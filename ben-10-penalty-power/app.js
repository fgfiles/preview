var Utils;(function(Utils){var AssetLoader=(function(){function AssetLoader(_lang,_aFileData,_ctx,_canvasWidth,_canvasHeight,_showBar){if(typeof _showBar==="undefined"){_showBar=true;}
this.oAssetData={};this.assetsLoaded=0;this.textData={};this.spinnerRot=0;this.totalAssets=_aFileData.length;this.showBar=_showBar;for(var i=0;i<_aFileData.length;i++){if(_aFileData[i].file.indexOf(".json")!=-1){this.loadJSON(_aFileData[i]);}else{this.loadImage(_aFileData[i]);}}
if(_showBar){this.oLoaderImgData=preAssetLib.getData("loader");this.oLoadSpinnerImgData=preAssetLib.getData("loadSpinner");this.oLoaderBgImgData=preAssetLib.getData("loaderBg");}}
AssetLoader.prototype.render=function(){ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(this.oLoaderBgImgData.img,0,0,this.oLoaderBgImgData.img.width,this.oLoaderBgImgData.img.height,0,0,canvas.width,canvas.height);ctx.fillStyle="#95D500";ctx.fillRect(canvas.width/2-150,canvas.height/2+20+50,(300/this.totalAssets)*this.assetsLoaded,30);ctx.drawImage(this.oLoaderImgData.img,canvas.width/2-this.oLoaderImgData.img.width/2,canvas.height/2-this.oLoaderImgData.img.height/2);this.spinnerRot+=delta*3;ctx.save();ctx.translate(canvas.width/2-30,canvas.height/2-16+50);ctx.rotate(this.spinnerRot);ctx.drawImage(this.oLoadSpinnerImgData.img,-this.oLoadSpinnerImgData.img.width/2,-this.oLoadSpinnerImgData.img.height/2);ctx.restore();this.displayNumbers();};AssetLoader.prototype.displayNumbers=function(){ctx.textAlign="left";ctx.font="bold 40px arial";ctx.fillStyle="#ffffff";ctx.fillText(Math.round((this.assetsLoaded/this.totalAssets)*100)+"%",canvas.width/2+0,canvas.height/2+51);};AssetLoader.prototype.loadExtraAssets=function(_callback,_aFileData){this.showBar=false;this.totalAssets=_aFileData.length;this.assetsLoaded=0;this.loadedCallback=_callback;for(var i=0;i<_aFileData.length;i++){if(_aFileData[i].file.indexOf(".json")!=-1){this.loadJSON(_aFileData[i]);}else{this.loadImage(_aFileData[i]);}}};AssetLoader.prototype.loadJSON=function(_oData){var _this=this;var xobj=new XMLHttpRequest();xobj.open('GET',_oData.file,true);xobj.onreadystatechange=function(){if(xobj.readyState==4&&xobj.status==200){_this.textData[_oData.id]=JSON.parse(xobj.responseText);++_this.assetsLoaded;_this.checkLoadComplete();}};xobj.send(null);};AssetLoader.prototype.loadImage=function(_oData){var _this=this;var img=new Image();img.onload=function(){_this.oAssetData[_oData.id]={};_this.oAssetData[_oData.id].img=img;_this.oAssetData[_oData.id].oData={};var aSpriteSize=_this.getSpriteSize(_oData.file);if(aSpriteSize[0]!=0){_this.oAssetData[_oData.id].oData.spriteWidth=aSpriteSize[0];_this.oAssetData[_oData.id].oData.spriteHeight=aSpriteSize[1];}else{_this.oAssetData[_oData.id].oData.spriteWidth=_this.oAssetData[_oData.id].img.width;_this.oAssetData[_oData.id].oData.spriteHeight=_this.oAssetData[_oData.id].img.height;}
if(_oData.oAnims){_this.oAssetData[_oData.id].oData.oAnims=_oData.oAnims;}
if(_oData.oAtlasData){_this.oAssetData[_oData.id].oData.oAtlasData=_oData.oAtlasData;}else{_this.oAssetData[_oData.id].oData.oAtlasData={none:{x:0,y:0,width:_this.oAssetData[_oData.id].oData.spriteWidth,height:_this.oAssetData[_oData.id].oData.spriteHeight}};}
++_this.assetsLoaded;_this.checkLoadComplete();};img.src=_oData.file;};AssetLoader.prototype.getSpriteSize=function(_file){var aNew=new Array();var sizeY="";var sizeX="";var stage=0;var inc=_file.lastIndexOf(".");var canCont=true;while(canCont){inc--;if(stage==0&&this.isNumber(_file.charAt(inc))){sizeY=_file.charAt(inc)+sizeY;}else if(stage==0&&sizeY.length>0&&_file.charAt(inc)=="x"){inc--;stage=1;sizeX=_file.charAt(inc)+sizeX;}else if(stage==1&&this.isNumber(_file.charAt(inc))){sizeX=_file.charAt(inc)+sizeX;}else if(stage==1&&sizeX.length>0&&_file.charAt(inc)=="_"){canCont=false;aNew=[parseInt(sizeX),parseInt(sizeY)];}else{canCont=false;aNew=[0,0];}}
return aNew;};AssetLoader.prototype.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n);};AssetLoader.prototype.checkLoadComplete=function(){if(this.assetsLoaded==this.totalAssets){this.loadedCallback();}};AssetLoader.prototype.onReady=function(_func){this.loadedCallback=_func;};AssetLoader.prototype.getImg=function(_id){return this.oAssetData[_id].img;};AssetLoader.prototype.getData=function(_id){return this.oAssetData[_id];};return AssetLoader;})();Utils.AssetLoader=AssetLoader;})(Utils||(Utils={}));var Utils;(function(Utils){var AnimSprite=(function(){function AnimSprite(_oImgData,_fps,_radius,_animId){this.x=0;this.y=0;this.rotation=0;this.radius=10;this.removeMe=false;this.frameInc=0;this.animType="loop";this.offsetX=0;this.offsetY=0;this.scaleX=1;this.scaleY=1;this.alpha=1;this.oImgData=_oImgData;this.oAnims=this.oImgData.oData.oAnims;this.fps=_fps;this.radius=_radius;this.animId=_animId;this.centreX=Math.round(this.oImgData.oData.spriteWidth/2);this.centreY=Math.round(this.oImgData.oData.spriteHeight/2);}
AnimSprite.prototype.updateAnimation=function(_delta){this.frameInc+=this.fps*_delta;};AnimSprite.prototype.changeImgData=function(_newImgData,_animId){this.oImgData=_newImgData;this.oAnims=this.oImgData.oData.oAnims;this.animId=_animId;this.centreX=Math.round(this.oImgData.oData.spriteWidth/2);this.centreY=Math.round(this.oImgData.oData.spriteHeight/2);this.resetAnim();};AnimSprite.prototype.resetAnim=function(){this.frameInc=0;};AnimSprite.prototype.setFrame=function(_frameNum){this.fixedFrame=_frameNum;};AnimSprite.prototype.setAnimType=function(_type,_animId,_reset){if(typeof _reset==="undefined"){_reset=true;}
this.animId=_animId;this.animType=_type;if(_reset){this.resetAnim();}
switch(_type){case "loop":break;case "once":this.maxIdx=this.oAnims[this.animId].length-1;break;}};AnimSprite.prototype.render=function(_ctx){_ctx.save();_ctx.translate(this.x,this.y);_ctx.rotate(this.rotation);_ctx.scale(this.scaleX,this.scaleY);_ctx.globalAlpha=this.alpha;if(this.animId!=null){var max=this.oAnims[this.animId].length;var idx=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][idx%max];var imgX=(this.curFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width;var imgY=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if(this.animType=="once"){if(idx>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][max-1];this.animId=null;if(this.animEndedFunc!=null){this.animEndedFunc();}
var imgX=(this.fixedFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width;var imgY=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;}}}else{var imgX=(this.fixedFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width;var imgY=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;}
_ctx.drawImage(this.oImgData.img,imgX,imgY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.centreX+this.offsetX,-this.centreY+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight);_ctx.restore();};AnimSprite.prototype.renderSimple=function(_ctx){if(this.animId!=null){var max=this.oAnims[this.animId].length;var idx=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][idx%max];var imgX=(this.curFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width;var imgY=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if(this.animType=="once"){if(idx>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][max-1];this.animId=null;if(this.animEndedFunc!=null){this.animEndedFunc();}
var imgX=(this.fixedFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width;var imgY=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;}}}else{var imgX=(this.fixedFrame*this.oImgData.oData.spriteWidth)%this.oImgData.img.width;var imgY=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;}
_ctx.drawImage(this.oImgData.img,imgX,imgY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,this.x-(this.centreX-this.offsetX)*this.scaleX,this.y-(this.centreY-this.offsetY)*this.scaleY,this.oImgData.oData.spriteWidth*this.scaleX,this.oImgData.oData.spriteHeight*this.scaleY);};return AnimSprite;})();Utils.AnimSprite=AnimSprite;})(Utils||(Utils={}));var Utils;(function(Utils){var BasicSprite=(function(){function BasicSprite(_oImgData,_radius,_frame){if(typeof _frame==="undefined"){_frame=0;}
this.x=0;this.y=0;this.rotation=0;this.radius=10;this.removeMe=false;this.offsetX=0;this.offsetY=0;this.scaleX=1;this.scaleY=1;this.oImgData=_oImgData;this.radius=_radius;this.setFrame(_frame);}
BasicSprite.prototype.setFrame=function(_frameNum){this.frameNum=_frameNum;};BasicSprite.prototype.render=function(_ctx){_ctx.save();_ctx.translate(this.x,this.y);_ctx.rotate(this.rotation);_ctx.scale(this.scaleX,this.scaleY);var imgX=(this.frameNum*this.oImgData.oData.spriteWidth)%this.oImgData.img.width;var imgY=Math.floor(this.frameNum/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;_ctx.drawImage(this.oImgData.img,imgX,imgY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2+this.offsetX,-this.oImgData.oData.spriteHeight/2+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight);_ctx.restore();};return BasicSprite;})();Utils.BasicSprite=BasicSprite;})(Utils||(Utils={}));var Utils;(function(Utils){var UserInput=(function(){function UserInput(_canvas,_isBugBrowser){var _this=this;this.prevHitTime=0;this.pauseIsOn=false;this.isDown=false;this.isBugBrowser=_isBugBrowser;this.keyDownEvtFunc=function(e){_this.keyDown(e);};this.keyUpEvtFunc=function(e){_this.keyUp(e);};_canvas.addEventListener('contextmenu',function(event){return event.preventDefault();});_canvas.addEventListener("touchstart",function(e){for(var i=0;i<e.changedTouches.length;i++){_this.hitDown(e,e.changedTouches[i].pageX,e.changedTouches[i].pageY,e.changedTouches[i].identifier);}},false);_canvas.addEventListener("touchend",function(e){for(var i=0;i<e.changedTouches.length;i++){_this.hitUp(e,e.changedTouches[i].pageX,e.changedTouches[i].pageY,e.changedTouches[i].identifier);}},false);_canvas.addEventListener("touchcancel",function(e){for(var i=0;i<e.changedTouches.length;i++){_this.hitCancel(e,e.changedTouches[i].pageX,e.changedTouches[i].pageY,e.changedTouches[i].identifier);}},false);_canvas.addEventListener("touchmove",function(e){for(var i=0;i<e.changedTouches.length;i++){_this.move(e,e.changedTouches[i].pageX,e.changedTouches[i].pageY,e.changedTouches[i].identifier,true);}},false);_canvas.addEventListener("mousedown",function(e){if(e.button==2){return;}
_this.isDown=true;_this.hitDown(e,e.pageX,e.pageY,1);},false);_canvas.addEventListener("mouseup",function(e){if(e.button==2){return;}
_this.isDown=false;_this.hitUp(e,e.pageX,e.pageY,1);},false);_canvas.addEventListener("mousemove",function(e){if(e.button==2){return;}
_this.move(e,e.pageX,e.pageY,1,_this.isDown);},false);_canvas.addEventListener("mouseout",function(e){if(e.button==2){return;}
clearButtonOvers();_this.isDown=false;_this.hitUp(e,Math.abs(e.pageX),Math.abs(e.pageY),1);},false);this.aHitAreas=new Array();this.aKeys=new Array();}
UserInput.prototype.hitDown=function(e,_posX,_posY,_identifer){e.preventDefault();e.stopPropagation();if(!hasFocus){visibleResume();}
if(this.pauseIsOn){return;}
var curHitTime=new Date().getTime();_posX*=canvasScale;_posY*=canvasScale;for(var i=0;i<this.aHitAreas.length;i++){if(this.aHitAreas[i].rect){var aX=getSafeWidth(canvas.width*this.aHitAreas[i].align[0]);var aY=getSafeHeight(canvas.height*this.aHitAreas[i].align[1]);if(_posX>aX+this.aHitAreas[i].area[0]&&_posY>aY+this.aHitAreas[i].area[1]&&_posX<aX+this.aHitAreas[i].area[2]&&_posY<aY+this.aHitAreas[i].area[3]){this.aHitAreas[i].aTouchIdentifiers.push(_identifer);this.aHitAreas[i].oData.hasLeft=false;if(!this.aHitAreas[i].oData.isDown){this.aHitAreas[i].oData.isDown=true;this.aHitAreas[i].oData.x=_posX;this.aHitAreas[i].oData.y=_posY;if((curHitTime-this.prevHitTime<500&&(gameState!="game"||this.aHitAreas[i].id=="pause"))&&isBugBrowser){return;}
this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData);}
break;}}else{}}
this.prevHitTime=curHitTime;};UserInput.prototype.hitUp=function(e,_posX,_posY,_identifer){if(!ios9FirstTouch){playSound("silence");ios9FirstTouch=true;}
if(this.pauseIsOn){return;}
e.preventDefault();e.stopPropagation();_posX*=canvasScale;_posY*=canvasScale;for(var i=0;i<this.aHitAreas.length;i++){if(this.aHitAreas[i].rect){var aX=canvas.width*this.aHitAreas[i].align[0];var aY=canvas.height*this.aHitAreas[i].align[1];if(_posX>aX+this.aHitAreas[i].area[0]&&_posY>aY+this.aHitAreas[i].area[1]&&_posX<aX+this.aHitAreas[i].area[2]&&_posY<aY+this.aHitAreas[i].area[3]){for(var j=0;j<this.aHitAreas[i].aTouchIdentifiers.length;j++){if(this.aHitAreas[i].aTouchIdentifiers[j]==_identifer){this.aHitAreas[i].aTouchIdentifiers.splice(j,1);j-=1;}}
if(this.aHitAreas[i].aTouchIdentifiers.length==0){this.aHitAreas[i].oData.isDown=false;if(this.aHitAreas[i].oData.multiTouch){this.aHitAreas[i].oData.x=_posX;this.aHitAreas[i].oData.y=_posY;this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData);}}
break;}}else{}}};UserInput.prototype.hitCancel=function(e,_posX,_posY,_identifer){e.preventDefault();e.stopPropagation();_posX*=canvasScale;_posY*=canvasScale;for(var i=0;i<this.aHitAreas.length;i++){if(this.aHitAreas[i].oData.isDown){this.aHitAreas[i].oData.isDown=false;this.aHitAreas[i].aTouchIdentifiers=new Array();if(this.aHitAreas[i].oData.multiTouch){this.aHitAreas[i].oData.x=_posX;this.aHitAreas[i].oData.y=_posY;this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData);}}}};UserInput.prototype.move=function(e,_posX,_posY,_identifer,_isDown){_posX*=canvasScale;_posY*=canvasScale;this.mouseX=_posX;this.mouseY=_posY;if(this.pauseIsOn){return;}
if(_isDown){for(var i=0;i<this.aHitAreas.length;i++){if(this.aHitAreas[i].rect){var aX=canvas.width*this.aHitAreas[i].align[0];var aY=canvas.height*this.aHitAreas[i].align[1];if(_posX>aX+this.aHitAreas[i].area[0]&&_posY>aY+this.aHitAreas[i].area[1]&&_posX<aX+this.aHitAreas[i].area[2]&&_posY<aY+this.aHitAreas[i].area[3]){this.aHitAreas[i].oData.hasLeft=false;if(this.aHitAreas[i].oData.isDraggable&&!this.aHitAreas[i].oData.isDown){this.aHitAreas[i].oData.isDown=true;this.aHitAreas[i].oData.x=_posX;this.aHitAreas[i].oData.y=_posY;this.aHitAreas[i].aTouchIdentifiers.push(_identifer);if(this.aHitAreas[i].oData.multiTouch){this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData);}}
if(this.aHitAreas[i]&&this.aHitAreas[i].oData.isDraggable){this.aHitAreas[i].oData.isBeingDragged=true;this.aHitAreas[i].oData.x=_posX;this.aHitAreas[i].oData.y=_posY;this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData);if(this.aHitAreas[i]){this.aHitAreas[i].oData.isBeingDragged=false;}}}else if(this.aHitAreas[i].oData.isDown&&!this.aHitAreas[i].oData.hasLeft){for(var j=0;j<this.aHitAreas[i].aTouchIdentifiers.length;j++){if(this.aHitAreas[i].aTouchIdentifiers[j]==_identifer){this.aHitAreas[i].aTouchIdentifiers.splice(j,1);j-=1;}}
if(this.aHitAreas[i].aTouchIdentifiers.length==0){this.aHitAreas[i].oData.hasLeft=true;if(!this.aHitAreas[i].oData.isBeingDragged){this.aHitAreas[i].oData.isDown=false;}
if(this.aHitAreas[i].oData.multiTouch){this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData);}}}}}}};UserInput.prototype.keyDown=function(e){for(var i=0;i<this.aKeys.length;i++){if(e.keyCode==this.aKeys[i].keyCode){e.preventDefault();this.aKeys[i].oData.isDown=true;this.aKeys[i].callback(this.aKeys[i].id,this.aKeys[i].oData);}}};UserInput.prototype.keyUp=function(e){for(var i=0;i<this.aKeys.length;i++){if(e.keyCode==this.aKeys[i].keyCode){e.preventDefault();this.aKeys[i].oData.isDown=false;this.aKeys[i].callback(this.aKeys[i].id,this.aKeys[i].oData);}}};UserInput.prototype.checkKeyFocus=function(){window.focus();if(this.aKeys.length>0){window.removeEventListener('keydown',this.keyDownEvtFunc,false);window.removeEventListener('keyup',this.keyUpEvtFunc,false);window.addEventListener('keydown',this.keyDownEvtFunc,false);window.addEventListener('keyup',this.keyUpEvtFunc,false);}};UserInput.prototype.addKey=function(_id,_callback,_oCallbackData,_keyCode){if(_oCallbackData==null){_oCallbackData=new Object();}
this.aKeys.push({id:_id,callback:_callback,oData:_oCallbackData,keyCode:_keyCode});this.checkKeyFocus();};UserInput.prototype.removeKey=function(_id){for(var i=0;i<this.aKeys.length;i++){if(this.aKeys[i].id==_id){this.aKeys.splice(i,1);i-=1;}}};UserInput.prototype.addHitArea=function(_id,_callback,_oCallbackData,_type,_oAreaData,_isUnique){if(typeof _isUnique==="undefined"){_isUnique=false;}
if(_oCallbackData==null){_oCallbackData=new Object();}
if(_isUnique){this.removeHitArea(_id);}
if(!_oAreaData.scale){_oAreaData.scale=1;}
if(!_oAreaData.align){_oAreaData.align=[0,0];}
var aTouchIdentifiers=new Array();switch(_type){case "image":var aRect;aRect=new Array(_oAreaData.aPos[0]-(_oAreaData.oImgData.oData.oAtlasData[_oAreaData.id].width/2)*_oAreaData.scale,_oAreaData.aPos[1]-(_oAreaData.oImgData.oData.oAtlasData[_oAreaData.id].height/2)*_oAreaData.scale,_oAreaData.aPos[0]+(_oAreaData.oImgData.oData.oAtlasData[_oAreaData.id].width/2)*_oAreaData.scale,_oAreaData.aPos[1]+(_oAreaData.oImgData.oData.oAtlasData[_oAreaData.id].height/2)*_oAreaData.scale);this.aHitAreas.push({id:_id,aTouchIdentifiers:aTouchIdentifiers,callback:_callback,oData:_oCallbackData,rect:true,area:aRect,align:_oAreaData.align});break;case "rect":this.aHitAreas.push({id:_id,aTouchIdentifiers:aTouchIdentifiers,callback:_callback,oData:_oCallbackData,rect:true,area:_oAreaData.aRect,align:_oAreaData.align});break;}};UserInput.prototype.removeHitArea=function(_id){for(var i=0;i<this.aHitAreas.length;i++){if(this.aHitAreas[i].id==_id){this.aHitAreas.splice(i,1);i-=1;}}};UserInput.prototype.resetAll=function(){for(var i=0;i<this.aHitAreas.length;i++){this.aHitAreas[i].oData.isDown=false;this.aHitAreas[i].oData.isBeingDragged=false;this.aHitAreas[i].aTouchIdentifiers=new Array();}
this.isDown=false;};return UserInput;})();Utils.UserInput=UserInput;})(Utils||(Utils={}));var Utils;(function(Utils){var FpsMeter=(function(){function FpsMeter(_canvasHeight){this.updateFreq=10;this.updateInc=0;this.frameAverage=0;this.display=1;this.log="";this.render=function(_ctx){this.frameAverage+=this.delta/this.updateFreq;if(++this.updateInc>=this.updateFreq){this.updateInc=0;this.display=this.frameAverage;this.frameAverage=0;}
_ctx.textAlign="left";ctx.font="10px Helvetica";_ctx.fillStyle="#333333";_ctx.beginPath();_ctx.rect(0,this.canvasHeight-15,40,15);_ctx.closePath();_ctx.fill();_ctx.fillStyle="#ffffff";_ctx.fillText(Math.round(1000/(this.display*1000))+" fps "+this.log,5,this.canvasHeight-5);};this.canvasHeight=_canvasHeight;}
FpsMeter.prototype.update=function(_delta){this.delta=_delta;};return FpsMeter;})();Utils.FpsMeter=FpsMeter;})(Utils||(Utils={}));var Elements;(function(Elements){var Background=(function(){function Background(){this.x=0;this.y=0;this.targY=0;this.incY=0;this.renderState=null;if(gameState=="start"){this.oImgData=assetLib.getData("titleBg");}}
Background.prototype.render=function(){if(canvas.width>canvas.height){ctx.drawImage(this.oImgData.img,0,((1-canvas.height/canvas.width)/2)*this.oImgData.img.height,this.oImgData.img.width,(canvas.height/canvas.width)*this.oImgData.img.height,0,0,canvas.width,canvas.height);}else{ctx.drawImage(this.oImgData.img,((1-canvas.width/canvas.height)/2)*this.oImgData.img.width,0,(canvas.width/canvas.height)*this.oImgData.img.width,this.oImgData.img.width,0,0,canvas.width,canvas.height);}};return Background;})();Elements.Background=Background;})(Elements||(Elements={}));var Elements;(function(Elements){var Panel=(function(){function Panel(_aButs){this.timer=.3;this.endTime=0;this.posY=0;this.posX=0;this.numberSpace=17;this.incY=0;this.flareRot=0;this.scrollX=0;this.posBounceX=0;this.aHeroCharPos=new Array({x:-30,y:50},{x:-30,y:50},{x:-20,y:100},{x:-20,y:70},{x:0,y:50});this.aEnemyCharPos=new Array({x:50,y:50},{x:40,y:20},{x:0,y:70},{x:40,y:50},{x:30,y:80});this.scoreNumberSpace=40;this.loserX=0;this.evolved=false;this.evolveTimer=0;this.evolveAlpha=0;this.evolveEffectScale=0;this.oBgImgData=assetLib.getData("titleBg");this.oTitleLogoImgData=assetLib.getData("titleLogo");this.oUiElementsImgData=assetLib.getData("uiElements");this.oGameElementsImgData=assetLib.getData("gameElements");this.aButs=_aButs;this.oIntroElementsImgData=assetLib.getData("introElements");this.oScoreNumbersImgData=assetLib.getData("scoreNumbers");}
Panel.prototype.update=function(){this.incY+=10*delta;};Panel.prototype.startTween1=function(){this.posY=500;TweenLite.to(this,.5,{posY:0,ease:"Back.easeOut"});this.posX=50;TweenLite.to(this,1,{posX:0,ease:"Cubic.easeOut"});this.posBounceX=50;TweenLite.to(this,1,{posBounceX:0,ease:"Bounce.easeOut"});};Panel.prototype.startEvolveTween=function(){this.posY=500;TweenLite.to(this,.5,{posY:0,ease:"Back.easeOut"});this.posX=50;TweenLite.to(this,1,{posX:0,ease:"Cubic.easeOut"});this.posBounceX=50;TweenLite.to(this,1,{delay:2,posBounceX:0,ease:"Bounce.easeOut"});};Panel.prototype.shootingCompleteTween=function(){this.posY=500;TweenLite.to(this,.5,{posY:0,ease:"Back.easeOut"});this.posX=50;TweenLite.to(this,1,{posX:0,ease:"Quad.easeOut"});this.posBounceX=50;TweenLite.to(this,1,{posBounceX:0,ease:"Bounce.easeOut"});setTimeout(function(){wipe.trigger(initGoalkeeping);},1500);};Panel.prototype.goalkeepingCompleteTween=function(){this.posY=500;TweenLite.to(this,.5,{posY:0,ease:"Back.easeOut"});this.posX=50;TweenLite.to(this,1,{posX:0,ease:"Quad.easeOut"});this.posBounceX=50;TweenLite.to(this,1,{posBounceX:0,ease:"Bounce.easeOut"});this.loserX=0;TweenLite.to(this,1,{delay:1.5,loserX:700,ease:"Back.easeIn",onComplete:function(){if(oGameData.heroScore>oGameData.enemyScore){if(levelNum<4){initVersusScreen(2);playSound("nextMatch");}else{wipe.trigger(initOutroScreen);}}else if(oGameData.heroScore==oGameData.enemyScore){initVersusScreen(1);playSound("nextMatch");}else{initVersusScreen(0);playSound("nextMatch");}}});};Panel.prototype.startScreenTween=function(){var _this=this;this.posY=500;this.oStartPosData={goodieX:-200,baddieX:200,ballX:400,ballY:200,ballRot:-.4,titleY:-300,titleScaleX:1,titleScaleY:1,logoX:-200};TweenLite.to(this.oStartPosData,.5,{goodieX:0,ease:"Back.easeOut"});TweenLite.to(this.oStartPosData,1,{logoX:0,ease:"Back.easeOut"});TweenLite.to(this.oStartPosData,.8,{baddieX:0,ease:"Quad.easeOut"});TweenLite.to(this.oStartPosData,.5,{ballRot:0,ballX:0,ballY:0,ease:"Quad.easeOut"});TweenLite.to(this.oStartPosData,2,{titleY:0,ease:"Bounce.easeOut"});TweenLite.to(this,.5,{delay:.25,posY:0,ease:"Quad.easeOut",onComplete:function(){_this.jiggleTitle();}});};Panel.prototype.jiggleTitle=function(){if(this.titleJiggleTween){this.titleJiggleTween.kill();}
this.oStartPosData.titleScaleX=1.05;this.oStartPosData.titleScaleY=.95;this.titleJiggleTween=TweenLite.to(this.oStartPosData,2,{titleScaleX:1,titleScaleY:1,ease:"Elastic.easeOut"});};Panel.prototype.switchBut=function(_id0,_id1,_id1Over,_aNewAPos,_aNewAlign){if(typeof _aNewAPos==="undefined"){_aNewAPos=null;}
if(typeof _aNewAlign==="undefined"){_aNewAlign=null;}
var oButData=null;for(var i=0;i<this.aButs.length;i++){if(this.aButs[i].id==_id0){this.aButs[i].id=_id1;this.aButs[i].idOver=_id1Over;oButData=this.aButs[i];if(_aNewAPos){this.aButs[i].aPos=_aNewAPos;}
if(_aNewAlign){this.aButs[i].align=_aNewAlign;}}}
return oButData;};Panel.prototype.introTween=function(){this.oIntro={inc0:1,inc1:-300,inc2:1,inc3:-200,inc4:-300,inc5:1,inc6:0,inc7:0,inc8:400};TweenLite.to(this.oIntro,2,{delay:.5,inc0:0,ease:"Quad.easeOut"});TweenLite.to(this.oIntro,.5,{delay:.5,inc1:0,ease:"Quint.easeOut"});TweenLite.to(this.oIntro,2,{delay:1,inc2:0,ease:"Quad.easeOut"});TweenLite.to(this.oIntro,1,{delay:1.5,inc3:0,ease:"Back.easeOut"});TweenLite.to(this.oIntro,1,{delay:2.4,inc4:0,ease:"Elastic.easeOut"});TweenLite.to(this.oIntro,1,{delay:3,inc5:0,ease:"Quad.easeOut"});TweenLite.to(this.oIntro,1,{delay:4,inc6:1,ease:"Bounce.easeOut"});TweenLite.to(this.oIntro,1,{delay:5,inc7:1,ease:"Elastic.easeOut"});TweenLite.to(this.oIntro,1,{delay:5.4,inc8:0,ease:"Back.easeOut"});};Panel.prototype.outroTween=function(){this.oIntro={inc0:1,inc1:0,inc2:1,inc3:-300,inc4:1,inc5:0};TweenLite.to(this.oIntro,1,{delay:.5,inc0:0,ease:"Quad.easeOut"});TweenLite.to(this.oIntro,1,{delay:.8,inc1:1,ease:"Elastic.easeIn"});TweenLite.to(this.oIntro,2,{delay:2.2,inc2:0,ease:"Quad.easeOut"});TweenLite.to(this.oIntro,.5,{delay:2.4,inc3:0,ease:"Back.easeOut"});TweenLite.to(this.oIntro,2,{delay:3.45,inc4:0,ease:"Quad.easeOut"});TweenLite.to(this.oIntro,2,{delay:4.45,inc5:1,ease:"Quad.easeOut"});};Panel.prototype.render=function(_butsOnTop){if(typeof _butsOnTop==="undefined"){_butsOnTop=true;}
if(!_butsOnTop){this.addButs(ctx);}
switch(gameState){case "outro":var oTempImgData=assetLib.getData("outroMainBg");var tempScale;if(canvas.width/oTempImgData.img.width<canvas.height/oTempImgData.img.height){tempScale=canvas.width/oTempImgData.img.width;this.introOffsetX=0;this.introOffsetY=(canvas.height-(oTempImgData.img.height*tempScale))/2;}else{tempScale=canvas.height/oTempImgData.img.height;this.introOffsetX=(canvas.width-(oTempImgData.img.width*tempScale))/2;this.introOffsetY=0;}
ctx.drawImage(oTempImgData.img,0,0,oTempImgData.img.width,oTempImgData.img.height,canvas.width/2-(oTempImgData.img.width/2)*tempScale,canvas.height/2-(oTempImgData.img.height/2)*tempScale,oTempImgData.img.width*tempScale,oTempImgData.img.height*tempScale);ctx.fillStyle="rgba(0, 0, 0, "+this.oIntro.inc0+")";ctx.beginPath();ctx.moveTo(this.introOffsetX+308*tempScale,this.introOffsetY+0*tempScale);ctx.lineTo(this.introOffsetX+900*tempScale,this.introOffsetY+0*tempScale);ctx.lineTo(this.introOffsetX+900*tempScale,this.introOffsetY+217*tempScale);ctx.lineTo(this.introOffsetX+405*tempScale,this.introOffsetY+192*tempScale);ctx.lineTo(this.introOffsetX+308*tempScale,this.introOffsetY+0*tempScale);ctx.fill();ctx.save();ctx.globalAlpha=Math.abs(this.oIntro.inc1);var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.domeGone].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.domeGone].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.domeGone].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.domeGone].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+262*tempScale,this.introOffsetY+0*tempScale,bWidth*tempScale,bHeight*tempScale);ctx.restore();ctx.fillStyle="rgba(0, 0, 0, "+this.oIntro.inc2+")";ctx.beginPath();ctx.moveTo(this.introOffsetX+0*tempScale,this.introOffsetY+0*tempScale);ctx.lineTo(this.introOffsetX+308*tempScale,this.introOffsetY+0*tempScale);ctx.lineTo(this.introOffsetX+405*tempScale,this.introOffsetY+192*tempScale);ctx.lineTo(this.introOffsetX+355*tempScale,this.introOffsetY+500*tempScale);ctx.lineTo(this.introOffsetX+0*tempScale,this.introOffsetY+9000*tempScale);ctx.lineTo(this.introOffsetX+0*tempScale,this.introOffsetY+0*tempScale);ctx.fill();for(var i=0;i<aFireworks.length;i++){aFireworks[i].update();aFireworks[i].render(ctx);if(aFireworks[i].removeMe){aFireworks.splice(i,1);i-=1;}}
var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.benHappy].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.benHappy].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.benHappy].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.benHappy].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+(82+this.oIntro.inc3)*tempScale,this.introOffsetY+78*tempScale,bWidth*tempScale,bHeight*tempScale);ctx.fillStyle="rgba(0, 0, 0, "+this.oIntro.inc4+")";ctx.beginPath();ctx.moveTo(this.introOffsetX+405*tempScale,this.introOffsetY+192*tempScale);ctx.lineTo(this.introOffsetX+900*tempScale,this.introOffsetY+217*tempScale);ctx.lineTo(this.introOffsetX+900*tempScale,this.introOffsetY+500*tempScale);ctx.lineTo(this.introOffsetX+355*tempScale,this.introOffsetY+500*tempScale);ctx.lineTo(this.introOffsetX+405*tempScale,this.introOffsetY+192*tempScale);ctx.fill();ctx.save();ctx.globalAlpha=this.oIntro.inc5;var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.vilgaxGone].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.vilgaxGone].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.vilgaxGone].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.vilgaxGone].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+540*tempScale,this.introOffsetY+338*tempScale,bWidth*tempScale,bHeight*tempScale);ctx.restore();var oTempImgData=assetLib.getData("introFrame");ctx.drawImage(oTempImgData.img,0,0,oTempImgData.img.width,oTempImgData.img.height,canvas.width/2-(oTempImgData.img.width/2)*tempScale,canvas.height/2-(oTempImgData.img.height/2)*tempScale,oTempImgData.img.width*tempScale,oTempImgData.img.height*tempScale);ctx.fillStyle="rgba(0, 0, 0, 1)";if(canvas.width/oTempImgData.img.width<canvas.height/oTempImgData.img.height){ctx.fillRect(0,0,canvas.width,this.introOffsetY);ctx.fillRect(0,canvas.height-this.introOffsetY,canvas.width,canvas.height);}else{ctx.fillRect(0,0,this.introOffsetX,canvas.height);ctx.fillRect(canvas.width-this.introOffsetX,0,canvas.width,canvas.height);}
var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,"outro")+20+80-this.posY,10,bWidth,bHeight);addText(30,380,"left",20-this.posY,53,"outro");break;case "intro":var oTempImgData=assetLib.getData("introMainBg");var tempScale;if(canvas.width/oTempImgData.img.width<canvas.height/oTempImgData.img.height){tempScale=canvas.width/oTempImgData.img.width;this.introOffsetX=0;this.introOffsetY=(canvas.height-(oTempImgData.img.height*tempScale))/2;}else{tempScale=canvas.height/oTempImgData.img.height;this.introOffsetX=(canvas.width-(oTempImgData.img.width*tempScale))/2;this.introOffsetY=0;}
ctx.drawImage(oTempImgData.img,0,0,oTempImgData.img.width,oTempImgData.img.height,canvas.width/2-(oTempImgData.img.width/2)*tempScale,canvas.height/2-(oTempImgData.img.height/2)*tempScale,oTempImgData.img.width*tempScale,oTempImgData.img.height*tempScale);ctx.fillStyle="rgba(0, 0, 0, "+this.oIntro.inc0+")";ctx.beginPath();ctx.moveTo(this.introOffsetX+0,this.introOffsetY+0);ctx.lineTo(this.introOffsetX+576*tempScale,this.introOffsetY+0);ctx.lineTo(this.introOffsetX+635*tempScale,this.introOffsetY+217*tempScale);ctx.lineTo(this.introOffsetX+599*tempScale,this.introOffsetY+278*tempScale);ctx.lineTo(this.introOffsetX+0,this.introOffsetY+304*tempScale);ctx.lineTo(this.introOffsetX+0,this.introOffsetY+0);ctx.fill();var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.happyGroup].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.happyGroup].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.happyGroup].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.happyGroup].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+0+this.oIntro.inc1,this.introOffsetY+80*tempScale,bWidth*tempScale,bHeight*tempScale);var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex0].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex0].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex0].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex0].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+727*tempScale,this.introOffsetY+(31+this.oIntro.inc3)*tempScale,bWidth*tempScale,bHeight*tempScale);ctx.fillStyle="rgba(0, 0, 0, "+this.oIntro.inc2+")";ctx.beginPath();ctx.moveTo(this.introOffsetX+576*tempScale,this.introOffsetY+0*tempScale);ctx.lineTo(this.introOffsetX+900*tempScale,this.introOffsetY+0*tempScale);ctx.lineTo(this.introOffsetX+900*tempScale,this.introOffsetY+261*tempScale);ctx.lineTo(this.introOffsetX+586*tempScale,this.introOffsetY+277*tempScale);ctx.lineTo(this.introOffsetX+635*tempScale,this.introOffsetY+217*tempScale);ctx.lineTo(this.introOffsetX+576*tempScale,this.introOffsetY+0*tempScale);ctx.fill();var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.shockedBen].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.shockedBen].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.shockedBen].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.shockedBen].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+502*tempScale,this.introOffsetY+(25+this.oIntro.inc4)*tempScale,bWidth*tempScale,bHeight*tempScale);var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex1].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex1].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex1].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.hex1].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+129*tempScale,this.introOffsetY+(347+100*this.oIntro.inc5)*tempScale,bWidth*tempScale,bHeight*tempScale);ctx.fillStyle="rgba(0, 0, 0, "+this.oIntro.inc5+")";ctx.beginPath();ctx.moveTo(this.introOffsetX+0*tempScale,this.introOffsetY+305*tempScale);ctx.lineTo(this.introOffsetX+604*tempScale,this.introOffsetY+276*tempScale);ctx.lineTo(this.introOffsetX+625*tempScale,this.introOffsetY+500*tempScale);ctx.lineTo(this.introOffsetX+0*tempScale,this.introOffsetY+500*tempScale);ctx.lineTo(this.introOffsetX+0*tempScale,this.introOffsetY+305*tempScale);ctx.fill();ctx.save();ctx.globalAlpha=this.oIntro.inc6;var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.dome].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.dome].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.dome].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.dome].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+0*tempScale,this.introOffsetY+233*tempScale,bWidth*tempScale,bHeight*tempScale);ctx.restore();var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.greenBg].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.greenBg].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.greenBg].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.greenBg].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+692*tempScale-(bWidth/2)*tempScale*this.oIntro.inc7,this.introOffsetY+335*tempScale-(bHeight/2)*tempScale*this.oIntro.inc7,bWidth*tempScale*this.oIntro.inc7,bHeight*tempScale*this.oIntro.inc7);var bX=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.actionBen].x;var bY=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.actionBen].y;var bWidth=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.actionBen].width;var bHeight=this.oIntroElementsImgData.oData.oAtlasData[oImageIds.actionBen].height;ctx.drawImage(this.oIntroElementsImgData.img,bX,bY,bWidth,bHeight,this.introOffsetX+608*tempScale,this.introOffsetY+(249+this.oIntro.inc8)*tempScale,bWidth*tempScale,bHeight*tempScale);var oTempImgData=assetLib.getData("introFrame");ctx.drawImage(oTempImgData.img,0,0,oTempImgData.img.width,oTempImgData.img.height,canvas.width/2-(oTempImgData.img.width/2)*tempScale,canvas.height/2-(oTempImgData.img.height/2)*tempScale,oTempImgData.img.width*tempScale,oTempImgData.img.height*tempScale);ctx.fillStyle="rgba(0, 0, 0, 1)";if(canvas.width/oTempImgData.img.width<canvas.height/oTempImgData.img.height){ctx.fillRect(0,0,canvas.width,this.introOffsetY);ctx.fillRect(0,canvas.height-this.introOffsetY,canvas.width,canvas.height);}else{ctx.fillRect(0,0,this.introOffsetX,canvas.height);ctx.fillRect(canvas.width-this.introOffsetX,0,canvas.width,canvas.height);}
var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,"intro")+20+80-this.posY,10,bWidth,bHeight);addText(30,380,"left",20-this.posY,53,"intro");break;case "start":ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(this.oBgImgData.img,0,0,this.oBgImgData.img.width,this.oBgImgData.img.height,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2,this.oBgImgData.img.width,this.oBgImgData.img.height);for(var i=0;i<aFireworks.length;i++){aFireworks[i].update();aFireworks[i].render(ctx);if(aFireworks[i].removeMe){aFireworks.splice(i,1);i-=1;}}
if(canvas.width>900&&canvas.height>600){this.titleScale=Math.min(canvas.width/900,1.2);}else{this.titleScale=1;}
var tempHoverX=Math.sin(this.incY/5)*3;var tempHoverY=Math.cos(this.incY/5)*3;ctx.save();ctx.translate(canvas.width/2-100+this.oStartPosData.goodieX+tempHoverX-(this.titleScale-1)*300,canvas.height/2+30+tempHoverY-(this.titleScale-1)*300);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroBack].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroBack].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroBack].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroBack].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth/2,-bHeight/2,bWidth,bHeight);ctx.restore();ctx.drawImage(this.oTitleLogoImgData.img,0,0,this.oTitleLogoImgData.img.width,this.oTitleLogoImgData.img.height,canvas.width/2-(this.oTitleLogoImgData.img.width/2)*this.oStartPosData.titleScaleX*this.titleScale+20,canvas.height*.24-(this.oTitleLogoImgData.img.height/2)*this.oStartPosData.titleScaleY*this.titleScale+this.oStartPosData.titleY,this.oTitleLogoImgData.img.width*this.oStartPosData.titleScaleX*this.titleScale,this.oTitleLogoImgData.img.height*this.oStartPosData.titleScaleY*this.titleScale);ctx.save();ctx.translate(canvas.width/2-365+this.oStartPosData.goodieX+tempHoverX-(this.titleScale-1)*300,canvas.height/2+90+tempHoverY-(this.titleScale-1)*300);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroFront].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroFront].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroFront].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroFront].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth/2,-bHeight/2,bWidth,bHeight);ctx.translate(124,-37);ctx.globalAlpha=Math.abs(Math.sin(this.incY+tempHoverX))/4;var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroGlow].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroGlow].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroGlow].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleHeroGlow].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth/2,-bHeight/2,bWidth,bHeight);ctx.restore();ctx.save();ctx.translate(canvas.width/2+325+this.oStartPosData.baddieX-tempHoverX+(this.titleScale-1)*300,canvas.height/2+115-tempHoverY-(this.titleScale-1)*300);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBaddie].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBaddie].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBaddie].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBaddie].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth/2,-bHeight/2,bWidth,bHeight);ctx.restore();ctx.save();ctx.translate(canvas.width/2+150+this.oStartPosData.ballX+tempHoverY,canvas.height*.23+250+this.oStartPosData.ballY+tempHoverY);ctx.rotate(this.oStartPosData.ballRot);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBall].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBall].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBall].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.titleBall].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth/2,-bHeight/2,bWidth,bHeight);ctx.restore();var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.bottomFade].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.bottomFade].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.bottomFade].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.bottomFade].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,canvas.height-bHeight,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.ben10Logo].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.ben10Logo].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.ben10Logo].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.ben10Logo].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,getSafeWidth(this.oStartPosData.logoX)-bWidth/2+80,getSafeHeight(canvas.height)-bHeight/2-80,bWidth,bHeight);ctx.restore();break;case "credits":ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(this.oBgImgData.img,0,0,this.oBgImgData.img.width,this.oBgImgData.img.height,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2,this.oBgImgData.img.width,this.oBgImgData.img.height);ctx.fillStyle="rgba(0, 0, 0,"+(.5-this.posX/50)+")";ctx.fillRect(0,0,canvas.width,canvas.height);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,0-this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,canvas.height-bHeight+this.posX,canvas.width,bHeight);var tempImgData=assetLib.getData("info");ctx.drawImage(tempImgData.img,0,0,tempImgData.img.width,tempImgData.img.height,canvas.width/2-tempImgData.img.width/2-this.posY,canvas.height/2-tempImgData.img.height/2,tempImgData.img.width,tempImgData.img.height);addText(20,1000,"center",canvas.width/2-this.posY,canvas.height/2-170,"producedFor","#FFFFFF");addText(20,1000,"center",canvas.width/2-this.posY,canvas.height/2+83,"createdBy","#FFFFFF");break;case "charSelect":ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(this.oBgImgData.img,0,0,this.oBgImgData.img.width,this.oBgImgData.img.height,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2,this.oBgImgData.img.width,this.oBgImgData.img.height);ctx.fillStyle="rgba(0, 0, 0,"+(.5-this.posX/50)+")";ctx.fillRect(0,0,canvas.width,canvas.height);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benStand].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benStand].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benStand].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benStand].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.67,canvas.height-470,bWidth,bHeight);if(saveDataHandler.getCurEnemy(0)==5&&saveDataHandler.getCurEnemy(1)==5&&saveDataHandler.getCurEnemy(2)==5&&saveDataHandler.getCurEnemy(3)==5&&saveDataHandler.getCurEnemy(4)==5){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benCrown].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benCrown].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benCrown].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.benCrown].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.67+140,canvas.height-500,bWidth,bHeight);}
var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,0-this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,canvas.height-bHeight+this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,"chooseAHero")+20+80-this.posY,10,bWidth,bHeight);addText(30,380,"left",20-this.posY,53,"chooseAHero");break;case "versusScreen":ctx.fillStyle="rgba(255, 255, 255, 1)";ctx.fillRect(0,0,canvas.width/2,canvas.height);this.scrollX+=delta*2000;var oWipeImgData=null;var cropWidth;if(levelNum>0||this.evolved){oWipeImgData=assetLib.getData("wipe0");cropWidth=oWipeImgData.img.width;}else{ctx.drawImage(this.oBgImgData.img,0,0,this.oBgImgData.img.width,this.oBgImgData.img.height,canvas.width/4-this.oBgImgData.img.width/2+this.posX,canvas.height/2-this.oBgImgData.img.height/2,this.oBgImgData.img.width,this.oBgImgData.img.height);}
if(oWipeImgData!=null){ctx.drawImage(oWipeImgData.img,0,0,Math.max(canvas.width/2,canvas.width/2+this.scrollX%cropWidth),oWipeImgData.img.height,-this.scrollX%cropWidth,0,Math.max(canvas.width/2,canvas.width/2+this.scrollX%cropWidth),canvas.height);ctx.drawImage(oWipeImgData.img,0,0,Math.max(this.scrollX%cropWidth-(cropWidth-canvas.width/2),.1),oWipeImgData.img.height,cropWidth-this.scrollX%cropWidth,0,Math.max(this.scrollX%cropWidth-(cropWidth-canvas.width/2),.1),canvas.height);}
if(levelNum>0||this.evolved){var oCharImgData=assetLib.getData("char0"+heroId);if(this.resetState==2){ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2-oCharImgData.img.width+this.aHeroCharPos[heroId].x,canvas.height/2-oCharImgData.img.height/2+Math.sin(this.incY/2)*5+this.aHeroCharPos[heroId].y,oCharImgData.img.width,oCharImgData.img.height);}else{ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2-oCharImgData.img.width+this.aHeroCharPos[heroId].x,canvas.height/2-oCharImgData.img.height/2+Math.sin(this.incY/2)*5+this.aHeroCharPos[heroId].y+this.posX*20,oCharImgData.img.width,oCharImgData.img.height);}}else{var oCharImgData=assetLib.getData("charBen");ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2-oCharImgData.img.width+40+this.posX*2,canvas.height/2-oCharImgData.img.height/2+50,oCharImgData.img.width,oCharImgData.img.height);this.flareRot+=delta;ctx.save();ctx.translate(canvas.width/2-122+this.posX*2,canvas.height/2-35);ctx.scale(Math.max(this.flareRot*2-1,0),Math.max(this.flareRot*2-1,0));ctx.globalAlpha=Math.max(this.flareRot*2-1,0);ctx.rotate(this.flareRot);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth/2,-bHeight/2,bWidth,bHeight);ctx.restore();this.evolveTimer+=delta;if(this.evolveTimer>1.5){this.evolved=true;this.evolveAlpha=1;this.evolveEffectScale=2;TweenLite.to(this,.5,{evolveAlpha:0,ease:"Quint.easeIn"});TweenLite.to(this,.75,{evolveEffectScale:0,ease:"Back.easeIn",onComplete:function(){if(audioType==1){music.fade(music.volume(),.25,10);}
addVersusButs();}});}}
ctx.fillStyle="rgba(255, 255, 255, "+this.evolveAlpha+")";ctx.fillRect(0,0,canvas.width/2,canvas.height);if(this.evolveEffectScale>0){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.evolveEffect].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.evolveEffect].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.evolveEffect].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.evolveEffect].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.25-(bWidth/2)*1.2,canvas.height-bHeight*this.evolveEffectScale,bWidth*1.2,bHeight*this.evolveEffectScale);}
ctx.fillStyle="rgba(255, 255, 255, 1)";ctx.fillRect(canvas.width/2,0,canvas.width/2,canvas.height);oWipeImgData=assetLib.getData("wipe1");cropWidth=oWipeImgData.img.width;ctx.drawImage(oWipeImgData.img,Math.max((cropWidth-canvas.width/2)-this.scrollX%cropWidth,0),0,cropWidth,oWipeImgData.img.height,canvas.width/2+Math.max((this.scrollX%cropWidth)-(cropWidth-canvas.width/2),0),0,cropWidth,canvas.height);ctx.drawImage(oWipeImgData.img,Math.min(cropWidth+(cropWidth-canvas.width/2)-this.scrollX%cropWidth,cropWidth-.1),0,cropWidth,oWipeImgData.img.height,canvas.width/2,0,cropWidth,canvas.height);var oCharImgData=assetLib.getData("char1"+aEnemyOrder[levelNum]);if(this.resetState==0){ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2+this.aEnemyCharPos[aEnemyOrder[levelNum]].x,canvas.height/2-oCharImgData.img.height/2-Math.sin(this.incY/2)*5+this.aEnemyCharPos[aEnemyOrder[levelNum]].y,oCharImgData.img.width,oCharImgData.img.height);}else{ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2+this.aEnemyCharPos[aEnemyOrder[levelNum]].x,canvas.height/2-oCharImgData.img.height/2-Math.sin(this.incY/2)*5+this.aEnemyCharPos[aEnemyOrder[levelNum]].y+this.posX*40,oCharImgData.img.width,oCharImgData.img.height);}
var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth*.5,(this.scrollX/4)%canvas.height,bWidth,canvas.height*2);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth*.5,(this.scrollX/4)%canvas.height-canvas.height,bWidth,canvas.height*2);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,0-this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,canvas.height-bHeight+this.posX,canvas.width,bHeight);if(this.posBounceX<50){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2-200-this.posBounceX*3,10,bWidth,bHeight);addText(30,230,"center",canvas.width/2-180-this.posBounceX*3,53,"hero"+heroId);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2+200+this.posBounceX*3,10,bWidth,bHeight);addText(30,230,"center",canvas.width/2+180+this.posBounceX*3,53,"enemy"+aEnemyOrder[levelNum]);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.vs].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.vs].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.vs].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.vs].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2,21-this.posBounceX,bWidth,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar1].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar1].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar1].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar1].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-250,canvas.height-120+this.posBounceX,bWidth,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar0].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar0].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar0].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressBar0].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,Math.min((levelNum+1)*90,bWidth),bHeight,canvas.width/2-250,canvas.height-120+this.posBounceX,Math.min((levelNum+1)*90,bWidth),bHeight);for(var i=0;i<levelNum;i++){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressTick].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressTick].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressTick].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressTick].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-218+i*90,canvas.height-70+this.posBounceX,bWidth,bHeight);}
if(this.incY%10<5){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressHighlight].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressHighlight].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressHighlight].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.progressHighlight].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-254+levelNum*90,canvas.height-122,bWidth,bHeight);}}
break;case "shootingComplete":ctx.fillStyle="rgba(255, 255, 255, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);this.scrollX+=delta*2000;var oWipeImgData=assetLib.getData("wipe0");var cropWidth=oWipeImgData.img.width;ctx.drawImage(oWipeImgData.img,0,0,Math.max(canvas.width/2,canvas.width/2+this.scrollX%cropWidth),oWipeImgData.img.height,-this.scrollX%cropWidth,0,Math.max(canvas.width/2,canvas.width/2+this.scrollX%cropWidth),canvas.height);ctx.drawImage(oWipeImgData.img,0,0,Math.max(this.scrollX%cropWidth-(cropWidth-canvas.width/2),.1),oWipeImgData.img.height,cropWidth-this.scrollX%cropWidth,0,Math.max(this.scrollX%cropWidth-(cropWidth-canvas.width/2),.1),canvas.height);var oWipeImgData=assetLib.getData("wipe1");ctx.drawImage(oWipeImgData.img,Math.max((cropWidth-canvas.width/2)-this.scrollX%cropWidth,0),0,cropWidth,oWipeImgData.img.height,canvas.width/2+Math.max((this.scrollX%cropWidth)-(cropWidth-canvas.width/2),0),0,cropWidth,canvas.height);ctx.drawImage(oWipeImgData.img,Math.min(cropWidth+(cropWidth-canvas.width/2)-this.scrollX%cropWidth,cropWidth-.1),0,cropWidth,oWipeImgData.img.height,canvas.width/2,0,cropWidth,canvas.height);var oCharImgData=assetLib.getData("char0"+heroId);ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2-oCharImgData.img.width+this.aHeroCharPos[heroId].x,canvas.height/2-oCharImgData.img.height/2+Math.sin(this.incY/2)*5+this.aHeroCharPos[heroId].y,oCharImgData.img.width,oCharImgData.img.height);var oCharImgData=assetLib.getData("char1"+aEnemyOrder[levelNum]);ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2+this.aEnemyCharPos[aEnemyOrder[levelNum]].x,canvas.height/2-oCharImgData.img.height/2-Math.sin(this.incY/2)*5+this.aEnemyCharPos[aEnemyOrder[levelNum]].y,oCharImgData.img.width,oCharImgData.img.height);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth*.5,(this.scrollX/4)%canvas.height,bWidth,canvas.height*2);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth*.5,(this.scrollX/4)%canvas.height-canvas.height,bWidth,canvas.height*2);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,0-this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,canvas.height-bHeight+this.posX,canvas.width,bHeight);var temp=1;var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2,10+this.posBounceX*3,bWidth,bHeight);addText(40,330,"center",canvas.width/2,61+this.posBounceX*3,"goalkeepingTime");break;case "goalkeepingComplete":var winStatus=0;if(oGameData.heroScore==oGameData.enemyScore){winStatus=1;}else if(oGameData.heroScore>oGameData.enemyScore){winStatus=2;}
if(winStatus==2){ctx.fillStyle="rgba(255, 255, 255, 1)";ctx.fillRect(0,0,canvas.width/2,canvas.height);ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(canvas.width/2,0,canvas.width,canvas.height);}else{ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width/2,canvas.height);ctx.fillStyle="rgba(255, 255, 255, 1)";ctx.fillRect(canvas.width/2,0,canvas.width,canvas.height);}
this.scrollX+=delta*2000;var oWipeImgData=assetLib.getData("wipe0");var cropWidth=oWipeImgData.img.width;ctx.drawImage(oWipeImgData.img,0,0,Math.max(canvas.width/2,canvas.width/2+this.scrollX%cropWidth),oWipeImgData.img.height,-this.scrollX%cropWidth,0,Math.max(canvas.width/2,canvas.width/2+this.scrollX%cropWidth),canvas.height);ctx.drawImage(oWipeImgData.img,0,0,Math.max(this.scrollX%cropWidth-(cropWidth-canvas.width/2),.1),oWipeImgData.img.height,cropWidth-this.scrollX%cropWidth,0,Math.max(this.scrollX%cropWidth-(cropWidth-canvas.width/2),.1),canvas.height);var oWipeImgData=assetLib.getData("wipe1");ctx.drawImage(oWipeImgData.img,Math.max((cropWidth-canvas.width/2)-this.scrollX%cropWidth,0),0,cropWidth,oWipeImgData.img.height,canvas.width/2+Math.max((this.scrollX%cropWidth)-(cropWidth-canvas.width/2),0),0,cropWidth,canvas.height);ctx.drawImage(oWipeImgData.img,Math.min(cropWidth+(cropWidth-canvas.width/2)-this.scrollX%cropWidth,cropWidth-.1),0,cropWidth,oWipeImgData.img.height,canvas.width/2,0,cropWidth,canvas.height);var heroLoseX=0;var enemyLoseX=0;if(winStatus==2){enemyLoseX=this.loserX;}else if(winStatus==0){heroLoseX=this.loserX;}else if(winStatus==1){heroLoseX=this.loserX;enemyLoseX=this.loserX;}
var oCharImgData=assetLib.getData("char0"+heroId);ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2-oCharImgData.img.width+this.aHeroCharPos[heroId].x,canvas.height/2-oCharImgData.img.height/2+Math.sin(this.incY/2)*5+this.aHeroCharPos[heroId].y+heroLoseX,oCharImgData.img.width,oCharImgData.img.height);var oCharImgData=assetLib.getData("char1"+aEnemyOrder[levelNum]);ctx.drawImage(oCharImgData.img,0,0,oCharImgData.img.width,oCharImgData.img.height,canvas.width/2+this.aEnemyCharPos[aEnemyOrder[levelNum]].x,canvas.height/2-oCharImgData.img.height/2-Math.sin(this.incY/2)*5+this.aEnemyCharPos[aEnemyOrder[levelNum]].y+enemyLoseX,oCharImgData.img.width,oCharImgData.img.height);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth*.5,(this.scrollX/4)%canvas.height,bWidth,canvas.height*2);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.versusMidEffect].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth*.5,(this.scrollX/4)%canvas.height-canvas.height,bWidth,canvas.height*2);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,0-this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,canvas.height-bHeight+this.posX,canvas.width,bHeight);var temp=1;if(winStatus==2){temp=0;}
var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds["textPanel"+temp]].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2,10+this.posBounceX*3,bWidth,bHeight);addText(40,330,"center",canvas.width/2,61+this.posBounceX*3,"result"+winStatus);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall0].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2-181-this.posBounceX*3-oGameData.heroScore.toString().length*this.scoreNumberSpace,canvas.height-70,bWidth,bHeight);addText(30,230,"center",canvas.width/2-161-this.posBounceX*3-oGameData.heroScore.toString().length*this.scoreNumberSpace,canvas.height-27,"hero"+heroId);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBall1].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2+187+this.posBounceX*3+oGameData.enemyScore.toString().length*this.scoreNumberSpace,canvas.height-70,bWidth,bHeight);addText(30,230,"center",canvas.width/2+167+this.posBounceX*3+oGameData.enemyScore.toString().length*this.scoreNumberSpace,canvas.height-27,"enemy"+aEnemyOrder[levelNum]);var tempScore=oGameData.heroScore.toString();var tempScale=1;for(var i=0;i<tempScore.length;i++){var id=parseFloat(tempScore.charAt(i));var imgX=(id*this.oScoreNumbersImgData.oData.spriteWidth)%this.oScoreNumbersImgData.img.width;var imgY=Math.floor(id/(this.oScoreNumbersImgData.img.width/this.oScoreNumbersImgData.oData.spriteWidth))*this.oScoreNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oScoreNumbersImgData.img,imgX,imgY,this.oScoreNumbersImgData.oData.spriteWidth,this.oScoreNumbersImgData.oData.spriteHeight,canvas.width/2+i*(this.scoreNumberSpace*tempScale)-25-tempScore.length*this.scoreNumberSpace,canvas.height-70-this.posY,this.oScoreNumbersImgData.oData.spriteWidth*tempScale,this.oScoreNumbersImgData.oData.spriteHeight*tempScale);}
var id=10;var imgX=(id*this.oScoreNumbersImgData.oData.spriteWidth)%this.oScoreNumbersImgData.img.width;var imgY=Math.floor(id/(this.oScoreNumbersImgData.img.width/this.oScoreNumbersImgData.oData.spriteWidth))*this.oScoreNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oScoreNumbersImgData.img,imgX,imgY,this.oScoreNumbersImgData.oData.spriteWidth,this.oScoreNumbersImgData.oData.spriteHeight,canvas.width/2-25,canvas.height-70-this.posY,this.oScoreNumbersImgData.oData.spriteWidth*tempScale,this.oScoreNumbersImgData.oData.spriteHeight*tempScale);var tempScore=oGameData.enemyScore.toString();var tempScale=1;for(var i=0;i<tempScore.length;i++){var id=parseFloat(tempScore.charAt(i));var imgX=(id*this.oScoreNumbersImgData.oData.spriteWidth)%this.oScoreNumbersImgData.img.width;var imgY=Math.floor(id/(this.oScoreNumbersImgData.img.width/this.oScoreNumbersImgData.oData.spriteWidth))*this.oScoreNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oScoreNumbersImgData.img,imgX,imgY,this.oScoreNumbersImgData.oData.spriteWidth,this.oScoreNumbersImgData.oData.spriteHeight,canvas.width/2+i*(this.scoreNumberSpace*tempScale)+17,canvas.height-70-this.posY,this.oScoreNumbersImgData.oData.spriteWidth*tempScale,this.oScoreNumbersImgData.oData.spriteHeight*tempScale);}
break;case "shooting":if(showingTut){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,"howToShoot")+20+80-this.posY,10,bWidth,bHeight);addText(30,380,"left",20-this.posY,53,"howToShoot");}
break;case "goalkeeping":if(showingTut){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,"howToSave")+20+80-this.posY,10,bWidth,bHeight);addText(30,380,"left",20-this.posY,53,"howToSave");}
break;case "pause":ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(this.oBgImgData.img,0,0,this.oBgImgData.img.width,this.oBgImgData.img.height,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2,this.oBgImgData.img.width,this.oBgImgData.img.height);ctx.fillStyle="rgba(0, 0, 0,"+(.5-this.posX/50)+")";ctx.fillRect(0,0,canvas.width,canvas.height);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameTop].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,0-this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.blackFrameBottom].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,0,canvas.height-bHeight+this.posX,canvas.width,bHeight);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,"paused")+20+80-this.posY,10,bWidth,bHeight);addText(30,380,"left",20-this.posY,53,"paused");break;case "rotated":var oRotateBgImgData=assetLib.getData("rotateBg");var oRotateIconImgData=assetLib.getData("rotateIcon");ctx.drawImage(oRotateBgImgData.img,0,0,oRotateBgImgData.img.width,oRotateBgImgData.img.height,0,0,canvas.width,canvas.height);ctx.fillStyle="rgba(0, 0, 0, .25)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(oRotateIconImgData.img,canvas.width/2-oRotateIconImgData.img.width/2,canvas.height/2-oRotateIconImgData.img.height/2);break;}
if(_butsOnTop){this.addButs(ctx);}
if(gameState=="charSelect"){this.renderCrowns();}};Panel.prototype.renderCrowns=function(){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.crown].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.crown].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.crown].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.crown].height;if(saveDataHandler.getCurEnemy(0)==5){ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.43-214+50+this.posY,canvas.height*.5-70-80,bWidth,bHeight);}
if(saveDataHandler.getCurEnemy(1)==5){ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.43+50+this.posY,canvas.height*.5-70-80,bWidth,bHeight);}
if(saveDataHandler.getCurEnemy(2)==5){ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.43+214+50+this.posY,canvas.height*.5-70-80,bWidth,bHeight);}
if(saveDataHandler.getCurEnemy(3)==5){ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.43-107+50+this.posY,canvas.height*.5+105-80,bWidth,bHeight);}
if(saveDataHandler.getCurEnemy(4)==5){ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width*.43+107+50+this.posY,canvas.height*.5+105-80,bWidth,bHeight);}};Panel.prototype.addButs=function(ctx){var aButOver=false;for(var i=0;i<this.aButs.length;i++){if(this.aButs[i].isOver){aButOver=true;}}
for(var i=0;i<this.aButs.length;i++){var offsetPosY=this.posY;var floatY=0;if(this.incY!=0&&this.aButs[i].flash){if(this.aButs[i].isOver){floatY=Math.sin((this.incY+i*25)*2)*3;}else{floatY=Math.sin(this.incY+i*25)*3;}}
if(i%2==0){}
if(!this.aButs[i].scale){this.aButs[i].scale=1;}
var bX;var bY;var bWidth;var bHeight;bX=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].id].x;bY=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].id].y;bWidth=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].id].width;bHeight=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].id].height;var aX=getSafeWidth(canvas.width*this.aButs[i].align[0]);var aY=getSafeHeight(canvas.height*this.aButs[i].align[1]);this.aButs[i].aOverData=new Array(aX+this.aButs[i].aPos[0]-(bWidth/2)*(this.aButs[i].scale)+offsetPosY-floatY/2,aY+this.aButs[i].aPos[1]-(bHeight/2)*(this.aButs[i].scale)+floatY/2,aX+this.aButs[i].aPos[0]+(bWidth/2)*(this.aButs[i].scale)+offsetPosY-floatY/2,aY+this.aButs[i].aPos[1]+(bHeight/2)*(this.aButs[i].scale)+floatY/2);if(this.aButs[i].isOver&&this.aButs[i].flash){ctx.save();ctx.translate(aX+this.aButs[i].aPos[0],aY+this.aButs[i].aPos[1]);ctx.scale(1.5,1);ctx.globalAlpha=1;ctx.rotate(this.incY/12);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.flare].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth/2,-bHeight/2,bWidth,bHeight);ctx.restore();}
ctx.drawImage(this.aButs[i].oImgData.img,bX,bY,bWidth,bHeight,this.aButs[i].aOverData[0],this.aButs[i].aOverData[1],bWidth*(this.aButs[i].scale)+floatY,bHeight*(this.aButs[i].scale)-floatY);if(this.aButs[i].isOver||this.aButs[i].flash){ctx.save();if(this.aButs[i].isOver){ctx.globalAlpha=1;}else{if(aButOver){ctx.globalAlpha=Math.max(Math.sin(this.incY/2),0)/2;}else{ctx.globalAlpha=Math.max(Math.sin(this.incY/2),0);}}
bX=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].idOver].x;bY=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].idOver].y;bWidth=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].idOver].width;bHeight=this.aButs[i].oImgData.oData.oAtlasData[this.aButs[i].idOver].height;ctx.drawImage(this.aButs[i].oImgData.img,bX,bY,bWidth,bHeight,this.aButs[i].aOverData[0],this.aButs[i].aOverData[1],bWidth*(this.aButs[i].scale)+floatY,bHeight*(this.aButs[i].scale)-floatY);ctx.restore();}}};return Panel;})();Elements.Panel=Panel;})(Elements||(Elements={}));var Utils;(function(Utils){var TextDisplay=(function(){function TextDisplay(){this.oTextData={};this.inc=0;this.createTextObjects();}
TextDisplay.prototype.createTextObjects=function(){var cnt=0;for(var i in assetLib.textData.langText.text[curLang]){this.oTextData[i]={};this.oTextData[i].aLineData=this.getCharData(assetLib.textData.langText.text[curLang][i]["@text"],assetLib.textData.langText.text[curLang][i]["@fontId"]);this.oTextData[i].aLineWidths=this.getLineWidths(this.oTextData[i].aLineData);this.oTextData[i].blockWidth=this.getBlockWidth(this.oTextData[i].aLineData);this.oTextData[i].blockHeight=this.getBlockHeight(this.oTextData[i].aLineData,assetLib.textData.langText.text[curLang][i]["@fontId"]);this.oTextData[i].lineHeight=parseInt(assetLib.textData["fontData"+assetLib.textData.langText.text[curLang][i]["@fontId"]].text.common["@lineHeight"]);this.oTextData[i].oFontImgData=assetLib.getData("font"+assetLib.textData.langText.text[curLang][i]["@fontId"]);}};TextDisplay.prototype.getLineWidths=function(_aCharData){var lineLength;var aLineWidths=new Array();for(var i=0;i<_aCharData.length;i++){lineLength=0;for(var j=0;j<_aCharData[i].length;j++){lineLength+=parseInt(_aCharData[i][j]["@xadvance"]);if(j==0){lineLength-=parseInt(_aCharData[i][j]["@xoffset"]);}else if(j==_aCharData[i].length-1){lineLength+=parseInt(_aCharData[i][j]["@xoffset"]);}}
aLineWidths.push(lineLength);}
return aLineWidths;};TextDisplay.prototype.getBlockWidth=function(_aCharData){var lineLength;var longestLineLength=0;for(var i=0;i<_aCharData.length;i++){lineLength=0;for(var j=0;j<_aCharData[i].length;j++){lineLength+=parseInt(_aCharData[i][j]["@xadvance"]);if(j==0){lineLength-=parseInt(_aCharData[i][j]["@xoffset"]);}else if(j==_aCharData[i].length-1){lineLength+=parseInt(_aCharData[i][j]["@xoffset"]);}}
if(lineLength>longestLineLength){longestLineLength=lineLength;}}
return longestLineLength;};TextDisplay.prototype.getBlockHeight=function(_aCharData,_fontId){return _aCharData.length*parseInt(assetLib.textData["fontData"+_fontId].text.common["@lineHeight"]);};TextDisplay.prototype.getCharData=function(_aLines,_fontId){var aCharData=new Array();for(var k=0;k<_aLines.length;k++){aCharData[k]=new Array();for(var i=0;i<_aLines[k].length;i++){for(var j=0;j<assetLib.textData["fontData"+_fontId].text.chars.char.length;j++){if(_aLines[k][i].charCodeAt()==assetLib.textData["fontData"+_fontId].text.chars.char[j]["@id"]){aCharData[k].push(assetLib.textData["fontData"+_fontId].text.chars.char[j]);}}}}
return aCharData;};TextDisplay.prototype.renderText=function(_oTextDisplayData){var aLinesToRender=this.oTextData[_oTextDisplayData.text].aLineData;var oFontImgData=this.oTextData[_oTextDisplayData.text].oFontImgData;var shiftX;var offsetX=0;var offsetY=0;var lineOffsetY=0;var manualScale=1;var animY=0;if(_oTextDisplayData.lineOffsetY){lineOffsetY=_oTextDisplayData.lineOffsetY;}
if(_oTextDisplayData.scale){manualScale=_oTextDisplayData.scale;}
var textScale=1*manualScale;if(_oTextDisplayData.maxWidth&&this.oTextData[_oTextDisplayData.text].blockWidth*manualScale>_oTextDisplayData.maxWidth){textScale=_oTextDisplayData.maxWidth/this.oTextData[_oTextDisplayData.text].blockWidth;}
if(_oTextDisplayData.anim){this.inc+=delta*7;}
for(var i=0;i<aLinesToRender.length;i++){shiftX=0;if(_oTextDisplayData.alignX=="centre"){offsetX=this.oTextData[_oTextDisplayData.text].aLineWidths[i]/2;}
if(_oTextDisplayData.alignY=="centre"){offsetY=this.oTextData[_oTextDisplayData.text].blockHeight/2+(lineOffsetY*(aLinesToRender.length-1))/2;}
for(var j=0;j<aLinesToRender[i].length;j++){var bX=aLinesToRender[i][j]["@x"];var bY=aLinesToRender[i][j]["@y"];var bWidth=aLinesToRender[i][j]["@width"];var bHeight=aLinesToRender[i][j]["@height"];if(_oTextDisplayData.anim){animY=Math.sin(this.inc+j/2)*((bHeight/15)*textScale);}
ctx.drawImage(oFontImgData.img,bX,bY,bWidth,bHeight,_oTextDisplayData.x+(shiftX+parseInt(aLinesToRender[i][j]["@xoffset"])-offsetX)*textScale,_oTextDisplayData.y+(parseInt(aLinesToRender[i][j]["@yoffset"])+(i*this.oTextData[_oTextDisplayData.text].lineHeight)+(i*lineOffsetY)-offsetY)*textScale+animY,bWidth*textScale,bHeight*textScale);shiftX+=parseInt(aLinesToRender[i][j]["@xadvance"]);}}};return TextDisplay;})();Utils.TextDisplay=TextDisplay;})(Utils||(Utils={}));var __extends=this.__extends||function(d,b){function __(){this.constructor=d;}
__.prototype=b.prototype;d.prototype=new __();};var Elements;(function(Elements){var Firework=(function(_super){__extends(Firework,_super);function Firework(_oImgData,_animId,_shouldFall,_frameRate){if(typeof _frameRate==="undefined"){_frameRate=25;}
_super.call(this,_oImgData,_frameRate,45,_animId);this.setAnimType("once",_animId);this.shouldFall=_shouldFall;this.animEndedFunc=function(){this.removeMe=true;};}
Firework.prototype.moveSideways=function(_dir){if(_dir=="left"){TweenLite.to(this,(1/this.fps)*this.oAnims[this.animId].length,{x:this.x+70*this.scaleX,ease:"Quad.easeOut"});}else if(_dir=="right"){TweenLite.to(this,(1/this.fps)*this.oAnims[this.animId].length,{x:this.x-70*this.scaleX,ease:"Quad.easeOut"});}};Firework.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);if(this.shouldFall){this.y+=100*delta;}};Firework.prototype.render=function(){_super.prototype.renderSimple.call(this,ctx);};return Firework;})(Utils.AnimSprite);Elements.Firework=Firework;})(Elements||(Elements={}));var Elements;(function(Elements){var Ball=(function(){function Ball(){this.rot=0;this.height=0;this.scale=1;this.power=0;this.maxSwipeLength=30;this.shootState=0;this.maxStartY=560;this.minStartY=360;this.leftPostX=-248;this.rightPostX=248;this.crossBarY=-155;this.crossBarHeight=191;this.bannerHeight=41;this.fixedBallRadius=80;this.ballScale=1;this.powerAreaFrame=0;this.powerAreaFrameInc=0;this.powerRadius=40;this.isGoldBall=false;this.showPowerArea=false;this.isSaved=false;this.hideMe=false;this.shownMissFar=false;this.shownSaved=false;this.oGameElementsImgData=assetLib.getData("gameElements");this.oPowerAreaImgData=assetLib.getData("powerArea");this.oBallImgData=assetLib.getData("ball");this.oGoldBallImgData=assetLib.getData("goldBall");if(isMobile){this.platformMultiplier=1.0;}else{this.platformMultiplier=1.0;}
this.reset();this.setPowerArea();}
Ball.prototype.killTweens=function(){if(this.jiggleTween){this.jiggleTween.kill();}
if(this.curlTween){this.curlTween.kill();}
if(this.ricochetTween){this.ricochetTween.kill();}};Ball.prototype.pause=function(_isOn){if(_isOn){if(this.jiggleTween&&this.jiggleTween.isActive()){this.jiggleTween.pause();}
if(this.curlTween&&this.curlTween.isActive()){this.curlTween.pause();}
if(this.ricochetTween&&this.ricochetTween.isActive()){this.ricochetTween.pause();}}else{if(this.jiggleTween&&this.jiggleTween.paused()){this.jiggleTween.resume();}
if(this.curlTween&&this.curlTween.paused()){this.curlTween.resume();}
if(this.ricochetTween&&this.ricochetTween.paused()){this.ricochetTween.resume();}}};Ball.prototype.reset=function(){if(this.jiggleTween){this.jiggleTween.kill();}
if(this.curlTween){this.curlTween.kill();}
if(this.ricochetTween){this.ricochetTween.kill();}
this.hideMe=false;this.shootState=0;this.power=0;this.scale=1;this.shadowAlpha=0;this.height=0;this.aTouchData=new Array();this.hitLeftPost=false;this.hitRightPost=false;this.hitCrossBar=false;this.inGoal=false;wipe.inGoal=false;this.hitBackOfNet=false;this.hitSideOfNet=false;this.trailInc=0;this.aTrail=new Array();this.ballFrame=0;this.rot=0;this.initialRot=0;this.incX=0;this.incY=0;this.ballScale=1;this.ballFrameTarg=0;this.powerAreaFrame=0;this.powerAreaFrameInc=0;this.isSaved=false;this.hasHitPowerArea=false;oGameData.ballInPlay=false;if(Math.random()>.75){this.showPowerArea=true;this.setPowerArea();}else{if(this.showPowerArea){this.hidePowerArea();}}
if(hud.powerMaxxed){this.isGoldBall=true;hud.powerMaxxed=false;}else{this.isGoldBall=false;}
this.ballRollX=-500;TweenLite.to(this,.7,{ballRollX:0,ease:"Cubic.easeOut"});};Ball.prototype.setPowerArea=function(){this.powerAreaScale=0;TweenLite.to(this,2,{powerAreaScale:1,ease:"Elastic.easeOut"});var temp=Math.random()*3;if(temp>2){this.powerAreaX=-203;this.powerAreaY=Math.random()*105+10;}else if(temp>1){this.powerAreaX=203;this.powerAreaY=Math.random()*105+10;}else{this.powerAreaX=Math.random()*406-203;this.powerAreaY=115;}
this.hasHitPowerArea=false;};Ball.prototype.hidePowerArea=function(){var _this=this;TweenLite.to(this,.5,{powerAreaScale:0,ease:"Back.easeIn",onComplete:function(){_this.showPowerArea=false;}});};Ball.prototype.ballJiggle=function(_inc){if(this.jiggleTween){this.jiggleTween.kill();}
this.initialRot=0;this.ballScale=_inc;this.jiggleTween=TweenLite.to(this,1,{ballScale:1,ease:"Elastic.easeOut"});};Ball.prototype.ballKickStretch=function(){if(this.jiggleTween){this.jiggleTween.kill();}
this.ballScale=.5;this.jiggleTween=TweenLite.to(this,.3,{ballScale:1,ease:"Quad.easeOut"});};Ball.prototype.isForwardKick=function(){var b=0;for(var i=0;i<this.aTouchData.length-1;i++){b+=this.aTouchData[i+1].y-this.aTouchData[i].y;}
if(b<0){return true;}else{return false;}};Ball.prototype.shootPrep=function(){var a;var b;for(var i=0;i<this.aTouchData.length-1;i++){a=this.aTouchData[i+1].x-this.aTouchData[i].x;b=this.aTouchData[i+1].y-this.aTouchData[i].y;this.power+=Math.sqrt(a*a+b*b);}
this.power=this.power/((oGameData.swipeTime/this.aTouchData.length)*100)*1.4;a=this.aTouchData[0].x-this.aTouchData[Math.min(Math.round(this.maxSwipeLength/2),this.aTouchData.length-1)].x;b=this.aTouchData[0].y-this.aTouchData[Math.min(Math.round(this.maxSwipeLength/2),this.aTouchData.length-1)].y;this.shootAngle=Math.atan2(b,a);this.power*=(this.maxSwipeLength/this.aTouchData.length);this.power=Math.min(this.power+1200,4000)*this.platformMultiplier;if(this.isGoldBall){this.power=4000;playSound("powerKick");}else{playSound("kick"+Math.floor(Math.random()*3));}
this.incX=Math.cos(this.shootAngle)*-this.power;this.incY=(Math.sin(this.shootAngle)*-this.power)*Math.min(((this.startY-canvas.height/2)/(this.maxStartY-canvas.height/2)),1);oGameData.ballInPlay=true;hud.heroKick.takeShot(Math.cos(this.shootAngle),this.incY);};Ball.prototype.shoot=function(){this.initialRot=(this.shootAngle-(90*radian))/2;this.ballKickStretch();this.incHeight=Math.max((this.power-500)*1.2,Math.random()*200+800)*(.5+((90-(Math.abs((this.shootAngle/radian)-90)))/90)/2);if(this.isGoldBall){this.incHeight=2000;}
if(this.incHeight>2100){}
var a=this.aTouchData[Math.min(Math.round(this.aTouchData.length/2),this.aTouchData.length-1)].x-this.aTouchData[this.aTouchData.length-1].x;var b=this.aTouchData[Math.min(Math.round(this.aTouchData.length/2),this.aTouchData.length-1)].y-this.aTouchData[this.aTouchData.length-1].y;var tempCurl=Math.atan2(b,a)-this.shootAngle;if(tempCurl>180*radian){tempCurl-=360*radian;}else if(tempCurl<-180*radian){tempCurl+=360*radian;}
tempCurl*=(Math.max(this.incHeight-800,0));if(this.curlTween){this.curlTween.kill();}
this.curlX=0;this.curlTween=TweenLite.to(this,.3,{delay:.1,curlX:Math.max(Math.min(tempCurl,450),-450),ease:"Quad.easeIn"});this.shootState=1;this.aTrail.push({x:this.x,y:this.y,scale:this.scale});screenShake(10);addExplosion(0,this.x,this.y-this.height*this.scale,3);if(this.isGoldBall){addSpray("left",canvas.width/2+160,canvas.height-46,2);addSpray("right",canvas.width/2-160,canvas.height-46,2);}};Ball.prototype.update=function(){var _this=this;if(this.shootState==0){this.x=canvas.width/2+this.ballRollX;this.y=this.startY=getSafeHeight(canvas.height)-50;this.ballRadius=this.fixedBallRadius*this.scale;this.ballScale=1;}else if(this.shootState==1){this.x+=(this.incX*this.scale*this.scale)*delta;this.y+=(this.incY*this.scale*this.scale)*delta;this.x+=(this.curlX*this.scale)*delta;if(!this.isGoldBall||(this.isGoldBall&&this.y<canvas.height/2+35)){this.incHeight-=4000*delta;}
this.height+=this.incHeight*delta;if(this.height<=0){this.height=0;this.incHeight*=-.6;var temp=1-this.incHeight/7000;if(this.incHeight>200){playSound("bounce"+Math.floor(Math.random()*5));}
if(temp<.95){this.ballJiggle(temp);}}
this.scale=(this.y-(canvas.height/2+25))/(this.startY-(canvas.height/2+25))*.75+.25;this.trailInc+=delta;if(this.trailInc>.05){if(this.aTrail.length>10){this.aTrail.shift();}
this.aTrail.push({x:this.x,y:this.y-this.height*this.scale,scale:this.scale});this.trailInc=0;}
this.shadowAlpha=Math.floor(Math.min((this.height)/500,.9)*10);this.ballRadius=this.fixedBallRadius*this.scale;if(!this.hitLeftPost&&!this.isSaved&&!wipe.canDisplay&&this.y<canvas.height/2+35-this.ballRadius&&this.y>canvas.height/2+30-this.ballRadius&&this.height*this.scale+this.ballRadius<this.crossBarHeight&&this.x>canvas.width/2+this.leftPostX-(this.ballRadius+5)&&this.x<canvas.width/2+this.leftPostX+(this.ballRadius+5)){playSound("hitBar");var reboundAngle=(((canvas.width/2+this.leftPostX)-this.x)/(this.ballRadius+5)+.5)*180-(90-this.shootAngle/radian)/10;addFirework(0,canvas.width/2+this.leftPostX-(((canvas.width/2+this.leftPostX)-this.x)/(this.ballRadius+5))*10,this.y-this.height*this.scale+this.ballRadius,.3,false);this.incX=(this.power*Math.cos(reboundAngle*radian))*4;this.incY=(this.power*Math.sin(reboundAngle*radian));if(this.incY>0){this.incY*=.1;}else{this.incY*=.6;}
this.x+=(this.incX*this.scale*this.scale)*delta;this.y+=(this.incY*this.scale*this.scale)*delta;this.hitLeftPost=true;if(this.ricochetTween){this.ricochetTween.kill();}
this.isGoldBall=false;this.ricochetTween=TweenLite.to(this,2,{incX:this.incX*.25,incY:this.incY*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){wipe.trigger(resetShooting);return;}});}
if(!this.hitRightPost&&!this.isSaved&&!wipe.canDisplay&&this.y<canvas.height/2+35-this.ballRadius&&this.y>canvas.height/2+30-this.ballRadius&&this.height*this.scale+this.ballRadius<this.crossBarHeight&&this.x>canvas.width/2+this.rightPostX-(this.ballRadius+5)&&this.x<canvas.width/2+this.rightPostX+(this.ballRadius+5)){playSound("hitBar");var reboundAngle=(((canvas.width/2+this.rightPostX)-this.x)/(this.ballRadius+5)+.5)*180-(90-this.shootAngle/radian)/10;addFirework(0,canvas.width/2+this.rightPostX-(((canvas.width/2+this.rightPostX)-this.x)/(this.ballRadius+5))*10,this.y-this.height*this.scale+this.ballRadius,.3,false);this.incX=(this.power*Math.cos(reboundAngle*radian))*4;this.incY=(this.power*Math.sin(reboundAngle*radian));if(this.incY>0){this.incY*=.1;}else{this.incY*=.6;}
this.x+=(this.incX*this.scale*this.scale)*delta;this.y+=(this.incY*this.scale*this.scale)*delta;this.hitRightPost=true;if(this.ricochetTween){this.ricochetTween.kill();}
this.isGoldBall=false;this.ricochetTween=TweenLite.to(this,2,{incX:this.incX*.25,incY:this.incY*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){wipe.trigger(resetShooting);return;}});}
if(!this.isSaved&&!this.inGoal&&!wipe.canDisplay&&this.y<canvas.height/2+32-this.ballRadius&&this.y>canvas.height/2+26-this.ballRadius&&this.height*this.scale+this.ballRadius<this.crossBarHeight-this.ballRadius&&this.x>canvas.width/2+this.leftPostX+(this.ballRadius)&&this.x<canvas.width/2+this.rightPostX-(this.ballRadius)){addGoalMarker(0,this.x,this.y-this.height*this.scale,this.scale);this.inGoal=true;wipe.inGoal=true;playSound("heroScore");playSound("crowdGood"+Math.floor(Math.random()*3));if(this.x>(canvas.width/2+this.powerAreaX)-38&&this.x<(canvas.width/2+this.powerAreaX)+38&&(this.y-this.height*this.scale)>(canvas.height/2-this.powerAreaY)-38&&(this.y-this.height*this.scale)<(canvas.height/2-this.powerAreaY)+38&&this.showPowerArea){this.hasHitPowerArea=true;TweenLite.to(this,.5,{powerAreaX:-canvas.width/2+50,powerAreaY:canvas.height/2-30,powerAreaScale:.5,ease:"Back.easeIn",onComplete:function(){_this.powerAreaScale=0;oGameData.curTime+=500;addFirework(0,50,30,1);hud.jiggleTimer();}});}
userScored();this.isGoldBall=false;}
if(!this.hitLeftPost&&!this.hitRightPost&&!this.isSaved&&!this.inGoal&&!wipe.canDisplay&&this.y<canvas.height/2+35-this.ballRadius&&this.y>canvas.height/2+30-this.ballRadius&&this.height*this.scale+this.ballRadius<this.crossBarHeight-this.ballRadius&&this.x>canvas.width/2+this.leftPostX+(this.ballRadius)&&this.x<canvas.width/2+this.rightPostX-(this.ballRadius)&&enemySave.checkBallHit(this.x,this.y-this.height*this.scale)){playSound("enemySave");playSound("crowdBad"+Math.floor(Math.random()*2));this.isSaved=true;addExplosion(0,this.x,this.y-this.height*this.scale+this.ballRadius,1);this.incY=-this.incY/5;this.incX*=5;this.isGoldBall=false;if(this.x>(canvas.width/2+this.powerAreaX)-38&&this.x<(canvas.width/2+this.powerAreaX)+38&&(this.y-this.height*this.scale)>(canvas.height/2-this.powerAreaY)-38&&(this.y-this.height*this.scale)<(canvas.height/2-this.powerAreaY)+38&&this.showPowerArea){this.hasHitPowerArea=true;TweenLite.to(this,.5,{powerAreaX:-canvas.width/2+50,powerAreaY:canvas.height/2-30,powerAreaScale:.5,ease:"Back.easeIn",onComplete:function(){_this.powerAreaScale=0;oGameData.curTime+=500;addFirework(0,50,30,1);hud.jiggleTimer();}});}
if(this.ricochetTween){this.ricochetTween.kill();}
if(this.hasHitPowerArea){hud.showTextEvent("bonusTime");}else if(!this.shownSaved){hud.showTextEvent("shotSaved");this.shownSaved=true;}
if(!this.hideMe){this.ricochetTween=TweenLite.to(this,1.5,{incY:this.incY*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){wipe.trigger(resetShooting);return;}});}else{this.ricochetTween=TweenLite.to(this,1,{incY:this.incY*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){if(!_this.shownSaved){hud.showTextEvent("shotSaved");_this.shownSaved=true;}
wipe.trigger(resetShooting);return;}});}}
if(!this.hitBackOfNet&&!wipe.canDisplay&&this.inGoal&&this.y<(canvas.height/2+18)-this.ballRadius){this.hitBackOfNet=true;this.incY=0;this.incHeight=0;if(this.ricochetTween){this.ricochetTween.kill();}
if(this.curlTween){this.curlTween.kill();}
this.curlX=0;this.isGoldBall=false;this.ricochetTween=TweenLite.to(this,1,{incX:this.incX*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){wipe.trigger(resetShooting);return;}});}
if(!this.hitSideOfNet&&!wipe.canDisplay&&this.inGoal&&this.x<canvas.width/2+this.leftPostX+36){this.hitSideOfNet=true;if(this.ricochetTween){this.ricochetTween.kill();}
this.incX=Math.abs(this.incX);this.y+=(this.incY*this.scale*this.scale)*delta;if(this.curlTween){this.curlTween.kill();}
this.curlX=0;this.isGoldBall=false;this.ricochetTween=TweenLite.to(this,1,{incX:this.incX*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){wipe.trigger(resetShooting);return;}});}
if(!this.hitSideOfNet&&!wipe.canDisplay&&this.inGoal&&this.x>canvas.width/2+this.rightPostX-36){this.hitSideOfNet=true;if(this.ricochetTween){this.ricochetTween.kill();}
this.incX=Math.abs(this.incX)*-1;this.x+=(this.incX*this.scale*this.scale)*delta;if(this.curlTween){this.curlTween.kill();}
this.curlX=0;this.isGoldBall=false;this.ricochetTween=TweenLite.to(this,1,{incX:this.incX*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){wipe.trigger(resetShooting);return;}});}
if(!this.hitCrossBar&&!this.isSaved&&!wipe.canDisplay&&this.y<canvas.height/2+35-this.ballRadius&&this.y>canvas.height/2+30-this.ballRadius&&this.height*this.scale+this.ballRadius>this.crossBarHeight-(this.ballRadius+5)&&this.height*this.scale+this.ballRadius<this.crossBarHeight+(this.ballRadius+5)&&this.x>canvas.width/2+this.leftPostX&&this.x<canvas.width/2+this.rightPostX){this.hitCrossBar=true;playSound("hitBar");var reboundAngle=((this.crossBarHeight)-(this.height*this.scale+this.ballRadius))/(this.ballRadius+5);addFirework(0,this.x,canvas.height/2+this.crossBarY+reboundAngle*10,.3,false);this.isGoldBall=false;if(Math.abs(reboundAngle)>.5){this.incY*=((Math.abs(reboundAngle)-.5)/.5)*.6+.1;if(reboundAngle>0){this.incHeight+=((.5-reboundAngle)+.5+.1)*-8000;}else{this.incHeight+=(.5+(reboundAngle+.5)+.1)*5000;}}else{this.incY*=-(1-(Math.abs(reboundAngle))/.5)*.1-.1;if(reboundAngle>0){this.incHeight+=((reboundAngle)-.1)*-8000;}else{this.incHeight+=(reboundAngle-.1)*5000;}}
this.y+=(this.incY*this.scale*this.scale)*delta;if(this.ricochetTween){this.ricochetTween.kill();}
this.ricochetTween=TweenLite.to(this,2,{incY:this.incY*.25,curlX:0,ease:"Quad.easeIn",onComplete:function(){wipe.trigger(resetShooting);return;}});}
if(this.inGoal&&this.height*this.scale+this.ballRadius>this.crossBarHeight-this.ballRadius){this.incHeight*=-1;}
if(!this.inGoal&&!this.isSaved&&!wipe.canDisplay&&((this.y<canvas.height/2-this.ballRadius+10&&this.height*this.scale<this.bannerHeight)||this.x>canvas.width+100||this.x<-100)){playSound("missShotWipe");wipe.trigger(resetShooting);return;}}};Ball.prototype.render=function(){if(!this.inGoal&&this.y<canvas.height/2+30-this.ballRadius){this.renderBall();this.renderGoal();enemySave.render();this.renderPowerArea();}else{if(this.y<canvas.height/2+30-this.ballRadius){this.renderGoal();this.renderBall();enemySave.render();this.renderPowerArea();}else{this.renderGoal();enemySave.render();this.renderPowerArea();this.renderBall();}}
var tempRot0;var tempRot1;var temp90=90*radian;var hyp0;var hyp1;var a;var b;if(this.aTouchData.length>1){for(var i=0;i<this.aTouchData.length-1;i++){if(this.aTouchData[i].alpha>0){a=this.aTouchData[i+1].x-this.aTouchData[i].x;b=this.aTouchData[i+1].y-this.aTouchData[i].y;tempRot0=Math.atan2(b,a);hyp0=Math.sin(((i/this.aTouchData.length)*180)*radian)*(80*this.aTouchData[i].alpha);if(i<this.aTouchData.length-2){a=this.aTouchData[i+2].x-this.aTouchData[i+1].x;b=this.aTouchData[i+2].y-this.aTouchData[i+1].y;tempRot1=Math.atan2(b,a);hyp1=Math.sin((((i+1)/this.aTouchData.length)*180)*radian)*(80*this.aTouchData[i+1].alpha);}else{tempRot1=tempRot0;hyp1=0;}
ctx.fillStyle="rgba(0, 0, 0, "+this.aTouchData[i].alpha+")";ctx.beginPath();ctx.moveTo(this.aTouchData[i].x-hyp0*Math.cos(tempRot0+temp90),this.aTouchData[i].y-hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.lineTo(this.aTouchData[i+1].x-hyp1*Math.cos(tempRot1+temp90),this.aTouchData[i+1].y-hyp1*Math.sin(tempRot1+temp90)+shakeY);ctx.lineTo(this.aTouchData[i+1].x+hyp1*Math.cos(tempRot1+temp90),this.aTouchData[i+1].y+hyp1*Math.sin(tempRot1+temp90)+shakeY);ctx.lineTo(this.aTouchData[i].x+hyp0*Math.cos(tempRot0+temp90),this.aTouchData[i].y+hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.lineTo(this.aTouchData[i].x-hyp0*Math.cos(tempRot0+temp90),this.aTouchData[i].y-hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.closePath();ctx.fill();this.aTouchData[i].alpha-=delta*.5;}}}};Ball.prototype.renderBall=function(){if(!this.hideMe){if(this.aTrail.length>1){var tempRot0;var tempRot1;var temp90=90*radian;var hyp0;var hyp1;var a;var b;for(var i=0;i<this.aTrail.length-1;i++){a=this.aTrail[i+1].x-this.aTrail[i].x;b=this.aTrail[i+1].y-this.aTrail[i].y;tempRot0=Math.atan2(b,a);hyp0=this.aTrail[i].scale*80;if(i<this.aTrail.length-2){a=this.aTrail[i+2].x-this.aTrail[i+1].x;b=this.aTrail[i+2].y-this.aTrail[i+1].y;tempRot1=Math.atan2(b,a);}else{tempRot1=tempRot0;}
hyp1=this.aTrail[i+1].scale*80;if(!this.isGoldBall){ctx.fillStyle="rgba(255, 255, 255, "+i/this.aTrail.length+")";}else{var tempAlpha=1;if(i<this.aTrail.length/2){tempAlpha=(i/this.aTrail.length)*2;}
ctx.fillStyle="rgba(6, 236, 233, "+tempAlpha+")";}
ctx.beginPath();ctx.moveTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90),this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.lineTo(this.aTrail[i+1].x-hyp1*Math.cos(tempRot1+temp90),this.aTrail[i+1].y-hyp1*Math.sin(tempRot1+temp90)+shakeY);ctx.lineTo(this.aTrail[i+1].x+hyp1*Math.cos(tempRot1+temp90),this.aTrail[i+1].y+hyp1*Math.sin(tempRot1+temp90)+shakeY);ctx.lineTo(this.aTrail[i].x+hyp0*Math.cos(tempRot0+temp90),this.aTrail[i].y+hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.lineTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90),this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.closePath();ctx.fill();}}
if(this.y>canvas.height/2){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2)*this.scale,this.y-(bHeight/2)*this.scale+this.ballRadius+shakeY,bWidth*this.scale,bHeight*this.scale);}
this.ballFrameTarg=this.ballFrameTarg-Math.max(Math.min((this.incY/1000),1),-1);this.ballFrame=Math.round(this.ballFrameTarg);if(this.ballFrame>7){this.ballFrame-=8;this.ballFrameTarg-=8;}else if(this.ballFrame<0){this.ballFrame+=8;this.ballFrameTarg+=8;}
this.rot=(this.x-canvas.width/2)/(10+this.scale*100);var curBallType=this.oBallImgData;if(this.isGoldBall){curBallType=this.oGoldBallImgData;}
ctx.save();ctx.translate(this.x,this.y-this.height*this.scale);ctx.rotate(this.initialRot);ctx.scale(this.ballScale,(1+(1-this.ballScale)));ctx.rotate(this.rot);var imgX=(this.ballFrame*curBallType.oData.spriteWidth)%curBallType.img.width;var imgY=Math.floor(this.ballFrame/(curBallType.img.width/curBallType.oData.spriteWidth))*curBallType.oData.spriteHeight;ctx.drawImage(curBallType.img,imgX,imgY,curBallType.oData.spriteWidth,curBallType.oData.spriteHeight,-(curBallType.oData.spriteWidth/2)*this.scale,-(curBallType.oData.spriteHeight/2)*this.scale+shakeY,curBallType.oData.spriteWidth*this.scale,curBallType.oData.spriteHeight*this.scale);ctx.restore();if(!this.isGoldBall){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2)*this.scale,this.y-(bHeight/2-2)*this.scale-this.height*this.scale+shakeY,bWidth*this.scale,bHeight*this.scale);}else{var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goldBallUnderShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goldBallUnderShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goldBallUnderShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goldBallUnderShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2)*this.scale,this.y-(bHeight/2)*this.scale-this.height*this.scale+shakeY,bWidth*this.scale,bHeight*this.scale);}}};Ball.prototype.renderPowerArea=function(){if(this.showPowerArea){this.powerAreaFrameInc+=delta*15;var tempScale=Math.sin(this.powerAreaFrameInc)/20+1;this.powerAreaFrame=Math.floor(this.powerAreaFrameInc)%9;var imgX=(this.powerAreaFrame*this.oPowerAreaImgData.oData.spriteWidth)%this.oPowerAreaImgData.img.width;var imgY=Math.floor(this.powerAreaFrame/(this.oPowerAreaImgData.img.width/this.oPowerAreaImgData.oData.spriteWidth))*this.oPowerAreaImgData.oData.spriteHeight;ctx.drawImage(this.oPowerAreaImgData.img,imgX,imgY,this.oPowerAreaImgData.oData.spriteWidth,this.oPowerAreaImgData.oData.spriteHeight,canvas.width/2+this.powerAreaX-(this.oPowerAreaImgData.oData.spriteWidth/2)*tempScale*this.powerAreaScale,canvas.height/2-this.powerAreaY-(this.oPowerAreaImgData.oData.spriteHeight/2)*(1+(1-tempScale))*this.powerAreaScale+shakeY,this.oPowerAreaImgData.oData.spriteWidth*tempScale*this.powerAreaScale,this.oPowerAreaImgData.oData.spriteHeight*(1+(1-tempScale))*this.powerAreaScale);}};Ball.prototype.renderGoal=function(){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.shootingGoal].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.shootingGoal].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.shootingGoal].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.shootingGoal].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2,canvas.height/2-bHeight+46+shakeY,bWidth,bHeight);};return Ball;})();Elements.Ball=Ball;})(Elements||(Elements={}));var Elements;(function(Elements){var Hud=(function(){function Hud(){this.scoreNumberSpace=40;this.userScoreY=0;this.enemyScoreY=0;this.prevSecs=0;this.timerNumberSpace=32;this.beepTimeTarg=600;this.powerBarY=0;this.timerY=0;this.powerMaxxed=false;this.textResultX=-1000;this.oGameElementsImgData=assetLib.getData("gameElements");this.oScoreNumbersImgData=assetLib.getData("scoreNumbers");this.oTimeNumbersImgData=assetLib.getData("timeNumbers");this.oUiElementsImgData=assetLib.getData("uiElements");this.heroKick=new Elements.HeroKick(assetLib.getData("heroKick"+heroId));if(firstRun){this.tutorial=new Elements.Tutorial(assetLib.getData("tut0"),0);}
if(levelNum==0){this.powerInc=.25;}else if(levelNum==1){this.powerInc=.20;}else{this.powerInc=.15;}}
Hud.prototype.update=function(){};Hud.prototype.jiggleUserScore=function(){var _this=this;if(this.scoreTween){this.scoreTween.kill();}
this.scoreTween=TweenLite.to(this,.1,{userScoreY:-50,ease:"Cubic.easeOut",onComplete:function(){_this.scoreTween=TweenLite.to(_this,1,{userScoreY:0,ease:"Elastic.easeOut",onComplete:function(){}});}});};Hud.prototype.showTextEvent=function(_eventText){var _this=this;if(this.textResultTween){this.textResultTween.kill();}
this.eventText=_eventText;this.textResultX=-300;this.textResultTween=TweenLite.to(this,.3,{delay:.5,textResultX:0,ease:"Back.easeOut",onComplete:function(){_this.textResultTween=TweenLite.to(_this,.3,{delay:1.5,textResultX:-300,ease:"Back.easeIn",onComplete:function(){}});}});};Hud.prototype.jiggleTimer=function(){var _this=this;if(this.scoreTween){this.scoreTween.kill();}
playSound("bonusTime");this.scoreTween=TweenLite.to(this,.1,{timerY:-50,ease:"Cubic.easeOut",onComplete:function(){_this.scoreTween=TweenLite.to(_this,1,{timerY:0,ease:"Elastic.easeOut",onComplete:function(){}});}});};Hud.prototype.increasePowerBar=function(){var _this=this;this.powerBarY=-10;TweenLite.to(this,.5,{powerBarY:0,ease:"Elastic.easeOut"});if(oGameData.power>=1-this.powerInc){this.powerMaxxed=true;playSound("powerBarFull");}else{playSound("powerBarUp");}
TweenLite.to(oGameData,.5,{power:Math.min(oGameData.power+this.powerInc,1),ease:"Bounce.easeOut",onComplete:function(){if(oGameData.power>=1){_this.powerBarY=-100;for(var i=0;i<5;i++){addFirework(2,canvas.width/2-100+i*(200/4),Math.random()*100-30,Math.random()*.5+1);}
oGameData.power=0;TweenLite.to(_this,1,{delay:.5,powerBarY:0,ease:"Back.easeOut"});}}});};Hud.prototype.render=function(){if(oGameData.curTime>500||Math.round(oGameData.curTime/25)%2==0){if(oGameData.curTime<=this.beepTimeTarg){playSound("beep");this.beepTimeTarg-=100;}
var id;var mins=Math.floor(oGameData.curTime/6000).toString();var tempX=getSafeWidth(0)+13;var tempY=getSafeHeight(0)+13+this.timerY;var secs=Math.floor((oGameData.curTime-Math.floor(oGameData.curTime/6000)*6000)/100).toString();if(secs.length<2){secs="0"+secs;}
var tenths=oGameData.curTime.toString().charAt(oGameData.curTime.toString().length-2)+oGameData.curTime.toString().charAt(oGameData.curTime.toString().length-1);if(tenths.length<2){tenths="0"+tenths;}
for(var i=0;i<2;i++){id=parseFloat(mins.charAt(i));if(mins.length<2){if(i==0){continue;}else{id=parseFloat(mins.charAt(0));}}
var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX,tempY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight);}
id=10;var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX+23,tempY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight);for(var i=0;i<2;i++){id=parseFloat(secs.charAt(i));var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX+46+i*this.timerNumberSpace,tempY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight);}
for(var i=0;i<2;i++){id=parseFloat(tenths.charAt(i));var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX+115+i*this.timerNumberSpace*.6,tempY,this.oTimeNumbersImgData.oData.spriteWidth*.6,this.oTimeNumbersImgData.oData.spriteHeight*.6);}}
var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,getSafeWidth(0)+50-bWidth/2-this.userScoreY+aHeroHeadIconOffsets[heroId].x,getSafeHeight(canvas.height)-75-bHeight/2+this.userScoreY+aHeroHeadIconOffsets[heroId].y,bWidth,bHeight);var tempScore=oGameData.heroScore.toString();var tempScale=1;for(var i=0;i<tempScore.length;i++){var id=parseFloat(tempScore.charAt(i));var imgX=(id*this.oScoreNumbersImgData.oData.spriteWidth)%this.oScoreNumbersImgData.img.width;var imgY=Math.floor(id/(this.oScoreNumbersImgData.img.width/this.oScoreNumbersImgData.oData.spriteWidth))*this.oScoreNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oScoreNumbersImgData.img,imgX,imgY,this.oScoreNumbersImgData.oData.spriteWidth,this.oScoreNumbersImgData.oData.spriteHeight,getSafeWidth(0)+120+i*(this.scoreNumberSpace*tempScale)-this.userScoreY+aHeroHeadIconOffsets[heroId].x,getSafeHeight(canvas.height)-80+this.userScoreY,this.oScoreNumbersImgData.oData.spriteWidth*tempScale,this.oScoreNumbersImgData.oData.spriteHeight*tempScale);}
var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,getSafeWidth(canvas.width)-50-bWidth/2+aEnemyHeadIconOffsets[aEnemyOrder[levelNum]].x,getSafeHeight(canvas.height)-75-bHeight/2+aEnemyHeadIconOffsets[aEnemyOrder[levelNum]].y,bWidth,bHeight);tempScore=oGameData.enemyScore.toString();tempScale=1;for(var i=0;i<tempScore.length;i++){var id=parseFloat(tempScore.charAt(i));var imgX=(id*this.oScoreNumbersImgData.oData.spriteWidth)%this.oScoreNumbersImgData.img.width;var imgY=Math.floor(id/(this.oScoreNumbersImgData.img.width/this.oScoreNumbersImgData.oData.spriteWidth))*this.oScoreNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oScoreNumbersImgData.img,imgX,imgY,this.oScoreNumbersImgData.oData.spriteWidth,this.oScoreNumbersImgData.oData.spriteHeight,getSafeWidth(canvas.width)-100+i*(this.scoreNumberSpace*tempScale)-((tempScore.length+.5)*this.scoreNumberSpace)+aEnemyHeadIconOffsets[aEnemyOrder[levelNum]].x,getSafeHeight(canvas.height)-80+this.enemyScoreY,this.oScoreNumbersImgData.oData.spriteWidth*tempScale,this.oScoreNumbersImgData.oData.spriteHeight*tempScale);}
var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarBg].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarBg].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarBg].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarBg].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2,getSafeHeight(0)+32-bHeight/2+this.powerBarY,bWidth,bHeight);var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBar].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBar].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBar].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBar].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth*oGameData.power+1,bHeight,canvas.width/2-111,getSafeHeight(0)+32-bHeight/2+1+this.powerBarY,bWidth*oGameData.power,bHeight);var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarTip].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarTip].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarTip].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBarTip].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-111+this.oGameElementsImgData.oData.oAtlasData[oImageIds.powerBar].width*oGameData.power+1-bWidth/2,getSafeHeight(0)+32-bHeight/2+this.powerBarY,bWidth,bHeight);if(this.textResultX>-300){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,this.eventText)+20+80+this.textResultX,60,bWidth,bHeight);addText(30,380,"left",20+this.textResultX,103,this.eventText);}
if(this.heroKick.showKick){this.heroKick.update();this.heroKick.render();}
if(showingTut){this.tutorial.update();this.tutorial.render();}};return Hud;})();Elements.Hud=Hud;})(Elements||(Elements={}));var Elements;(function(Elements){var GoalMarker=(function(_super){__extends(GoalMarker,_super);function GoalMarker(_oImgData,_animId){var _this=this;_super.call(this,_oImgData,25,45,_animId);this.setAnimType("loop",_animId);if(gameState=="shooting"){TweenLite.to(this,.5,{scaleX:2,scaleY:2,ease:"Elastic.easeOut",onComplete:function(){TweenLite.to(_this,.5,{x:canvas.width/2+85,y:30,scaleX:.2,scaleY:.2,ease:"Back.easeIn",onComplete:function(){_this.removeMe=true;addFirework(2,canvas.width/2+85,30,1);hud.increasePowerBar();}});}});}else{TweenLite.to(this,.5,{scaleX:2,scaleY:2,ease:"Elastic.easeOut",onComplete:function(){TweenLite.to(_this,.5,{scaleX:.2,scaleY:.2,ease:"Back.easeIn",onComplete:function(){_this.removeMe=true;if(_animId=="goalMarker0"){addFirework(2,_this.x,_this.y,1);}else{addFirework(0,_this.x,_this.y,1);}}});}});}}
GoalMarker.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);};GoalMarker.prototype.render=function(){_super.prototype.renderSimple.call(this,ctx);};return GoalMarker;})(Utils.AnimSprite);Elements.GoalMarker=GoalMarker;})(Elements||(Elements={}));var Elements;(function(Elements){var Crowd=(function(){function Crowd(){this.segs=8;this.inc=0;this.wildFactor=3;this.oBgImgData=assetLib.getData("shootingBg");}
Crowd.prototype.update=function(){this.inc+=(3+this.wildFactor/3)*delta;};Crowd.prototype.goWild=function(){var _this=this;if(this.wildTween){this.wildTween.kill();}
this.wildTween=TweenLite.to(this,.1,{wildFactor:10,ease:"Quad.easeIn",onComplete:function(){_this.wildTween=TweenLite.to(_this,1,{delay:3,wildFactor:3,ease:"Cubic.easeOut",onComplete:function(){}});}});};Crowd.prototype.render=function(){ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(this.oBgImgData.img,0,0,this.oBgImgData.img.width,this.oBgImgData.img.height,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2+shakeY,this.oBgImgData.img.width,this.oBgImgData.img.height);for(var i=0;i<this.segs;i++){var temp=-Math.abs(Math.sin(this.inc+i/8)*this.wildFactor);ctx.drawImage(this.oBgImgData.img,0,i*(317/this.segs),this.oBgImgData.img.width,317/this.segs,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2+i*(317/this.segs)+temp+this.wildFactor+shakeY,this.oBgImgData.img.width,317/this.segs);}
ctx.drawImage(this.oBgImgData.img,0,317,this.oBgImgData.img.width,this.oBgImgData.img.height-317,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2+317+shakeY,this.oBgImgData.img.width,this.oBgImgData.img.height-317);};return Crowd;})();Elements.Crowd=Crowd;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemyBall=(function(){function EnemyBall(){this.rot=0;this.height=0;this.scale=1;this.maxSwipeLength=30;this.ballScale=1;this.fixedBallRadius=80;this.incXMultiplier=0;this.incNetMultiplier=0;this.goalSegs=15;this.goalJiggleInc=0;this.saveCount=0;this.oGameElementsImgData=assetLib.getData("gameElements");this.oBallImgData=assetLib.getData("ball");this.reset();}
EnemyBall.prototype.reset=function(){if(this.kickTween){this.kickTween.kill();}
if(this.jiggleTween){this.jiggleTween.kill();}
if(this.shootTweenX){this.shootTweenX.kill();}
if(this.shootTweenY){this.shootTweenY.kill();}
if(this.ricochetTween){this.ricochetTween.kill();}
this.isSaved=false;this.shootState=0;this.shadowAlpha=0;this.height=200;this.trailInc=0;this.aTrail=new Array();this.ballFrame=0;this.rot=0;this.initialRot=0;this.incX=0;this.incY=0;this.ballScale=1;this.ballFrameTarg=0;this.shootTweenComplete=false;this.rotInc=0;this.spinInc=0;this.x=115;this.y=15;this.prevX=this.x;this.prevY=this.y;this.inGoal=false;this.aTouchData=new Array();this.incXMultiplier=1;oGameData.ballInPlay=false;enemyKick.reset();if(!showingTut){this.startKickTween();}};EnemyBall.prototype.startKickTween=function(){this.kickTween=TweenLite.to(this,.5,{height:0,ease:"Bounce.easeOut",onComplete:function(){oGameData.ballInPlay=true;enemyKick.takeShot();}});};EnemyBall.prototype.ballJiggle=function(_inc){if(this.jiggleTween){this.jiggleTween.kill();}
this.initialRot=0;this.ballScale=_inc;this.jiggleTween=TweenLite.to(this,1,{ballScale:1,ease:"Elastic.easeOut"});};EnemyBall.prototype.killTweens=function(){if(this.kickTween){this.kickTween.kill();}
if(this.jiggleTween){this.jiggleTween.kill();}
if(this.shootTweenX){this.shootTweenX.kill();}
if(this.shootTweenY){this.shootTweenY.kill();}
if(this.ricochetTween){this.ricochetTween.kill();}};EnemyBall.prototype.pause=function(_isOn){if(_isOn){if(this.kickTween&&this.kickTween.isActive()){this.kickTween.pause();}
if(this.shootTweenX&&this.shootTweenX.isActive()){this.shootTweenX.pause();}
if(this.shootTweenY&&this.shootTweenY.isActive()){this.shootTweenY.pause();}
if(this.ricochetTween&&this.ricochetTween.isActive()){this.ricochetTween.pause();}
if(this.jiggleTween&&this.jiggleTween.isActive()){this.jiggleTween.pause();}}else{if(this.kickTween&&this.kickTween.paused()){this.kickTween.resume();}
if(this.shootTweenX&&this.shootTweenX.paused()){this.shootTweenX.resume();}
if(this.shootTweenY&&this.shootTweenY.paused()){this.shootTweenY.resume();}
if(this.ricochetTween&&this.ricochetTween.paused()){this.ricochetTween.resume();}
if(this.jiggleTween&&this.jiggleTween.paused()){this.jiggleTween.resume();}}};EnemyBall.prototype.shoot=function(){var _this=this;this.shootState=1;playSound("kick"+Math.floor(Math.random()*3));if(heroGoal.saveState==2){heroGoal.makeSave();}
if(this.shootTweenX){this.shootTweenX.kill();}
if(this.shootTweenY){this.shootTweenY.kill();}
this.spinInc=-.5;var tempTime=1.1-Math.random()*(aEnemyOrder[levelNum]/10);if(firstFail){tempTime+=.1;}
var tempRan=Math.random();var tempEase="Sine.easeIn";if(tempRan>.8){tempEase="Linear.easeNone";}else if(tempRan>.6){tempEase="Cubic.easeIn";}else if(tempRan>.4&&levelNum>1){tempEase="Back.easeIn";}
var ranX=Math.random()*150+208;if(Math.random()>.5){ranX=-(Math.random()*150+208);}
this.shootTweenX=TweenLite.to(this,tempTime,{x:ranX,ease:tempEase});this.shootTweenY=TweenLite.to(this,tempTime,{y:158,ease:"Sine.easeIn",onComplete:function(){_this.shootTweenComplete=true;_this.incXMultiplier=1;_this.incNetMultiplier=1;screenShake(10);_this.shootTweenY=TweenLite.to(_this,2,{incNetMultiplier:0,incXMultiplier:0,y:_this.y-10,ease:"Quad.easeOut",onComplete:function(){wipe.inGoal=false;wipe.trigger(resetGoalkeeping);}});}});this.incHeight=(Math.random()*1100+1200)*(.7+tempTime*.3);this.aTrail.push({x:canvas.width/2+this.x,y:canvas.height/2+this.y,scale:this.scale});addExplosion(0,canvas.width/2+this.x,canvas.height/2+this.y,.4);};EnemyBall.prototype.saveBall=function(){if(this.shootTweenX){this.shootTweenX.kill();}
if(this.shootTweenY){this.shootTweenY.kill();}
this.incHeight+=Math.random()*2000+1000;this.incXMultiplier=1;this.shootTweenY=TweenLite.to(this,2,{incXMultiplier:0,ease:"Quad.easeOut",onComplete:function(){wipe.inGoal=true;wipe.trigger(resetGoalkeeping);}});this.spinInc=.5;addExplosion(0,canvas.width/2+this.x,canvas.height/2+this.y-(this.height+this.incHeight*delta)*this.scale,2);userSaved();this.saveCount++;};EnemyBall.prototype.update=function(){if(this.shootState==0){this.x=115;this.y=15;this.ballRadius=this.fixedBallRadius*this.scale;this.ballScale=1;}else if(this.shootState==1){this.incHeight-=(5000*(this.scale+.5))*delta;this.height+=this.incHeight*delta;if(this.height<=0){this.height=0;this.incHeight*=-.6;if(this.incHeight>200){playSound("bounce"+Math.floor(Math.random()*5));}
var temp=1-this.incHeight/7000;if(!this.isSaved){this.spinInc*=.5;}
if(temp<.95){this.ballJiggle(temp);}}
if(!this.isSaved){if(!this.shootTweenComplete){this.incX=this.x-this.prevX;this.prevX=this.x;this.incY=this.y-this.prevY;this.prevY=this.y;this.rot+=this.incX*delta/2;}else{this.x+=(this.incX*delta*50)*this.incXMultiplier;this.rot+=this.incX*(delta/1)*this.incXMultiplier;if(this.x<-400){this.x=-400;this.incX*=-.2;}else if(this.x>355){this.x=355;this.incX*=-.2;}}}else{this.x+=(this.incX*delta*10)*this.incXMultiplier;this.y-=(this.incY*delta*20)*this.incXMultiplier;this.rot+=this.incX*(delta/1)*this.incXMultiplier;}
if(!this.isSaved&&canvas.height/2+this.y+this.ballRadius>canvas.height/2+127&&canvas.height/2+this.y+this.ballRadius<canvas.height/2+144&&heroGoal.checkSave(canvas.width/2+this.x,canvas.height/2+this.y-this.height*this.scale)){this.isSaved=true;this.saveBall();playSound("crowdGood"+Math.floor(Math.random()*3));playSound("heroSave");playSound("kick"+Math.floor(Math.random()*3));}
if(!this.inGoal&&canvas.height/2+this.y+this.ballRadius>canvas.height/2+144){this.inGoal=true;addGoalMarker(1,canvas.width/2+this.x,canvas.height/2+this.y-this.height*this.scale,.5);enemyScored();playSound("crowdBad"+Math.floor(Math.random()*2));playSound("enemyScore");}
this.trailInc+=delta;if(this.trailInc>.05){if(this.aTrail.length>10){this.aTrail.shift();}
this.aTrail.push({x:canvas.width/2+this.x,y:canvas.height/2+this.y-this.height*this.scale,scale:this.scale});this.trailInc=0;}
this.shadowAlpha=Math.floor(Math.min((this.height)/500,.9)*10);this.ballRadius=this.fixedBallRadius*this.scale;}
this.scale=(this.y-15)/143*.25+.1;};EnemyBall.prototype.render=function(){if(!this.inGoal){this.renderBall();heroGoal.render();this.renderGoalFront();}else{heroGoal.render();this.renderGoalFront();this.renderBall();}
this.goalJiggleInc+=delta*5;var tempY;for(var i=0;i<this.goalSegs;i++){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalBack].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalBack].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalBack].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalBack].height;tempY=((Math.sin(this.goalJiggleInc+i/2)*10)*(this.goalSegs/2-Math.abs(i-this.goalSegs/2))/5)*this.incNetMultiplier;ctx.drawImage(this.oGameElementsImgData.img,bX+i*(bWidth/this.goalSegs),bY,(bWidth/this.goalSegs),bHeight,canvas.width/2-bWidth/2-46+i*(bWidth/this.goalSegs)+tempY,canvas.height/2-bHeight+186+shakeY,(bWidth/this.goalSegs),bHeight);}};EnemyBall.prototype.renderGoalFront=function(){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalFront].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalFront].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalFront].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeepingGoalFront].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2-39,canvas.height/2-bHeight+182+shakeY,bWidth,bHeight);};EnemyBall.prototype.renderBall=function(){if(this.aTrail.length>1){var tempRot0;var tempRot1;var temp90=90*radian;var hyp0;var hyp1;var a;var b;for(var i=0;i<this.aTrail.length-1;i++){a=this.aTrail[i+1].x-this.aTrail[i].x;b=this.aTrail[i+1].y-this.aTrail[i].y;tempRot0=Math.atan2(b,a);hyp0=this.aTrail[i].scale*80;if(i<this.aTrail.length-2){a=this.aTrail[i+2].x-this.aTrail[i+1].x;b=this.aTrail[i+2].y-this.aTrail[i+1].y;tempRot1=Math.atan2(b,a);}else{tempRot1=tempRot0;}
hyp1=this.aTrail[i+1].scale*80;ctx.fillStyle="rgba(255, 255, 255, "+i/this.aTrail.length+")";ctx.beginPath();ctx.moveTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90),this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.lineTo(this.aTrail[i+1].x-hyp1*Math.cos(tempRot1+temp90),this.aTrail[i+1].y-hyp1*Math.sin(tempRot1+temp90)+shakeY);ctx.lineTo(this.aTrail[i+1].x+hyp1*Math.cos(tempRot1+temp90),this.aTrail[i+1].y+hyp1*Math.sin(tempRot1+temp90)+shakeY);ctx.lineTo(this.aTrail[i].x+hyp0*Math.cos(tempRot0+temp90),this.aTrail[i].y+hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.lineTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90),this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+shakeY);ctx.closePath();ctx.fill();}}
var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ballShadow"+this.shadowAlpha]].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2+this.x-(bWidth/2)*this.scale,canvas.height/2+this.y-(bHeight/2)*this.scale+this.ballRadius+shakeY,bWidth*this.scale,bHeight*this.scale);this.ballFrameTarg+=this.spinInc*this.incXMultiplier;this.ballFrame=Math.round(this.ballFrameTarg);if(this.ballFrame>7){this.ballFrame-=8;this.ballFrameTarg-=8;}else if(this.ballFrame<0){this.ballFrame+=8;this.ballFrameTarg+=8;}
var curBallType=this.oBallImgData;ctx.save();ctx.translate(canvas.width/2+this.x,canvas.height/2+this.y-this.height*this.scale);ctx.rotate(this.initialRot);ctx.scale(this.ballScale,(1+(1-this.ballScale)));ctx.rotate(this.rot);var imgX=(this.ballFrame*curBallType.oData.spriteWidth)%curBallType.img.width;var imgY=Math.floor(this.ballFrame/(curBallType.img.width/curBallType.oData.spriteWidth))*curBallType.oData.spriteHeight;ctx.drawImage(curBallType.img,imgX,imgY,curBallType.oData.spriteWidth,curBallType.oData.spriteHeight,-(curBallType.oData.spriteWidth/2)*this.scale,-(curBallType.oData.spriteHeight/2)*this.scale+shakeY,curBallType.oData.spriteWidth*this.scale,curBallType.oData.spriteHeight*this.scale);ctx.restore();var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballUnderShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2+this.x-(bWidth/2)*this.scale,canvas.height/2+this.y-(bHeight/2-2)*this.scale-this.height*this.scale+shakeY,bWidth*this.scale,bHeight*this.scale);};return EnemyBall;})();Elements.EnemyBall=EnemyBall;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemyCrowd=(function(){function EnemyCrowd(){this.inc=0;this.wildFactor=0;this.oBgImgData=assetLib.getData("goalkeepingBg");this.oGameElementsImgData=assetLib.getData("gameElements");}
EnemyCrowd.prototype.update=function(){this.inc+=(0+this.wildFactor)*delta;};EnemyCrowd.prototype.goWild=function(){var _this=this;if(this.wildTween){this.wildTween.kill();}
this.wildTween=TweenLite.to(this,.1,{wildFactor:7,ease:"Quad.easeIn",onComplete:function(){_this.wildTween=TweenLite.to(_this,1,{delay:3,wildFactor:0,ease:"Cubic.easeOut",onComplete:function(){}});}});};EnemyCrowd.prototype.render=function(){ctx.fillStyle="rgba(0, 0, 0, 1)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(this.oBgImgData.img,0,0,this.oBgImgData.img.width,this.oBgImgData.img.height,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-this.oBgImgData.img.height/2+shakeY,this.oBgImgData.img.width,this.oBgImgData.img.height);var temp=-Math.abs(Math.sin(this.inc)*2);ctx.drawImage(this.oBgImgData.img,0,155,this.oBgImgData.img.width,156,canvas.width/2-this.oBgImgData.img.width/2,canvas.height/2-195+shakeY,this.oBgImgData.img.width,156+temp);var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tinyGoal].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tinyGoal].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tinyGoal].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tinyGoal].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2+105,canvas.height/2-75+shakeY,bWidth,bHeight);};return EnemyCrowd;})();Elements.EnemyCrowd=EnemyCrowd;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemyHud=(function(){function EnemyHud(){this.scoreNumberSpace=40;this.userScoreY=0;this.enemyScoreY=0;this.prevSecs=0;this.timerNumberSpace=32;this.beepTimeTarg=600;this.powerBarY=0;this.timerY=0;this.powerMaxxed=false;this.textResultX=-1000;this.oGameElementsImgData=assetLib.getData("gameElements");this.oScoreNumbersImgData=assetLib.getData("scoreNumbers");this.oTimeNumbersImgData=assetLib.getData("timeNumbers");this.oUiElementsImgData=assetLib.getData("uiElements");if(firstRun){this.tutorial=new Elements.Tutorial(assetLib.getData("tut1"),1);}}
EnemyHud.prototype.showTextEvent=function(_eventText){var _this=this;if(this.textResultTween){this.textResultTween.kill();}
this.eventText=_eventText;this.textResultX=-300;this.textResultTween=TweenLite.to(this,.3,{delay:.5,textResultX:0,ease:"Back.easeOut",onComplete:function(){_this.textResultTween=TweenLite.to(_this,.3,{delay:1.5,textResultX:-300,ease:"Back.easeIn",onComplete:function(){}});}});};EnemyHud.prototype.update=function(){};EnemyHud.prototype.jiggleEnemyScore=function(){var _this=this;if(this.scoreTween){this.scoreTween.kill();}
this.scoreTween=TweenLite.to(this,.1,{enemyScoreY:-50,ease:"Cubic.easeOut",onComplete:function(){_this.scoreTween=TweenLite.to(_this,1,{enemyScoreY:0,ease:"Elastic.easeOut",onComplete:function(){}});}});};EnemyHud.prototype.render=function(){if(oGameData.curTime>500||Math.round(oGameData.curTime/25)%2==0){if(oGameData.curTime<=this.beepTimeTarg){playSound("beep");this.beepTimeTarg-=100;}
var id;var mins=Math.floor(oGameData.curTime/6000).toString();var tempX=getSafeWidth(0)+13;var tempY=getSafeHeight(0)+13+this.timerY;var secs=Math.floor((oGameData.curTime-Math.floor(oGameData.curTime/6000)*6000)/100).toString();if(secs.length<2){secs="0"+secs;}
var tenths=oGameData.curTime.toString().charAt(oGameData.curTime.toString().length-2)+oGameData.curTime.toString().charAt(oGameData.curTime.toString().length-1);if(tenths.length<2){tenths="0"+tenths;}
for(var i=0;i<2;i++){id=parseFloat(mins.charAt(i));if(mins.length<2){if(i==0){continue;}else{id=parseFloat(mins.charAt(0));}}
var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX,tempY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight);}
id=10;var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX+23,tempY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight);for(var i=0;i<2;i++){id=parseFloat(secs.charAt(i));var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX+46+i*this.timerNumberSpace,tempY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight);}
for(var i=0;i<2;i++){id=parseFloat(tenths.charAt(i));var imgX=(id*this.oTimeNumbersImgData.oData.spriteWidth)%this.oTimeNumbersImgData.img.width;var imgY=Math.floor(id/(this.oTimeNumbersImgData.img.width/this.oTimeNumbersImgData.oData.spriteWidth))*this.oTimeNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oTimeNumbersImgData.img,imgX,imgY,this.oTimeNumbersImgData.oData.spriteWidth,this.oTimeNumbersImgData.oData.spriteHeight,tempX+115+i*this.timerNumberSpace*.6,tempY,this.oTimeNumbersImgData.oData.spriteWidth*.6,this.oTimeNumbersImgData.oData.spriteHeight*.6);}}
var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds["heroHead"+heroId]].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,getSafeWidth(0)+50-bWidth/2-this.userScoreY+aHeroHeadIconOffsets[heroId].x,getSafeHeight(canvas.height)-75-bHeight/2+this.userScoreY+aHeroHeadIconOffsets[heroId].y,bWidth,bHeight);var tempScore=oGameData.heroScore.toString();var tempScale=1;for(var i=0;i<tempScore.length;i++){var id=parseFloat(tempScore.charAt(i));var imgX=(id*this.oScoreNumbersImgData.oData.spriteWidth)%this.oScoreNumbersImgData.img.width;var imgY=Math.floor(id/(this.oScoreNumbersImgData.img.width/this.oScoreNumbersImgData.oData.spriteWidth))*this.oScoreNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oScoreNumbersImgData.img,imgX,imgY,this.oScoreNumbersImgData.oData.spriteWidth,this.oScoreNumbersImgData.oData.spriteHeight,getSafeWidth(0)+110+i*(this.scoreNumberSpace*tempScale)-this.userScoreY+aHeroHeadIconOffsets[heroId].x,getSafeHeight(canvas.height)-80+this.userScoreY,this.oScoreNumbersImgData.oData.spriteWidth*tempScale,this.oScoreNumbersImgData.oData.spriteHeight*tempScale);}
var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds["enemyHead"+aEnemyOrder[levelNum]]].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,getSafeWidth(canvas.width)-50-bWidth/2+this.enemyScoreY+aEnemyHeadIconOffsets[aEnemyOrder[levelNum]].x,getSafeHeight(canvas.height)-75-bHeight/2+this.enemyScoreY+aEnemyHeadIconOffsets[aEnemyOrder[levelNum]].y,bWidth,bHeight);tempScore=oGameData.enemyScore.toString();tempScale=1;for(var i=0;i<tempScore.length;i++){var id=parseFloat(tempScore.charAt(i));var imgX=(id*this.oScoreNumbersImgData.oData.spriteWidth)%this.oScoreNumbersImgData.img.width;var imgY=Math.floor(id/(this.oScoreNumbersImgData.img.width/this.oScoreNumbersImgData.oData.spriteWidth))*this.oScoreNumbersImgData.oData.spriteHeight;ctx.drawImage(this.oScoreNumbersImgData.img,imgX,imgY,this.oScoreNumbersImgData.oData.spriteWidth,this.oScoreNumbersImgData.oData.spriteHeight,getSafeWidth(canvas.width)-100+i*(this.scoreNumberSpace*tempScale)-((tempScore.length+.5)*this.scoreNumberSpace)+this.enemyScoreY+aEnemyHeadIconOffsets[aEnemyOrder[levelNum]].x,getSafeHeight(canvas.height)-80+this.enemyScoreY,this.oScoreNumbersImgData.oData.spriteWidth*tempScale,this.oScoreNumbersImgData.oData.spriteHeight*tempScale);}
if(this.textResultX>-300){var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds.textPanelBallLong].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,-bWidth+getCorrectedTextWidth(30,380,this.eventText)+20+80+this.textResultX,60,bWidth,bHeight);addText(30,380,"left",20+this.textResultX,103,this.eventText);}
if(showingTut){this.tutorial.update();this.tutorial.render();}};return EnemyHud;})();Elements.EnemyHud=EnemyHud;})(Elements||(Elements={}));var Elements;(function(Elements){var HeroGoal0=(function(_super){__extends(HeroGoal0,_super);function HeroGoal0(_oImgData){_super.call(this,_oImgData,14,45,"ambient");this.hitRadius=100;this.setAnimType("loop","ambient");this.oGameElementsImgData=assetLib.getData("gameElements");this.reset();}
HeroGoal0.prototype.reset=function(){if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.moveX=0;this.moveY=0;this.driftX=0;this.incX=0;this.prevX=0;this.trailInc=0;this.aPosCapture=new Array();this.saveState=0;this.aTrail=new Array();this.hasSprayed=false;this.setAnimType("loop","ambient");};HeroGoal0.prototype.checkSave=function(_x,_y){for(var i=0;i<this.aPosCapture.length;i++){var a=_x-this.aPosCapture[i].x;var b=_y-this.aPosCapture[i].y;if(Math.sqrt(a*a+b*b)<this.hitRadius){return true;}}
return false;};HeroGoal0.prototype.makeSave=function(){var _this=this;if(enemyBall.shootState==0){this.saveState=2;return;}
playSound("saveJump"+Math.floor(Math.random()*3));userInput.removeHitArea("goalkeepingGameTouch");this.saveState=1;var a;var b;var tempPower=0;for(var i=0;i<enemyBall.aTouchData.length-1;i++){a=enemyBall.aTouchData[i+1].x-enemyBall.aTouchData[i].x;b=enemyBall.aTouchData[i+1].y-enemyBall.aTouchData[i].y;tempPower+=Math.sqrt(a*a+b*b);}
a=enemyBall.aTouchData[0].x-enemyBall.aTouchData[enemyBall.aTouchData.length-1].x;b=enemyBall.aTouchData[0].y-enemyBall.aTouchData[enemyBall.aTouchData.length-1].y;var tempAngle=Math.atan2(b,a);tempPower*=(enemyBall.maxSwipeLength/enemyBall.aTouchData.length);tempPower=Math.min(tempPower*.4,275);if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
if(a>0){addSpray("left",this.x+50,canvas.height/2+120,1);}else{addSpray("right",this.x-50,canvas.height/2+120,1);}
this.saveTweenX=TweenLite.to(this,1.3,{driftX:(Math.cos(tempAngle)*-tempPower)/2,ease:"Quad.easeOut",onComplete:function(){}});this.saveTweenY=TweenLite.to(this,.3,{moveX:Math.cos(tempAngle)*-tempPower,moveY:Math.max(Math.min(Math.sin(tempAngle)*-tempPower,0),-150),ease:"Cubic.easeOut",onComplete:function(){_this.saveState=3;_this.saveTweenY=TweenLite.to(_this,.4,{moveY:0,ease:"Quad.easeIn",onComplete:function(){playSound("saveLand");}});}});var tempRad=tempAngle/radian;if(tempRad<165&&tempRad>=90){this.setAnimType("once","highRight");}else if(tempRad>=165||tempRad<-90){this.setAnimType("once","lowRight");}else if(tempRad<90&&tempRad>=15){this.setAnimType("once","highLeft");}else if(tempRad<15){this.setAnimType("once","lowLeft");}
this.animEndedFunc=function(){this.setAnimType("loop","ambient");};this.aTrail.push({x:this.x,y:this.y,scale:25});};HeroGoal0.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.moveX+this.driftX;this.y=canvas.height/2+50+this.moveY;if(this.moveY>-5&&this.saveState==3&&!this.hasSprayed){addSpray("left",this.x+50,canvas.height/2+120,1);addSpray("right",this.x-50,canvas.height/2+120,1);this.hasSprayed=true;}
this.incX=this.x-this.prevX;this.prevX=this.x;this.aPosCapture.push({x:this.x,y:this.y+20});if(this.aPosCapture.length>10){this.aPosCapture.shift();}
this.trailInc+=delta;if(this.trailInc>.05){if(this.aTrail.length>10){this.aTrail.shift();}
this.aTrail.push({x:this.x,y:this.y,scale:25});this.trailInc=0;}};HeroGoal0.prototype.render=function(){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2),canvas.height/2+135+shakeY,bWidth,bHeight);if(this.aTrail.length>1){var tempRot0;var tempRot1;var temp90=90*radian;var hyp0;var hyp1;var a;var b;var trailOffsetY=55;var trailOffsetX;for(var i=0;i<this.aTrail.length-1;i++){a=this.aTrail[i+1].x-this.aTrail[i].x;b=this.aTrail[i+1].y-this.aTrail[i].y;tempRot0=0/radian;hyp0=this.aTrail[i].scale;if(i<this.aTrail.length-2){a=this.aTrail[i+2].x-this.aTrail[i+1].x;b=this.aTrail[i+2].y-this.aTrail[i+1].y;tempRot1=0/radian;}else{tempRot1=tempRot0;}
hyp1=this.aTrail[i+1].scale;ctx.fillStyle="rgba(6, 236, 233, "+(i/this.aTrail.length)+")";trailOffsetX=40;ctx.beginPath();ctx.moveTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x-hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y-hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x+hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y+hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x+hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y+hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.closePath();ctx.fill();trailOffsetX=-40;ctx.beginPath();ctx.moveTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x-hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y-hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x+hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y+hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x+hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y+hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.closePath();ctx.fill();}}
this.y=this.y+shakeY;_super.prototype.renderSimple.call(this,ctx);};return HeroGoal0;})(Utils.AnimSprite);Elements.HeroGoal0=HeroGoal0;})(Elements||(Elements={}));var Elements;(function(Elements){var HeroGoal1=(function(_super){__extends(HeroGoal1,_super);function HeroGoal1(_oImgData){_super.call(this,_oImgData,16,45,"ambient");this.hitRadius=100;this.setAnimType("loop","ambient");this.oGameElementsImgData=assetLib.getData("gameElements");this.reset();}
HeroGoal1.prototype.reset=function(){if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.moveX=0;this.moveY=0;this.driftX=0;this.incX=0;this.prevX=0;this.trailInc=0;this.aPosCapture=new Array();this.saveState=0;this.aTrail=new Array();this.hasSprayed=false;this.setAnimType("loop","ambient");};HeroGoal1.prototype.checkSave=function(_x,_y){for(var i=0;i<this.aPosCapture.length;i++){var a=_x-this.aPosCapture[i].x;var b=_y-this.aPosCapture[i].y;if(Math.sqrt(a*a+b*b)<this.hitRadius){return true;}}
return false;};HeroGoal1.prototype.makeSave=function(){var _this=this;if(enemyBall.shootState==0){this.saveState=2;return;}
playSound("saveJump"+Math.floor(Math.random()*3));userInput.removeHitArea("goalkeepingGameTouch");this.saveState=1;var a;var b;var tempPower=0;for(var i=0;i<enemyBall.aTouchData.length-1;i++){a=enemyBall.aTouchData[i+1].x-enemyBall.aTouchData[i].x;b=enemyBall.aTouchData[i+1].y-enemyBall.aTouchData[i].y;tempPower+=Math.sqrt(a*a+b*b);}
a=enemyBall.aTouchData[0].x-enemyBall.aTouchData[enemyBall.aTouchData.length-1].x;b=enemyBall.aTouchData[0].y-enemyBall.aTouchData[enemyBall.aTouchData.length-1].y;var tempAngle=Math.atan2(b,a);tempPower*=(enemyBall.maxSwipeLength/enemyBall.aTouchData.length);tempPower=Math.min(tempPower*.4,275);if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.saveTweenX=TweenLite.to(this,1.3,{driftX:(Math.cos(tempAngle)*-tempPower)/2,ease:"Quad.easeOut",onComplete:function(){}});this.saveTweenY=TweenLite.to(this,.3,{moveX:Math.cos(tempAngle)*-tempPower,moveY:Math.max(Math.min(Math.sin(tempAngle)*-tempPower,0),-150),ease:"Cubic.easeOut",onComplete:function(){_this.saveState=3;_this.saveTweenY=TweenLite.to(_this,1,{moveY:0,ease:"Bounce.easeOut",onComplete:function(){playSound("saveLand");}});}});if(a>0){addSpray("left",this.x+50,canvas.height/2+120,1);}else{addSpray("right",this.x-50,canvas.height/2+120,1);}
var tempRad=tempAngle/radian;if(tempRad<-90||tempRad>=90){this.setAnimType("once","right");this.animEndedFunc=function(){this.setAnimType("once","endRight");this.animEndedFunc=function(){this.setAnimType("loop","ambient");};};}else{this.setAnimType("once","left");this.animEndedFunc=function(){this.setAnimType("once","endLeft");this.animEndedFunc=function(){this.setAnimType("loop","ambient");};};}
this.aTrail.push({x:this.x,y:this.y,scale:25});};HeroGoal1.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.moveX+this.driftX;this.y=canvas.height/2+50+this.moveY;if(this.moveY>-5&&this.saveState==3&&!this.hasSprayed){addSpray("left",this.x+50,canvas.height/2+120,1);addSpray("right",this.x-50,canvas.height/2+120,1);this.hasSprayed=true;}
this.incX=this.x-this.prevX;this.prevX=this.x;this.aPosCapture.push({x:this.x,y:this.y+20});if(this.aPosCapture.length>10){this.aPosCapture.shift();}
this.trailInc+=delta;if(this.trailInc>.05){if(this.aTrail.length>10){this.aTrail.shift();}
this.aTrail.push({x:this.x,y:this.y,scale:25});this.trailInc=0;}};HeroGoal1.prototype.render=function(){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2),canvas.height/2+135+shakeY,bWidth,bHeight);this.y=this.y+shakeY;_super.prototype.renderSimple.call(this,ctx);if(this.aTrail.length>1&&(this.animId=="left"||this.animId=="right")){var tempRot0;var tempRot1;var temp90=90*radian;var hyp0;var hyp1;var a;var b;var trailOffsetY=30;var trailOffsetX=0;for(var i=0;i<this.aTrail.length-1;i++){a=this.aTrail[i+1].x-this.aTrail[i].x;b=this.aTrail[i+1].y-this.aTrail[i].y;tempRot0=0*radian;hyp0=this.aTrail[i].scale;if(i<this.aTrail.length-2){a=this.aTrail[i+2].x-this.aTrail[i+1].x;b=this.aTrail[i+2].y-this.aTrail[i+1].y;tempRot1=0*radian;}else{tempRot1=tempRot0;}
hyp1=this.aTrail[i+1].scale;ctx.fillStyle="rgba(6, 236, 233, "+(i/this.aTrail.length)+")";ctx.beginPath();ctx.moveTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x-hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y-hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x+hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y+hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x+hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y+hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.closePath();ctx.fill();tempRot0=90*radian;tempRot1=90*radian;ctx.beginPath();ctx.moveTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x-hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y-hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i+1].x+hyp1*Math.cos(tempRot1+temp90)+trailOffsetX,this.aTrail[i+1].y+hyp1*Math.sin(tempRot1+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x+hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y+hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.lineTo(this.aTrail[i].x-hyp0*Math.cos(tempRot0+temp90)+trailOffsetX,this.aTrail[i].y-hyp0*Math.sin(tempRot0+temp90)+trailOffsetY+shakeY);ctx.closePath();ctx.fill();}}};return HeroGoal1;})(Utils.AnimSprite);Elements.HeroGoal1=HeroGoal1;})(Elements||(Elements={}));var Elements;(function(Elements){var HeroGoal2=(function(_super){__extends(HeroGoal2,_super);function HeroGoal2(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.hitRadius=110;this.hitOffsetX=0;this.setAnimType("loop","ambient");this.oGameElementsImgData=assetLib.getData("gameElements");this.scaleX=this.scaleY=1.15;this.reset();}
HeroGoal2.prototype.reset=function(){if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.moveX=0;this.moveY=0;this.driftX=0;this.incX=0;this.prevX=0;this.trailInc=0;this.aPosCapture=new Array();this.saveState=0;this.hitOffsetX=0;this.hasSprayed=false;this.setAnimType("loop","ambient");};HeroGoal2.prototype.checkSave=function(_x,_y){if(_x>this.x-120+this.hitOffsetX&&_x<this.x+120+this.hitOffsetX&&_y>this.y-20&&_y<this.y+155){return true;}else{return false;}};HeroGoal2.prototype.makeSave=function(){var _this=this;if(enemyBall.shootState==0){this.saveState=2;return;}
playSound("saveJump"+Math.floor(Math.random()*3));userInput.removeHitArea("goalkeepingGameTouch");this.saveState=1;var a;var b;var tempPower=0;for(var i=0;i<enemyBall.aTouchData.length-1;i++){a=enemyBall.aTouchData[i+1].x-enemyBall.aTouchData[i].x;b=enemyBall.aTouchData[i+1].y-enemyBall.aTouchData[i].y;tempPower+=Math.sqrt(a*a+b*b);}
a=enemyBall.aTouchData[0].x-enemyBall.aTouchData[enemyBall.aTouchData.length-1].x;b=enemyBall.aTouchData[0].y-enemyBall.aTouchData[enemyBall.aTouchData.length-1].y;var tempAngle=Math.atan2(b,a);tempPower*=(enemyBall.maxSwipeLength/enemyBall.aTouchData.length);tempPower=Math.min(tempPower*.4,275);if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.saveTweenX=TweenLite.to(this,1.3,{driftX:(Math.cos(tempAngle)*-tempPower)/2,ease:"Quad.easeOut",onComplete:function(){}});this.saveTweenY=TweenLite.to(this,.3,{moveX:Math.cos(tempAngle)*-tempPower,moveY:Math.max(Math.min(Math.sin(tempAngle)*-tempPower,0),-150),ease:"Cubic.easeOut",onComplete:function(){_this.saveState=3;_this.saveTweenY=TweenLite.to(_this,.3,{moveY:0,ease:"Cubic.easeIn",onComplete:function(){playSound("saveLand");_this.setAnimType("once",_this.saveSide+"Land");}});}});if(a>0){addSpray("left",this.x+50,canvas.height/2+120,1);}else{addSpray("right",this.x-50,canvas.height/2+120,1);}
var tempRad=tempAngle/radian;if(tempRad<-90||tempRad>=90){this.saveSide="right";this.hitOffsetX=20;}else{this.saveSide="left";this.hitOffsetX=-20;}
this.setAnimType("once",this.saveSide+"Fly");this.animEndedFunc=null;};HeroGoal2.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.moveX+this.driftX;this.y=canvas.height/2-0+this.moveY;if(this.moveY>-5&&this.saveState==3&&!this.hasSprayed){addSpray("left",this.x+150,canvas.height/2+120,1);addSpray("right",this.x-150,canvas.height/2+120,1);this.hasSprayed=true;}
this.incX=this.x-this.prevX;this.prevX=this.x;};HeroGoal2.prototype.render=function(){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2),canvas.height/2+135+shakeY,bWidth,bHeight);this.y=this.y+shakeY;_super.prototype.renderSimple.call(this,ctx);};return HeroGoal2;})(Utils.AnimSprite);Elements.HeroGoal2=HeroGoal2;})(Elements||(Elements={}));var Elements;(function(Elements){var HeroGoal3=(function(_super){__extends(HeroGoal3,_super);function HeroGoal3(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.hitRadius=110;this.hoverInc=0;this.hitOffsetX=0;this.setAnimType("loop","ambient");this.oGameElementsImgData=assetLib.getData("gameElements");this.scaleX=this.scaleY=1;this.reset();}
HeroGoal3.prototype.reset=function(){if(this.saveTween){this.saveTween.kill();}
this.targX=0;this.targY=0;this.driftX=0;this.incX=0;this.prevX=0;this.trailInc=0;this.aPosCapture=new Array();this.saveState=0;this.hitOffsetX=0;this.setAnimType("loop","ambient");};HeroGoal3.prototype.checkSave=function(_x,_y){for(var i=0;i<this.aPosCapture.length;i++){if(_x>this.aPosCapture[i].x-100+this.hitOffsetX&&_x<this.aPosCapture[i].x+100+this.hitOffsetX&&_y>this.aPosCapture[i].y-80&&_y<this.aPosCapture[i].y+110){return true;}}
return false;};HeroGoal3.prototype.makeSave=function(){var _this=this;if(enemyBall.shootState==0){this.saveState=2;return;}
playSound("saveFly"+Math.floor(Math.random()*2));userInput.removeHitArea("goalkeepingGameTouch");this.saveState=1;var a;var b;var tempPower=0;for(var i=0;i<enemyBall.aTouchData.length-1;i++){a=enemyBall.aTouchData[i+1].x-enemyBall.aTouchData[i].x;b=enemyBall.aTouchData[i+1].y-enemyBall.aTouchData[i].y;tempPower+=Math.sqrt(a*a+b*b);}
a=enemyBall.aTouchData[0].x-enemyBall.aTouchData[enemyBall.aTouchData.length-1].x;b=enemyBall.aTouchData[0].y-enemyBall.aTouchData[enemyBall.aTouchData.length-1].y;var tempAngle=Math.atan2(b,a);tempPower*=(enemyBall.maxSwipeLength/enemyBall.aTouchData.length);tempPower=Math.min(tempPower*.4,300);if(this.saveTween){this.saveTween.kill();}
this.saveTween=TweenLite.to(this,.3,{targX:Math.cos(tempAngle)*-tempPower,targY:Math.max(Math.min(Math.sin(tempAngle)*-tempPower,30),-120),ease:"Cubic.easeOut",onComplete:function(){_this.saveState=3;_this.setAnimType("once",_this.saveSide+"Stop");_this.animEndedFunc=_this.ambientAnim;}});var tempRad=tempAngle/radian;if(tempRad<-90||tempRad>=90){this.saveSide="right";this.hitOffsetX=0;}else{this.saveSide="left";this.hitOffsetX=0;}
this.setAnimType("once",this.saveSide+"Fly");this.animEndedFunc=null;};HeroGoal3.prototype.ambientAnim=function(){this.setAnimType("loop","ambient");};HeroGoal3.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.hoverInc+=delta;this.x=canvas.width/2+this.targX;this.y=canvas.height/2+this.targY+Math.sin(this.hoverInc*3)*5;this.aPosCapture.push({x:this.x,y:this.y});if(this.aPosCapture.length>10){this.aPosCapture.shift();}};HeroGoal3.prototype.render=function(){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2),canvas.height/2+135+shakeY,bWidth,bHeight);this.y=this.y+shakeY;_super.prototype.renderSimple.call(this,ctx);};return HeroGoal3;})(Utils.AnimSprite);Elements.HeroGoal3=HeroGoal3;})(Elements||(Elements={}));var Elements;(function(Elements){var HeroGoal4=(function(_super){__extends(HeroGoal4,_super);function HeroGoal4(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.hitRadius=110;this.hitOffsetX=0;this.setAnimType("loop","ambient");this.oGameElementsImgData=assetLib.getData("gameElements");this.scaleX=this.scaleY=1;this.reset();}
HeroGoal4.prototype.reset=function(){if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.moveX=0;this.moveY=0;this.driftX=0;this.incX=0;this.prevX=0;this.trailInc=0;this.aPosCapture=new Array();this.saveState=0;this.hitOffsetX=0;this.hasSprayed=false;this.setAnimType("loop","ambient");};HeroGoal4.prototype.checkSave=function(_x,_y){if(_x>this.x-100+this.hitOffsetX&&_x<this.x+100+this.hitOffsetX&&_y>this.y-60&&_y<this.y+130){return true;}else{return false;}};HeroGoal4.prototype.makeSave=function(){var _this=this;if(enemyBall.shootState==0){this.saveState=2;return;}
playSound("saveJump"+Math.floor(Math.random()*3));userInput.removeHitArea("goalkeepingGameTouch");this.saveState=1;var a;var b;var tempPower=0;for(var i=0;i<enemyBall.aTouchData.length-1;i++){a=enemyBall.aTouchData[i+1].x-enemyBall.aTouchData[i].x;b=enemyBall.aTouchData[i+1].y-enemyBall.aTouchData[i].y;tempPower+=Math.sqrt(a*a+b*b);}
a=enemyBall.aTouchData[0].x-enemyBall.aTouchData[enemyBall.aTouchData.length-1].x;b=enemyBall.aTouchData[0].y-enemyBall.aTouchData[enemyBall.aTouchData.length-1].y;var tempAngle=Math.atan2(b,a);tempPower*=(enemyBall.maxSwipeLength/enemyBall.aTouchData.length);tempPower=Math.min(tempPower*.4,275);if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.saveTweenX=TweenLite.to(this,1.3,{driftX:(Math.cos(tempAngle)*-tempPower)/2,ease:"Quad.easeOut",onComplete:function(){}});this.saveTweenY=TweenLite.to(this,.3,{moveX:Math.cos(tempAngle)*-tempPower,moveY:Math.max(Math.min(Math.sin(tempAngle)*-tempPower,0),-150),ease:"Cubic.easeOut",onComplete:function(){_this.saveState=3;_this.saveTweenY=TweenLite.to(_this,.3,{moveY:0,ease:"Cubic.easeIn",onComplete:function(){playSound("saveLand");_this.setAnimType("once",_this.saveSide+"Land");}});}});if(a>0){addSpray("left",this.x+50,canvas.height/2+120,1);}else{addSpray("right",this.x-50,canvas.height/2+120,1);}
var tempRad=tempAngle/radian;if(tempRad<-90||tempRad>=90){this.saveSide="right";this.hitOffsetX=0;}else{this.saveSide="left";this.hitOffsetX=0;}
this.setAnimType("once",this.saveSide+"Fly");this.animEndedFunc=null;};HeroGoal4.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.moveX+this.driftX;this.y=canvas.height/2+32+this.moveY;if(this.moveY>-5&&this.saveState==3&&!this.hasSprayed){addSpray("left",this.x+120,canvas.height/2+120,1);addSpray("right",this.x-120,canvas.height/2+120,1);this.hasSprayed=true;}
this.incX=this.x-this.prevX;this.prevX=this.x;};HeroGoal4.prototype.render=function(){var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.goalkeeperShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-(bWidth/2),canvas.height/2+135+shakeY,bWidth,bHeight);this.y=this.y+shakeY;_super.prototype.renderSimple.call(this,ctx);};return HeroGoal4;})(Utils.AnimSprite);Elements.HeroGoal4=HeroGoal4;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemyKick=(function(_super){__extends(EnemyKick,_super);function EnemyKick(_oImgData){_super.call(this,_oImgData,20,45,"ambient");this.aOffsets=new Array({x:200,y:-50},{x:172,y:-25},{x:177,y:-15},{x:210,y:-32},{x:180,y:-50});this.reset();}
EnemyKick.prototype.reset=function(){this.setAnimType("loop","ambient");allowUserSaveSwipe=false;};EnemyKick.prototype.takeShot=function(){allowUserSaveSwipe=true;this.setAnimType("once","kick0");this.animEndedFunc=this.endKick;};EnemyKick.prototype.celebrate=function(){this.setAnimType("once","celebrate");this.animEndedFunc=null;};EnemyKick.prototype.sad=function(){this.setAnimType("once","sad");this.animEndedFunc=null;};EnemyKick.prototype.endKick=function(){this.setAnimType("once","kick1");enemyBall.shoot();this.animEndedFunc=null;};EnemyKick.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.aOffsets[aEnemyOrder[levelNum]].x;this.y=canvas.height/2+this.aOffsets[aEnemyOrder[levelNum]].y;};EnemyKick.prototype.render=function(){this.y=this.y+shakeY;_super.prototype.renderSimple.call(this,ctx);};return EnemyKick;})(Utils.AnimSprite);Elements.EnemyKick=EnemyKick;})(Elements||(Elements={}));var Elements;(function(Elements){var HeroKick=(function(_super){__extends(HeroKick,_super);function HeroKick(_oImgData){_super.call(this,_oImgData,20,45,"ambient");this.aOffsets=new Array({x:0,y:218/2-1,scale:1.3},{x:0,y:212/2-1,scale:1.3},{x:0,y:195/2-1,scale:1.3},{x:0,y:197/2-1,scale:1.3},{x:0,y:183/2-1,scale:1.3});this.showKick=false;this.slideX=0;this.scaleX=this.scaleY=this.aOffsets[heroId].scale;}
HeroKick.prototype.takeShot=function(_ballXInc,_ballYInc){this.ballXInc=_ballXInc;this.ballYInc=_ballYInc;this.showKick=true;this.setAnimType("once","kick0");this.slideX=0;TweenLite.to(this,.5,{slideX:this.ballXInc/8,ease:"Quad.easeOut"});this.animEndedFunc=this.midKick;};HeroKick.prototype.midKick=function(){this.setAnimType("once","kick1");ball.shoot();enemySave.makeSave(this.ballXInc,this.ballYInc);this.animEndedFunc=this.endKick;};HeroKick.prototype.endKick=function(){this.showKick=false;};HeroKick.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.aOffsets[heroId].x+this.slideX;this.y=canvas.height-this.aOffsets[heroId].y*this.aOffsets[heroId].scale;};HeroKick.prototype.render=function(){this.y=this.y+shakeY;_super.prototype.renderSimple.call(this,ctx);};return HeroKick;})(Utils.AnimSprite);Elements.HeroKick=HeroKick;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemySave0=(function(_super){__extends(EnemySave0,_super);function EnemySave0(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.targX=0;this.targY=0;this.hitOffsetX=0;this.oGameElementsImgData=assetLib.getData("gameElements");this.offsetY=-this.oImgData.oData.spriteHeight/2+40;this.reset();}
EnemySave0.prototype.reset=function(){this.setAnimType("loop","ambient");if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.targX=0;this.targY=0;this.jumpHeight=0;this.hasLanded=false;this.hitOffsetX=0;this.trueSave=true;this.accuracyScale=getAccuracyScale();};EnemySave0.prototype.checkBallHit=function(_bx,_by){if(_bx>this.x-70+this.hitOffsetX&&_bx<this.x+70+this.hitOffsetX&&_by>this.y-50&&_by<this.y+50){return true;}else{return false;}};EnemySave0.prototype.makeSave=function(_ballXInc,_ballYInc){playSound("saveJump"+Math.floor(Math.random()*3));this.ballXInc=_ballXInc;this.ballYInc=_ballYInc;this.saveSide="right";this.hitOffsetX=25;if(ball.isGoldBall){if(_ballXInc<0){this.saveSide="left";this.hitOffsetX=-25;}
this.trueSave=false;}else if(!this.trueSave){if(Math.random()>.5){this.saveSide="left";this.hitOffsetX=-25;}}else{if(_ballXInc>0){this.saveSide="left";this.hitOffsetX=-25;}}
this.setAnimType("once",this.saveSide+"Jump");this.animEndedFunc=this.endJump;};EnemySave0.prototype.endJump=function(){if(!this.trueSave){var tempX=Math.random()*210+40;if(this.saveSide=="left"){tempX*=-1;}
this.targY=-(Math.random()*600+100);this.saveTweenX=TweenLite.to(this,1,{targX:tempX,ease:"Cubic.easeOut"});this.saveTweenY=TweenLite.to(this,.5,{targY:500,ease:"Linear.easeNone"});}else{var tempX=Math.min(Math.max(-this.ballXInc*300,-275),275)*this.accuracyScale;this.targY=Math.max((this.ballYInc+500)/1.5,-850)*this.accuracyScale;this.saveTweenX=TweenLite.to(this,.4,{targX:tempX,ease:"Cubic.easeOut"});this.saveTweenY=TweenLite.to(this,.5,{targY:500,ease:"Linear.easeNone"});}
this.setAnimType("once",this.saveSide+"Fly");this.animEndedFunc=null;};EnemySave0.prototype.land=function(){this.hasLanded=true;this.setAnimType("once",this.saveSide+"Land");this.animEndedFunc=null;playSound("saveLand");if(this.saveSide=="left"){addSpray("left",this.x+50,canvas.height/2+21,.6);addSpray("right",this.x-140,canvas.height/2+21,.6);}else{addSpray("left",this.x+140,canvas.height/2+21,.6);addSpray("right",this.x-50,canvas.height/2+21,.6);}};EnemySave0.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.targX;this.jumpHeight+=this.targY*delta;this.y=canvas.height/2+this.jumpHeight;if(this.y>canvas.height/2){this.y=canvas.height/2;if(!this.hasLanded){this.land();}}};EnemySave0.prototype.render=function(){this.y=this.y+shakeY;var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-bWidth/2,canvas.height/2+25,bWidth,bHeight);_super.prototype.renderSimple.call(this,ctx);};return EnemySave0;})(Utils.AnimSprite);Elements.EnemySave0=EnemySave0;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemySave2=(function(_super){__extends(EnemySave2,_super);function EnemySave2(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.targX=0;this.targY=0;this.hoverInc=0;this.isMovingRandomly=false;this.animoSave=false;this.oGameElementsImgData=assetLib.getData("gameElements");this.animo=new Elements.EnemySave2a(assetLib.getData("enemySave2a"));this.targX=100;this.targY=-100;this.reset();}
EnemySave2.prototype.reset=function(){this.animo.reset();this.setAnimType("loop","ambient");this.animoSave=false;this.accuracyScale=getAccuracyScale();if(!this.isMovingRandomly){this.tweenRandomPos();}};EnemySave2.prototype.tweenRandomPos=function(){var _this=this;if(this.saveTween){this.saveTween.kill();}
this.isMovingRandomly=true;var tempTargX=Math.random()*120+100;if(Math.random()>.5){tempTargX=-(Math.random()*120+100);}
this.saveTween=TweenLite.to(this,2,{targX:tempTargX,targY:-(Math.random()*130+30),ease:"Quad.easeInOut",onComplete:function(){_this.tweenRandomPos();}});};EnemySave2.prototype.checkBallHit=function(_bx,_by){if((_bx>this.x-40&&_bx<this.x+40&&_by>this.y-20&&_by<this.y+60)||this.animoSave){return true;}else{return false;}};EnemySave2.prototype.makeSave=function(_ballXInc,_ballYInc){playSound("saveFly"+Math.floor(Math.random()*2));this.ballXInc=_ballXInc;this.ballYInc=_ballYInc;if(ball.isGoldBall){this.accuracyScale=.2;}
this.saveSide="right";if(this.ballXInc*320>canvas.width/2-this.x){this.saveSide="left";}
if(this.ballXInc>-.15&&this.ballXInc<.15){this.animo.makeSave();this.animoSave=true;return;}else{this.animo.makePoint(this.ballXInc);}
this.setAnimType("once",this.saveSide+"Fly");this.animEndedFunc=this.stopAnim;var tempX=Math.min(Math.max(-this.ballXInc*320,-300),300);var tempY=Math.min(Math.max((this.ballYInc+1000)/5,-150),-25);if(this.saveTween){this.saveTween.kill();}
this.isMovingRandomly=false;this.saveTween=TweenLite.to(this,.5+(1-(this.accuracyScale*1)),{targX:tempX,targY:tempY,ease:"Cubic.easeInOut",onComplete:function(){}});};EnemySave2.prototype.stopAnim=function(){this.setAnimType("once",this.saveSide+"Stop");this.animEndedFunc=this.ambientAnim;};EnemySave2.prototype.ambientAnim=function(){this.setAnimType("loop","ambient");};EnemySave2.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.hoverInc+=delta;this.x=canvas.width/2+this.targX;this.y=canvas.height/2+this.targY+Math.sin(this.hoverInc*6)*5;this.animo.update();};EnemySave2.prototype.render=function(){this.y=this.y+shakeY;var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-bWidth/2,canvas.height/2+25,bWidth,bHeight);_super.prototype.renderSimple.call(this,ctx);this.animo.render();};return EnemySave2;})(Utils.AnimSprite);Elements.EnemySave2=EnemySave2;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemySave2a=(function(_super){__extends(EnemySave2a,_super);function EnemySave2a(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.reset();}
EnemySave2a.prototype.reset=function(){this.setAnimType("loop","ambient");};EnemySave2a.prototype.makeSave=function(){this.setAnimType("once","reach");this.animEndedFunc=null;};EnemySave2a.prototype.makePoint=function(_ballXInc){var saveSide="right";if(_ballXInc>canvas.width/2-this.x){saveSide="left";}
this.setAnimType("once",saveSide+"Point");this.animEndedFunc=null;};EnemySave2a.prototype.ambientAnim=function(){this.setAnimType("loop","ambient");};EnemySave2a.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2;this.y=canvas.height/2-55;};EnemySave2a.prototype.render=function(){_super.prototype.renderSimple.call(this,ctx);};return EnemySave2a;})(Utils.AnimSprite);Elements.EnemySave2a=EnemySave2a;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemySave3=(function(_super){__extends(EnemySave3,_super);function EnemySave3(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.targX=0;this.targY=0;this.hoverInc=0;this.isMovingRandomly=false;this.oGameElementsImgData=assetLib.getData("gameElements");this.offsetY=-this.oImgData.oData.spriteHeight/2+20;this.targX=0;this.targY=0;this.reset();}
EnemySave3.prototype.reset=function(){this.setAnimType("loop","ambient");this.accuracyScale=getAccuracyScale();if(!this.isMovingRandomly){this.tweenRandomPos();}};EnemySave3.prototype.tweenRandomPos=function(){var _this=this;if(this.saveTween){this.saveTween.kill();}
this.isMovingRandomly=true;this.saveTween=TweenLite.to(this,3,{targX:Math.random()*400-200,targY:Math.random()*60-50,ease:"Quad.easeInOut",onComplete:function(){_this.tweenRandomPos();}});};EnemySave3.prototype.checkBallHit=function(_bx,_by){if(_bx>this.x-40&&_bx<this.x+40&&_by>this.y-120&&_by<this.y+20){return true;}else{return false;}};EnemySave3.prototype.makeSave=function(_ballXInc,_ballYInc){playSound("saveFly"+Math.floor(Math.random()*2));this.ballXInc=_ballXInc;this.ballYInc=_ballYInc;if(ball.isGoldBall){this.accuracyScale=.2;}
this.saveSide="right";if(this.ballXInc*300>canvas.width/2-this.x){this.saveSide="left";}
this.setAnimType("once",this.saveSide+"Fly");this.animEndedFunc=this.stopAnim;var tempX=Math.min(Math.max(-this.ballXInc*300,-275),275);var tempY=Math.min(Math.max((this.ballYInc+1200)/15,-90),15);if(this.saveTween){this.saveTween.kill();}
this.isMovingRandomly=false;this.saveTween=TweenLite.to(this,.5+(1-(this.accuracyScale*1)),{targX:tempX,targY:tempY,ease:"Cubic.easeInOut",onComplete:function(){}});};EnemySave3.prototype.stopAnim=function(){this.setAnimType("once",this.saveSide+"Stop");this.animEndedFunc=this.ambientAnim;};EnemySave3.prototype.ambientAnim=function(){this.setAnimType("loop","ambient");this.tweenRandomPos();};EnemySave3.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.hoverInc+=delta;this.x=canvas.width/2+this.targX;this.y=canvas.height/2+this.targY+Math.sin(this.hoverInc*3)*5;};EnemySave3.prototype.render=function(){this.y=this.y+shakeY;var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-bWidth/2,canvas.height/2+25,bWidth,bHeight);_super.prototype.renderSimple.call(this,ctx);};return EnemySave3;})(Utils.AnimSprite);Elements.EnemySave3=EnemySave3;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemySave1=(function(_super){__extends(EnemySave1,_super);function EnemySave1(_oImgData){_super.call(this,_oImgData,19,45,"ambient");this.targX=0;this.targY=0;this.hitOffsetX=0;this.oGameElementsImgData=assetLib.getData("gameElements");this.offsetY=-this.oImgData.oData.spriteHeight/2+45;this.reset();}
EnemySave1.prototype.reset=function(){this.setAnimType("loop","ambient");if(this.saveTweenX){this.saveTweenX.kill();}
if(this.saveTweenY){this.saveTweenY.kill();}
this.targX=0;this.targY=0;this.jumpHeight=0;this.hasLanded=false;this.hitOffsetX=0;this.trueSave=true;this.accuracyScale=getAccuracyScale();};EnemySave1.prototype.makeSave=function(_ballXInc,_ballYInc){playSound("saveJump"+Math.floor(Math.random()*3));this.ballXInc=_ballXInc;this.ballYInc=_ballYInc;this.saveSide="right";this.hitOffsetX=25;if(ball.isGoldBall){if(_ballXInc<0){this.saveSide="left";this.hitOffsetX=-25;}
this.trueSave=false;}else if(!this.trueSave){if(Math.random()>.5){this.saveSide="left";this.hitOffsetX=-25;}}else{if(_ballXInc>0){this.saveSide="left";this.hitOffsetX=-25;}}
this.setAnimType("once",this.saveSide+"Jump");this.animEndedFunc=this.endJump;};EnemySave1.prototype.endJump=function(){if(!this.trueSave){var tempX=Math.random()*210+40;if(this.saveSide=="left"){tempX*=-1;}
this.targY=-(Math.random()*600+100);this.saveTweenX=TweenLite.to(this,1,{targX:tempX,ease:"Cubic.easeOut"});this.saveTweenY=TweenLite.to(this,.5,{targY:500,ease:"Linear.easeNone"});}else{var tempX=Math.min(Math.max(-this.ballXInc*330,-290),290)*this.accuracyScale;this.targY=Math.max((this.ballYInc+500)/1.3,-850)*this.accuracyScale;this.saveTweenX=TweenLite.to(this,.5,{targX:tempX,ease:"Cubic.easeOut"});this.saveTweenY=TweenLite.to(this,.5,{targY:700,ease:"Linear.easeNone"});}
this.setAnimType("once",this.saveSide+"Fly");this.animEndedFunc=null;};EnemySave1.prototype.land=function(){this.hasLanded=true;this.setAnimType("once",this.saveSide+"Land");this.animEndedFunc=null;playSound("saveLand");if(this.saveSide=="left"){addSpray("left",this.x+100,canvas.height/2+21,.6);addSpray("right",this.x-120,canvas.height/2+21,.6);}else{addSpray("left",this.x+120,canvas.height/2+21,.6);addSpray("right",this.x-100,canvas.height/2+21,.6);}};EnemySave1.prototype.checkBallHit=function(_bx,_by){if(_bx>this.x-60+this.hitOffsetX&&_bx<this.x+60+this.hitOffsetX&&_by>this.y-60&&_by<this.y+40){return true;}else{return false;}};EnemySave1.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2+this.targX;this.jumpHeight+=this.targY*delta;this.y=canvas.height/2+this.jumpHeight;if(this.y>canvas.height/2){this.y=canvas.height/2;if(!this.hasLanded){this.land();}}};EnemySave1.prototype.render=function(){this.y=this.y+shakeY;var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-bWidth/2,canvas.height/2+25,bWidth,bHeight);_super.prototype.renderSimple.call(this,ctx);};return EnemySave1;})(Utils.AnimSprite);Elements.EnemySave1=EnemySave1;})(Elements||(Elements={}));var Elements;(function(Elements){var EnemySave4=(function(_super){__extends(EnemySave4,_super);function EnemySave4(_oImgData){_super.call(this,_oImgData,18,45,"ambient");this.targX=0;this.targY=0;this.hitOffsetX=0;this.saveState=0;this.aEyePos={left:[-14,-110],right:[-2,-117]};this.oGameElementsImgData=assetLib.getData("gameElements");this.offsetY=-this.oImgData.oData.spriteHeight/2+45;this.reset();}
EnemySave4.prototype.reset=function(){this.setAnimType("loop","ambient");this.saveState=0;this.laserAlpha=0;this.accuracyScale=getAccuracyScale();};EnemySave4.prototype.makeSave=function(_ballXInc,_ballYInc){this.ballXInc=_ballXInc;this.ballYInc=_ballYInc;this.saveSide="right";this.hitOffsetX=25;if(_ballXInc>0){this.saveSide="left";this.hitOffsetX=-25;}
if(this.ballXInc>-.4&&this.ballXInc<.4){if(this.ballXInc>.2||this.ballXInc<-.2){this.setAnimType("once",this.saveSide+"Slap");this.animEndedFunc=this.backToAmbient;this.saveState=2;playSound("saveJump"+Math.floor(Math.random()*3));}else{this.saveState=1;}}else{this.setAnimType("once",this.saveSide+"Laser");playSound("saveFly"+Math.floor(Math.random()*2));this.animEndedFunc=null;this.saveState=3;}};EnemySave4.prototype.backToAmbient=function(){this.setAnimType("loop","ambient");};EnemySave4.prototype.checkBallHit=function(_bx,_by){if(this.saveState==1){return true;}else if(this.saveState==2){if(Math.random()>=this.accuracyScale+(1-this.accuracyScale)*((this.ballXInc-.2)*5)||ball.isGoldBall){return false;}else{return true;}}else if(this.saveState==3){if(Math.random()>=this.accuracyScale||ball.isGoldBall){if(Math.random()>.5){this.laserMissY=Math.random()*20+30;}else{this.laserMissY=-(Math.random()*20+30);}
this.saveState=4;this.fireLaser();return false;}else{this.laserMissY=0;this.fireLaser();ball.hideMe=true;addExplosion(0,ball.x,ball.y-ball.height*ball.scale+ball.ballRadius,1);addFirework(0,ball.x,ball.y-ball.height*ball.scale+ball.ballRadius,1,true);addFirework(1,ball.x,ball.y-ball.height*ball.scale+ball.ballRadius,1,false);return true;}}};EnemySave4.prototype.fireLaser=function(){this.laserAlpha=15;TweenLite.to(this,.4,{laserAlpha:0,ease:"Quad.easeOut"});};EnemySave4.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);this.x=canvas.width/2;this.y=canvas.height/2;};EnemySave4.prototype.render=function(){this.y=this.y+shakeY;var bX=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].x;var bY=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].y;var bWidth=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].width;var bHeight=this.oGameElementsImgData.oData.oAtlasData[oImageIds.enemySaveShadow].height;ctx.drawImage(this.oGameElementsImgData.img,bX,bY,bWidth,bHeight,this.x-bWidth/2,canvas.height/2+25,bWidth,bHeight);_super.prototype.renderSimple.call(this,ctx);if(this.saveState>=3&&this.laserAlpha>0){ctx.strokeStyle="#FF0000";ctx.lineWidth=this.laserAlpha;var x1=this.x+this.aEyePos[this.saveSide][0];var y1=this.y+this.aEyePos[this.saveSide][1];var x2=x1-(x1-ball.x)*3;var y2=y1-(y1-(ball.y-ball.height*ball.scale+this.laserMissY))*3;if(y2>canvas.height/2+30){x2=x1-(x1-ball.x);y2=y1-(y1-(ball.y-ball.height*ball.scale+this.laserMissY));}
ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();ctx.strokeStyle="#FFFFFF";ctx.lineWidth=this.laserAlpha/4;ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();}};return EnemySave4;})(Utils.AnimSprite);Elements.EnemySave4=EnemySave4;})(Elements||(Elements={}));var Elements;(function(Elements){var Wipe=(function(){function Wipe(){this.canDisplay=false;this.inGoal=false;this.stackedFunc=null;}
Wipe.prototype.trigger=function(_func){var _this=this;if(this.wipeTween&&this.wipeTween.isActive()){this.stackedFunc=_func;return;}
if(oGameData.curTime<=0&&!oGameData.timesUp){oGameData.timesUp=true;if(gameState=="shooting"){_func=initShootingComplete;playSound("endWhistle");}else{_func=initGoalkeepingComplete;playSound("endWhistle");}}
if(this.inGoal){this.oWipeImgData=assetLib.getData("wipe0");}else{this.oWipeImgData=assetLib.getData("wipe1");}
this.x=-canvas.width*2;this.canDisplay=true;if(this.wipeTween){this.wipeTween.kill();}
this.wipeTween=TweenLite.to(this,.2,{x:-canvas.width/2,ease:"Linear.easeNone",onComplete:function(){_func();_this.wipeTween=TweenLite.to(_this,.2,{x:canvas.width,ease:"Linear.easeNone",onComplete:function(){_this.canDisplay=false;if(_this.stackedFunc!=null){_this.trigger(_this.stackedFunc);_this.stackedFunc=null;}}});}});};Wipe.prototype.render=function(){if(this.canDisplay){ctx.drawImage(this.oWipeImgData.img,0,0,this.oWipeImgData.img.width,this.oWipeImgData.img.height,this.x,0,canvas.width*2,canvas.height);}};return Wipe;})();Elements.Wipe=Wipe;})(Elements||(Elements={}));var Elements;(function(Elements){var Tutorial=(function(_super){__extends(Tutorial,_super);function Tutorial(_oImgData,_tutBg){_super.call(this,_oImgData,16,45,"anim");this.tutBg=0;this.oUiElementsImgData=assetLib.getData("uiElements");this.tutBg=_tutBg;this.setAnimType("loop","anim");}
Tutorial.prototype.update=function(){_super.prototype.updateAnimation.call(this,delta);if(this.tutBg==0){this.x=canvas.width/2+100;this.y=canvas.height/2+37;}else{this.x=canvas.width/2-25;this.y=canvas.height/2+45;}};Tutorial.prototype.render=function(){ctx.fillStyle="rgba(0, 0, 0, 0.75)";ctx.fillRect(0,0,canvas.width,canvas.height);var bX=this.oUiElementsImgData.oData.oAtlasData[oImageIds["tutBg"+this.tutBg]].x;var bY=this.oUiElementsImgData.oData.oAtlasData[oImageIds["tutBg"+this.tutBg]].y;var bWidth=this.oUiElementsImgData.oData.oAtlasData[oImageIds["tutBg"+this.tutBg]].width;var bHeight=this.oUiElementsImgData.oData.oAtlasData[oImageIds["tutBg"+this.tutBg]].height;ctx.drawImage(this.oUiElementsImgData.img,bX,bY,bWidth,bHeight,canvas.width/2-bWidth/2,canvas.height/2-bHeight/2,bWidth,bHeight);_super.prototype.renderSimple.call(this,ctx);};return Tutorial;})(Utils.AnimSprite);Elements.Tutorial=Tutorial;})(Elements||(Elements={}));var Utils;(function(Utils){var SaveDataHandler=(function(){function SaveDataHandler(_saveDataId){this.dataGroupNum=2;this.saveDataId=_saveDataId;var testKey='test',storage=window.sessionStorage;try{storage.setItem(testKey,'1');storage.removeItem(testKey);this.canStore=true;}catch(error){this.canStore=false;}
this.clearData();this.setInitialData();}
SaveDataHandler.prototype.isFirstRun=function(){var temp=true;for(var i=0;i<this.aLevelStore.length;i++){if(this.aLevelStore[i]>0){temp=false;break;}}
return temp;};SaveDataHandler.prototype.clearData=function(){this.aLevelStore=new Array();for(var i=0;i<5;i++){this.aLevelStore.push(0);}};SaveDataHandler.prototype.resetData=function(){this.clearData();this.saveData();};SaveDataHandler.prototype.setInitialData=function(){if(this.canStore&&typeof(Storage)!=="undefined"){if(localStorage.getItem(this.saveDataId)!=null&&localStorage.getItem(this.saveDataId)!=""){this.aLevelStore=localStorage.getItem(this.saveDataId).split(",");for(var a in this.aLevelStore){this.aLevelStore[a]=parseInt(this.aLevelStore[a]);}}else{this.saveData();}}};SaveDataHandler.prototype.setData=function(_heroId,_enemyDefeated){this.aLevelStore[_heroId]=_enemyDefeated;};SaveDataHandler.prototype.getCurEnemy=function(_heroId){return this.aLevelStore[_heroId];};SaveDataHandler.prototype.saveData=function(){if(this.canStore&&typeof(Storage)!=="undefined"){var str="";for(var i=0;i<this.aLevelStore.length;i++){str+=this.aLevelStore[i];if(i<this.aLevelStore.length-1){str+=",";}}
localStorage.setItem(this.saveDataId,str);}};return SaveDataHandler;})();Utils.SaveDataHandler=SaveDataHandler;})(Utils||(Utils={}));var requestAnimFrame=(function(){return window.requestAnimationFrame||(window).webkitRequestAnimationFrame||(window).mozRequestAnimationFrame||(window).oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000/60,new Date().getTime());};})();var previousTime;var canvas=document.getElementById('canvas');var ctx=canvas.getContext("2d");var minWidth=750;var minHeight=450;var maxWidth=850;var maxHeight=550;var maxSafeWidth=1050;var maxSafeHeight=660;var canvasX;var canvasY;var canvasScale;var div=document.getElementById('canvas-wrapper');var sound;var music;var audioType=0;var muted=false;var splashTimer=0;var assetLib;var preAssetLib;var isMobile=false;var gameState="loading";var curLang="";var isBugBrowser=false;var isIE10=false;var delta;var radian=Math.PI/180;var ios9FirstTouch=false;var hasFocus=true;var saveDataHandler=new Utils.SaveDataHandler("footballfaceoffv3");var isRotated=false;if(navigator.userAgent.match(/MSIE\s([\d]+)/)){isIE10=true;}
var deviceAgent=navigator.userAgent.toLowerCase();if(deviceAgent.match(/(iphone|ipod|ipad)/)||deviceAgent.match(/(android)/)||deviceAgent.match(/(iemobile)/)||deviceAgent.match(/iphone/i)||deviceAgent.match(/ipad/i)||deviceAgent.match(/ipod/i)||deviceAgent.match(/blackberry/i)||deviceAgent.match(/bada/i)){isMobile=true;if(deviceAgent.match(/(android)/)&&!/Chrome/.test(navigator.userAgent)){isBugBrowser=true;}}
var userInput=new Utils.UserInput(canvas,isBugBrowser);resizeCanvas();window.onresize=function(){setTimeout(function(){resizeCanvas();},1);};function visibleResume(){if(!hasFocus){if(userInput){userInput.checkKeyFocus();}
if(!muted&&gameState!="pause"&&gameState!="splash"&&gameState!="loading"){Howler.mute(false);playMusic();}}
hasFocus=true;}
function visiblePause(){hasFocus=false;Howler.mute(true);music.pause();}
(window).onpageshow=function(){if(!hasFocus){if(userInput){userInput.checkKeyFocus();}
if(!muted&&gameState!="pause"&&gameState!="splash"&&gameState!="loading"){Howler.mute(false);playMusic();}}
hasFocus=true;};(window).onpagehide=function(){hasFocus=false;Howler.mute(true);music.pause();};function playMusic(){if(!music.playing()){music.play();}}
window.addEventListener("load",function(){setTimeout(function(){resizeCanvas();},0);window.addEventListener("orientationchange",function(){setTimeout(function(){resizeCanvas();},500);setTimeout(function(){resizeCanvas();},2000);},false);});function isStock(){var matches=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return matches&&parseFloat(matches[1])<537;}
var ua=navigator.userAgent;var isSharpStock=((/SHL24|SH-01F/i).test(ua))&&isStock();var isXperiaAStock=((/SO-04E/i).test(ua))&&isStock();var isFujitsuStock=((/F-01F/i).test(ua))&&isStock();if(!isIE10&&!isSharpStock&&!isXperiaAStock&&!isFujitsuStock&&(typeof(window).AudioContext!=='undefined'||typeof(window).webkitAudioContext!=='undefined'||navigator.userAgent.indexOf('Android')==-1)){audioType=1;sound=new Howl({src:['audio/sound.mp3'],sprite:{transform:[0,3600],powerBarUp:[4000,1000],click:[5500,600],powerBarFull:[6500,1500],bonusTime:[8500,1300],matchWin:[10500,4000],matchLose:[15000,2500],nextMatch:[18000,3000],startWhistle:[21500,600],endWhistle:[22500,2000],kick0:[24500,1000],kick1:[26000,1000],kick2:[27500,1000],bounce0:[29000,300],bounce1:[29500,300],bounce2:[30000,300],bounce3:[30500,300],bounce4:[31000,300],missShotWipe:[31500,800],hitBar:[32500,800],powerKick:[33500,2000],crowdBad0:[36000,3200],crowdGood0:[39500,4600],crowdBad1:[44500,1950],crowdGood1:[46500,5500],crowdGood2:[52500,5500],saveLand:[58500,800],saveFly0:[59500,1000],saveFly1:[61000,1500],saveJump0:[63000,400],saveJump1:[63500,400],saveJump2:[64000,400],changeEnds:[64500,2200],heroScore:[67000,1500],enemyScore:[69000,1500],heroSave:[71000,1500],enemySave:[73000,1500]}});music=new Howl({src:['audio/music.mp3'],volume:0,loop:true,html5:false,mobileAutoEnable:true});}else{audioType=0;}
var panel;var background;var totalScore=0;var levelScore=0;var levelNum=0;var panelFrame;var oLogoData={};var oLogoBut;var musicTween;var oImageIds={};var prevGameState;var aFireworks;var ball;var touchState;var touchX;var touchY;var curTouches;var crowd;var heroId;var hud;var oGameData;var flashRate=.02;var enemyHud;var enemyBall;var enemyCrowd;var heroGoal;var shakeY=0;var shakeTween;var fireworkTimer;var fireworkNum;var enemyKick;var enemySave;var aHeroHeadIconOffsets=new Array({x:18,y:-5},{x:10,y:5},{x:10,y:20},{x:0,y:0},{x:0,y:0});var aEnemyHeadIconOffsets=new Array({x:-5,y:-5},{x:-5,y:0},{x:-3,y:10},{x:-15,y:0},{x:-10,y:-5});var wipe;var aEnemyOrder=new Array(0,2,1,3,4);var prePauseGameState;var hasSaved=false;var textInc=0;var firstRun=true;var showingTut=false;var allowUserSaveSwipe=false;var firstFail=false;var tempLang=window.location.href.split("?lang=")[1];function loadGame(_lang){if(!tempLang){loadPreAssets(_lang);}else{loadPreAssets(tempLang);}}
function initSplash(){gameState="splash";if(audioType==1&&!muted){playMusic();if(!hasFocus){music.pause();}}
wipe=new Elements.Wipe();initIntroScreen();resizeCanvas();}
function initIntroScreen(){gameState="intro";if(audioType==1){music.fade(music.volume(),.15,500);}
var oPlayBut={oImgData:assetLib.getData("uiButs"),aPos:[-60,-44],align:[1,1],id:oImageIds.nextBut,idOver:oImageIds.nextButOver,flash:true};userInput.addHitArea("playOnIntroScreen",butEventHandler,null,"image",oPlayBut);var aButs=new Array(oPlayBut);addMuteBut(aButs);resetGameData();panel=new Elements.Panel(aButs);panel.introTween();previousTime=new Date().getTime();updateIntroScreenEvent();}
function initOutroScreen(){gameState="outro";var oPlayBut={oImgData:assetLib.getData("uiButs"),aPos:[-60,-44],align:[1,1],id:oImageIds.nextBut,idOver:oImageIds.nextButOver,flash:true};userInput.addHitArea("playOnOutroScreen",butEventHandler,null,"image",oPlayBut);var aButs=new Array(oPlayBut);addMuteBut(aButs);aFireworks=new Array();resetGameData();panel=new Elements.Panel(aButs);panel.outroTween();previousTime=new Date().getTime();updateOutroScreenEvent();}
function initStartScreen(){gameState="start";userInput.removeHitArea("moreGames");firstRun=saveDataHandler.isFirstRun();if(audioType==1){music.fade(music.volume(),.15,500);}
var oPlayBut={oImgData:assetLib.getData("uiButs"),aPos:[-90,-75],align:[1,1],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:true};var oCreditsBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.infoBut,idOver:oImageIds.infoButOver};userInput.addHitArea("playOnStartScreen",butEventHandler,null,"image",oPlayBut);userInput.addHitArea("credits",butEventHandler,null,"image",oCreditsBut);var aButs=new Array(oPlayBut,oCreditsBut);addMuteBut(aButs);aFireworks=new Array();resetGameData();panel=new Elements.Panel(aButs);panel.startScreenTween();previousTime=new Date().getTime();updateStartScreenEvent();}
function resetGameData(){oGameData={timesUp:false,curTime:4500,heroScore:0,enemyScore:0,power:0,swipeTime:0,ballInPlay:false,goalsInRow:0};}
function addMuteBut(_aButs){if(audioType==1){var mb=oImageIds.muteBut0;var mbOver=oImageIds.muteBut0Over;if(muted){mb=oImageIds.muteBut1;mbOver=oImageIds.muteBut1Over;}
var oMuteBut={oImgData:assetLib.getData("uiButs"),aPos:[-37,37],align:[1,0],id:mb,idOver:mbOver};userInput.addHitArea("mute",butEventHandler,null,"image",oMuteBut);for(var i=0;i<_aButs.length;i++){if(_aButs[i].id==oImageIds.muteBut0||_aButs[i].id==oImageIds.muteBut1){return;}}
_aButs.push(oMuteBut);}}
function initCreditsScreen(){gameState="credits";var oBackBut={oImgData:assetLib.getData("uiButs"),aPos:[60,-44],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver,flash:false};var oResetBut={oImgData:assetLib.getData("uiButs"),aPos:[-60,-44],align:[1,1],id:oImageIds.resetBut,idOver:oImageIds.resetButOver,flash:false};userInput.addHitArea("backFromCredits",butEventHandler,null,"image",oBackBut);userInput.addHitArea("resetData",butEventHandler,null,"image",oResetBut);var aButs=new Array(oBackBut,oResetBut);addMuteBut(aButs);panel=new Elements.Panel(aButs);panel.startTween1();previousTime=new Date().getTime();updateCreditsScreenEvent();}
function initCharSelectScreen(){gameState="charSelect";if(audioType==1){music.fade(music.volume(),.15,500);}
var oCharBut0={oImgData:assetLib.getData("uiButs"),aPos:[-214,-70],align:[.43,.5],id:oImageIds.charBut0,idOver:oImageIds.charBut0Over,flash:true};var oCharBut1={oImgData:assetLib.getData("uiButs"),aPos:[0,-70],align:[.43,.5],id:oImageIds.charBut1,idOver:oImageIds.charBut1Over,flash:true};var oCharBut2={oImgData:assetLib.getData("uiButs"),aPos:[214,-70],align:[.43,.5],id:oImageIds.charBut2,idOver:oImageIds.charBut2Over,flash:true};var oCharBut3={oImgData:assetLib.getData("uiButs"),aPos:[-107,105],align:[.43,.5],id:oImageIds.charBut3,idOver:oImageIds.charBut3Over,flash:true};var oCharBut4={oImgData:assetLib.getData("uiButs"),aPos:[107,105],align:[.43,.5],id:oImageIds.charBut4,idOver:oImageIds.charBut4Over,flash:true};var oBackBut={oImgData:assetLib.getData("uiButs"),aPos:[60,-44],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver,flash:false};userInput.addHitArea("chooseChar",butEventHandler,{id:0},"image",oCharBut0);userInput.addHitArea("chooseChar",butEventHandler,{id:1},"image",oCharBut1);userInput.addHitArea("chooseChar",butEventHandler,{id:2},"image",oCharBut2);userInput.addHitArea("chooseChar",butEventHandler,{id:3},"image",oCharBut3);userInput.addHitArea("chooseChar",butEventHandler,{id:4},"image",oCharBut4);userInput.addHitArea("backFromCharSelect",butEventHandler,null,"image",oBackBut);var aButs=new Array(oCharBut0,oCharBut1,oCharBut2,oCharBut3,oCharBut4,oBackBut);addMuteBut(aButs);panel=new Elements.Panel(aButs);panel.startTween1();previousTime=new Date().getTime();updateCharSelectScreenEvent();}
function initVersusScreen(_resetState){if(typeof _resetState==="undefined"){_resetState=3;}
gameState="versusScreen";if(_resetState==2){if(levelNum<4){levelNum++;}}
if(levelNum>0||this.evolved){if(audioType==1){music.fade(music.volume(),.25,500);}}else{if(audioType==1){music.fade(music.volume(),0,10);}}
var oPlayBut;var aButs=new Array();if(_resetState==0||_resetState==1){oPlayBut={oImgData:assetLib.getData("uiButs"),aPos:[-90,-75],align:[1,1],id:oImageIds.replayBut,idOver:oImageIds.replayButOver,flash:true};userInput.addHitArea("playOnVersusScreen",butEventHandler,null,"image",oPlayBut);aButs.push(oPlayBut);}else if(levelNum>0||panel.evolved){oPlayBut={oImgData:assetLib.getData("uiButs"),aPos:[-90,-75],align:[1,1],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:true};userInput.addHitArea("playOnVersusScreen",butEventHandler,null,"image",oPlayBut);aButs.push(oPlayBut);}
panel=new Elements.Panel(aButs);if(_resetState==0||_resetState==1){panel.evolved=true;}
panel.resetState=_resetState;if(levelNum>0||panel.evolved){var oBackBut={oImgData:assetLib.getData("uiButs"),aPos:[60,-44],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver,flash:false};userInput.addHitArea("backFromVersusScreen",butEventHandler,null,"image",oBackBut);aButs.push(oBackBut);}
addMuteBut(aButs);aFireworks=new Array();resetGameData();if(levelNum==0&&!panel.evolved){panel.startEvolveTween();}else{panel.startTween1();}
previousTime=new Date().getTime();updateVersusScreenEvent();}
function addVersusButs(){var oPlayBut={oImgData:assetLib.getData("uiButs"),aPos:[-90,-75],align:[1,1],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:true};userInput.addHitArea("playOnVersusScreen",butEventHandler,null,"image",oPlayBut);var oBackBut={oImgData:assetLib.getData("uiButs"),aPos:[60,-44],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver,flash:false};userInput.addHitArea("backFromVersusScreen",butEventHandler,null,"image",oBackBut);panel.aButs.push(oPlayBut,oBackBut);panel.posY=500;TweenLite.to(panel,.5,{posY:0,ease:"Back.easeOut"});}
function initShooting(){playSound("startWhistle");gameState="shooting";if(audioType==1){music.fade(music.volume(),.25,1000);}
var aButs=new Array();addMuteBut(aButs);if(firstRun){var oTutDoneBut={oImgData:assetLib.getData("uiButs"),aPos:[-90,-75],align:[1,1],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:true};userInput.addHitArea("playOnTut0Screen",butEventHandler,null,"image",oTutDoneBut);aButs.push(oTutDoneBut);showingTut=true;}else{var oPauseBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",oPauseBut);aButs.push(oPauseBut);userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);showingTut=false;}
panel=new Elements.Panel(aButs);panel.startTween1();touchState=0;curTouches=0;oGameData.curTime=4500;oGameData.ballInPlay=false;oGameData.timesUp=false;oGameData.goalsInRow=0;crowd=new Elements.Crowd();hud=new Elements.Hud();enemySave=new Elements["EnemySave"+aEnemyOrder[levelNum]](assetLib.getData("enemySave"+aEnemyOrder[levelNum]));aFireworks=new Array();ball=new Elements.Ball();previousTime=new Date().getTime();updateShootingEvent();}
function blockUI(_block){if(_block){userInput.removeHitArea("pause");userInput.removeHitArea("mute");}else{var oPauseBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",oPauseBut);addMuteBut(panel.aButs);}}
function initGoalkeeping(){gameState="goalkeeping";playSound("startWhistle");if(audioType==1){music.fade(music.volume(),.25,1000);}
userInput.removeHitArea("shootingGameTouch");var aButs=new Array();addMuteBut(aButs);if(firstRun){var oTutDoneBut={oImgData:assetLib.getData("uiButs"),aPos:[-90,-75],align:[1,1],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:true};userInput.addHitArea("playOnTut1Screen",butEventHandler,null,"image",oTutDoneBut);aButs.push(oTutDoneBut);showingTut=true;}else{var oPauseBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",oPauseBut);userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);aButs.push(oPauseBut);showingTut=false;}
panel=new Elements.Panel(aButs);panel.startTween1();touchState=0;enemyKick=new Elements.EnemyKick(assetLib.getData("enemyKick"+aEnemyOrder[levelNum]));enemyCrowd=new Elements.EnemyCrowd();enemyHud=new Elements.EnemyHud();heroGoal=new Elements["HeroGoal"+heroId](assetLib.getData("heroGoal"+heroId));oGameData.curTime=4500;oGameData.ballInPlay=false;oGameData.timesUp=false;aFireworks=new Array();enemyBall=new Elements.EnemyBall();previousTime=new Date().getTime();updateGoalkeepingEvent();}
function initPause(){gameState="pause";var oPlayBut={oImgData:assetLib.getData("uiButs"),aPos:[90,0],align:[.5,.5],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:true};var oReplayBut={oImgData:assetLib.getData("uiButs"),aPos:[-90,0],align:[.5,.5],id:oImageIds.replayBut,idOver:oImageIds.replayButOver,flash:true};var oQuitBut={oImgData:assetLib.getData("uiButs"),aPos:[60,-44],align:[0,1],id:oImageIds.quitBut,idOver:oImageIds.quitButOver};userInput.addHitArea("resumeGameFromPause",butEventHandler,{gameState:gameState},"image",oPlayBut);userInput.addHitArea("replayGameFromPause",butEventHandler,{gameState:gameState},"image",oReplayBut);userInput.addHitArea("quitGameFromPause",butEventHandler,{gameState:gameState},"image",oQuitBut);var aButs=new Array(oPlayBut,oReplayBut,oQuitBut);panel=new Elements.Panel(aButs);panel.startTween1();previousTime=new Date().getTime();updatePauseEvent();}
function resumeShooting(){gameState="shooting";var oPauseBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",oPauseBut);var aButs=new Array(oPauseBut);addMuteBut(aButs);if(!oGameData.ballInPlay){userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);}
panel=new Elements.Panel(aButs);panel.startTween1();previousTime=new Date().getTime();updateShootingEvent();}
function resumeGoalkeeping(){gameState="goalkeeping";var oPauseBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",oPauseBut);var aButs=new Array(oPauseBut);addMuteBut(aButs);if(!hasSaved){userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);}
panel=new Elements.Panel(aButs);panel.startTween1();previousTime=new Date().getTime();updateGoalkeepingEvent();}
function butEventHandler(_id,_oData){if(isRotated){return;}
switch(_id){case "langSelect":break;case "playOnIntroScreen":playSound("click");userInput.removeHitArea("playOnIntroScreen");wipe.trigger(initStartScreen);break;case "playOnOutroScreen":playSound("click");userInput.removeHitArea("playOnOutroScreen");wipe.trigger(initCharSelectScreen);break;case "credits":playSound("click");userInput.removeHitArea("playOnStartScreen");userInput.removeHitArea("credits");userInput.removeHitArea("mute");wipe.trigger(initCreditsScreen);break;case "backFromCredits":playSound("click");userInput.removeHitArea("backFromCredits");userInput.removeHitArea("resetData");userInput.removeHitArea("mute");wipe.trigger(initStartScreen);break;case "resetData":playSound("click");userInput.removeHitArea("backFromCredits");userInput.removeHitArea("resetData");userInput.removeHitArea("mute");saveDataHandler.resetData();wipe.trigger(initStartScreen);break;case "playOnStartScreen":playSound("click");userInput.removeHitArea("playOnStartScreen");userInput.removeHitArea("credits");userInput.removeHitArea("mute");wipe.trigger(initCharSelectScreen);break;case "chooseChar":userInput.removeHitArea("chooseChar");userInput.removeHitArea("backFromCharSelect");userInput.removeHitArea("mute");heroId=_oData.id;levelNum=saveDataHandler.getCurEnemy(heroId);if(levelNum==0){playSound("transform");}else{playSound("nextMatch");}
if(levelNum==5){levelNum=0;saveDataHandler.setData(heroId,0);saveDataHandler.saveData();}
wipe.trigger(initVersusScreen);break;case "backFromCharSelect":playSound("click");userInput.removeHitArea("chooseChar");userInput.removeHitArea("backFromCharSelect");userInput.removeHitArea("mute");wipe.trigger(initStartScreen);break;case "playOnVersusScreen":playSound("click");userInput.removeHitArea("playOnVersusScreen");userInput.removeHitArea("backFromVersusScreen");userInput.removeHitArea("mute");wipe.trigger(initShooting);break;case "backFromVersusScreen":playSound("click");userInput.removeHitArea("playOnVersusScreen");userInput.removeHitArea("backFromVersusScreen");userInput.removeHitArea("mute");wipe.trigger(initCharSelectScreen);break;case "playOnTut0Screen":playSound("click");userInput.removeHitArea("playOnTut0Screen");userInput.removeHitArea("mute");showingTut=false;var oPauseBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",oPauseBut);panel.aButs=new Array(oPauseBut);setTimeout(function(){userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);},500);addMuteBut(panel.aButs);break;case "playOnTut1Screen":playSound("click");userInput.removeHitArea("playOnTut1Screen");userInput.removeHitArea("mute");showingTut=false;firstRun=false;var oPauseBut={oImgData:assetLib.getData("uiButs"),aPos:[-104,37],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",oPauseBut);setTimeout(function(){userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);},500);enemyBall.startKickTween();panel.aButs=new Array(oPauseBut);addMuteBut(panel.aButs);break;case "shootingGameTouch":if(_oData.isDown&&curTouches<2){if(touchState!=2){if(touchState==0){ball.aTouchData=new Array();touchState=1;blockUI(true);oGameData.swipeTime=0;}
ball.aTouchData.push({x:_oData.x,y:_oData.y,alpha:.25});if(ball.aTouchData.length>ball.maxSwipeLength&&ball.isForwardKick()){touchState=0;blockUI(false);ball.shootPrep();userInput.removeHitArea("shootingGameTouch");}}}else{touchState=0;if(ball.aTouchData.length>2&&ball.isForwardKick()){blockUI(false);ball.shootPrep();userInput.removeHitArea("shootingGameTouch");}}
break;case "goalkeepingGameTouch":if(!allowUserSaveSwipe){break;}
if(_oData.isDown&&curTouches<2){if(touchState!=2){if(touchState==0){enemyBall.aTouchData=new Array();blockUI(true);touchState=1;}
enemyBall.aTouchData.push({x:_oData.x,y:_oData.y,alpha:.25});if(enemyBall.aTouchData.length>enemyBall.maxSwipeLength){heroGoal.makeSave();blockUI(false);touchState=0;hasSaved=true;}}}else{touchState=0;if(enemyBall.aTouchData.length>2){heroGoal.makeSave();blockUI(false);hasSaved=true;}}
break;case "retryFromEnd":playSound("click");userInput.removeHitArea("retryFromEnd");userInput.removeHitArea("quitFromEnd");levelScore=0;initShooting();break;case "quitFromEnd":playSound("click");userInput.removeHitArea("retryFromEnd");userInput.removeHitArea("quitFromEnd");initStartScreen();break;case "mute":playSound("click");toggleMute();if(muted){panel.switchBut(oImageIds.muteBut0,oImageIds.muteBut1,oImageIds.muteBut1Over);}else{panel.switchBut(oImageIds.muteBut1,oImageIds.muteBut0,oImageIds.muteBut0Over);}
break;case "pause":if(wipe.wipeTween.isActive()){break;}
playSound("click");if(audioType==1){Howler.mute(true);music.pause();}else if(audioType==2){music.pause();}
userInput.removeHitArea("pause");userInput.removeHitArea("shootingGameTouch");userInput.removeHitArea("goalkeepingGameTouch");userInput.removeHitArea("mute");prePauseGameState=gameState;if(prePauseGameState=="shooting"){ball.pause(true);}else{enemyBall.pause(true);}
initPause();break;case "resumeGameFromPause":playSound("click");if(audioType==1){if(!muted){Howler.mute(false);playMusic();}}else if(audioType==2){if(!muted){playMusic();}}
userInput.removeHitArea("quitGameFromPause");userInput.removeHitArea("resumeGameFromPause");userInput.removeHitArea("replayGameFromPause");userInput.removeHitArea("mute");if(prePauseGameState=="shooting"){ball.pause(false);wipe.trigger(resumeShooting);}else{enemyBall.pause(false);wipe.trigger(resumeGoalkeeping);}
break;case "quitGameFromPause":playSound("click");if(audioType==1){if(!muted){Howler.mute(false);playMusic();}}else if(audioType==2){if(!muted){playMusic();}}
userInput.removeHitArea("quitGameFromPause");userInput.removeHitArea("resumeGameFromPause");userInput.removeHitArea("replayGameFromPause");userInput.removeHitArea("mute");levelScore=0;totalScore=0;wipe.trigger(initStartScreen);break;case "replayGameFromPause":playSound("click");if(audioType==1){if(!muted){Howler.mute(false);playMusic();}}else if(audioType==2){if(!muted){playMusic();}}
userInput.removeHitArea("quitGameFromPause");userInput.removeHitArea("resumeGameFromPause");userInput.removeHitArea("replayGameFromPause");userInput.removeHitArea("mute");if(prePauseGameState=="shooting"){oGameData.heroScore=0;oGameData.enemyScore=0;oGameData.power=0;wipe.trigger(initShooting);}else{oGameData.enemyScore=0;wipe.trigger(initGoalkeeping);}
break;}}
function addText(_size,_width,_align,_x,_y,_str,_col){if(typeof _col==="undefined"){_col="#202020";}
ctx.fillStyle=_col;ctx.textAlign=_align;if(_width<getTextWidth(_size,_str)){var breakCount=0;_size--;while(_width<getTextWidth(_size,_str)){_size--;if(breakCount>100){break;}}}
ctx.font=_size+"px "+assetLib.textData.langText.font[curLang];ctx.fillText(getText(_str),_x,_y);}
function getText(_str){return assetLib.textData.langText[_str][curLang];}
function getTextWidth(_size,_str){ctx.font=_size+"px "+assetLib.textData.langText.font[curLang];var metrics=ctx.measureText(getText(_str));return metrics.width;}
function getCorrectedTextWidth(_size,_width,_str){if(_width<getTextWidth(_size,_str)){var breakCount=0;_size--;while(_width<getTextWidth(_size,_str)){_size--;if(breakCount>100){break;}}}
ctx.font=_size+"px "+assetLib.textData.langText.font[curLang];var metrics=ctx.measureText(getText(_str));return metrics.width;}
function getTrueSave(){if(Math.random()>.9){return false;}else{return true;}}
function getAccuracyScale(){switch(levelNum){case 0:if(!firstFail){return Math.random()*.5+.5;}else{return Math.random()*.5+.25;}
break;case 1:return Math.random()*.5+.55;break;case 2:return Math.random()*.4+.65;break;case 3:return Math.random()*.4+.6;break;case 4:return Math.random()*.5+.5;break;}}
function screenShake(_num){shakeY=-_num;if(shakeTween){shakeTween.kill();}
shakeTween=TweenLite.to(this,.2,{shakeY:0,ease:"Back.easeOut"});}
function userScored(){crowd.goWild();oGameData.heroScore=Math.min(oGameData.heroScore+1,99);hud.jiggleUserScore();flashRate=1;addFirework(1,canvas.width/8,10,2);addFirework(1,(canvas.width/8)*7,10,2);TweenLite.to(this,4,{flashRate:.02,ease:"Quad.easeOut"});oGameData.goalsInRow++;if(ball.hasHitPowerArea){hud.showTextEvent("bonusTime");}else if(oGameData.goalsInRow>0&&oGameData.goalsInRow%3==0&&oGameData.goalsInRow<=21){hud.showTextEvent("row"+oGameData.goalsInRow);}else if(oGameData.heroScore==1||ball.isGoldBall||Math.random()>.7){hud.showTextEvent("goal"+textInc);textInc=(textInc+1)%5;}}
function userSaved(){flashRate=.5;enemyCrowd.goWild();enemyKick.sad();clearInterval(fireworkTimer);fireworkNum=0;fireworkTimer=setInterval(celebration1,100);TweenLite.to(this,4,{flashRate:.02,ease:"Quad.easeOut"});if(enemyBall.saveCount==0||Math.random()>.7){enemyHud.showTextEvent("save"+textInc);textInc=(textInc+1)%5;}}
function celebration0(){addFirework(0,canvas.width/5+fireworkNum*(canvas.width/5),canvas.height/2-230+Math.random()*80-40,Math.random()*1.5+1);if(++fireworkNum>3){clearInterval(fireworkTimer);}}
function celebration1(){addFirework(1,canvas.width/5+(3-fireworkNum)*(canvas.width/5),canvas.height/2-230+Math.random()*40-50,Math.random()*1.5+1);if(++fireworkNum>3){clearInterval(fireworkTimer);}}
function enemyScored(){oGameData.enemyScore=Math.min(oGameData.enemyScore+1,99);enemyHud.jiggleEnemyScore();flashRate=.5;enemyKick.celebrate();TweenLite.to(this,4,{flashRate:.02,ease:"Quad.easeOut"});}
function resetShooting(){userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);if(!ball.inGoal){oGameData.goalsInRow=0;}
ball.reset();enemySave.reset();}
function resetGoalkeeping(){userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);hasSaved=false;heroGoal.reset();enemyBall.reset();}
function getSafeWidth(_num){if(canvas.width>maxSafeWidth&&(_num<(canvas.width-maxSafeWidth)/2||_num>canvas.width-(canvas.width-maxSafeWidth)/2)){_num=_num*(maxSafeWidth/canvas.width)+(canvas.width-maxSafeWidth)/2;}
return _num;}
function getSafeHeight(_num){if(canvas.height>maxSafeHeight&&(_num<(canvas.height-maxSafeHeight)/2||_num>canvas.height-(canvas.height-maxSafeHeight)/2)){_num=_num*(maxSafeHeight/canvas.height)+(canvas.height-maxSafeHeight)/2;}
return _num;}
function checkButtonsOver(){if(isMobile){return;}
for(var i=0;i<panel.aButs.length;i++){panel.aButs[i].isOver=false;if(userInput.mouseX>panel.aButs[i].aOverData[0]&&userInput.mouseX<panel.aButs[i].aOverData[2]&&userInput.mouseY>panel.aButs[i].aOverData[1]&&userInput.mouseY<panel.aButs[i].aOverData[3]){panel.aButs[i].isOver=true;}}}
function clearButtonOvers(){userInput.mouseX=-100;userInput.mouseY=-100;}
function addFirework(_id,_x,_y,_scale,_shouldFall){if(typeof _scale==="undefined"){_scale=1;}
if(typeof _shouldFall==="undefined"){_shouldFall=true;}
if(aFireworks.length>15){return;}
var animId="explode";var firework=new Elements.Firework(assetLib.getData("firework"+_id),animId,_shouldFall);firework.x=_x;firework.y=_y;firework.scaleX=firework.scaleY=_scale;aFireworks.push(firework);}
function addExplosion(_id,_x,_y,_scale,_shouldFall){if(typeof _scale==="undefined"){_scale=1;}
if(typeof _shouldFall==="undefined"){_shouldFall=false;}
if(aFireworks.length>15){return;}
var animId="explode";var firework=new Elements.Firework(assetLib.getData("explosion"+_id),animId,_shouldFall);firework.x=_x;firework.y=_y;firework.offsetX=-8;firework.offsetY=-8;firework.scaleX=firework.scaleY=_scale;aFireworks.push(firework);}
function addSpray(_dir,_x,_y,_scale){if(typeof _scale==="undefined"){_scale=1;}
if(aFireworks.length>15){return;}
var firework=new Elements.Firework(assetLib.getData("spray"),_dir,false,15);firework.x=_x;firework.y=_y;firework.scaleX=firework.scaleY=_scale;firework.moveSideways(_dir);aFireworks.push(firework);}
function addFlash(_id,_x,_y,_scale){if(typeof _scale==="undefined"){_scale=1;}
if(aFireworks.length>15){return;}
var animId="flash";var firework=new Elements.Firework(assetLib.getData("firework"+_id),animId,false);firework.x=_x;firework.y=_y;firework.scaleX=firework.scaleY=_scale;aFireworks.push(firework);}
function addGoalMarker(_type,_x,_y,_scale){if(typeof _scale==="undefined"){_scale=1;}
var gm=new Elements.GoalMarker(assetLib.getData("goalMarker"+_type),"spin");gm.x=_x;gm.y=_y;gm.scaleX=gm.scaleY=_scale;aFireworks.push(gm);}
function updateScore(_inc){levelScore+=_inc;}
function initShootingComplete(){gameState="shootingComplete";if(audioType==1){music.fade(music.volume(),0,10);}
playSound("changeEnds");userInput.removeHitArea("pause");userInput.removeHitArea("shootingGameTouch");var aButs=new Array();addMuteBut(aButs);panel=new Elements.Panel(aButs);panel.shootingCompleteTween();previousTime=new Date().getTime();updateShootingComplete();}
function initGoalkeepingComplete(){gameState="goalkeepingComplete";if(audioType==1){music.fade(music.volume(),0,10);}
firstFail=false;if(oGameData.heroScore>oGameData.enemyScore){saveDataHandler.setData(heroId,levelNum+1);saveDataHandler.saveData();}else if(oGameData.heroScore<oGameData.enemyScore&&levelNum==0){firstFail=true;}
if(oGameData.heroScore>oGameData.enemyScore){playSound("matchWin");}else{playSound("matchLose");}
userInput.removeHitArea("pause");userInput.removeHitArea("goalkeepingGameTouch");var aButs=new Array();addMuteBut(aButs);panel=new Elements.Panel(aButs);panel.goalkeepingCompleteTween();previousTime=new Date().getTime();updateGoalkeepingComplete();}
function updateShootingEvent(){if(gameState!="shooting"){return;}
delta=getDelta();if(!showingTut){oGameData.curTime=Math.max(Math.round(oGameData.curTime-(delta*100)),0);oGameData.swipeTime+=delta;}
if(oGameData.curTime<=0&&!oGameData.timesUp&&!oGameData.ballInPlay){ball.killTweens();wipe.trigger(initShootingComplete);oGameData.timesUp=true;playSound("endWhistle");}
if(!showingTut){if(Math.random()<flashRate){var tempX=Math.random()*canvas.width;var tempY=Math.random()*canvas.height/2-33;if((tempX>canvas.width/2+75||tempX<canvas.width/2-75)||tempY<canvas.height/2-180){addFlash(0,tempX,tempY,Math.random()*.2+.2);}}}
crowd.update();crowd.render();ball.update();ball.render();curTouches=0;for(var i=0;i<userInput.aHitAreas.length;i++){if(curTouches<userInput.aHitAreas[i].aTouchIdentifiers.length){curTouches=userInput.aHitAreas[i].aTouchIdentifiers.length;}}
enemySave.update();hud.update();hud.render();for(var i=0;i<aFireworks.length;i++){aFireworks[i].update();aFireworks[i].render(ctx);if(aFireworks[i].removeMe){aFireworks.splice(i,1);i-=1;}}
panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updateShootingEvent);}
function updateGoalkeepingEvent(){if(gameState!="goalkeeping"){return;}
delta=getDelta();if(!showingTut){oGameData.curTime=Math.max(Math.round(oGameData.curTime-(delta*100)),0);}
if(oGameData.curTime<=0&&!oGameData.timesUp&&!oGameData.ballInPlay){enemyBall.killTweens();wipe.trigger(initGoalkeepingComplete);oGameData.timesUp=true;playSound("endWhistle");}
if(Math.random()<flashRate){addFlash(0,Math.random()*canvas.width,canvas.height/2-(Math.random()*144+42),Math.random()*.2+.2);}
enemyCrowd.update();enemyCrowd.render();enemyKick.update();enemyKick.render();for(var i=0;i<aFireworks.length;i++){aFireworks[i].update();aFireworks[i].render(ctx);if(aFireworks[i].removeMe){aFireworks.splice(i,1);i-=1;}}
heroGoal.update();enemyBall.update();enemyBall.render();curTouches=0;for(var i=0;i<userInput.aHitAreas.length;i++){if(curTouches<userInput.aHitAreas[i].aTouchIdentifiers.length){curTouches=userInput.aHitAreas[i].aTouchIdentifiers.length;}}
enemyHud.update();enemyHud.render();panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updateGoalkeepingEvent);}
function updateCreditsScreenEvent(){if(gameState!="credits"){return;}
delta=getDelta();panel.update();panel.render();ctx.fillStyle="#888888";ctx.textAlign="center";ctx.font="15px Arial";ctx.fillText("v1.0",canvas.width/2,canvas.height-10);checkButtonsOver();wipe.render();requestAnimFrame(updateCreditsScreenEvent);}
function updateShootingComplete(){if(gameState!="shootingComplete"){return;}
delta=getDelta();panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updateShootingComplete);}
function updateGoalkeepingComplete(){if(gameState!="goalkeepingComplete"){return;}
delta=getDelta();panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updateGoalkeepingComplete);}
function updateSplashScreenEvent(){if(gameState!="splash"){return;}
delta=getDelta();splashTimer+=delta;if(splashTimer>2.5){if(audioType==1&&!muted){playMusic();if(!hasFocus){music.pause();}}
initStartScreen();return;}
background.render();panel.update();panel.render();requestAnimFrame(updateSplashScreenEvent);}
function updateIntroScreenEvent(){if(gameState!="intro"){return;}
delta=getDelta();panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updateIntroScreenEvent);}
function updateOutroScreenEvent(){if(gameState!="outro"){return;}
delta=getDelta();panel.update();panel.render();if(panel.oIntro.inc2<1&&Math.random()<.1){addFirework(Math.round(Math.random()*2),Math.random()*360+panel.introOffsetX,Math.random()*canvas.height/2+panel.introOffsetY,Math.random()*1+1);}
checkButtonsOver();wipe.render();requestAnimFrame(updateOutroScreenEvent);}
function updateStartScreenEvent(){if(gameState!="start"){return;}
if(Math.random()<.1&&panel.oStartPosData.titleY>-50){addFirework(Math.round(Math.random()*2),Math.random()*canvas.width,Math.random()*canvas.height/2,Math.random()*1+1);}
delta=getDelta();panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updateStartScreenEvent);}
function updateCharSelectScreenEvent(){if(gameState!="charSelect"){return;}
delta=getDelta();panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updateCharSelectScreenEvent);}
function updateVersusScreenEvent(){if(gameState!="versusScreen"){return;}
delta=getDelta();panel.update();panel.render();if(Math.random()<.1){}
for(var i=0;i<aFireworks.length;i++){aFireworks[i].update();aFireworks[i].render(ctx);if(aFireworks[i].removeMe){aFireworks.splice(i,1);i-=1;}}
checkButtonsOver();wipe.render();requestAnimFrame(updateVersusScreenEvent);}
function updateLoaderEvent(){if(gameState!="loading"){return;}
delta=getDelta();assetLib.render();requestAnimFrame(updateLoaderEvent);}
function updateRotateWarningEvent(){if(gameState!="rotated"){return;}
delta=getDelta();panel.update();panel.render(false);requestAnimFrame(updateRotateWarningEvent);}
function updatePauseEvent(){if(gameState!="pause"){return;}
delta=getDelta();panel.update();panel.render();checkButtonsOver();wipe.render();requestAnimFrame(updatePauseEvent);}
function getDelta(){var currentTime=new Date().getTime();var deltaTemp=(currentTime-previousTime)/1000;previousTime=currentTime;if(deltaTemp>.5){deltaTemp=0;}
return deltaTemp;}
function checkSpriteCollision(_s1,_s2){var s1XOffset=_s1.x;var s1YOffset=_s1.y;var s2XOffset=_s2.x;var s2YOffset=_s2.y;var distance_squared=(((s1XOffset-s2XOffset)*(s1XOffset-s2XOffset))+((s1YOffset-s2YOffset)*(s1YOffset-s2YOffset)));var radii_squared=(_s1.radius)*(_s2.radius);if(distance_squared<radii_squared){return true;}else{return false;}}
function getScaleImageToMax(_oImgData,_aLimit){var newScale;if(_oImgData.isSpriteSheet){if(_aLimit[0]/_oImgData.oData.spriteWidth<_aLimit[1]/_oImgData.oData.spriteHeight){newScale=Math.min(_aLimit[0]/_oImgData.oData.spriteWidth,1);}else{newScale=Math.min(_aLimit[1]/_oImgData.oData.spriteHeight,1);}}else{if(_aLimit[0]/_oImgData.img.width<_aLimit[1]/_oImgData.img.height){newScale=Math.min(_aLimit[0]/_oImgData.img.width,1);}else{newScale=Math.min(_aLimit[1]/_oImgData.img.height,1);}}
return newScale;}
function getCentreFromTopLeft(_aTopLeft,_oImgData,_imgScale){var aCentre=new Array();aCentre.push(_aTopLeft[0]+(_oImgData.oData.spriteWidth/2)*_imgScale);aCentre.push(_aTopLeft[1]+(_oImgData.oData.spriteHeight/2)*_imgScale);return aCentre;}
function loadPreAssets(_lang){curLang=_lang;preAssetLib=new Utils.AssetLoader(curLang,[{id:"loader",file:"images/loader.png"},{id:"loadSpinner",file:"images/loadSpinner.png"},{id:"loaderBg",file:"images/loaderBg.jpg"}],ctx,canvas.width,canvas.height,false);preAssetLib.onReady(initLoadAssets);}
function initLoadAssets(){loadAssets();}
function loadAssets(){gameState="loading";assetLib=new Utils.AssetLoader(curLang,[{id:"uiButs",file:"images/uiButs.png",oAtlasData:{id0:{x:611,y:620,width:55,height:48},id1:{x:554,y:658,width:55,height:48},id10:{x:609,y:428,width:94,height:62},id11:{x:609,y:556,width:94,height:62},id12:{x:410,y:0,width:152,height:116},id13:{x:410,y:118,width:152,height:116},id14:{x:409,y:329,width:198,height:162},id15:{x:210,y:0,width:198,height:162},id16:{x:0,y:338,width:204,height:171},id17:{x:0,y:511,width:204,height:171},id18:{x:210,y:164,width:198,height:163},id19:{x:409,y:493,width:198,height:163},id2:{x:496,y:658,width:56,height:49},id20:{x:206,y:502,width:201,height:162},id21:{x:206,y:338,width:201,height:162},id22:{x:0,y:169,width:208,height:167},id23:{x:0,y:0,width:208,height:167},id24:{x:609,y:364,width:94,height:62},id25:{x:410,y:236,width:94,height:62},id26:{x:506,y:236,width:94,height:62},id27:{x:602,y:236,width:94,height:62},id28:{x:609,y:300,width:94,height:62},id29:{x:609,y:492,width:94,height:62},id3:{x:438,y:658,width:56,height:49},id4:{x:264,y:666,width:56,height:49},id5:{x:322,y:666,width:56,height:49},id6:{x:564,y:118,width:152,height:116},id7:{x:564,y:0,width:152,height:116},id8:{x:380,y:666,width:56,height:49},id9:{x:206,y:666,width:56,height:49}}},{id:"uiElements",file:"images/uiElements.png",oAtlasData:{id0:{x:885,y:771,width:424,height:565},id1:{x:0,y:172,width:470,height:360},id10:{x:0,y:0,width:693,height:48},id11:{x:0,y:50,width:693,height:48},id12:{x:0,y:1336,width:396,height:79},id13:{x:0,y:1255,width:396,height:79},id14:{x:0,y:100,width:571,height:70},id15:{x:1010,y:0,width:388,height:436},id16:{x:1311,y:438,width:334,height:334},id17:{x:0,y:534,width:449,height:117},id18:{x:199,y:1561,width:58,height:59},id19:{x:451,y:665,width:90,height:94},id2:{x:451,y:534,width:110,height:129},id20:{x:69,y:1561,width:66,height:60},id21:{x:0,y:653,width:449,height:117},id22:{x:444,y:772,width:439,height:481},id23:{x:1565,y:774,width:45,height:609},id24:{x:773,y:1338,width:373,height:237},id25:{x:398,y:1338,width:373,height:237},id26:{x:0,y:1561,width:67,height:60},id3:{x:573,y:100,width:435,height:669},id4:{x:1311,y:774,width:252,height:444},id5:{x:0,y:772,width:442,height:468},id6:{x:1010,y:438,width:171,height:131},id7:{x:0,y:1488,width:325,height:71},id8:{x:0,y:1417,width:327,height:69},id9:{x:137,y:1561,width:60,height:47}}},{id:"langText",file:"json/text.json"},{id:"rotateIcon",file:"images/rotate.png"},{id:"rotateBg",file:"images/loaderBg.jpg"},{id:"titleBg",file:"images/titleBg.jpg"},{id:"titleLogo",file:"images/title/title_"+curLang+".png"},{id:"firework0",file:"images/firework0_150x150.png",oAnims:{explode:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],flash:[5,4,3,2,1,0]}},{id:"firework1",file:"images/firework1_175x175.png",oAnims:{explode:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]}},{id:"firework2",file:"images/firework2_150x150.png",oAnims:{explode:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]}},{id:"goalMarker0",file:"images/goalMarker0_162x167.png",oAnims:{spin:[0,1,2,3,4,5,6,7,8]}},{id:"goalMarker1",file:"images/goalMarker1_162x167.png",oAnims:{spin:[0,1,2,3,4,5,6,7,8]}},{id:"powerArea",file:"images/powerArea_85x85.png",oAnims:{spin:[0,1,2,3,4,5,6,7,8,9]}},{id:"timeNumbers",file:"images/timeNumbers_41x44.png"},{id:"scoreNumbers",file:"images/scoreNumbers_53x67.png"},{id:"gameElements",file:"images/gameElements.png",oAtlasData:{id0:{x:0,y:660,width:542,height:228},id1:{x:995,y:115,width:99,height:126},id10:{x:0,y:1016,width:264,height:59},id11:{x:0,y:953,width:270,height:61},id12:{x:0,y:890,width:276,height:61},id13:{x:767,y:891,width:161,height:159},id14:{x:526,y:890,width:239,height:48},id15:{x:544,y:707,width:187,height:28},id16:{x:681,y:737,width:18,height:48},id17:{x:767,y:660,width:227,height:229},id18:{x:0,y:0,width:882,height:338},id19:{x:0,y:340,width:868,height:318},id2:{x:544,y:737,width:135,height:125},id20:{x:0,y:1077,width:195,height:17},id21:{x:870,y:488,width:119,height:58},id22:{x:930,y:891,width:101,height:142},id23:{x:991,y:488,width:101,height:150},id24:{x:996,y:640,width:97,height:105},id25:{x:884,y:115,width:109,height:156},id26:{x:884,y:0,width:111,height:113},id27:{x:870,y:548,width:108,height:100},id28:{x:994,y:273,width:99,height:136},id29:{x:870,y:340,width:122,height:146},id3:{x:544,y:660,width:214,height:45},id30:{x:266,y:1076,width:258,height:18},id4:{x:529,y:1044,width:222,height:47},id5:{x:529,y:993,width:228,height:49},id6:{x:526,y:940,width:237,height:51},id7:{x:278,y:890,width:246,height:53},id8:{x:272,y:953,width:252,height:55},id9:{x:266,y:1016,width:261,height:58}}},{id:"shootingBg",file:"images/shootingBg.jpg"},{id:"goalkeepingBg",file:"images/goalkeepingBg.jpg"},{id:"ball",file:"images/ball_165x165.png"},{id:"goldBall",file:"images/goldBall_179x179.png"},{id:"heroGoal0",file:"images/heroGoal0_214x190.png",oAnims:{ambient:[7,8,9,10,11,12,13,14,15,14,13,12,11,10,9,8],highRight:[16,17,17,17,17,17,17,18,19,20,21,22],lowRight:[18,18,18,18,18,18,19,20,21,22],highLeft:[6,5,5,5,5,5,5,4,3,2,1,0],lowLeft:[4,4,4,4,4,4,3,2,1,0]}},{id:"heroGoal1",file:"images/heroGoal1_279x194.png",oAnims:{ambient:[6,7,8,9,10,9,8,7,6,5,4,3,2,1,0,1,2,3,4,5],right:[11,11,11,16,15,14,13,12,16,15],left:[17,17,17,12,13,14,15,16,12,13],endRight:[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],endLeft:[33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]}},{id:"heroGoal2",file:"images/heroGoal2_399x261.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,8,7,6,5,4,3,2,1],rightFly:[10,11,12,13,14,15,16,17,18,19],rightLand:[20,21,22,23,24,25,26,27,28],leftFly:[29,30,31,32,33,34,35,36,37,38],leftLand:[39,40,41,42,43,44,45,46,47]}},{id:"heroGoal3",file:"images/heroGoal3_223x223.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,8,7,6,5,4,3,2,1],rightFly:[10,11,12,13,14],rightStop:[15,16,17,18,19,20,21,22,23,24,25,26],leftFly:[27,28,29,30,31],leftStop:[32,33,34,35,36,37,38,39,40,41,42,43]}},{id:"heroGoal4",file:"images/heroGoal4_301x263.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,8,7,6,5,4,3,2,1],rightFly:[10,11,12,13,14,15,16,17,18],rightLand:[19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],leftFly:[35,36,37,38,39,40,41,42,43],leftLand:[44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}},{id:"explosion0",file:"images/explosion0_214x199.png",oAnims:{explode:[4,5,6,7,8,9,10,11]}},{id:"enemyKick0",file:"images/enemyKick0_198x166.png",oAnims:{ambient:[0],kick0:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],kick1:[16,17,18,19,20,21,22,23,24],celebrate:[25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43],sad:[44,45,46,47,48,49,50,51]}},{id:"enemyKick1",file:"images/enemyKick1_148x116.png",oAnims:{ambient:[0],kick0:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],kick1:[19,20,21,22,23,24,25,26,27,28,29,30],celebrate:[31,32,33,34,35,36,37,38,38,38,38,38,38,38,38,38,37,36,35,34,33,32,31,30],sad:[39,40,41,42,43,44,45,46,47,48,49,50,50]}},{id:"enemyKick2",file:"images/enemyKick2_159x88.png",oAnims:{ambient:[0],kick0:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],kick1:[16,17,18,19,20,21,22,23,24,25,26,27,28,29],celebrate:[30,31,32,33,34,35,36,37,38,39,39,39,39,39,39,39,38,37,36,35,34,33,32,31,30],sad:[40,41,42,43,44,45,46,47,48,49]}},{id:"enemyKick3",file:"images/enemyKick3_215x160.png",oAnims:{ambient:[0],kick0:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],kick1:[16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],celebrate:[32,33,34,35,36,37,38,39,40,41,41,41,41,41,41,41,41,41,40,39,38,37,36,35,34,33,32],sad:[42,43,44,45,46,47,48,49,50,51,52,53]}},{id:"enemyKick4",file:"images/enemyKick4_248x166.png",oAnims:{ambient:[0],kick0:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],kick1:[16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33],celebrate:[33,34,35,36,37,38,39,40,41,42,43,44,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,45,44,43,42,41,40,39,38,37,36,35,34,33],sad:[47,48,49,50,51,52,53,54,55,56,57]}},{id:"heroKick0",file:"images/heroKick0_337x218.png",oAnims:{ambient:[9],kick0:[0],kick1:[1,2,3,4,5,6,7,8]}},{id:"heroKick1",file:"images/heroKick1_278x212.png",oAnims:{ambient:[9],kick0:[0],kick1:[1,2,3,4,5,6,7,8]}},{id:"heroKick2",file:"images/heroKick2_296x195.png",oAnims:{ambient:[9],kick0:[0],kick1:[1,2,3,4,5,6,7,8]}},{id:"heroKick3",file:"images/heroKick3_269x197.png",oAnims:{ambient:[9],kick0:[0],kick1:[1,2,3,4,5,6,7,8]}},{id:"heroKick4",file:"images/heroKick4_234x183.png",oAnims:{ambient:[9],kick0:[0],kick1:[1,2,3,4,5,6,7,8]}},{id:"enemySave0",file:"images/enemySave0_272x186.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,8,7,6,5,4,3,2,1],rightJump:[10,11,12,13,14,15],rightFly:[16,17,18,19,20,21,22],rightLand:[23,24,25,26,27,28,29,30,31,32,33],leftJump:[34,35,36,37,38,39],leftFly:[40,41,42,43,44,45,46],leftLand:[47,48,49,50,51,52,53,54,55,56,57]}},{id:"enemySave3",file:"images/enemySave3_195x165.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,10,11,10,9,8,7,6,5,4,3,2,1],leftFly:[12,13,14,15,16],leftStop:[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],rightFly:[36,37,38,39,40],rightStop:[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}},{id:"enemySave2a",file:"images/enemySave2a_117x187.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,13,12,11,10,9,8,7,6,5,4,3,2,1],reach:[15,16,17,18,19,19,19,19,19,19,19,19,18,17,16,15],leftPoint:[20,21,22,23,24,25,25,25,25,25,24,23,22,21,20],rightPoint:[26,27,28,29,30,31,31,31,31,31,30,29,28,27,26]}},{id:"enemySave2",file:"images/enemySave2_326x121.png",oAnims:{ambient:[0,1,2,3,4,5,6,5,4,3,2,1],rightFly:[7,8,9,10,11,11,11,11,11],rightStop:[10,9,8,7],leftFly:[12,13,14,15,16,16,16,16,16,16],leftStop:[15,14,13,12]}},{id:"enemySave1",file:"images/enemySave1_241x218.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,10,11,12,11,10,9,8,7,6,5,4,3,2,1],rightJump:[13,14,15,16,17,18],rightFly:[19,20,21,22,23,24],rightLand:[25,26,27,28,29,30,31,32,33,34,35,36,37,38],leftJump:[13,14,15,16,39,40],leftFly:[41,42,43,44,45,46],leftLand:[47,48,49,50,51,52,53,54,55,56,57,58,59,60]}},{id:"enemySave4",file:"images/enemySave4_309x206.png",oAnims:{ambient:[0,1,2,3,4,5,6,7,8,9,10,11,10,9,8,7,6,5,4,3,2,1],leftSlap:[12,13,14,15,16,17,18,19,20,21,22,22,22,22,22,23,24,25],rightSlap:[26,27,28,29,30,31,32,33,34,35,35,35,35,35,36,37,38,39],leftLaser:[40,41,42,43,44],rightLaser:[45,46,47,48,49]}},{id:"wipe0",file:"images/wipe0.png"},{id:"wipe1",file:"images/wipe1.png"},{id:"char00",file:"images/char00.png"},{id:"char01",file:"images/char01.png"},{id:"char02",file:"images/char02.png"},{id:"char03",file:"images/char03.png"},{id:"char04",file:"images/char04.png"},{id:"char10",file:"images/char10.png"},{id:"char11",file:"images/char11.png"},{id:"char12",file:"images/char12.png"},{id:"char13",file:"images/char13.png"},{id:"char14",file:"images/char14.png"},{id:"charBen",file:"images/charBen.png"},{id:"info",file:"images/info.png"},{id:"tut0",file:"images/tut0_274x294.png",oAnims:{anim:[0,0,0,0,0,1,2,3,4,5,6,7,7,7,7,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,40,40,40,40,40,40,40,40,40]}},{id:"tut1",file:"images/tut1_371x267.png",oAnims:{anim:[0,0,0,0,0,1,2,3,4,5,6,7,7,7,7,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,35,35,35,35,35,35,35,35,35]}},{id:"spray",file:"images/spray_160x47.png",oAnims:{left:[0,1,2,3,4,5,6,7,8,9,10,11],right:[12,13,14,15,16,17,18,19,20,21,22,23]}},{id:"introElements",file:"images/introElements.png",oAtlasData:{id0:{x:420,y:771,width:256,height:187},id1:{x:0,y:866,width:73,height:100},id2:{x:678,y:771,width:178,height:184},id3:{x:420,y:533,width:292,height:236},id4:{x:0,y:265,width:621,height:266},id5:{x:0,y:533,width:418,height:331},id6:{x:856,y:0,width:142,height:307},id7:{x:0,y:0,width:637,height:263},id8:{x:639,y:0,width:215,height:412},id9:{x:714,y:414,width:156,height:163}}},{id:"introFrame",file:"images/introFrame.png"},{id:"introMainBg",file:"images/introMainBg.jpg"},{id:"outroMainBg",file:"images/outroMainBg.jpg"}],ctx,canvas.width,canvas.height);oImageIds.infoBut="id0";oImageIds.infoButOver="id1";oImageIds.muteBut0="id2";oImageIds.muteBut0Over="id3";oImageIds.muteBut1="id4";oImageIds.muteBut1Over="id5";oImageIds.playBut="id6";oImageIds.playButOver="id7";oImageIds.pauseBut="id8";oImageIds.pauseButOver="id9";oImageIds.backBut="id10";oImageIds.backButOver="id11";oImageIds.replayBut="id12";oImageIds.replayButOver="id13";oImageIds.charBut0="id14";oImageIds.charBut0Over="id15";oImageIds.charBut1="id16";oImageIds.charBut1Over="id17";oImageIds.charBut2="id18";oImageIds.charBut2Over="id19";oImageIds.charBut3="id20";oImageIds.charBut3Over="id21";oImageIds.charBut4="id22";oImageIds.charBut4Over="id23";oImageIds.resetBut="id24";oImageIds.resetButOver="id25";oImageIds.quitBut="id26";oImageIds.quitButOver="id27";oImageIds.nextBut="id28";oImageIds.nextButOver="id29";oImageIds.titleBaddie="id0";oImageIds.titleBall="id1";oImageIds.ben10Logo="id2";oImageIds.titleHeroFront="id3";oImageIds.titleHeroBack="id4";oImageIds.titleHeroGlow="id5";oImageIds.bottomFade="id6";oImageIds.textPanelBall0="id7";oImageIds.textPanelBall1="id8";oImageIds.vs="id9";oImageIds.blackFrameTop="id10";oImageIds.blackFrameBottom="id11";oImageIds.textPanel1="id12";oImageIds.textPanel0="id13";oImageIds.textPanelBallLong="id14";oImageIds.benStand="id15";oImageIds.flare="id16";oImageIds.progressBar0="id17";oImageIds.progressTick="id18";oImageIds.progressHighlight="id19";oImageIds.crown="id20";oImageIds.progressBar1="id21";oImageIds.evolveEffect="id22";oImageIds.versusMidEffect="id23";oImageIds.tutBg0="id24";oImageIds.tutBg1="id25";oImageIds.benCrown="id26";oImageIds.shootingGoal="id0";oImageIds.heroHead3="id1";oImageIds.enemyHead3="id2";oImageIds.ballShadow0="id3";oImageIds.ballShadow1="id4";oImageIds.ballShadow2="id5";oImageIds.ballShadow3="id6";oImageIds.ballShadow4="id7";oImageIds.ballShadow5="id8";oImageIds.ballShadow6="id9";oImageIds.ballShadow7="id10";oImageIds.ballShadow8="id11";oImageIds.ballShadow9="id12";oImageIds.ballUnderShadow="id13";oImageIds.powerBarBg="id14";oImageIds.powerBar="id15";oImageIds.powerBarTip="id16";oImageIds.goldBallUnderShadow="id17";oImageIds.goalkeepingGoalFront="id18";oImageIds.goalkeepingGoalBack="id19";oImageIds.goalkeeperShadow="id20";oImageIds.tinyGoal="id21";oImageIds.enemyHead1="id22";oImageIds.enemyHead0="id23";oImageIds.enemyHead2="id24";oImageIds.enemyHead4="id25";oImageIds.heroHead1="id26";oImageIds.heroHead2="id27";oImageIds.heroHead4="id28";oImageIds.heroHead0="id29";oImageIds.enemySaveShadow="id30";oImageIds.happyGroup="id0";oImageIds.hex0="id1";oImageIds.shockedBen="id2";oImageIds.hex1="id3";oImageIds.dome="id4";oImageIds.greenBg="id5";oImageIds.actionBen="id6";oImageIds.domeGone="id7";oImageIds.benHappy="id8";oImageIds.vilgaxGone="id9";assetLib.onReady(initSplash);previousTime=new Date().getTime();updateLoaderEvent();}
function resizeCanvas(){var tempInnerWidth=window.innerWidth;var tempInnerHeight=window.innerHeight;canvas.height=tempInnerHeight;canvas.width=tempInnerWidth;canvas.style.width=tempInnerWidth+"px";canvas.style.height=tempInnerHeight+"px";var maxW;var maxH;var minW;var minH;canvasScale=1;if(tempInnerWidth>tempInnerHeight){if(isRotated){if(gameState!="loading"){initBackFromRotate();}}
maxW=maxWidth;maxH=maxHeight;minW=minWidth;minH=minHeight;}else{if(!isRotated){if(gameState!="loading"){initRotateWarning();}}
maxW=maxHeight;maxH=maxWidth;minW=minHeight;minH=minWidth;}
if(canvas.width<maxW||canvas.height<maxH){if(canvas.height<minH){canvas.height=minH;canvas.width=minH*(tempInnerWidth/tempInnerHeight);canvasScale=minH/tempInnerHeight;}
if(canvas.width<minW){canvas.width=minW;canvas.height=minW*(tempInnerHeight/tempInnerWidth);canvasScale=minW/tempInnerWidth;}}else{if(canvas.height-maxH<canvas.width-maxW){if(canvas.height<maxH){canvasScale=1;}else{canvas.height=maxH;canvas.width=maxH*(tempInnerWidth/tempInnerHeight);canvasScale=maxH/tempInnerHeight;}}else{if(canvas.width<maxW){canvasScale=1;}else{canvas.width=maxW;canvas.height=maxW*(tempInnerHeight/tempInnerWidth);canvasScale=maxW/tempInnerWidth;}}}
if(gameState=="shooting"){if(!oGameData.ballInPlay){userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("shootingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);}}else if(gameState=="goalkeeping"){if(!hasSaved){userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,65,canvas.width,canvas.height]},false);userInput.addHitArea("goalkeepingGameTouch",butEventHandler,{isDraggable:true,multiTouch:true},"rect",{aRect:[0,0,canvas.width-140,65]},false);}}
window.scrollTo(0,0);}
function initRotateWarning(){isRotated=true;if(gameState=="shooting"){ball.pause(true);}else if(gameState=="goalkeeping"){enemyBall.pause(true);}
prevGameState=gameState;gameState="rotated";background=new Elements.Background();previousTime=new Date().getTime();updateRotateWarningEvent();}
function initBackFromRotate(){isRotated=false;switch(prevGameState){case "start":gameState="start";previousTime=new Date().getTime();updateStartScreenEvent();break;case "credits":gameState="credits";previousTime=new Date().getTime();updateCreditsScreenEvent();break;case "shooting":gameState="shooting";ball.pause(false);previousTime=new Date().getTime();updateShootingEvent();break;case "goalkeeping":gameState="goalkeeping";enemyBall.pause(false);previousTime=new Date().getTime();updateGoalkeepingEvent();break;case "charSelect":gameState="charSelect";previousTime=new Date().getTime();updateCharSelectScreenEvent();break;case "versusScreen":gameState="versusScreen";previousTime=new Date().getTime();updateVersusScreenEvent();break;case "pause":gameState="pause";previousTime=new Date().getTime();updatePauseEvent();break;case "intro":gameState="intro";previousTime=new Date().getTime();updateIntroScreenEvent();break;case "outro":gameState="outro";previousTime=new Date().getTime();updateOutroScreenEvent();break;}}
function playSound(_id){if(audioType==1){sound.play(_id);}}
function toggleMute(){muted=!muted;if(audioType==1){if(muted){Howler.mute(true);music.pause();}else{Howler.mute(false);playMusic();if(gameState=="shooting"||gameState=="goalkeeping"){music.volume(.25);}else{music.volume(.15);}}}else if(audioType==2){if(muted){music.pause();}else{playMusic();}}}