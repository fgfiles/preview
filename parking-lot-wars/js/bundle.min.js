!function t(e,i,n){function a(r,o){if(!i[r]){if(!e[r]){var h="function"==typeof require&&require;if(!o&&h)return h(r,!0);if(s)return s(r,!0);var _=new Error("Cannot find module '"+r+"'");throw _.code="MODULE_NOT_FOUND",_}var l=i[r]={exports:{}};e[r][0].call(l.exports,function(t){var i=e[r][1][t];return a(i?i:t)},l,l.exports,t,e,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(t,e,i){"use strict";function n(){this._currentScene=null}var a=(t("./AudioParams"),t("./Common")),s=t("./CommonGame"),r=t("./SavedData"),o=t("./scenes/MainScene"),h=t("./scenes/LevelSelectionScene"),_=t("./scenes/CharSelectionScene"),l=t("./scenes/GameScene"),c=t("./scenes/IntroScene"),p=t("./scenes/TutorialScene"),u=t("./scenes/ShowInfoScene");e.exports=n,n.prototype.init=function(){this.loadScene(s.SCENE_ID_MAIN),a.savedData=new r,a.savedData.init()},n.prototype.loadScene=function(t){switch(t){case s.SCENE_ID_MAIN:this._currentScene=new o;break;case s.SCENE_ID_LEVEL_SELECTION:this._currentScene=new h;break;case s.SCENE_ID_CHAR_SELECTION:this._currentScene=new _;break;case s.SCENE_ID_GAMEPLAY:this._currentScene=new l;break;case s.SCENE_ID_INTRO:this._currentScene=new c;break;case s.SCENE_ID_PRE_BATTLE:this._currentScene=new PreBattleScene;break;case s.SCENE_ID_GAME_OVER:this._currentScene=new GameOverScene;break;case s.SCENE_ID_TUTORIAL:this._currentScene=new p;break;case s.SCENE_ID_SHOW_INFO:this._currentScene=new u}var e=new p3.Transition;e.push=!1,e.replace=!0,a.sceneManager.add(this._currentScene,e)}},{"./AudioParams":4,"./Common":6,"./CommonGame":7,"./SavedData":10,"./scenes/CharSelectionScene":39,"./scenes/GameScene":41,"./scenes/IntroScene":42,"./scenes/LevelSelectionScene":43,"./scenes/MainScene":44,"./scenes/ShowInfoScene":47,"./scenes/TutorialScene":49}],2:[function(t,e,i){"use strict";function n(){this.id=-1,this.howl=null}e.exports=n},{}],3:[function(t,e,i){"use strict";function n(){this._cache={},this._music=null,this._isMuted=!1;var t;"undefined"!=typeof document.hidden?(t="hidden",this.visibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(t="mozHidden",this.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(t="msHidden",this.visibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(t="webkitHidden",this.visibilityChange="webkitvisibilitychange"),document.addEventListener(this.visibilityChange,function(){document[t]?Howler.volume(0):Howler.volume(1)},!1)}var a=t("./Audio"),s=t("./AudioParams");e.exports=n,n.prototype.addSounds=function(t,e,i){i=i||"";var n,a,s,r,o,h,_;for(h=0;h<t.length;++h){for(s=i+t[h],s=s.split("/"),a=s[s.length-1],r=[],_=0;_<e.length;++_)o=e[_],r.push(s.join("/")+o);n=new Howl({src:r,volume:1,loop:!1,autoplay:!1}),n.name=a,this._cache[a]=n}},n.prototype.removeSounds=function(t){for(var e,i,n,a=0;a<t.length;++a){e=t[a];for(i in this._cache)if(this._cache.hasOwnProperty(key)&&(n=this._cache[key],n.name==i)){n.unload(),delete this._cache[e];break}}},n.prototype.findHowl=function(t){var e=this._cache[t];return e?e:(console.warn("Could not find sound - "+t),null)},n.prototype.playSound=function(t,e){e=e||new s;var i=-1;"string"!=typeof t&&(t=t[Math.floor(Math.random()*t.length)]);var n=this._cache[t];if(!n)return console.warn("Could not find sound - "+t),i;n.__onend=function(){e.callback&&e.callback.call(e.scope)},n.on("end",n.__onend),i=n.play(),n.volume(e.volume,i),n.loop(e.loop,i);var r=new a;return r.id=i,r.howl=n,r},n.prototype.playMusic=function(t,e){e=e||new s;var i=-1;if("string"!=typeof t&&(t=t[Math.floor(Math.random()*t.length)]),this._music&&this._music.howl.name==t)return this._music;var n=this._cache[t];if(!n)return console.warn("Could not find music - "+t),null;n.__onend=function(){e.callback&&e.callback.call(e.scope)},n.on("end",n.__onend),p3.Device&&p3.Device.isAndroidStockBrowser&&(n.buffer=!0),i=n.play(),n.volume(e.volume,i),n.loop(!0,i);var r=new a;return r.id=i,r.howl=n,e.fadeIn>0&&(this._music&&this.fadeOut(this._music,e.fadeIn),this.fadeIn(r,e.fadeIn)),this._music=r,r},n.prototype.stopSound=function(t,e){var i=this._cache[t];!i&&console.warn("Could not find sound - "+t),i.stop(e)},n.prototype.stopMusic=function(){this._music&&(this._music.howl.__onend&&this._music.howl.off("end",this._music.howl.__onend),this._music.howl.stop(),this._music=null)},n.prototype.clearCallback=function(t){var e=this._cache[t];!e&&console.warn("Could not find sound - "+t),e.off("end")},n.prototype.mute=function(t){this._isMuted=t,this._isMuted?Howler.mute(!0):Howler.mute(!1)},n.prototype.fadeIn=function(t,e,i,n){e=e||1;var a=t.howl.volume(t.id);t.howl.volume(0,t.id),t.__volume=0,TweenMax.killTweensOf(t),TweenMax.to(t,e,{__volume:a,ease:Power1.easeInOut,onUpdate:function(){t.howl.volume(t.__volume,t.id)},onUpdateScope:this,onComplete:i,onCompleteParams:[t],onCompleteScope:n})},n.prototype.fadeOut=function(t,e,i,n){e=e||1,t.__volume=t.howl.volume(t.id),TweenMax.killTweensOf(t),TweenMax.to(t,e,{__volume:0,ease:Power1.easeInOut,onUpdate:function(){t.howl.volume(t.__volume,t.id)},onUpdateScope:this,onComplete:i,onCompleteParams:[t],onCompleteScope:n})},n.prototype.setAudioPos3D=function(t,e,i,n,a){if(!p3.Device.isMobile&&p3.Device.bowser.chrome){n=n||0,a=a||320;var s=i.findLayerForObject(e),r=e.x*(1/s.parallax.x),o=r-i.position.x;o/=Math.abs(o),o==-1?r=Math.min(0,(r+n-i.position.x)/(a-n)):1==o&&(r=Math.max(0,(r-n-i.position.x)/(a-n))),t.howl.pos(r,0,0,t.id)}},n.prototype.setAudioPosStereo=function(t,e,i,n,a){n=n||0,a=a||320;var s=i.findLayerForObject(e),r=e.x*(1/s.parallax.x),o=r-i.position.x;o/=Math.abs(o),r=Math.max(0,Math.abs(r-n-i.position.x)/a),r=Math.max(0,Math.min(1,1+(1-r))),t.howl.volume(r,t.id),!p3.Device.isMobile&&p3.Device.bowser.chrome&&(r=e.x*(1/s.parallax.x),o==-1?r=Math.min(0,(r+n-i.position.x)/(a-n)):1==o&&(r=Math.max(0,(r-n-i.position.x)/(a-n))),r=Math.max(-1,Math.min(1,r)),t.howl.stereo(r,t.id))},Object.defineProperty(n.prototype,"isMute",{get:function(){return this._isMuted}})},{"./Audio":2,"./AudioParams":4}],4:[function(t,e,i){"use strict";function n(){this.volume=1,this.loop=!1,this.delay=0,this.fadeIn=0,this.priority=0,this.callback=null,this.scope=window}e.exports=n},{}],5:[function(t,e,i){"use strict";function n(t){var e="";e+="precision mediump float;",e+="varying vec2 vTextureCoord;",e+="uniform sampler2D uSampler;",e+="uniform vec3 rgbColor;",e+="void main(void) {",e+="gl_FragColor = texture2D(uSampler, vTextureCoord);",e+="gl_FragColor.r = rgbColor.r * gl_FragColor.a;",e+="gl_FragColor.g = rgbColor.g * gl_FragColor.a;",e+="gl_FragColor.b = rgbColor.b * gl_FragColor.a;",e+="}";var i="";i+="attribute vec2 aVertexPosition;",i+="attribute vec2 aTextureCoord;",i+="uniform mat3 projectionMatrix;",i+="varying vec2 vTextureCoord;",i+="void main(void) {",i+="gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);",i+="vTextureCoord = aTextureCoord;",i+="}",PIXI.Filter.call(this,i,e),void 0!==t&&(this.hexColor=t)}e.exports=n,n.prototype=Object.create(PIXI.Filter.prototype),n.prototype.constructor=n,Object.defineProperties(n.prototype,{rgbColor:{get:function(){return this.uniforms.rgbColor},set:function(t){this.uniforms.rgbColor=t}},hexColor:{get:function(){return PIXI.utils.rgb2hex(this.uniforms.rgbColor)},set:function(t){this.uniforms.rgbColor=PIXI.utils.hex2rgb(t)}}})},{}],6:[function(t,e,i){"use strict";function n(){}e.exports=n,n.STAGE_WIDTH=1900,n.STAGE_MIN_WIDTH=1024,n.STAGE_HEIGHT=768,n.assets=null,n.main=null,n.stage=null,n.renderer=null,n.timestep=null,n.tracking=null,n.animator=null,n.audio=null,n.camera=null,n.copy=null,n.config=null,n.language="en",n.touch=new PIXI.Point(0,0),n.touching=!1,n.paused=!1,n.isWebGL=!1,n.blankTexture=null,n.game=null,n.savedData=null,n.isMute=!1,n.randBool=function(){return Math.random()>.5},n.toOneDecimalStr=function(t){var e=t.toFixed(1);return"0"==e[e.indexOf(".")+1]&&(e=e.substr(0,e.indexOf("."))),e},n.randomIntFromInterval=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},n.heapPermutations=function(t){function e(t,e){var i=n[t];n[t]=n[e],n[e]=i}function i(t){if(1==t)a.push(n.slice());else for(var s=0;s!=t;++s)i(t-1),e(t%2?0:s,t-1)}var n=t.slice(),a=[];return i(n.length),a},n.getButtonPositionLeft=function(t){return Math.max(0,.5*n.STAGE_WIDTH-.5*p3.View.width)+75+150*t},n.getButtonPositionRight=function(t){return Math.min(n.STAGE_WIDTH,.5*n.STAGE_WIDTH+.5*p3.View.width)-75-150*t}},{}],7:[function(t,e,i){"use strict";function n(){}var a=t("./Common");e.exports=n,n.SCENE_ID_MAIN=0,n.SCENE_ID_LEVEL_SELECTION=1,n.SCENE_ID_CHAR_SELECTION=2,n.SCENE_ID_PRE_BATTLE=3,n.SCENE_ID_GAMEPLAY=4,n.SCENE_ID_INTRO=5,n.SCENE_ID_GAME_OVER=6,n.SCENE_ID_TUTORIAL=7,n.SCENE_ID_SHOW_INFO=8,n.PLAYER_ID_AI=0,n.PLAYER_ID_PLAYER=1,n.INFLUENCE_ID_AI=0,n.INFLUENCE_ID_PLAYER=1,n.INFLUENCE_ID_PICKUP=2,n.COND_ID_DOUBLE_DAMAGE=1,n.COND_ID_DOUBLE_SPEED=2,n.COND_ID_EXTRA_ATTACK_RANGE=3,n.COND_ID_EXTRA_ATTACK=4,n.COND_ID_EXTRA_MOVE=5,n.COND_ID_SPLASH_DAMAGE=6,n.SA_ID_EXTRA_ATTACK=0,n.SA_ID_SPLASH_DAMAGE=1,n.SA_ID_EXTRA_MOVE=2,n.SA_ID_HEALING_POWER=3,n.SA_ID_HEAL_OTHERS=4,n.PICKUP_ID_DOUBLE_DAMAGE=0,n.PICKUP_ID_DOUBLE_SPEED=1,n.PICKUP_ID_SPECIAL_ABILITY_RECHARGE=2,n.PICKUP_ID_HEALTH_PACK=3,n.PICKUP_ID_COIN_PACK=4,n.PICKUP_ID_DOUBLE_ATTACK_RANGE=5,n.PICKUP_ID_COUNT=6,n.ESSENCE_ID_STRENGTH=0,n.ESSENCE_ID_AGILITY=1,n.ESSENCE_ID_INTELLIGENCE=2,n.LEVEL_TILE_STATE_PLAYABLE=0,n.LEVEL_TILE_STATE_LAKEWOOD=1,n.LEVEL_TILE_STATE_BOXMORE=2,n.ESSENCE_BONUS_DAMAGE=10,n.SPLASH_DAMAGE_RANGE=1,n.SPLASH_DAMAGE_FACTOR=.5,n.HEAL_VALUE=50,n.HEAL_OTHERS_VALUE=20,n.PICKUP_COIN_PACK_REWARD=50,n.TILED_PLAYER_START_ID=230,n.TILED_ENEMY_START_ID=229,n.TILED_BUSH_CENTRE_ID=222,n.TILED_BUSH_LEFT_ID=223,n.TILED_BUSH_RIGHT_ID=-1,n.TILED_CONE_CENTRE_ID=225,n.TILED_CONE_LEFT_ID=-1,n.TILED_CONE_RIGHT_ID=227,n.TILED_LAMP_ID=228,n.PLAYER_TEAM_SIZE=3,n.GRID_COL_COUNT=9,n.GRID_ROW_COUNT=7,n.selectedLevel={id:0,tileIndex:0,result:0},n.getDecorationSpriteId=function(t){var e="";switch(t){case n.TILED_BUSH_CENTRE_ID:e="bush_centre";break;case n.TILED_BUSH_LEFT_ID:e="bush_left";break;case n.TILED_BUSH_RIGHT_ID:e="bush_right";break;case n.TILED_CONE_CENTRE_ID:e="cone_centre";break;case n.TILED_CONE_LEFT_ID:e="cone_left";break;case n.TILED_CONE_RIGHT_ID:e="cone_right";break;case n.TILED_LAMP_ID:e="lamp"}return e},n.getEssenceType=function(t){var e=-1;switch(t){case"STR":e=n.ESSENCE_ID_STRENGTH;break;case"AGI":e=n.ESSENCE_ID_AGILITY;break;case"INT":e=n.ESSENCE_ID_INTELLIGENCE}return e},n.getSpecialAbilityType=function(t){var e=-1;switch(t){case"EXTRA_ATTACK":e=n.SA_ID_EXTRA_ATTACK;break;case"SPLASH_DAMAGE":e=n.SA_ID_SPLASH_DAMAGE;break;case"EXTRA_MOVE":e=n.SA_ID_EXTRA_MOVE;break;case"HEALING_POWER":e=n.SA_ID_HEALING_POWER;break;case"HEAL_OTHERS":e=n.SA_ID_HEAL_OTHERS}return e},n.getEssenceColorId=function(t){var e="";switch(t){case n.ESSENCE_ID_STRENGTH:e="orange";break;case n.ESSENCE_ID_AGILITY:e="blue";break;case n.ESSENCE_ID_INTELLIGENCE:e="green"}return e},n.getPlayerCharStats=function(t){var e=a.assets.getJSON("playerCharacters").playerCharacters[t],i=a.savedData.arrPlayerCharInfo[t],n={DAMAGE:e.damage,ATTACK_RANGE:e.attackRange,SPEED:e.speed,HEALTH:e.health,SA_RECHARGE_TIME:e.specialAbility.rechargeTime};if(i.isImproved){var s=!0,r=!1,o=void 0;try{for(var h,_=e.improvedStats[Symbol.iterator]();!(s=(h=_.next()).done);s=!0){var l=h.value;n[l.type]=l.value}}catch(t){r=!0,o=t}finally{try{!s&&_.return&&_.return()}finally{if(r)throw o}}}return n}},{"./Common":6}],8:[function(t,e,i){"use strict";function n(){PIXI.AbstractFilter.call(this),this.passes=[this];var t="";t+="precision mediump float;",t+="varying vec2 vTextureCoord;",t+="varying vec4 vColor;",t+="uniform sampler2D uSampler;",t+="uniform float gray;",t+="void main(void) {",t+="gl_FragColor = texture2D(uSampler, vTextureCoord);",t+="gl_FragColor.rgb = mix( gl_FragColor.rgb, vec3( 0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b ), 1.0 );",t+="}",this.fragmentSrc=t}e.exports=n,n.prototype=Object.create(PIXI.AbstractFilter.prototype),n.prototype.constructor=n,Object.defineProperty(n.prototype,"gray",{get:function(){return this.uniforms.gray},set:function(t){this.uniforms.gray=t}})},{}],9:[function(t,e,i){"use strict";function n(t,e){this._width=t,this._height=e,this._preloader=null,this._application=null}var a=t("./Application"),s=t("./AudioManager"),r=t("./Common"),o=t("./scenes/PreloaderScene");window.Main=n,n.prototype.init=function(){r.main=this,r.assets=p3.AssetManager.instance,r.audio=p3.Button.audio=new s,r.language=language;var t=new p3.ViewParams;t.holderId="game",t.width=this._width,t.height=this._height,t.rotateImageUrl="./assets/images/localisation/rotate_"+r.language+".jpg",t.rotateImageColor="#000000",PIXI.settings.MIPMAP_TEXTURES=!1,PIXI.settings.RETINA_PREFIX=/\_(?=[^_]*$)(.+)x/,p3.Device.init(window.bowser),TweenMax.defaultOverwrite="none",TweenMax.ticker.fps(60);var e=new PIXI.Graphics;e.beginFill(16777215),e.drawRect(0,0,1,1),e.endFill(),r.blankTexture=e.generateCanvasTexture();var i=new p3.View(t);i.signals.ready.addOnce(function(e){var i={};i.view=e,i.transparent=!1,i.antialias=!1,i.preserveDrawingBuffer=!1,i.resolution=1;var n=new PIXI.Container;r.stage=n,p3.Device.isCocoonJS&&(n.scale.x=window.innerHeight/t.height,n.scale.y=window.innerHeight/t.height);var a=p3.Device.isCocoonJS?new PIXI.WebGLRenderer(window.innerWidth,window.innerHeight,i):PIXI.autoDetectRenderer(this._width,this._height,i);a.backgroundColor=0,r.renderer=a,r.isWebGL=a instanceof PIXI.WebGLRenderer;var s=new p3.SceneManager(a);s.updateAll=!0,r.sceneManager=s,r.stage.addChild(s.view);var o=new p3.Timestep(p3.Timestep.FIXED);o.init(this.update,this.render,this),r.timestep=o,r.animator=new p3.Animator,r.animator.init(),window.delay=function(t,e,i){return r.animator.setTimeout(t,e,i)},this.loadPreloader()},this),i.signals.resize.add(this.onCanvasResize,this),r.view=i},n.prototype.loadPreloader=function(){var t=[{name:"preloader_bg",url:"images/bg/cn_preloader.jpg"},{name:"buttons",url:"images/buttons_1x.json"},{name:"preloader",url:"images/cn_preloader_1x.json"},{name:"aeromaticslight_50",url:"fonts/aeromaticslight_50.xml"}],e=[];t.length?(r.assets.addFiles(t,"assets/"),r.assets.signals.complete.addOnce(function(){this.loadAssets()},this),r.assets.load(),r.audio.addSounds(e,[".mp3",".ogg"],"")):this.loadAssets()},n.prototype.loadAssets=function(){var t=[{name:"playerCharacters",url:"data/playerCharacters.json"},{name:"enemyCharacters",url:"data/enemyCharacters.json"},{name:"levels",url:"data/levels.json"},{name:"languages",url:"data/languages.json"},{name:"levelSelectionGrid",url:"data/levelSelectionGrid.json"},{name:"battle_sequence_0_1x",url:"images/battle_sequence_0_1x.json"},{name:"battle_sequence_1_1x",url:"images/battle_sequence_1_1x.json"},{name:"game_over_0_1x",url:"images/game_over_0_1x.json"},{name:"game_over_1_1x",url:"images/game_over_1_1x.json"},{name:"help_0_1x",url:"images/help_0_1x.json"},{name:"help_1_1x",url:"images/help_1_1x.json"},{name:"splash_0_1x",url:"images/splash_0_1x.json"},{name:"intro_0_1x",url:"images/intro_0_1x.json"},{name:"ui_game_0_1x",url:"images/ui_game_0_1x.json"},{name:"ui_game_1_1x",url:"images/ui_game_1_1x.json"},{name:"ui_0_1x",url:"images/ui_0_1x.json"},{name:"ui_shared_0_1x",url:"images/ui_shared_0_1x.json"},{name:"ui_shared_1_1x",url:"images/ui_shared_1_1x.json"},{name:"buttons_1x",url:"images/buttons_1x.json"},{name:"choose_bg",url:"images/bg/choose_bg.jpg"},{name:"intro_bg",url:"images/bg/intro_bg.jpg"},{name:"lvl_select_bg",url:"images/bg/lvl_select_bg.jpg"},{name:"splash_bg",url:"images/bg/splash_bg.jpg"},{name:"result_bad_bg",url:"images/bg/result_bad_bg.jpg"},{name:"result_good_bg",url:"images/bg/result_good_bg.jpg"},{name:"game_over_good",url:"images/bg/game_over_good.jpg"},{name:"game_over_bad",url:"images/bg/game_over_bad.jpg"},{name:"attack_lines_blue",url:"images/bg/attack_lines_blue.jpg"},{name:"attack_lines_green",url:"images/bg/attack_lines_green.jpg"},{name:"attack_lines_orange",url:"images/bg/attack_lines_orange.jpg"},{name:"lvlLeftBg_001",url:"images/levels/bg/game_left_001.jpg"},{name:"lvlMidBg_001",url:"images/levels/bg/game_centre_001.jpg"},{name:"lvlRightBg_001",url:"images/levels/bg/game_right_001.jpg"},{name:"tiles",url:"images/levels/tiles.png"},{name:"game_char_special",url:"particles/game_char_special.json"},{name:"game_stats_special",url:"particles/game_stats_special.json"},{name:"ed_50_ar",url:"fonts/ed_50_ar.xml"},{name:"ed_110",url:"fonts/ed_110.xml"},{name:"ed_50",url:"fonts/ed_50.xml"},{name:"ed_30",url:"fonts/ed_30.xml"},{name:"ed_24",url:"fonts/ed_24.xml"},{name:"ed_110_gradient",url:"fonts/ed_110_gradient.xml"},{name:"ed_50_gradient",url:"fonts/ed_50_gradient.xml"},{name:"ed_76_gradient",url:"fonts/ed_76_gradient.xml"}],e=["music_team_select_03","music_story_screen_tension_00","music_story_screen_team_clash_00","music_story_screen_stab_danger_00","music_quit_00","music_powerup_00","music_pause_screen_00","music_menu_playbtn_start_00","music_main_menu_theme_00","music_level_success_00","music_level_select_00","music_heal_00","music_gameover_lost_00","music_gameover_battle_lost_00","music_fight_clash_03","music_battle_tension_teams_even_06","music_battle_tension_teams_even_04","music_battle_tension_teams_even_02","music_battle_tension_teams_even_00","music_battle_tension_2playerleft_08","music_battle_tension_2enemyleft_05","music_battle_tension_1playerleft_07","music_battle_tension_1enemyleft_01"],i=["sfx_your_turn_00","sfx_special_splash_damage_00","sfx_special_move_attack_move_01","sfx_special_move_attack_move_00","sfx_special_increaserange_attack_00","sfx_special_healing_power_00","sfx_special_forcefield_00","sfx_special_double_attack_00","sfx_player_stunned_loop_00","sfx_player_human_dies_00","sfx_pickup_health_pack_01","sfx_pickup_health_pack_00","sfx_pickup_doublespeed_00","sfx_pickup_double_damage_00","sfx_pickup_coinspack_01","sfx_pickup_coinspack_00","sfx_pickup_ability_recharge_00","sfx_leave_char_select_screen_00","sfx_gameover_00","sfx_enter_char_select_screen_00","sfx_enemy_robot_dies_02","sfx_enemy_robot_dies_01","sfx_enemy_robot_dies_00","sfx_card_selected_00","sfx_btn_remove_card_00","sfx_btn_press_fwd_00","sfx_btn_press_back_00","sfx_btn_endmove_03","sfx_btn_endmove_02","sfx_btn_endmove_01","sfx_btn_endmove_00","sfx_achievement_00"],n=["sfx_player_bighit_onrobot_00","sfx_player_bionic_jump_hit_00","sfx_player_hit_00","sfx_player_hit_crush_00","sfx_player_hit_poke_three_00","sfx_player_hit_smash_00","sfx_player_move_loop_01","sfx_player_punch_combo_00","sfx_player_punch_combo_01","sfx_player_punch_combo_02","sfx_player_punch_combo_03","sfx_player_spin_hit_00"],a=["sfx_enemy_laser_bolt_00","sfx_enemy_laser_fire_00","sfx_enemy_laser_strike_00","sfx_enemy_lord_move_loop_04","sfx_enemy_robot_decision_01","sfx_enemy_robot_move_00","sfx_enemy_robot_move_loop_00","sfx_hit_metal_00"];t.length?(this._preloader=new o,this._preloader.signals.onAllLoaded.addOnce(this._startGame,this),r.sceneManager.add(this._preloader),r.assets.addFiles(t,"assets/"),r.assets.signals.progress.add(this.onLoadingProgress,this),r.assets.signals.complete.addOnce(this.onLoadingCompleted,this),r.assets.load(),r.audio.addSounds(e,[".mp3",".ogg"],"assets/audio/music/"),r.audio.addSounds(i,[".mp3",".ogg"],"assets/audio/sfx/"),r.audio.addSounds(n,[".mp3",".ogg"],"assets/audio/sfx/player_attacks/"),r.audio.addSounds(a,[".mp3",".ogg"],"assets/audio/sfx/enemy_attacks/")):this.startGame()},n.prototype.update=function(){r.sceneManager.update(),r.animator.update()},n.prototype.render=function(){r.renderer.render(r.stage)},n.prototype.onLoadingProgress=function(t){this._preloader.loaded=t.progress/100},n.prototype.onLoadingCompleted=function(){r.assets.signals.progress.removeAll(),r.assets.signals.complete.removeAll(),this._preloader.loaded=1},n.prototype._startGame=function(){delay(function(){this._application=new a,this._application.init()},.5,this)},n.prototype.onCanvasResize=function(t){t&&(r.renderer.resize(p3.View.width,p3.View.height),r.sceneManager&&r.sceneManager.resize())},Object.defineProperty(n.prototype,"application",{get:function(){return this._application}})},{"./Application":1,"./AudioManager":3,"./Common":6,"./scenes/PreloaderScene":46}],10:[function(t,e,i){"use strict";function n(){p3.AssetManager.instance;this.SAVE_NAME="customer_focus",this.SAVE_VERSION="0.0.215",this.SAVE_SEED="y5k0Eo6R177mUkb",this._hasSeenIntro=!1,this._arrPlayerCharInfo=[],this._coins=0,this._isFirstCharPick=!0,this._isTutorial=!0,this._arrTeamCharId=[],this._arrLevelTile=[],this._arrUsedEnemyTeam=[],this._isPlayerTicTacToeTurn=!0,this.ARR_LEVEL_TILE_DEFAULT=[0,0,0,0,0,0,0,0,0]}var a=t("./Common");e.exports=n,n.prototype.init=function(){window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION]?this.load():(this.reset(),this.save())},n.prototype.reset=function(){this._hasSeenIntro=!1,this._isFirstCharPick=!0,this._isTutorial=!0,this._isPlayerTicTacToeTurn=!0,this._arrLevelTile=this.ARR_LEVEL_TILE_DEFAULT.slice(0);var t=a.assets.getJSON("playerCharacters").playerCharacters,e=!0,i=!1,n=void 0;try{for(var s,r=t[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var o=s.value,h={isLocked:0!=o.unlockCoins,isImproved:!1};this._arrPlayerCharInfo.push(h)}}catch(t){i=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw n}}this._coins=0,this._arrTeamCharId=[],this._arrUsedEnemyTeam=[]},n.prototype.load=function(){var t=window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION];t=JSON.parse(t),this._hasSeenIntro=t.hasSeenIntro,this._isFirstCharPick=t.isFirstCharPick,this._isTutorial=t.isTutorial,this._isPlayerTicTacToeTurn=t.isPlayerTicTacToeTurn,null!=t.arrPlayerCharInfo&&(this._arrPlayerCharInfo=t.arrPlayerCharInfo),null!=t.arrLevelTile&&(this._arrLevelTile=t.arrLevelTile),this._coins=t.coins,this._arrTeamCharId=t.arrTeamCharId,this._arrUsedEnemyTeam=t.arrUsedEnemyTeam},n.prototype.save=function(){var t={};t.hasSeenIntro=this._hasSeenIntro,t.isFirstCharPick=this._isFirstCharPick,t.isTutorial=this._isTutorial,t.arrPlayerCharInfo=this._arrPlayerCharInfo,t.coins=this._coins,t.arrTeamCharId=this._arrTeamCharId,t.arrLevelTile=this._arrLevelTile,t.arrUsedEnemyTeam=this._arrUsedEnemyTeam,t.isPlayerTicTacToeTurn=this._isPlayerTicTacToeTurn;var e=JSON.stringify(t);t.hash=md5(e+this.SAVE_SEED),window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION]=JSON.stringify(t)},Object.defineProperty(n.prototype,"hasSeenIntro",{get:function(){return this._hasSeenIntro},set:function(t){this._hasSeenIntro=t}}),Object.defineProperty(n.prototype,"isPlayerTicTacToeTurn",{get:function(){return this._isPlayerTicTacToeTurn},set:function(t){this._isPlayerTicTacToeTurn=t}}),Object.defineProperty(n.prototype,"isFirstCharPick",{get:function(){return this._isFirstCharPick},set:function(t){this._isFirstCharPick=t}}),Object.defineProperty(n.prototype,"isTutorial",{get:function(){return this._isTutorial},set:function(t){this._isTutorial=t}}),Object.defineProperty(n.prototype,"arrPlayerCharInfo",{get:function(){return this._arrPlayerCharInfo}}),Object.defineProperty(n.prototype,"arrLevelTile",{get:function(){return this._arrLevelTile},set:function(t){this._arrLevelTile=t}}),Object.defineProperty(n.prototype,"coins",{get:function(){return this._coins},set:function(t){this._coins=t}}),Object.defineProperty(n.prototype,"arrTeamCharId",{get:function(){return this._arrTeamCharId},set:function(t){this._arrTeamCharId=t}}),Object.defineProperty(n.prototype,"arrUsedEnemyTeam",{get:function(){return this._arrUsedEnemyTeam},set:function(t){this._arrUsedEnemyTeam=t}})},{"./Common":6}],11:[function(t,e,i){"use strict";function n(t,e){this._type=t,this._param=e}t("../Common");e.exports=n,n.prototype.constructor=n,n.TYPE_INPUT=0,n.TYPE_END_TURN=1,n.TYPE_GAME_OVER=2,n.TYPE_ATTACK=3,n.TYPE_ENEMY_CHAR_KNOCKED_OUT=4,n.TYPE_PLAYER_CHAR_KNOCKED_OUT=5,n.TYPE_UNDO_LAST_MOVEMENT=6,Object.defineProperty(n.prototype,"type",{get:function(){return this._type}}),Object.defineProperty(n.prototype,"param",{get:function(){return this._param}})},{"../Common":6}],12:[function(t,e,i){"use strict";function n(){this._selectedChar=null,this._arrGameEvent=[]}var a=t("../Common"),s=t("../CommonGame"),r=(t("./MyGame"),t("./GameEvent")),o=t("./world/PlayerCharacter"),h=t("./world/EnemyCharacter");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(){},n.prototype.update=function(){for(var t=0;t<this._arrGameEvent.length;++t)this._arrGameEvent[t].type==r.TYPE_INPUT&&this._processInputEvent(this._arrGameEvent[t].param.tile);this._arrGameEvent=[]},n.prototype.clearSelection=function(){a.game.grid.restoreTileVisibility(this._selectedChar.tile),this._selectedChar.clearHotTiles(),this._selectedChar.tile.clearTexture(),this._selectedChar=null},n.prototype._processInputEvent=function(t){null==this._selectedChar?this._selectTileWithCharacter(t):this._selectedChar!=t.content&&(this._selectedChar instanceof o?t.content instanceof h?!this._selectedChar.hasAttacked&&this._selectedChar.canAttackTo(t.content)?(a.game.hud.isEndTurnWarning=!1,a.game.movementToUndo=null,a.game.events.push(new r(r.TYPE_ATTACK,{attacker:this._selectedChar,defender:t.content})),this._selectedChar.clearHotTiles(),this._selectedChar.hasAttacked=!0,this._selectedChar.hasMoved=!0,this._selectedChar.actionLog.indexOf("attack")!=-1&&this._selectedChar.hasCondition(s.COND_ID_EXTRA_ATTACK)&&(this._selectedChar.removeCondition(s.COND_ID_EXTRA_ATTACK),a.game.hud.playerCharAttributes.conditionList.update()),this._selectedChar.actionLog.push("attack")):(this._selectedChar.clearHotTiles(),this._selectedChar.tile.clearTexture(),this._selectTileWithCharacter(t)):t.content instanceof o?(this._selectedChar.clearHotTiles(),this._selectedChar.tile.clearTexture(),this._selectTileWithCharacter(t)):this._selectedChar.canMoveTo(t)&&!this._selectedChar.hasMoved?(a.game.hud.isEndTurnWarning=!1,a.game.grid.restoreTileVisibility(this._selectedChar.tile),this._selectedChar.clearHotTiles(),this._selectedChar.tile.clearTexture(),a.game.movementToUndo={playerChar:this._selectedChar,tile:this._selectedChar.tile},this._selectedChar.moveTo(t),this._selectedChar.actionLog.push("move"),t.setTexture(a.assets.getTexture(this._selectedChar.TILE_SPRITE_ID.selected)),a.game.state=a.game.STATE_COMPLETING_PLAYER_ACTION):(a.game.grid.restoreTileVisibility(this._selectedChar.tile),this._selectedChar.clearHotTiles(),this._selectedChar.tile.clearTexture(),a.game.hud.playerCharAttributes.visible=!1,this._selectedChar=null):this._selectedChar instanceof h&&(t.content instanceof o||t.content instanceof h?(this._selectedChar.clearHotTiles(),this._selectedChar.tile.clearTexture(),this._selectTileWithCharacter(t)):(a.game.grid.restoreTileVisibility(this._selectedChar.tile),this._selectedChar.clearHotTiles(),this._selectedChar.tile.clearTexture(),a.game.hud.enemyCharAttributes.visible=!1,this._selectedChar=null)))},n.prototype._selectTileWithCharacter=function(t){t.content instanceof o?(null!=this._selectedChar&&a.game.grid.restoreTileVisibility(this._selectedChar.tile),this._selectedChar=t.content,this._selectedChar.hotTiles=a.game.grid.findHotTiles(this._selectedChar),this._selectedChar.highlightHotTiles(),a.game.hud.enemyCharAttributes.visible=!1,a.game.hud.playerCharAttributes.visible=!0,a.game.hud.playerCharAttributes.setCharacter(this._selectedChar),t.setTexture(a.assets.getTexture(this._selectedChar.TILE_SPRITE_ID.selected)),a.game.grid.setTileVisibility(t)):t.content instanceof h&&(null!=this._selectedChar&&a.game.grid.restoreTileVisibility(this._selectedChar.tile),this._selectedChar=t.content,this._selectedChar.hotTiles=a.game.grid.findHotTiles(this._selectedChar),this._selectedChar.highlightHotTiles(),a.game.hud.playerCharAttributes.visible=!1,a.game.hud.enemyCharAttributes.visible=!0,a.game.hud.enemyCharAttributes.setCharacter(this._selectedChar),t.setTexture(a.assets.getTexture(this._selectedChar.TILE_SPRITE_ID.selected)),a.game.grid.setTileVisibility(t))},Object.defineProperty(n.prototype,"events",{get:function(){return this._arrGameEvent},set:function(t){this._arrGameEvent=t}}),Object.defineProperty(n.prototype,"selectedChar",{get:function(){return this._selectedChar},set:function(t){this._selectedChar=t}})},{"../Common":6,"../CommonGame":7,"./GameEvent":11,"./MyGame":14,"./world/EnemyCharacter":31,"./world/PlayerCharacter":36}],13:[function(t,e,i){"use strict";function n(){this._enemyCount=0,this._playerCount=0,this._howl=null}var a=t("../Common");t("../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(t,e){this._enemyCount=t,this._playerCount=e,this._setInitialMusic()},n.prototype.play=function(){this._howl.play()},n.prototype.pause=function(){this._howl.pause()},n.prototype.stop=function(){this._howl.stop()},n.prototype.reset=function(){this._howl.stop(),this._setInitialMusic()},n.prototype.onPlayerCharKnockedOut=function(){if(this._playerCount-=1,2==this._playerCount){this._howl.stop();var t="music_battle_tension_2playerleft_08";this._howl=a.audio.findHowl(t),this._howl.loop(!0),this._howl.play()}else if(1==this._playerCount){this._howl.stop();var t="music_battle_tension_1playerleft_07";this._howl=a.audio.findHowl(t),this._howl.loop(!0),this._howl.play()}},n.prototype.onEnemyCharKnockedOut=function(){if(this._enemyCount-=1,2==this._enemyCount){this._howl.stop();var t="music_battle_tension_2enemyleft_05";this._howl=a.audio.findHowl(t),this._howl.loop(!0),this._howl.play()}else if(1==this._enemyCount){this._howl.stop();var t="music_battle_tension_1enemyleft_01";this._howl=a.audio.findHowl(t),this._howl.loop(!0),this._howl.play()}},n.prototype._setInitialMusic=function(){var t="music_battle_tension_teams_even_00";this._howl=a.audio.findHowl(t),this._howl.loop(!0)}},{"../Common":6,"../CommonGame":7}],14:[function(t,e,i){"use strict";function n(){this.STATE_NONE=-1,this.STATE_PLAYER_TURN=0,this.STATE_ENEMY_TURN=1,this.STATE_COMPLETING_PLAYER_ACTION=2,this.STATE_COMPLETING_ENEMY_ACTION=3,this.STATE_GAME_OVER=4,this.STATE_COMBAT_SCREEN=5,this._state=this.STATE_PLAYER_TURN,this._round=1,this._timeline=new TimelineMax,this._arrGameEvent=[],this._scene=null,this._combatPanel=null,this._movementToUndo=null,this._enemyTeam=[],this._isGameOver=!1,this._isPaused=!1,this._grid=null,this._hud=null,this._input=null,this._music=null,this._ai=null,this._aiCharIndex=0,this._aiCharActionIndex=0,this.MAX_PICKUP_COUNT=3,this.PICKUP_SPAWN_RATE=2,this.PICKUP_SPAWN_PROBABILITY=.6,this.signals={},this.signals.onGameOver=new signals.Signal}var a=t("../Common"),s=t("../CommonGame"),r=t("./world/MyGrid"),o=t("./world/Obstacle"),h=t("./world/Decoration"),_=t("./world/PlayerCharacter"),l=t("./world/EnemyCharacter"),c=t("./hud/HUD"),p=t("./GameEvent"),u=t("./ai/AI"),d=t("./GameInput"),I=t("./GameMusic"),T=t("../ui/overlays/CombatPanel");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(){this._input=new d,this._input.init(),this._initGrid(),this._hud=new c,this._hud.init(),this._scene.addChild(this._hud),this._ai=new u,this._ai.init(),this._combatPanel=new T,this._combatPanel.init(),this._scene.combatLayer.addChild(this._combatPanel),this._combatPanel.visible=!1,this._music=new I,this._music.init(this._grid.playerChars.length,this._grid.enemyChars.length),this._music.play()},n.prototype.update=function(){switch(this._state){case this.STATE_PLAYER_TURN:var t=!1;this._hud.update(),this._input.update();for(var e=0;e<this._arrGameEvent.length;++e)switch(this._arrGameEvent[e].type){case p.TYPE_END_TURN:this._movementToUndo=null,this._hud.update(),t=!0;break;case p.TYPE_UNDO_LAST_MOVEMENT:this._movementToUndo.playerChar.hasMoved=!1,this._movementToUndo.playerChar.actionLog.splice(this._movementToUndo.playerChar.actionLog.length-1,1),TweenMax.to(this._movementToUndo.playerChar,.15,{x:this._movementToUndo.playerChar.x-50,ease:Sine.easeOut}),TweenMax.to(this._movementToUndo.playerChar,.15,{alpha:0,ease:Sine.easeInOut,onComplete:function(){null!=this._input.selectedChar&&this._input.clearSelection(),
this._movementToUndo.playerChar._onMoveToCompleted(this._movementToUndo.tile),this._movementToUndo.playerChar.setOutOfActions(!1),this._movementToUndo.playerChar.position=new PIXI.Point(this._movementToUndo.tile.x-50,this._movementToUndo.tile.y+this._grid.CHARACTER_TILE_Y_OFFSET),this._input._selectTileWithCharacter(this._movementToUndo.playerChar.tile),this._movementToUndo=null},onCompleteScope:this}),TweenMax.to(this._movementToUndo.playerChar,.15,{x:this._movementToUndo.tile.x,ease:Sine.easeOut,delay:.15}),TweenMax.to(this._movementToUndo.playerChar,.15,{alpha:1,ease:Sine.easeInOut,delay:.15});break;case p.TYPE_ATTACK:this._combatPanel.show(this._arrGameEvent[e].param.attacker,this._arrGameEvent[e].param.defender),this._combatPanel.visible=!0,this._state=this.STATE_COMBAT_SCREEN;break;case p.TYPE_PLAYER_CHAR_KNOCKED_OUT:this._music.onPlayerCharKnockedOut();break;case p.TYPE_ENEMY_CHAR_KNOCKED_OUT:this._music.onEnemyCharKnockedOut()}this._arrGameEvent=[],null!=this._input.selectedChar&&this._input.selectedChar.update();var i=!0,n=!1,r=void 0;try{for(var o,h=this._grid.playerChars[Symbol.iterator]();!(i=(o=h.next()).done);i=!0){var c=o.value;c.currentHealth>0&&c.setOutOfActions(c.isOutOfActions())}}catch(t){n=!0,r=t}finally{try{!i&&h.return&&h.return()}finally{if(n)throw r}}if(t){null!=this._input.selectedChar&&(this._hud.playerCharAttributes.visible=!1,this._hud.enemyCharAttributes.visible=!1,this._input.clearSelection()),this._hud.onPlayerTurnEnd(),this._aiCharIndex=0,this._aiCharActionIndex=0,this._ai.think();var u=!0,d=!1,I=void 0;try{for(var T,m=this._grid.playerChars[Symbol.iterator]();!(u=(T=m.next()).done);u=!0){var c=T.value;c.setOutOfActions(!1)}}catch(t){d=!0,I=t}finally{try{!u&&m.return&&m.return()}finally{if(d)throw I}}this._state=this.STATE_ENEMY_TURN}break;case this.STATE_COMBAT_SCREEN:this._combatPanel.isCompleted&&(this._combatPanel.clear(),this._combatPanel.visible=!1,this._combatPanel.attacker.attackSpecialAbility(this._combatPanel.defender),this._combatPanel.attacker.onDamageTaken(this._combatPanel.defender),this._combatPanel.defender.onDamageTaken(this._combatPanel.attacker),null!=this._input.selectedChar&&0==this._input.selectedChar.currentHealth&&this._input.clearSelection(),this._combatPanel.attacker instanceof _?this._state=this.STATE_COMPLETING_PLAYER_ACTION:this._combatPanel.attacker instanceof l&&(this._state=this.STATE_COMPLETING_ENEMY_ACTION));break;case this.STATE_COMPLETING_PLAYER_ACTION:case this.STATE_COMPLETING_ENEMY_ACTION:if(!this._timeline.isActive()&&!this._timeline.paused()){for(var e=0;e<this._arrGameEvent.length;++e){if(this._arrGameEvent[e].type==p.TYPE_GAME_OVER){TweenMax.delayedCall(1.5,function(){this._music.stop(),this.signals.onGameOver.dispatch()},null,this),this._state=this.STATE_GAME_OVER;break}if(this._arrGameEvent[e].type==p.TYPE_PLAYER_CHAR_KNOCKED_OUT){this._music.onPlayerCharKnockedOut();break}if(this._arrGameEvent[e].type==p.TYPE_ENEMY_CHAR_KNOCKED_OUT){this._music.onEnemyCharKnockedOut();break}}this._arrGameEvent=[],this._state!=this.STATE_GAME_OVER&&(this._state==this.STATE_COMPLETING_PLAYER_ACTION?this._state=this.STATE_PLAYER_TURN:this._state==this.STATE_COMPLETING_ENEMY_ACTION&&(this._state=this.STATE_ENEMY_TURN))}break;case this.STATE_ENEMY_TURN:if(this._aiCharIndex<this._ai.enemyCharActions.length){var y=this._ai.enemyCharActions[this._aiCharIndex].sequence,g=this._ai.enemyCharActions[this._aiCharIndex].enemyChar;if(y.length>0&&g.currentHealth>0&&(this._aiCharActionIndex<y.length?this._ai.specialAbility.preEvaluateActivation(g,y,this._aiCharActionIndex):this._aiCharActionIndex==y.length&&this._ai.specialAbility.postEvaluateActivation(g,y,this._aiCharActionIndex),0==this._aiCharActionIndex&&(this._hud.enemyCharAttributes.visible=!0,this._hud.enemyCharAttributes.setCharacter(g)),this._aiCharActionIndex<y.length)){var S=y[this._aiCharActionIndex];if(null!=S.moveTo)S.moveTo.setTexture(a.assets.getTexture(g.TILE_SPRITE_ID.selected)),g.moveTo(S.moveTo),this._state=this.STATE_COMPLETING_ENEMY_ACTION;else if(null!=S.attackTo)S.attackTo.currentHealth>0&&(g.markTarget(S.attackTo),this._state=this.STATE_COMBAT_SCREEN);else if(null!=S.activateSpecialAbility){var C=new PIXI.extras.BitmapText(g.specialAbility.toString().toUpperCase(),{font:"30px ed_30",align:"center"});C.anchor=new PIXI.Point(.5,.5),C.position=new PIXI.Point(g.x,g.y-100),g.specialAbility.type==s.SA_ID_HEALING_POWER&&(C.y-=30),this._timeline.to(C,1,{y:C.y-25,onComplete:function(){a.game.grid.removeChild(this)},onCompleteScope:C}),a.game.grid.addChild(C),g.specialAbility.activate(),this._state=this.STATE_COMPLETING_ENEMY_ACTION}this._aiCharActionIndex+=1}this._state!=this.STATE_COMBAT_SCREEN&&(0==y.length||this._aiCharActionIndex>=y.length)&&(this._aiCharIndex+=1,this._aiCharActionIndex=0)}else{this._state=this.STATE_PLAYER_TURN;var f=!1,x=!0,P=!1,v=void 0;try{for(var E,A=this._grid.playerChars[Symbol.iterator]();!(x=(E=A.next()).done);x=!0){var w=E.value;w.refresh(),!f&&w.currentHealth>0&&(a.game.input.events.push(new p(p.TYPE_INPUT,{tile:w.tile})),f=!0)}}catch(t){P=!0,v=t}finally{try{!x&&A.return&&A.return()}finally{if(P)throw v}}var b=!0,O=!1,B=void 0;try{for(var k,D=this._grid.enemyChars[Symbol.iterator]();!(b=(k=D.next()).done);b=!0){var G=k.value;G.refresh()}}catch(t){O=!0,B=t}finally{try{!b&&D.return&&D.return()}finally{if(O)throw B}}if(this._round+=1,this._round%this.PICKUP_SPAWN_RATE==0&&this._grid.pickUps.length<this.MAX_PICKUP_COUNT)for(var e=this._grid.pickUps.length;e<this.MAX_PICKUP_COUNT;++e)(0==this._grid.pickUps.length||this._grid.pickUps.length>0&&Math.random()<=this.PICKUP_SPAWN_PROBABILITY)&&this._grid.createRandomPickUp();this._hud.enemyCharAttributes.visible=!1,this._hud.onPlayerTurnStart(),a.audio.playSound("sfx_your_turn_00")}}this._updatePS(),this._grid.updateZSortedContainer()},n.prototype.replay=function(){this._round=1,this._isPaused=!1,this._scene.gameLayer.removeChild(this._grid),this._initGrid(),this._hud.reset(),this._music.reset(),this._state=this.STATE_PLAYER_TURN},n.prototype.pause=function(){this._isPaused=!0,this._timeline.pause(),this._combatPanel.pause(),this._music.pause(),this._grid.pause()},n.prototype.resume=function(){this._isPaused=!1,this._timeline.resume(),this._combatPanel.resume(),this._music.play(),this._grid.resume()},n.prototype.isBusy=function(){return this._timeline.isActive()},n.prototype._initGrid=function(){var t=[],e=[],i=[],n=a.assets.getJSON("levels").levels[s.selectedLevel.id],c=0,u=0,d=!0,I=!1,T=void 0;try{for(var m,y=n.tiles.nonWalkable[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var g=m.value;if(g>0){var g=new PIXI.Point(u,c);t.push(g)}++u,u>=s.GRID_COL_COUNT&&(u=0,++c)}}catch(t){I=!0,T=t}finally{try{!d&&y.return&&y.return()}finally{if(I)throw T}}var S=!0,C=!1,f=void 0;try{for(var x,P=n.characterStart[Symbol.iterator]();!(S=(x=P.next()).done);S=!0){var v=x.value,g=new PIXI.Point(v.x/v.width,v.y/v.height-1);v.gid==s.TILED_PLAYER_START_ID?e.push(g):v.gid==s.TILED_ENEMY_START_ID&&i.push(g)}}catch(t){C=!0,f=t}finally{try{!S&&P.return&&P.return()}finally{if(C)throw f}}this._grid=new r,this._grid.init(),this._scene.gameLayer.addChild(this._grid);for(var E=0;E<t.length;++E){var A=new o;A.init(),this._grid.addObstacle(A,t[E].x,t[E].y)}for(var w=0,E=0;E<a.savedData.arrTeamCharId.length;++E){var b=new _,O=a.assets.getJSON("playerCharacters").playerCharacters[a.savedData.arrTeamCharId[E]];b.init(O),this._grid.addPlayerChar(b,e[E].x,e[E].y),a.savedData.arrPlayerCharInfo[a.savedData.arrTeamCharId[E]].isImproved&&(w+=1),0==E&&a.game.input.events.push(new p(p.TYPE_INPUT,{tile:b.tile}))}0==this._enemyTeam.length&&(this._enemyTeam=this._generateEnemyTeam());var B=[];if(3==w)B=[0,1,2];else if(2==w)for(var k=a.randomIntFromInterval(0,2),E=0;E<this._enemyTeam.length;++E)E!=k&&B.push(E);else 1==w&&B.push(a.randomIntFromInterval(0,2));for(var E=0;E<this._enemyTeam.length;++E){var D=B.indexOf(E)!=-1,G=new l,R=a.assets.getJSON("enemyCharacters").enemyCharacters[this._enemyTeam[E]];G.init(R,D),this._grid.addEnemyChar(G,i[E].x,i[E].y)}var L=!0,H=!1,M=void 0;try{for(var X,N=n.decoration[Symbol.iterator]();!(L=(X=N.next()).done);L=!0){var U=X.value,W=!0,F=!1,K=void 0;try{for(var j,V=U[Symbol.iterator]();!(W=(j=V.next()).done);W=!0){var Y=j.value,J=new h;J.init(Y.gid),this._grid.addDecoration(J,Y.x/Y.width,Y.y/Y.height-1)}}catch(t){F=!0,K=t}finally{try{!W&&V.return&&V.return()}finally{if(F)throw K}}}}catch(t){H=!0,M=t}finally{try{!L&&N.return&&N.return()}finally{if(H)throw M}}for(var q=this._grid.playerChars,E=0;E<q.length;++E)q[E].refresh();for(var z=this._grid.enemyChars,E=0;E<z.length;++E)z[E].refresh();this._grid.updateZSortedContainer()},n.prototype._generateEnemyTeam=function(){for(var t=!1,e=a.assets.getJSON("enemyCharacters").enemyCharacters,i=[],n=0;n<e.length;++n)i.push(n);var r=[];do{var o=i.slice(0);r=[];for(var n=0;n<s.PLAYER_TEAM_SIZE;++n){var h=a.randomIntFromInterval(0,o.length-1);r.push(o[h]),o.splice(h,1)}for(var n=0;n<a.savedData.arrUsedEnemyTeam.length;++n){t=!0;for(var _=0;_<r.length;++_)if(a.savedData.arrUsedEnemyTeam[n].indexOf(r[_])==-1){t=!1;break}if(t)break}}while(t);return r},n.prototype._updatePS=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._grid.playerChars[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;null!=s.parent&&s.updatePS()}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}var r=!0,o=!1,h=void 0;try{for(var _,l=this._grid.enemyChars[Symbol.iterator]();!(r=(_=l.next()).done);r=!0){var c=_.value;null!=c.parent&&c.updatePS()}}catch(t){o=!0,h=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw h}}},n.prototype.onPickUpActivated=function(t,e){t==this._input.selectedChar&&t instanceof _?(this._movementToUndo=null,this._hud.playerCharAttributes.conditionList.update(),this._hud.playerCharAttributes.specialAbility.update(),this._hud.playerCharAttributes.updateStats(t,!0),t.hasAttacked||e.type!=s.PICKUP_ID_DOUBLE_ATTACK_RANGE||(t.hotTiles=this._grid.findHotTiles(t),t.highlightHotTiles())):t==this._input.selectedChar&&t instanceof l&&(this._hud.enemyCharAttributes.conditionList.update(),this._hud.enemyCharAttributes.specialAbility.update(),this._hud.enemyCharAttributes.updateStats(t,!0))},n.prototype.onCombatStarted=function(t,e){this._combatPanel.show(t,e),this._combatPanel.visible=!0},Object.defineProperty(n.prototype,"input",{get:function(){return this._input}}),Object.defineProperty(n.prototype,"grid",{get:function(){return this._grid}}),Object.defineProperty(n.prototype,"timeline",{get:function(){return this._timeline}}),Object.defineProperty(n.prototype,"hud",{get:function(){return this._hud}}),Object.defineProperty(n.prototype,"music",{get:function(){return this._music}}),Object.defineProperty(n.prototype,"events",{get:function(){return this._arrGameEvent}}),Object.defineProperty(n.prototype,"round",{get:function(){return this._round}}),Object.defineProperty(n.prototype,"isPaused",{get:function(){return this._isPaused}}),Object.defineProperty(n.prototype,"enemyTeam",{get:function(){return this._enemyTeam}}),Object.defineProperty(n.prototype,"isGameOver",{set:function(t){this._isGameOver=t}}),Object.defineProperty(n.prototype,"state",{set:function(t){this._state=t}}),Object.defineProperty(n.prototype,"scene",{get:function(){return this._scene},set:function(t){this._scene=t}}),Object.defineProperty(n.prototype,"movementToUndo",{get:function(){return this._movementToUndo},set:function(t){this._movementToUndo=t}})},{"../Common":6,"../CommonGame":7,"../ui/overlays/CombatPanel":60,"./GameEvent":11,"./GameInput":12,"./GameMusic":13,"./ai/AI":16,"./hud/HUD":20,"./world/Decoration":30,"./world/EnemyCharacter":31,"./world/MyGrid":33,"./world/Obstacle":34,"./world/PlayerCharacter":36}],15:[function(t,e,i){"use strict";function n(){this.STATE_SELECT_KO=0,this.STATE_MOVE_KO=1,this.STATE_MOVING_KO=2,this.STATE_KO_ATTACKS_JETHRO=3,this.STATE_COMBAT_EXPLAINED=4,this.STATE_SPECIAL_ABILITY_EXPLAINED=5,this.STATE_BONUS_DAMAGE=6,this.STATE_PICKUP=7,this.STATE_RANGED_ATTACK=8,this.STATE_ENID_ATTACKS_JETHRO=9,this.STATE_ENID_KILLS_JETHRO=10,this.STATE_SELECT_ENID=11,this.STATE_MOVE_ENID=12,this.STATE_MOVING_ENID=13,this.STATE_WAITING=14,this.STATE_WELCOME=15,this.STATE_COMPLETING_PLAYER_ACTION=20,this.STATE_COMBAT_SCREEN=21,this.STATE_GAME_OVER=21,this._nextState=null,this._state=null,this._timeline=new TimelineMax,this._arrGameEvent=[],this._scene=null,this._CombatPanel=null,this._tutorialMessage=null,this._tutorialFinger=null,this._essenceGuideSprite=null,this._isGameOver=!1,this._isPaused=!1,this._grid=null,this._hud=null,this._input=null,this._music=null,this.signals={},this.signals.onGameOver=new signals.Signal}var a=t("../Common"),s=t("../CommonGame"),r=t("./world/MyGrid"),o=t("./world/Obstacle"),h=t("./world/PlayerCharacter"),_=t("./world/EnemyCharacter"),l=t("./world/Decoration"),c=t("./hud/HUD"),p=t("./GameEvent"),u=t("./GameInput"),d=t("./GameMusic"),I=t("../ui/overlays/CombatPanel"),T=t("../ui/UITutorialMessage");t("../GrayScaleFilter");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(){this._input=new u,this._input.init(),this._initGrid(),this._hud=new c,this._hud.init(),this._hud.endTurnButton.visible=!1,this._hud.undoButton.visible=!1,this._hud.essenceGuideSprite.visible=!1,this._scene.addChild(this._hud),this._CombatPanel=new I,this._CombatPanel.init(),this._scene.combatLayer.addChild(this._CombatPanel),this._CombatPanel.visible=!1,this._music=new d,this._music.init(this._grid.playerChars.length,this._grid.enemyChars.length),this._music.play(),this._tutorialMessage=new T,this._tutorialMessage.x=.5*a.STAGE_WIDTH,this._tutorialMessage.y=.5*a.STAGE_HEIGHT-220,this._tutorialMessage.init(),this._scene.addChild(this._tutorialMessage),this._tutorialMessage.showMessages([a.assets.getJSON("languages").TUTORIAL_00_00[a.language],a.assets.getJSON("languages").TUTORIAL_00_01[a.language],a.assets.getJSON("languages").TUTORIAL_00_02[a.language]]),this._tutorialMessage.signals.onContinue.add(function(t){1==t&&(this._tutorialFinger.visible=!0,this._tutorialFinger.x=this._grid.tiles[5][2].x+this._grid.parent.x,this._tutorialFinger.y=this._grid.tiles[5][2].y+this._grid.parent.y,this._animateTutorialFinger(),this._tutorialMessage.continueBtn.visible=!1,this._state=this.STATE_SELECT_KO)},this),this._tutorialFinger=new PIXI.Sprite(a.assets.getTexture("game_tutorial_finger")),this._tutorialFinger.anchor=new PIXI.Point(0,1),this._tutorialFinger.visible=!1,this._scene.addChild(this._tutorialFinger),this._essenceGuideSprite=new PIXI.Sprite(a.assets.getTexture("essence_guide")),this._essenceGuideSprite.anchor=new PIXI.Point(.5,.5),this._essenceGuideSprite.visible=!1,this._essenceGuideSprite.x=.5*a.STAGE_WIDTH,this._essenceGuideSprite.y=.5*a.STAGE_HEIGHT-100,this._scene.addChild(this._essenceGuideSprite),this._state=this.STATE_WELCOME},n.prototype.update=function(){switch(this._state){case this.STATE_SELECT_KO:var t=!0,e=!1,i=void 0;try{for(var n,r=this._input.events[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var o=n.value;if(o.type==p.TYPE_INPUT&&null!=o.param.tile.content&&o.param.tile.content instanceof h&&0==o.param.tile.content.id){this._input.update(),this._tutorialFinger.visible=!1,a.game.hud.lock.targetStats(),this._tutorialMessage.setMessages([a.assets.getJSON("languages").TUTORIAL_01_00[a.language],""]),this._tutorialMessage.signals.onContinue.add(function(t){if(0==t){a.game.hud.lock.clear(),this._tutorialFinger.visible=!1,this._tutorialMessage.visible=!1;var e=new _,i=a.assets.getJSON("enemyCharacters").enemyCharacters[3];e.init(i),this._grid.addEnemyChar(e,5,5);var n=this._grid.playerChars[0];n.hotTiles=a.game.grid.findHotTiles(n),n.highlightHotTiles(),e.alpha=0,e.x+=50,TweenMax.to(e,.15,{x:e.x-50,alpha:1,ease:Sine.easeInOut,onComplete:function(){this._tutorialMessage.visible=!0,this._tutorialMessage.showMessages([a.assets.getJSON("languages").TUTORIAL_02_00[a.language],a.assets.getJSON("languages").TUTORIAL_02_01[a.language],a.assets.getJSON("languages").TUTORIAL_02_02[a.language]]),this._tutorialMessage.signals.onContinue.add(function(t){0==t?a.game.hud.lock.targetAttackRange():1==t&&(a.game.hud.lock.clear(),this._tutorialMessage.continueBtn.visible=!1,this._tutorialFinger.visible=!0,this._tutorialFinger.x=this._grid.tiles[5][4].x+this._grid.parent.x,this._tutorialFinger.y=this._grid.tiles[5][4].y+this._grid.parent.y,this._animateTutorialFinger(),this._input.events=[],this._state=this.STATE_MOVE_KO)},this)},onCompleteScope:this})}},this),this._state=this.STATE_WAITING;break}}}catch(t){e=!0,i=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw i}}this._input.events=[];break;case this.STATE_MOVE_KO:var l=!0,c=!1,u=void 0;try{for(var d,I=this._input.events[Symbol.iterator]();!(l=(d=I.next()).done);l=!0){var o=d.value;if(o.type==p.TYPE_INPUT&&5==o.param.tile.row&&4==o.param.tile.col){this._input.update(),this._tutorialFinger.visible=!1,this._tutorialMessage.visible=!1,this._state=this.STATE_MOVING_KO;break}}}catch(t){c=!0,u=t}finally{try{!l&&I.return&&I.return()}finally{if(c)throw u}}this._input.events=[];break;case this.STATE_MOVING_KO:this._grid.tiles[5][4].content==this._grid.playerChars[0]&&(this._tutorialFinger.visible=!0,this._tutorialFinger.x=this._grid.tiles[5][5].x+this._grid.parent.x,this._tutorialFinger.y=this._grid.tiles[5][5].y+this._grid.parent.y,this._animateTutorialFinger(),this._state=this.STATE_KO_ATTACKS_JETHRO);break;case this.STATE_KO_ATTACKS_JETHRO:var T=!0,m=!1,y=void 0;try{for(var g,S=this._input.events[Symbol.iterator]();!(T=(g=S.next()).done);T=!0){var o=g.value;if(o.type==p.TYPE_INPUT&&5==o.param.tile.row&&5==o.param.tile.col){this._input.update(),this._CombatPanel.show(this._grid.tiles[5][4].content,this._grid.tiles[5][5].content),this._CombatPanel.visible=!0,this._tutorialFinger.visible=!1,this._tutorialMessage.visible=!1,this._state=this.STATE_COMBAT_SCREEN,this._nextState=this.STATE_COMBAT_EXPLAINED;break}}}catch(t){m=!0,y=t}finally{try{!T&&S.return&&S.return()}finally{if(m)throw y}}this._input.events=[];break;case this.STATE_SELECT_ENID:var C=!0,f=!1,x=void 0;try{for(var P,v=this._input.events[Symbol.iterator]();!(C=(P=v.next()).done);C=!0){var o=P.value;if(o.type==p.TYPE_INPUT&&null!=o.param.tile.content&&o.param.tile.content instanceof h&&1==o.param.tile.content.id){this._input.update(),this._essenceGuideSprite.visible=!0,this._essenceGuideSprite.scale=new PIXI.Point,TweenMax.to(this._essenceGuideSprite.scale,.25,{x:1,y:1,ease:Back.easeOut}),a.game.hud.lock.targetEssenceBar(),this._tutorialFinger.visible=!1,this._tutorialMessage.setMessages([a.assets.getJSON("languages").TUTORIAL_03_00[a.language],a.assets.getJSON("languages").TUTORIAL_03_01[a.language],a.assets.getJSON("languages").TUTORIAL_03_02[a.language]]),this._tutorialMessage.signals.onContinue.add(function(t){0==t?(a.game.hud.lock.clear(),TweenMax.to(this._essenceGuideSprite,.75,{rotation:2*-Math.PI,ease:Back.easeIn}),TweenMax.to(this._essenceGuideSprite,.5,{x:this._hud.essenceGuideSprite.x,y:this._hud.essenceGuideSprite.y,ease:Sine.easeInOut,delay:.5,onComplete:function(){this._hud.essenceGuideSprite.visible=!0,this._essenceGuideSprite.visible=!1},onCompleteScope:this})):1==t&&(this._tutorialMessage.continueBtn.visible=!1,this._tutorialFinger.visible=!0,this._tutorialFinger.x=this._grid.tiles[5][3].x+this._grid.parent.x,this._tutorialFinger.y=this._grid.tiles[5][3].y+this._grid.parent.y,this._animateTutorialFinger(),this._input.events=[],this._state=this.STATE_MOVE_ENID)},this),this._state=this.STATE_WAITING;break}}}catch(t){f=!0,x=t}finally{try{!C&&v.return&&v.return()}finally{if(f)throw x}}this._input.events=[];break;case this.STATE_MOVE_ENID:var E=!0,A=!1,w=void 0;try{for(var b,O=this._input.events[Symbol.iterator]();!(E=(b=O.next()).done);E=!0){var o=b.value;if(o.type==p.TYPE_INPUT&&5==o.param.tile.row&&3==o.param.tile.col){this._input.update(),this._tutorialFinger.visible=!1,this._tutorialMessage.visible=!1,this._state=this.STATE_MOVING_ENID;break}}}catch(t){A=!0,w=t}finally{try{!E&&O.return&&O.return()}finally{if(A)throw w}}this._input.events=[];break;case this.STATE_MOVING_ENID:this._grid.tiles[5][3].content==this._grid.playerChars[1]&&(a.game.hud.lock.targetAttackRange(),this._tutorialMessage.visible=!0,this._tutorialMessage.showMessages([a.assets.getJSON("languages").TUTORIAL_08_00[a.language],a.assets.getJSON("languages").TUTORIAL_08_01[a.language]]),this._tutorialMessage.signals.onContinue.add(function(t){0==t&&(a.game.hud.lock.clear(),this._tutorialMessage.continueBtn.visible=!1,this._tutorialFinger.visible=!0,this._tutorialFinger.x=this._grid.tiles[5][5].x+this._grid.parent.x,this._tutorialFinger.y=this._grid.tiles[5][5].y+this._grid.parent.y,this._animateTutorialFinger(),this._input.events=[],this._state=this.STATE_ENID_ATTACKS_JETHRO)},this),this._state=this.STATE_WAITING);break;case this.STATE_ENID_ATTACKS_JETHRO:var B=!0,k=!1,D=void 0;try{for(var G,R=this._input.events[Symbol.iterator]();!(B=(G=R.next()).done);B=!0){var o=G.value;if(o.type==p.TYPE_INPUT&&5==o.param.tile.row&&5==o.param.tile.col){this._input.update(),this._CombatPanel.show(this._grid.tiles[5][3].content,this._grid.tiles[5][5].content),this._CombatPanel.visible=!0,this._tutorialFinger.visible=!1,this._tutorialMessage.visible=!1,this._state=this.STATE_COMBAT_SCREEN,this._nextState=this.STATE_SPECIAL_ABILITY_EXPLAINED;break}}}catch(t){k=!0,D=t}finally{try{!B&&R.return&&R.return()}finally{if(k)throw D}}this._input.events=[];break;case this.STATE_ENID_KILLS_JETHRO:var L=!0,H=!1,M=void 0;try{for(var X,N=this._input.events[Symbol.iterator]();!(L=(X=N.next()).done);L=!0){var o=X.value;if(o.type==p.TYPE_INPUT&&5==o.param.tile.row&&5==o.param.tile.col){this._input.update(),this._CombatPanel.show(this._grid.tiles[5][3].content,this._grid.tiles[5][5].content),this._CombatPanel.visible=!0,this._tutorialFinger.visible=!1,this._tutorialMessage.visible=!1,this._state=this.STATE_COMBAT_SCREEN,this._nextState=this.STATE_GAME_OVER;break}}}catch(t){H=!0,M=t}finally{try{!L&&N.return&&N.return()}finally{if(H)throw M}}this._input.events=[];break;case this.STATE_COMBAT_SCREEN:this._CombatPanel.isCompleted&&(this._CombatPanel.clear(),this._CombatPanel.visible=!1,this._CombatPanel.attacker.attackSpecialAbility(this._CombatPanel.defender),this._CombatPanel.attacker.onDamageTaken(this._CombatPanel.defender),this._CombatPanel.defender.onDamageTaken(this._CombatPanel.attacker),null!=this._input.selectedChar&&0==this._input.selectedChar.currentHealth&&this._input.clearSelection(),this._state=this.STATE_COMPLETING_PLAYER_ACTION);break;case this.STATE_COMPLETING_PLAYER_ACTION:if(!this._timeline.isActive()&&!this._timeline.paused()){for(var U=0;U<this._arrGameEvent.length;++U){if(this._arrGameEvent[U].type==p.TYPE_GAME_OVER){this._state=this.STATE_GAME_OVER;break}if(this._arrGameEvent[U].type==p.TYPE_PLAYER_CHAR_KNOCKED_OUT){this._music.onPlayerCharKnockedOut();break}if(this._arrGameEvent[U].type==p.TYPE_ENEMY_CHAR_KNOCKED_OUT){this._music.onEnemyCharKnockedOut();break}}switch(this._arrGameEvent=[],this._state=this._nextState,this._nextState=null,this._state){case this.STATE_COMBAT_EXPLAINED:this._grid.playerChars[0].setOutOfActions(!0),this._tutorialMessage.visible=!0,this._tutorialMessage.showMessages([a.assets.getJSON("languages").TUTORIAL_04_00[a.language],a.assets.getJSON("languages").TUTORIAL_04_01[a.language],a.assets.getJSON("languages").TUTORIAL_04_02[a.language]]),this._tutorialMessage.signals.onAllRead.add(function(){this._tutorialMessage.visible=!1;var t=new h,e=a.assets.getJSON("playerCharacters").playerCharacters[1];t.init(e),this._grid.addPlayerChar(t,1,6),t.x-=50,t.alpha=0,TweenMax.to(t,.15,{x:t.x+50,alpha:1,ease:Sine.easeInOut,onComplete:function(){this._tutorialMessage.visible=!0,this._tutorialMessage.showMessage(a.assets.getJSON("languages").TUTORIAL_05_00[a.language]),this._tutorialFinger.visible=!0,this._tutorialFinger.x=this._grid.tiles[6][1].x+this._grid.parent.x,this._tutorialFinger.y=this._grid.tiles[6][1].y+this._grid.parent.y,this._animateTutorialFinger(),this._input.events=[],this._state=this.STATE_SELECT_ENID},onCompleteScope:this})},this);break;case this.STATE_SPECIAL_ABILITY_EXPLAINED:this._grid.playerChars[1].specialAbility.recharge(),this._hud.playerCharAttributes.specialAbility.update(),this._hud.playerCharAttributes.specialAbility.signals.onSpecialAbilityUsed.addOnce(function(){this._tutorialMessage.visible=!1,this._grid.playerChars[1].update(),this._tutorialFinger.visible=!0,this._tutorialFinger.x=this._grid.tiles[5][5].x+this._grid.parent.x,this._tutorialFinger.y=this._grid.tiles[5][5].y+this._grid.parent.y,this._animateTutorialFinger(),this._input.events=[],this._state=this.STATE_ENID_KILLS_JETHRO},this),this._tutorialMessage.visible=!0,this._tutorialMessage.showMessage(a.assets.getJSON("languages").TUTORIAL_06_00[a.language]),this._tutorialFinger.x=this._hud.playerCharAttributes.x+this._hud.playerCharAttributes.specialAbility.x,this._tutorialFinger.y=this._hud.playerCharAttributes.y+this._hud.playerCharAttributes.specialAbility.y,this._tutorialFinger.visible=!0,this._animateTutorialFinger();break;case this.STATE_GAME_OVER:this._grid.playerChars[1].setOutOfActions(!0),TweenMax.delayedCall(1.5,function(){this._tutorialMessage.visible=!0,this._tutorialMessage.showMessages([a.assets.getJSON("languages").TUTORIAL_07_00[a.language],a.assets.getJSON("languages").TUTORIAL_07_01[a.language],a.assets.getJSON("languages").TUTORIAL_07_02[a.language]]),this._tutorialMessage.signals.onAllRead.add(function(){this._music.stop(),this.signals.onGameOver.dispatch()},this),this._tutorialMessage.signals.onContinue.add(function(t){if(0==t)for(var e=[{type:s.PICKUP_ID_SPECIAL_ABILITY_RECHARGE,row:6,col:2},{type:s.PICKUP_ID_HEALTH_PACK,row:5,col:5},{type:s.PICKUP_ID_DOUBLE_DAMAGE,row:3,col:4}],i=0;i<e.length;++i)this._grid.createPickUp(e[i].row,e[i].col,e[i].type)},this)},null,this)}}}var W=!0,F=!1,K=void 0;try{for(var j,V=this._grid.playerChars[Symbol.iterator]();!(W=(j=V.next()).done);W=!0){var Y=j.value;null!=Y.parent&&Y.updatePS()}}catch(t){F=!0,K=t}finally{try{!W&&V.return&&V.return()}finally{if(F)throw K}}this._hud.playerCharAttributes.specialAbility.updatePS(),this._grid.updateZSortedContainer()},n.prototype.pause=function(){this._isPaused=!0,this._timeline.pause(),this._CombatPanel.pause(),this._music.pause(),this._grid.pause()},n.prototype.resume=function(){this._isPaused=!1,this._timeline.resume(),this._CombatPanel.resume(),this._music.play(),this._grid.resume()},n.prototype.isBusy=function(){return this._timeline.isActive()},n.prototype._animateTutorialFinger=function(){TweenMax.killTweensOf(this._tutorialFinger),TweenMax.from(this._tutorialFinger,.5,{x:this._tutorialFinger.x+20,y:this._tutorialFinger.y-20,ease:Sine.easeInOut,repeat:-1,yoyo:!0})},n.prototype._initGrid=function(){var t=[],e=a.assets.getJSON("levels").levels[9],i=0,n=0,_=!0,c=!1,p=void 0;try{for(var u,d=e.tiles.nonWalkable[Symbol.iterator]();!(_=(u=d.next()).done);_=!0){var I=u.value;if(I>0){var I=new PIXI.Point(n,i);t.push(I)}++n,n>=s.GRID_COL_COUNT&&(n=0,++i)}}catch(t){c=!0,p=t}finally{try{!_&&d.return&&d.return()}finally{if(c)throw p}}this._grid=new r,this._grid.init(),this._scene.gameLayer.addChild(this._grid);for(var T=0;T<t.length;++T){var m=new o;m.init(),this._grid.addObstacle(m,t[T].x,t[T].y)}var y=new h,g=a.assets.getJSON("playerCharacters").playerCharacters[0];y.init(g),this._grid.addPlayerChar(y,2,5);var S=!0,C=!1,f=void 0;try{for(var x,P=e.decoration[Symbol.iterator]();!(S=(x=P.next()).done);S=!0){var v=x.value,E=!0,A=!1,w=void 0;try{for(var b,O=v[Symbol.iterator]();!(E=(b=O.next()).done);E=!0){var B=b.value,k=new l;k.init(B.gid),this._grid.addDecoration(k,B.x/B.width,B.y/B.height-1)}}catch(t){A=!0,w=t}finally{try{!E&&O.return&&O.return()}finally{if(A)throw w}}}}catch(t){C=!0,f=t}finally{try{!S&&P.return&&P.return()}finally{if(C)throw f}}y.refresh(),this._grid.updateZSortedContainer()},n.prototype.onPickUpActivated=function(t,e){t==this._input.selectedChar&&t instanceof h?(this._hud.playerCharAttributes.conditionList.update(),this._hud.playerCharAttributes.specialAbility.update(),this._hud.playerCharAttributes.updateStats(t,!0),t.hasAttacked||e.type!=s.PICKUP_ID_DOUBLE_ATTACK_RANGE||(t.clearEnemiesInRange(),t.enemiesInRange=this._grid.findEnemiesInRange(t,e.tile),t.highlightEnemiesInRange())):t==this._input.selectedChar&&t instanceof _&&(this._hud.enemyCharAttributes.conditionList.update(),this._hud.enemyCharAttributes.specialAbility.update(),this._hud.enemyCharAttributes.updateStats(t,!0))},n.prototype.onCombatStarted=function(t,e){this._CombatPanel.show(t,e),this._CombatPanel.visible=!0},Object.defineProperty(n.prototype,"input",{get:function(){return this._input}}),Object.defineProperty(n.prototype,"grid",{get:function(){return this._grid}}),Object.defineProperty(n.prototype,"timeline",{get:function(){return this._timeline}}),Object.defineProperty(n.prototype,"hud",{get:function(){return this._hud}}),Object.defineProperty(n.prototype,"music",{get:function(){return this._music}}),Object.defineProperty(n.prototype,"events",{get:function(){return this._arrGameEvent}}),Object.defineProperty(n.prototype,"isPaused",{get:function(){return this._isPaused}}),Object.defineProperty(n.prototype,"isGameOver",{set:function(t){this._isGameOver=t}}),Object.defineProperty(n.prototype,"state",{set:function(t){this._state=t}}),Object.defineProperty(n.prototype,"scene",{get:function(){return this._scene},set:function(t){this._scene=t}})},{"../Common":6,"../CommonGame":7,"../GrayScaleFilter":8,"../ui/UITutorialMessage":59,"../ui/overlays/CombatPanel":60,"./GameEvent":11,"./GameInput":12,"./GameMusic":13,"./hud/HUD":20,"./world/Decoration":30,"./world/EnemyCharacter":31,"./world/MyGrid":33,"./world/Obstacle":34,"./world/PlayerCharacter":36}],16:[function(t,e,i){"use strict";function n(){this._aiSpecialAbility=null,this._influenceMap=null,this._arrBestAction=[],this.ARR_TILE_ACTION_ID=["nothing","attack"],this.TENSION_WEIGHT=70,this.TENSION_AI_FACTOR=.25,this.TENSION_PICKUP_FACTOR=1,this.TENSION_PLAYER_FACTOR=1,this.SAFE_ATTACK_WEIGHT=600,this.AI_INFLUENCE_WEIGHT=75,this.FAVOURABLE_COMBAT_WEIGHT=40,this.INSTANT_KILL_WEIGHT=1500,this.UNEFFECTIVE_DAMAGE_WEIGHT=-20,this.SAME_ATTACK_TARGET_WEIGHT=50,this.DOUBLE_DAMAGE_PICKUP_WEIGHT=500,this.DOUBLE_ATTACK_RANGE_PICKUP_WEIGHT=400,this.DOUBLE_SPEED_PICKUP_WEIGHT=350,this.SPECIAL_ABILITY_RECHARGE_PICKUP_WEIGHT=400,this.HEALTH_PACK_PICKUP_WEIGHT=500,this.COINS_PACK_PICKUP_WEIGHT=-100,this.RISK_WEIGHT=-150,this.HEALING_POWER_RAND_FACTOR=.8,this.DOUBLE_ATTACK_NO_DD_PROB=.7,this.DOUBLE_ATTACK_TARGET_WITH_SHD_PROB=.5,this.MOVE_ATTACK_MOVE_NO_PICKUP_PROB=.9}var a=t("../../Common"),s=t("../../CommonGame"),r=(t("../world/Tile"),t("../world/MyGrid"),t("../MyGame"),t("./InfluenceMap")),o=t("../world/PickUp"),h=(t("./IMapTileData"),t("./AISpecialAbility"));e.exports=n,n.prototype.constructor=n,n.prototype.init=function(){this._aiSpecialAbility=new h(this),this._influenceMap=new r,this._influenceMap.init()},n.prototype.think=function(){var t=a.game.grid;this._arrBestAction=[];var e=[],i=!0,n=!1,s=void 0;try{for(var r,o=t.enemyChars[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){r.value;e.push([])}}catch(t){n=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}this._influenceMap.generate(t),this._populateScoredActions(e);var h=[];this._populateActionCombinationsRec(0,0,"",h,e,""),this._scoreActionCombinations(e,h);var h=this._sortActionCombinations(h),_=this._findValidActionComb(e,h),l=!0,c=!1,p=void 0;try{for(var u,d=_[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var I=u.value,T=I.actionIndex;if(T!=-1){var m=I.charIndex,y={enemyChar:t.enemyChars[m],sequence:e[m][T].sequence};this._arrBestAction.push(y)}}}catch(t){c=!0,p=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw p}}},n.prototype._populateScoredActions=function(t){var e=a.game.grid,i=this._findAiSuperiority(),n=-1,r=!0,o=!1,h=void 0;try{for(var _,l=e.enemyChars[Symbol.iterator]();!(r=(_=l.next()).done);r=!0){
var c=_.value;if(++n,0!=c.currentHealth){var p=e.findWalkableTiles(c,{includeEnemyChars:!0}),u=!0,d=!1,I=void 0;try{for(var T,m=p[Symbol.iterator]();!(u=(T=m.next()).done);u=!0){var y=T.value,g=!0,S=!1,C=void 0;try{for(var f,x=this.ARR_TILE_ACTION_ID[Symbol.iterator]();!(g=(f=x.next()).done);g=!0){var P=f.value,v=0;switch(v=i?this._influenceMap.getTile(y.col,y.row).getInfluence(s.INFLUENCE_ID_PLAYER)*this.TENSION_WEIGHT:(this._influenceMap.getTile(y.col,y.row).getInfluence(s.INFLUENCE_ID_PLAYER)*this.TENSION_PLAYER_FACTOR+this._influenceMap.getTile(y.col,y.row).getInfluence(s.INFLUENCE_ID_AI)*this.TENSION_AI_FACTOR+this._influenceMap.getTile(y.col,y.row).getInfluence(s.INFLUENCE_ID_PICKUP)*this.TENSION_PICKUP_FACTOR)*this.TENSION_WEIGHT,P){case"nothing":var E={tile:y,sequence:[],score:v};y!=c.tile&&(E.sequence.push({moveTo:y}),E.score+=this._findPickUpScore(c,y),E.score+=this._findPotentialReceivedDamage(c,y)*this.RISK_WEIGHT),t[n].push(E);break;case"attack":var A=e.findEnemiesInRange(c,y),w=!0,b=!1,O=void 0;try{for(var B,k=A[Symbol.iterator]();!(w=(B=k.next()).done);w=!0){var D=B.value,E={tile:y,sequence:[],score:v};y!=c.tile&&(E.sequence.push({moveTo:y}),E.score+=this._findPickUpScore(c,y)),E.sequence.push({attackTo:D}),E.score+=this._findAttackActionScore(c,D,y),t[n].push(E)}}catch(t){b=!0,O=t}finally{try{!w&&k.return&&k.return()}finally{if(b)throw O}}}}}catch(t){S=!0,C=t}finally{try{!g&&x.return&&x.return()}finally{if(S)throw C}}}}catch(t){d=!0,I=t}finally{try{!u&&m.return&&m.return()}finally{if(d)throw I}}}}}catch(t){o=!0,h=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw h}}},n.prototype._populateActionCombinationsRec=function(t,e,i,n,a,s){if(t==a.length){var r={score:e,actionIndexes:[]},o=i.split("#"),h=!0,_=!1,l=void 0;try{for(var c,p=o[Symbol.iterator]();!(h=(c=p.next()).done);h=!0){var i=c.value;r.actionIndexes.push(parseInt(i))}}catch(t){_=!0,l=t}finally{try{!h&&p.return&&p.return()}finally{if(_)throw l}}n.push(r)}else{i.length>0&&(i+="#");var u=a[t];if(u.length>0){var d=0,I=!0,T=!1,m=void 0;try{for(var y,g=u[Symbol.iterator]();!(I=(y=g.next()).done);I=!0){var S=y.value,C=S.tile.row.toString()+S.tile.col.toString();s.indexOf(C)==-1&&(s.length>0&&(s+="#"),this._populateActionCombinationsRec(t+1,e+S.score,i+d,n,a,s+C)),++d}}catch(t){T=!0,m=t}finally{try{!I&&g.return&&g.return()}finally{if(T)throw m}}}else this._populateActionCombinationsRec(t+1,e,i+"-1",n,a,s)}},n.prototype._scoreActionCombinations=function(t,e){for(var i=0;i<e.length;){for(var n=!1,s=e[i],r=s.actionIndexes,o=[],h=0;h<r.length;++h){if(r[h]!=-1){var _=t[h][r[h]].sequence,l=!0,c=!1,p=void 0;try{for(var u,d=_[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var I=u.value;if(null!=I.attackTo){var T=!1,m=!0,y=!1,g=void 0;try{for(var S,C=o[Symbol.iterator]();!(m=(S=C.next()).done);m=!0){var f=S.value;if(f.target==I.attackTo){if(f.target.currentHealth<=f.damage){n=!0;break}T=!0;var x=a.game.grid.enemyChars[h].currentDamage+a.game.grid.enemyChars[h].findEssenceBonus(I.attackTo.essenceType);f.damage+=x,f.attackerCount+=1}}}catch(t){y=!0,g=t}finally{try{!m&&C.return&&C.return()}finally{if(y)throw g}}if(!T){var x=a.game.grid.enemyChars[h].currentDamage+a.game.grid.enemyChars[h].findEssenceBonus(I.attackTo.essenceType);o.push({target:I.attackTo,damage:x,attackerCount:1})}}if(n)break}}catch(t){c=!0,p=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw p}}}if(n)break}if(n)e.splice(i,1);else{var P=!0,v=!1,E=void 0;try{for(var A,w=o[Symbol.iterator]();!(P=(A=w.next()).done);P=!0){var b=A.value;b.attackerCount>1&&(s.score+=b.target.currentHealth*b.attackerCount*this.SAME_ATTACK_TARGET_WEIGHT,b.damage>b.target.currentHealth&&(s.score+=this.INSTANT_KILL_WEIGHT,s.score-=(b.damage-b.target.currentHealth)*b.attackerCount*this.SAME_ATTACK_TARGET_WEIGHT))}}catch(t){v=!0,E=t}finally{try{!P&&w.return&&w.return()}finally{if(v)throw E}}i+=1}}},n.prototype._sortActionCombinations=function(t){var e=[],i=!0,n=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){var h=r.value;if(0==e.length)e.push(h);else{for(var _=e.length,l=0;l<e.length;++l)if(h.score>e[l].score||h.score==e[l].score&&a.randBool()){e.splice(l,0,h);break}_==e.length&&e.splice(_,0,h)}}}catch(t){n=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}return e},n.prototype._findValidActionComb=function(t,e){for(var i=[],n=0;n<t.length;++n)i.push(n);var s=a.heapPermutations(i),r=null,o=null,h=!0,_=!1,l=void 0;try{for(var c,p=e[Symbol.iterator]();!(h=(c=p.next()).done);h=!0){var u=c.value,d=!0,I=!1,T=void 0;try{for(var m,y=s[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var g=m.value,S=!0,C=a.game.grid.createPfGrid(-1,-1),f=!0,x=!1,P=void 0;try{for(var v,E=g[Symbol.iterator]();!(f=(v=E.next()).done);f=!0){var A=v.value,w=a.game.grid.enemyChars[A],b=null,O=null,B=u.actionIndexes[A];if(B>-1){var k=t[A][B].sequence,D=!0,G=!1,R=void 0;try{for(var L,H=k[Symbol.iterator]();!(D=(L=H.next()).done);D=!0){var M=L.value;if(null!=M.moveTo){O=M,b=M.moveTo,C[w.tile.row][w.tile.col]=1;break}}}catch(t){G=!0,R=t}finally{try{!D&&H.return&&H.return()}finally{if(G)throw R}}}if(null!=b){var X=new Graph(C),N=X.grid[w.tile.row][w.tile.col],U=X.grid[b.row][b.col],W=astar.search(X,N,U);if(0==W.length||W.length>w.currentSpeed){S=!1;break}C[b.row][b.col]=0,O.path=W}}}catch(t){x=!0,P=t}finally{try{!f&&E.return&&E.return()}finally{if(x)throw P}}if(S){o=g;break}}}catch(t){I=!0,T=t}finally{try{!d&&y.return&&y.return()}finally{if(I)throw T}}if(null!=o){r=u;break}}}catch(t){_=!0,l=t}finally{try{!h&&p.return&&p.return()}finally{if(_)throw l}}var F=[],K=!0,j=!1,V=void 0;try{for(var Y,J=o[Symbol.iterator]();!(K=(Y=J.next()).done);K=!0){var A=Y.value;F.push({charIndex:A,actionIndex:r.actionIndexes[A]})}}catch(t){j=!0,V=t}finally{try{!K&&J.return&&J.return()}finally{if(j)throw V}}return F},n.prototype._findPickUpScore=function(t,e){var i=0;if(e.content instanceof o)switch(e.content.type){case s.PICKUP_ID_DOUBLE_DAMAGE:i+=t.damage*this.DOUBLE_DAMAGE_PICKUP_WEIGHT;break;case s.PICKUP_ID_DOUBLE_ATTACK_RANGE:i+=t.damage*this.DOUBLE_DAMAGE_ATTACK_RANGE_WEIGHT;break;case s.PICKUP_ID_DOUBLE_SPEED:i+=t.speed*this.DOUBLE_SPEED_PICKUP_WEIGHT;break;case s.PICKUP_ID_SPECIAL_ABILITY_RECHARGE:i+=(t.specialAbility.rechargeCounter+1)*this.SPECIAL_ABILITY_RECHARGE_PICKUP_WEIGHT;break;case s.PICKUP_ID_HEALTH_PACK:i+=(t.health-t.currentHealth)*this.HEALTH_PACK_PICKUP_WEIGHT;break;case s.PICKUP_ID_COIN_PACK:i+=this.COINS_PACK_PICKUP_WEIGHT}return i},n.prototype._findAttackActionScore=function(t,e,i){var n=0,r="",o=t.currentDamage+t.findEssenceBonus(e.essenceType),h=e.currentDamage+e.findEssenceBonus(t.essenceType),_=this._influenceMap.getTile(i.col,i.row);if(n=(_.getInfluence(s.INFLUENCE_ID_AI)-_.getInfluence(s.INFLUENCE_ID_PLAYER))*this.AI_INFLUENCE_WEIGHT,n<0&&(n=0),r="[is="+n+"]",o>=e.currentHealth){var l=e.currentHealth*this.INSTANT_KILL_WEIGHT+(o-e.currentHealth)*this.UNEFFECTIVE_DAMAGE_WEIGHT;n+=l,r+=", [ik="+l+"]"}else n+=(t.health/(1.5*h)-e.health/(1.5*o))*this.FAVOURABLE_COMBAT_WEIGHT;if(t.currentAttackRange>e.currentAttackRange){var c=a.game.grid.findTileDistance(i,e.tile);c-=e.currentAttackRange,c>0&&(n+=c*this.SAFE_ATTACK_WEIGHT,r+=", [sa="+c*this.SAFE_ATTACK_WEIGHT+"]")}return n},n.prototype._findPotentialReceivedDamage=function(t,e){var i=0,n=!0,s=!1,r=void 0;try{for(var o,h=a.game.grid.playerChars[Symbol.iterator]();!(n=(o=h.next()).done);n=!0){var _=o.value;if(_.currentHealth>0){var l=0;_.tile.col==e.col?l=Math.abs(_.tile.row-e.row):_.tile.row==e.row&&(l=Math.abs(_.tile.col-e.col)),l>0&&l<=_.currentAttackRange&&(i+=_.currentDamage+_.findEssenceBonus(t.essenceType))}}}catch(t){s=!0,r=t}finally{try{!n&&h.return&&h.return()}finally{if(s)throw r}}return i},n.prototype._findAiSuperiority=function(){var t=0,e=0,i=!0,n=!1,s=void 0;try{for(var r,o=a.game.grid.enemyChars[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){var h=r.value;h.currentHealth<=0&&++t}}catch(t){n=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}var _=!0,l=!1,c=void 0;try{for(var p,u=a.game.grid.playerChars[Symbol.iterator]();!(_=(p=u.next()).done);_=!0){var d=p.value;d.currentHealth<=0&&++e}}catch(t){l=!0,c=t}finally{try{!_&&u.return&&u.return()}finally{if(l)throw c}}return e>t},Object.defineProperty(n.prototype,"enemyCharActions",{get:function(){return this._arrBestAction}}),Object.defineProperty(n.prototype,"specialAbility",{get:function(){return this._aiSpecialAbility}})},{"../../Common":6,"../../CommonGame":7,"../MyGame":14,"../world/MyGrid":33,"../world/PickUp":35,"../world/Tile":38,"./AISpecialAbility":17,"./IMapTileData":18,"./InfluenceMap":19}],17:[function(t,e,i){"use strict";function n(t){this._ai=t}var a=t("../../Common"),s=t("../../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.preEvaluateActivation=function(t,e,i){if(t.specialAbility.isReady())switch(t.specialAbility.type){case s.SA_ID_SPLASH_DAMAGE:var n=e[i].attackTo;if(null!=n){var r=0,o=!0,h=!1,_=void 0;try{for(var l,c=a.game.grid.playerChars[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var p=l.value;p.currentHealth>0&&p!=n&&++r}}catch(t){h=!0,_=t}finally{try{!o&&c.return&&c.return()}finally{if(h)throw _}}var u=a.game.grid.findFriendlyChars(n,s.SPLASH_DAMAGE_RANGE);u.length>=1&&Math.random()<=u.length/r&&e.splice(i,0,{activateSpecialAbility:t.specialAbility})}break;case s.SA_ID_HEALING_POWER:var d=!1,I=e[i].attackTo;null!=I&&.5*I.currentDamage>=t.currentHealth&&(d=!0),d||(d=Math.random()<=(t.health-t.currentHealth)/t.health*this._ai.HEALING_POWER_RAND_FACTOR),d&&e.splice(i,0,{activateSpecialAbility:t.specialAbility});break;case s.SA_ID_HEAL_OTHERS:this._isHealOthersActivation(t)&&e.splice(i,0,{activateSpecialAbility:t.specialAbility})}},n.prototype.postEvaluateActivation=function(t,e,i){if(t.specialAbility.isReady())switch(t.specialAbility.type){case s.SA_ID_EXTRA_ATTACK:var n=e[i-1].attackTo;if(null!=n&&(t.hasCondition(s.COND_ID_DOUBLE_DAMAGE)||!t.hasCondition(s.COND_ID_DOUBLE_DAMAGE)&&Math.random()<=this._ai.DOUBLE_ATTACK_NO_DD_PROB)){var r=a.game.grid.findEnemiesInRange(t),o={target:null,score:0},h=!0,_=!1,l=void 0;try{for(var c,p=r[Symbol.iterator]();!(h=(c=p.next()).done);h=!0){var u=c.value,d=this._ai._findAttackActionScore(t,u,t.tile);(null==o.target||null!=o.target&&(o.score<d||o.score==d&&a.randBool()))&&(o={target:u,score:d})}}catch(t){_=!0,l=t}finally{try{!h&&p.return&&p.return()}finally{if(_)throw l}}null!=o.target&&(e.splice(i,0,{activateSpecialAbility:t.specialAbility}),e.splice(i+1,0,{attackTo:o.target}))}break;case s.SA_ID_EXTRA_MOVE:var n=e[i-1].attackTo;if(null!=n){var I=a.game.grid.findWalkableTiles(t),T={tile:t.tile,score:this._ai._findPotentialReceivedDamage(t,t.tile)*this._ai.RISK_WEIGHT,isPickUp:!1},m=[],y=!1,g=!0,S=!1,C=void 0;try{for(var f,x=this._ai._arrBestAction[Symbol.iterator]();!(g=(f=x.next()).done);g=!0){var P=f.value;if(P.enemyChar==t)y=!0;else if(y){var v=!0,E=!1,A=void 0;try{for(var w,b=P.sequence[Symbol.iterator]();!(v=(w=b.next()).done);v=!0){var O=w.value;null!=O.moveTo&&(m=m.concat(O.path))}}catch(t){E=!0,A=t}finally{try{!v&&b.return&&b.return()}finally{if(E)throw A}}}}}catch(t){S=!0,C=t}finally{try{!g&&x.return&&x.return()}finally{if(S)throw C}}var B=!0,k=!1,D=void 0;try{for(var G,R=I[Symbol.iterator]();!(B=(G=R.next()).done);B=!0){var L=G.value,H=!1,M=!0,X=!1,N=void 0;try{for(var U,W=m[Symbol.iterator]();!(M=(U=W.next()).done);M=!0){var F=U.value;if(F.x==L.row&&F.y==L.col){H=!0;break}}}catch(t){X=!0,N=t}finally{try{!M&&W.return&&W.return()}finally{if(X)throw N}}if(!H){var K=!1,j=this._ai._findPickUpScore(t,t.tile);j>0&&(K=!0),j-=this._ai._findPotentialReceivedDamage(t,L)*this.RISK_WEIGHT,(j>T.score||j==T.score&&a.randBool())&&(T={tile:L,score:j,isPickUp:K})}}}catch(t){k=!0,D=t}finally{try{!B&&R.return&&R.return()}finally{if(k)throw D}}T.tile!=t.tile&&(T.isPickUp||!T.isPickUp&&Math.random()<=this._ai.MOVE_ATTACK_MOVE_NO_PICKUP_PROB)&&(e.splice(i,0,{activateSpecialAbility:t.specialAbility}),e.splice(i+1,0,{moveTo:T.tile}))}break;case s.SA_ID_HEALING_POWER:var V=!1,Y=this._ai._findPotentialReceivedDamage(t,t.tile);Y>=t.currentHealth&&(V=!0),V||(V=Math.random()<=(t.health-t.currentHealth)/t.health*this._ai.HEALING_POWER_RAND_FACTOR),V&&e.splice(i,0,{activateSpecialAbility:t.specialAbility});break;case s.SA_ID_HEAL_OTHERS:this._isHealOthersActivation(t)&&e.splice(i,0,{activateSpecialAbility:t.specialAbility})}},n.prototype._isHealOthersActivation=function(t){var e=!1,i=[],n=a.game.grid.findFriendlyChars(t),s=!0,r=!1,o=void 0;try{for(var h,_=n[Symbol.iterator]();!(s=(h=_.next()).done);s=!0){var l=h.value;i.push(l.character)}}catch(t){r=!0,o=t}finally{try{!s&&_.return&&_.return()}finally{if(r)throw o}}var c=!0,p=!1,u=void 0;try{for(var d,I=i[Symbol.iterator]();!(c=(d=I.next()).done);c=!0){var T=d.value,m=this._ai._findPotentialReceivedDamage(T,T.tile);if(m>=T.currentHealth){e=!0;break}}}catch(t){p=!0,u=t}finally{try{!c&&I.return&&I.return()}finally{if(p)throw u}}if(!e){var y=0,g=0,S=!0,C=!1,f=void 0;try{for(var x,P=i[Symbol.iterator]();!(S=(x=P.next()).done);S=!0){var T=x.value;y+=T.health-T.currentHealth,g+=T.health}}catch(t){C=!0,f=t}finally{try{!S&&P.return&&P.return()}finally{if(C)throw f}}var v=0,E=!0,A=!1,w=void 0;try{for(var b,O=a.game.grid.enemyChars[Symbol.iterator]();!(E=(b=O.next()).done);E=!0){var B=b.value;B!=t&&B.currentHealth>0&&++v}}catch(t){A=!0,w=t}finally{try{!E&&O.return&&O.return()}finally{if(A)throw w}}e=Math.random()<=y/g*(i.length/v)}return e}},{"../../Common":6,"../../CommonGame":7}],18:[function(t,e,i){"use strict";function n(t,e){this._arrInfluence=[0,0,0],this._x=t,this._y=e}t("../../Common"),t("../../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.getInfluence=function(t){return this._arrInfluence[t]},n.prototype.getEffectiveInfluence=function(t,e){return this._arrInfluence[t]-this._arrInfluence[e]},n.prototype.getTension=function(){var t=0,e=!0,i=!1,n=void 0;try{for(var a,s=this._arrInfluence[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;t+=r}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}return t},n.prototype.setInfluence=function(t,e){this._arrInfluence[t]=Math.max(e,this._arrInfluence[t])},n.prototype.clear=function(){this._arrInfluence=[0,0,0]},Object.defineProperty(n.prototype,"x",{get:function(){return this._x}}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y}})},{"../../Common":6,"../../CommonGame":7}],19:[function(t,e,i){"use strict";function n(){this._arrIMapTileData=[]}var a=(t("../../Common"),t("../../CommonGame")),s=(t("../world/MyGrid"),t("../world/Tile"),t("./IMapTileData"));e.exports=n,n.prototype.constructor=n,n.prototype.init=function(){for(var t=0;t<a.GRID_ROW_COUNT;++t){this._arrIMapTileData.push([]);for(var e=0;e<a.GRID_COL_COUNT;++e)this._arrIMapTileData[t].push(new s(e,t))}},n.prototype.generate=function(t){for(var e=0;e<a.GRID_ROW_COUNT;++e)for(var i=0;i<a.GRID_COL_COUNT;++i)this._arrIMapTileData[e][i].clear();for(var e=0;e<t.playerChars.length;++e)if(t.playerChars[e].currentHealth>0){var n=t.playerChars[e].tile;this._arrIMapTileData[n.row][n.col].setInfluence(a.INFLUENCE_ID_PLAYER,this._getCharacterInfluenceValue(t.playerChars[e]))}for(var e=0;e<t.enemyChars.length;++e)if(t.enemyChars[e].currentHealth>0){var n=t.enemyChars[e].tile;this._arrIMapTileData[n.row][n.col].setInfluence(a.INFLUENCE_ID_AI,this._getCharacterInfluenceValue(t.enemyChars[e]))}for(var e=0;e<t.pickUps.length;++e){var n=t.pickUps[e].tile;this._arrIMapTileData[n.row][n.col].setInfluence(a.INFLUENCE_ID_PICKUP,this._getPickUpInfluenceValue(t.pickUps[e]))}for(var e=0;e<a.GRID_ROW_COUNT;e++)for(var i=0;i<a.GRID_COL_COUNT;i++)this._arrIMapTileData[e][i].setInfluence(a.INFLUENCE_ID_PLAYER,this._getTileInfluenceValue(a.INFLUENCE_ID_PLAYER,i,e,-1)),this._arrIMapTileData[e][i].setInfluence(a.INFLUENCE_ID_AI,this._getTileInfluenceValue(a.INFLUENCE_ID_AI,i,e,-1)),this._arrIMapTileData[e][i].setInfluence(a.INFLUENCE_ID_PICKUP,this._getTileInfluenceValue(a.INFLUENCE_ID_PICKUP,i,e,-1));for(var e=a.GRID_ROW_COUNT-1;e>=0;e--)for(var i=a.GRID_COL_COUNT-1;i>=0;i--)this._arrIMapTileData[e][i].setInfluence(a.INFLUENCE_ID_PLAYER,this._getTileInfluenceValue(a.INFLUENCE_ID_PLAYER,i,e,1)),this._arrIMapTileData[e][i].setInfluence(a.INFLUENCE_ID_AI,this._getTileInfluenceValue(a.INFLUENCE_ID_AI,i,e,1)),this._arrIMapTileData[e][i].setInfluence(a.INFLUENCE_ID_PICKUP,this._getTileInfluenceValue(a.INFLUENCE_ID_PICKUP,i,e,1))},n.prototype.getTile=function(t,e){return this._arrIMapTileData[e][t]},n.prototype.print=function(t){for(var e=0;e<this._arrIMapTileData.length;++e)for(var i="",n=0;n<this._arrIMapTileData[e].length;++n)i+=this._arrIMapTileData[e][n].getInfluence(t)+" - "},n.prototype.printTension=function(){for(var t=0;t<this._arrIMapTileData.length;++t)for(var e="",i=0;i<this._arrIMapTileData[t].length;++i)e+=this._arrIMapTileData[t][i].getTension()+" - "},n.prototype.findMaxInfluenceTile=function(t,e){var i=null,n=!0,a=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var h=r.value;(null==i||null!=i&&i.getInfluence(t)<this._arrIMapTileData[h.row][h.col].getInfluence(t))&&(i=this._arrIMapTileData[h.row][h.col])}}catch(t){a=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}return i},n.prototype.findMaxEffectiveInfluenceTile=function(t,e,i){var n=null,a=0,s=!0,r=!1,o=void 0;try{for(var h,_=i[Symbol.iterator]();!(s=(h=_.next()).done);s=!0){var l=h.value,c=this._arrIMapTileData[l.row][l.col],p=c.getEffectiveInfluence(t,e);(null==n||null!=n&&a<p)&&(n=c,a=p)}}catch(t){r=!0,o=t}finally{try{!s&&_.return&&_.return()}finally{if(r)throw o}}return n},n.prototype.findMaxTensionTile=function(t){var e=null,i=0,n=!0,a=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var h=r.value,_=this._arrIMapTileData[h.row][h.col],l=_.getTension();(null==e||null!=e&&i<l)&&(e=_,i=l)}}catch(t){a=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}return e},n.prototype._getCharacterInfluenceValue=function(t){return t.currentSpeed+t.currentAttackRange+t.currentDamage},n.prototype._getPickUpInfluenceValue=function(t){var e=0;switch(t.type){case a.PICKUP_ID_DOUBLE_DAMAGE:case a.PICKUP_ID_HEALTH_PACK:case a.PICKUP_ID_SPECIAL_ABILITY_RECHARGE:e=20;break;case a.PICKUP_ID_DOUBLE_SPEED:e=15;break;case a.PICKUP_ID_COIN_PACK:e=10}return e},n.prototype._getTileInfluenceValue=function(t,e,i,n){var s=i+n>=0&&i+n<a.GRID_ROW_COUNT?this._arrIMapTileData[i+n][e].getInfluence(t):0,r=e+n>=0&&e+n<a.GRID_COL_COUNT?this._arrIMapTileData[i][e+n].getInfluence(t):0,o=Math.max(s,r)-1;return o}},{"../../Common":6,"../../CommonGame":7,"../world/MyGrid":33,"../world/Tile":38,"./IMapTileData":18}],20:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._isEndTurnWarning=!1,this._playerCharAttributes=null,this._enemyCharAttributes=null,this._endTurnButton=null,this._enemyTurnText=null,this._undoButton=null,this._essenceGuideSprite=null,this._endTurnWarningContainer=null,this._endTurnWarningBg=null,this._endTurnWarningText=null,this._lock=null}var a=t("../../Common"),s=t("../../CommonGame"),r=t("./UICharacterAttributes"),o=t("./UIPlayerCharAttributes"),h=t("./UILock"),_=(t("../world/MyGrid"),t("../MyGame"),t("../world/Tile")),l=t("../GameEvent");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._playerCharAttributes=new o,this._playerCharAttributes.init(),this._playerCharAttributes.visible=!1,this._playerCharAttributes.position=new PIXI.Point(.5*a.STAGE_WIDTH-270,.5*a.STAGE_HEIGHT+350),this.addChild(this._playerCharAttributes),this._enemyCharAttributes=new r,this._enemyCharAttributes.orientation=-1,this._enemyCharAttributes.init(),this._enemyCharAttributes.visible=!1,this._enemyCharAttributes.position=new PIXI.Point(.5*a.STAGE_WIDTH+270,.5*a.STAGE_HEIGHT+350),this.addChild(this._enemyCharAttributes);var t=new p3.ButtonStates(a.assets.getTexture("btn_secondary_off"),a.assets.getTexture("btn_secondary_over"),a.assets.getTexture("btn_secondary_down"));this._endTurnButton=new p3.Button(t),this._endTurnButton.anchor=new PIXI.Point(.5,.5),this._endTurnButton.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT+.5*(s.GRID_ROW_COUNT+1)*_.SIDE_LENGTH),this._endTurnButton.signals.click.add(this._onEndTurnButton_Click,this),this.addChild(this._endTurnButton);var e=a.assets.getJSON("languages").END_TURN[a.language].toUpperCase(),i=new PIXI.extras.BitmapText(e,{font:"40px ed_50",align:"center"});i.anchor=new PIXI.Point(.5,.5),i.y-=5,this._endTurnButton.addChild(i);var n=new PIXI.Sprite(a.assets.getTexture("stats_special_counter_full-copy"));n.anchor=new PIXI.Point(.5,.5),n.y-=5,this._endTurnButton.addChild(n),i.x-=.5*n.width,n.x=.5*i.width+5,this._enemyTurnText=new PIXI.extras.BitmapText("BOX MORE MOVES...",{font:"50px ed_50",align:"center"}),this._enemyTurnText.anchor=new PIXI.Point(0,.5),this._enemyTurnText.position=new PIXI.Point(.5*a.STAGE_WIDTH-350,.5*a.STAGE_HEIGHT+.5*(s.GRID_ROW_COUNT+1)*_.SIDE_LENGTH),this.addChild(this._enemyTurnText),this._enemyTurnText.alpha=0,this._enemyTurnText.x-=50,this._essenceGuideSprite=new PIXI.Sprite(a.assets.getTexture("essence_guide")),this._essenceGuideSprite.x=.5*a.STAGE_WIDTH-.5*a.STAGE_MIN_WIDTH+.5*this._essenceGuideSprite.width,this._essenceGuideSprite.y=.5*this._essenceGuideSprite.height+10,this._essenceGuideSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._essenceGuideSprite),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_square_off"),a.assets.getTexture("btn_primary_square_over"),a.assets.getTexture("btn_primary_square_down"),a.assets.getTexture("icon_primary_replay_off")),t.iconOver=a.assets.getTexture("icon_primary_replay_over"),t.iconDown=a.assets.getTexture("icon_primary_replay_down"),this._undoButton=new p3.Button(t),this._undoButton.interactive=!1,this._undoButton.alpha=0,this._undoButton.anchor=new PIXI.Point(.5,.5),this._undoButton.position=new PIXI.Point(.5*a.STAGE_WIDTH-450-40,this._essenceGuideSprite.y+.5*this._essenceGuideSprite.height+.5*a.assets.getTexture("btn_primary_square_off").height),this._undoButton.signals.click.add(this._onUndoButton_Click,this),this.addChild(this._undoButton),this._endTurnWarningContainer=new PIXI.Container,this._endTurnWarningContainer.x=this._endTurnButton.x,this._endTurnWarningContainer.y=this._endTurnButton.y-70,this._endTurnWarningContainer.alpha=0,this.addChild(this._endTurnWarningContainer);var e=a.assets.getJSON("languages").END_TURN_WARNING[a.language];this._endTurnWarningText=new PIXI.Text(e,{font:"28px Arial",fill:"#000000",align:"center",cacheAsBitmap:!0}),this._endTurnWarningText.anchor=new PIXI.Point(.5,1),this._endTurnWarningText.y=-20,this._endTurnWarningBg=new PIXI.Sprite(a.assets.getTexture("tutorial_panel")),this._endTurnWarningBg.anchor=new PIXI.Point(.5,1),this._endTurnWarningBg.height=70,this._endTurnWarningBg.width=this._endTurnWarningText.width+40,this._endTurnWarningContainer.addChild(this._endTurnWarningBg),this._endTurnWarningContainer.addChild(this._endTurnWarningText),this._lock=new h,this._lock.init(),this.addChild(this._lock)},n.prototype.update=function(){for(var t=a.game.grid.playerChars,e=!0,i=0;i<t.length;++i)if(t[i].currentHealth>0&&(!t[i].hasMoved&&t[i].canMove()||!t[i].hasAttacked&&t[i].canAttack())){e=!1;break}e&&!TweenMax.isTweening(this._endTurnButton.scale)?TweenMax.to(this._endTurnButton.scale,.5,{x:1.1*this._endTurnButton.scale.x,y:1.1*this._endTurnButton.scale.y,ease:Sine.easeInOut,yoyo:!0,repeat:-1}):!e&&TweenMax.isTweening(this._endTurnButton.scale)&&(TweenMax.killTweensOf(this._endTurnButton.scale),this._endTurnButton.scale=new PIXI.Point(1,1)),this._undoButton.interactive&&null==a.game.movementToUndo?(this._undoButton.interactive=!1,TweenMax.to(this._undoButton,.15,{x:this._undoButton.x-50,ease:Sine.easeOut}),TweenMax.to(this._undoButton,.15,{alpha:0,ease:Sine.easeInOut})):this._undoButton.interactive||null==a.game.movementToUndo||(this._undoButton.interactive=!0,TweenMax.to(this._undoButton,.15,{x:this._undoButton.x+50,ease:Sine.easeOut}),TweenMax.to(this._undoButton,.15,{alpha:1,ease:Sine.easeInOut})),this._playerCharAttributes.specialAbility.updatePS()},n.prototype.reset=function(){this._playerCharAttributes.visible=!1,this._enemyCharAttributes.visible=!1,this._endTurnButton.x=.5*a.STAGE_WIDTH,this._endTurnButton.alpha=1,this._enemyTurnText.x=.5*a.STAGE_WIDTH-350,this._enemyTurnText.alpha=0,this._undoButton.x=.5*a.STAGE_WIDTH-450-40,this._undoButton.alpha=0},n.prototype.setLockAtAttackRange=function(){this._lockAnimParams.width=2e3,this._lockAnimParams.x=.5*a.STAGE_WIDTH-.5*this._lockAnimParams.width,this._lockAnimParams.y=.5*a.STAGE_HEIGHT-.5*this._lockAnimParams.width,TweenMax.to(this._lockAnimParams,1,{x:.5*a.STAGE_WIDTH-30-272,y:.5*a.STAGE_HEIGHT-30+310,width:60,ease:Sine.easeOut,onUpdate:this._updateLock,onUpdateScope:this,onComplete:function(){TweenMax.to(this._lockAnimParams,.25,{x:.5*a.STAGE_WIDTH-30-272-5,y:.5*a.STAGE_HEIGHT-30+310-5,width:70,repeat:-1,yoyo:!0,ease:Sine.easeInOut,onUpdate:this._updateLock,onUpdateScope:this})},onCompleteScope:this})},n.prototype._updateLock=function(){this._graphics.clear(),this._graphics.lineStyle(10,16776960,1),this._graphics.drawRect(this._lockAnimParams.x,this._lockAnimParams.y,this._lockAnimParams.width,this._lockAnimParams.width)},n.prototype._onEndTurnButton_Click=function(t){if(!a.game.isBusy()){var e=!1,i=!0,n=!1,s=void 0;try{for(var r,o=a.game.grid.playerChars[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){var h=r.value;if(h.currentHealth>0&&!h.isOutOfActions()){e=!0;break}}}catch(t){n=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}!e||e&&this._isEndTurnWarning?(TweenMax.to(this._endTurnButton,.25,{alpha:0,x:this._endTurnButton.x-50,ease:Sine.easeInOut}),TweenMax.to(this._enemyTurnText,.25,{alpha:1,x:this._enemyTurnText.x+50,ease:Sine.easeInOut}),a.game.events.push(new l(l.TYPE_END_TURN,null)),a.audio.playSound("sfx_btn_endmove_0"+a.randomIntFromInterval(0,3).toString()),TweenMax.killTweensOf(this._endTurnWarningContainer),this._endTurnWarningContainer.alpha=0):(this._isEndTurnWarning=!0,TweenMax.killTweensOf(this._endTurnWarningContainer.scale),TweenMax.killTweensOf(this._endTurnWarningContainer),this._endTurnWarningContainer.scale=new PIXI.Point,this._endTurnWarningContainer.alpha=1,TweenMax.to(this._endTurnWarningContainer.scale,.25,{x:1,y:1,ease:Back.easeOut,onComplete:function(){TweenMax.to(this._endTurnWarningContainer,3,{alpha:0,ease:Sine.easeIn})},onCompleteScope:this}))}},n.prototype._onUndoButton_Click=function(t){a.game.isBusy()||a.game.events.push(new l(l.TYPE_UNDO_LAST_MOVEMENT,null))},n.prototype.onPlayerTurnEnd=function(){TweenMax.killTweensOf(this._endTurnButton.scale),this._endTurnButton.scale=new PIXI.Point(1,1),this._isEndTurnWarning=!1},n.prototype.onPlayerTurnStart=function(){TweenMax.killTweensOf(this._endTurnButton),TweenMax.killTweensOf(this._enemyTurnText),this._endTurnButton.alpha=0,this._endTurnButton.x=.5*a.STAGE_WIDTH-50,this._enemyTurnText.alpha=1,this._enemyTurnText.x=.5*a.STAGE_WIDTH-350,TweenMax.to(this._endTurnButton,.25,{alpha:1,x:this._endTurnButton.x+50,ease:Sine.easeInOut}),TweenMax.to(this._enemyTurnText,.25,{alpha:0,x:this._enemyTurnText.x-50,ease:Sine.easeInOut})},Object.defineProperty(n.prototype,"playerCharacterStats",{get:function(){return this._playerCharacterStats}}),Object.defineProperty(n.prototype,"enemyCharacterStats",{get:function(){return this._enemyCharacterStats}}),Object.defineProperty(n.prototype,"playerCharAttributes",{get:function(){return this._playerCharAttributes}}),Object.defineProperty(n.prototype,"enemyCharAttributes",{get:function(){return this._enemyCharAttributes}}),Object.defineProperty(n.prototype,"endTurnButton",{get:function(){return this._endTurnButton}}),Object.defineProperty(n.prototype,"undoButton",{get:function(){return this._undoButton}}),Object.defineProperty(n.prototype,"essenceGuideSprite",{get:function(){return this._essenceGuideSprite}}),Object.defineProperty(n.prototype,"lock",{get:function(){return this._lock}}),Object.defineProperty(n.prototype,"isEndTurnWarning",{set:function(t){this._isEndTurnWarning=t}})},{"../../Common":6,"../../CommonGame":7,"../GameEvent":11,"../MyGame":14,"../world/MyGrid":33,"../world/Tile":38,"./UICharacterAttributes":21,"./UILock":24,"./UIPlayerCharAttributes":26}],21:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._charSprite=null,this._nameBgSprite=null,this._teamBgSprite=null,this._damageSprite=null,this._attackRangeSprite=null,this._uiSpecialAbility=null,this._uiConditionList=null,this._nameText=null,this._damageText=null,this._attackRangeText=null,this._teamText=null,this._character=null,this._orientation=1}var a=t("../../Common"),s=t("../../CommonGame"),r=t("./UISpecialAbility"),o=t("./UIConditionList");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._nameBgSprite=new PIXI.Sprite(a.blankTexture),this._nameBgSprite.anchor=new PIXI.Point(.5,.5),this._nameBgSprite.position=new PIXI.Point(-23*this._orientation,(-97)),this._orientation==-1&&(this._nameBgSprite.scale.x=-1),this.addChild(this._nameBgSprite),this._teamBgSprite=new PIXI.Sprite(a.blankTexture),this._teamBgSprite.anchor=new PIXI.Point(.5,.5),this._teamBgSprite.position=new PIXI.Point(0,(-40)),this._orientation==-1&&(this._teamBgSprite.scale.x=-1),this.addChild(this._teamBgSprite),this._charSprite=new PIXI.Sprite(a.blankTexture),this._charSprite.anchor=new PIXI.Point(.5,1),this._charSprite.width=150,this._charSprite.height=300,this._charSprite.tint=16777215,this._charSprite.position=new PIXI.Point(1==this._orientation?-180:180,50),this.addChild(this._charSprite),this._nameText=new PIXI.extras.BitmapText("aaa",{font:"36px ed_50",align:"center"}),this._nameText.anchor=new PIXI.Point(1==this._orientation?0:1,.5),this._nameText.position=new PIXI.Point(-90*this._orientation,this._nameBgSprite.y-2),this.addChild(this._nameText),this._damageSprite=new PIXI.Sprite(a.assets.getTexture("stats_attack")),this._damageSprite.anchor=new PIXI.Point(.5,.5),this._damageSprite.position=new PIXI.Point(this._teamBgSprite.position.x-70*this._orientation,this._teamBgSprite.position.y+2),this._damageSprite.scale.x=this._orientation,this.addChild(this._damageSprite),this._damageText=new PIXI.extras.BitmapText("aaa",{font:"30px ed_30",align:"center"}),this._damageText.anchor=new PIXI.Point(.5,.5),this._damageText.position=new PIXI.Point(this._damageSprite.position.x+5*this._orientation,this._damageSprite.position.y-5),this.addChild(this._damageText),this._attackRangeSprite=new PIXI.Sprite(a.assets.getTexture("stats_range")),this._attackRangeSprite.anchor=new PIXI.Point(.5,.5),this._attackRangeSprite.position=new PIXI.Point(this._damageSprite.position.x+(.5*(this._damageSprite.width+this._attackRangeSprite.width)-3)*this._orientation,this._teamBgSprite.position.y+3),this._attackRangeSprite.scale.x=this._orientation,this.addChild(this._attackRangeSprite),this._attackRangeText=new PIXI.extras.BitmapText("aaa",{font:"30px ed_30",align:"center"}),this._attackRangeText.anchor=new PIXI.Point(.5,.5),this._attackRangeText.position=new PIXI.Point(this._attackRangeSprite.position.x+8*this._orientation,this._attackRangeSprite.position.y-5),this.addChild(this._attackRangeText),this._uiSpecialAbility=new r,this._uiSpecialAbility.anchor=new PIXI.Point(.5,.5),this._uiSpecialAbility.init(),this.addChild(this._uiSpecialAbility),this._uiSpecialAbility.position=new PIXI.Point(this._attackRangeSprite.position.x+(.5*(this._attackRangeSprite.width+this._uiSpecialAbility.width)+10)*this._orientation,this._teamBgSprite.position.y-2),this._teamText=new PIXI.extras.BitmapText("aaa",{font:"30px ed_30",align:"center"}),this._teamText.position=new PIXI.Point(-90*this._orientation,15),this._teamText.anchor=new PIXI.Point(1==this._orientation?0:1,.5),this.addChild(this._teamText),this._uiConditionList=new o,this._uiConditionList.anchor=new PIXI.Point(.5,.5),
this._uiConditionList.x=1==this._orientation?-200:200,this._uiConditionList.y=-200,this._uiConditionList.orientation=this._orientation,this.addChild(this._uiConditionList)},n.prototype.setCharacter=function(t){null!=this._character&&this._character.signals.onDamageTaken.remove(this._onCharacterTookDamage,this),this._character=t,this._character.signals.onDamageTaken.add(this._onCharacterTookDamage,this);var e=t.getCharInfo();switch(this._nameText.text=e.name,this.updateStats(t,!1),this._uiSpecialAbility.specialAbility=t.specialAbility,this._uiSpecialAbility.update(),this._teamBgSprite.texture=a.assets.getTexture("panel_"+(1==this._orientation?"lakewood":"boxmore")),this._character.essenceType){case s.ESSENCE_ID_STRENGTH:this._nameBgSprite.texture=a.assets.getTexture("panel_orange");break;case s.ESSENCE_ID_INTELLIGENCE:this._nameBgSprite.texture=a.assets.getTexture("panel_green");break;case s.ESSENCE_ID_AGILITY:this._nameBgSprite.texture=a.assets.getTexture("panel_blue")}this._nameBgSprite.width=this._nameBgSprite.texture.width,this._nameBgSprite.height=this._nameBgSprite.texture.height;var i=a.assets.getTexture("stats_"+e.spritePrefix);null!=i&&(this._charSprite.width=i.width,this._charSprite.height=i.height,this._charSprite.texture=i,this._charSprite.position.x=1==this._orientation?-230:230,this._charSprite.alpha=0,TweenMax.to(this._charSprite.position,.15,{x:this._charSprite.position.x+(1==this._orientation?50:-50),ease:Sine.easeOut}),TweenMax.to(this._charSprite,.15,{alpha:1,ease:Sine.easeInOut})),this._uiConditionList.conditions=t.conditions,this._uiConditionList.update();var n=a.assets.getJSON("languages")[1==this._orientation?"TEAM_LAKEWOOD":"TEAM_BOX_MORE"][a.language];this._teamText.text=n,this._teamText.tint=this._orientation==-1?16680996:15759100},n.prototype.updateStats=function(t,e){this._damageText.text=t.currentDamage.toString(),t.currentDamage>t.damage?(this._damageText.tint=65280,e&&TweenMax.to(this._damageText.scale,.125,{x:1.25,y:1.25,ease:Sine.easeInOut,repeat:1,yoyo:!0})):this._damageText.tint=16777215,this._attackRangeText.text=t.currentAttackRange.toString(),t.currentAttackRange>t.attackRange?(this._attackRangeText.tint=65280,e&&TweenMax.to(this._attackRangeText.scale,.125,{x:1.25,y:1.25,ease:Sine.easeInOut,repeat:1,yoyo:!0})):this._attackRangeText.tint=16777215},n.prototype._getConditionsStr=function(t){var e="[ ",i=["SHD","DD","DS"],n=!0,a=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var h=r.value;e+=i[h.type],h!=t[t.length-1]&&(e+=", ")}}catch(t){a=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}return e+=" ]"},n.prototype._onCharacterTookDamage=function(t){0==t.currentHealth&&(this.visible=!1,this._character.signals.onDamageTaken.remove(this._onCharacterTookDamage,this),this._character=null)},Object.defineProperty(n.prototype,"orientation",{set:function(t){this._orientation=t}}),Object.defineProperty(n.prototype,"specialAbility",{get:function(){return this._uiSpecialAbility}}),Object.defineProperty(n.prototype,"conditionList",{get:function(){return this._uiConditionList}})},{"../../Common":6,"../../CommonGame":7,"./UIConditionList":23,"./UISpecialAbility":28}],22:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._orientation=1,this._condition=null,this._panelSprite=null}t("../../Common"),t("../../CommonGame"),t("../../ui/UISAbilityIcon");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){console.assert(null!=this._condition,{message:"this._condition is null"})},Object.defineProperty(n.prototype,"orientation",{set:function(t){this._orientation=t}}),Object.defineProperty(n.prototype,"condition",{set:function(t){this._condition=t}})},{"../../Common":6,"../../CommonGame":7,"../../ui/UISAbilityIcon":56}],23:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._arrConditionTemp=[],this._arrCondition=[],this._orientation=1,this.ITEM_MARGIN=70}var a=(t("../../Common"),t("../../CommonGame")),s=t("./UIPickUpCondItem"),r=t("./UISAbilityCondItem");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.update=function(){this.removeChildren();var t=0,e=!0,i=!1,n=void 0;try{for(var o,h=this._arrCondition[Symbol.iterator]();!(e=(o=h.next()).done);e=!0){var _=o.value,l=null;_.type==a.COND_ID_DOUBLE_DAMAGE||_.type==a.COND_ID_DOUBLE_SPEED||_.type==a.COND_ID_EXTRA_ATTACK_RANGE?l=new s:_.type!=a.COND_ID_EXTRA_ATTACK&&_.type!=a.COND_ID_EXTRA_MOVE&&_.type!=a.COND_ID_SPLASH_DAMAGE||(l=new r),l.anchor=new PIXI.Point(.5,.5),l.y=-t*this.ITEM_MARGIN,l.condition=_,l.orientation=this._orientation,l.init(),this.addChild(l),t>=this._arrConditionTemp.length?(l.alpha=0,l.x=-50,TweenMax.to(l,.15,{alpha:1,ease:Sine.easeInOut}),TweenMax.to(l,.15,{x:0,ease:Sine.easeInOut})):t<this._arrConditionTemp.length&&_.duration>this._arrConditionTemp[t].duration&&TweenMax.to(l.scale,.15,{x:1.25,y:1.25,ease:Sine.easeInOut,yoyo:!0,repeat:1}),++t}}catch(t){i=!0,n=t}finally{try{!e&&h.return&&h.return()}finally{if(i)throw n}}this._arrConditionTemp=[];var c=!0,p=!1,u=void 0;try{for(var d,I=this._arrCondition[Symbol.iterator]();!(c=(d=I.next()).done);c=!0){var _=d.value;this._arrConditionTemp.push({type:_.type,duration:_.duration})}}catch(t){p=!0,u=t}finally{try{!c&&I.return&&I.return()}finally{if(p)throw u}}},Object.defineProperty(n.prototype,"conditions",{set:function(t){this._arrCondition=t,this._arrConditionTemp=this._arrCondition}}),Object.defineProperty(n.prototype,"orientation",{set:function(t){this._orientation=t}})},{"../../Common":6,"../../CommonGame":7,"./UIPickUpCondItem":25,"./UISAbilityCondItem":27}],24:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._graphics=null,this._animParams={}}var a=t("../../Common");t("../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._graphics=new PIXI.Graphics,this.addChild(this._graphics)},n.prototype.clear=function(){TweenMax.killTweensOf(this._animParams),this._graphics.clear()},n.prototype.targetStats=function(){var t=260,e=70;this._animParams.width=a.STAGE_MIN_WIDTH,this._animParams.height=a.STAGE_HEIGHT,this._animParams.x=0,this._animParams.y=0,TweenMax.to(this._animParams,1,{x:.5*a.STAGE_WIDTH-.5*t-250,y:.5*a.STAGE_HEIGHT-.5*e+310,width:t,height:e,ease:Sine.easeOut,onUpdate:this._updateUILock,onUpdateScope:this,onComplete:function(){TweenMax.to(this._animParams,.25,{x:this._animParams.x-5,y:this._animParams.y-5,width:t+10,height:e+10,repeat:-1,yoyo:!0,ease:Sine.easeInOut,onUpdate:this._updateUILock,onUpdateScope:this})},onCompleteScope:this})},n.prototype.targetEssenceBar=function(){var t=243,e=54;this._animParams.width=a.STAGE_MIN_WIDTH,this._animParams.height=a.STAGE_HEIGHT,this._animParams.x=0,this._animParams.y=0,TweenMax.to(this._animParams,1,{x:.5*a.STAGE_WIDTH-.5*t-283,y:.5*a.STAGE_HEIGHT-.5*e+253,width:t,height:e,ease:Sine.easeOut,onUpdate:this._updateUILock,onUpdateScope:this,onComplete:function(){TweenMax.to(this._animParams,.25,{x:this._animParams.x-5,y:this._animParams.y-5,width:t+10,height:e+10,repeat:-1,yoyo:!0,ease:Sine.easeInOut,onUpdate:this._updateUILock,onUpdateScope:this})},onCompleteScope:this})},n.prototype.targetAttackRange=function(){var t=70,e=t;this._animParams.width=a.STAGE_MIN_WIDTH,this._animParams.height=a.STAGE_HEIGHT,this._animParams.x=0,this._animParams.y=0,TweenMax.to(this._animParams,1,{x:.5*a.STAGE_WIDTH-.5*t-272,y:.5*a.STAGE_HEIGHT-.5*t+310,width:t,height:t,ease:Sine.easeOut,onUpdate:this._updateUILock,onUpdateScope:this,onComplete:function(){TweenMax.to(this._animParams,.25,{x:this._animParams.x-5,y:this._animParams.y-5,width:t+10,height:e+10,repeat:-1,yoyo:!0,ease:Sine.easeInOut,onUpdate:this._updateUILock,onUpdateScope:this})},onCompleteScope:this})},n.prototype._updateUILock=function(){this._graphics.clear(),this._graphics.lineStyle(10,16776960,1),this._graphics.drawRect(this._animParams.x,this._animParams.y,this._animParams.width,this._animParams.height)}},{"../../Common":6,"../../CommonGame":7}],25:[function(t,e,i){"use strict";function n(){r.call(this),this._panelText=null,this._panelStatSprite=null,this._iconSprite=null,this._counterSprite=null,this._counterText=null}var a=t("../../Common"),s=t("../../CommonGame"),r=t("./UIConditionItem");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(){r.prototype.init.call(this),this._panelSprite=new PIXI.Sprite(a.assets.getTexture(this._getBgSpriteId())),this._panelSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._panelSprite),this._panelStatSprite=new PIXI.Sprite(a.assets.getTexture(this._getStatId())),this._panelStatSprite.y=-75,this._panelStatSprite.x=23,this._panelStatSprite.anchor=new PIXI.Point(1,.5),this.addChild(this._panelStatSprite),this._panelText=new PIXI.extras.BitmapText("x2",{font:"30px ed_30",align:"center"}),this._panelText.y=-3,this._panelText.x=-2,this._panelText.anchor=new PIXI.Point(0,.5),this.addChild(this._panelText),this._iconSprite=new PIXI.Sprite(a.assets.getTexture(this._getIconSpriteId())),this._iconSprite.anchor=new PIXI.Point(.5,.5),this._iconSprite.x=.5*-this._panelSprite.width-20,this._orientation==-1&&(this._iconSprite.scale.x=-1,this._iconSprite.x*=-1),this._iconSprite.y-=.25*this._panelSprite.height,this.addChild(this._iconSprite),this._counterSprite=new PIXI.Sprite(a.assets.getTexture("stats_pickup_counter")),this._counterSprite.anchor=new PIXI.Point(.5,.5),this._counterSprite.x=this._iconSprite.x,this._counterSprite.y+=.25*this._panelSprite.height,this.addChild(this._counterSprite),this._counterText=new PIXI.extras.BitmapText(this._condition.duration.toString(),{font:"24px ed_24",align:"center"}),this._counterText.anchor=new PIXI.Point(.5,.5),this._counterText.position=new PIXI.Point(this._counterSprite.position.x,this._counterSprite.position.y),this.addChild(this._counterText)},n.prototype._getIconSpriteId=function(){var t="";switch(this._condition.type){case s.COND_ID_DOUBLE_DAMAGE:t="stats_pickup_attack";break;case s.COND_ID_DOUBLE_SPEED:t="stats_pickup_movement";break;case s.COND_ID_EXTRA_ATTACK_RANGE:t="stats_pickup_range"}return t},n.prototype._getBgSpriteId=function(){var t="";switch(this._condition.type){case s.COND_ID_DOUBLE_DAMAGE:case s.COND_ID_EXTRA_ATTACK_RANGE:t="stats_pickup_red";break;case s.COND_ID_DOUBLE_SPEED:t="stats_pickup_green"}return t},n.prototype._getStatId=function(){var t="pickup_icon_";switch(this._condition.type){case s.COND_ID_DOUBLE_DAMAGE:t+="attack";break;case s.COND_ID_DOUBLE_SPEED:t+="movement";break;case s.COND_ID_EXTRA_ATTACK_RANGE:t+="range"}return t}},{"../../Common":6,"../../CommonGame":7,"./UIConditionItem":22}],26:[function(t,e,i){"use strict";function n(){s.call(this)}var a=t("../../Common"),s=t("./UICharacterAttributes");e.exports=n,n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.init=function(){s.prototype.init.call(this),this._uiSpecialAbility.signals.onSpecialAbilityUsed.add(this._onSpecialAbility_Click,this)},n.prototype._onSpecialAbility_Click=function(){a.game.movementToUndo=null,a.game.hud.isEndTurnWarning=!1,this._character.specialAbility.activate()}},{"../../Common":6,"./UICharacterAttributes":21}],27:[function(t,e,i){"use strict";function n(){o.call(this),this._uiSAbilityIcon=null}var a=t("../../Common"),s=t("../../CommonGame"),r=t("../../ui/UISAbilityIcon"),o=t("./UIConditionItem");e.exports=n,n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.init=function(){o.prototype.init.call(this),this._panelSprite=new PIXI.Sprite(a.assets.getTexture("stats_pickup_blue")),this._panelSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._panelSprite);var t=null;switch(this._condition.type){case s.COND_ID_EXTRA_ATTACK:t=s.SA_ID_EXTRA_ATTACK;break;case s.COND_ID_SPLASH_DAMAGE:t=s.SA_ID_SPLASH_DAMAGE;break;case s.COND_ID_EXTRA_MOVE:t=s.SA_ID_EXTRA_MOVE}this._uiSAbilityIcon=new r,this._uiSAbilityIcon.reinit(t),this._uiSAbilityIcon.anchor=new PIXI.Point(.5,.5),this.addChild(this._uiSAbilityIcon)}},{"../../Common":6,"../../CommonGame":7,"../../ui/UISAbilityIcon":56,"./UIConditionItem":22}],28:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._progressContainer=null,this._specialAbility=null,this._specialAbilityIcon=null,this._starPS=null,this.signals={},this.signals.onSpecialAbilityUsed=new signals.Signal}var a=t("../../Common"),s=t("../../ui/UISAbilityIcon");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("stats_special")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.interactive=!0,this._bgSprite.click=this._bgSprite.tap=this._onClick.bind(this),this.addChild(this._bgSprite),this._specialAbilityIcon=new s,this._specialAbilityIcon.anchor=new PIXI.Point(.5,.5),this._bgSprite.addChild(this._specialAbilityIcon),this._progressContainer=new PIXI.Container,this._bgSprite.addChild(this._progressContainer);for(var t=0;t<3;++t){var e=new PIXI.Sprite(a.assets.getTexture("stats_special_counter_empty-copy"));e.anchor=new PIXI.Point(.5,.5),e.y=27,this._progressContainer.addChild(e)}this._starPS=new PIXI.particles.Emitter(this,[a.assets.getTexture("star_small"),a.assets.getTexture("star_large")],a.assets.getJSON("game_stats_special")),this._starPS.emit=!1},n.prototype.update=function(){console.assert(null!=this._specialAbility,{message:"this._specialAbility is null"}),this._specialAbilityIcon.reinit(this._specialAbility.type);var t=0,e=!0,i=!1,n=void 0;try{for(var s,r=this._progressContainer.children[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var o=s.value;o.visible=t<this._specialAbility.rechargeTime,o.texture=a.assets.getTexture(t>=this._specialAbility.rechargeTime-this._specialAbility.rechargeCounter?"stats_special_counter_empty-copy":"stats_special_counter_full-copy"),++t}}catch(t){i=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw n}}for(var h=-(this._specialAbility.rechargeTime-1)*(this._progressContainer.children[0].width+3)*.5,t=0;t<this._specialAbility.rechargeTime;++t)this._progressContainer.children[t].x=h,h+=3+this._progressContainer.children[0].width;this._bgSprite.texture=a.assets.getTexture(this._specialAbility.isReady()?"stats_special":"stats_special_off"),this._specialAbilityIcon.y=this._specialAbility.isReady()?-3:0,this._specialAbility.isReady()&&!this._starPS.emit?this._starPS.emit=!0:!this._specialAbility.isReady()&&this._starPS.emit&&(TweenMax.killTweensOf(this._bgSprite.scale),this._starPS.emit=!1,this._bgSprite.scale=new PIXI.Point(1,1))},n.prototype.updatePS=function(){this._starPS.update(p3.Timestep.deltaTime)},n.prototype._onClick=function(){this._specialAbility.isReady()&&(this.signals.onSpecialAbilityUsed.dispatch(),this.update())},Object.defineProperty(n.prototype,"specialAbility",{set:function(t){this._specialAbility=t}}),Object.defineProperty(n.prototype,"width",{get:function(){return this._bgSprite.width}})},{"../../Common":6,"../../ui/UISAbilityIcon":56}],29:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this.SIDE_LENGTH=56,this.TILE_SPRITE_ID={attackCharacter:"",attackRange:"",movement:"",selected:""},this._id=-1,this._speed=0,this._health=0,this._damage=0,this._attackRange=0,this._essenceType=s.ESSENCE_ID_STRENGTH,this._curHealth=0,this._baseTopSprite=null,this._baseBotSprite=null,this._sprite=null,this._tile=null,this._healthBar=null,this._damageText=null,this._arrCondition=[],this._specialAbility=null,this._arrHotTile=[],this._walkAudio=null,this._walkSoundId="",this._charInfo=null,this._tint=null,this._isMoving=!1,this._hasMoved=!1,this._hasAttacked=!1,this._starPS=null,this._starPsContainer=null,this._actionLog=[],this.signals={},this.signals.onDamageTaken=new signals.Signal,this.signals.onRemoved=new signals.Signal,this.signals.onMoved=new signals.Signal}var a=t("../../Common"),s=t("../../CommonGame"),r=t("../../GrayScaleFilter"),o=(t("./Tile"),t("./MyGrid"),t("../MyGame"),t("./PickUp")),h=t("./HealthBar");t("./SpecialAbility");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(t){this._id=t.id,this._loadStats(t),this._baseBotSprite.anchor=new PIXI.Point(.5,1),this.addChild(this._baseBotSprite),this._baseTopSprite=new PIXI.Sprite(a.assets.getTexture("base_top_"+s.getEssenceColorId(this._essenceType))),this._baseTopSprite.anchor=new PIXI.Point(.5,1),this._baseBotSprite.addChild(this._baseTopSprite),this._sprite=new PIXI.Sprite(a.assets.getTexture("char_"+t.spritePrefix)),this._sprite.texture.mipmap=!1,this._sprite.anchor=new PIXI.Point(.5,1),this._sprite.scale=new PIXI.Point(.5,.5),this._sprite.y-=37,this._baseTopSprite.addChild(this._sprite),TweenMax.to(this._sprite.scale,.5,{x:.49,y:.49,ease:Sine.easeOut,yoyo:!0,repeat:-1,delay:.5*Math.random()}),this._curHealth=this._health,this._damageText=new PIXI.Text(this._damage,{font:"20px Arial",align:"center",fill:"#000000",stroke:"#ffffff",strokeThickness:3}),this._damageText.anchor=new PIXI.Point(.5,.5),this._damageText.position=new PIXI.Point(.5*this.SIDE_LENGTH-.5*this._damageText.width,.5*-this.SIDE_LENGTH),this._damageText.visible=!1,this.addChild(this._damageText),this._healthBar=new h,this._healthBar.maxHealth=this._health,this._healthBar.init(),this._healthBar.y-=15,this.addChild(this._healthBar),this._starPsContainer=new PIXI.Container,this._starPsContainer.x=-30,this._starPsContainer.y=-130,this.addChild(this._starPsContainer),this._starPS=new PIXI.particles.Emitter(this._starPsContainer,[a.assets.getTexture("star_small"),a.assets.getTexture("star_large")],a.assets.getJSON("game_char_special")),this._starPS.emit=!1},n.prototype.update=function(){},n.prototype.updatePS=function(){this._starPS.update(p3.Timestep.deltaTime),this._curHealth>0&&(this._specialAbility.isReady()&&!this._starPS.emit?this._starPS.emit=!0:!this._specialAbility.isReady()&&this._starPS.emit&&(this._starPS.emit=!1))},n.prototype.moveTo=function(t){var e=new Graph(a.game.grid.createPfGrid(this._tile.col,this._tile.row)),i=e.grid[this._tile.row][this._tile.col],n=e.grid[t.row][t.col],r=astar.search(e,i,n),o=[];if(r.length>0){this._isMoving=!0;for(var h=new PIXI.Point(r[0].y-this._tile.col,r[0].x-this._tile.row),_=0;_<r.length-1;++_){var l=new PIXI.Point(r[_+1].y-r[_].y,r[_+1].x-r[_].x);l.x==h.x&&l.y==h.y||(o.push(new PIXI.Point(r[_].y,r[_].x)),h=l)}o.push(new PIXI.Point(r[r.length-1].y,r[r.length-1].x)),a.game.timeline.clear();for(var c=this._tile,_=0;_<o.length;++_){var p=a.game.grid.tiles[o[_].y][o[_].x],u=Math.abs(c.col-p.col+c.row-p.row);c=p;var d=a.game.timeline.to(this.position,.25*u,{x:p.position.x,y:p.position.y+a.game.grid.CHARACTER_TILE_Y_OFFSET,ease:Linear.easeInOut,onUpdate:this._onMoveToUpdate,onUpdateScope:this});_==o.length-1&&(d.vars.onComplete=this._onMoveToCompleted,d.vars.onCompleteScope=this,d.vars.onCompleteParams=[p],d.vars.onUpdate=this._onMoveToUpdate,d.vars.onUpdateScope=this)}this._walkAudio=a.audio.playSound(this._walkSoundId,{loop:!0}),this._actionLog.indexOf("move")!=-1&&this.hasCondition(s.COND_ID_EXTRA_MOVE)&&(this.removeCondition(s.COND_ID_EXTRA_MOVE),a.game.hud.playerCharAttributes.conditionList.update()),this._hasMoved=!0}},n.prototype.attackSpecialAbility=function(t){if(this.hasCondition(s.COND_ID_SPLASH_DAMAGE)){this.removeCondition(s.COND_ID_SPLASH_DAMAGE),a.game.hud.playerCharAttributes.conditionList.update();var e=a.game.grid.findFriendlyChars(t,s.SPLASH_DAMAGE_RANGE),i=!0,n=!1,r=void 0;try{for(var o,h=e[Symbol.iterator]();!(i=(o=h.next()).done);i=!0){var _=o.value,l=_.character,c=this.currentDamage*s.SPLASH_DAMAGE_FACTOR;c<0&&(c=0),c>=l.currentHealth?l.currentHealth=0:l.currentHealth-=c,TweenMax.to(l.scale,.2,{x:1.1,y:1.1,repeat:1,yoyo:!0,ease:Sine.easeInOut,onComplete:function(t){t.onDamageTaken(this)},onCompleteScope:this,onCompleteParams:[l]});var p=new PIXI.Sprite(a.assets.getTexture("attack_"+s.getEssenceColorId(l.essenceType)+"_burst3")),u=.2*Math.random();p.anchor=new PIXI.Point(.5,.5),p.scale=new PIXI.Point,p.x=l.x,p.y=l.y-100,TweenMax.to(p.scale,.2,{x:.5-u,y:.5-u,ease:Back.easeOut,onComplete:function(){TweenMax.to(this,.2,{alpha:0,onComplete:function(){a.game.grid.removeChild(this)},onCompleteScope:this})},onCompleteScope:p}),a.game.grid.addChild(p);var d=new PIXI.extras.BitmapText("-"+c.toString(),{font:"30px ed_30",align:"center"});d.tint=16777215,d.anchor=new PIXI.Point(.5,.5),d.x=l.x,d.y=l.y-100,TweenMax.to(d,1,{y:d.y-25,onComplete:function(){a.game.grid.removeChild(this)},onCompleteScope:d}),a.game.grid.addChild(d)}}catch(t){n=!0,r=t}finally{try{!i&&h.return&&h.return()}finally{if(n)throw r}}if(e.length>0){var I=["sfx_hit_metal_00","sfx_player_bighit_onrobot_00"],T=["sfx_player_hit_00","sfx_player_hit_crush_00","sfx_player_hit_poke_three_00","sfx_player_hit_smash_00"];(this._tint=65280)?a.audio.playSound(T[a.randomIntFromInterval(0,T.length-1)]):(this._tint=16711680)&&a.audio.playSound(I[a.randomIntFromInterval(0,I.length-1)])}}},n.prototype.refresh=function(){this._actionLog=[],this._hasMoved=!1,this._hasAttacked=!1;for(var t=this._arrCondition.length-1;t>=0;--t)this._arrCondition[t].duration>=0&&(this._arrCondition[t].duration-=1,this._arrCondition[t].duration<=0&&this._arrCondition.splice(t,1));null!=this._specialAbility&&this._specialAbility.refresh(),this._arrHotTile=a.game.grid.findHotTiles(this)},n.prototype.heal=function(t){this._curHealth+=t,this._curHealth>this._health&&(this._curHealth=this._health),this._healthBar.setHealth(this._curHealth);var e=new PIXI.extras.BitmapText("+"+t.toString(),{font:"30px ed_30",align:"center"});e.tint=this._tint,e.anchor=new PIXI.Point(.5,.5),e.x=this.x,e.y=this.y-100,TweenMax.to(e,1,{y:e.y-25,onComplete:function(){a.game.grid.removeChild(this)},onCompleteScope:e}),a.game.grid.addChild(e)},n.prototype.findEssenceBonus=function(t){var e=this._essenceType==s.ESSENCE_ID_STRENGTH&&t==s.ESSENCE_ID_INTELLIGENCE||this._essenceType==s.ESSENCE_ID_INTELLIGENCE&&t==s.ESSENCE_ID_AGILITY||this._essenceType==s.ESSENCE_ID_AGILITY&&t==s.ESSENCE_ID_STRENGTH;return e?s.ESSENCE_BONUS_DAMAGE:0},n.prototype.addCondition=function(t,e){var i=!1,n=!0,a=!1,s=void 0;try{for(var r,o=this._arrCondition[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var h=r.value;if(h.type==t){h.duration=e,i=!0;break}}}catch(t){a=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}i||this._arrCondition.push({type:t,duration:e})},n.prototype.hasCondition=function(t){var e=!1,i=!0,n=!1,a=void 0;try{for(var s,r=this._arrCondition[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var o=s.value;if(o.type==t){e=!0;break}}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}return e},n.prototype.removeCondition=function(t){for(var e=!1,i=0;i<this._arrCondition.length;++i)if(this._arrCondition[i].type==t){this._arrCondition.splice(i,1);break}return e},n.prototype.canMove=function(){var t=!1,e=!0,i=!1,n=void 0;try{for(var a,s=this._arrHotTile[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;if("walk"==r.type){t=!0;break}}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}return t},n.prototype.canAttack=function(){var t=!1,e=!0,i=!1,n=void 0;try{for(var a,s=this._arrHotTile[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;if("target"==r.type){t=!0;break}}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}return t},n.prototype.highlightHotTiles=function(){var t=!0,e=!1,i=void 0;try{for(var n,s=this._arrHotTile[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var r=n.value,o="";"walk"!=r.type||this._hasMoved?this._hasAttacked||("target"==r.type?o=this.TILE_SPRITE_ID.attackCharacter:"attack"==r.type&&(o=this._hasMoved?this.TILE_SPRITE_ID.attackCharacter:this.TILE_SPRITE_ID.attackRange)):o=this.TILE_SPRITE_ID.movement,""!=o&&r.tile.setTexture(a.assets.getTexture(o))}}catch(t){e=!0,i=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw i}}},n.prototype.clearHotTiles=function(){for(var t=0;t<this._arrHotTile.length;++t)"start"!=this._arrHotTile[t].type&&this._arrHotTile[t].tile.clearTexture()},n.prototype.canMoveTo=function(t){var e=!1,i=!0,n=!1,a=void 0;try{for(var s,r=this._arrHotTile[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var o=s.value;if("walk"==o.type&&o.tile==t){e=!0;break}}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}return e},n.prototype.canAttackTo=function(t){var e=!1,i=!0,n=!1,a=void 0;try{for(var s,r=this._arrHotTile[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var o=s.value;if("target"==o.type&&o.tile.content==t){e=!0;break}}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}return e},n.prototype.pause=function(){null!=this._walkAudio&&this._walkAudio.howl.playing(this._walkAudio.id)&&this._walkAudio.howl.pause(this._walkAudio.id)},n.prototype.resume=function(){null!=this._walkAudio&&this._walkAudio.howl.seek(null,this._walkAudio.id)>0&&this._walkAudio.howl.play(this._walkAudio.id)},n.prototype.playDeathAnim=function(t){this._starPS.emit=!1;var e=new PIXI.filters.BlurYFilter;e.blur=0,TweenMax.to(e,.35,{blur:100,ease:Power1.easeOut}),TweenMax.to(this._baseBotSprite,.35,{alpha:0,ease:Sine.easeOut}),TweenMax.to(this._baseBotSprite.scale,.35,{y:5,ease:Power1.easeOut}),TweenMax.to(this._baseBotSprite,.35,{y:this._baseBotSprite.y-50,ease:Power1.easeOut}),TweenMax.to(this._baseBotSprite.scale,.35,{x:0,ease:Power1.easeIn,onComplete:function(){this.parent.removeChild(this)},onCompleteScope:this}),this._baseBotSprite.filters=[e],this._healthBar.visible=!1;var i=5,n=a.game.scene.levelContainer;TweenMax.fromTo(n,.1,{y:n.y-i},{y:n.y+i,ease:RoughEase.ease.config({strength:4,points:10,template:Linear.easeNone,randomize:!1}),onComplete:function(){this.y=0},onCompleteScope:n});var r=!0,o=!1,h=void 0;try{for(var _,l=a.game.grid.decorations[Symbol.iterator]();!(r=(_=l.next()).done);r=!0){var c=_.value;if(c.gid==s.TILED_BUSH_CENTRE_ID||c.gid==s.TILED_BUSH_LEFT_ID||c.gid==s.TILED_BUSH_RIGHT_ID)c.scale.y=.9,TweenMax.to(c.scale,1.5,{ease:Elastic.easeOut.config(3,.1),y:1});else if(c.gid==s.TILED_LAMP_ID){var p=new TimelineMax;p.to(c,.06,{rotation:.025*-Math.PI,ease:Power1.easeOut}),p.to(c,.12,{rotation:.025*Math.PI,ease:Power1.easeInOut}),p.to(c,.12,{rotation:.025*-Math.PI,ease:Power1.easeInOut}),p.to(c,.12,{rotation:.025*Math.PI,ease:Power1.easeInOut}),p.to(c,.12,{rotation:.025*-Math.PI,ease:Power1.easeInOut}),p.to(c,.12,{rotation:0,ease:Sine.easeOut})}}}catch(t){o=!0,h=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw h}}},n.prototype.setOutOfActions=function(t){t?(this._sprite.filters=[new r],this._baseTopSprite.filters=[new r]):(this._sprite.filters=[],this._baseTopSprite.filters=[])},n.prototype.getCharInfo=function(){},n.prototype._loadStats=function(t){},n.prototype._updateText=function(){this._healthText.text=this._curHealth,this._healthText.position=new PIXI.Point(.5*-this.SIDE_LENGTH+.5*this._healthText.width,.5*-this.SIDE_LENGTH+.5*this._healthText.height)},n.prototype._onMoveToCompleted=function(t){var e=t.content;this._tile.content=null,this._tile=t,t.content=this,e instanceof o&&(e.activate(this),a.game.onPickUpActivated(this,e),a.game.grid.removePickUp(e)),null!=this._walkAudio&&(this._walkAudio.howl.stop(this._walkAudio.id),this._walkAudio=null),this._isMoving=!1},n.prototype._onMoveToUpdate=function(){this.signals.onMoved.dispatch(this)},n.prototype.onDamageTaken=function(t){this._healthBar.setHealth(this._curHealth),this.signals.onDamageTaken.dispatch(this)},Object.defineProperty(n.prototype,"id",{get:function(){return this._id}}),Object.defineProperty(n.prototype,"actionLog",{get:function(){return this._actionLog}}),Object.defineProperty(n.prototype,"speed",{get:function(){return this._speed}}),Object.defineProperty(n.prototype,"currentSpeed",{get:function(){var t=this._speed;return this.hasCondition(s.COND_ID_DOUBLE_SPEED)&&(t*=2),t}}),Object.defineProperty(n.prototype,"health",{get:function(){return this._health}}),Object.defineProperty(n.prototype,"currentHealth",{get:function(){return this._curHealth},set:function(t){this._curHealth=t}}),Object.defineProperty(n.prototype,"damage",{get:function(){return this._damage}}),Object.defineProperty(n.prototype,"currentDamage",{get:function(){var t=this._damage;return this.hasCondition(s.COND_ID_DOUBLE_DAMAGE)&&(t*=2),t}}),Object.defineProperty(n.prototype,"essenceType",{get:function(){return this._essenceType}}),Object.defineProperty(n.prototype,"attackRange",{get:function(){return this._attackRange}}),Object.defineProperty(n.prototype,"currentAttackRange",{get:function(){var t=this._attackRange;return this.hasCondition(s.COND_ID_EXTRA_ATTACK_RANGE)&&(t*=2),t}}),Object.defineProperty(n.prototype,"tile",{get:function(){return this._tile},set:function(t){this._tile=t}}),Object.defineProperty(n.prototype,"conditions",{get:function(){return this._arrCondition}}),Object.defineProperty(n.prototype,"specialAbility",{get:function(){return this._specialAbility}}),Object.defineProperty(n.prototype,"sprite",{get:function(){return this._sprite}}),Object.defineProperty(n.prototype,"hotTiles",{get:function(){return this._arrHotTile},set:function(t){this._arrHotTile=t}}),Object.defineProperty(n.prototype,"hasMoved",{get:function(){return this._hasMoved},set:function(t){this._hasMoved=t}}),Object.defineProperty(n.prototype,"hasAttacked",{get:function(){return this._hasAttacked},set:function(t){this._hasAttacked=t}})},{"../../Common":6,"../../CommonGame":7,"../../GrayScaleFilter":8,"../MyGame":14,"./HealthBar":32,"./MyGrid":33,"./PickUp":35,"./SpecialAbility":37,"./Tile":38}],30:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._sprite=null,this._gid=null}var a=t("../../Common"),s=t("../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(t){this._gid=t,this._sprite=new PIXI.Sprite(a.assets.getTexture(s.getDecorationSpriteId(t))),this._sprite.anchor=new PIXI.Point(.5,1),this.addChild(this._sprite)},Object.defineProperty(n.prototype,"gid",{get:function(){return this._gid}})},{"../../Common":6,"../../CommonGame":7}],31:[function(t,e,i){"use strict";function n(){r.call(this),this._targetSprite=null,this._statsIndex=0}var a=t("../../Common"),s=t("../../CommonGame"),r=t("./Character"),o=t("./SpecialAbility");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(t,e){this._statsIndex=e?1:0,this.TILE_SPRITE_ID={attackRange:"grid_opponent_attack_range",attackCharacter:"grid_opponent_attack",movement:"grid_opponent_movement",selected:"grid_opponent_movement_selected"},this._baseBotSprite=new PIXI.Sprite(a.assets.getTexture("char_base_btm_red")),this._tint=16711680,r.prototype.init.call(this,t),this._targetSprite=new PIXI.Sprite(a.blankTexture),this._targetSprite.width=this._targetSprite.height=20,this._targetSprite.tint=16777215,this._targetSprite.anchor=new PIXI.Point(.5,.5),this._targetSprite.visible=!1,this.addChild(this._targetSprite),this._healthBar.setBarColour(16711680),this._walkSoundId="sfx_enemy_robot_move_loop_00"},n.prototype.markAsTarget=function(t){this._targetSprite.visible=t},n.prototype.markTarget=function(t){var e=new PIXI.extras.BitmapText(a.assets.getJSON("languages")["ATTACK!"][a.language].toUpperCase(),{font:"30px ed_30",align:"center"});e.anchor=new PIXI.Point(.5,.5),e.position=new PIXI.Point(this.x,this.y-100),TweenMax.to(e,.25,{x:t.x,y:t.y-100,onComplete:function(t,e){a.game.grid.removeChild(this),a.game.onCombatStarted(t,e)},onCompleteScope:e,onCompleteParams:[this,t]}),a.game.grid.addChild(e)},n.prototype.getCharInfo=function(){return a.assets.getJSON("enemyCharacters").enemyCharacters[this._id]},n.prototype._loadStats=function(t){this._speed=t.speed[this._statsIndex],this._health=t.health[this._statsIndex],
this._damage=t.damage[this._statsIndex],this._attackRange=t.attackRange[this._statsIndex],this._essenceType=s.getEssenceType(t.essence),this._specialAbility=new o,this._specialAbility.owner=this,this._specialAbility.type=s.getSpecialAbilityType(t.specialAbility.type),this._specialAbility.rechargeTime=t.specialAbility.rechargeTime[this._statsIndex],this._specialAbility.signals.onActivated.add(this._onSpecialAbilityActivated,this),this._specialAbility.init()},n.prototype.onDamageTaken=function(t){r.prototype.onDamageTaken.call(this,t),0==this._curHealth&&(a.game.grid.removeEnemyChar(this,t),a.audio.playSound("sfx_enemy_robot_dies_0"+a.randomIntFromInterval(0,2).toString()))},n.prototype._onMoveToCompleted=function(t){r.prototype._onMoveToCompleted.call(this,t),t.clearTexture()},n.prototype._onSpecialAbilityActivated=function(t){t==s.SA_ID_SPLASH_DAMAGE&&this.addCondition(s.COND_ID_SPLASH_DAMAGE,-1)}},{"../../Common":6,"../../CommonGame":7,"./Character":29,"./SpecialAbility":37}],32:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this.BAR_MARGIN=2,this._healthText=null,this._bgSprite=null,this._fgSprite=null,this._barSprite=null,this._maxHealth=0,this._width=66,this._height=10,this.BAR_COLOUR=65280}var a=t("../../Common");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){console.assert(0!=this._maxHealth,{message:"this._maxHealth is 0"}),this._bgSprite=new PIXI.Sprite(a.assets.getTexture("heath_bar_btm")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._bgSprite),this._barSprite=new PIXI.Sprite(a.blankTexture),this._barSprite.anchor=new PIXI.Point(0,.5),this._barSprite.width=this._width-2*this.BAR_MARGIN,this._barSprite.height=this._height-2*this.BAR_MARGIN,this._barSprite.tint=this.BAR_COLOUR,this._barSprite.position.x=.5*-this._width+this.BAR_MARGIN,this.addChild(this._barSprite),this._fgSprite=new PIXI.Sprite(a.assets.getTexture("heath_bar_top")),this._fgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._fgSprite),this._healthText=new PIXI.extras.BitmapText(this._maxHealth.toString()+"/"+this._maxHealth.toString(),{font:"18px ed_50",align:"center"}),this._healthText.anchor=new PIXI.Point(.5,.5),this._healthText.position.y=this._barSprite.height,this.addChild(this._healthText)},n.prototype.setHealth=function(t){this._healthText.text=t.toString()+"/"+this._maxHealth.toString();var e=0;t>0&&(e=this._width*(t/this._maxHealth)-2*this.BAR_MARGIN),TweenMax.to(this._barSprite,.25,{width:e,ease:Sine.easeOut})},n.prototype.setBarColour=function(t){this._barSprite.tint=t},Object.defineProperty(n.prototype,"maxHealth",{set:function(t){this._maxHealth=t}})},{"../../Common":6}],33:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._arrTile=[],this._arrObstacle=[],this._arrPlayerChar=[],this._arrEnemyChar=[],this._arrDecoration=[],this._arrPickUp=[],this._zSortedContainer=null,this.CHARACTER_TILE_Y_OFFSET=40}var a=t("../../Common"),s=t("../../CommonGame"),r=t("./Tile"),o=t("./Character"),h=t("./EnemyCharacter"),_=t("./PlayerCharacter"),l=t("./PickUp"),c=t("../GameEvent");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){for(var t=0;t<s.GRID_ROW_COUNT;++t){this._arrTile.push([]);for(var e=0;e<s.GRID_COL_COUNT;++e){var i=new r;i.col=e,i.row=t,i.init(),i.position.x=e*r.SIDE_LENGTH,i.position.y=t*r.SIDE_LENGTH,this.addChild(i),this._arrTile[t].push(i)}}this._zSortedContainer=new PIXI.Container,this.addChild(this._zSortedContainer)},n.prototype.getPlayerCharCount=function(){var t=0,e=!0,i=!1,n=void 0;try{for(var a,s=this._arrPlayerChar[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;r.currentHealth>0&&++t}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}return t},n.prototype.addObstacle=function(t,e,i){this._arrObstacle.push(t),t.tile=this._arrTile[i][e],t.tile.visible=!1,t.tile.content=t,t.position=new PIXI.Point(t.tile.position.x,t.tile.position.y),this._zSortedContainer.addChild(t)},n.prototype.addPlayerChar=function(t,e,i){this._arrPlayerChar.push(t),t.tile=this._arrTile[i][e],t.tile.content=t,t.position=new PIXI.Point(t.tile.position.x,t.tile.position.y+this.CHARACTER_TILE_Y_OFFSET),this._zSortedContainer.addChild(t)},n.prototype.addDecoration=function(t,e,i){this._arrDecoration.push(t);var n=this._arrTile[i][e];n.decorations.push(t),t.position=new PIXI.Point(n.position.x,n.position.y+this.CHARACTER_TILE_Y_OFFSET),this._zSortedContainer.addChild(t)},n.prototype.addEnemyChar=function(t,e,i){this._arrEnemyChar.push(t),t.tile=this._arrTile[i][e],t.tile.content=t,t.position=new PIXI.Point(t.tile.position.x,t.tile.position.y+this.CHARACTER_TILE_Y_OFFSET),this._zSortedContainer.addChild(t)},n.prototype.createRandomPickUp=function(){var t=new l;t.type=a.randomIntFromInterval(0,s.PICKUP_ID_COUNT-1),t.tile=this._findEmptyTile(),t.anchor=new PIXI.Point(.5,1),t.position=new PIXI.Point(t.tile.position.x,t.tile.position.y+this.CHARACTER_TILE_Y_OFFSET+8),t.init(),t.tile.content=t,this._arrPickUp.push(t),this._zSortedContainer.addChild(t)},n.prototype.createPickUp=function(t,e,i){var n=new l;n.type=i,n.tile=this._arrTile[t][e],n.anchor=new PIXI.Point(.5,1),n.position=new PIXI.Point(n.tile.position.x,n.tile.position.y+this.CHARACTER_TILE_Y_OFFSET+8),n.init(),n.tile.content=n,this._arrPickUp.push(n),this._zSortedContainer.addChild(n)},n.prototype.removePlayerChar=function(t,e){t.sprite.alpha<1&&this.restoreTileVisibility(e.tile),t.playDeathAnim(e.tile.col<=t.tile.col?1:-1),t.tile.clearTexture(),t.tile.content=null;var i=!0,n=!0,s=!1,r=void 0;try{for(var o,h=this._arrPlayerChar[Symbol.iterator]();!(n=(o=h.next()).done);n=!0){var t=o.value;if(t.currentHealth>0){i=!1;break}}}catch(t){s=!0,r=t}finally{try{!n&&h.return&&h.return()}finally{if(s)throw r}}i?a.game.events.push(new c(c.TYPE_GAME_OVER)):a.game.events.push(new c(c.TYPE_PLAYER_CHAR_KNOCKED_OUT))},n.prototype.removeEnemyChar=function(t,e){t.sprite.alpha<1&&this.restoreTileVisibility(e.tile),t.playDeathAnim(e.tile.col<=t.tile.col?1:-1),t.tile.clearTexture(),t.tile.content=null;var i=!0,n=!0,s=!1,r=void 0;try{for(var o,h=this._arrEnemyChar[Symbol.iterator]();!(n=(o=h.next()).done);n=!0){var t=o.value;if(t.currentHealth>0){i=!1;break}}}catch(t){s=!0,r=t}finally{try{!n&&h.return&&h.return()}finally{if(s)throw r}}i?a.game.events.push(new c(c.TYPE_GAME_OVER)):a.game.events.push(new c(c.TYPE_ENEMY_CHAR_KNOCKED_OUT))},n.prototype.removePickUp=function(t){t.tile.content==t&&(t.tile.content=null),t.tile=null,TweenMax.to(t,.25,{alpha:0,ease:Sine.easeInOut,onComplete:function(){this.parent.removeChild(this)},onCompleteScope:t}),this._arrPickUp.splice(this._arrPickUp.indexOf(t),1)},n.prototype.findWalkableTiles=function(t,e){var i=[];this._findWalkableTilesRec(t.hasMoved?0:t.currentSpeed,t.tile,i,!0,e),t.tile.step=-1;var n=!0,a=!1,s=void 0;try{for(var r,o=i[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var h=r.value;h.step=-1}}catch(t){a=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}return i},n.prototype.findHotTiles=function(t){var e=[];this._findHotTilesRec(t,t.hasMoved?0:t.currentSpeed,t.tile,e,!0),t.tile.step=-1;var i=!0,n=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){var c=r.value;c.tile.step=-1}}catch(t){n=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}e.push({tile:t.tile,type:"start"});for(var p=this._htFindBorderTiles(e),u=[],d=0;d<p.length;++d){var I=p[d],T=!0,m=!1,y=void 0;try{for(var g,S=I.outDirs[Symbol.iterator]();!(T=(g=S.next()).done);T=!0){var C=g.value;if(0==C.x&&C.y==-1)for(var f=1;f<=t.currentAttackRange&&!(I.row-f<0);++f)if(!this._containsHotTile(e,this._arrTile[I.row-f][I.col])){var x=this._arrTile[I.row-f][I.col];null==x.content||x.content instanceof l?u.push({tile:x,type:"attack"}):(t instanceof _&&x.content instanceof h||t instanceof h&&x.content instanceof _)&&u.push({tile:x,type:this._isTargetInRange(t,x.content)?"target":"attack"})}if(0==C.x&&1==C.y)for(var f=1;f<=t.currentAttackRange&&!(I.row+f>=s.GRID_ROW_COUNT);++f)if(!this._containsHotTile(e,this._arrTile[I.row+f][I.col])){var x=this._arrTile[I.row+f][I.col];null==x.content||x.content instanceof l?u.push({tile:x,type:"attack"}):(t instanceof _&&x.content instanceof h||t instanceof h&&x.content instanceof _)&&u.push({tile:x,type:this._isTargetInRange(t,x.content)?"target":"attack"})}if(C.x==-1&&0==C.y)for(var f=1;f<=t.currentAttackRange&&!(I.col-f<0);++f)if(!this._containsHotTile(e,this._arrTile[I.row][I.col-f])){var x=this._arrTile[I.row][I.col-f];null==x.content||x.content instanceof l?u.push({tile:x,type:"attack"}):(t instanceof _&&x.content instanceof h||t instanceof h&&x.content instanceof _)&&u.push({tile:x,type:this._isTargetInRange(t,x.content)?"target":"attack"})}if(1==C.x&&0==C.y)for(var f=1;f<=t.currentAttackRange&&!(I.col+f>=s.GRID_COL_COUNT);++f)if(!this._containsHotTile(e,this._arrTile[I.row][I.col+f])){var x=this._arrTile[I.row][I.col+f];null==x.content||x.content instanceof l?u.push({tile:x,type:"attack"}):(t instanceof _&&x.content instanceof h||t instanceof h&&x.content instanceof _)&&u.push({tile:x,type:this._isTargetInRange(t,x.content)?"target":"attack"})}}}catch(t){m=!0,y=t}finally{try{!T&&S.return&&S.return()}finally{if(m)throw y}}}return e=e.concat(u)},n.prototype.findEnemiesInRange=function(t,e){for(var i=[],n=t instanceof _,a=null==e?t.tile:e,r=1;r<=t.currentAttackRange;++r)a.col-r>=0&&(n&&this._arrTile[a.row][a.col-r].content instanceof h||!n&&this._arrTile[a.row][a.col-r].content instanceof _)&&i.push(this._arrTile[a.row][a.col-r].content),a.col+r<s.GRID_COL_COUNT&&(n&&this._arrTile[a.row][a.col+r].content instanceof h||!n&&this._arrTile[a.row][a.col+r].content instanceof _)&&i.push(this._arrTile[a.row][a.col+r].content),a.row-r>=0&&(n&&this._arrTile[a.row-r][a.col].content instanceof h||!n&&this._arrTile[a.row-r][a.col].content instanceof _)&&i.push(this._arrTile[a.row-r][a.col].content),a.row+r<s.GRID_ROW_COUNT&&(n&&this._arrTile[a.row+r][a.col].content instanceof h||!n&&this._arrTile[a.row+r][a.col].content instanceof _)&&i.push(this._arrTile[a.row+r][a.col].content);return i},n.prototype.findTileDistance=function(t,e){return Math.abs(t.row-e.row)+Math.abs(t.col-e.col)},n.prototype.findTileRadialDistance=function(t,e){return Math.max(Math.abs(t.row-e.row),Math.abs(t.col-e.col))},n.prototype.findFriendlyChars=function(t,e){var i=[],n=[];t instanceof _?n=this._arrPlayerChar:t instanceof h&&(n=this._arrEnemyChar);var a=!0,s=!1,r=void 0;try{for(var o,l=n[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var c=o.value;if(c!=t&&c.currentHealth>0){var p=0,u=!0;null!=e&&(p=this.findTileRadialDistance(c.tile,t.tile),u=p<=e),u&&i.push({character:c,tileDist:p})}}}catch(t){s=!0,r=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw r}}return i},n.prototype.createPfGrid=function(t,e){for(var i=[],n=0;n<this._arrTile.length;++n){i.push([]);for(var a=0;a<this._arrTile[n].length;++a)null==this._arrTile[n][a].content||this._arrTile[n][a].content instanceof l||n==e&&a==t?i[n].push(1):i[n].push(0)}return i},n.prototype.updateZSortedContainer=function(){this._zSortedContainer.children.sort(function(t,e){return t.y-e.y})},n.prototype.restoreTileVisibility=function(t){if(t.row+1<s.GRID_ROW_COUNT){var e=[],i=this._arrTile[t.row+1][t.col];if(i.content instanceof o)e.push(i.content.sprite);else if(i.content instanceof l)e.push(i.content);else if(i.decorations.length>0){var n=!0,a=!1,r=void 0;try{for(var h,_=i.decorations[Symbol.iterator]();!(n=(h=_.next()).done);n=!0){var c=h.value;e.push(c)}}catch(t){a=!0,r=t}finally{try{!n&&_.return&&_.return()}finally{if(a)throw r}}}var p=!0,u=!1,d=void 0;try{for(var I,T=e[Symbol.iterator]();!(p=(I=T.next()).done);p=!0){var m=I.value;TweenMax.to(m,.25,{alpha:1,ease:Sine.easeInOut})}}catch(t){u=!0,d=t}finally{try{!p&&T.return&&T.return()}finally{if(u)throw d}}}},n.prototype.setTileVisibility=function(t){if(t.row+1<s.GRID_ROW_COUNT){var e=[],i=this._arrTile[t.row+1][t.col];if(i.content instanceof o)e.push(i.content.sprite);else if(i.content instanceof l)e.push(i.content);else if(i.decorations.length>0){var n=!0,a=!1,r=void 0;try{for(var h,_=i.decorations[Symbol.iterator]();!(n=(h=_.next()).done);n=!0){var c=h.value;e.push(c)}}catch(t){a=!0,r=t}finally{try{!n&&_.return&&_.return()}finally{if(a)throw r}}}var p=!0,u=!1,d=void 0;try{for(var I,T=e[Symbol.iterator]();!(p=(I=T.next()).done);p=!0){var m=I.value;TweenMax.to(m,.25,{alpha:.2,ease:Sine.easeInOut})}}catch(t){u=!0,d=t}finally{try{!p&&T.return&&T.return()}finally{if(u)throw d}}}},n.prototype.pause=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrPlayerChar[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.pause()}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}var r=!0,o=!1,h=void 0;try{for(var _,l=this._arrEnemyChar[Symbol.iterator]();!(r=(_=l.next()).done);r=!0){var c=_.value;c.pause()}}catch(t){o=!0,h=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw h}}},n.prototype.resume=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrPlayerChar[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.resume()}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}var r=!0,o=!1,h=void 0;try{for(var _,l=this._arrEnemyChar[Symbol.iterator]();!(r=(_=l.next()).done);r=!0){var c=_.value;c.resume()}}catch(t){o=!0,h=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw h}}},n.prototype._containsHotTile=function(t,e){var i=!1,n=!0,a=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var h=r.value;if(h.tile==e){i=!0;break}}}catch(t){a=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}return i},n.prototype._isTargetInRange=function(t,e){return(t.tile.col==e.tile.col||t.tile.row==e.tile.row)&&this.findTileDistance(t.tile,e.tile)<=t.currentAttackRange},n.prototype._findWalkableTilesRec=function(t,e,i,n,a){(n||!n&&(null==e.content||e.content instanceof l||null!=a&&a.includeEnemyChars&&e.content instanceof h))&&(n||e.step!=-1||i.push(e),e.step=t,t-1>=0&&(e.col-1>=0&&this._arrTile[e.row][e.col-1].step<t&&this._findWalkableTilesRec(t-1,this._arrTile[e.row][e.col-1],i,!1,a),e.col+1<s.GRID_COL_COUNT&&!this._arrTile[e.row][e.col+1].step<t&&this._findWalkableTilesRec(t-1,this._arrTile[e.row][e.col+1],i,!1,a),e.row-1>=0&&!this._arrTile[e.row-1][e.col].step<t&&this._findWalkableTilesRec(t-1,this._arrTile[e.row-1][e.col],i,!1,a),e.row+1<s.GRID_ROW_COUNT&&!this._arrTile[e.row+1][e.col].step<t&&this._findWalkableTilesRec(t-1,this._arrTile[e.row+1][e.col],i,!1,a)))},n.prototype._findHotTilesRec=function(t,e,i,n,a){(a||!a&&(null==i.content||i.content instanceof l||t instanceof _&&i.content instanceof h||t instanceof h&&i.content instanceof _))&&(a||i.step!=-1||(null==i.content||i.content instanceof l?n.push({tile:i,type:"walk"}):(t instanceof _&&i.content instanceof h||t instanceof h&&i.content instanceof _)&&n.push({tile:i,type:this._isTargetInRange(t,i.content)?"target":"attack"})),i.step=e,e-1>=0&&(a||!a&&(null==i.content||i.content instanceof l))&&(i.col-1>=0&&this._arrTile[i.row][i.col-1].step<e&&this._findHotTilesRec(t,e-1,this._arrTile[i.row][i.col-1],n,!1),i.col+1<s.GRID_COL_COUNT&&!this._arrTile[i.row][i.col+1].step<e&&this._findHotTilesRec(t,e-1,this._arrTile[i.row][i.col+1],n,!1),i.row-1>=0&&!this._arrTile[i.row-1][i.col].step<e&&this._findHotTilesRec(t,e-1,this._arrTile[i.row-1][i.col],n,!1),i.row+1<s.GRID_ROW_COUNT&&!this._arrTile[i.row+1][i.col].step<e&&this._findHotTilesRec(t,e-1,this._arrTile[i.row+1][i.col],n,!1)))},n.prototype._findEmptyTile=function(){for(var t=null,e=[],i=0;i<s.GRID_ROW_COUNT;++i)for(var n=0;n<s.GRID_COL_COUNT;++n)null==this._arrTile[i][n].content&&e.push(this._arrTile[i][n]);return e.length>0&&(t=e[a.randomIntFromInterval(0,e.length-1)]),t},n.prototype._htFindBorderTiles=function(t){for(var e=[],i=[],n=0;n<s.GRID_ROW_COUNT;++n){i.push([]);for(var a=0;a<s.GRID_COL_COUNT;++a)i[n].push(null)}var r=!0,o=!1,h=void 0;try{for(var _,l=t[Symbol.iterator]();!(r=(_=l.next()).done);r=!0){var c=_.value;"walk"!=c.type&&"start"!=c.type||(i[c.tile.row][c.tile.col]={row:c.tile.row,col:c.tile.col})}}catch(t){o=!0,h=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw h}}for(var n=0;n<i.length;++n)for(var a=0;a<i[n].length;++a){var p=i[n][a];if(null!=p){var u={row:p.row,col:p.col,outDirs:[]};p.row>0&&(0==n||n>0&&null==i[n-1][a])&&u.outDirs.push(new PIXI.Point(0,(-1))),p.row<s.GRID_ROW_COUNT-1&&(n==i.length-1||n<i.length-1&&null==i[n+1][a])&&u.outDirs.push(new PIXI.Point(0,1)),p.col>0&&(0==a||a>0&&null==i[n][a-1])&&u.outDirs.push(new PIXI.Point((-1),0)),p.col<s.GRID_COL_COUNT-1&&(a==i[n].length-1||a<i[n].length-1&&null==i[n][a+1])&&u.outDirs.push(new PIXI.Point(1,0)),u.outDirs.length>0&&e.push(u)}}return e},Object.defineProperty(n.prototype,"width",{get:function(){return s.GRID_COL_COUNT*r.SIDE_LENGTH}}),Object.defineProperty(n.prototype,"height",{get:function(){return s.GRID_ROW_COUNT*r.SIDE_LENGTH}}),Object.defineProperty(n.prototype,"playerChars",{get:function(){return this._arrPlayerChar}}),Object.defineProperty(n.prototype,"enemyChars",{get:function(){return this._arrEnemyChar}}),Object.defineProperty(n.prototype,"pickUps",{get:function(){return this._arrPickUp}}),Object.defineProperty(n.prototype,"decorations",{get:function(){return this._arrDecoration}}),Object.defineProperty(n.prototype,"tiles",{get:function(){return this._arrTile}})},{"../../Common":6,"../../CommonGame":7,"../GameEvent":11,"./Character":29,"./EnemyCharacter":31,"./PickUp":35,"./PlayerCharacter":36,"./Tile":38}],34:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this.SIDE_LENGTH=32,this._sprite=null,this._tile=null}t("../../Common"),t("./Tile");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){},n.prototype.update=function(){},Object.defineProperty(n.prototype,"tile",{get:function(){return this._tile},set:function(t){this._tile=t}})},{"../../Common":6,"./Tile":38}],35:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this.SIDE_LENGTH=56,this.ARR_PICKUP_ID=["Shield","Double Damage","Double Speed","Refresh Special","Health Pack","Coin Pack","Double Range"],this._type=null,this._backSprite=null,this._frontSprite=null,this._iconSprite=null,this._sprite=null,this._tile=null}var a=t("../../Common"),s=t("../../CommonGame");t("./Tile"),t("./MyGrid"),t("../MyGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){console.assert(null!=this._type,{message:"this._type is null"}),this._backSprite=new PIXI.Sprite(a.assets.getTexture("pickup_back")),this._backSprite.anchor=new PIXI.Point(.5,1),this._backSprite.alpha=0,this.addChild(this._backSprite),TweenMax.to(this._backSprite,.5,{alpha:.9,ease:Sine.easeInOut,yoyo:!0,repeat:-1,delay:.6}),this._sprite=new PIXI.Sprite(a.assets.getTexture(this._getSpriteId(this._type))),this._sprite.anchor=new PIXI.Point(.5,1),this.addChild(this._sprite),this._sprite.y-=200,this._sprite.alpha=0;var t=new TimelineMax;t.to(this._sprite,.5,{y:this._sprite.y+200,alpha:1,ease:Back.easeOut}),t.to(this._sprite,.35,{y:this._sprite.y-10+200,ease:Sine.easeOut}),t.to(this._sprite,.5,{y:this._sprite.y+10+200-10,ease:Sine.easeInOut,yoyo:!0,repeat:-1}),this._frontSprite=new PIXI.Sprite(a.assets.getTexture("pickup_top")),this._frontSprite.anchor=new PIXI.Point(.5,1),this._frontSprite.alpha=0,this.addChild(this._frontSprite),TweenMax.to(this._frontSprite,.5,{alpha:.9,ease:Sine.easeInOut,yoyo:!0,repeat:-1,delay:.5}),this._iconSprite=new PIXI.Sprite(a.assets.getTexture(this._getIconId())),this._iconSprite.anchor=new PIXI.Point(.5,1),this._iconSprite.alpha=0,this.addChild(this._iconSprite),TweenMax.to(this._frontSprite,.5,{alpha:1,ease:Sine.easeInOut}),TweenMax.to(this._backSprite,.5,{alpha:1,ease:Sine.easeInOut}),TweenMax.to(this._iconSprite,.5,{alpha:1,ease:Sine.easeInOut})},n.prototype.activate=function(t){switch(this._type){case s.PICKUP_ID_DOUBLE_DAMAGE:t.addCondition(s.COND_ID_DOUBLE_DAMAGE,2),a.audio.playSound("sfx_pickup_double_damage_00");break;case s.PICKUP_ID_DOUBLE_ATTACK_RANGE:t.addCondition(s.COND_ID_EXTRA_ATTACK_RANGE,2);break;case s.PICKUP_ID_DOUBLE_SPEED:t.addCondition(s.COND_ID_DOUBLE_SPEED,2),a.audio.playSound("sfx_pickup_doublespeed_00");break;case s.PICKUP_ID_SPECIAL_ABILITY_RECHARGE:null!=t.specialAbility&&t.specialAbility.recharge(),a.audio.playSound("sfx_pickup_ability_recharge_00");break;case s.PICKUP_ID_HEALTH_PACK:t.heal(.5*t.health),a.audio.playSound("sfx_pickup_health_pack_0"+a.randomIntFromInterval(0,1).toString());break;case s.PICKUP_ID_COIN_PACK:a.savedData.coins+=s.PICKUP_COIN_PACK_REWARD,a.audio.playSound("sfx_pickup_coinspack_0"+a.randomIntFromInterval(0,1).toString());var e=new PIXI.extras.BitmapText("+"+s.PICKUP_COIN_PACK_REWARD.toString(),{font:"30px ed_30",align:"center"});e.anchor=new PIXI.Point(.5,.5),e.position=new PIXI.Point(t.x,t.y-100),e.tint=16766720,TweenMax.to(e,1,{y:e.y-25,onComplete:function(){a.game.grid.removeChild(this)},onCompleteScope:e}),a.game.grid.addChild(e)}},n.prototype._getSpriteId=function(){var t="";switch(this._type){case s.PICKUP_ID_DOUBLE_DAMAGE:t="pickup_attack";break;case s.PICKUP_ID_DOUBLE_SPEED:t="pickup_movement";break;case s.PICKUP_ID_SPECIAL_ABILITY_RECHARGE:t="pickup_special";break;case s.PICKUP_ID_HEALTH_PACK:t="pickup_health";break;case s.PICKUP_ID_COIN_PACK:t="pickup_coins";break;case s.PICKUP_ID_DOUBLE_ATTACK_RANGE:t="pickup_range"}return t},n.prototype._getIconId=function(){var t="pickup_icon_";switch(this._type){case s.PICKUP_ID_DOUBLE_DAMAGE:t+="attack";break;case s.PICKUP_ID_DOUBLE_SPEED:t+="movement";break;case s.PICKUP_ID_SPECIAL_ABILITY_RECHARGE:t+="special";break;case s.PICKUP_ID_HEALTH_PACK:t+="health";break;case s.PICKUP_ID_COIN_PACK:t+="coins";break;case s.PICKUP_ID_DOUBLE_ATTACK_RANGE:t+="range"}return t},Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t}}),Object.defineProperty(n.prototype,"tile",{get:function(){return this._tile},set:function(t){this._tile=t}})},{"../../Common":6,"../../CommonGame":7,"../MyGame":14,"./MyGrid":33,"./Tile":38}],36:[function(t,e,i){"use strict";function n(){r.call(this)}var a=t("../../Common"),s=t("../../CommonGame"),r=t("./Character"),o=(t("../MyGame"),t("./SpecialAbility"));e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(t){this.TILE_SPRITE_ID={attackCharacter:"grid_attack",attackRange:"grid_attack_range",movement:"grid_movement",selected:"grid_movement_selected"},this._baseBotSprite=new PIXI.Sprite(a.assets.getTexture("char_base_btm_yellow")),this._tint=65280,r.prototype.init.call(this,t),this._walkSoundId="sfx_player_move_loop_01"},n.prototype.update=function(){r.prototype.update.call(this),!this._isMoving&&this._hasMoved&&this.hasCondition(s.COND_ID_EXTRA_MOVE)?(this._hasMoved=!1,this._arrHotTile=a.game.grid.findHotTiles(this),this.highlightHotTiles()):this._hasAttacked&&this.hasCondition(s.COND_ID_EXTRA_ATTACK)&&(this._hasAttacked=!1,this._arrHotTile=a.game.grid.findHotTiles(this),this.highlightHotTiles())},n.prototype.getCharInfo=function(){return a.assets.getJSON("playerCharacters").playerCharacters[this._id]},n.prototype.isOutOfActions=function(){var t=!1;return t=!this._specialAbility.isReady(),t&&(t=!this._isMoving&&this._hasMoved),t&&(t=!this._hasAttacked&&0==a.game.grid.findEnemiesInRange(this).length||this._hasAttacked),t},n.prototype._loadStats=function(t){var e=s.getPlayerCharStats(t.id);this._speed=e.SPEED,this._health=e.HEALTH,this._damage=e.DAMAGE,this._attackRange=e.ATTACK_RANGE,this._essenceType=s.getEssenceType(t.essence),this._specialAbility=new o,this._specialAbility.owner=this,this._specialAbility.type=s.getSpecialAbilityType(t.specialAbility.type),this._specialAbility.rechargeTime=e.SA_RECHARGE_TIME,this._specialAbility.signals.onActivated.add(this._onSpecialAbilityActivated,this),this._specialAbility.init()},n.prototype._onMoveToCompleted=function(t){r.prototype._onMoveToCompleted.call(this,t),this._hasAttacked||(this._arrHotTile=a.game.grid.findHotTiles(this),this.highlightHotTiles()),a.game.grid.setTileVisibility(t)},n.prototype._onSpecialAbilityActivated=function(t){switch(t){case s.SA_ID_EXTRA_ATTACK:this.addCondition(s.COND_ID_EXTRA_ATTACK,-1),a.game.hud.playerCharAttributes.conditionList.update();break;case s.SA_ID_SPLASH_DAMAGE:this.addCondition(s.COND_ID_SPLASH_DAMAGE,-1),a.game.hud.playerCharAttributes.conditionList.update();break;case s.SA_ID_EXTRA_MOVE:this.addCondition(s.COND_ID_EXTRA_MOVE,-1),a.game.hud.playerCharAttributes.conditionList.update()}},n.prototype.onDamageTaken=function(t){r.prototype.onDamageTaken.call(this,t),0==this._curHealth&&(a.game.grid.removePlayerChar(this,t),a.audio.playSound("sfx_player_human_dies_00"))}},{"../../Common":6,"../../CommonGame":7,"../MyGame":14,"./Character":29,"./SpecialAbility":37}],37:[function(t,e,i){"use strict";function n(){this.ARR_SPECIAL_ABILITY_TITLE=[a.assets.getJSON("languages").DOUBLE_ATTACK[a.language],a.assets.getJSON("languages").SPLASH_DAMAGE[a.language],a.assets.getJSON("languages").DOUBLE_MOVE[a.language],a.assets.getJSON("languages").HEAL[a.language],a.assets.getJSON("languages").HEAL[a.language]],this._owner=null,this._type=null,this._rechargeTime=0,this._rechargeCounter=0,this.signals={},this.signals.onActivated=new signals.Signal}var a=t("../../Common"),s=t("../../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(){console.assert(null!=this._owner,{message:"this._owner is null"}),console.assert(null!=this._type,{message:"this._type is null"}),console.assert(this._rechargeTime>0,{message:"this._rechargeTime is not greater than 0"}),this._rechargeCounter=this._rechargeTime+1},n.prototype.activate=function(){switch(this._rechargeCounter=this._rechargeTime+1,this._type){case s.SA_ID_EXTRA_ATTACK:a.audio.playSound("sfx_special_double_attack_00");break;case s.SA_ID_SPLASH_DAMAGE:a.audio.playSound("sfx_special_splash_damage_00");break;case s.SA_ID_EXTRA_MOVE:a.audio.playSound("sfx_special_move_attack_move_0"+a.randomIntFromInterval(0,1).toString());break;case s.SA_ID_HEALING_POWER:this._owner.heal(s.HEAL_VALUE),a.audio.playSound("sfx_special_healing_power_00");break;case s.SA_ID_HEAL_OTHERS:var t=a.game.grid.findFriendlyChars(this._owner),e=!0,i=!1,n=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var h=r.value;h.character.heal(s.HEAL_OTHERS_VALUE)}}catch(t){i=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(i)throw n}}a.audio.playSound("sfx_special_healing_power_00")}this.signals.onActivated.dispatch(this._type)},n.prototype.recharge=function(){this._canRecharge()&&(this._rechargeCounter=0)},n.prototype.refresh=function(){this._rechargeCounter>0&&this._canRecharge()&&(this._rechargeCounter-=1)},n.prototype.isReady=function(){return this._rechargeCounter<=0},n.prototype.toString=function(){return this.ARR_SPECIAL_ABILITY_TITLE[this._type]},n.prototype._canRecharge=function(){return!(this._type==s.SA_ID_EXTRA_ATTACK&&this._owner.hasCondition(s.COND_ID_EXTRA_ATTACK)||this._type==s.SA_ID_SPLASH_DAMAGE&&this._owner.hasCondition(s.COND_ID_SPLASH_DAMAGE)||this._type==s.SA_ID_EXTRA_MOVE&&this._owner.hasCondition(s.COND_ID_EXTRA_MOVE))},Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t}}),Object.defineProperty(n.prototype,"rechargeTime",{set:function(t){this._rechargeTime=t},get:function(){return this._rechargeTime}}),Object.defineProperty(n.prototype,"rechargeCounter",{get:function(){return this._rechargeCounter}}),Object.defineProperty(n.prototype,"owner",{set:function(t){this._owner=t}})},{"../../Common":6,"../../CommonGame":7}],38:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._arrDecoration=[],this._content=null,this._sprite=null,this._btnSprite=null,this._row=-1,this._col=-1,this._step=-1}var a=t("../../Common"),s=(t("./PlayerCharacter"),t("./EnemyCharacter"),t("../MyGame"),t("../GameEvent"));e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.SIDE_LENGTH=76,n.prototype.init=function(){this._btnSprite=new PIXI.Sprite(a.blankTexture),this._btnSprite.alpha=0,this._btnSprite.width=this._btnSprite.height=n.SIDE_LENGTH-5,this._btnSprite.anchor=new PIXI.Point(.5,.5),this._btnSprite.interactive=!0,this._btnSprite.click=this._btnSprite.tap=this._onClick.bind(this),this.addChild(this._btnSprite),this._sprite=new PIXI.Sprite(a.blankTexture),this._sprite.width=this._sprite.height=n.SIDE_LENGTH,this._sprite.anchor=new PIXI.Point(.5,.5),this._sprite.visible=!1,this.addChild(this._sprite)},n.prototype.setTexture=function(t){this._sprite.visible=!0,this._sprite.texture!=t&&(this._sprite.texture=t,this._sprite.width=t.width,this._sprite.height=t.height)},n.prototype.clearTexture=function(){this._sprite.visible=!1},n.prototype._onClick=function(t){a.game.isBusy()||a.game.input.events.push(new s(s.TYPE_INPUT,{tile:this}))},Object.defineProperty(n.prototype,"content",{get:function(){return this._content},set:function(t){this._content=t}}),Object.defineProperty(n.prototype,"decorations",{get:function(){return this._arrDecoration},set:function(t){this._arrDecoration=t}}),Object.defineProperty(n.prototype,"row",{get:function(){return this._row},set:function(t){this._row=t}}),Object.defineProperty(n.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t}}),Object.defineProperty(n.prototype,"step",{get:function(){return this._step},set:function(t){this._step=t}})},{"../../Common":6,"../GameEvent":11,"../MyGame":14,"./EnemyCharacter":31,"./PlayerCharacter":36}],39:[function(t,e,i){"use strict";function n(){r.call(this),this._playBtn=null,this._uiCharPicker=null,this._uiTeamViewer=null,this._teamViewerTl=null,this._titleText=null,this._tmPlayMusic=null,this._helpPanel=null}var a=t("../Common"),s=t("../CommonGame"),r=t("./SimpleScene"),o=t("../ui/UICharPicker"),h=t("../ui/UITeamViewer"),_=t("../ui/overlays/HelpPanel");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("choose_bg")),r.prototype.init.call(this);var t=a.assets.getJSON("languages").TEAM_SETUP[a.language].toUpperCase();this._titleText=new PIXI.extras.BitmapText(t,{font:"100px ed_110_gradient",align:"center"}),this._titleText.anchor=new PIXI.Point(.5,.5),this._titleText.position.x=.5*a.STAGE_WIDTH,this._titleText.position.y=this._titleText.height,this.addChild(this._titleText);var e=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("icon_primary_play_off"));e.iconOver=a.assets.getTexture("icon_primary_play_over"),e.iconDown=a.assets.getTexture("icon_primary_play_down"),this._playBtn=new p3.Button(e),this._playBtn.anchor=new PIXI.Point(.5,1),this._playBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH+400,a.STAGE_HEIGHT-.5*this._playBtn.height),this._playBtn.signals.click.add(this._onPlayButton_Click,this),this.addChild(this._playBtn),this._uiCharPicker=new o,this._uiCharPicker.init(a.savedData.arrTeamCharId),this._uiCharPicker.position=new PIXI.Point(.5*a.STAGE_WIDTH-200,.5*a.STAGE_HEIGHT+50),this.addChild(this._uiCharPicker),this._uiCharPicker.signals.onCharacterPicked.add(this._onCharacterPicked,this),this._uiCharPicker.signals.onCharacterImproved.add(this._onCharacterImproved,this),this._uiTeamViewer=new h,this._uiTeamViewer.init(),this._uiTeamViewer.position=new PIXI.Point(.5*a.STAGE_WIDTH+350,.5*a.STAGE_HEIGHT),this.addChild(this._uiTeamViewer),this._uiTeamViewer.signals.onCharSlotCleared.add(this._uiCharPicker.onCharSlotCleared,this._uiCharPicker);var i=!0,n=!1,l=void 0;try{for(var c,p=this._uiCharPicker.selectedChars[Symbol.iterator]();!(i=(c=p.next()).done);i=!0){
var u=c.value;this._uiTeamViewer.addChar(u)}}catch(t){n=!0,l=t}finally{try{!i&&p.return&&p.return()}finally{if(n)throw l}}this._teamViewerTl=new TimelineMax,this._teamViewerTl.to(this._uiTeamViewer,.08,{x:this._uiTeamViewer.x-50,ease:Sine.easeIn},0).to(this._uiTeamViewer,.08,{x:this._uiTeamViewer.x+50,ease:Linear.easeOut}).to(this._uiTeamViewer,.08,{x:this._uiTeamViewer.x-50,ease:Linear.easeOut}).to(this._uiTeamViewer,.08,{x:this._uiTeamViewer.x+50,ease:Linear.easeOut}).to(this._uiTeamViewer,.08,{x:this._uiTeamViewer.x,ease:Sine.easeOut}),this._teamViewerTl.pause(),r.prototype.createSharedControls.call(this),this._uiTopBarSharedControls.homeBtn.visible=!1,this._uiTopBarSharedControls.backBtn.visible=!0,this._uiTopBarSharedControls.signals.onBackBtn_Click.addOnce(function(){a.main.application.loadScene(s.SCENE_ID_LEVEL_SELECTION)},this),this._helpPanel=new _,this._helpPanel.anchor=new PIXI.Point(.5,.5),this._helpPanel.visible=!1,this._helpPanel.init(),this._helpPanel.signals.onClosed.add(function(){this._helpPanel.hide()},this),this._helpPanel.signals.onHidden.add(function(){this._helpPanel.visible=!1},this),this.addChild(this._helpPanel)},n.prototype.animateIn=function(){this._uiTeamViewer.scale=new PIXI.Point,this._uiCharPicker.scale=new PIXI.Point,this._titleText.alpha=0,this._titleText.x-=100,this._playBtn.alpha=0,this._playBtn.x-=100;var t=new TimelineMax;t.to(this._titleText,.25,{alpha:1,x:this._titleText.x+100,ease:Sine.easeOut}).to(this._uiCharPicker.scale,.25,{x:1,y:1,ease:Sine.easeOut}).to(this._uiTeamViewer.scale,.25,{x:1,y:1,ease:Sine.easeOut}).to(this._playBtn,.25,{alpha:1,x:this._playBtn.x+100,ease:Sine.easeOut}),a.audio.playSound("sfx_enter_char_select_screen_00"),this._tmPlayMusic=TweenMax.delayedCall(1,function(){a.audio.playMusic("music_team_select_03")},null,this),a.savedData.isFirstCharPick&&t.call(function(){this._helpPanel.visible=!0,this._helpPanel.show()},null,this)},n.prototype.hide=function(){r.prototype.hide.call(this),a.audio.playSound("sfx_leave_char_select_screen_00"),this._tmPlayMusic.kill()},n.prototype._onPlayButton_Click=function(){this._uiCharPicker.selectedChars.length==s.PLAYER_TEAM_SIZE?(a.savedData.arrTeamCharId=this._uiCharPicker.selectedChars,a.savedData.save(),a.main.application.loadScene(s.SCENE_ID_GAMEPLAY)):this._teamViewerTl.play(0)},n.prototype._onCharacterPicked=function(t,e){this._uiTeamViewer.addChar(t,new PIXI.Point(this._uiCharPicker.position.x+this._uiCharPicker.ARR_CHAR_CARD_POSITION[1+e].x,this._uiCharPicker.position.y+this._uiCharPicker.ARR_CHAR_CARD_POSITION[1+e].y),0==e?1:this._uiCharPicker.CHAR_CARD_SCALE)},n.prototype._onCharacterImproved=function(t){this._uiTeamViewer.updateChar(t)}},{"../Common":6,"../CommonGame":7,"../ui/UICharPicker":52,"../ui/UITeamViewer":57,"../ui/overlays/HelpPanel":65,"./SimpleScene":48}],40:[function(t,e,i){"use strict";function n(){p3.Scene.call(this),this._leftBgSprite=null,this._midBgSprite=null,this._rightBgSprite=null,this._levelLayer=null,this._decoBackLayer=null,this._nonWalkableLayer=null,this._gameLayer=null}var a=t("../Common"),s=t("../CommonGame");t("../game/world/MyGrid");e.exports=n,n.prototype=Object.create(p3.Scene.prototype),n.prototype.constructor=n,n.prototype.init=function(t){p3.Scene.prototype.init.call(this),this._levelContainer=new PIXI.Container,this.addChild(this._levelContainer);var e=a.assets.getJSON("levels").levels[t];this._midBgSprite=new PIXI.Sprite(a.assets.getTexture("lvlMidBg_"+e.bg.mid)),this._midBgSprite.anchor=new PIXI.Point(.5,.5),this._midBgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this._levelContainer.addChild(this._midBgSprite),this._leftBgSprite=new PIXI.Sprite(a.assets.getTexture("lvlLeftBg_"+e.bg.left)),this._leftBgSprite.anchor=new PIXI.Point(.5,.5),this._leftBgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH-.5*this._midBgSprite.width-.5*this._leftBgSprite.width,.5*a.STAGE_HEIGHT),this._levelContainer.addChild(this._leftBgSprite),this._rightBgSprite=new PIXI.Sprite(a.assets.getTexture("lvlRightBg_"+e.bg.right)),this._rightBgSprite.anchor=new PIXI.Point(.5,.5),this._rightBgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH+.5*this._midBgSprite.width+.5*this._leftBgSprite.width,.5*a.STAGE_HEIGHT),this._levelContainer.addChild(this._rightBgSprite),this._decoBackLayer=new PIXI.Container,this._decoBackLayer.position=new PIXI.Point(.5*a.STAGE_WIDTH-302,.5*a.STAGE_HEIGHT-270),this._levelContainer.addChild(this._decoBackLayer),this._processLayerData(e.tiles.decoBack,this._decoBackLayer),this._nonWalkableLayer=new PIXI.Container,this._nonWalkableLayer.position=new PIXI.Point(this._decoBackLayer.x,this._decoBackLayer.y),this._levelContainer.addChild(this._nonWalkableLayer),this._processLayerData(e.tiles.nonWalkable,this._nonWalkableLayer),this._gameLayer=new PIXI.Container,this._gameLayer.position=new PIXI.Point(this._decoBackLayer.x,this._decoBackLayer.y),this._levelContainer.addChild(this._gameLayer),this._combatLayer=new PIXI.Container,this.addChild(this._combatLayer)},n.prototype.update=function(){a.game.isPaused||a.game.update()},n.prototype.resize=function(){this.x=.5*(p3.View.width-a.STAGE_WIDTH)},n.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this)},n.prototype._processLayerData=function(t,e){var i=4,n=152,r=0,o=0,h=!0,_=!1,l=void 0;try{for(var c,p=t[Symbol.iterator]();!(h=(c=p.next()).done);h=!0){var u=c.value;if(u>0){var d=new PIXI.Texture(a.assets.getTexture("tiles"),new PIXI.Rectangle((u-1)%i*n,Math.floor((u-1)/i)*n,n,n)),I=new PIXI.Sprite(d);I.anchor=new PIXI.Point(.5,.5),I.scale=new PIXI.Point(.5,.5),I.position=new PIXI.Point(o*I.width,r*I.height),e.addChild(I)}++o,o>=s.GRID_COL_COUNT&&(o=0,++r)}}catch(t){_=!0,l=t}finally{try{!h&&p.return&&p.return()}finally{if(_)throw l}}},n.prototype._onGameOver=function(){},Object.defineProperty(n.prototype,"levelContainer",{get:function(){return this._levelContainer}}),Object.defineProperty(n.prototype,"gameLayer",{get:function(){return this._gameLayer}}),Object.defineProperty(n.prototype,"combatLayer",{get:function(){return this._combatLayer}})},{"../Common":6,"../CommonGame":7,"../game/world/MyGrid":33}],41:[function(t,e,i){"use strict";function n(){l.call(this),this._pauseBtn=null,this._pausePanel=null,this._gameResultPanel=null,this._preBattlePanel=null}var a=t("../Common"),s=t("../CommonGame"),r=t("../game/MyGame"),o=(t("../game/world/MyGrid"),t("../ui/overlays/PausePanel")),h=t("../ui/overlays/GameResultPanel"),_=t("../ui/overlays/PreBattlePanel"),l=t("./GamePlayScene");e.exports=n,n.prototype=Object.create(l.prototype),n.prototype.constructor=n,n.prototype.init=function(){l.prototype.init.call(this,s.selectedLevel.id),a.game=new r,a.game.scene=this,a.game.init(),a.game.signals.onGameOver.addOnce(this._onGameOver,this),a.game.pause();var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_side_off"),a.assets.getTexture("btn_primary_side_over"),a.assets.getTexture("btn_primary_side_down"),a.assets.getTexture("icon_primary_pause_off"));t.iconOver=a.assets.getTexture("icon_primary_pause_over"),t.iconDown=a.assets.getTexture("icon_primary_pause_down"),this._pauseBtn=new p3.Button(t),this._pauseBtn.anchor=new PIXI.Point(.5,.5),this._pauseBtn.position.y=.5*this._pauseBtn.height,this._pauseBtn.signals.click.add(this._onPauseButton_Click,this),this.addChild(this._pauseBtn),this._pausePanel=new o,this._pausePanel.init(),this._pausePanel.signals.onClosed.add(this._pausePanel.hide,this._pausePanel),this._pausePanel.signals.onHidden.add(this._onPausePanel_Hidden,this),this.addChild(this._pausePanel),this._pausePanel.visible=!1,this.setChildIndex(this._combatLayer,this.getChildIndex(this._pausePanel)),this._gameResultPanel=new h,this._gameResultPanel.init(),this.addChild(this._gameResultPanel),this._gameResultPanel.visible=!1,this._preBattlePanel=new _,this._preBattlePanel.init(),this._preBattlePanel.signals.onAnimateInEnded.add(this._onPreBattleAnimationEnded,this),this.addChild(this._preBattlePanel)},n.prototype.resize=function(){l.prototype.resize.call(this),this._pauseBtn.position.x=a.getButtonPositionRight(0),this._pausePanel.resize(),this._gameResultPanel.resize()},n.prototype.animateIn=function(){this._preBattlePanel.animateIn()},n.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this)},n.prototype._onPauseButton_Click=function(){this._pausePanel.visible=!0,this._pausePanel.show(),a.game.pause()},n.prototype._onPausePanel_Hidden=function(){this._pausePanel.visible=!1,a.game.resume()},n.prototype._onPreBattleAnimationEnded=function(){this.removeChild(this._preBattlePanel),this._preBattlePanel=!0,a.game.resume()},n.prototype._onGameOver=function(){var t=a.game.grid.getPlayerCharCount(),e=0==a.game.grid.getPlayerCharCount(),i=100*t-10*(a.game.round-1);i<0&&(i=0),i+=100,this._gameResultPanel.visible=!0,this._gameResultPanel.show(e,i)},n.prototype._onMuteButton_Click=function(){a.isMute=!a.isMute,this._muteBtn._icon.texture=a.assets.getTexture("icon_small_sound_o"+(a.isMute?"ff":"n")),this._muteBtn._currentIconTexture=this._muteBtn._icon.texture,this._muteBtn._currentIconOverTexture=this._muteBtn._icon.texture,this._muteBtn._currentIconDownTexture=this._muteBtn._icon.texture,a.audio.mute(a.isMute),a.audio.playSound("sfx_small_blip")}},{"../Common":6,"../CommonGame":7,"../game/MyGame":14,"../game/world/MyGrid":33,"../ui/overlays/GameResultPanel":63,"../ui/overlays/PausePanel":68,"../ui/overlays/PreBattlePanel":69,"./GamePlayScene":40}],42:[function(t,e,i){"use strict";function n(){r.call(this),this._nextBtn=null,this._timeline=null,this._comicPageIndex=2,this._comicPageContainer=null,this._arrShowComicPageFunc=[],this.COMIC_PAGE_COUNT=3}var a=t("../Common"),s=t("../CommonGame"),r=t("./SimpleScene");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("intro_bg")),r.prototype.init.call(this),this._comicPageContainer=new PIXI.Container,this.addChild(this._comicPageContainer);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("btn_next_off"));t.iconOver=a.assets.getTexture("btn_next_over"),t.iconDown=a.assets.getTexture("btn_next_down"),this._nextBtn=new p3.Button(t),this._nextBtn.anchor=new PIXI.Point(.5,.5),this._nextBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH+550,a.STAGE_HEIGHT-.5*this._nextBtn.height),this._nextBtn.signals.click.add(this._onNextButton_Click,this),this.addChild(this._nextBtn),this._arrShowComicPageFunc.push(this._showComicPage_0),this._arrShowComicPageFunc.push(this._showComicPage_1),this._arrShowComicPageFunc.push(this._showComicPage_2),this._timeline=new TimelineMax,this._arrShowComicPageFunc[this._comicPageIndex].call(this),r.prototype.createSharedControls.call(this),this._uiTopBarSharedControls.homeBtn.visible=!1,this._uiTopBarSharedControls.muteBtn.visible=!1},n.prototype.update=function(){},n.prototype._showComicPage_0=function(){var t=new PIXI.Sprite(a.assets.getTexture("intro_1_panel_001"));t.alpha=0,t.anchor=new PIXI.Point(.5,.5),t.position=new PIXI.Point(0,.5*a.STAGE_HEIGHT),this._comicPageContainer.addChild(t);var e=new PIXI.Sprite(a.assets.getTexture("intro_1_panel_002"));e.alpha=0,e.anchor=new PIXI.Point(.5,.5),e.position=new PIXI.Point(a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this._comicPageContainer.addChildAt(e,0);var i=new PIXI.Sprite(a.assets.getTexture("intro_1_panel_003"));i.alpha=0,i.anchor=new PIXI.Point(.5,.5),i.scale=new PIXI.Point,i.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this._comicPageContainer.addChild(i);var n=new PIXI.Sprite(a.assets.getTexture("intro_1_panel_004"));n.alpha=0,n.anchor=new PIXI.Point(.5,.5),n.position=new PIXI.Point(.5*a.STAGE_WIDTH,a.STAGE_HEIGHT),this._comicPageContainer.addChildAt(n,0),this._timeline.to(t,.25,{alpha:1,ease:Sine.easeInOut},0).to(t.position,.5,{x:.5*a.STAGE_WIDTH,ease:Sine.easeInOut},0).to(e,.25,{alpha:1,ease:Sine.easeInOut},.75).to(e.position,.5,{x:.5*a.STAGE_WIDTH,ease:Sine.easeInOut},.75).to(i,0,{alpha:1},"+=0").to(i.scale,.5,{x:1,y:1,ease:Back.easeOut},"+=0").to(n,.25,{alpha:1,ease:Sine.easeInOut},2).to(n.position,.5,{y:.5*a.STAGE_HEIGHT,ease:Sine.easeInOut},2),a.audio.playMusic("music_story_screen_tension_00")},n.prototype._showComicPage_1=function(){this._bgSprite.texture=a.assets.getTexture("intro_2_bg");var t=new PIXI.Sprite(a.assets.getTexture("intro_2_char"));t.alpha=0,t.anchor=new PIXI.Point(.5,.5),t.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this._comicPageContainer.addChild(t);var e=new PIXI.Sprite(a.assets.getTexture("intro_2_boarder"));e.anchor=new PIXI.Point(.5,.5),e.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this._comicPageContainer.addChild(e),this._timeline.to(t,2,{alpha:1,ease:Sine.easeInOut},0),a.audio.playSound("music_story_screen_stab_danger_00")},n.prototype._showComicPage_2=function(){this._bgSprite.texture=a.assets.getTexture("intro_bg");var t=new PIXI.Sprite(a.assets.getTexture("intro_3_panel_001"));t.alpha=0,t.anchor=new PIXI.Point(.5,.5),t.position=new PIXI.Point(0,.5*a.STAGE_HEIGHT-40),this._comicPageContainer.addChild(t);var e=new PIXI.Sprite(a.assets.getTexture("intro_3_panel_002"));e.alpha=0,e.anchor=new PIXI.Point(.5,.5),e.position=new PIXI.Point(a.STAGE_WIDTH,t.position.y),this._comicPageContainer.addChild(e),this._timeline.to(t,.25,{alpha:1,ease:Sine.easeInOut},0).to(t.position,.5,{x:.5*a.STAGE_WIDTH,ease:Sine.easeInOut},0).to(e,.25,{alpha:1,ease:Sine.easeInOut},0).to(e.position,.5,{x:.5*a.STAGE_WIDTH,ease:Sine.easeInOut},0),a.audio.stopMusic(),a.audio.playSound("music_story_screen_team_clash_00")},n.prototype._onNextButton_Click=function(){this._comicPageIndex==this.COMIC_PAGE_COUNT-1?(a.savedData.hasSeenIntro=!0,a.savedData.save(),a.main.application.loadScene(s.SCENE_ID_LEVEL_SELECTION)):(this._timeline.clear(),this._comicPageContainer.removeChildren(),this._comicPageIndex+=1,this._arrShowComicPageFunc[this._comicPageIndex].call(this))}},{"../Common":6,"../CommonGame":7,"./SimpleScene":48}],43:[function(t,e,i){"use strict";function n(){r.call(this),this._lakewoodLogoSprite=null,this._boxMoreLogoSprite=null,this._gridContainer=null,this._topGradientSprite=null,this._titleText=null,this._messagePanel=null,this._isInteractive=!0,this._gameOverPanel=null,this._ticTacToeAI=null,this._miniCarGenerator=null,this._boxMorePickSprite=null,this._boxManSprite=null,this._koSprite=null,this._ticTacToeWinner=null,this.COL_COUNT=3,this.ROW_COUNT=3}var a=t("../Common"),s=t("../CommonGame"),r=t("./SimpleScene"),o=(t("../ui/UILevelTile"),t("../ui/overlays/MessagePanel")),h=t("../ui/overlays/GameOverPanel"),_=t("./ticTacToe/TicTacToeAI"),l=t("./MiniCarGenerator");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("lvl_select_bg")),r.prototype.init.call(this),this._ticTacToeAI=new _,this._topGradientSprite=new PIXI.Sprite(a.assets.getTexture("lvl_select_gradient")),this._topGradientSprite.anchor=new PIXI.Point(.5,0),this._topGradientSprite.x=.5*a.STAGE_WIDTH,this.addChild(this._topGradientSprite),this._gridContainer=new PIXI.Container,this._gridContainer.anchor=new PIXI.Point(.5,.5),this._gridContainer.x=.5*a.STAGE_WIDTH-378,this._gridContainer.y=.5*a.STAGE_HEIGHT-270,this.addChild(this._gridContainer),this._initTicTacToeGrid(),this._miniCarGenerator=new l,this._miniCarGenerator.position=new PIXI.Point(.5*a.STAGE_WIDTH+491,a.STAGE_HEIGHT+20),this._miniCarGenerator.init(a.STAGE_HEIGHT+40,18),this.addChild(this._miniCarGenerator),this._lakewoodLogoSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_logo_good")),this._lakewoodLogoSprite.anchor=new PIXI.Point(1,.5),this._lakewoodLogoSprite.scale=new PIXI.Point(.6,.6),this._lakewoodLogoSprite.x=.5*a.STAGE_WIDTH-340,this._lakewoodLogoSprite.y=.5*a.STAGE_HEIGHT+50,this.addChild(this._lakewoodLogoSprite),this._boxMoreLogoSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_logo_bad")),this._boxMoreLogoSprite.anchor=new PIXI.Point(0,.5),this._boxMoreLogoSprite.scale=new PIXI.Point(.6,.6),this._boxMoreLogoSprite.x=.5*a.STAGE_WIDTH+390,this._boxMoreLogoSprite.y=.5*a.STAGE_HEIGHT+50,this.addChild(this._boxMoreLogoSprite),this._koSprite=new PIXI.Sprite(a.assets.getTexture("stats_ko")),this._koSprite.anchor=new PIXI.Point(0,1),this._koSprite.scale=new PIXI.Point(1,1),this._koSprite.xIni=.5*a.STAGE_WIDTH-.5*a.STAGE_MIN_WIDTH-50,this._koSprite.x=this._koSprite.xIni,this._koSprite.y=a.STAGE_HEIGHT,this.addChild(this._koSprite),this._boxManSprite=new PIXI.Sprite(a.assets.getTexture("stats_boxman")),this._boxManSprite.anchor=new PIXI.Point(1,1),this._boxManSprite.scale=new PIXI.Point(1,1),this._boxManSprite.xIni=.5*a.STAGE_WIDTH+.5*a.STAGE_MIN_WIDTH+100,this._boxManSprite.x=this._boxManSprite.xIni,this._boxManSprite.y=a.STAGE_HEIGHT,this.addChild(this._boxManSprite);var t=a.assets.getJSON("languages").LEVEL_SELECTION[a.language].toUpperCase();this._titleText=new PIXI.extras.BitmapText(t,{font:"100px ed_110_gradient",align:"center"}),this._titleText.anchor=new PIXI.Point(.5,.5),this._titleText.x=.5*a.STAGE_WIDTH,this._titleText.y=this._titleText.height,this.addChild(this._titleText),this._boxMorePickSprite=new PIXI.Sprite(a.assets.getTexture("ui_tutorial_boxmore_finger")),this._boxMorePickSprite.anchor=new PIXI.Point(.5,.5),this._boxMorePickSprite.scale.y=-1,this._boxMorePickSprite.visible=!1,this.addChild(this._boxMorePickSprite),r.prototype.createSharedControls.call(this),this._uiTopBarSharedControls.homeBtn.visible=!1,this._uiTopBarSharedControls.backBtn.visible=!0,this._uiTopBarSharedControls.signals.onBackBtn_Click.addOnce(function(){TweenMax.killAll(),a.main.application.loadScene(s.SCENE_ID_MAIN)},this),this._messagePanel=new o,this._messagePanel.init(),this.addChild(this._messagePanel),this._messagePanel.visible=!1,this._gameOverPanel=new h,this._gameOverPanel.init(),this.addChild(this._gameOverPanel),this._gameOverPanel.visible=!1,this._gameOverPanel.signals.onClosed.add(this._onGameOverPanel_Closed,this)},n.prototype.animateIn=function(){this._isInteractive=!1;var t=new TimelineMax;TweenMax.to(this._topGradientSprite,1,{alpha:.75,repeat:-1,yoyo:!0,ease:Sine.easeInOut}),this._titleText.alpha=0,this._titleText.x-=100,t.to(this._titleText,.25,{alpha:1,x:this._titleText.x+100,ease:Sine.easeOut});for(var e=[0,1,2,5,8,7,6,3,4],i=0;i<e.length;++i)this._gridContainer.children[e[i]].scale=new PIXI.Point,t.to(this._gridContainer.children[e[i]].scale,.25,{x:1,y:1,ease:Back.easeOut},.25+.05*i);if(this._lakewoodLogoSprite.alpha=0,this._lakewoodLogoSprite.x-=100,t.to(this._lakewoodLogoSprite,.25,{alpha:1,x:this._lakewoodLogoSprite.x+100,ease:Sine.easeOut}),this._boxMoreLogoSprite.alpha=0,this._boxMoreLogoSprite.x+=100,t.to(this._boxMoreLogoSprite,.25,{alpha:1,x:this._boxMoreLogoSprite.x-100,ease:Sine.easeOut},"-=0.25"),a.savedData.isPlayerTicTacToeTurn?(this._boxManSprite.alpha=0,this._koSprite.alpha=0,this._koSprite.x=this._koSprite.xIni-100,t.to(this._koSprite,.25,{alpha:1,x:this._koSprite.x+100,ease:Sine.easeOut})):(this._koSprite.alpha=0,this._boxManSprite.alpha=0,this._boxManSprite.x=this._boxManSprite.xIni+100,t.to(this._boxManSprite,.25,{alpha:1,x:this._boxManSprite.x-100,ease:Sine.easeOut})),t.addLabel("uiAnimEnd"),a.savedData.isTutorial)t.call(function(){this._isInteractive=!0,this._messagePanel.signals.onContinue.addOnce(function(){this._messagePanel.hide()},this),this._messagePanel.show(a.assets.getJSON("languages").KO_POPUP_02[a.language])},null,this,"uiAnimEnd");else if(s.selectedLevel.result>s.LEVEL_TILE_STATE_PLAYABLE){var n=this._gridContainer.children[s.selectedLevel.tileIndex];n.interactive=!1;var r=new PIXI.Sprite(a.assets.getTexture(s.selectedLevel.result==s.LEVEL_TILE_STATE_LAKEWOOD?"lvl_select_Lakewood":"lvl_select_boxmore"));r.anchor=new PIXI.Point(.5,.5),r.x=n.x,r.y=n.y,r.alpha=0,this._gridContainer.addChildAt(r,s.selectedLevel.tileIndex);var o=new PIXI.Sprite(a.assets.getTexture(s.selectedLevel.result==s.LEVEL_TILE_STATE_LAKEWOOD?"lvl_select_Lakewood_icon":"lvl_select_boxmore_icon"));o.anchor=new PIXI.Point(.5,.5),o.scale=new PIXI.Point,r.addChild(o),t.to(n,.25,{alpha:0,ease:Sine.easeInOut,onComplete:function(t){this._gridContainer.removeChild(t)},onCompleteScope:this,onCompleteParams:[n]},"uiAnimEnd"),t.to(r,.25,{alpha:1,ease:Sine.easeInOut},"uiAnimEnd"),t.to(o.scale,.25,{x:1,y:1,ease:Back.easeOut}),t.call(this._checkTicTacToeGameOver,null,this,"+=0.75"),a.savedData.isPlayerTicTacToeTurn=!a.savedData.isPlayerTicTacToeTurn,a.savedData.arrLevelTile[s.selectedLevel.tileIndex]=s.selectedLevel.result,a.savedData.save(),s.selectedLevel.result=s.LEVEL_TILE_STATE_PLAYABLE}else a.savedData.isPlayerTicTacToeTurn?t.call(function(){this._isInteractive=!0},null,this):t.call(this._doBoxMorePick,null,this,"+=0.75");a.audio.playMusic("music_level_select_00")},n.prototype.resize=function(){r.prototype.resize.call(this),this._gameOverPanel.resize()},n.prototype._checkTicTacToeGameOver=function(){this._checkTicTacToeWinner(s.LEVEL_TILE_STATE_LAKEWOOD)?this._ticTacToeWinner=s.PLAYER_ID_PLAYER:(this._checkTicTacToeWinner(s.LEVEL_TILE_STATE_BOXMORE)||this._checkTicTacToeDraw())&&(this._ticTacToeWinner=s.PLAYER_ID_AI),null!=this._ticTacToeWinner?(this._gameOverPanel.visible=!0,this._gameOverPanel.show(this._ticTacToeWinner==s.PLAYER_ID_AI),a.audio.stopMusic()):a.savedData.isPlayerTicTacToeTurn?(this._boxManSprite.alpha=1,this._boxManSprite.x=this._boxManSprite.xIni,TweenMax.to(this._boxManSprite,.25,{alpha:0,x:this._boxManSprite.x+100,ease:Sine.easeOut}),this._koSprite.alpha=0,this._koSprite.x=this._koSprite.xIni-100,TweenMax.to(this._koSprite,.25,{alpha:1,x:this._koSprite.x+100,ease:Sine.easeOut}),this._isInteractive=!0):(this._koSprite.alpha=1,this._koSprite.x=this._koSprite.xIni,TweenMax.to(this._koSprite,.25,{alpha:0,x:this._koSprite.x-100,ease:Sine.easeOut}),this._boxManSprite.alpha=0,this._boxManSprite.x=this._boxManSprite.xIni+100,TweenMax.to(this._boxManSprite,.25,{alpha:1,x:this._boxManSprite.x-100,ease:Sine.easeOut}),this._doBoxMorePick())},n.prototype._checkTicTacToeWinner=function(t){for(var e=!1,i=3,n=0;n<i;++n){for(var s=0;s<i;++s){var r=a.savedData.arrLevelTile[n*i+s];if(r!=t)break;s==i-1&&(e=!0)}if(e)break}if(!e)for(var s=0;s<i;++s){for(var n=0;n<i;++n){var r=a.savedData.arrLevelTile[n*i+s];if(r!=t)break;n==i-1&&(e=!0)}if(e)break}if(!e)for(var n=0;n<i;++n){var r=a.savedData.arrLevelTile[n*(i+1)];if(r!=t)break;n==i-1&&(e=!0)}if(!e)for(var n=0;n<i;++n){var r=a.savedData.arrLevelTile[2*(n+1)];if(r!=t)break;n==i-1&&(e=!0)}return e},n.prototype._checkTicTacToeDraw=function(){for(var t=!0,e=3,i=0;i<e;++i){for(var n=0;n<e;++n){var r=a.savedData.arrLevelTile[i*e+n];if(r==s.LEVEL_TILE_STATE_BOXMORE)break;n==e-1&&(t=!1)}if(!t)break}if(t)for(var n=0;n<e;++n){for(var i=0;i<e;++i){var r=a.savedData.arrLevelTile[i*e+n];if(r==s.LEVEL_TILE_STATE_BOXMORE)break;i==e-1&&(t=!1)}if(!t)break}if(t)for(var i=0;i<e;++i){var r=a.savedData.arrLevelTile[i*(e+1)];if(r==s.LEVEL_TILE_STATE_BOXMORE)break;i==e-1&&(t=!1)}if(t)for(var i=0;i<e;++i){var r=a.savedData.arrLevelTile[2*(i+1)];if(r==s.LEVEL_TILE_STATE_BOXMORE)break;i==e-1&&(t=!1)}return t},n.prototype._initTicTacToeGrid=function(){for(var t=new p3.ButtonStates(a.assets.getTexture("lvl_select_free"),a.assets.getTexture("lvl_select_free"),a.assets.getTexture("lvl_select_free")),e=0;e<this.ROW_COUNT;++e)for(var i=0;i<this.COL_COUNT;++i){var n=e*this.ROW_COUNT+i,r=null;switch(a.savedData.arrLevelTile[n]){case s.LEVEL_TILE_STATE_PLAYABLE:r=new p3.Button(t),r.index=n,r.signals.click.add(this._onPlayLevel_Click,this),r.signals.over.add(function(t){if(this._isInteractive){var e=new TimelineMax;t.scale=new PIXI.Point(1,1),e.to(t.scale,.1,{x:1.2,y:1.2,ease:Sine.easeOut}).to(t.scale,.25,{x:1,y:1,ease:Back.easeOut})}},this);break;case s.LEVEL_TILE_STATE_LAKEWOOD:r=new PIXI.Sprite(a.assets.getTexture("lvl_select_Lakewood"));var o=new PIXI.Sprite(a.assets.getTexture("lvl_select_Lakewood_icon"));o.anchor=new PIXI.Point(.5,.5),r.addChild(o);break;case s.LEVEL_TILE_STATE_BOXMORE:r=new PIXI.Sprite(a.assets.getTexture("lvl_select_boxmore"));var o=new PIXI.Sprite(a.assets.getTexture("lvl_select_boxmore_icon"));o.anchor=new PIXI.Point(.5,.5),r.addChild(o)}r.anchor=new PIXI.Point(.5,.5),r.x=125+253*i,r.y=105+200*e,this._gridContainer.addChild(r)}},n.prototype._doBoxMorePick=function(){this._isInteractive=!1;var t=this._ticTacToeAI.findBestTile();s.selectedLevel.id=a.assets.getJSON("levels").layout[t],s.selectedLevel.tileIndex=t,this._boxMorePickSprite.x=this._gridContainer.x+this._gridContainer.children[t].x+100,this._boxMorePickSprite.y=this._gridContainer.y+this._gridContainer.children[t].y+100,this._boxMorePickSprite.visible=!0,this._boxMorePickSprite.scale=new PIXI.Point;var e=new TimelineMax;e.to(this._gridContainer.children[t].scale,.1,{x:1.2,y:1.2,ease:Sine.easeOut}),e.to(this._gridContainer.children[t].scale,.25,{x:1,y:1,ease:Back.easeOut}),e.to(this._boxMorePickSprite.scale,.5,{x:1.5,y:-1.5,ease:Back.easeOut},"-=0.35"),e.to(this._boxMorePickSprite,.75,{x:this._boxMorePickSprite.x-50,y:this._boxMorePickSprite.y-50,ease:Back.easeInOut},"+=0.5"),e.to(this._boxMorePickSprite.scale,.75,{x:1,y:-1,ease:Back.easeInOut},"-=0.75"),e.call(function(){a.main.application.loadScene(s.SCENE_ID_CHAR_SELECTION)},null,this)},n.prototype._onGameOverPanel_Hidden=function(){this._gameOverPanel.visible=!1,this._initTicTacToeGrid();for(var t=[0,1,2,5,8,7,6,3,4],e=new TimelineMax,i=0;i<t.length;++i)e.to(this._gridContainer.children[t[i]],.25,{alpha:0,ease:Sine.easeInOut},.25+.05*i),this._gridContainer.children[t.length+t[i]].scale=new PIXI.Point,e.to(this._gridContainer.children[t.length+t[i]].scale,.25,{x:1,y:1,ease:Back.easeOut},.25+.05*i);e.call(function(){this._isInteractive=!0;var t=!0,e=!1,i=void 0;try{for(var n,a=this._gridContainer.children[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;if(1==s.alpha)break;this._gridContainer.removeChildAt(0)}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}},null,this),this._ticTacToeWinner==s.PLAYER_ID_AI&&e.call(function(){this._messagePanel.signals.onContinue.addOnce(function(){this._messagePanel.hide()},this),this._messagePanel.show(a.assets.getJSON("languages").KO_POPUP_01[a.language])},null,this),a.audio.playMusic("music_level_select_00")},n.prototype._onGameOverPanel_Closed=function(){this._isInteractive=!1,this._gameOverPanel.signals.onHidden.addOnce(this._onGameOverPanel_Hidden,this),this._gameOverPanel.hide()},n.prototype._onPlayLevel_Click=function(t){this._isInteractive&&(s.selectedLevel.id=a.assets.getJSON("levels").layout[t.index],s.selectedLevel.tileIndex=t.index,a.savedData.isTutorial?(this._messagePanel.signals.onContinue.addOnce(function(){a.main.application.loadScene(s.SCENE_ID_TUTORIAL)},this),this._messagePanel.show(a.assets.getJSON("languages").KO_POPUP_00[a.language]),this._messagePanel.visible=!0):a.main.application.loadScene(s.SCENE_ID_CHAR_SELECTION))}},{"../Common":6,"../CommonGame":7,"../ui/UILevelTile":55,"../ui/overlays/GameOverPanel":62,"../ui/overlays/MessagePanel":67,"./MiniCarGenerator":45,"./SimpleScene":48,"./ticTacToe/TicTacToeAI":50}],44:[function(t,e,i){"use strict";function n(){r.call(this),this._cnLogoSprite=null,this._titleContainer=null,this._titleSprite=null,this._titleBgSprite=null,this._titleFgSprite=null,this._playBtn=null,this._charContainer=null}var a=t("../Common"),s=t("../CommonGame"),r=t("./SimpleScene");t("../ui/overlays/MessagePanel");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("splash_bg")),this._bgSprite.scale.x=1.85546875,r.prototype.init.call(this),this._charContainer=new PIXI.Container,this._charContainer.x=.5*a.STAGE_WIDTH,this._charContainer.y=.5*a.STAGE_HEIGHT+200,this.addChild(this._charContainer);var t=new PIXI.Sprite(a.assets.getTexture("splash_dino_003"));t.anchor=new PIXI.Point(.5,.5),t.position.x=.5*a.STAGE_WIDTH-300,t.position.y=60,this.addChild(t),TweenMax.to(t,1,{y:t.y+30,ease:Sine.easeInOut,repeat:-1,yoyo:!0});var e=new PIXI.Sprite(a.assets.getTexture("splash_dino_001"));e.anchor=new PIXI.Point(.5,1),e.x=.5*a.STAGE_WIDTH-800,e.y=.5*a.STAGE_HEIGHT+350,this.addChild(e),TweenMax.to(e.scale,.25,{x:.99,y:.99,ease:Sine.easeInOut,repeat:-1,yoyo:!0});var i=new PIXI.Sprite(a.assets.getTexture("splash_dino_002"));i.anchor=new PIXI.Point(.5,1),i.x=.5*a.STAGE_WIDTH+150,i.y=.5*a.STAGE_HEIGHT+380,this.addChild(i),TweenMax.to(i.scale,.25,{x:.99,y:.99,ease:Sine.easeInOut,repeat:-1,yoyo:!0}),this._titleContainer=new PIXI.Container,this._titleContainer.x=.5*a.STAGE_WIDTH,this.addChild(this._titleContainer),this._titleBgSprite=new PIXI.Sprite(a.assets.getTexture("splash_title_back")),this._titleBgSprite.anchor=new PIXI.Point(.5,.5),this._titleContainer.addChild(this._titleBgSprite),this._titleSprite=new PIXI.Sprite(a.assets.getTexture("splash_title")),this._titleSprite.anchor=new PIXI.Point(.5,.5),this._titleContainer.addChild(this._titleSprite),this._titleContainer.y=.5*this._titleSprite.height,this._titleFgSprite=new PIXI.Sprite(a.assets.getTexture("splash_title_front")),this._titleFgSprite.anchor=new PIXI.Point(.5,.5),this._titleContainer.addChild(this._titleFgSprite);var n=new PIXI.extras.BitmapText(a.assets.getJSON("languages").SPLASH_TITLE[a.language].toUpperCase(),{font:"70px ed_76_gradient",align:"center"});n.anchor=new PIXI.Point(.5,.5),n.position.x=-20,n.position.y=82,this._titleSprite.addChild(n);var s=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("icon_primary_play_off"));s.iconOver=a.assets.getTexture("icon_primary_play_over"),s.iconDown=a.assets.getTexture("icon_primary_play_down"),this._playBtn=new p3.Button(s),this._playBtn.anchor=new PIXI.Point(.5,.5),this._playBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH,a.STAGE_HEIGHT-150),this._playBtn.signals.click.addOnce(this._onPlayButton_Click,this),this.addChild(this._playBtn),this._cnLogoSprite=new PIXI.Sprite(a.assets.getTexture("splash_cn_logo")),this._cnLogoSprite.anchor=new PIXI.Point(1,1),this._cnLogoSprite.y=a.STAGE_HEIGHT,this.addChild(this._cnLogoSprite),r.prototype.createSharedControls.call(this),this._uiTopBarSharedControls.homeBtn.visible=!1,this._uiTopBarSharedControls.infoBtn.visible=!0},n.prototype.update=function(){},n.prototype.animateIn=function(){this._titleContainer.scale=new PIXI.Point,this._playBtn.x-=100,this._playBtn.alpha=0;var t=new TimelineMax;t.to(this._titleContainer.scale,.25,{x:1,y:1,ease:Back.easeOut,onComplete:function(){TweenMax.to(this._titleFgSprite.scale,.5,{x:.98,y:.98,ease:Sine.easeInOut,repeat:-1,yoyo:!0})},onCompleteScope:this},.25).to(this._playBtn,.25,{alpha:1,x:this._playBtn.x+100,ease:Sine.easeOut,onComplete:function(){TweenMax.to(this._playBtn.scale,.25,{x:.97,y:.97,ease:Sine.easeInOut,repeat:-1,yoyo:!0,delay:.6})},onCompleteScope:this}),this._animateInCharacters(),a.audio.playMusic("music_main_menu_theme_00")},n.prototype.resize=function(){r.prototype.resize.call(this),this._cnLogoSprite.x=Math.min(a.STAGE_WIDTH,.5*a.STAGE_WIDTH+.5*p3.View.width)},n.prototype._animateInCharacters=function(){var t=[{spriteId:"r_001",position:new PIXI.Point(100,100),orientation:-1},{spriteId:"l_001",position:new PIXI.Point((-100),110),orientation:1},{spriteId:"r_002",position:new PIXI.Point(150,120),orientation:-1},{spriteId:"l_002",position:new PIXI.Point((-180),130),orientation:1},{spriteId:"r_003",position:new PIXI.Point(300,140),orientation:-1},{spriteId:"l_003",position:new PIXI.Point((-400),150),orientation:1},{spriteId:"r_004",position:new PIXI.Point(240,160),orientation:-1},{spriteId:"l_004",position:new PIXI.Point((-230),170),orientation:1},{spriteId:"r_005",position:new PIXI.Point(300,180),orientation:-1},{spriteId:"l_005",position:new PIXI.Point((-500),190),orientation:1},{spriteId:"r_006",
position:new PIXI.Point(500,200),orientation:-1}],e=0,i=100,n=.5,s=!0,r=!1,o=void 0;try{for(var h,_=t[Symbol.iterator]();!(s=(h=_.next()).done);s=!0){var l=h.value,c=new PIXI.Sprite(a.assets.getTexture("splash_char_"+l.spriteId));c.anchor=new PIXI.Point(.5,1),c.x=l.position.x,c.y=l.position.y,this._charContainer.addChild(c),c.x+=i*-l.orientation,c.alpha=0,TweenMax.to(c,.3,{x:c.x+(1==l.orientation?i:-i),ease:Back.easeOut,onComplete:function(t){TweenMax.to(this._charContainer.children[t].scale,.25+Math.random()+.25,{x:.99,y:.995,ease:Sine.easeOut,yoyo:!0,repeat:-1,delay:.5*Math.random()+.5})},onCompleteScope:this,onCompleteParams:[e],delay:n+.05*e}),TweenMax.to(c,.3,{alpha:1,ease:Sine.easeInOut,delay:n+.05*e}),++e}}catch(t){r=!0,o=t}finally{try{!s&&_.return&&_.return()}finally{if(r)throw o}}},n.prototype._onPlayButton_Click=function(){a.savedData.hasSeenIntro?a.main.application.loadScene(s.SCENE_ID_LEVEL_SELECTION):a.main.application.loadScene(s.SCENE_ID_INTRO),a.audio.stopMusic(),a.audio.playSound("music_menu_playbtn_start_00")}},{"../Common":6,"../CommonGame":7,"../ui/overlays/MessagePanel":67,"./SimpleScene":48}],45:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._verticalDistance=-1,this._laneDistance=-1,this.CAR_SPAWN_MIN_PERIOD=.5,this.CAR_SPAWN_MAX_PERIOD=4,this.ARR_CAR_COLOUR=[16777215,16711680,65280,255,0]}var a=t("../Common");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(t,e){this._verticalDistance=t,this._laneDistance=e,this._requestMiniCar(1),this._requestMiniCar(-1)},n.prototype._requestMiniCar=function(t){TweenMax.delayedCall(this.CAR_SPAWN_MIN_PERIOD+(this.CAR_SPAWN_MAX_PERIOD-this.CAR_SPAWN_MIN_PERIOD)*Math.random(),this._spawnMiniCar,[t],this)},n.prototype._spawnMiniCar=function(t){var e=new PIXI.Sprite(a.assets.getTexture("lvl_select_car_00"+a.randomIntFromInterval(1,5).toString()));e.tint=16777215*Math.random(),e.x=t*this._laneDistance,e.y=t==-1?-this._verticalDistance:0,e.scale.y=-t,e.anchor=new PIXI.Point(.5,.5),this.addChild(e),TweenMax.to(e,10,{y:t==-1?0:-this._verticalDistance,ease:Linear.easeInOut,onComplete:function(){this.parent.removeChild(this)},onCompleteScope:e}),TweenMax.to(e,2+3*Math.random(),{x:e.x-3*t,ease:Sine.easeInOut,repeat:-1,yoyo:!0}),this._requestMiniCar(t)}},{"../Common":6}],46:[function(t,e,i){"use strict";function n(){this.loaded=0,this._isPlayingAnim=!1,this._logoAnimation=null,this._bg=null,this._bar=null,this._barOverlay=null,this._text=null,this._playButton=null,p3.Scene.call(this),this.signals.onAllLoaded=new signals.Signal}var a=t("../Common");e.exports=n,n.prototype=Object.create(p3.Scene.prototype),n.prototype.constructor=n,n.prototype.init=function(){var t=new PIXI.Container;t.x=Math.floor(.5*a.STAGE_WIDTH),t.y=Math.floor(.5*a.STAGE_HEIGHT),this.addChild(t),this._bg=new PIXI.Sprite(a.assets.getTexture("preloader_bg")),this._bg.anchor=new PIXI.Point(.5,.5),t.addChild(this._bg),this._bar=new PIXI.Sprite(a.assets.getTexture("preloader_fill")),this._bar.anchor=new PIXI.Point(.5,.5),t.addChild(this._bar),this._barOverlay=new PIXI.Sprite(a.assets.getTexture("preloader_overlay")),this._barOverlay.anchor=new PIXI.Point(.5,.5),this._barOverlay.x-=250,this._barOverlay.y+=160,t.addChild(this._barOverlay),this._bar.x=this._barOverlay.x-300,this._bar.y=this._barOverlay.y,this._text=new PIXI.Text("0%",{font:"28px Arial",fill:"#FFFFFF"}),this._text.anchor=new PIXI.Point(.5,.5),this._text.y=this._barOverlay.y+100,t.addChild(this._text);var e=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("icon_primary_play_off"));e.iconOver=a.assets.getTexture("icon_primary_play_over"),e.iconDown=a.assets.getTexture("icon_primary_play_down"),this._playButton=new p3.Button(e),this._playButton.y+=200,this._playButton.downSoundName="music_menu_playbtn_start_00",this._playButton.visible=!1,this._playButton.signals.click.add(this._onPlayButtonClick,this),t.addChild(this._playButton)},n.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this)},n.prototype.appear=function(){this.animateIn()},n.prototype.show=function(){},n.prototype.animateIn=function(t,e){},n.prototype.animateOut=function(t,e){},n.prototype.resize=function(){this.x=.5*(p3.View.width-a.STAGE_WIDTH)},n.prototype.update=function(){this._bar.x=this._barOverlay.x-300+550*this.loaded,this._text.text=Math.ceil(100*this.loaded)+"%",1==this.loaded&&(p3.Device.isMobile?this._playButton.visible||(this._playButton.visible=!0,this._bar.visible=!1,this._barOverlay.visible=!1,this._text.visible=!1,this._playButton.alpha=0,this._playButton.x-=50,TweenMax.to(this._playButton,.25,{x:this._playButton.x+50,alpha:1,ease:Sine.easeOut})):this.signals.onAllLoaded.dispatch(this))},n.prototype._onPlayButtonClick=function(t){this._playButton.interactive=!1,p3.Device.isAndroid&&screenfull.enabled&&(screenfull.request(),setTimeout(function(){a.view.resize()},1e3)),TweenMax.to(this._playButton,.25,{x:this._playButton.x-50,alpha:0,ease:Sine.easeIn,onComplete:this.signals.onAllLoaded.dispatch,onCompleteScope:this})}},{"../Common":6}],47:[function(t,e,i){"use strict";function n(){r.call(this),this._selectedItemIndex=0,this._arrItemInfo=[],this._titleText=null,this._nextItemBtn=null,this._prevItemBtn=null,this._nextItem=null,this._nextNextItem=null,this._selectedItem=null,this._prevItem=null,this._prevPrevItem=null,this._incomingItem=null,this._itemContainer=null,this._infoBg=null,this._infoText=null,this._charNameText=null,this._infoContainer=null,this._timeline=null,this.ARR_ITEM_POSITION=[new PIXI.Point((-260),0),new PIXI.Point((-130),0),new PIXI.Point(0,0),new PIXI.Point(130,0),new PIXI.Point(260,0)],this.CLOSE_SCALE_FACTOR=.7,this.FAR_SCALE_FACTOR=.4}var a=t("../Common"),s=t("../CommonGame"),r=t("./SimpleScene"),o=t("../ColorFillFilter");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("choose_bg")),r.prototype.init.call(this),this._itemContainer=new PIXI.Container,this._itemContainer.x=.5*a.STAGE_WIDTH,this._itemContainer.y=.5*a.STAGE_HEIGHT-40,this.addChild(this._itemContainer),this._timeline=new TimelineMax;var t=a.assets.getJSON("enemyCharacters").enemyCharacters,e=!0,i=!1,n=void 0;try{for(var h,_=t[Symbol.iterator]();!(e=(h=_.next()).done);e=!0){var l=h.value;this._arrItemInfo.push({fullName:l.fullName,spriteId:"battle_char_"+l.spritePrefix,info:a.assets.getJSON("languages")[l.spritePrefix.toUpperCase()+"_INFO"][a.language]})}}catch(t){i=!0,n=t}finally{try{!e&&_.return&&_.return()}finally{if(i)throw n}}this._selectedItemIndex=this._arrItemInfo.length;var c=a.assets.getJSON("playerCharacters").playerCharacters,p=!0,u=!1,d=void 0;try{for(var I,T=c[Symbol.iterator]();!(p=(I=T.next()).done);p=!0){var m=I.value;this._arrItemInfo.push({fullName:m.fullName,spriteId:"battle_char_"+m.spritePrefix,info:a.assets.getJSON("languages")[m.spritePrefix.toUpperCase()+"_INFO"][a.language]})}}catch(t){u=!0,d=t}finally{try{!p&&T.return&&T.return()}finally{if(u)throw d}}this._incomingItem=new PIXI.Sprite(a.blankTexture),this._incomingItem.anchor=new PIXI.Point(.5,.5),this._incomingItem.filters=[new o(2775691)],this._itemContainer.addChild(this._incomingItem),this._prevPrevItem=new PIXI.Sprite(a.assets.getTexture(this._arrItemInfo[this._selectedItemIndex-2].spriteId)),this._prevPrevItem.scale=new PIXI.Point(this.FAR_SCALE_FACTOR,this.FAR_SCALE_FACTOR),this._prevPrevItem.anchor=new PIXI.Point(.5,.5),this._prevPrevItem.position=new PIXI.Point(this.ARR_ITEM_POSITION[0].x,this.ARR_ITEM_POSITION[0].y),this._prevPrevItem.filters=[new o(2775691)],this._itemContainer.addChild(this._prevPrevItem),this._nextNextItem=new PIXI.Sprite(a.assets.getTexture(this._arrItemInfo[this._selectedItemIndex+2].spriteId)),this._nextNextItem.scale=new PIXI.Point(this.FAR_SCALE_FACTOR,this.FAR_SCALE_FACTOR),this._nextNextItem.anchor=new PIXI.Point(.5,.5),this._nextNextItem.position=new PIXI.Point(this.ARR_ITEM_POSITION[4].x,this.ARR_ITEM_POSITION[4].y),this._nextNextItem.filters=[new o(2775691)],this._itemContainer.addChild(this._nextNextItem),this._prevItem=new PIXI.Sprite(a.assets.getTexture(this._arrItemInfo[this._selectedItemIndex-1].spriteId)),this._prevItem.scale=new PIXI.Point(this.CLOSE_SCALE_FACTOR,this.CLOSE_SCALE_FACTOR),this._prevItem.anchor=new PIXI.Point(.5,.5),this._prevItem.position=new PIXI.Point(this.ARR_ITEM_POSITION[1].x,this.ARR_ITEM_POSITION[1].y),this._prevItem.filters=[new o(4596571)],this._itemContainer.addChild(this._prevItem),this._nextItem=new PIXI.Sprite(a.assets.getTexture(this._arrItemInfo[this._selectedItemIndex+1].spriteId)),this._nextItem.scale=new PIXI.Point(this.CLOSE_SCALE_FACTOR,this.CLOSE_SCALE_FACTOR),this._nextItem.anchor=new PIXI.Point(.5,.5),this._nextItem.position=new PIXI.Point(this.ARR_ITEM_POSITION[3].x,this.ARR_ITEM_POSITION[3].y),this._nextItem.filters=[new o(4596571)],this._itemContainer.addChild(this._nextItem),this._selectedItem=new PIXI.Sprite(a.assets.getTexture(this._arrItemInfo[this._selectedItemIndex].spriteId)),this._selectedItem.anchor=new PIXI.Point(.5,.5),this._selectedItem.position=new PIXI.Point(this.ARR_ITEM_POSITION[2].x,this.ARR_ITEM_POSITION[2].y),this._itemContainer.addChild(this._selectedItem);var y=a.assets.getJSON("languages").SHOW_INFO[a.language].toUpperCase();this._titleText=new PIXI.extras.BitmapText(y,{font:"100px ed_110_gradient",align:"center"}),this._titleText.anchor=new PIXI.Point(.5,.5),this._titleText.position.x=.5*a.STAGE_WIDTH,this._titleText.position.y=this._titleText.height,this.addChild(this._titleText);var g=new p3.ButtonStates(a.assets.getTexture("btn_next_off"),a.assets.getTexture("btn_next_over"),a.assets.getTexture("btn_next_down"));this._nextItemBtn=new p3.Button(g),this._nextItemBtn.anchor=new PIXI.Point(.5,.5),this._nextItemBtn.position.x=.5*(a.STAGE_WIDTH+1024-this._nextItemBtn.width),this._nextItemBtn.position.y=.5*a.STAGE_HEIGHT,this._nextItemBtn.signals.click.add(this._onNextItemButton_Click,this),this.addChild(this._nextItemBtn),g=new p3.ButtonStates(a.assets.getTexture("btn_back_off"),a.assets.getTexture("btn_back_over"),a.assets.getTexture("btn_back_down")),this._prevItemBtn=new p3.Button(g),this._prevItemBtn.anchor=new PIXI.Point(.5,.5),this._prevItemBtn.position.x=.5*(a.STAGE_WIDTH-1024+this._nextItemBtn.width),this._prevItemBtn.position.y=.5*a.STAGE_HEIGHT,this._prevItemBtn.signals.click.add(this._onPrevItemButton_Click,this),this.addChild(this._prevItemBtn),this._infoContainer=new PIXI.Container,this._infoContainer.x=.5*a.STAGE_WIDTH,this._infoContainer.y=.5*a.STAGE_HEIGHT+300,this.addChild(this._infoContainer),this._infoBg=new PIXI.Sprite(a.assets.getTexture("tutorial_panel")),this._infoBg.anchor=new PIXI.Point(.5,.5),this._infoBg.height=160,this._infoBg.width=924,this._infoContainer.addChild(this._infoBg),this._charNameText=new PIXI.extras.BitmapText("aaa",{font:"50px ed_110_gradient",align:"center"}),this._charNameText.anchor=new PIXI.Point(.5,.5),this._charNameText.y=.5*-this._infoBg.height-5,this._infoContainer.addChild(this._charNameText),this._infoText=new PIXI.Text("aaa",{font:"28px Arial",fill:"#000000",align:"center",cacheAsBitmap:!0,wordWrap:!0,wordWrapWidth:.9*this._infoBg.width}),this._infoText.anchor=new PIXI.Point(.5,.5),this._infoContainer.addChild(this._infoText),r.prototype.createSharedControls.call(this),this._uiTopBarSharedControls.homeBtn.visible=!1,this._uiTopBarSharedControls.backBtn.visible=!0,this._uiTopBarSharedControls.signals.onBackBtn_Click.addOnce(function(){a.main.application.loadScene(s.SCENE_ID_MAIN)},this),this._updateUI()},n.prototype.animateIn=function(){this._titleText.alpha=0,this._titleText.x-=100,this._nextItemBtn.scale=new PIXI.Point,this._prevItemBtn.scale=new PIXI.Point,this._selectedItem.scale=new PIXI.Point,this._nextItem.scale=new PIXI.Point,this._nextNextItem.scale=new PIXI.Point,this._prevItem.scale=new PIXI.Point,this._prevPrevItem.scale=new PIXI.Point,this._infoContainer.alpha=0,this._infoContainer.x-=100;var t=new TimelineMax;t.to(this._titleText,.25,{alpha:1,x:this._titleText.x+100,ease:Sine.easeOut}),t.to(this._selectedItem.scale,.25,{x:1,y:1,ease:Sine.easeOut},.1),t.to(this._nextItem.scale,.25,{x:this.CLOSE_SCALE_FACTOR,y:this.CLOSE_SCALE_FACTOR,ease:Sine.easeOut},.2),t.to(this._prevItem.scale,.25,{x:this.CLOSE_SCALE_FACTOR,y:this.CLOSE_SCALE_FACTOR,ease:Sine.easeOut},.2),t.to(this._nextNextItem.scale,.25,{x:this.FAR_SCALE_FACTOR,y:this.FAR_SCALE_FACTOR,ease:Sine.easeOut},.3),t.to(this._prevPrevItem.scale,.25,{x:this.FAR_SCALE_FACTOR,y:this.FAR_SCALE_FACTOR,ease:Sine.easeOut},.3),t.to(this._nextItemBtn.scale,.25,{x:1,y:1,ease:Sine.easeOut},.4),t.to(this._prevItemBtn.scale,.25,{x:1,y:1,ease:Sine.easeOut},.4),t.to(this._infoContainer,.25,{alpha:1,x:this._infoContainer.x+100,ease:Sine.easeInOut},.5),a.audio.playMusic("music_level_select_00")},n.prototype._updateUI=function(){this._charNameText.text=this._arrItemInfo[this._selectedItemIndex].fullName.toUpperCase(),this._infoText.text=this._arrItemInfo[this._selectedItemIndex].info},n.prototype._animateInfoContainer=function(t){this._infoContainer.alpha=0,this._infoContainer.x=-100*t+.5*a.STAGE_WIDTH,TweenMax.to(this._infoContainer,.25,{alpha:1,x:.5*a.STAGE_WIDTH,ease:Sine.easeOut})},n.prototype._animateCarousel=function(t){var e=t==-1?this._nextNextItem:this._prevPrevItem,i=t==-1?this._prevItem:this._nextItem,n=t==-1?this._prevPrevItem:this._nextNextItem,s=t==-1?this._nextItem:this._prevItem,r=this._selectedItemIndex+2*t;if(r<0?r+=this._arrItemInfo.length:r>=this._arrItemInfo.length&&(r-=this._arrItemInfo.length),this._incomingItem.visible=!0,this._incomingItem.texture=a.assets.getTexture(this._arrItemInfo[r].spriteId),this._incomingItem.width=this._incomingItem.texture.width,this._incomingItem.height=this._incomingItem.texture.height,this._incomingItem.position=new PIXI.Point(this.ARR_ITEM_POSITION[t==-1?0:4].x,this.ARR_ITEM_POSITION[t==-1?0:4].y),this._incomingItem.scale=new PIXI.Point,TweenMax.to(this._incomingItem.scale,.25,{x:this.FAR_SCALE_FACTOR,y:this.FAR_SCALE_FACTOR,ease:Sine.easeOut}),TweenMax.to(i.position,.25,{x:this.ARR_ITEM_POSITION[2].x,y:this.ARR_ITEM_POSITION[2].y,ease:Sine.easeOut}),TweenMax.to(i.scale,.25,{x:1,y:1,ease:Sine.easeOut}),TweenMax.to(this._selectedItem.position,.25,{x:this.ARR_ITEM_POSITION[t==-1?3:1].x,y:this.ARR_ITEM_POSITION[t==-1?3:1].y,ease:Sine.easeOut}),TweenMax.to(this._selectedItem.scale,.25,{x:this.CLOSE_SCALE_FACTOR,y:this.CLOSE_SCALE_FACTOR,ease:Sine.easeOut}),TweenMax.to(n.position,.25,{x:this.ARR_ITEM_POSITION[t==-1?1:3].x,y:this.ARR_ITEM_POSITION[t==-1?1:3].y,ease:Sine.easeOut}),TweenMax.to(n.scale,.25,{x:this.CLOSE_SCALE_FACTOR,y:this.CLOSE_SCALE_FACTOR,ease:Sine.easeOut}),TweenMax.to(s.position,.25,{x:this.ARR_ITEM_POSITION[t==-1?4:0].x,y:this.ARR_ITEM_POSITION[t==-1?4:0].y,ease:Sine.easeOut}),TweenMax.to(s.scale,.25,{x:this.FAR_SCALE_FACTOR,y:this.FAR_SCALE_FACTOR,ease:Sine.easeOut}),TweenMax.to(e.scale,.25,{x:0,y:0,ease:Sine.easeOut}),t==-1){var h=this._nextNextItem;this._nextNextItem=this._nextItem,this._nextItem=this._selectedItem,this._selectedItem=this._prevItem,this._prevItem=this._prevPrevItem,this._prevPrevItem=this._incomingItem,this._incomingItem=h}else{var h=this._prevPrevItem;this._prevPrevItem=this._prevItem,this._prevItem=this._selectedItem,this._selectedItem=this._nextItem,this._nextItem=this._nextNextItem,this._nextNextItem=this._incomingItem,this._incomingItem=h}this._itemContainer.setChildIndex(this._incomingItem,0),this._itemContainer.setChildIndex(this._nextNextItem,1),this._itemContainer.setChildIndex(this._prevPrevItem,2),this._itemContainer.setChildIndex(this._nextItem,3),this._itemContainer.setChildIndex(this._prevItem,4),this._itemContainer.setChildIndex(this._selectedItem,5),this._incomingItem.filters=[new o(2775691)],this._nextNextItem.filters=[new o(2775691)],this._prevPrevItem.filters=[new o(2775691)],this._nextItem.filters=[new o(4596571)],this._prevItem.filters=[new o(4596571)],this._selectedItem.filters=[]},n.prototype._onNextItemButton_Click=function(){++this._selectedItemIndex,this._selectedItemIndex>=this._arrItemInfo.length&&(this._selectedItemIndex-=this._arrItemInfo.length),this._updateUI(),this._animateCarousel(1),this._animateInfoContainer(1),a.audio.playSound("sfx_btn_press_fwd_00")},n.prototype._onPrevItemButton_Click=function(){--this._selectedItemIndex,this._selectedItemIndex<0&&(this._selectedItemIndex+=this._arrItemInfo.length),this._updateUI(),this._animateCarousel(-1),this._animateInfoContainer(-1),a.audio.playSound("sfx_btn_press_back_00")}},{"../ColorFillFilter":5,"../Common":6,"../CommonGame":7,"./SimpleScene":48}],48:[function(t,e,i){"use strict";function n(){p3.Scene.call(this),this._uiTopBarSharedControls=null,this._bgSprite=null}var a=t("../Common"),s=(t("../CommonGame"),t("../ui/UITopBarSharedControls"));e.exports=n,n.prototype=Object.create(p3.Scene.prototype),n.prototype.constructor=n,n.prototype.init=function(){p3.Scene.prototype.init.call(this),null!=this._bgSprite&&(this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgSprite))},n.prototype.createSharedControls=function(){this._uiTopBarSharedControls=new s,this._uiTopBarSharedControls.init(),this.addChild(this._uiTopBarSharedControls)},n.prototype.resize=function(){this.x=.5*(p3.View.width-a.STAGE_WIDTH),this._uiTopBarSharedControls.resize()},n.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this)},n.prototype.animateIn=function(t,e){},n.prototype.hide=function(t,e){a.audio.stopMusic()}},{"../Common":6,"../CommonGame":7,"../ui/UITopBarSharedControls":58}],49:[function(t,e,i){"use strict";function n(){r.call(this),this._confirmationPanel=null,this._backBtn=null,this._muteBtn=null}var a=t("../Common"),s=t("../CommonGame"),r=t("./GamePlayScene"),o=t("../game/TutorialGame"),h=(t("../game/world/MyGrid"),t("../ui/overlays/ConfirmationPanel"));e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.init=function(){r.prototype.init.call(this,9),a.game=new o,a.game.scene=this,a.game.init(),a.game.signals.onGameOver.addOnce(this._onGameOver,this),this.addChild(this._combatLayer);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_side_off"),a.assets.getTexture("btn_primary_side_over"),a.assets.getTexture("btn_primary_side_down"),a.assets.getTexture(a.isMute?"icon_primary_mute_off":"icon_primary_sound_off"));t.iconOver=a.assets.getTexture(a.isMute?"icon_primary_mute_over":"icon_primary_sound_over"),t.iconDown=a.assets.getTexture(a.isMute?"icon_primary_mute_down":"icon_primary_sound_down"),this._muteBtn=new p3.Button(t),this._muteBtn.anchor=new PIXI.Point(.5,.5),this._muteBtn.position.y=.5*this._muteBtn.height,this._muteBtn.signals.click.add(this._onMuteButton_Click,this),this.addChild(this._muteBtn),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_side_off"),a.assets.getTexture("btn_primary_side_over"),a.assets.getTexture("btn_primary_side_down"),a.assets.getTexture("icon_primary_previous_off")),t.iconOver=a.assets.getTexture("icon_primary_previous_over"),t.iconDown=a.assets.getTexture("icon_primary_previous_down"),this._backBtn=new p3.Button(t),this._backBtn.anchor=new PIXI.Point(.5,.5),this._backBtn.scale=new PIXI.Point((-1),1),this._backBtn.position.y=this._muteBtn.position.y,this._backBtn.signals.click.add(this._onBackButton_Click,this),this._backBtn._icon.scale.x=-1,this.addChild(this._backBtn),this._confirmationPanel=new h,this._confirmationPanel.init(),this.addChild(this._confirmationPanel),this._confirmationPanel.signals.onNo.add(function(){a.game.resume(),this._confirmationPanel.hide(),this._confirmationPanel.signals.onYes.removeAll()},this)},n.prototype.resize=function(){this.x=.5*(p3.View.width-a.STAGE_WIDTH),this._muteBtn.position.x=a.getButtonPositionRight(0),this._backBtn.position.x=a.getButtonPositionLeft(0)},n.prototype._onMuteButton_Click=function(){a.isMute=!a.isMute,this._muteBtn._icon.texture=a.assets.getTexture(a.isMute?"icon_primary_mute_off":"icon_primary_sound_off"),this._muteBtn._currentIconTexture=this._muteBtn._icon.texture,this._muteBtn._currentIconOverTexture=a.assets.getTexture(a.isMute?"icon_primary_mute_over":"icon_primary_sound_over"),this._muteBtn._currentIconDownTexture=a.assets.getTexture(a.isMute?"icon_primary_mute_down":"icon_primary_sound_down"),a.audio.mute(a.isMute)},n.prototype._onBackButton_Click=function(){a.game.pause(),this._confirmationPanel.show(a.assets.getJSON("languages").CONFIRMATION[a.language].toUpperCase()),this._confirmationPanel.signals.onYes.addOnce(function(){this._confirmationPanel.hide(),a.game.music.stop(),this._onGameOver()},this)},n.prototype._onGameOver=function(){a.main.application.loadScene(s.SCENE_ID_CHAR_SELECTION),a.savedData.isTutorial=!1,a.savedData.save()}},{"../Common":6,"../CommonGame":7,"../game/TutorialGame":15,"../game/world/MyGrid":33,"../ui/overlays/ConfirmationPanel":61,"./GamePlayScene":40}],50:[function(t,e,i){"use strict";function n(){this.COL_COUNT=3,this.ROW_COUNT=3,this.VICTORY_SCORE=1e3,this.SEQUENCE_SCORE=100}var a=t("../../Common"),s=t("../../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.findBestTile=function(){for(var t=[null,null,null,null,null,null,null,null,null],e=[],i=0,n=0,r=0;r<this.ROW_COUNT;++r){e=[],i=0,n=0;for(var o=0;o<this.COL_COUNT;++o){var h=r*this.ROW_COUNT+o;switch(a.savedData.arrLevelTile[h]){case s.LEVEL_TILE_STATE_BOXMORE:++n;break;case s.LEVEL_TILE_STATE_LAKEWOOD:++i;break;case s.LEVEL_TILE_STATE_PLAYABLE:null==t[h]&&(t[h]=0),e.push(h)}}var _=!0,l=!1,c=void 0;try{for(var p,u=e[Symbol.iterator]();!(_=(p=u.next()).done);_=!0){var d=p.value;t[d]+=this._findTileScore(i,n)}}catch(t){l=!0,c=t}finally{try{!_&&u.return&&u.return()}finally{if(l)throw c}}}for(var r=0;r<this.COL_COUNT;++r){e=[],i=0,n=0;for(var o=0;o<this.ROW_COUNT;++o){var h=r+o*this.ROW_COUNT;switch(a.savedData.arrLevelTile[h]){case s.LEVEL_TILE_STATE_BOXMORE:++n;break;case s.LEVEL_TILE_STATE_LAKEWOOD:++i;break;case s.LEVEL_TILE_STATE_PLAYABLE:null==t[h]&&(t[h]=0),e.push(h)}}var I=!0,T=!1,m=void 0;try{for(var y,g=e[Symbol.iterator]();!(I=(y=g.next()).done);I=!0){var d=y.value;t[d]+=this._findTileScore(i,n)}}catch(t){T=!0,m=t}finally{try{!I&&g.return&&g.return()}finally{if(T)throw m}}}e=[],i=0,n=0;for(var r=0;r<this.ROW_COUNT;++r){var h=r*(this.ROW_COUNT+1);switch(a.savedData.arrLevelTile[h]){case s.LEVEL_TILE_STATE_BOXMORE:++n;break;case s.LEVEL_TILE_STATE_LAKEWOOD:++i;break;case s.LEVEL_TILE_STATE_PLAYABLE:null==t[h]&&(t[h]=0),e.push(h)}}var S=!0,C=!1,f=void 0;try{for(var x,P=e[Symbol.iterator]();!(S=(x=P.next()).done);S=!0){var d=x.value;t[d]+=this._findTileScore(i,n)}}catch(t){C=!0,f=t}finally{try{!S&&P.return&&P.return()}finally{if(C)throw f}}e=[],i=0,n=0;for(var r=0;r<this.ROW_COUNT;++r){var h=2*(r+1);switch(a.savedData.arrLevelTile[h]){case s.LEVEL_TILE_STATE_BOXMORE:++n;break;case s.LEVEL_TILE_STATE_LAKEWOOD:++i;break;case s.LEVEL_TILE_STATE_PLAYABLE:null==t[h]&&(t[h]=0),e.push(h)}}var v=!0,E=!1,A=void 0;try{for(var w,b=e[Symbol.iterator]();!(v=(w=b.next()).done);v=!0){var d=w.value;t[d]+=this._findTileScore(i,n)}}catch(t){E=!0,A=t}finally{try{!v&&b.return&&b.return()}finally{if(E)throw A}}for(var O=-1,r=0;r<t.length;++r)null!=t[r]&&(O==-1||t[r]>t[O]||t[r]==t[O]&&a.randBool())&&(O=r);return O},n.prototype._findTileScore=function(t,e){var i=0;return 2==e?i=this.VICTORY_SCORE:2==t?i=-this.VICTORY_SCORE:1==e&&0==t?i=this.SEQUENCE_SCORE:1==t&&(i=-this.SEQUENCE_SCORE),i}},{"../../Common":6,"../../CommonGame":7}],51:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._lakewoodLogoSprite=null,this._charSprite=null,this._nameText=null,this._damageText=null,this._attackRangeText=null,this._speedText=null,this._healthText=null,this._uiSAbilityIcon=null,this._saRechargeContainer=null,this._sheenSprite=null,this._charIndex=-1}var a=t("../Common"),s=t("../CommonGame"),r=t("./UISAbilityIcon");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){console.assert(this._charIndex!=-1,{message:"this._charIndex is -1"}),this._bgSprite=new PIXI.Sprite(a.blankTexture),this._bgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._bgSprite),this._lakewoodLogoSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_logo_good")),this._lakewoodLogoSprite.anchor=new PIXI.Point(0,0),this._lakewoodLogoSprite.scale=new PIXI.Point(.4,.4),this._lakewoodLogoSprite.x=-125,this._lakewoodLogoSprite.y=-185,this.addChild(this._lakewoodLogoSprite),this._charSprite=new PIXI.Sprite(a.blankTexture),this._charSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._charSprite),this._nameText=new PIXI.extras.BitmapText("",{font:"30px ed_30",align:"center"}),this._nameText.anchor=new PIXI.Point(.5,.5),this._nameText.position=new PIXI.Point(0,(-117)),this.addChild(this._nameText),this._damageText=new PIXI.extras.BitmapText("",{font:"30px ed_30",align:"center"}),this._damageText.anchor=new PIXI.Point(.5,.5),this._damageText.position=new PIXI.Point((-79),148),this.addChild(this._damageText),this._speedText=new PIXI.extras.BitmapText("",{font:"30px ed_30",align:"center"}),this._speedText.anchor=new PIXI.Point(.5,.5),this._speedText.position=new PIXI.Point((-77),(-152)),this.addChild(this._speedText),this._healthText=new PIXI.extras.BitmapText("",{font:"30px ed_30",align:"center"}),this._healthText.anchor=new PIXI.Point(.5,.5),this._healthText.position=new PIXI.Point(79,(-152)),this.addChild(this._healthText),this._attackRangeText=new PIXI.extras.BitmapText("",{font:"30px ed_30",align:"center"}),this._attackRangeText.anchor=new PIXI.Point(.5,.5),this._attackRangeText.position=new PIXI.Point((-20),148),this.addChild(this._attackRangeText),this._uiSAbilityIcon=new r,this._uiSAbilityIcon.anchor=new PIXI.Point(.5,.5),this._uiSAbilityIcon.position=new PIXI.Point(60,148),this.addChild(this._uiSAbilityIcon),this._saRechargeContainer=new PIXI.Container,this._saRechargeContainer.anchor=new PIXI.Point(.5,.5),this._saRechargeContainer.x=this._uiSAbilityIcon.x,this._saRechargeContainer.y=this._uiSAbilityIcon.y+30,this.addChild(this._saRechargeContainer);for(var t=0;t<3;++t){var e=new PIXI.Sprite(a.assets.getTexture("stats_special_counter_full-copy"));e.anchor=new PIXI.Point(.5,.5),this._saRechargeContainer.addChild(e)}this.update()},n.prototype.update=function(){var t=a.assets.getJSON("playerCharacters").playerCharacters[this._charIndex],e=a.savedData.arrPlayerCharInfo[this._charIndex],i="";if(e.isLocked)i="player_select_card_foil";else switch(i="player_select_card_",t.essence){case"STR":i+="orange";break;case"AGI":i+="blue";break;case"INT":i+="green"}e.isImproved&&(i+="_potential"),this._bgSprite.texture=a.assets.getTexture(i),this._lakewoodLogoSprite.visible=e.isLocked;var n="player_select_char_";n+=t.spritePrefix,n+=e.isLocked?"_locked":e.isImproved?"_potential":"_unlocked",this._charSprite.texture=a.assets.getTexture(n),null==this._sheenSprite||e.isImproved?null==this._sheenSprite&&e.isImproved&&this._initSheenEffect():(TweenMax.killTweensOf(this._sheenSprite),this.removeChild(this._sheenSprite),this._sheenSprite=null);var r=s.getPlayerCharStats(t.id);this._nameText.text=t.name.toUpperCase(),this._nameText.y=e.isLocked?136:-117,this._damageText.text=r.DAMAGE.toString(),this._damageText.visible=!e.isLocked,this._damageText.font=r.DAMAGE!=t.damage?"33px ed_50_gradient":"30px ed_30",this._attackRangeText.text=r.ATTACK_RANGE.toString(),this._attackRangeText.visible=!e.isLocked,this._attackRangeText.font=r.ATTACK_RANGE!=t.attackRange?"33px ed_50_gradient":"30px ed_30",this._speedText.text=r.SPEED.toString(),this._speedText.visible=!e.isLocked,this._speedText.font=r.SPEED!=t.speed?"33px ed_50_gradient":"30px ed_30",this._healthText.text=r.HEALTH.toString(),this._healthText.visible=!e.isLocked,this._healthText.font=r.HEALTH!=t.health?"33px ed_50_gradient":"30px ed_30",this._uiSAbilityIcon.visible=!e.isLocked,this._saRechargeContainer.visible=!e.isLocked,this._uiSAbilityIcon.reinit(s.getSpecialAbilityType(t.specialAbility.type));for(var o=0;o<this._saRechargeContainer.children.length;++o)this._saRechargeContainer.children[o].visible=o<r.SA_RECHARGE_TIME;for(var h=-(r.SA_RECHARGE_TIME-1)*this._saRechargeContainer.children[0].width*.5,o=0;o<r.SA_RECHARGE_TIME;++o)this._saRechargeContainer.children[o].x=h,h+=this._saRechargeContainer.children[0].width},n.prototype.bump=function(){var t=this.scale.x;this.scale=new PIXI.Point(t-.1,t-.1),TweenMax.to(this.scale,.25,{x:t,y:t,ease:Back.easeInOut})},n.prototype._initSheenEffect=function(){var t=new PIXI.Graphics;t.lineStyle(),t.beginFill(255,.5),t.moveTo(119,-201),t.lineTo(126,-198),t.lineTo(129,-191),t.lineTo(129,191),t.lineTo(126,198),t.lineTo(119,201),t.lineTo(-119,201),t.lineTo(-126,198),t.lineTo(-129,191),t.lineTo(-129,-191),t.lineTo(-126,-198),t.lineTo(-119,-201),t.lineTo(119,-201),t.endFill(),this.addChild(t),this._sheenSprite=new PIXI.Sprite(a.assets.getTexture("player_select_card_shine")),this._sheenSprite.blendMode=PIXI.BLEND_MODES.ADD,this._sheenSprite.anchor=new PIXI.Point(.5,.5),this._sheenSprite.rotation=.25*Math.PI,this.addChild(this._sheenSprite),this._sheenSprite.mask=t,this._applySheen()},n.prototype._applySheen=function(){null!=this._sheenSprite&&(this._sheenSprite.x=-200,this._sheenSprite.y=200,TweenMax.to(this._sheenSprite,1,{x:this._sheenSprite.x+400,y:this._sheenSprite.y-400,ease:Power3.easeOut,delay:2*Math.random(),onComplete:function(){TweenMax.delayedCall(1+2*Math.random(),this._applySheen,null,this)},onCompleteScope:this}))},Object.defineProperty(n.prototype,"charIndex",{set:function(t){this._charIndex=t}})},{"../Common":6,"../CommonGame":7,"./UISAbilityIcon":56}],52:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._pickItSprite=null,this._prevCharCard=null,this._selectedCharCard=null,this._nextCharCard=null,this._incomingCharCard=null,this._arrTeamCharId=[],this._unlockBtn=null,this._pickBtn=null,this._pickLeftBtn=null,this._pickRightBtn=null,this._nextBtn=null,this._prevBtn=null,this._unlockTitleText=null,this._unlockValueText=null,this._playerBalanceText=null,this._noCoinsContainer=null,this._noCoinsBg=null,this._noCoinsText=null,this._charIndex=0,this.ARR_CHAR_CARD_POSITION=[new PIXI.Point((-150),20),new PIXI.Point(0,20),new PIXI.Point(150,20)],this.CHAR_CARD_SCALE=.7,this.signals={},this.signals.onCharacterPicked=new signals.Signal,this.signals.onCharacterImproved=new signals.Signal}var a=t("../Common"),s=t("../CommonGame"),r=t("../GrayScaleFilter"),o=t("./UICharCard");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(t){this._arrTeamCharId=t,this._bgSprite=new PIXI.Sprite(a.assets.getTexture("player_select__panel")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._bgSprite),this._incomingCharCard=new o,this._incomingCharCard.charIndex=0,this._incomingCharCard.init(),this._incomingCharCard.visible=!1,this._incomingCharCard.anchor=new PIXI.Point(.5,.5),this.addChild(this._incomingCharCard),this._prevCharCard=new o,this._prevCharCard.charIndex=this._findCarouselCharIndex(this._charIndex-1),this._prevCharCard.init(),this._prevCharCard.scale=new PIXI.Point(this.CHAR_CARD_SCALE,this.CHAR_CARD_SCALE),this._prevCharCard.anchor=new PIXI.Point(.5,.5),this.addChild(this._prevCharCard),this._prevCharCard.position=new PIXI.Point(this.ARR_CHAR_CARD_POSITION[0].x,this.ARR_CHAR_CARD_POSITION[0].y),this._nextCharCard=new o,this._nextCharCard.charIndex=this._findCarouselCharIndex(this._charIndex+1),this._nextCharCard.init(),this._nextCharCard.scale=new PIXI.Point(this.CHAR_CARD_SCALE,this.CHAR_CARD_SCALE),this._nextCharCard.anchor=new PIXI.Point(.5,.5),this.addChild(this._nextCharCard),this._nextCharCard.position=new PIXI.Point(this.ARR_CHAR_CARD_POSITION[2].x,this.ARR_CHAR_CARD_POSITION[2].y),
this._selectedCharCard=new o,this._selectedCharCard.charIndex=this._charIndex,this._selectedCharCard.init(),this._selectedCharCard.anchor=new PIXI.Point(.5,.5),this.addChild(this._selectedCharCard),this._selectedCharCard.position=new PIXI.Point(this.ARR_CHAR_CARD_POSITION[1].x,this.ARR_CHAR_CARD_POSITION[1].y);var e=new p3.ButtonStates(a.assets.getTexture("btn_next_off"),a.assets.getTexture("btn_next_over"),a.assets.getTexture("btn_next_down"));this._nextBtn=new p3.Button(e),this._nextBtn.anchor=new PIXI.Point(.5,.5),this._nextBtn.position.x=300,this._nextBtn.position.y=0,this._nextBtn.signals.click.add(this._onNextButton_Click,this),this.addChild(this._nextBtn),e=new p3.ButtonStates(a.assets.getTexture("btn_back_off"),a.assets.getTexture("btn_back_over"),a.assets.getTexture("btn_back_down")),this._prevBtn=new p3.Button(e),this._prevBtn.anchor=new PIXI.Point(.5,.5),this._prevBtn.position.x=-300,this._prevBtn.position.y=0,this._prevBtn.signals.click.add(this._onPrevButton_Click,this),this.addChild(this._prevBtn),e=new p3.ButtonStates(a.assets.getTexture("btn_secondary_off"),a.assets.getTexture("btn_secondary_over"),a.assets.getTexture("btn_secondary_down"),a.assets.getTexture("icon_secondary_coins_off")),e.iconOver=a.assets.getTexture("icon_secondary_coins_over"),e.iconDown=a.assets.getTexture("icon_secondary_coins_down"),this._unlockBtn=new p3.Button(e),this._unlockBtn.anchor=new PIXI.Point(.5,.5),this._unlockBtn.position.x=0,this._unlockBtn.position.y=280,this._unlockBtn.signals.click.add(this._onUnlockButton_Click,this),this.addChild(this._unlockBtn),this._pickLeftBtn=new PIXI.Sprite(a.blankTexture),this._pickLeftBtn.anchor=new PIXI.Point(.5,.5),this._pickLeftBtn.alpha=0,this._pickLeftBtn.interactive=!0,this._pickLeftBtn.width=260*this.CHAR_CARD_SCALE,this._pickLeftBtn.height=400*this.CHAR_CARD_SCALE,this._pickLeftBtn.x=this._prevCharCard.position.x,this._pickLeftBtn.y=this._prevCharCard.position.y,this._pickLeftBtn.click=this._pickLeftBtn.tap=this._onPickButton_Click.bind(this,-1),this._pickLeftBtn.buttonMode=!0,this.addChild(this._pickLeftBtn),this._pickRightBtn=new PIXI.Sprite(a.blankTexture),this._pickRightBtn.anchor=new PIXI.Point(.5,.5),this._pickRightBtn.alpha=0,this._pickRightBtn.interactive=!0,this._pickRightBtn.width=this._pickLeftBtn.width,this._pickRightBtn.height=this._pickLeftBtn.height,this._pickRightBtn.x=this._nextCharCard.position.x,this._pickRightBtn.y=this._nextCharCard.position.y,this._pickRightBtn.click=this._pickRightBtn.tap=this._onPickButton_Click.bind(this,1),this._pickRightBtn.buttonMode=!0,this.addChild(this._pickRightBtn),this._pickBtn=new PIXI.Sprite(a.blankTexture),this._pickBtn.anchor=new PIXI.Point(.5,.5),this._pickBtn.alpha=0,this._pickBtn.interactive=!0,this._pickBtn.width=260,this._pickBtn.height=400,this._pickBtn.x=this._selectedCharCard.position.x,this._pickBtn.y=this._selectedCharCard.position.y,this._pickBtn.click=this._pickBtn.tap=this._onPickButton_Click.bind(this,0),this._pickBtn.buttonMode=!0,this.addChild(this._pickBtn),this._balanceText=new PIXI.extras.BitmapText(a.savedData.coins.toString(),{font:"50px ed_50",align:"center"}),this._balanceText.anchor=new PIXI.Point(1,.5),this._balanceText.position=new PIXI.Point(95,(-245)),this._bgSprite.addChild(this._balanceText),this._unlockTitleText=new PIXI.extras.BitmapText("1",{font:"30px ed_30",align:"center"}),this._unlockTitleText.anchor=new PIXI.Point(.5,.5),this._unlockTitleText.position=new PIXI.Point(this._unlockBtn.position.x,this._unlockBtn.position.y-20),this.addChild(this._unlockTitleText),this._unlockValueText=new PIXI.extras.BitmapText("1",{font:"30px ed_30",align:"center"}),this._unlockValueText.anchor=new PIXI.Point(.5,.5),this._unlockValueText.position=new PIXI.Point(this._unlockBtn.position.x,this._unlockBtn.position.y+10),this.addChild(this._unlockValueText),a.savedData.isFirstCharPick&&(this._pickItSprite=new PIXI.Sprite(a.assets.getTexture("ui_tutorial_finger")),this._pickItSprite.anchor=new PIXI.Point(.5,.5),this._pickItSprite.x=this._selectedCharCard.position.x+100,this._pickItSprite.y=this._selectedCharCard.position.y+100,this._pickItSprite.scale.y=-1,this.addChild(this._pickItSprite),TweenMax.to(this._pickItSprite,.5,{x:this._pickItSprite.x-40,y:this._pickItSprite.y-40,ease:Sine.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this._pickItSprite.scale,.5,{x:.8,y:-.8,ease:Sine.easeInOut,yoyo:!0,repeat:-1})),this._noCoinsContainer=new PIXI.Container,this._noCoinsContainer.x=this._unlockBtn.x+140,this._noCoinsContainer.y=this._unlockBtn.y,this._noCoinsContainer.alpha=0,this.addChild(this._noCoinsContainer);var i=a.assets.getJSON("languages").NO_COINS[a.language];this._noCoinsText=new PIXI.Text(i,{font:"28px Arial",fill:"#000000",align:"center",cacheAsBitmap:!0}),this._noCoinsText.anchor=new PIXI.Point(0,.5),this._noCoinsText.x=20,this._noCoinsBg=new PIXI.Sprite(a.assets.getTexture("tutorial_panel")),this._noCoinsBg.anchor=new PIXI.Point(0,.5),this._noCoinsBg.height=50,this._noCoinsBg.width=this._noCoinsText.width+40,this._noCoinsContainer.addChild(this._noCoinsBg),this._noCoinsContainer.addChild(this._noCoinsText),this._updateUI()},n.prototype._bumpBg=function(){this._bgSprite.scale=new PIXI.Point(.9,.9),TweenMax.to(this._bgSprite.scale,.2,{x:1,y:1,ease:Back.easeOut})},n.prototype._updateUI=function(){var t=this._findCarouselCharIndex(this._charIndex-1),e=this._findCarouselCharIndex(this._charIndex+1),i=a.savedData.arrPlayerCharInfo[this._charIndex];if(i.isLocked){this._unlockBtn.visible=!0,this._unlockTitleText.visible=!0,this._unlockValueText.visible=!0,this._pickBtn.visible=!1;var n=a.assets.getJSON("languages").UNLOCK_NEW_HERO[a.language].toUpperCase();this._unlockTitleText.text=n,this._unlockValueText.text=a.assets.getJSON("playerCharacters").playerCharacters[this._charIndex].unlockCoins.toString()}else if(i.isImproved)this._unlockBtn.visible=!1,this._unlockTitleText.visible=!1,this._unlockValueText.visible=!1,this._pickBtn.visible=!0;else{this._unlockBtn.visible=!0,this._unlockTitleText.visible=!0,this._unlockValueText.visible=!0,this._pickBtn.visible=!0;var n=a.assets.getJSON("languages").UNLOCK_POTENTIAL[a.language].toUpperCase();this._unlockTitleText.text=n,this._unlockValueText.text=a.assets.getJSON("playerCharacters").playerCharacters[this._charIndex].improveCoins.toString()}t>=0&&(this._arrTeamCharId.indexOf(t)!=-1?this._prevCharCard.filters=[new r]:this._prevCharCard.filters=[]),e<a.savedData.arrPlayerCharInfo.length&&(this._arrTeamCharId.indexOf(e)!=-1?this._nextCharCard.filters=[new r]:this._nextCharCard.filters=[]),this._arrTeamCharId.indexOf(this._charIndex)!=-1?this._selectedCharCard.filters=[new r]:this._selectedCharCard.filters=[]},n.prototype._animateCarousel=function(t){var e=t==-1?this._nextCharCard:this._prevCharCard,i=t==-1?this._prevCharCard:this._nextCharCard;this._incomingCharCard.visible=!0,this._incomingCharCard.charIndex=this._findCarouselCharIndex(this._charIndex+(t==-1?-1:1)),this._incomingCharCard.update(),this._incomingCharCard.position=new PIXI.Point(this.ARR_CHAR_CARD_POSITION[t==-1?0:2].x,this.ARR_CHAR_CARD_POSITION[t==-1?0:2].y),this._incomingCharCard.scale=new PIXI.Point,TweenMax.to(this._incomingCharCard.scale,.25,{x:this.CHAR_CARD_SCALE,y:this.CHAR_CARD_SCALE,ease:Sine.easeOut});var n=new TimelineMax;if(n.to(i.position,.1,{x:i.x+(t==-1?-50:50),ease:Sine.easeIn}).to(i.position,.15,{x:this.ARR_CHAR_CARD_POSITION[1].x,y:this.ARR_CHAR_CARD_POSITION[1].y,ease:Sine.easeOut}),TweenMax.to(i.scale,.25,{x:1,y:1,ease:Sine.easeOut}),TweenMax.to(i,.25,{rotation:0,ease:Sine.easeOut}),TweenMax.to(this._selectedCharCard.position,.25,{x:this.ARR_CHAR_CARD_POSITION[t==-1?2:0].x,y:this.ARR_CHAR_CARD_POSITION[t==-1?2:0].y,ease:Back.easeOut}),TweenMax.to(this._selectedCharCard.scale,.25,{x:this.CHAR_CARD_SCALE,y:this.CHAR_CARD_SCALE,ease:Sine.easeOut}),TweenMax.to(e.scale,.25,{x:0,y:0,ease:Sine.easeOut}),t==-1){var a=this._nextCharCard;this._nextCharCard=this._selectedCharCard,this._selectedCharCard=this._prevCharCard,this._prevCharCard=this._incomingCharCard,this._incomingCharCard=a}else{var a=this._prevCharCard;this._prevCharCard=this._selectedCharCard,this._selectedCharCard=this._nextCharCard,this._nextCharCard=this._incomingCharCard,this._incomingCharCard=a}this.setChildIndex(this._incomingCharCard,1),this.setChildIndex(this._prevCharCard,2),this.setChildIndex(this._nextCharCard,3),this.setChildIndex(this._selectedCharCard,4)},n.prototype._findCarouselCharIndex=function(t){var e=a.assets.getJSON("playerCharacters").playerCharacters.length;return t>=e?t-=e:t<0&&(t=e+t),t},n.prototype.onCharSlotCleared=function(t){var e=this._arrTeamCharId.indexOf(t);this._arrTeamCharId.splice(e,1),this._updateUI()},n.prototype._onNextButton_Click=function(){this._charIndex=this._findCarouselCharIndex(this._charIndex+1),this._animateCarousel(1),this._updateUI(),a.audio.playSound("sfx_btn_press_fwd_00")},n.prototype._onPrevButton_Click=function(){this._charIndex=this._findCarouselCharIndex(this._charIndex-1),this._animateCarousel(-1),this._updateUI(),a.audio.playSound("sfx_btn_press_back_00")},n.prototype._onPickButton_Click=function(t){var e=this._charIndex+t;e>=a.assets.getJSON("playerCharacters").playerCharacters.length?e=0:e<0&&(e=a.assets.getJSON("playerCharacters").playerCharacters.length-1),this._arrTeamCharId.indexOf(e)!=-1||this._arrTeamCharId.length==s.PLAYER_TEAM_SIZE||a.savedData.arrPlayerCharInfo[e].isLocked||(this._arrTeamCharId.push(e),this._updateUI(),this.signals.onCharacterPicked.dispatch(e,t),null!=this._pickItSprite&&(TweenMax.killTweensOf(this._pickItSprite),this.removeChild(this._pickItSprite),this._pickItSprite.destroy(),this._pickItSprite=null,a.savedData.isFirstCharPick=this._isFirstCharPick,a.savedData.save()),a.audio.playSound("sfx_card_selected_00"))},n.prototype._showNoCoinsMsg=function(){TweenMax.killTweensOf(this._noCoinsContainer.scale),TweenMax.killTweensOf(this._noCoinsContainer),this._noCoinsContainer.scale=new PIXI.Point,this._noCoinsContainer.alpha=1,TweenMax.to(this._noCoinsContainer.scale,.25,{x:1,y:1,ease:Back.easeOut,onComplete:function(){TweenMax.to(this._noCoinsContainer,2,{alpha:0,ease:Sine.easeIn})},onCompleteScope:this})},n.prototype._onUnlockButton_Click=function(){var t=a.savedData.arrPlayerCharInfo[this._charIndex];if(t.isLocked){var e=a.assets.getJSON("playerCharacters").playerCharacters[this._charIndex];if(a.savedData.coins>=e.unlockCoins){a.savedData.arrPlayerCharInfo[this._charIndex].isLocked=!1,a.savedData.coins-=e.unlockCoins,a.savedData.save();var i=a.assets.getJSON("languages").UNLOCK_POTENTIAL[a.language].toUpperCase();this._unlockTitleText.text=i,this._unlockValueText.text=e.improveCoins.toString(),this._pickBtn.visible=!0,this._balanceText.text=a.savedData.coins.toString(),this._selectedCharCard.update(),this._bumpBg(),this._selectedCharCard.bump(),a.audio.playSound("sfx_achievement_00")}else this._showNoCoinsMsg()}else if(!t.isImproved){var e=a.assets.getJSON("playerCharacters").playerCharacters[this._charIndex];a.savedData.coins>=e.improveCoins?(a.savedData.arrPlayerCharInfo[this._charIndex].isImproved=!0,a.savedData.coins-=e.improveCoins,a.savedData.save(),this._unlockBtn.visible=!1,this._unlockTitleText.visible=!1,this._unlockValueText.visible=!1,this._balanceText.text=a.savedData.coins.toString(),this._selectedCharCard.update(),this._bumpBg(),this._selectedCharCard.bump(),a.audio.playSound("sfx_achievement_00"),this.signals.onCharacterImproved.dispatch(this._charIndex)):this._showNoCoinsMsg()}},Object.defineProperty(n.prototype,"selectedChars",{get:function(){return this._arrTeamCharId}})},{"../Common":6,"../CommonGame":7,"../GrayScaleFilter":8,"./UICharCard":51}],53:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._card=null,this._clearBtn=null,this._charIndex=-1,this.signals={},this.signals.onCharSlotCleared=new signals.Signal}var a=t("../Common"),s=t("./UICharCard");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){a.assets.getJSON("playerCharacters").playerCharacters[this._charIndex];this._bgSprite=new PIXI.Sprite(a.assets.getTexture("player_select_empty")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._bgSprite),this._card=new s,this._card.charIndex=0,this._card.visible=!1,this._card.init(),this._card.anchor=new PIXI.Point(.5,.5),this._card.scale=new PIXI.Point(.37,.37),this.addChild(this._card);var t=new p3.ButtonStates(a.assets.getTexture("btn_close"),a.assets.getTexture("btn_close"),a.assets.getTexture("btn_close"));this._clearBtn=new p3.Button(t),this._clearBtn.anchor=new PIXI.Point(.5,.5),this._clearBtn.position.x=.48*this._bgSprite.width,this._clearBtn.position.y=.48*-this._bgSprite.height,this._clearBtn.signals.click.add(this._onClearButton_Click,this),this.addChild(this._clearBtn),this._clearBtn.visible=!1},n.prototype.setChar=function(t,e,i){this._charIndex=t,this._clearBtn.visible=null==e,this._card.visible=!0,this._card.charIndex=t,this._card.update(),null!=e&&(this._card.position=new PIXI.Point(e.x-this.parent.x-this.x,e.y-this.parent.y-this.y),this._card.scale=new PIXI.Point(i,i),TweenMax.to(this._card.scale,.25,{x:.37,y:.37,ease:Sine.easeOut}),TweenMax.to(this._card.position,.25,{x:0,y:0,ease:Sine.easeOut}).eventCallback("onComplete",function(){this._clearBtn.visible=!0,this.parent.bump()},null,this))},n.prototype.isAvailable=function(){return this._charIndex==-1},n.prototype.bumpCard=function(){this._card.bump()},n.prototype._onClearButton_Click=function(){this.signals.onCharSlotCleared.dispatch(this._charIndex),this._clearBtn.visible=!1,TweenMax.to(this._card.scale,.25,{x:0,y:0,ease:Sine.easeOut}),this._charIndex=-1,a.audio.playSound("sfx_btn_remove_card_00")},Object.defineProperty(n.prototype,"charIndex",{get:function(){return this._charIndex}}),Object.defineProperty(n.prototype,"card",{get:function(){return this._card}})},{"../Common":6,"./UICharCard":51}],54:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this.BAR_MARGIN=10,this._healthText=null,this._bgSprite=null,this._fgSprite=null,this._barSprite=null,this._maxHealth=0,this._width=314,this._height=64,this._barTint=null}var a=t("../Common");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(t){this._barTint=t,this._bgSprite=new PIXI.Sprite(a.assets.getTexture("battle_health_bar_btm")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._bgSprite),this._barSprite=new PIXI.Sprite(a.blankTexture),this._barSprite.anchor=new PIXI.Point(0,.5),this._barSprite.width=this._width-2*this.BAR_MARGIN,this._barSprite.height=this._height-2*this.BAR_MARGIN,this._barSprite.tint=this._barTint,this._barSprite.position.x=.5*-this._width+this.BAR_MARGIN,this.addChild(this._barSprite),this._fgSprite=new PIXI.Sprite(a.assets.getTexture("battle_health_bar_top")),this._fgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._fgSprite),this._healthText=new PIXI.extras.BitmapText("",{font:"50px ed_50",align:"center"}),this._healthText.anchor=new PIXI.Point(.5,.5),this._healthText.position.y=.5*this._healthText.height+20,this.addChild(this._healthText)},n.prototype.setHealth=function(t,e){console.assert(0!=this._maxHealth,{message:"this._maxHealth is 0"}),this._healthText.text=t.toString()+"/"+this._maxHealth.toString();var i=0;t>0&&(i=this._width*(t/this._maxHealth)-2*this.BAR_MARGIN),e?TweenMax.to(this._barSprite,.25,{width:i,ease:Sine.easeOut}):this._barSprite.width=i},Object.defineProperty(n.prototype,"maxHealth",{set:function(t){this._maxHealth=t}})},{"../Common":6}],55:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._sprite=null,this._levelId=null,this._state=s.LEVEL_TILE_STATE_NONE,this._row=-1,this._column=-1,this.signals={},this.signals.onClick=new signals.Signal}var a=t("../Common"),s=t("../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(t,e,i,n){this._row=e,this._column=i;var s=a.assets.getJSON("levels").levels[t];this._state=n,this._sprite=new PIXI.Sprite(a.assets.getTexture(s.tileSprite)),this._sprite.anchor=new PIXI.Point(.5,.5),this._sprite.interactive=!0,this._sprite.click=this._sprite.tap=this._onClick.bind(this),this.addChild(this._sprite),this.setState(this._state)},n.prototype.setState=function(t){this._state=t,this._state==s.LEVEL_TILE_STATE_NONE?this._sprite.tint=16777215:this._state==s.LEVEL_TILE_STATE_PLAYABLE?this._sprite.tint=65280:this._state==s.LEVEL_TILE_STATE_BLOCKED?this._sprite.tint=16711680:this._state==s.LEVEL_TILE_STATE_BEATEN&&(this._sprite.tint=16776960)},n.prototype._onClick=function(){this.signals.onClick.dispatch(this)},Object.defineProperty(n.prototype,"width",{get:function(){return this._sprite.width}}),Object.defineProperty(n.prototype,"height",{get:function(){return this._sprite.height}}),Object.defineProperty(n.prototype,"state",{get:function(){return this._state}}),Object.defineProperty(n.prototype,"row",{get:function(){return this._row}}),Object.defineProperty(n.prototype,"col",{get:function(){return this._column}}),Object.defineProperty(n.prototype,"levelId",{get:function(){return this._levelId}})},{"../Common":6,"../CommonGame":7}],56:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._iconContainer=null}var a=t("../Common"),s=t("../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(t){switch(this._iconContainer=new PIXI.Container,this.addChild(this._iconContainer),t){case s.SA_ID_EXTRA_ATTACK:var e=new PIXI.Sprite(a.assets.getTexture("player_select_card_icon_attack"));e.anchor=new PIXI.Point(.5,.5),this._iconContainer.addChild(e);break;case s.SA_ID_SPLASH_DAMAGE:var e=new PIXI.Sprite(a.assets.getTexture("player_select_card_icon_attack"));e.anchor=new PIXI.Point(.5,.5),e.x-=.45*e.width,this._iconContainer.addChild(e),e=new PIXI.Sprite(a.assets.getTexture("player_select_card_icon_splash")),e.anchor=new PIXI.Point(.5,.5),e.x+=.45*e.width,this._iconContainer.addChild(e);break;case s.SA_ID_EXTRA_MOVE:var e=new PIXI.Sprite(a.assets.getTexture("player_select_card_icon_movement"));e.anchor=new PIXI.Point(.5,.5),this._iconContainer.addChild(e);break;case s.SA_ID_HEALING_POWER:var e=new PIXI.Sprite(a.assets.getTexture("player_select_card_icon_health"));e.anchor=new PIXI.Point(.5,.5),this._iconContainer.addChild(e);break;case s.SA_ID_HEAL_OTHERS:var e=new PIXI.Sprite(a.assets.getTexture("player_select_card_icon_healall"));e.anchor=new PIXI.Point(.5,.5),this._iconContainer.addChild(e)}},n.prototype.reinit=function(t){null!=this._iconContainer&&this._iconContainer.removeChildren(),this.init(t)}},{"../Common":6,"../CommonGame":7}],57:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._arrCharSlot=[],this.TOP_UI_CHAR_SLOT_CHILD_INDEX=3,this.signals={},this.signals.onCharSlotCleared=new signals.Signal}var a=t("../Common"),s=t("../CommonGame"),r=t("./UICharSlot");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("player_select_team_panel")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._bgSprite);for(var t=[new PIXI.Point((-60),45),new PIXI.Point(90,0),new PIXI.Point((-40),(-140))],e=0;e<s.PLAYER_TEAM_SIZE;++e){var i=new r;i.init(),i.signals.onCharSlotCleared.add(this._onCharSlotCleared,this),i.position=t[e],this.addChild(i),this._arrCharSlot.push(i)}},n.prototype.addChar=function(t,e,i){var n=!0,a=!1,s=void 0;try{for(var r,o=this._arrCharSlot[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var h=r.value;if(h.isAvailable()){h!=this.getChildAt(this.TOP_UI_CHAR_SLOT_CHILD_INDEX)&&this.swapChildren(h,this.getChildAt(this.TOP_UI_CHAR_SLOT_CHILD_INDEX)),h.setChar(t,e,i);break}}}catch(t){a=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}},n.prototype.updateChar=function(t){var e=!0,i=!1,n=void 0;try{for(var a,s=this._arrCharSlot[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;if(r.charIndex==t){r.card.update();break}}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}},n.prototype.bump=function(){this.scale=new PIXI.Point(.9,.9),TweenMax.to(this.scale,.2,{x:1,y:1,ease:Back.easeOut})},n.prototype.bumpChar=function(t){var e=!0,i=!1,n=void 0;try{for(var a,s=this._arrCharSlot[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;if(r.charIndex==t){r.bumpCard();break}}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}},n.prototype._onCharSlotCleared=function(t){this.signals.onCharSlotCleared.dispatch(t)},Object.defineProperty(n.prototype,"levelIndex",{set:function(t){this._levelIndex=t}})},{"../Common":6,"../CommonGame":7,"./UICharSlot":53}],58:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._homeBtn=null,this._muteBtn=null,this._infoBtn=null,this._backBtn=null,this.signals={},this.signals.onBackBtn_Click=new signals.Signal}var a=t("../Common"),s=t("../CommonGame");t("./overlays/HomeConfirmationPanel");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_side_off"),a.assets.getTexture("btn_primary_side_over"),a.assets.getTexture("btn_primary_side_down"),a.assets.getTexture("icon_primary_exit_right_off"));t.iconOver=a.assets.getTexture("icon_primary_exit_right_over"),t.iconDown=a.assets.getTexture("icon_primary_exit_right_down"),this._homeBtn=new p3.Button(t),this._homeBtn.anchor=new PIXI.Point(.5,.5),this._homeBtn.scale=new PIXI.Point((-1),1),this._homeBtn.position.y=.5*this._homeBtn.height,this._homeBtn._icon.scale.x=-1,this._homeBtn.signals.click.add(this._onHomeButton_Click,this),this.addChild(this._homeBtn),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_side_off"),a.assets.getTexture("btn_primary_side_over"),a.assets.getTexture("btn_primary_side_down"),a.assets.getTexture(a.isMute?"icon_primary_mute_off":"icon_primary_sound_off")),t.iconOver=a.assets.getTexture(a.isMute?"icon_primary_mute_over":"icon_primary_sound_over"),t.iconDown=a.assets.getTexture(a.isMute?"icon_primary_mute_down":"icon_primary_sound_down"),this._muteBtn=new p3.Button(t),this._muteBtn.anchor=new PIXI.Point(.5,.5),this._muteBtn.position.y=this._homeBtn.position.y,this._muteBtn.signals.click.add(this._onMuteButton_Click,this),this.addChild(this._muteBtn),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_side_off"),a.assets.getTexture("btn_primary_side_over"),a.assets.getTexture("btn_primary_side_down"),a.assets.getTexture("icon_primary_info_off")),t.iconOver=a.assets.getTexture("icon_primary_info_over"),t.iconDown=a.assets.getTexture("icon_primary_info_down"),this._infoBtn=new p3.Button(t),this._infoBtn.anchor=new PIXI.Point(.5,.5),this._infoBtn.scale=new PIXI.Point((-1),1),this._infoBtn.position.y=this._homeBtn.position.y,this._infoBtn.signals.click.add(this._onInfoButton_Click,this),this._infoBtn.visible=!1,this._infoBtn._icon.scale.x=-1,this.addChild(this._infoBtn),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_side_off"),a.assets.getTexture("btn_primary_side_over"),a.assets.getTexture("btn_primary_side_down"),a.assets.getTexture("icon_primary_previous_off")),t.iconOver=a.assets.getTexture("icon_primary_previous_over"),t.iconDown=a.assets.getTexture("icon_primary_previous_down"),this._backBtn=new p3.Button(t),this._backBtn.anchor=new PIXI.Point(.5,.5),this._backBtn.scale=new PIXI.Point((-1),1),this._backBtn.position.y=this._homeBtn.position.y,this._backBtn.signals.click.add(this._onBackButton_Click,this),this._backBtn.visible=!1,this._backBtn._icon.scale.x=-1,this.addChild(this._backBtn)},n.prototype.resize=function(){this._homeBtn.position.x=a.getButtonPositionLeft(0),this._muteBtn.position.x=a.getButtonPositionRight(0),this._infoBtn.position.x=a.getButtonPositionLeft(0),this._backBtn.position.x=a.getButtonPositionLeft(0)},n.prototype._onHomeButton_Click=function(){a.main.application.loadScene(s.SCENE_ID_MAIN)},n.prototype._onMuteButton_Click=function(){a.isMute=!a.isMute,this._muteBtn._icon.texture=a.assets.getTexture(a.isMute?"icon_primary_mute_off":"icon_primary_sound_off"),this._muteBtn._currentIconTexture=this._muteBtn._icon.texture,this._muteBtn._currentIconOverTexture=a.assets.getTexture(a.isMute?"icon_primary_mute_over":"icon_primary_sound_over"),this._muteBtn._currentIconDownTexture=a.assets.getTexture(a.isMute?"icon_primary_mute_down":"icon_primary_sound_down"),a.audio.mute(a.isMute)},n.prototype._onInfoButton_Click=function(){a.main.application.loadScene(s.SCENE_ID_SHOW_INFO)},n.prototype._onBackButton_Click=function(){this.signals.onBackBtn_Click.dispatch()},Object.defineProperty(n.prototype,"homeBtn",{get:function(){return this._homeBtn}}),Object.defineProperty(n.prototype,"muteBtn",{get:function(){return this._muteBtn}}),Object.defineProperty(n.prototype,"infoBtn",{get:function(){return this._infoBtn}}),Object.defineProperty(n.prototype,"backBtn",{get:function(){return this._backBtn}})},{"../Common":6,"../CommonGame":7,"./overlays/HomeConfirmationPanel":66}],59:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._koSprite=null,this._messageSprite=null,this._messageText=null,this._continueBtn=null,this._messageIndex=0,this._arrMessage=[],this.signals={},this.signals.onContinue=new signals.Signal,this.signals.onAllRead=new signals.Signal}var a=t("../Common");t("../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._messageSprite=new PIXI.Sprite(a.assets.getTexture("tutorial_panel")),this._messageSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._messageSprite),this._messageText=new PIXI.Text("aaaa",{font:"28px Arial",fill:"#000000",align:"center",cacheAsBitmap:!0,wordWrap:!0,wordWrapWidth:.8*this._messageSprite.width}),this._messageText.anchor=new PIXI.Point(.5,.5),this._messageSprite.addChild(this._messageText),this._koSprite=new PIXI.Sprite(a.assets.getTexture("tutorial_ko")),this._koSprite.anchor=new PIXI.Point(.5,.5),this._koSprite.x=.5*-this._messageSprite.width,this._koSprite.y=.5*-this._messageSprite.height,this.addChild(this._koSprite);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("icon_primary_next_off"));t.iconOver=a.assets.getTexture("icon_primary_next_over"),t.iconDown=a.assets.getTexture("icon_primary_next_down"),this._continueBtn=new p3.Button(t),this._continueBtn.anchor=new PIXI.Point(.5,.5),this._continueBtn.position=new PIXI.Point(.5*this._messageSprite.width,.5*this._messageSprite.height),this._continueBtn.signals.click.add(this._onContinueButton_Click,this),this.addChild(this._continueBtn)},n.prototype.showMessage=function(t){this._messageText.text=t,this._messageSprite.scale=new PIXI.Point,this._koSprite.scale=new PIXI.Point,this._continueBtn.scale=new PIXI.Point,TweenMax.killTweensOf(this._koSprite),this._koSprite.rotation=0;var e=new TimelineMax;e.to(this._messageSprite.scale,.25,{x:1,y:1,ease:Back.easeOut}).addLabel("t0").to(this._koSprite.scale,.25,{x:1,y:1,ease:Back.easeOut}).to(this._continueBtn.scale,.25,{x:1,y:1,ease:Back.easeOut}).to(this._koSprite,.25,{rotation:.025*Math.PI,ease:Sine.easeInOut},"t0").to(this._koSprite,.5,{rotation:.025*-Math.PI,ease:Sine.easeInOut,repeat:-1,yoyo:!0},"t0+=0.25"),this._continueBtn.visible=!1,this._clearSignals()},n.prototype.showMessages=function(t){this._arrMessage=t,this._messageIndex=0,this.showMessage(this._arrMessage[this._messageIndex]),this._continueBtn.visible=!0},n.prototype.setMessage=function(t){this._clearSignals(),this._messageText.text=t,this._continueBtn.visible=!1},n.prototype.setMessages=function(t){this._clearSignals(),this._messageIndex=0,this._arrMessage=t,this._messageText.text=this._arrMessage[this._messageIndex],this._continueBtn.visible=!0},n.prototype._clearSignals=function(){this.signals.onContinue.removeAll(),this.signals.onAllRead.removeAll()},n.prototype._onContinueButton_Click=function(){++this._messageIndex,this._messageIndex==this._arrMessage.length?(this.signals.onAllRead.dispatch(),this._continueBtn.visible=!1):(this.signals.onContinue.dispatch(this._messageIndex-1),this._messageText.text=this._arrMessage[this._messageIndex])},Object.defineProperty(n.prototype,"continueBtn",{get:function(){return this._continueBtn}})},{"../Common":6,"../CommonGame":7}],60:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._attacker=null,this._defender=null,this._attackerIndex=-1,this._defenderIndex=-1,this._timeline=null,this._darkBgSprite=null,this._arrScreenSideContainer=[],this._arrCombatBg=[null,null],this._radialCombatBg=null,this._hScrollCombatBg=null,this._arrDamageTakenAnimation=[],this._arrCharacterSprite=[],this._arrGraphics=[],this._arrHealthBar=[],this._arrDamageTaken=[{base:0,bonus:0},{base:0,bonus:0}],this._titleText=null,this._isCompleted=!1,this.ARR_ENEMY_ATTACK_SOUND_ID=["sfx_enemy_laser_bolt_00","sfx_enemy_laser_fire_00","sfx_enemy_laser_strike_00"],this.ARR_PLAYER_ATTACK_SOUND_ID=["sfx_player_punch_combo_00","sfx_player_punch_combo_01","sfx_player_punch_combo_02","sfx_player_punch_combo_03","sfx_player_spin_hit_00"],this.ARR_ENEMY_HIT_SOUND_ID=["sfx_hit_metal_00","sfx_player_bighit_onrobot_00"],this.ARR_PLAYER_HIT_SOUND_ID=["sfx_player_hit_00","sfx_player_hit_crush_00","sfx_player_hit_poke_three_00","sfx_player_hit_smash_00"],this.ARR_CHAR_SPRITE_POSITION=[new PIXI.Point(.5*a.STAGE_WIDTH-300,.5*a.STAGE_HEIGHT),new PIXI.Point(.5*a.STAGE_WIDTH+300,.5*a.STAGE_HEIGHT)]}var a=t("../../Common"),s=t("../../CommonGame"),r=(t("../../game/world/Character"),t("../../game/world/PlayerCharacter")),o=t("../../game/world/EnemyCharacter"),h=t("../UIHealthBar"),_=t("./combat/RadialCombatBg"),l=t("./combat/HScrollCombatBg"),c=t("./combat/BurstCombatAnimation");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._timeline=new TimelineMax,this._darkBgSprite=new PIXI.Sprite(a.blankTexture),this._darkBgSprite.width=a.STAGE_WIDTH,this._darkBgSprite.height=a.STAGE_HEIGHT,this._darkBgSprite.tint=0,this._darkBgSprite.alpha=0,this._darkBgSprite.interactive=!0,this.addChild(this._darkBgSprite);for(var t=0;t<2;++t)this._arrScreenSideContainer.push(new PIXI.Container),this._arrScreenSideContainer[t].anchor=new PIXI.Point(.5,.5),this.addChild(this._arrScreenSideContainer[t]);this._radialCombatBg=new _,this._radialCombatBg.init(),this._hScrollCombatBg=new l,this._hScrollCombatBg.init(),this._arrGraphics.push(new PIXI.Graphics),this._arrGraphics.push(new PIXI.Graphics),this._arrGraphics[0].lineStyle(),this._arrGraphics[0].beginFill(0,1),this._arrGraphics[0].moveTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH-.7*a.STAGE_MIN_WIDTH,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT-170),this._arrGraphics[0].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH+50-5,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT-170),this._arrGraphics[0].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH-50-5,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT+170),this._arrGraphics[0].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH-.7*a.STAGE_MIN_WIDTH,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT+170),this._arrGraphics[0].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH-.7*a.STAGE_MIN_WIDTH+100,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT-170),this._arrGraphics[0].endFill(),this._arrScreenSideContainer[0].mask=this._arrGraphics[0],this._arrScreenSideContainer[0].addChild(this._arrGraphics[0]),this._arrGraphics[1].lineStyle(),this._arrGraphics[1].beginFill(0,1),this._arrGraphics[1].moveTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH+.7*a.STAGE_MIN_WIDTH,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT-170),
this._arrGraphics[1].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH+50+5,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT-170),this._arrGraphics[1].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH-50+5,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT+170),this._arrGraphics[1].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH+.7*a.STAGE_MIN_WIDTH-100,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT+170),this._arrGraphics[1].lineTo(-this._arrScreenSideContainer[1].x+.5*a.STAGE_WIDTH+.7*a.STAGE_MIN_WIDTH,-this._arrScreenSideContainer[1].y+.5*a.STAGE_HEIGHT-170),this._arrGraphics[1].endFill(),this._arrScreenSideContainer[1].mask=this._arrGraphics[1],this._arrScreenSideContainer[1].addChild(this._arrGraphics[1]);for(var t=0;t<2;++t){var e=new c;e.position=0==t?new PIXI.Point(.5*a.STAGE_WIDTH-350,.5*a.STAGE_HEIGHT):new PIXI.Point(a.STAGE_WIDTH-610,.5*a.STAGE_HEIGHT),e.init(),this._arrScreenSideContainer[t].addChild(e),this._arrDamageTakenAnimation.push(e)}var i=new PIXI.Sprite(a.assets.getTexture("fight_char_ko"));i.anchor=new PIXI.Point(.5,.5),i.position=new PIXI.Point(this.ARR_CHAR_SPRITE_POSITION[0].x,this.ARR_CHAR_SPRITE_POSITION[0].y),this._arrScreenSideContainer[0].addChild(i),this._arrCharacterSprite.push(i),i=new PIXI.Sprite(a.assets.getTexture("fight_char_darrell")),i.anchor=new PIXI.Point(.5,.5),i.position=new PIXI.Point(this.ARR_CHAR_SPRITE_POSITION[1].x,this.ARR_CHAR_SPRITE_POSITION[1].y),this._arrScreenSideContainer[1].addChild(i),this._arrCharacterSprite.push(i),this._arrHealthBar.push(new h),this._arrHealthBar[0].init(65280),this._arrHealthBar[0].x=.5*a.STAGE_WIDTH-300,this._arrHealthBar[0].y=.5*a.STAGE_HEIGHT+180,this.addChild(this._arrHealthBar[0]),this._arrHealthBar.push(new h),this._arrHealthBar[1].init(16711680),this._arrHealthBar[1].x=.5*a.STAGE_WIDTH+300,this._arrHealthBar[1].y=this._arrHealthBar[0].y,this.addChild(this._arrHealthBar[1]),this._titleText=new PIXI.extras.BitmapText("aaa",{font:"80px ed_110_gradient",align:"center"}),this._titleText.anchor=new PIXI.Point(.5,.5),this._titleText.position.x=.5*a.STAGE_WIDTH,this._titleText.position.y=.5*a.STAGE_HEIGHT-190,this.addChild(this._titleText)},n.prototype.show=function(t,e){this._attacker=t,this._defender=e,this._setup(),this._resolveAttack(),this._playAnimationSequence()},n.prototype.clear=function(){this._timeline.clear(),this._isCompleted=!1;for(var t=0;t<2;++t)TweenMax.killTweensOf(this._arrCharacterSprite[t]),TweenMax.killTweensOf(this._arrCharacterSprite[t].scale),this._arrCharacterSprite[t].position=new PIXI.Point(this.ARR_CHAR_SPRITE_POSITION[t].x,this.ARR_CHAR_SPRITE_POSITION[t].y),this._arrCharacterSprite[t].rotation=0,this._arrCharacterSprite[t].scale=new PIXI.Point(1,1),this._arrCharacterSprite[t].alpha=1,this._arrDamageTaken[t]={base:0,bonus:0};var e=!0,i=!1,n=void 0;try{for(var a,s=this._arrCombatBg[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;r.clear()}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}var o=!0,h=!1,_=void 0;try{for(var l,c=this._arrDamageTakenAnimation[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var p=l.value;p.clear()}}catch(t){h=!0,_=t}finally{try{!o&&c.return&&c.return()}finally{if(h)throw _}}this._attackerIndex=-1,this._defenderIndex=-1},n.prototype.pause=function(){this._timeline.pause()},n.prototype.resume=function(){this._timeline.resume()},n.prototype._setup=function(){this._titleText.text=this._attacker.getCharInfo().name.toUpperCase()+" "+a.assets.getJSON("languages")["ATTACKS!"][a.language].toUpperCase(),this._attacker instanceof o?(this._attackerIndex=1,this._defenderIndex=0):(this._attackerIndex=0,this._defenderIndex=1);var t=s.getEssenceColorId(this._attacker.essenceType),e=s.getEssenceColorId(this._defender.essenceType);this._arrDamageTakenAnimation[this._attackerIndex].setup(t),this._arrDamageTakenAnimation[this._defenderIndex].setup(e),this._arrHealthBar[this._attackerIndex].maxHealth=this._attacker.health,this._arrHealthBar[this._attackerIndex].setHealth(this._attacker.currentHealth),this._arrHealthBar[this._defenderIndex].maxHealth=this._defender.health,this._arrHealthBar[this._defenderIndex].setHealth(this._defender.currentHealth),this._arrCharacterSprite[this._attackerIndex].texture=a.assets.getTexture("fight_char_"+this._attacker.getCharInfo().spritePrefix.toString()),this._arrCharacterSprite[this._attackerIndex].y+=this._attacker.getCharInfo().combat.offsetY,this._arrCharacterSprite[this._defenderIndex].texture=a.assets.getTexture("fight_char_"+this._defender.getCharInfo().spritePrefix.toString()),this._arrCharacterSprite[this._defenderIndex].y+=this._attacker.getCharInfo().combat.offsetY,this._arrCombatBg[this._attackerIndex]=this._hScrollCombatBg,this._hScrollCombatBg.scale.x=0==this._attackerIndex?1:-1,this._arrCombatBg[this._attackerIndex].setup(t),this._hScrollCombatBg.setParent(this._arrScreenSideContainer[this._attackerIndex]),this._arrScreenSideContainer[this._attackerIndex].setChildIndex(this._hScrollCombatBg,0),this._hScrollCombatBg.position=0==this._attackerIndex?new PIXI.Point(.5*a.STAGE_WIDTH+1500,.5*a.STAGE_HEIGHT):new PIXI.Point(.5*a.STAGE_WIDTH-1500,.5*a.STAGE_HEIGHT),this._arrCombatBg[this._defenderIndex]=this._radialCombatBg,this._arrCombatBg[this._defenderIndex].setup(e),this._radialCombatBg.setParent(this._arrScreenSideContainer[this._defenderIndex]),this._arrScreenSideContainer[this._defenderIndex].setChildIndex(this._radialCombatBg,0),this._radialCombatBg.position=0==this._defenderIndex?new PIXI.Point(.5*a.STAGE_WIDTH-350,.5*a.STAGE_HEIGHT):new PIXI.Point(a.STAGE_WIDTH-610,.5*a.STAGE_HEIGHT)},n.prototype._resolveAttack=function(){this._arrDamageTaken[this._defenderIndex].base=this._attacker.currentDamage,this._arrDamageTaken[this._defenderIndex].bonus=this._attacker.findEssenceBonus(this._defender.essenceType);var t=this._arrDamageTaken[this._defenderIndex].base+this._arrDamageTaken[this._defenderIndex].bonus;t>=this._defender.currentHealth?this._defender.currentHealth=0:(this._defender.currentHealth-=t,a.game.grid.findTileDistance(this._attacker._tile,this._defender.tile)<=this._defender.currentAttackRange&&(this._arrDamageTaken[this._attackerIndex].base=.5*this._defender.currentDamage,this._arrDamageTaken[this._attackerIndex].bonus=.5*this._defender.findEssenceBonus(this._attacker.essenceType),t=this._arrDamageTaken[this._attackerIndex].base+this._arrDamageTaken[this._attackerIndex].bonus,t>=this._attacker.currentHealth?this._attacker.currentHealth=0:this._attacker.currentHealth-=t))},n.prototype._playAnimationSequence=function(){var t=this._arrCharacterSprite[this._attackerIndex];TweenMax.to(t,10,{x:t.x+100*(0==this._attackerIndex?1:-1)});var e=this._arrCharacterSprite[this._defenderIndex];TweenMax.to(e.scale,10,{x:.5,y:.5,ease:Sine.easeOut});for(var i=0;i<2;++i)this._arrScreenSideContainer[i].position.y=a.STAGE_HEIGHT*(0==i?-1:1),this._timeline.to(this._arrScreenSideContainer[i].position,.5,{y:0,ease:Sine.easeInOut},0);this._darkBgSprite.alpha=0,TweenMax.to(this._darkBgSprite,.5,{alpha:.7,ease:Sine.easeInOut}),this._titleText.scale=new PIXI.Point,TweenMax.to(this._titleText.scale,.5,{x:1,y:1,ease:Back.easeOut});var n=!0,s=!1,h=void 0;try{for(var _,l=this._arrHealthBar[Symbol.iterator]();!(n=(_=l.next()).done);n=!0){var c=_.value;c.scale=new PIXI.Point,TweenMax.to(c.scale,.5,{x:1,y:1,ease:Back.easeOut})}}catch(t){s=!0,h=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw h}}this._timeline.call(function(){this._attacker instanceof r?a.audio.playSound(this.ARR_PLAYER_ATTACK_SOUND_ID[a.randomIntFromInterval(0,this.ARR_PLAYER_ATTACK_SOUND_ID.length-1)]):this._attacker instanceof o&&a.audio.playSound(this.ARR_ENEMY_ATTACK_SOUND_ID[a.randomIntFromInterval(0,this.ARR_ENEMY_ATTACK_SOUND_ID.length-1)])},null,this,.75).to(this._arrScreenSideContainer[this._defenderIndex],.2,{x:this._arrScreenSideContainer[this._defenderIndex].x+10,ease:RoughEase.ease.config({strength:8,points:20,template:Linear.easeNone,randomize:!1}),onStart:function(){this._arrScreenSideContainer[this._defenderIndex].x-=10,this._arrHealthBar[this._defenderIndex].setHealth(this._defender.currentHealth,!0),this._createDamageTakenText(this._defenderIndex,this._attacker),this._defender instanceof r?a.audio.playSound(this.ARR_PLAYER_HIT_SOUND_ID[a.randomIntFromInterval(0,this.ARR_PLAYER_HIT_SOUND_ID.length-1)]):this._defender instanceof o&&a.audio.playSound(this.ARR_ENEMY_HIT_SOUND_ID[a.randomIntFromInterval(0,this.ARR_ENEMY_HIT_SOUND_ID.length-1)]),this._arrDamageTakenAnimation[this._defenderIndex].play()},onStartScope:this,onComplete:function(){this._arrScreenSideContainer[this._defenderIndex].x=0,0==this._defender.currentHealth&&(TweenMax.killTweensOf(this._arrCharacterSprite[this._defenderIndex],{x:!0,y:!0}),TweenMax.to(this._arrCharacterSprite[this._defenderIndex],1,{alpha:0,ease:Sine.easeIn}),TweenMax.to(this._arrCharacterSprite[this._defenderIndex],1,{y:this._arrCharacterSprite[this._defenderIndex].y+300,ease:Sine.easeIn}),TweenMax.to(this._arrCharacterSprite[this._defenderIndex],.15,{x:this._arrCharacterSprite[this._defenderIndex].x-50*(0==this._defenderIndex?1:-1),ease:Linear.easeInOut,yoyo:!0,repeat:-1}))},onCompleteScope:this},1),this._defender.currentHealth>0&&a.game.grid.findTileDistance(this._attacker._tile,this._defender.tile)<=this._defender.currentAttackRange&&this._timeline.call(function(){this._defender instanceof r?a.audio.playSound(this.ARR_PLAYER_ATTACK_SOUND_ID[a.randomIntFromInterval(0,this.ARR_PLAYER_ATTACK_SOUND_ID.length-1)]):this._defender instanceof o&&a.audio.playSound(this.ARR_ENEMY_ATTACK_SOUND_ID[a.randomIntFromInterval(0,this.ARR_ENEMY_ATTACK_SOUND_ID.length-1)])},null,this,1.75).to(this._arrScreenSideContainer[this._attackerIndex],.2,{x:this._arrScreenSideContainer[this._defenderIndex].x+10,ease:RoughEase.ease.config({strength:8,points:20,template:Linear.easeNone,randomize:!1}),onStart:function(){this._arrHealthBar[this._attackerIndex].setHealth(this._attacker.currentHealth,!0),this._createDamageTakenText(this._attackerIndex,this._defender),this._attacker instanceof r?a.audio.playSound(this.ARR_PLAYER_HIT_SOUND_ID[a.randomIntFromInterval(0,this.ARR_PLAYER_HIT_SOUND_ID.length-1)]):this._attacker instanceof o&&a.audio.playSound(this.ARR_ENEMY_HIT_SOUND_ID[a.randomIntFromInterval(0,this.ARR_ENEMY_HIT_SOUND_ID.length-1)]),this._arrDamageTakenAnimation[this._attackerIndex].play()},onStartScope:this,onComplete:function(){this._arrScreenSideContainer[this._attackerIndex].x=0,0==this._attacker.currentHealth&&(TweenMax.killTweensOf(this._arrCharacterSprite[this._attackerIndex],{x:!0,y:!0}),TweenMax.to(this._arrCharacterSprite[this._attackerIndex],1,{alpha:0,ease:Sine.easeIn}),TweenMax.to(this._arrCharacterSprite[this._attackerIndex],1,{y:this._arrCharacterSprite[this._attackerIndex].y+300,ease:Sine.easeIn}),TweenMax.to(this._arrCharacterSprite[this._attackerIndex],.15,{x:this._arrCharacterSprite[this._attackerIndex].x-50*(0==this._attackerIndex?1:-1),ease:Linear.easeInOut,yoyo:!0,repeat:-1}))},onCompleteScope:this}),this._timeline.addLabel("end","+=1"),this._timeline.to(this._titleText.scale,.5,{x:0,y:0,ease:Back.easeIn},"end-=0.25");var p=!0,u=!1,d=void 0;try{for(var I,T=this._arrHealthBar[Symbol.iterator]();!(p=(I=T.next()).done);p=!0){var c=I.value;this._timeline.to(c.scale,.5,{x:0,y:0,ease:Back.easeIn},"end-=0.25")}}catch(t){u=!0,d=t}finally{try{!p&&T.return&&T.return()}finally{if(u)throw d}}this._timeline.to(this._darkBgSprite,.5,{alpha:0,ease:Sine.easeInOut},"end");for(var i=0;i<2;++i)this._timeline.to(this._arrScreenSideContainer[i].position,.5,{y:a.STAGE_HEIGHT*(0==i?-1:1),ease:Sine.easeInOut},"end");this._timeline.call(function(){this._isCompleted=!0},null,this,"+=0.5")},n.prototype._createDamageTakenText=function(t,e){var i=new PIXI.Container;i.anchor=new PIXI.Point(.5,.5),i.position.x=.5*a.STAGE_WIDTH+110*(0==t?-1:1),i.position.y=.5*a.STAGE_HEIGHT-80,i.scale=new PIXI.Point,i.rotation=.05*Math.PI*(0==t?-1:1),this.addChild(i);var n=new PIXI.extras.BitmapText("-"+this._arrDamageTaken[t].base,{font:"100px ed_110",align:"center"});if(n.anchor=new PIXI.Point(.5,.5),i.addChild(n),e.hasCondition(s.COND_ID_DOUBLE_DAMAGE)){var r=new PIXI.Sprite(a.assets.getTexture("battle_attack"));r.x+=.5*n.width+10,r.y-=50,r.scale=new PIXI.Point(.7,.7),i.addChild(r)}if(TweenMax.to(i.scale,.5,{x:1,y:1,ease:Back.easeOut}),TweenMax.to(i,1,{rotation:Math.PI*-.1*(0==t?-1:1),ease:Sine.easeInOut}),TweenMax.to(i,1,{x:i.x-25*(0==t?-1:1),y:i.y-25,ease:Sine.easeInOut}),TweenMax.to(i,.25,{delay:.75,alpha:0,ease:Sine.easeInOut,onComplete:function(){this.parent.removeChild(this)},onCompleteScope:i}),this._arrDamageTaken[t].bonus>0){var o=new PIXI.Container;o.anchor=new PIXI.Point(.5,.5),o.x=.5*a.STAGE_WIDTH+200*(0==t?-1:1),o.y=.5*a.STAGE_HEIGHT-40,o.scale=new PIXI.Point,o.rotation=.05*Math.PI*(0==t?-1:1),this.addChild(o);var h=new PIXI.extras.BitmapText("-"+this._arrDamageTaken[t].bonus,{font:"100px ed_110_gradient",align:"center"});h.anchor=new PIXI.Point(.5,.5),o.addChild(h);var _=new PIXI.Sprite(a.assets.getTexture("battle_essence_"+s.getEssenceColorId(e.essenceType)));_.x+=.5*h.width+20,_.y-=50,_.scale=new PIXI.Point(.8,.8),o.addChild(_),TweenMax.to(o.scale,.5,{x:1,y:1,ease:Back.easeOut,delay:.25}),TweenMax.to(o,1,{rotation:Math.PI*-.1*(0==t?-1:1),ease:Sine.easeInOut,delay:.25}),TweenMax.to(o,1,{x:o.x-25*(0==t?-1:1),y:o.y-25,ease:Sine.easeInOut,delay:.25}),TweenMax.to(o,.25,{delay:1,alpha:0,ease:Sine.easeInOut,onComplete:function(){this.parent.removeChild(this)},onCompleteScope:o})}},Object.defineProperty(n.prototype,"attacker",{get:function(){return this._attacker}}),Object.defineProperty(n.prototype,"defender",{get:function(){return this._defender}}),Object.defineProperty(n.prototype,"isCompleted",{get:function(){return this._isCompleted}})},{"../../Common":6,"../../CommonGame":7,"../../game/world/Character":29,"../../game/world/EnemyCharacter":31,"../../game/world/PlayerCharacter":36,"../UIHealthBar":54,"./combat/BurstCombatAnimation":70,"./combat/HScrollCombatBg":71,"./combat/RadialCombatBg":72}],61:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._messageSprite=null,this._messageText=null,this._yesBtn=null,this._noBtn=null,this.signals={},this.signals.onYes=new signals.Signal,this.signals.onNo=new signals.Signal}var a=t("../../Common");t("../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("pause_overlay")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.interactive=!0,this._bgSprite.scale.x=100,this._bgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgSprite),this._messageSprite=new PIXI.Sprite(a.assets.getTexture("areyousure_panel")),this._messageSprite.anchor=new PIXI.Point(.5,.5),this._messageSprite.x=.5*a.STAGE_WIDTH,this._messageSprite.y=.5*a.STAGE_HEIGHT,this.addChild(this._messageSprite),this._messageText=new PIXI.extras.BitmapText("aaaa",{font:"50px ed_110_gradient",align:"center"}),this._messageText.anchor=new PIXI.Point(.5,.5),this._messageText.y-=40,this._messageSprite.addChild(this._messageText);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_square_off"),a.assets.getTexture("btn_primary_square_over"),a.assets.getTexture("btn_primary_square_down"),a.assets.getTexture("icon_tick_off"));t.iconOver=a.assets.getTexture("icon_tick_over"),t.iconDown=a.assets.getTexture("icon_tick_down"),this._yesBtn=new p3.Button(t),this._yesBtn.anchor=new PIXI.Point(.5,.5),this._yesBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH+100,.5*a.STAGE_HEIGHT+.5*this._messageSprite.height-90),this._yesBtn.signals.click.add(this.signals.onYes.dispatch,this),this.addChild(this._yesBtn),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_square_off"),a.assets.getTexture("btn_primary_square_over"),a.assets.getTexture("btn_primary_square_down"),a.assets.getTexture("icon_cross_off")),t.iconOver=a.assets.getTexture("icon_cross_over"),t.iconDown=a.assets.getTexture("icon_cross_down"),this._noBtn=new p3.Button(t),this._noBtn.anchor=new PIXI.Point(.5,.5),this._noBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH-100,.5*a.STAGE_HEIGHT+.5*this._messageSprite.height-90),this._noBtn.signals.click.add(this.signals.onNo.dispatch,this),this.addChild(this._noBtn),this.visible=!1},n.prototype.show=function(t){this.visible=!0,this._messageText.text=t,this._bgSprite.alpha=0,this._messageSprite.scale=new PIXI.Point,this._yesBtn.scale=new PIXI.Point,this._noBtn.scale=new PIXI.Point;var e=new TimelineMax;e.to(this._bgSprite,.25,{alpha:1,ease:Sine.easeInOut},0).to(this._messageSprite.scale,.25,{x:1,y:1,ease:Back.easeOut}).to(this._yesBtn.scale,.25,{x:1,y:1,ease:Back.easeOut}).to(this._noBtn.scale,.25,{x:1,y:1,ease:Back.easeOut})},n.prototype.hide=function(){var t=new TimelineMax;t.to(this._noBtn.scale,.25,{x:0,y:0,ease:Back.easeIn},0).to(this._yesBtn.scale,.25,{x:0,y:0,ease:Back.easeIn},0).to(this._messageSprite.scale,.25,{x:0,y:0,ease:Back.easeIn}).addLabel("end").to(this._bgSprite,.25,{alpha:0,ease:Sine.easeInOut,onComplete:function(){this.visible=!1},onCompleteScope:this},"end")}},{"../../Common":6,"../../CommonGame":7}],62:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._continueBtn=null,this._bgGradientSprite=null,this._bgTopSprite=null,this._bgBotSprite=null,this._titleText=null,this._teamSprite=null,this._radialSprite_00=null,this._radialSprite_01=null,this._starsSprite=null,this._uiTopBarSharedControls=null,this.signals={},this.signals.onClosed=new signals.Signal,this.signals.onHidden=new signals.Signal}var a=t("../../Common"),s=(t("../../CommonGame"),t("../UITopBarSharedControls"));e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgGradientSprite=new PIXI.Sprite(a.assets.getTexture("results_overlay")),this._bgGradientSprite.anchor=new PIXI.Point(.5,.5),this._bgGradientSprite.scale.x=100,this._bgGradientSprite.interactive=!0,this._bgGradientSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgGradientSprite),this._bgTopSprite=new PIXI.Sprite(a.blankTexture),this._bgTopSprite.anchor=new PIXI.Point(1,1),this._bgTopSprite.position=new PIXI.Point(a.STAGE_WIDTH,0),this.addChild(this._bgTopSprite),this._radialSprite_00=new PIXI.Sprite(a.assets.getTexture("gameover_radial_001")),this._radialSprite_00.anchor=new PIXI.Point(.5,.5),this._radialSprite_00.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._radialSprite_00),TweenMax.to(this._radialSprite_00,5,{rotation:2*Math.PI,repeat:-1,ease:Linear.easeInOut}),this._radialSprite_01=new PIXI.Sprite(a.assets.getTexture("gameover_radial_002")),this._radialSprite_01.anchor=new PIXI.Point(.5,.5),this._radialSprite_01.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._radialSprite_01),TweenMax.to(this._radialSprite_01,6,{rotation:2*Math.PI,repeat:-1,ease:Linear.easeInOut}),this._teamSprite=new PIXI.Sprite(a.blankTexture),this._teamSprite.anchor=new PIXI.Point(.5,.5),this._teamSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._teamSprite),this._bgBotSprite=new PIXI.Sprite(a.blankTexture),this._bgBotSprite.anchor=new PIXI.Point(0,0),this._bgBotSprite.position=new PIXI.Point(0,a.STAGE_HEIGHT),this.addChild(this._bgBotSprite),this._starsSprite=new PIXI.Sprite(a.assets.getTexture("splash_title_front")),this._starsSprite.anchor=new PIXI.Point(.5,.5),this._starsSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._starsSprite),this._titleText=new PIXI.extras.BitmapText("A",{font:"100px ed_110_gradient",align:"center"}),this._titleText.anchor=new PIXI.Point(.5,.5),this._titleText.x=.5*a.STAGE_WIDTH,this._titleText.y=this._titleText.height,this.addChild(this._titleText);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("btn_next_off"));t.iconOver=a.assets.getTexture("btn_next_over"),t.iconDown=a.assets.getTexture("btn_next_down"),this._continueBtn=new p3.Button(t),this._continueBtn.anchor=new PIXI.Point(.5,.5),this._continueBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT+290),this._continueBtn.signals.click.addOnce(this.signals.onClosed.dispatch,this),this.addChild(this._continueBtn),this._uiTopBarSharedControls=new s,this._uiTopBarSharedControls.init(),this._uiTopBarSharedControls.homeBtn.visible=!1,this.addChild(this._uiTopBarSharedControls)},n.prototype.resize=function(){this._uiTopBarSharedControls.resize()},n.prototype.show=function(t){this._updateUI(t),this._bgGradientSprite.alpha=0,this._titleText.x-=100,this._titleText.alpha=0,this._continueBtn.x-=100,this._continueBtn.alpha=0,this._bgTopSprite.y=0,this._bgBotSprite.y=a.STAGE_HEIGHT,this._radialSprite_00.alpha=0,this._radialSprite_01.alpha=0,this._starsSprite.scale=new PIXI.Point,this._teamSprite.scale=new PIXI.Point;var e=new TimelineMax;e.to(this._bgGradientSprite,.3,{alpha:1,ease:Sine.easeOut},0).to(this._bgTopSprite,.3,{y:this._bgTopSprite.height,ease:Sine.easeOut},.2).to(this._bgBotSprite,.3,{y:a.STAGE_HEIGHT-this._bgBotSprite.height,ease:Sine.easeOut},.2).to(this._titleText,.25,{alpha:1,x:this._titleText.x+100,ease:Sine.easeOut},.2).to(this._continueBtn,.25,{alpha:1,x:this._continueBtn.x+100,ease:Sine.easeOut},"radial").to(this._teamSprite.scale,.25,{x:1,y:1,ease:Back.easeOut},"radial").to(this._radialSprite_00,.25,{alpha:1,ease:Sine.easeOut},"radial").to(this._radialSprite_01,.25,{alpha:1,ease:Sine.easeOut},"radial").to(this._starsSprite.scale,.25,{x:1,y:1,ease:Sine.easeOut},"radial").call(function(){TweenMax.to(this._starsSprite.scale,.5,{x:.98,y:.98,ease:Sine.easeInOut,repeat:-1,yoyo:!0})},null,this),a.savedData.arrLevelTile=a.savedData.ARR_LEVEL_TILE_DEFAULT.slice(0),a.savedData.isPlayerTicTacToeTurn=!0,a.savedData.arrUsedEnemyTeam=[],a.savedData.save(),a.audio.playSound(t?"music_gameover_lost_00":"music_level_success_00")},n.prototype.hide=function(){var t=new TimelineMax;t.to(this._bgGradientSprite,.3,{alpha:0,ease:Sine.easeIn},0).to(this._bgTopSprite,.3,{y:0,ease:Sine.easeIn},.2).to(this._bgBotSprite,.3,{y:a.STAGE_HEIGHT,ease:Sine.easeIn},.2).to(this._titleText,.25,{alpha:0,x:this._titleText.x-100,ease:Sine.easeIn},.2).to(this._continueBtn,.25,{alpha:0,x:this._continueBtn.x-100,ease:Sine.easeIn},.2).to(this._radialSprite_00,.25,{alpha:0,ease:Sine.easeIn},.2).to(this._radialSprite_01,.25,{alpha:0,ease:Sine.easeIn},.2).to(this._starsSprite.scale,.25,{x:0,y:0,ease:Sine.easeIn},.2).to(this._teamSprite.scale,.25,{x:0,y:0,ease:Back.easeIn},.2).call(function(){this.signals.onHidden.dispatch()},null,this)},n.prototype._updateUI=function(t){this._bgTopSprite.texture=a.assets.getTexture("pattern_top_"+(t?"bad":"good")),this._bgBotSprite.texture=a.assets.getTexture("pattern_btm_"+(t?"bad":"good")),this._teamSprite.texture=a.assets.getTexture("gameover_char_"+(t?"bad":"good")),this._titleText.text=a.assets.getJSON("languages")[t?"GAME_OVER_BAD":"GAME_OVER_GOOD"][a.language].toUpperCase()}},{"../../Common":6,"../../CommonGame":7,"../UITopBarSharedControls":58}],63:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._continueBtn=null,this._bgGradientSprite=null,this._bgTopSprite=null,this._bgBotSprite=null,this._panelSprite=null,this._coinsText=null,this._titleText=null,this._subtitleText=null,this._arrCharacterSprite=[],this._delta=0,this._uiTopBarSharedControls=null,this.signals={},this.signals.onClosed=new signals.Signal}var a=t("../../Common"),s=t("../../CommonGame"),r=t("../UITopBarSharedControls");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgGradientSprite=new PIXI.Sprite(a.assets.getTexture("results_overlay")),this._bgGradientSprite.anchor=new PIXI.Point(.5,.5),this._bgGradientSprite.scale.x=100,this._bgGradientSprite.interactive=!0,this._bgGradientSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgGradientSprite),this._bgTopSprite=new PIXI.Sprite(a.blankTexture),this._bgTopSprite.anchor=new PIXI.Point(1,1),this._bgTopSprite.position=new PIXI.Point(a.STAGE_WIDTH,0),this.addChild(this._bgTopSprite),this._bgBotSprite=new PIXI.Sprite(a.blankTexture),this._bgBotSprite.anchor=new PIXI.Point(0,0),this._bgBotSprite.position=new PIXI.Point(0,a.STAGE_HEIGHT),this.addChild(this._bgBotSprite),this._panelSprite=new PIXI.Sprite(a.blankTexture),this._panelSprite.anchor=new PIXI.Point(.5,.5),this._panelSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT-40),this.addChild(this._panelSprite),this._titleText=new PIXI.extras.BitmapText("",{font:"76px ed_76_gradient",align:"center"}),this._titleText.anchor=new PIXI.Point(.5,.5),this._titleText.position.x=.5*a.STAGE_WIDTH,this._titleText.position.y=.5*a.STAGE_HEIGHT-180,this.addChild(this._titleText),this._subtitleText=new PIXI.extras.BitmapText("",{font:"50px ed_50",align:"center"}),this._subtitleText.anchor=new PIXI.Point(.5,.5),this._subtitleText.position.x=.5*a.STAGE_WIDTH,this._subtitleText.position.y=.5*a.STAGE_HEIGHT-50,this.addChild(this._subtitleText),this._coinsText=new PIXI.extras.BitmapText("0",{font:"50px ed_50",align:"center"}),this._coinsText.anchor=new PIXI.Point(.5,.5),this._coinsText.x=.5*a.STAGE_WIDTH,this._coinsText.y=.5*a.STAGE_HEIGHT+90,this.addChild(this._coinsText);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("btn_next_off"));t.iconOver=a.assets.getTexture("btn_next_over"),t.iconDown=a.assets.getTexture("btn_next_down"),this._continueBtn=new p3.Button(t),this._continueBtn.anchor=new PIXI.Point(.5,.5),this._continueBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT+290),this._continueBtn.signals.click.addOnce(this._onContinueButton_Click,this),this.addChild(this._continueBtn),this._uiTopBarSharedControls=new r,this._uiTopBarSharedControls.init(),this._uiTopBarSharedControls.homeBtn.visible=!1,this.addChild(this._uiTopBarSharedControls)},n.prototype.resize=function(){this._uiTopBarSharedControls.resize()},n.prototype.show=function(t,e){a.savedData.arrUsedEnemyTeam.push(a.game.enemyTeam),a.savedData.coins+=e,s.selectedLevel.result=t?s.LEVEL_TILE_STATE_BOXMORE:s.LEVEL_TILE_STATE_LAKEWOOD,this._updateUI(t,e),this._animateIn(e),a.audio.stopMusic(),a.audio.playSound(t?"music_gameover_battle_lost_00":"music_level_success_00")},n.prototype._updateUI=function(t,e){this._bgTopSprite.texture=a.assets.getTexture("pattern_top_"+(t?"bad":"good")),this._bgBotSprite.texture=a.assets.getTexture("pattern_btm_"+(t?"bad":"good")),this._panelSprite.texture=a.assets.getTexture("results_panel_"+(t?"bad":"good")),this._titleText.text=a.assets.getJSON("languages")[t?"BAD_LUCK":"AWESOME"][a.language].toUpperCase();var i=a.assets.getJSON("languages")[t?"TEAM_BOX_MORE":"TEAM_LAKEWOOD"][a.language].toUpperCase();if(i+=" "+a.assets.getJSON("languages").WINS[a.language].toUpperCase(),this._subtitleText.text=i,t){var n=[450,250,-400],r=a.game.enemyTeam;r.sort(function(t,e){var i=a.assets.getJSON("enemyCharacters").enemyCharacters;return i[t].preBattle.priority-i[e].preBattle.priority});for(var o=s.PLAYER_TEAM_SIZE-1;o>=0;--o){var h=a.assets.getJSON("enemyCharacters").enemyCharacters[r[o]],_=new PIXI.Sprite(a.assets.getTexture("battle_char_"+h.spritePrefix));_.anchor=new PIXI.Point(.5,1),_.x=.5*a.STAGE_WIDTH+n[o],_.y=a.STAGE_HEIGHT+30,o==s.PLAYER_TEAM_SIZE-1&&(_.scale.x=-1),this.addChild(_),this._arrCharacterSprite.push(_)}}else{var l=[-250,-450,400],c=[],p=!0,u=!1,d=void 0;try{for(var I,T=a.savedData.arrTeamCharId[Symbol.iterator]();!(p=(I=T.next()).done);p=!0){var m=I.value;c.push(m)}}catch(t){u=!0,d=t}finally{try{!p&&T.return&&T.return()}finally{if(u)throw d}}c.sort(function(t,e){var i=a.assets.getJSON("playerCharacters").playerCharacters;return i[t].preBattle.priority-i[e].preBattle.priority});for(var o=s.PLAYER_TEAM_SIZE-1;o>=0;--o){var y=a.assets.getJSON("playerCharacters").playerCharacters[c[o]],g=new PIXI.Sprite(a.assets.getTexture("battle_char_"+y.spritePrefix));g.anchor=new PIXI.Point(.5,1),g.x=.5*a.STAGE_WIDTH+l[o],g.y=a.STAGE_HEIGHT+30,o==s.PLAYER_TEAM_SIZE-1&&(g.scale.x=-1),this.addChild(g),this._arrCharacterSprite.push(g)}}},n.prototype._animateIn=function(t){this._panelSprite.scale=new PIXI.Point(.8,.8),this._bgTopSprite.y=0,this._bgBotSprite.y=a.STAGE_HEIGHT,this._subtitleText.x-=100,this._subtitleText.alpha=0,this._titleText.x-=100,this._titleText.alpha=0,this._continueBtn.x-=100,this._continueBtn.alpha=0;var e=new TimelineMax;e.to(this._panelSprite.scale,.2,{x:1,y:1,ease:Back.easeOut},0).to(this._bgTopSprite,.3,{y:this._bgTopSprite.height,ease:Sine.easeOut},.2).to(this._bgBotSprite,.3,{y:a.STAGE_HEIGHT-this._bgBotSprite.height,ease:Sine.easeOut},.2).to(this._titleText,.25,{alpha:1,x:this._titleText.x+100,ease:Sine.easeOut},.2).to(this._subtitleText,.25,{alpha:1,x:this._subtitleText.x+100,ease:Sine.easeOut}).to(this._continueBtn,.25,{alpha:1,x:this._continueBtn.x+100,ease:Sine.easeOut});var i=0,n=50,s=!0,r=!1,o=void 0;try{for(var h,_=this._arrCharacterSprite[Symbol.iterator]();!(s=(h=_.next()).done);s=!0){var l=h.value,c=.25+.15*i,p=l.x<.5*a.STAGE_WIDTH?1:-1;l.x+=n*-p,l.alpha=0,TweenMax.to(l,.15,{x:l.x+(1==p?n:-n),ease:Sine.easeOut,delay:c}),TweenMax.to(l,.15,{alpha:1,ease:Sine.easeInOut,delay:c}),++i}}catch(t){r=!0,o=t}finally{try{!s&&_.return&&_.return()}finally{if(r)throw o}}t>0&&TweenMax.to(this,1,{_delta:1,onUpdate:function(t){this._coinsText.text=Math.ceil(this._delta*t).toString()},onUpdateScope:this,onUpdateParams:[t],onComplete:function(){TweenMax.to(this._coinsText.scale,.15,{x:1.5,y:1.5,ease:Sine.easeOut,yoyo:!0,repeat:1})},onCompleteScope:this})},n.prototype._onContinueButton_Click=function(){a.main.application.loadScene(s.SCENE_ID_LEVEL_SELECTION)}},{"../../Common":6,"../../CommonGame":7,"../UITopBarSharedControls":58}],64:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._nextBtn=null,this._prevBtn=null,this._panelSprite=null,this._borderSprite=null,this._currentHelpSpriteIndex=0,this._helptText=null,this._arrHelpSprite=[],this.ARR_HELP_SPRITE_INFO=[{id:"pause_help_001",message:a.assets.getJSON("languages").HELP_SCREEN_00[a.language],initFunc:null},{id:"pause_help_002",message:a.assets.getJSON("languages").HELP_SCREEN_01[a.language],initFunc:null},{id:"pause_help_003",message:a.assets.getJSON("languages").HELP_SCREEN_02[a.language],initFunc:null},{id:"pause_help_004",message:a.assets.getJSON("languages").HELP_SCREEN_03[a.language],initFunc:null},{id:"pause_help_005",message:a.assets.getJSON("languages").HELP_SCREEN_04[a.language],initFunc:this._initCharStatsHelp},{id:"pause_help_006",message:a.assets.getJSON("languages").HELP_SCREEN_05[a.language],initFunc:this._initSpecialAbilitiesHelp}],this.signals={},this.signals.onNextPressed=new signals.Signal}var a=t("../../Common");t("../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._panelSprite=new PIXI.Sprite(a.assets.getTexture("pause_panel")),this._panelSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._panelSprite);for(var t=0;t<this.ARR_HELP_SPRITE_INFO.length;++t){var e=new PIXI.Sprite(a.assets.getTexture(this.ARR_HELP_SPRITE_INFO[t].id));e.visible=t==this._currentHelpSpriteIndex,e.anchor=new PIXI.Point(.5,.5),this._panelSprite.addChild(e),null!=this.ARR_HELP_SPRITE_INFO[t].initFunc&&this.ARR_HELP_SPRITE_INFO[t].initFunc(e),this._arrHelpSprite.push(e)}this._helpText=new PIXI.extras.BitmapText("",{font:"38px ed_50",align:"center"}),this._helpText.anchor=new PIXI.Point(.5,.5),this._helpText.y=150,this._panelSprite.addChild(this._helpText);var i=new p3.ButtonStates(a.assets.getTexture("btn_next_off"),a.assets.getTexture("btn_next_over"),a.assets.getTexture("btn_next_down"));
this._nextBtn=new p3.Button(i),this._nextBtn.anchor=new PIXI.Point(.5,.5),this._nextBtn.position.x=.49*this._panelSprite.width,this._nextBtn.signals.click.add(this._onNextButton_Click,this),this.addChild(this._nextBtn),i=new p3.ButtonStates(a.assets.getTexture("btn_back_off"),a.assets.getTexture("btn_back_over"),a.assets.getTexture("btn_back_down")),this._prevBtn=new p3.Button(i),this._prevBtn.anchor=new PIXI.Point(.5,.5),this._prevBtn.position.x=.49*-this._panelSprite.width,this._prevBtn.signals.click.add(this._onPrevButton_Click,this),this.addChild(this._prevBtn),this._updateUI()},n.prototype.show=function(){this._updateUI(),this._nextBtn.scale=new PIXI.Point,this._panelSprite.scale=new PIXI.Point(.8,.8),this._panelSprite.alpha=0;var t=new TimelineMax;t.to(this._panelSprite.scale,.2,{x:1,y:1,ease:Back.easeOut},0),t.to(this._panelSprite,.2,{alpha:1,ease:Sine.easeOut},0),t.to(this._nextBtn.scale,.2,{x:1,y:1,ease:Sine.easeOut},.2),t.to(this._prevBtn.scale,.2,{x:1,y:1,ease:Sine.easeOut},.2)},n.prototype.hide=function(){var t=new TimelineMax;t.to(this._nextBtn.scale,.2,{x:0,y:0,ease:Sine.easeIn},0),t.to(this._prevBtn.scale,.2,{x:0,y:0,ease:Sine.easeIn},0),t.to(this._panelSprite.scale,.2,{x:.8,y:.8,ease:Back.easeIn},0),t.to(this._panelSprite,.2,{alpha:0,ease:Sine.easeIn},0)},n.prototype.reset=function(){this._currentHelpSpriteIndex=0},n.prototype._updateUI=function(){this._prevBtn.visible=this._currentHelpSpriteIndex>0,this._nextBtn.visible=this._currentHelpSpriteIndex<this._arrHelpSprite.length-1;for(var t=0;t<this._arrHelpSprite.length;++t)this._arrHelpSprite[t].visible=t==this._currentHelpSpriteIndex;this._helpText.text=this.ARR_HELP_SPRITE_INFO[this._currentHelpSpriteIndex].message.toUpperCase()},n.prototype._initCharStatsHelp=function(t){var e=[{text:"DAMAGE",x:-130,y:-125},{text:"ATTACK RANGE",x:130,y:-125},{text:"MOVEMENT",x:-255,y:0},{text:"SPECIAL ABILITY",x:0,y:0},{text:"HEALTH",x:255,y:0}],i=!0,n=!1,a=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var o=s.value,h=new PIXI.extras.BitmapText(o.text,{font:"30px ed_30",align:"center"});h.anchor=new PIXI.Point(.5,.5),h.position=new PIXI.Point(o.x,o.y),t.addChild(h)}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}},n.prototype._initSpecialAbilitiesHelp=function(t){var e=[{text:"SPLASH DAMAGE",x:-135,y:-115},{text:"HEAL YOURSELF",x:135,y:-115},{text:"EXTRA ATTACK",x:-255,y:10},{text:"HEAL OTHERS",x:0,y:10},{text:"EXTRA MOVE",x:255,y:10}],i=!0,n=!1,a=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var o=s.value,h=new PIXI.extras.BitmapText(o.text,{font:"30px ed_30",align:"center"});h.anchor=new PIXI.Point(.5,.5),h.position=new PIXI.Point(o.x,o.y),t.addChild(h)}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}},n.prototype._onNextButton_Click=function(){this._currentHelpSpriteIndex<this._arrHelpSprite.length-1&&(this._currentHelpSpriteIndex+=1,this._updateUI(),this._panelSprite.scale=new PIXI.Point(.9,.9),TweenMax.to(this._panelSprite.scale,.2,{x:1,y:1,ease:Back.easeOut},0)),a.audio.playSound("sfx_btn_press_fwd_00"),this.signals.onNextPressed.dispatch(this._currentHelpSpriteIndex)},n.prototype._onPrevButton_Click=function(){this._currentHelpSpriteIndex>0&&(this._currentHelpSpriteIndex-=1,this._updateUI(),this._panelSprite.scale=new PIXI.Point(.9,.9),TweenMax.to(this._panelSprite.scale,.2,{x:1,y:1,ease:Back.easeOut},0)),a.audio.playSound("sfx_btn_press_back_00")}},{"../../Common":6,"../../CommonGame":7}],65:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._helpBox=null,this._bgGradientSprite=null,this._playBtn=null,this.signals={},this.signals.onClosed=new signals.Signal,this.signals.onHidden=new signals.Signal}var a=t("../../Common"),s=(t("../../CommonGame"),t("./HelpBox"));e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgGradientSprite=new PIXI.Sprite(a.assets.getTexture("results_overlay")),this._bgGradientSprite.anchor=new PIXI.Point(.5,.5),this._bgGradientSprite.scale.x=100,this._bgGradientSprite.interactive=!0,this._bgGradientSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgGradientSprite),this._helpBox=new s,this._helpBox.anchor=new PIXI.Point(.5,.5),this._helpBox.init(),this._helpBox.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this._helpBox.signals.onNextPressed.add(this._onNext_Pressed,this),this.addChild(this._helpBox);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("icon_primary_play_off"));t.iconOver=a.assets.getTexture("icon_primary_play_over"),t.iconDown=a.assets.getTexture("icon_primary_play_down"),this._playBtn=new p3.Button(t),this._playBtn.anchor=new PIXI.Point(.5,.5),this._playBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT+300),this._playBtn.visible=!1,this._playBtn.signals.click.add(this.signals.onClosed.dispatch,this),this.addChild(this._playBtn)},n.prototype.show=function(){this._bgGradientSprite.alpha=0,TweenMax.to(this._bgGradientSprite,.3,{alpha:1,ease:Sine.easeOut}),this._helpBox.show()},n.prototype.hide=function(){TweenMax.to(this._bgGradientSprite,.3,{alpha:0,ease:Sine.easeIn,onComplete:function(){this.signals.onHidden.dispatch()},onCompleteScope:this}),TweenMax.to(this._playBtn.scale,.25,{x:0,y:0,ease:Sine.easeIn}),this._helpBox.hide()},n.prototype._onNext_Pressed=function(t){t!=this._helpBox.ARR_HELP_SPRITE_INFO.length-1||this._playBtn.visible||(this._playBtn.visible=!0,this._playBtn.scale=new PIXI.Point,TweenMax.to(this._playBtn.scale,.25,{x:1,y:1,ease:Sine.easeOut}))}},{"../../Common":6,"../../CommonGame":7,"./HelpBox":64}],66:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._titleText=null,this._yesButton=null,this._noButton=null}var a=t("../../Common"),s=t("../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.blankTexture),this._bgSprite.tint=0,this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.width=a.STAGE_WIDTH,this._bgSprite.height=a.STAGE_HEIGHT,this._bgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this._bgSprite.interactive=!0,this.addChild(this._bgSprite),this._titleText=new PIXI.Text("Are you sure?",{font:"68px Arial",fill:"#ffffff",align:"center",cacheAsBitmap:!0}),this._titleText.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT-.25*this._bgSprite.height),this._titleText.anchor=new PIXI.Point(.5,.5),this.addChild(this._titleText),this._noButton=p3.Button.create(a.assets.getTexture("btn_small_off"),a.assets.getTexture("btn_small_over"),a.assets.getTexture("btn_small_over"),a.assets.getTexture("icon_small_sound_off")),this._noButton.anchor=new PIXI.Point(.5,.5),this._noButton.scale=new PIXI.Point(.5,.5),this._noButton.position=new PIXI.Point(.5*a.STAGE_WIDTH-100,a.STAGE_HEIGHT-150),this._noButton.signals.click.addOnce(this._onNoButton_Click,this),this.addChild(this._noButton),this._yesButton=p3.Button.create(a.assets.getTexture("btn_small_off"),a.assets.getTexture("btn_small_over"),a.assets.getTexture("btn_small_over"),a.assets.getTexture("icon_small_sound_on")),this._yesButton.anchor=new PIXI.Point(.5,.5),this._yesButton.scale=new PIXI.Point(.5,.5),this._yesButton.position=new PIXI.Point(.5*a.STAGE_WIDTH+100,a.STAGE_HEIGHT-150),this._yesButton.signals.click.addOnce(this._onYesButton_Click,this),this.addChild(this._yesButton)},n.prototype._onYesButton_Click=function(){a.main.application.loadScene(s.SCENE_ID_MAIN)},n.prototype._onNoButton_Click=function(){this.parent.removeChild(this)}},{"../../Common":6,"../../CommonGame":7}],67:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._koSprite=null,this._messageSprite=null,this._messageText=null,this._continueBtn=null,this.signals={},this.signals.onContinue=new signals.Signal}var a=t("../../Common");t("../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("pause_overlay")),this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.interactive=!0,this._bgSprite.scale.x=100,this._bgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgSprite),this._messageSprite=new PIXI.Sprite(a.assets.getTexture("ui_tutorial_panel")),this._messageSprite.anchor=new PIXI.Point(.5,.5),this._messageSprite.x=.5*a.STAGE_WIDTH,this._messageSprite.y=.5*a.STAGE_HEIGHT,this.addChild(this._messageSprite),this._messageText=new PIXI.Text("aaaa",{font:"32px Arial",fill:"#000000",align:"center",cacheAsBitmap:!0,wordWrap:!0,wordWrapWidth:.9*this._messageSprite.width}),this._messageText.anchor=new PIXI.Point(.5,.5),this._messageText.y-=20,this._messageSprite.addChild(this._messageText),this._koSprite=new PIXI.Sprite(a.assets.getTexture("ui_tutorial_ko")),this._koSprite.anchor=new PIXI.Point(.5,1),this._koSprite.x=.5*a.STAGE_WIDTH-350,this._koSprite.y=a.STAGE_HEIGHT,this.addChild(this._koSprite);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("icon_primary_play_off"));t.iconOver=a.assets.getTexture("icon_primary_play_over"),t.iconDown=a.assets.getTexture("icon_primary_play_down"),this._continueBtn=new p3.Button(t),this._continueBtn.anchor=new PIXI.Point(.5,.5),this._continueBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH+.5*this._messageSprite.width,.5*a.STAGE_HEIGHT+.5*this._messageSprite.height-40),this._continueBtn.signals.click.add(this.signals.onContinue.dispatch,this),this.addChild(this._continueBtn),this.visible=!1},n.prototype.show=function(t){this.visible=!0,this._messageText.text=t,this._bgSprite.alpha=0,this._koSprite.y=a.STAGE_HEIGHT+this._koSprite.height,this._messageSprite.scale=new PIXI.Point,this._continueBtn.scale=new PIXI.Point;var e=new TimelineMax;e.to(this._bgSprite,.25,{alpha:1,ease:Sine.easeInOut},0).to(this._koSprite,.25,{y:this._koSprite.y-this._koSprite.height,ease:Sine.easeOut},0).to(this._messageSprite.scale,.25,{x:1,y:1,ease:Back.easeOut}).to(this._continueBtn.scale,.25,{x:1,y:1,ease:Back.easeOut})},n.prototype.hide=function(){var t=new TimelineMax;t.to(this._continueBtn.scale,.25,{x:0,y:0,ease:Back.easeIn},0).to(this._messageSprite.scale,.25,{x:0,y:0,ease:Back.easeIn}).addLabel("end").to(this._koSprite,.25,{y:this._koSprite.y+this._koSprite.height,ease:Sine.easeIn},"end").to(this._bgSprite,.25,{alpha:0,ease:Sine.easeInOut,onComplete:function(){this.visible=!1},onCompleteScope:this},"end")}},{"../../Common":6,"../../CommonGame":7}],68:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._playBtn=null,this._restartBtn=null,this._homeBtn=null,this._bgGradientSprite=null,this._bgTopSprite=null,this._bgBotSprite=null,this._helpBox=null,this._uiTopBarSharedControls=null,this._confirmationPanel=null,this.signals={},this.signals.onClosed=new signals.Signal,this.signals.onHidden=new signals.Signal}var a=t("../../Common"),s=t("../../CommonGame"),r=t("../UITopBarSharedControls"),o=t("./HelpBox"),h=t("./ConfirmationPanel");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgGradientSprite=new PIXI.Sprite(a.assets.getTexture("pause_overlay")),this._bgGradientSprite.anchor=new PIXI.Point(.5,.5),this._bgGradientSprite.scale.x=100,this._bgGradientSprite.interactive=!0,this._bgGradientSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgGradientSprite),this._bgTopSprite=new PIXI.Sprite(a.assets.getTexture("pattern_top_good")),this._bgTopSprite.anchor=new PIXI.Point(1,1),this._bgTopSprite.position=new PIXI.Point(a.STAGE_WIDTH,0),this.addChild(this._bgTopSprite),this._bgBotSprite=new PIXI.Sprite(a.assets.getTexture("pattern_btm_good")),this._bgBotSprite.anchor=new PIXI.Point(0,0),this._bgBotSprite.position=new PIXI.Point(0,a.STAGE_HEIGHT),this.addChild(this._bgBotSprite),this._helpBox=new o,this._helpBox.anchor=new PIXI.Point(.5,.5),this._helpBox.init(),this._helpBox.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._helpBox);var t=new p3.ButtonStates(a.assets.getTexture("btn_primary_centre_off"),a.assets.getTexture("btn_primary_centre_over"),a.assets.getTexture("btn_primary_centre_down"),a.assets.getTexture("icon_primary_play_off"));t.iconOver=a.assets.getTexture("icon_primary_play_over"),t.iconDown=a.assets.getTexture("icon_primary_play_down"),this._playBtn=new p3.Button(t),this._playBtn.anchor=new PIXI.Point(.5,.5),this._playBtn.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT+300),this._playBtn.signals.click.add(this._onPlayButton_Click,this),this.addChild(this._playBtn),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_square_off"),a.assets.getTexture("btn_primary_square_over"),a.assets.getTexture("btn_primary_square_down"),a.assets.getTexture("icon_primary_replay_off")),t.iconOver=a.assets.getTexture("icon_primary_replay_over"),t.iconDown=a.assets.getTexture("icon_primary_replay_down"),this._restartBtn=new p3.Button(t),this._restartBtn.anchor=new PIXI.Point(.5,.5),this._restartBtn.position=new PIXI.Point(this._playBtn.position.x+200,this._playBtn.position.y),this._restartBtn.signals.click.add(this._onRestartButton_Click,this),this.addChild(this._restartBtn),t=new p3.ButtonStates(a.assets.getTexture("btn_primary_square_off"),a.assets.getTexture("btn_primary_square_over"),a.assets.getTexture("btn_primary_square_down"),a.assets.getTexture("icon_primary_exit_left_off")),t.iconOver=a.assets.getTexture("icon_primary_exit_left_over"),t.iconDown=a.assets.getTexture("icon_primary_exit_left_down"),this._homeBtn=new p3.Button(t),this._homeBtn.anchor=new PIXI.Point(.5,.5),this._homeBtn.position=new PIXI.Point(this._playBtn.position.x-200,this._playBtn.position.y),this._homeBtn.signals.click.add(this._onHomeButton_Click,this),this.addChild(this._homeBtn),this._uiTopBarSharedControls=new r,this._uiTopBarSharedControls.init(),this._uiTopBarSharedControls.homeBtn.visible=!1,this.addChild(this._uiTopBarSharedControls),this._confirmationPanel=new h,this._confirmationPanel.init(),this.addChild(this._confirmationPanel),this._confirmationPanel.signals.onNo.add(function(){this._confirmationPanel.hide(),this._confirmationPanel.signals.onYes.removeAll()},this)},n.prototype.resize=function(){this._uiTopBarSharedControls.resize()},n.prototype.show=function(){this._playBtn.scale=new PIXI.Point,this._restartBtn.scale=new PIXI.Point,this._homeBtn.scale=new PIXI.Point,this._bgTopSprite.y=0,this._bgBotSprite.y=a.STAGE_HEIGHT,this._bgGradientSprite.alpha=0;var t=new TimelineMax;t.to(this._bgGradientSprite,.55,{alpha:1,ease:Sine.easeOut},0),t.to(this._playBtn.scale,.25,{x:1,y:1,ease:Sine.easeOut},0),t.to(this._restartBtn.scale,.25,{x:1,y:1,ease:Sine.easeOut},.1),t.to(this._homeBtn.scale,.25,{x:1,y:1,ease:Sine.easeOut},.2),t.to(this._bgTopSprite,.3,{y:this._bgTopSprite.height,ease:Sine.easeOut},.2),t.to(this._bgBotSprite,.3,{y:a.STAGE_HEIGHT-this._bgBotSprite.height,ease:Sine.easeOut},.2),this._helpBox.show(),a.audio.playMusic("music_pause_screen_00")},n.prototype.hide=function(){var t=new TimelineMax;t.to(this._bgGradientSprite,.55,{alpha:0,ease:Sine.easeIn},0),t.to(this._playBtn.scale,.25,{x:0,y:0,ease:Sine.easeIn},0),t.to(this._restartBtn.scale,.25,{x:0,y:0,ease:Sine.easeIn},.1),t.to(this._homeBtn.scale,.25,{x:0,y:0,ease:Sine.easeIn},.2),t.to(this._bgTopSprite,.3,{y:0,ease:Sine.easeIn},.2),t.to(this._bgBotSprite,.3,{y:a.STAGE_HEIGHT,ease:Sine.easeIn},.2),t.call(this._helpBox.hide,null,this._helpBox,.2),t.call(function(){this.signals.onHidden.dispatch()},null,this)},n.prototype._reset=function(){this._helpBox.reset(),a.audio.stopMusic()},n.prototype._onPlayButton_Click=function(){this.signals.onClosed.dispatch(),this._reset()},n.prototype._onRestartButton_Click=function(){this._confirmationPanel.show(a.assets.getJSON("languages").CONFIRMATION[a.language].toUpperCase()),this._confirmationPanel.signals.onYes.addOnce(function(){this._confirmationPanel.hide(),a.game.replay(),this.signals.onClosed.dispatch(),this._reset()},this)},n.prototype._onHomeButton_Click=function(){this._confirmationPanel.show(a.assets.getJSON("languages").CONFIRMATION[a.language].toUpperCase()),this._confirmationPanel.signals.onYes.addOnce(function(){this._confirmationPanel.hide(),a.main.application.loadScene(s.SCENE_ID_MAIN),a.audio.stopMusic()},this)}},{"../../Common":6,"../../CommonGame":7,"../UITopBarSharedControls":58,"./ConfirmationPanel":61,"./HelpBox":64}],69:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._defendText=null,this._levelNameText=null,this._playerTeamNameText=null,this._enemyTeamNameText=null,this._versusSprite=null,this._boxMoreLogoSprite=null,this._lakeWoodLogoSprite=null,this._timeline=null,this._playerTeamBgSprite=null,this._enemyTeamBgSprite=null,this._playerTeamNameSprite=null,this._enemyTeamNameSprite=null,this._graphics=null,this.signals={},this.signals.onAnimateInEnded=new signals.Signal}var a=t("../../Common"),s=t("../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.blankTexture),this._bgSprite.tint=0,this._bgSprite.interactive=!0,this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.width=a.STAGE_WIDTH,this._bgSprite.height=a.STAGE_HEIGHT,this._bgSprite.position=new PIXI.Point(.5*a.STAGE_WIDTH,.5*a.STAGE_HEIGHT),this.addChild(this._bgSprite),this._graphics=new PIXI.Graphics,this._graphics.drawRect(0,.5*(a.STAGE_HEIGHT-400)-100,a.STAGE_WIDTH,500),this._graphics.endFill(),this.addChild(this._graphics),this._playerTeamBgSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_panel_l")),this._playerTeamBgSprite.anchor=new PIXI.Point(.5,.5),this._playerTeamBgSprite.position.x=0,this._playerTeamBgSprite.position.y=.5*a.STAGE_HEIGHT,this._playerTeamBgSprite.mask=this._graphics,this.addChild(this._playerTeamBgSprite),this._enemyTeamBgSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_panel_r")),this._enemyTeamBgSprite.anchor=new PIXI.Point(.5,.5),this._enemyTeamBgSprite.position.x=a.STAGE_WIDTH,this._enemyTeamBgSprite.position.y=.5*a.STAGE_HEIGHT,this._enemyTeamBgSprite.mask=this._graphics,this.addChild(this._enemyTeamBgSprite);var t=[],e=!0,i=!1,n=void 0;try{for(var r,o=a.savedData.arrTeamCharId[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var h=r.value;t.push(h)}}catch(t){i=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(i)throw n}}t.sort(function(t,e){var i=a.assets.getJSON("playerCharacters").playerCharacters;return i[t].preBattle.priority-i[e].preBattle.priority});for(var _=0;_<s.PLAYER_TEAM_SIZE;++_){var l=a.assets.getJSON("playerCharacters").playerCharacters[t[_]],c=new PIXI.Sprite(a.assets.getTexture("battle_char_"+l.spritePrefix));c.anchor=new PIXI.Point(.5,1),c.position.x=-450+110*_,c.position.y=.5*this._playerTeamBgSprite.height,c.position.y+=l.preBattle.offsetY,this._playerTeamBgSprite.addChildAt(c,0)}var p=a.game.enemyTeam;p.sort(function(t,e){var i=a.assets.getJSON("enemyCharacters").enemyCharacters;return i[t].preBattle.priority-i[e].preBattle.priority});for(var _=0;_<s.PLAYER_TEAM_SIZE;++_){var u=a.assets.getJSON("enemyCharacters").enemyCharacters[p[_]],d=new PIXI.Sprite(a.assets.getTexture("battle_char_"+u.spritePrefix));d.anchor=new PIXI.Point(.5,1),d.position.x=480-110*_,d.position.y=.5*this._enemyTeamBgSprite.height,d.position.y+=u.preBattle.offsetY,this._enemyTeamBgSprite.addChildAt(d,0)}this._versusSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_vs")),this._versusSprite.anchor=new PIXI.Point(.5,.5),this._versusSprite.position.x=.5*a.STAGE_WIDTH,this._versusSprite.position.y=.5*a.STAGE_HEIGHT+200,this.addChild(this._versusSprite),this._lakeWoodLogoSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_logo_good")),this._lakeWoodLogoSprite.anchor=new PIXI.Point(.5,.5),this._lakeWoodLogoSprite.position.x=.5*a.STAGE_WIDTH-350,this._lakeWoodLogoSprite.position.y=.5*this._lakeWoodLogoSprite.height,this.addChild(this._lakeWoodLogoSprite),this._boxMoreLogoSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_logo_bad")),this._boxMoreLogoSprite.anchor=new PIXI.Point(.5,.5),this._boxMoreLogoSprite.position.x=.5*a.STAGE_WIDTH+350,this._boxMoreLogoSprite.position.y=this._lakeWoodLogoSprite.position.y,this.addChild(this._boxMoreLogoSprite),this._playerTeamNameSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_name_l")),this._playerTeamNameSprite.anchor=new PIXI.Point(1,.5),this._playerTeamNameSprite.position.x=.5*a.STAGE_WIDTH-68,this._playerTeamNameSprite.position.y=.5*a.STAGE_HEIGHT+200,this.addChild(this._playerTeamNameSprite);var I=a.assets.getJSON("languages").TEAM_LAKEWOOD[a.language].toUpperCase();this._playerTeamNameText=new PIXI.extras.BitmapText(I,{font:"50px ed_50_gradient",align:"center"}),this._playerTeamNameText.anchor=new PIXI.Point(0,.5),this._playerTeamNameText.position.x=.5*a.STAGE_WIDTH-500,this._playerTeamNameText.position.y=this._playerTeamNameSprite.position.y,this.addChild(this._playerTeamNameText),this._enemyTeamNameSprite=new PIXI.Sprite(a.assets.getTexture("lvl_intro_name_r")),this._enemyTeamNameSprite.anchor=new PIXI.Point(0,.5),this._enemyTeamNameSprite.position.x=.5*a.STAGE_WIDTH+80,this._enemyTeamNameSprite.position.y=this._playerTeamNameSprite.position.y,this.addChild(this._enemyTeamNameSprite),I=a.assets.getJSON("languages").TEAM_BOX_MORE[a.language].toUpperCase(),this._enemyTeamNameText=new PIXI.extras.BitmapText(I,{font:"50px ed_50_gradient",align:"center",fill:"#ee1d2b",stroke:"#ffffff",strokeThickness:5}),this._enemyTeamNameText.anchor=new PIXI.Point(1,.5),this._enemyTeamNameText.position.x=.5*a.STAGE_WIDTH+500,this._enemyTeamNameText.position.y=this._playerTeamNameSprite.position.y,this.addChild(this._enemyTeamNameText),this._timeline=new TimelineMax,this._playPreBattleAnim()},n.prototype.animateIn=function(){a.audio.playSound("music_fight_clash_03"),TweenMax.delayedCall(3,this._onPreBattleAnimEnded,null,this)},n.prototype._playPreBattleAnim=function(){this._playerTeamBgSprite.alpha=0,this._playerTeamBgSprite.position.x=0,this._enemyTeamBgSprite.alpha=0,this._enemyTeamBgSprite.position.x=a.STAGE_WIDTH,this._versusSprite.scale=new PIXI.Point,this._timeline.to(this._playerTeamBgSprite,.45,{alpha:1,ease:Sine.easeInOut},.35).to(this._playerTeamBgSprite.position,.5,{x:.5*a.STAGE_WIDTH,ease:Sine.easeInOut},.35).to(this._enemyTeamBgSprite,.45,{alpha:1,ease:Sine.easeInOut},.35).to(this._enemyTeamBgSprite.position,.5,{x:.5*a.STAGE_WIDTH,ease:Sine.easeInOut},.35).to(this._versusSprite.scale,.25,{x:1,y:1,ease:Back.easeOut});for(var t=0;t<this._playerTeamBgSprite.children.length;++t){var e=this._playerTeamBgSprite.children[t];TweenMax.to(e,5,{x:e.x+10*(t+1),ease:Sine.easeInOut})}for(var t=0;t<this._playerTeamBgSprite.children.length;++t){var e=this._enemyTeamBgSprite.children[t];TweenMax.to(e,5,{x:e.x-10*(t+1),ease:Sine.easeInOut})}},n.prototype._onPreBattleAnimEnded=function(){TweenMax.to(this._playerTeamBgSprite,.5,{x:0,ease:Sine.easeInOut}),TweenMax.to(this._enemyTeamBgSprite,.5,{x:a.STAGE_WIDTH,ease:Sine.easeInOut}),TweenMax.to(this,.45,{alpha:0,ease:Sine.easeInOut,onComplete:function(){this.signals.onAnimateInEnded.dispatch()},onCompleteScope:this})}},{"../../Common":6,"../../CommonGame":7}],70:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._arrBurstSprite=[]}var a=t("../../../Common");t("../../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){for(var t=[new PIXI.Point(150,0),new PIXI.Point((-120),(-180)),new PIXI.Point(270,300),new PIXI.Point(390,(-210)),new PIXI.Point((-480),(-150)),new PIXI.Point(30,300),new PIXI.Point((-570),180),new PIXI.Point((-240),120)],e=0;e<t.length;++e){var i=new PIXI.Sprite(a.assets.getTexture("attack_blue_burst"+a.randomIntFromInterval(1,3).toString()));i.anchor=new PIXI.Point(.5,.5),i.scale=new PIXI.Point,i.rotation=2*Math.PI*Math.random(),i.position=t[e],this.addChild(i),this._arrBurstSprite.push(i)}},n.prototype.setup=function(t){var e=!0,i=!1,n=void 0;try{for(var s,r=this._arrBurstSprite[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var o=s.value;o.texture=a.assets.getTexture("attack_"+t+"_burst"+a.randomIntFromInterval(1,3).toString())}}catch(t){i=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw n}}},n.prototype.play=function(){var t=[],e=!0,i=!1,n=void 0;try{for(var s,r=this._arrBurstSprite[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var o=s.value;t.push(o)}}catch(t){i=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw n}}for(;t.length>0;){var h=a.randomIntFromInterval(0,t.length-1),o=t[h],_=.1*Math.random();o.scale=new PIXI.Point,t.splice(h,1),TweenMax.to(o.scale,.25*Math.random(),{x:1.5-_,y:1.5-_,ease:Back.easeOut,delay:.25*Math.random()})}},n.prototype.clear=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrBurstSprite[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.scale=new PIXI.Point}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}}},{"../../../Common":6,"../../../CommonGame":7}],71:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._arrBgTileSprite=[],this._arrLineTileSprite=[],this._bgTileScrollX=0,this._prevBgTileScrollX=0,this._lineTileScrollX=0,this._prevLineTileScrollX=0,this.SCROLL_X_LIMIT=-3e3}var a=t("../../../Common");t("../../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){for(var t=0;t<3;++t){var e=new PIXI.Sprite(a.assets.getTexture("attack_lines_orange"));e.anchor=new PIXI.Point(1,.5),e.x=-t*e.width,this._arrBgTileSprite.push(e),this.addChild(e)}for(var t=0;t<3;++t){var i=new PIXI.Sprite(a.assets.getTexture("attack_lines_fg_orange"));i.anchor=new PIXI.Point(1,.5),i.scale=new PIXI.Point(2,2),i.x=-t*i.width,this._arrLineTileSprite.push(i),this.addChild(i)}},n.prototype.setup=function(t){var e=!0,i=!1,n=void 0;try{for(var s,r=this._arrBgTileSprite[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var o=s.value;o.texture=a.assets.getTexture("attack_lines_"+t)}}catch(t){i=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw n}}var h=!0,_=!1,l=void 0;try{for(var c,p=this._arrLineTileSprite[Symbol.iterator]();!(h=(c=p.next()).done);h=!0){var u=c.value;u.texture=a.assets.getTexture("attack_lines_fg_"+t)}}catch(t){_=!0,l=t}finally{try{!h&&p.return&&p.return()}finally{if(_)throw l}}TweenMax.to(this,5,{_bgTileScrollX:4e4,ease:Linear.easeInOut,onUpdate:this._onBgTileScrollX_Updated,onUpdateScope:this}),TweenMax.to(this,5,{_lineTileScrollX:28e3,ease:Linear.easeInOut,onUpdate:this._onLineTileScrollX_Updated,onUpdateScope:this})},n.prototype.clear=function(){this._bgTileScrollX=0,this._prevBgTileScrollX=0,this._lineTileScrollX=0,this._prevLineTileScrollX=0,TweenMax.killTweensOf(this);for(var t=0;t<this._arrBgTileSprite.length;++t)this._arrBgTileSprite[t].x=-t*this._arrBgTileSprite[0].width,this._arrLineTileSprite[t].x=-t*this._arrLineTileSprite[0].width},n.prototype._onBgTileScrollX_Updated=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrBgTileSprite[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.x-=this._bgTileScrollX-this._prevBgTileScrollX,s.x<=this.SCROLL_X_LIMIT&&(s.x-=this.SCROLL_X_LIMIT)}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}this._prevBgTileScrollX=this._bgTileScrollX},n.prototype._onLineTileScrollX_Updated=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrLineTileSprite[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.x-=this._lineTileScrollX-this._prevLineTileScrollX,s.x<=this.SCROLL_X_LIMIT&&(s.x-=this.SCROLL_X_LIMIT)}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}this._prevLineTileScrollX=this._lineTileScrollX}},{"../../../Common":6,"../../../CommonGame":7}],72:[function(t,e,i){"use strict";function n(){PIXI.Container.call(this),this._bgSprite=null,this._centreSprite=null,this._arrRadialSprite=[]}var a=t("../../../Common");t("../../../CommonGame");e.exports=n,n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.init=function(){this._bgSprite=new PIXI.Sprite(a.assets.getTexture("attack_blue_bg")),this._bgSprite.scale=new PIXI.Point(2.7,2.7),this._bgSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._bgSprite);for(var t=0;t<2;++t){var e=new PIXI.Sprite(a.assets.getTexture("attack_blue_radial_00"+(t+1).toString()));e.anchor=new PIXI.Point(.5,.5),e.scale=new PIXI.Point(2.7,2.7),this.addChild(e),this._arrRadialSprite.push(e)}this._centreSprite=new PIXI.Sprite(a.assets.getTexture("attack_blue_centre")),this._centreSprite.anchor=new PIXI.Point(.5,.5),this._centreSprite.scale=new PIXI.Point(1,1),this.addChild(this._centreSprite)},n.prototype.setup=function(t){this._bgSprite.texture=a.assets.getTexture("attack_"+t+"_bg");for(var e=0;e<this._arrRadialSprite.length;++e)this._arrRadialSprite[e].texture=a.assets.getTexture("attack_"+t+"_radial_00"+(e+1).toString()),TweenMax.killTweensOf(this._arrRadialSprite[e]),TweenMax.to(this._arrRadialSprite[e],10+3*e,{rotation:2*Math.PI,repeat:-1,ease:Linear.easeInOut});this._centreSprite.texture=a.assets.getTexture("attack_"+t+"_centre")},n.prototype.clear=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrRadialSprite[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;TweenMax.killTweensOf(s),s.rotation=0}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}}},{"../../../Common":6,"../../../CommonGame":7}]},{},[9]);