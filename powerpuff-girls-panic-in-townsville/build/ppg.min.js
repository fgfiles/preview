/*! ppg 2017-07-11 */
var BasicGame={music:null,soundFx:null,juicy:null,screenFlash:null,FXEnabled:null,gamePaused:!1,PPGPlayer:null,lvlFlowIntro:0,lvlFlowPlaying:1,lvlFlowGameOver:2,lvlFlowTutorial:3,lvlFlowState:0,eventIsClicked:!1,wasClicked:!1,currentClickedEvent:"",eventNone:-1,eventComet:0,eventMonster:1,eventSocialNetwork:2,eventDirigible:3,eventPickles:4,eventPopsinger:5,eventHomework:6,eventCometIce:7,cityHealth:1,cityBuildings:[],levelDayTimer:null,levelTotalMinutes:0,score:0,signGood:0,signBad:1,signHeal:2},gameLevels={currentLevelIndex:0,starsData:[],scoresData:[],lastLevelUnlocked:-1,level01DayTime:3,level01:[[BasicGame.eventComet,1,1],[BasicGame.eventCometIce,5,1],[BasicGame.eventComet,1,1],[BasicGame.eventCometIce,6,.4],[BasicGame.eventComet,1,1],[BasicGame.eventCometIce,6,.75],[BasicGame.eventComet,8,.75],[BasicGame.eventComet,1,1],[BasicGame.eventComet,8,.75],[BasicGame.eventComet,6,.75],[BasicGame.eventComet,5,.75],[BasicGame.eventComet,5,1],[BasicGame.eventComet,5,1],[BasicGame.eventCometIce,5,1],[BasicGame.eventComet,1,1],[BasicGame.eventComet,3,.75],[BasicGame.eventComet,3,.75],[BasicGame.eventComet,2,1],[BasicGame.eventComet,5,1],[BasicGame.eventCometIce,2,1],[BasicGame.eventComet,1,1],[BasicGame.eventComet,2,.4],[BasicGame.eventPickles,4,.75],[BasicGame.eventComet,1,1],[BasicGame.eventCometIce,2,.75],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,3,1],[BasicGame.eventComet,1,.4],[BasicGame.eventComet,3,1],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,3,1],[BasicGame.eventComet,1,1],[BasicGame.eventComet,2,.4],[BasicGame.eventCometIce,1,1],[BasicGame.eventComet,2,.75],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,3,1],[BasicGame.eventComet,1,.75],[BasicGame.eventComet,3,1],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,3,1],[BasicGame.eventCometIce,1,1],[BasicGame.eventComet,2,1],[BasicGame.eventComet,1,.75],[BasicGame.eventComet,2,1],[BasicGame.eventCometIce,2,.4],[BasicGame.eventCometIce,2,.75],[BasicGame.eventComet,1,1],[BasicGame.eventComet,2,1],[BasicGame.eventComet,1,1],[BasicGame.eventCometIce,2,1]],level02DayTime:3,level02:[[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,5,.75],[BasicGame.eventCometIce,6,.75],[BasicGame.eventPopsinger,5,1],[BasicGame.eventComet,8,1],[BasicGame.eventComet,5,.75],[BasicGame.eventComet,3,.4],[BasicGame.eventComet,3,.4],[BasicGame.eventComet,3,.4],[BasicGame.eventComet,3,1],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,4,1],[BasicGame.eventCometIce,2,.4],[BasicGame.eventComet,1,1],[BasicGame.eventComet,2,.75],[BasicGame.eventCometIce,2,1],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,8,.4],[BasicGame.eventComet,1,1],[BasicGame.eventComet,3,.4],[BasicGame.eventComet,6,1],[BasicGame.eventPopsinger,2,.75],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,4,1],[BasicGame.eventComet,2,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,8,1],[BasicGame.eventComet,2,.75],[BasicGame.eventComet,2,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,1,.4],[BasicGame.eventComet,3,1],[BasicGame.eventSocialNetwork,2],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,2,1],[BasicGame.eventCometIce,1,.75],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,8,1],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,4,1],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,2,.75],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,5,1],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,2,1],[BasicGame.eventPickles,2]],level03DayTime:3,level03:[[BasicGame.eventHomework,2],[BasicGame.eventMonster,5],[BasicGame.eventComet,5,1],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,1],[BasicGame.eventComet,2,.75],[BasicGame.eventComet,8,.75],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventHomework,2],[BasicGame.eventComet,4,1],[BasicGame.eventComet,4,1],[BasicGame.eventComet,5,.75],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,5,.4],[BasicGame.eventComet,4,.4],[BasicGame.eventComet,3,1],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,4,1],[BasicGame.eventComet,4,.4],[BasicGame.eventComet,3,.4],[BasicGame.eventComet,6,1],[BasicGame.eventSocialNetwork,2,.75],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,3,.4],[BasicGame.eventHomework,2],[BasicGame.eventPopsinger,2],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,3,1],[BasicGame.eventComet,4,.75],[BasicGame.eventComet,4,1],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,5,1],[BasicGame.eventComet,3,1],[BasicGame.eventComet,1,1],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,4,.75],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,3,1],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,3,1],[BasicGame.eventCometIce,2,1],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,4,.75],[BasicGame.eventPickles,2],[BasicGame.eventComet,4,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,3,1],[BasicGame.eventCometIce,2,1],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,2,.75],[BasicGame.eventPickles,2],[BasicGame.eventComet,2,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,2,1],[BasicGame.eventCometIce,1,1],[BasicGame.eventComet,2,.4],[BasicGame.eventCometIce,2,.75],[BasicGame.eventHomework,2],[BasicGame.eventCometIce,2,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,1,1],[BasicGame.eventCometIce,2,1]],level04DayTime:4,level04:[[BasicGame.eventDirigible,2],[BasicGame.eventCometIce,6,1],[BasicGame.eventCometIce,2,.5],[BasicGame.eventCometIce,2,1],[BasicGame.eventComet,2,.75],[BasicGame.eventComet,8,.75],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventHomework,2],[BasicGame.eventCometIce,4,1],[BasicGame.eventComet,4,1],[BasicGame.eventCometIce,5,.75],[BasicGame.eventComet,2,.4],[BasicGame.eventComet,3,1],[BasicGame.eventComet,10,.5],[BasicGame.eventCometIce,2,.5],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,8,1],[BasicGame.eventComet,4,.4],[BasicGame.eventPickles,6,1],[BasicGame.eventCometIce,2,.5],[BasicGame.eventCometIce,4,.5],[BasicGame.eventComet,4,.5],[BasicGame.eventPopsinger,2,.5],[BasicGame.eventComet,3,.4],[BasicGame.eventHomework,2],[BasicGame.eventCometIce,4,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,4,1],[BasicGame.eventCometIce,4,.75],[BasicGame.eventComet,2,1],[BasicGame.eventComet,3,.4],[BasicGame.eventComet,2,1],[BasicGame.eventPickles,10,1],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,5,1],[BasicGame.eventComet,4,.75],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,3,1],[BasicGame.eventCometIce,2,.4],[BasicGame.eventComet,3,1],[BasicGame.eventCometIce,2,.5],[BasicGame.eventCometIce,2,.4],[BasicGame.eventCometIce,4,.75],[BasicGame.eventCometIce,5,1],[BasicGame.eventComet,4,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventPopsinger,2]],level05DayTime:4,level05:[[BasicGame.eventMonster,2],[BasicGame.eventComet,10,1],[BasicGame.eventComet,2,.5],[BasicGame.eventCometIce,2,1],[BasicGame.eventComet,10,.75],[BasicGame.eventComet,2,.5],[BasicGame.eventHomework,2],[BasicGame.eventComet,4,.75],[BasicGame.eventCometIce,4,.75],[BasicGame.eventComet,5,.75],[BasicGame.eventCometIce,2,.4],[BasicGame.eventComet,3,.75],[BasicGame.eventComet,2,.5],[BasicGame.eventCometIce,2,.5],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,6,.4],[BasicGame.eventDirigible,2,.75],[BasicGame.eventComet,2,.5],[BasicGame.eventComet,3,.4],[BasicGame.eventHomework,2],[BasicGame.eventComet,2,.5],[BasicGame.eventCometIce,8,1],[BasicGame.eventComet,4,.75],[BasicGame.eventCometIce,5,.4],[BasicGame.eventComet,5,1],[BasicGame.eventComet,2,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventComet,5,1],[BasicGame.eventCometIce,4,.75],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,2,.5],[BasicGame.eventPopsinger,4,.75],[BasicGame.eventPickles,2],[BasicGame.eventComet,5,1],[BasicGame.eventCometIce,4,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventPopsinger,2],[BasicGame.eventCometIce,2,.4],[BasicGame.eventComet,1,.75],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,2,.4],[BasicGame.eventComet,2,.75],[BasicGame.eventHomework,2],[BasicGame.eventCometIce,2,.4],[BasicGame.eventSocialNetwork,2],[BasicGame.eventCometIce,8,1],[BasicGame.eventComet,2,.4],[BasicGame.eventCometIce,2,.75],[BasicGame.eventHomework,2],[BasicGame.eventCometIce,2,1]]};BasicGame.Boot=function(a){a.state.add("Preloader",BasicGame.Preloader),a.state.add("MainMenu",BasicGame.MainMenu),a.state.add("LevelSelector",BasicGame.LevelSelector),a.state.add("Game",BasicGame.Game),a.state.add("GameEnd",BasicGame.GameEnd)},BasicGame.Boot.prototype={init:function(){this.input.maxPointers=1,this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.game.device.desktop||(this.scale.forceOrientation(!0,!1),this.scale.setResizeCallback(this.gameResized,this),this.scale.enterIncorrectOrientation.add(this.enterIncorrectOrientation,this),this.scale.leaveIncorrectOrientation.add(this.leaveIncorrectOrientation,this)),this.scale.refresh()},preload:function(){this.load.image("preloaderBarBack","assets/images/barEmpty.png"),this.load.image("preloaderBar","assets/images/barFull.png")},create:function(){this.state.start("Preloader")},gameResized:function(a,b){},enterIncorrectOrientation:function(){BasicGame.orientated=!1,document.getElementById("orientation").style.display="block",this.game.paused=!0},leaveIncorrectOrientation:function(){BasicGame.orientated=!0,document.getElementById("orientation").style.display="none",this.game.paused=!1}},BasicGame.Game=function(a){},BasicGame.Game.prototype={create:function(){switch(BasicGame.lvlFlowState=BasicGame.lvlFlowIntro,gameLevels.currentLevelIndex){case 0:this.currentLevel=gameLevels.level01,BasicGame.levelTotalMinutes=Phaser.Timer.MINUTE*gameLevels.level01DayTime;break;case 1:this.currentLevel=gameLevels.level02,BasicGame.levelTotalMinutes=Phaser.Timer.MINUTE*gameLevels.level02DayTime;break;case 2:this.currentLevel=gameLevels.level03,BasicGame.levelTotalMinutes=Phaser.Timer.MINUTE*gameLevels.level03DayTime;break;case 3:this.currentLevel=gameLevels.level04,BasicGame.levelTotalMinutes=Phaser.Timer.MINUTE*gameLevels.level04DayTime;break;case 4:this.currentLevel=gameLevels.level05,BasicGame.levelTotalMinutes=Phaser.Timer.MINUTE*gameLevels.level05DayTime}this.currentEventsTimer=0,this.timeToNextEvent=this.currentLevel[0][1],this.currentEventIndex=0,this.tutoFingersCount=4,this.physics.startSystem(Phaser.Physics.ARCADE),this.game.world.setBounds(0,0,4e3,1224),BasicGame.levelDayTimer=this.game.time.create(!0),BasicGame.levelDayTimer.add(BasicGame.levelTotalMinutes,function(){},this),this.backSky=this.add.tileSprite(0,0,this.game.width,this.game.height,"scene1","cielo"),this.backSky.postUpdate=function(){this.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y;var a;a=BasicGame.lvlFlowState==BasicGame.lvlFlowIntro||BasicGame.lvlFlowState==BasicGame.lvlFlowTutorial?BasicGame.levelTotalMinutes:BasicGame.levelDayTimer.duration;var b=a/BasicGame.levelTotalMinutes;this.tilePosition.set(.25*-this.game.camera.view.x,-this.game.camera.view.y-1024*b)},this.backLayer02=this.add.tileSprite(0,0,this.game.width,this.game.height,"nubes"),this.backLayer02.postUpdate=function(){this.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y,this.tilePosition.set(.6*-this.game.camera.view.x,.6*-this.game.camera.view.y)},this.backLayerBuildings=this.add.tileSprite(0,this.game.world.height,this.game.width,512,"scene1"),this.backLayerBuildings.anchor.set(0,1),this.backLayerBuildings.animations.add("damage01",["buildingsHorizonte"]),this.backLayerBuildings.animations.add("damage02",["buildingsHorizonte02"]),this.backLayerBuildings.animations.add("damage03",["buildingsHorizonte03"]),this.backLayerBuildings.animations.play("damage01"),this.backLayerBuildings.postUpdate=function(){this.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.tilePosition.set(-this.game.camera.view.x,0)},this.levelBuildingsAmount=4,BasicGame.cityHealth=0,this.lastCityHealth=0,BasicGame.cityBuildings=[];for(var a=0;a<this.levelBuildingsAmount;a++){var b=new Buildings(this.game,.15*this.game.world.width+.2*this.game.world.width*a,this.game.world.height-50,a);this.add.existing(b),b.addDestructionParticles(),BasicGame.cityBuildings.push(b),BasicGame.cityHealth+=b.health}this.grpWarningArrows=this.add.group(),this.grpTutoFingers=this.add.group(),this.BuildingsWithSocialNetwork=[],this.grpSocialNetworkEv=this.add.group(),this.PopSinger=new PopSingers(this.game),this.add.existing(this.PopSinger),this.PopSinger.killAll(),this.monster=new Monster(this.game,0,(-1e3)),this.add.existing(this.monster),this.monster.kill(),this.grpBombs=this.add.group(),this.dirigible=new Dirigible(this.game,0,(-1e3)),this.add.existing(this.dirigible),this.dirigible.kill(),this.grpHomeworkEv=this.add.group(),this.grpComets=this.add.group(),this.grpIceComets=this.add.group(),this.grpPickles=this.add.group(),this.grpExplotions=this.add.group(),this.grpfeedbackSigns=this.add.group(),this.mayor=new Mayor(this.game,500,500),this.add.existing(this.mayor);for(var c=700,d=Math.floor(this.game.world.width/c),a=0;a<d;a++){var e=this.add.image(c*a,this.game.world.height-30,"scene1","Tree");e.anchor.set(0,1)}BasicGame.PPGPlayer=new PowerPuffGirlsPlayer(this.game,.5*this.game.world.width,.5*this.game.world.height-.5*this.game.world.height),this.add.existing(BasicGame.PPGPlayer),this.game.camera.focusOnXY(.5*this.game.world.width,.5*this.game.world.height),this.nigthFilter=this.add.graphics(0,0),this.nigthFilter.fixedToCamera=!0,this.nigthFilter.beginFill(14203,1),this.nigthFilter.alpha=0,this.nigthFilter.drawRect(0,0,this.game.width,this.game.height),this.nigthFilter.endFill();var f=this.game.height-100;this.grpHud=this.add.group(),this.grpHud.fixedToCamera=!0,this.cityLifeBarEmpty=new Phaser.Image(this.game,90,f,"HUD","lifeCityEmpty"),this.grpHud.add(this.cityLifeBarEmpty),this.cityLifeBar=new Phaser.Image(this.game,90,f,"HUD","lifeCityFull"),this.grpHud.add(this.cityLifeBar),this.cityLifeBarRect=new Phaser.Rectangle(0,0,this.cityLifeBar.width,this.cityLifeBar.height),this.cityLifeBar.crop(this.cityLifeBarRect),this.totalStars=3,this.star01Perc=.85,this.star02Perc=.5,this.star03Perc=.2,this.lifeBarStar01=new Phaser.Sprite(this.game,this.cityLifeBar.x+this.cityLifeBar.width*this.star01Perc,f+this.cityLifeBar.height,"HUD"),this.lifeBarStar01.anchor.set(.5),this.lifeBarStar01.animations.add("on",["estrellitaON"]),this.lifeBarStar01.animations.add("off",["estrellitaOFF"]),this.lifeBarStar01.animations.play("on"),this.grpHud.add(this.lifeBarStar01),this.lifeBarStar02=new Phaser.Sprite(this.game,this.cityLifeBar.x+this.cityLifeBar.width*this.star02Perc,f+this.cityLifeBar.height,"HUD"),this.lifeBarStar02.anchor.set(.5),this.lifeBarStar02.animations.add("on",["estrellitaON"]),this.lifeBarStar02.animations.add("off",["estrellitaOFF"]),this.lifeBarStar02.animations.play("on"),this.grpHud.add(this.lifeBarStar02),this.lifeBarStar03=new Phaser.Sprite(this.game,this.cityLifeBar.x+this.cityLifeBar.width*this.star03Perc,f+this.cityLifeBar.height,"HUD"),this.lifeBarStar03.anchor.set(.5),this.lifeBarStar03.animations.add("on",["estrellitaON"]),this.lifeBarStar03.animations.add("off",["estrellitaOFF"]),this.lifeBarStar03.animations.play("on"),this.grpHud.add(this.lifeBarStar03);var g=new Phaser.Image(this.game,55,f+55,"HUD","heartBase");g.anchor.set(.5),this.grpHud.add(g),this.cityHeart=new Phaser.Sprite(this.game,g.x,g.y,"HUD"),this.cityHeart.anchor.set(.5),this.cityHeart.animations.add("full",["heart"],1,!0),this.cityHeart.animations.add("broken",["heartBroken"],1,!0),this.cityHeart.animations.play("full"),this.grpHud.add(this.cityHeart);var h=new Phaser.Image(this.game,this.cityLifeBar.x+this.cityLifeBar.width+15,f+10,"HUD","relojBack");this.grpHud.add(h),this.dayWatchWheel=new Phaser.Sprite(this.game,h.x+.5*h.width,h.y+h.height-13,"HUD","ruedaTiempo"),this.dayWatchWheel.pivot.set(.5*this.dayWatchWheel.width,.5*this.dayWatchWheel.height),this.grpHud.add(this.dayWatchWheel);var i=new Phaser.Graphics(this.game,0,0);i.beginFill(16777215),i.drawRect(this.dayWatchWheel.x-.5*this.dayWatchWheel.width,this.dayWatchWheel.y-.5*this.dayWatchWheel.height,this.dayWatchWheel.width,.5*this.dayWatchWheel.height),this.dayWatchWheel.mask=i,this.grpHud.add(i);var j=new Phaser.Image(this.game,h.x,h.y,"HUD","relojFront");this.grpHud.add(j),BasicGame.score=0,this.txtScore=new Phaser.BitmapText(this.game,h.x+h.width+20,h.y+15,"PPG_font","0",57),this.grpHud.add(this.txtScore);var k=new Phaser.Button(this.game,this.game.width-10,f+10,"HUD",this.openPause,this,"btn_pauseOver","btn_pauseNormal","btn_pauseDown","btn_pauseNormal");k.anchor.set(1,0),k.input.useHandCursor=!1,this.grpHud.add(k),this.game.device.desktop&&(this.cursor=this.add.image(0,0,"HUD","cursor")),this.grpEndLevelWin=this.add.group(),this.grpEndLevelWin.fixedToCamera=!0;var l=.5*this.game.width;this.winScreenBase=new Phaser.Image(this.game,l+94,this.game.height,"HUD","WinScreen_base"),this.winScreenBase.anchor.set(.5,1),this.grpEndLevelWin.add(this.winScreenBase),this.winScreenSelfie=new Phaser.Sprite(this.game,l,.5*this.game.height,"HUD","WinScreen_selfie"),this.winScreenSelfie.anchor.set(.5),this.grpEndLevelWin.add(this.winScreenSelfie);var m=65;this.levelEndStarOff01=new Phaser.Image(this.game,l,m,"HUD","WinScreen_starOff"),this.levelEndStarOff01.anchor.set(.5,0),this.grpEndLevelWin.add(this.levelEndStarOff01),this.levelEndStarOn01=new Phaser.Image(this.game,l,m,"HUD","WinScreen_starOn"),this.levelEndStarOn01.anchor.set(.5,0),this.grpEndLevelWin.add(this.levelEndStarOn01),this.levelEndStarOff02=new Phaser.Image(this.game,l-1.2*this.levelEndStarOff01.width,m,"HUD","WinScreen_starOff"),this.levelEndStarOff02.anchor.set(.5,0),this.grpEndLevelWin.add(this.levelEndStarOff02),this.levelEndStarOn02=new Phaser.Image(this.game,l-1.2*this.levelEndStarOff01.width,m,"HUD","WinScreen_starOn"),this.levelEndStarOn02.anchor.set(.5,0),this.grpEndLevelWin.add(this.levelEndStarOn02),this.levelEndStarOff03=new Phaser.Image(this.game,l+1.2*this.levelEndStarOff01.width,m,"HUD","WinScreen_starOff"),this.levelEndStarOff03.anchor.set(.5,0),this.grpEndLevelWin.add(this.levelEndStarOff03),this.levelEndStarOn03=new Phaser.Image(this.game,l+1.2*this.levelEndStarOff01.width,m,"HUD","WinScreen_starOn"),this.levelEndStarOn03.anchor.set(.5,0),this.grpEndLevelWin.add(this.levelEndStarOn03),this.levelEndLikesBase=new Phaser.Image(this.game,l,this.game.height-200,"HUD","LikeBase"),this.levelEndLikesBase.anchor.set(.5),this.grpEndLevelWin.add(this.levelEndLikesBase),this.txtEndLikes=new Phaser.BitmapText(this.game,l+15,this.levelEndLikesBase.y-5,"PPG_font","0",50),this.txtEndLikes.anchor.set(.5),this.grpEndLevelWin.add(this.txtEndLikes),this.btnContinue=new Phaser.Button(this.game,l,this.game.height-125,"HUD",this.gotoLevelSelector,this,"btn_siguienteOver","btn_siguienteNormal","btn_siguienteDown","btn_siguienteNormal"),this.btnContinue.anchor.set(.5),this.btnContinue.input.useHandCursor=!1,this.grpEndLevelWin.add(this.btnContinue),this.grpEndLevelWin.visible=!1,this.introGirlsAnim=new IntroGirls(this.game),this.add.existing(this.introGirlsAnim),this.grpEndLevelLose=this.add.group(),this.grpEndLevelLose.fixedToCamera=!0,this.backLostScreen=new Phaser.Graphics(this.game,0,0),this.backLostScreen.beginFill(2818079,.7),this.backLostScreen.drawRect(0,0,this.game.width,this.game.height),this.backLostScreen.endFill(),this.grpEndLevelLose.add(this.backLostScreen),this.btnRestart=new Phaser.Button(this.game,.5*this.game.width,this.game.height-100,"HUD",this.restartLevel,this,"btn_replay_over","btn_replay_normal","btn_replay_down","btn_replay_normal"),this.btnRestart.anchor.set(.5),this.btnRestart.input.useHandCursor=!1,this.grpEndLevelLose.add(this.btnRestart),this.gameOverAnim=new GameOverGirls(this.game),this.add.existing(this.gameOverAnim),this.grpEndLevelLose.visible=!1,this.groupPause=new PausePanel(this.game),this.add.existing(this.groupPause),this.groupPause.x=0,this.groupPause.y=0,this.groupPauseShowTween=this.add.tween(this.groupPause),this.groupPauseShowTween.to({x:0},250,Phaser.Easing.Linear.Out),this.txtFPS=this.add.bitmapText(90,this.game.height-20,"PPG_font","0",57),this.txtFPS.fixedToCamera=!0,this.txtFPS.visible=!1,this.txtFPS.anchor.set(1,1),this.bringImportantThingToTop(),this.pauseButton=this.input.keyboard.addKey(Phaser.Keyboard.ESC),this.input.keyboard.addKeyCapture([Phaser.Keyboard.ESC]),this.pauseButton.onDown.add(this.openPause,this),this.game.input.onDown.add(this.stageClicked,this),this.game.input.priorityID=4,0==gameLevels.currentLevelIndex?this.startTutorialState():this.startIntroState(),BasicGame.music.stop(),BasicGame.music.play("musicGameplay")},bringImportantThingToTop:function(){BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&(this.game.world.bringToTop(this.grpComets),this.game.world.bringToTop(this.grpIceComets),this.game.world.bringToTop(this.grpfeedbackSigns),this.game.world.bringToTop(this.grpWarningArrows),this.game.world.bringToTop(this.grpTutoFingers),this.game.world.bringToTop(BasicGame.PPGPlayer),this.game.world.bringToTop(this.nigthFilter),this.game.world.bringToTop(this.grpHud),this.game.world.bringToTop(this.mayor),this.game.world.bringToTop(this.txtFPS),this.game.world.bringToTop(this.groupPause),this.game.device.desktop&&this.game.world.bringToTop(this.cursor))},stageClicked:function(a){BasicGame.currentClickedEvent!=BasicGame.eventMonster&&(BasicGame.eventIsClicked=!1)},spawnComet:function(a){if(BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&!(BasicGame.cityBuildings.length<=0)){var b=this.grpComets.getFirstDead();null==b&&(b=this.addCometToGroup());var c=Math.floor(Math.random()*BasicGame.cityBuildings.length);b.respawnComet(Math.random()*this.game.world.width,0,BasicGame.cityBuildings[c],a);var d=2;a<.85&&(d=1),a<.65&&(d=0),this.spawnWarningArrow(b,!1,d),0==gameLevels.currentLevelIndex&&this.tutoFingersCount>0&&(this.spawnFingerTuto(0,b),this.tutoFingersCount--)}},spawnIceComet:function(a){if(BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&!(BasicGame.cityBuildings.length<=0)){var b=this.grpIceComets.getFirstDead();null==b&&(b=this.addIceCometToGroup());var c=Math.floor(Math.random()*BasicGame.cityBuildings.length);b.respawnCometIce(Math.random()*this.game.world.width,0,BasicGame.cityBuildings[c],a);var d=2;a<.85&&(d=1),a<.65&&(d=0),this.spawnWarningArrow(b,!1,d),0==gameLevels.currentLevelIndex&&this.tutoFingersCount>0&&(this.spawnFingerTuto(2,b),this.tutoFingersCount--)}},spawnPickle:function(){if(BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying){var a=this.grpPickles.getFirstDead();null==a&&(a=this.addPickleToGroup()),a.reset(Math.random()*(this.game.world.width-300)+150,Math.random()*(this.game.world.height-300)+150),this.spawnWarningArrow(a,!0,2)}},spawnSocialNetworkEvent:function(){if(BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&!(BasicGame.cityBuildings.length<=0||this.BuildingsWithSocialNetwork.length>=BasicGame.cityBuildings.length)){var a=this.findBuildingFreeOfSocialNetwork();this.BuildingsWithSocialNetwork.push(a);var b=this.grpSocialNetworkEv.getFirstDead();null==b&&(b=this.addSocialNetEvToGroup()),b.respawnComputer(a.x,this.game.world.height-100,a),this.spawnWarningArrow(b,!1,2),this.bringImportantThingToTop()}},findBuildingFreeOfSocialNetwork:function(){for(var a=0;a<BasicGame.cityBuildings.length;a++){building=BasicGame.cityBuildings[a];var b=this.arrayContains(this.BuildingsWithSocialNetwork,building);if(!b)return building}},freeBuildingFromSocialNetwork:function(a){var b=this.BuildingsWithSocialNetwork.indexOf(a);this.BuildingsWithSocialNetwork.splice(b,1)},arrayContains:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1},spawnHomeworkEvent:function(){if(BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&!(BasicGame.cityBuildings.length<=0)){var a=this.grpHomeworkEv.getFirstDead();null==a&&(a=this.addHomeworkEvToGroup()),a.respawnComputer(Math.random()*this.game.world.width*.5+.5*this.game.world.width-200,this.game.world.height),this.spawnWarningArrow(a,!0,2),this.bringImportantThingToTop()}},spawnWarningArrow:function(a,b,c){var d=this.grpWarningArrows.getFirstDead();null==d&&(d=this.addWarningArrowToGroup()),d.respawnArrow(a,b,c),this.bringImportantThingToTop()},spawnFingerTuto:function(a,b){var c=this.grpTutoFingers.getFirstDead();null==c&&(c=this.addTutoFingerToGroup()),c.respawnFinger(a,b),this.bringImportantThingToTop()},spawnExplotion:function(a,b){var c=this.grpExplotions.getFirstDead();null==c&&(c=this.addExplotionToGroup()),c.respawnExplotion(a,b)},spawnBomb:function(a,b,c){var d=this.grpBombs.getFirstDead();null==d&&(d=this.addBombToGroup()),d.respawnBomb(a,b,c),this.spawnWarningArrow(d,!1,1)},spawnFeedbacksign:function(a,b,c){var d=this.grpfeedbackSigns.getFirstDead();null==d&&(d=this.addFeedbacksignToGroup()),d.respawnSign(a,b,c)},addHomeworkEvToGroup:function(){var a=new Homework(this.game);return this.grpHomeworkEv.add(a),a.kill(),a},addSocialNetEvToGroup:function(){var a=new SocialNetwork(this.game);return this.grpSocialNetworkEv.add(a),a.kill(),a},addCometToGroup:function(){var a=new Comet(this.game);return this.grpComets.add(a),a.kill(),a},addIceCometToGroup:function(){var a=new CometIce(this.game);return this.grpIceComets.add(a),a.kill(),a},addPickleToGroup:function(){var a=new Pickles(this.game);return this.grpPickles.add(a),a.kill(),a},addWarningArrowToGroup:function(){var a=new WarningArrow(this.game);return this.grpWarningArrows.add(a),a.kill(),a},addTutoFingerToGroup:function(){var a=new TutoFinger(this.game);return this.grpTutoFingers.add(a),a.kill(),a},addExplotionToGroup:function(){var a=new Explotion(this.game);return this.grpExplotions.add(a),a.kill(),a},addBombToGroup:function(){var a=new Bomb(this.game);return this.grpBombs.add(a),a.kill(),a},addFeedbacksignToGroup:function(){var a=new FeedbackSign(this.game);return this.grpfeedbackSigns.add(a),a.kill(),a},openPause:function(){BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&(BasicGame.gamePaused=!0,this.physics.arcade.isPaused=BasicGame.gamePaused,this.showPauseMenu(),BasicGame.levelDayTimer.pause(),this.game.time.events.pause())},resumeEvents:function(){BasicGame.levelDayTimer.resume(),this.game.time.events.resume()},restartLevel:function(){this.state.restart()},gotoLevelSelector:function(){this.state.start("LevelSelector")},showPauseMenu:function(){this.groupPause.visible=!0,this.groupPauseShowTween.start(),this.bringImportantThingToTop()},startTutorialState:function(){BasicGame.lvlFlowState=BasicGame.lvlFlowTutorial,this.grpHud.visible=!1;var a=new TutorialPanel(this.game);this.add.existing(a),a.showHidePanel(),this.game.device.desktop&&this.game.world.bringToTop(this.cursor)},startIntroState:function(){BasicGame.lvlFlowState=BasicGame.lvlFlowIntro,this.grpHud.visible=!0,this.introGirlsAnim.showGirls()},startPlayState:function(){BasicGame.lvlFlowState=BasicGame.lvlFlowPlaying,BasicGame.PPGPlayer.girlsGoTo(.5*this.game.world.width,.5*this.game.world.height),BasicGame.levelDayTimer.start()},startNewDangerEvent:function(a,b){switch(this.mayor.showWarning(a),a){case BasicGame.eventComet:this.spawnComet(b);break;case BasicGame.eventCometIce:this.spawnIceComet(b);break;case BasicGame.eventMonster:this.monster.reset(this.game.world.width,this.game.world.height-34),this.spawnWarningArrow(this.monster,!1,2),this.spawnFingerTuto(1,this.monster);break;case BasicGame.eventDirigible:this.dirigible.reset(this.game.world.width,350),this.spawnWarningArrow(this.dirigible,!1,2),this.spawnFingerTuto(1,this.dirigible);break;case BasicGame.eventSocialNetwork:this.spawnSocialNetworkEvent();break;case BasicGame.eventPickles:for(var c=0;c<10;c++)this.spawnPickle();break;case BasicGame.eventPopsinger:this.PopSinger.respawnSinger(),this.spawnWarningArrow(this.PopSinger,!0,1);break;case BasicGame.eventHomework:this.spawnHomeworkEvent()}this.bringImportantThingToTop()},update:function(){this.txtFPS.text=""+this.game.time.fps,this.game.device.desktop&&(this.cursor.x=this.game.input.worldX,this.cursor.y=this.game.input.worldY),this.physics.arcade.isPaused||BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&(this.updatePlayingState(),this.updateCityHealth())},updatePlayingState:function(){this.getNextLevelEvent(),this.game.camera.focusOnXY(BasicGame.PPGPlayer.girlsCenterPoint.x,BasicGame.PPGPlayer.girlsCenterPoint.y),null!=BasicGame.levelDayTimer&&BasicGame.levelDayTimer.duration<=100&&(this.levelEndWon(),BasicGame.levelDayTimer.destroy());var a=1-BasicGame.levelDayTimer.duration/BasicGame.levelTotalMinutes;this.nigthFilter.alpha=.6*a,this.dayWatchWheel.angle=-180*a,this.txtScore.text=""+BasicGame.score,this.game.physics.arcade.collide(BasicGame.PPGPlayer.buttercup,this.grpPickles,this.collidePickle,null,this),this.game.physics.arcade.collide(BasicGame.PPGPlayer.bubbles,this.grpPickles,this.collidePickle,null,this),this.game.physics.arcade.collide(BasicGame.PPGPlayer.blossom,this.grpPickles,this.collidePickle,null,this)},getNextLevelEvent:function(){if(!(this.currentEventIndex>=this.currentLevel.length)){this.currentEventsTimer+=this.game.time.elapsed;var a=1e3*this.timeToNextEvent;if(this.currentEventsTimer>a){var b=this.currentLevel[this.currentEventIndex],c=1;b[0]==BasicGame.eventComet&&(c=b[2]),this.startNewDangerEvent(b[0],c),this.currentEventIndex++,this.currentEventIndex<this.currentLevel.length?(b=this.currentLevel[this.currentEventIndex],this.timeToNextEvent+=b[1]):this.levelEndWon()}}},collidePickle:function(a,b){b.getcollected()},updateCityHealth:function(){if(BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying){BasicGame.cityHealth=0;for(var a=0;a<BasicGame.cityBuildings.length;a++)BasicGame.cityHealth+=BasicGame.cityBuildings[a].health;this.cityLifeBarRect.width=BasicGame.cityHealth*(this.cityLifeBarEmpty.width/this.levelBuildingsAmount),this.cityLifeBar.updateCrop(),BasicGame.cityHealth<this.lastCityHealth?(this.cityLifeBarRect.width<=this.cityLifeBarEmpty.width*this.star01Perc&&(this.lifeBarStar01.animations.play("off"),this.totalStars=2),this.cityLifeBarRect.width<=this.cityLifeBarEmpty.width*this.star02Perc&&(this.lifeBarStar02.animations.play("off"),this.totalStars=1,this.backLayerBuildings.animations.play("damage02")),this.cityLifeBarRect.width<=this.cityLifeBarEmpty.width*this.star03Perc&&(this.lifeBarStar03.animations.play("off"),this.totalStars=0,this.backLayerBuildings.animations.play("damage03"))):(this.cityLifeBarRect.width>this.cityLifeBarEmpty.width*this.star03Perc&&(this.lifeBarStar03.animations.play("on"),this.totalStars=1),this.cityLifeBarRect.width>this.cityLifeBarEmpty.width*this.star02Perc&&(this.lifeBarStar02.animations.play("on"),this.totalStars=2,this.backLayerBuildings.animations.play("damage02")),this.cityLifeBarRect.width>this.cityLifeBarEmpty.width*this.star01Perc&&(this.lifeBarStar01.animations.play("on"),this.totalStars=3,this.backLayerBuildings.animations.play("damage01"))),this.lastCityHealth=BasicGame.cityHealth,BasicGame.cityHealth<=0&&(this.cityHeart.animations.play("broken"),this.levelEndLost())}},endLevelGirlsGoOffscreen:function(){this.grpHud.visible=!1,BasicGame.PPGPlayer.girlsGoTo(-100,-100),BasicGame.music.stop("musicGameplay")},levelEndWon:function(){if(BasicGame.lvlFlowState!=BasicGame.lvlFlowGameOver){if(this.grpBombs.countLiving()>0||this.grpComets.countLiving()>0||this.grpIceComets.countLiving()>0||this.grpSocialNetworkEv.countLiving()>0||this.monster.alive||this.dirigible.alive)return void this.game.time.events.add(5*Phaser.Timer.SECOND,this.levelEndWon,this);BasicGame.soundFx.play("victoria"),this.endLevelGirlsGoOffscreen(),
BasicGame.lvlFlowState=BasicGame.lvlFlowGameOver,this.game.world.bringToTop(this.grpEndLevelWin),this.grpEndLevelWin.visible=!0,this.txtEndLikes.text=""+BasicGame.score,this.game.device.desktop&&this.game.world.bringToTop(this.cursor),this.levelEndStarOn01.scale.set(0),this.levelEndStarOn02.scale.set(0),this.levelEndStarOn03.scale.set(0);var a=500,b=!1,c=!1,d=!1;this.totalStars>0&&(this.game.add.tween(this.levelEndStarOn02.scale).to({x:1,y:1},500,Phaser.Easing.Bounce.Out,!0,a),a+=500,b=!0),this.totalStars>1&&(this.game.add.tween(this.levelEndStarOn01.scale).to({x:1,y:1},500,Phaser.Easing.Bounce.Out,!0,a),a+=500,c=!0),this.totalStars>2&&(this.game.add.tween(this.levelEndStarOn03.scale).to({x:1,y:1},500,Phaser.Easing.Bounce.Out,!0,a),a+=500,d=!0);var e=gameLevels.currentLevelIndex,f=gameLevels.starsData[e];null!=f&&(f[0]&&(b=!0),f[1]&&(c=!0),f[2]&&(d=!0)),gameLevels.starsData.splice(e,1,[b,c,d]),localStorage.setItem("PPGstarsData",JSON.stringify(gameLevels.starsData));var g=gameLevels.scoresData[e];null==g&&(g=0),BasicGame.score>g&&(gameLevels.scoresData.splice(e,1,BasicGame.score),localStorage.setItem("PPGscoresData",JSON.stringify(gameLevels.scoresData))),gameLevels.lastLevelUnlocked<e&&(gameLevels.lastLevelUnlocked=e,localStorage.setItem("PPGlastLevelUnlocked",JSON.stringify(gameLevels.lastLevelUnlocked)))}},levelEndLost:function(){this.endLevelGirlsGoOffscreen(),BasicGame.lvlFlowState=BasicGame.lvlFlowGameOver,BasicGame.soundFx.play("derrota"),this.game.world.bringToTop(this.grpEndLevelLose),this.grpEndLevelLose.visible=!0,this.game.device.desktop&&this.game.world.bringToTop(this.cursor),this.gameOverAnim.showGirls()},render:function(){},renderGroup:function(a){this.game.debug.body(a)}},BasicGame.LevelSelector=function(a){},BasicGame.LevelSelector.prototype={create:function(){this.backSky=this.add.tileSprite(0,0,this.game.width,this.game.height,"scene1","cielo"),this.backSky.tilePosition.y=-1200,this.hillL=this.add.sprite(0,this.game.height,"HUD","BGSelectorL"),this.hillL.anchor.set(0,1),this.hillR=this.add.sprite(this.game.width,this.game.height,"HUD","BGSelectorR"),this.hillR.anchor.set(1,1),this.hillC=this.add.sprite(.5*this.game.width,this.game.height,"HUD","BGSelectorCenter"),this.hillC.anchor.set(.5,1),this.btnBack=this.add.button(0,this.game.height-10,"HUD",this.btnPlayOnBack,this,"btn_back_over","btn_back_normal","btn_back_down","btn_back_normal"),this.btnBack.anchor.set(0,1),this.btnBack.input.useHandCursor=!1;for(var a=[],b=0;b<5;b++)b<=gameLevels.lastLevelUnlocked+1?a[b]=!0:a[b]=!1;var c=new ButtonLevelSelect(this.game,.5*this.game.width-250,150,a[0],0);this.add.existing(c);var d=new ButtonLevelSelect(this.game,.5*this.game.width,150,a[1],1);this.add.existing(d);var e=new ButtonLevelSelect(this.game,.5*this.game.width+250,150,a[2],2);this.add.existing(e);var f=new ButtonLevelSelect(this.game,.5*this.game.width-125,400,a[3],3);this.add.existing(f);var g=new ButtonLevelSelect(this.game,.5*this.game.width+125,400,a[4],4);this.add.existing(g),this.game.device.desktop&&(this.cursor=this.add.image(0,0,"HUD","cursor")),BasicGame.music.isPlaying||BasicGame.music.play("musicIntro")},btnPlayOnBack:function(){this.state.start("MainMenu")},update:function(){this.game.device.desktop&&(this.cursor.x=this.game.input.worldX,this.cursor.y=this.game.input.worldY)}},BasicGame.MainMenu=function(a){},BasicGame.MainMenu.prototype={create:function(){this.backSky=this.add.tileSprite(0,0,this.game.width,this.game.height,"scene1","cielo"),this.backSky.tilePosition.y=-1200,this.backClouds=this.add.tileSprite(0,20,this.game.width,236,"splashAtlas","nubesSplash");var a=new Spriter.Loader,b=new Spriter.SpriterJSON(this.game.cache.getJSON("splashAnim"),{imageNameType:Spriter.eImageNameType.FULL_PATH_NO_EXTENSION}),c=a.load(b);this.spriterGroup=new Spriter.SpriterGroup(this.game,c,"splashAtlas","Splash"),this.spriterGroup.fixedToCamera=!0,this.add.existing(this.spriterGroup),this.spriterGroup.cameraOffset.set(.5*this.game.width,this.game.height-300),this.spriterGroup.playAnimationByName("Intro"),this.spriterGroup.onFinish.add(this.spriterAnimationFinished,this),this.hillL=this.add.sprite(0,this.game.height,"splashAtlas","hillL"),this.hillL.anchor.set(0,1),this.hillR=this.add.sprite(this.game.width,this.game.height,"splashAtlas","hillR"),this.hillR.anchor.set(1,1),this.title=this.add.image(.3*this.game.width,0,"splashAtlas","TitleEng"),this.title.anchor.set(.5,0),this.title.inputEnabled=!0,this.title.events.onInputDown.add(this.btnCreditsHide,this),this.credits=this.add.image(.5*this.game.width,.5*this.game.height,"splashAtlas","credits"),this.credits.anchor.set(.5),this.credits.visible=!1,this.credits.inputEnabled=!0,this.credits.events.onInputDown.add(this.btnCreditsHide,this),this.btnPlay=this.add.button(this.game.width-10,this.game.height-10,"splashAtlas",this.btnPlayOnClick,this,"play_Over","play_Normal","play_Down","play_Normal"),this.btnPlay.anchor.set(1,1),this.btnPlay.input.useHandCursor=!1,this.btnAudioOn=this.add.button(this.game.width-20,120,"splashAtlas",this.btnAudioOnClick,this,"soung_over","soung_normal","soung_down","soung_normal"),this.btnAudioOn.anchor.set(1,1),this.btnAudioOn.input.useHandCursor=!1,this.btnAudioOff=this.add.button(this.game.width-20,120,"splashAtlas",this.btnAudioOnClick,this,"soungOFF_over","soungOFF_normal","soungOFF_down","soungOFF_over"),this.btnAudioOff.anchor.set(1,1),this.btnAudioOff.input.useHandCursor=!1,this.game.sound.mute?(this.btnAudioOn.visible=!1,this.btnAudioOff.visible=!0):(this.btnAudioOn.visible=!0,this.btnAudioOff.visible=!1),this.grpHelpPanel=new TutorialPanel(this.game),this.btnTuto=this.add.button(10,this.game.height-10,"splashAtlas",this.btnClickHelp,this,"help_over","help_normal","help_down","help_normal"),this.btnTuto.anchor.set(0,1),this.btnTuto.input.useHandCursor=!1,this.game.device.desktop&&(this.cursor=this.add.image(0,0,"HUD","cursor")),this.fadeFilter=this.add.graphics(0,0),this.fadeFilter.fixedToCamera=!0,this.fadeFilter.beginFill(0,1),this.fadeFilter.alpha=0,this.fadeFilter.drawRect(0,0,this.game.width,this.game.height),this.fadeFilter.endFill(),this.fadeTween=this.add.tween(this.fadeFilter),this.fadeTween.to({alpha:1},800,Phaser.Easing.Cubic.In).onComplete.add(function(){gameLevels.lastLevelUnlocked==-1?this.state.start("Game"):this.state.start("LevelSelector")},this),BasicGame.music.stop(),BasicGame.music.play("musicIntro")},spriterAnimationFinished:function(){"Intro"==this.spriterGroup.currentAnimationName&&this.spriterGroup.playAnimationByName("Loop")},btnCreditsHide:function(){this.credits.visible=!this.credits.visible},btnPlayOnClick:function(){this.spriterGroup.playAnimationByName("Outro"),this.fadeTween.start()},btnAudioOnClick:function(){this.game.sound.mute=!this.game.sound.mute,localStorage.setItem("PPGmuteState",JSON.stringify(this.game.sound.mute)),this.game.sound.mute?(this.btnAudioOn.visible=!1,this.btnAudioOff.visible=!0):(this.btnAudioOn.visible=!0,this.btnAudioOff.visible=!1)},btnClickHelp:function(){this.grpHelpPanel.showHidePanel()},update:function(){this.game.device.desktop&&(this.cursor.x=this.game.input.worldX,this.cursor.y=this.game.input.worldY),this.spriterGroup.updateAnimation(),this.backClouds.tilePosition.x+=.2}},BasicGame.Preloader=function(a){this.background=null,this.preloadBar=null,this.ready=!1},BasicGame.Preloader.prototype={preload:function(){this.background=this.add.image(0,0,"preloaderBarBack"),this.background.anchor.set(0,.5),this.preloadBar=this.add.sprite(0,0,"preloaderBar"),this.preloadBar.anchor.set(0,.5),this.background.x=this.game.world.centerX-244,this.background.y=this.game.world.centerY,this.preloadBar.x=this.game.world.centerX-244,this.preloadBar.y=this.game.world.centerY,this.load.onFileComplete.add(this.fileComplete,this),this.load.setPreloadSprite(this.preloadBar),this.load.atlasJSONHash("HUD","assets/texturas/UI_01.png","assets/texturas/UI_01.json"),this.load.bitmapFont("Commodore","assets/font/Commodore Rounded v1.2.png","assets/font/Commodore Rounded v1.2.fnt"),this.load.bitmapFont("PPG_font","assets/font/PPG_Font.png","assets/font/PPG_Font.xml"),this.load.atlasJSONHash("building01","assets/texturas/buildings/Buildings01_01.png","assets/texturas/buildings/Buildings01_01.json"),this.load.atlasJSONHash("building02","assets/texturas/buildings/Buildings02_01.png","assets/texturas/buildings/Buildings02_01.json"),this.load.atlasJSONHash("comet","assets/texturas/meteoritos_01.png","assets/texturas/meteoritos_01.json"),this.load.atlasJSONHash("cometIce","assets/texturas/meteoritos_ice1.png","assets/texturas/meteoritos_ice1.json"),this.load.atlasJSONArray("monsterAtlas","assets/texturas/monster/atlasMonster.png","assets/texturas/monster/atlasMonster.json"),this.load.json("monsterAnim","assets/texturas/monster/monster01.scon"),this.load.image("monsterColBox","assets/images/monsColBox.png"),this.load.atlasJSONArray("dirigibleAtlas","assets/texturas/dirigible/PPG_Dirigible.png","assets/texturas/dirigible/PPG_Dirigible.json"),this.load.json("dirigibleAnim","assets/texturas/dirigible/PPGdirigible.scon"),this.load.image("dirigibleColBox","assets/images/dirigibleColBox.png"),this.load.atlasJSONArray("socialNetworkText","assets/texturas/E03_01.png","assets/texturas/E03_01.json"),this.load.atlasJSONArray("PopStars","assets/texturas/popstars/popStars_01.png","assets/texturas/popstars/popStars_01.json"),this.load.atlasJSONArray("Homework","assets/texturas/homework/matematicas1.png","assets/texturas/homework/matematicas1.json"),this.load.atlasJSONArray("mayorAtlas","assets/texturas/mayor/atlasMayor.png","assets/texturas/mayor/atlasMayor.json"),this.load.json("mayorAnim","assets/texturas/mayor/Mayor.scon"),this.load.atlasJSONArray("gameOverAtlas","assets/texturas/gameoveranim/GameOver_atlas.png","assets/texturas/gameoveranim/GameOver_atlas.json"),this.load.json("gameOverAnim","assets/texturas/gameoveranim/GameOver.scon"),this.load.atlasJSONArray("introAtlas","assets/texturas/intro/PPG_Intro.png","assets/texturas/intro/PPG_Intro.json"),this.load.json("introAnim","assets/texturas/intro/PPG_Intro.scon"),this.load.image("nubes","assets/images/backgrounds/nubes.png"),this.load.atlasJSONHash("scene1","assets/texturas/Escenario01_01.png","assets/texturas/Escenario01_01.json"),this.load.atlasJSONHash("Blossom","assets/texturas/girls/Blossom_01.png","assets/texturas/girls/Blossom_01.json"),this.load.atlasJSONHash("Bubbles","assets/texturas/girls/Bubbles_01.png","assets/texturas/girls/Bubbles_01.json"),this.load.atlasJSONHash("Buttercup","assets/texturas/girls/Buttercup_01.png","assets/texturas/girls/Buttercup_01.json"),this.load.image("trailBlossom","assets/images/trailBlossom.png"),this.load.image("trailButtercup","assets/images/trailButtercup.png"),this.load.image("trailBubbles","assets/images/trailBubbles.png"),this.load.audiosprite("music",["assets/audio/music.ac3","assets/audio/music.m4a","assets/audio/music.mp3","assets/audio/music.ogg"],"assets/audio/music.json"),this.load.audiosprite("audioMix",["assets/audio/soundFx.ac3","assets/audio/soundFx.m4a","assets/audio/soundFx.mp3","assets/audio/soundFx.ogg"],"assets/audio/soundFx.json"),this.load.atlasJSONArray("splashAtlas","assets/texturas/splash/PPG_splash.png","assets/texturas/splash/PPG_splash.json"),this.load.json("splashAnim","assets/texturas/splash/PPG_splash.scon")},fileComplete:function(a,b,c,d,e){if("levelList"==b)for(var f=this.game.cache.getJSON(b),g=0;g<f.levels.length;g++){var h=f.levels[g].block;this.load.json("level"+g,"assets/levels/"+h),BasicGame.levelsCacheNames[g]="level"+g}},create:function(){BasicGame.FXEnabled=JSON.parse(localStorage.getItem("PPGFXEnabled")),null==BasicGame.FXEnabled&&(BasicGame.FXEnabled=!0),BasicGame.soundFx=this.add.audioSprite("audioMix"),BasicGame.soundFx.allowMultiple=!0,BasicGame.music=this.add.audioSprite("music"),BasicGame.music.allowMultiple=!0,this.game.sound.mute=JSON.parse(localStorage.getItem("PPGmuteState")),gameLevels.scoresData=JSON.parse(localStorage.getItem("PPGscoresData")),null==gameLevels.scoresData&&(gameLevels.scoresData=[]),gameLevels.starsData=JSON.parse(localStorage.getItem("PPGstarsData")),null==gameLevels.starsData&&(gameLevels.starsData=[]),gameLevels.lastLevelUnlocked=JSON.parse(localStorage.getItem("PPGlastLevelUnlocked")),null==gameLevels.lastLevelUnlocked&&(gameLevels.lastLevelUnlocked=-1),this.state.start("MainMenu")},resize:function(a,b){this.background.x=this.game.world.centerX-244,this.background.y=this.game.world.centerY,this.preloadBar.x=this.game.world.centerX-244,this.preloadBar.y=this.game.world.centerY}},Bomb=function(a){Phaser.Sprite.call(this,a,0,0,"dirigibleAtlas","bomba"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.anchor.set(.5)},Bomb.prototype=Object.create(Phaser.Sprite.prototype),Bomb.prototype.constructor=Bomb,Bomb.prototype.update=function(){null!=this.buildingTarget&&this.alive&&(this.game.input.activePointer.isDown&&Phaser.Rectangle.contains(this.body,this.game.input.worldX,this.game.input.worldY)&&BasicGame.PPGPlayer.clickOnMeteorite(this),this.y>this.buildingTarget.y-.2*this.buildingTarget.height&&this.alive&&(this.explosionStart(),null!=this.buildingTarget&&this.buildingTarget.damage(.15)))},Bomb.prototype.damage=function(a){return this.alive&&(this.health-=a,this.health<=0&&(this.explosionStart(),BasicGame.score+=200)),this},Bomb.prototype.explosionStart=function(){this.body.velocity.setTo(0,0),this.kill(),this.game.state.states[this.game.state.current].spawnExplotion(this.x,this.y)},Bomb.prototype.respawnBomb=function(a,b,c){this.buildingTarget=c,this.reset(a,b),this.health=1;var d=new Phaser.Point(this.buildingTarget.x,this.buildingTarget.y-.25*this.buildingTarget.height);this.game.physics.arcade.moveToXY(this,d.x,d.y,75)},Comet=function(a){Phaser.Sprite.call(this,a,0,0,"comet"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.animations.add("fly",Phaser.Animation.generateFrameNames("meteorito",1,5,"",2),15,!0),this.animations.add("explode",Phaser.Animation.generateFrameNames("explosion",1,7,"",2),15,!1),this.animations.play("fly"),this.anchor.set(460/814,400/814),this.body.setSize(110,110,400,350)},Comet.prototype=Object.create(Phaser.Sprite.prototype),Comet.prototype.constructor=Comet,Comet.prototype.update=function(){null!=this.buildingTarget&&this.alive&&(this.game.input.activePointer.isDown&&Phaser.Rectangle.contains(this.body,this.game.input.worldX,this.game.input.worldY)&&BasicGame.PPGPlayer.clickOnMeteorite(this),this.y>this.buildingTarget.y-.2*this.buildingTarget.height&&"explode"!=this.animations.currentAnim.name&&(this.explosionStart(),null!=this.buildingTarget&&this.buildingTarget.damage(.3*this.scale.x)))},Comet.prototype.damage=function(a){return this.alive&&(this.health-=a,this.health<=0&&(this.explosionStart(),BasicGame.score+=Math.floor(200*this.scale.x))),this},Comet.prototype.explosionStart=function(){this.alive=!1,this.body.velocity.setTo(0,0),this.animations.play("explode"),this.events.onAnimationComplete.addOnce(function(){this.kill()},this);var a=Math.floor(2*Math.random());a>1?BasicGame.soundFx.play("explosion_1"):BasicGame.soundFx.play("explosion_2")},Comet.prototype.respawnComet=function(a,b,c,d){this.buildingTarget=c,this.reset(a,b);var e=d;this.scale.x=e,this.scale.y=e,this.health=e;var f=new Phaser.Point(this.buildingTarget.x,this.buildingTarget.y-.25*this.buildingTarget.height);this.game.physics.arcade.moveToXY(this,f.x,f.y,75*(1-e)+50),this.rotation=Phaser.Point.angle(f,this.position),this.animations.play("fly")},CometIce=function(a){Phaser.Sprite.call(this,a,0,0,"cometIce"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.animations.add("fly",Phaser.Animation.generateFrameNames("cometa",1,5,"",2),15,!0),this.animations.add("explode",Phaser.Animation.generateFrameNames("explosion_cometa",1,7,"",2),15,!1),this.animations.play("fly"),this.anchor.set(460/814,400/814),this.body.setSize(110,110,400,350)},CometIce.prototype=Object.create(Phaser.Sprite.prototype),CometIce.prototype.constructor=CometIce,CometIce.prototype.update=function(){null!=this.buildingTarget&&this.alive&&(this.game.input.activePointer.isDown&&Phaser.Rectangle.contains(this.body,this.game.input.worldX,this.game.input.worldY)&&(BasicGame.wasClicked||(this.damage(.006),BasicGame.PPGPlayer.clickOnIceMeteorite(this),BasicGame.wasClicked=!0)),this.game.input.activePointer.isUp&&(BasicGame.wasClicked=!1),this.y>this.buildingTarget.y-.2*this.buildingTarget.height&&"explode"!=this.animations.currentAnim.name&&(this.explosionStart(),null!=this.buildingTarget&&this.buildingTarget.damage(.3*this.scale.x)))},CometIce.prototype.damage=function(a){return this.alive&&(this.health-=a,this.health<=0&&(this.explosionStart(),BasicGame.score+=Math.floor(200*this.scale.x))),this},CometIce.prototype.explosionStart=function(){this.alive=!1,this.body.velocity.setTo(0,0),this.animations.play("explode"),this.events.onAnimationComplete.addOnce(function(){this.kill(),BasicGame.wasClicked=!1},this);var a=Math.floor(2*Math.random());a>1?BasicGame.soundFx.play("explosion_1"):BasicGame.soundFx.play("explosion_2")},CometIce.prototype.startHitState=function(){},CometIce.prototype.respawnCometIce=function(a,b,c,d){this.buildingTarget=c,this.reset(a,b);var e=d;this.scale.x=e,this.scale.y=e,this.health=.1*e;var f=new Phaser.Point(this.buildingTarget.x,this.buildingTarget.y-.25*this.buildingTarget.height);this.game.physics.arcade.moveToXY(this,f.x,f.y,75*(1-e)+50),this.rotation=Phaser.Point.angle(f,this.position),this.animations.play("fly")},Dirigible=function(a,b,c){Phaser.Sprite.call(this,a,b,c,"dirigibleColBox"),this.stateWalking=0,this.stateAttacking=1,this.stateDeath=2,this.currentState=0,this.game.physics.enable(this,Phaser.Physics.ARCADE),this.walkingSpeed=-1.75,this.anchor.set(.5,1);var d=new Spriter.Loader,e=new Spriter.SpriterJSON(a.cache.getJSON("dirigibleAnim"),{imageNameType:Spriter.eImageNameType.FULL_PATH_NO_EXTENSION}),f=d.load(e);this.spriterGroup=new Spriter.SpriterGroup(a,f,"dirigibleAtlas","PPGdirigible"),a.world.add(this.spriterGroup),this.spriterDeviation=new Phaser.Point(0,100),this.spriterGroup.position.setTo(b+this.spriterDeviation.x,c+this.spriterDeviation.y),this.alpha=0,this.spriterGroup.playAnimationByName("Dirigible_idle"),this.spriterGroup.onFinish.add(this.spriterAnimationFinished,this),this.spriterGroup.onLoop.add(this.spriterAnimationLoopFinished,this),this.buildingTarget=this.getBuildingTarget(),this.attackTimer=a.time.create(!1),this.grpLifeBar=new Phaser.Group(this.game),this.game.world.add(this.grpLifeBar);var g=new Phaser.Image(this.game,0,0,"HUD","barEnemigos_Empty");this.grpLifeBar.add(g);var h=new Phaser.Sprite(this.game,20,10,"HUD","iconDirigible");this.grpLifeBar.add(h),this.lifeBar=new Phaser.Image(this.game,114,50,"HUD","barEnemigos_Full"),this.grpLifeBar.add(this.lifeBar),this.lifeBarRect=new Phaser.Rectangle(0,0,this.lifeBar.width,this.lifeBar.height),this.lifeBar.crop(this.lifeBarRect)},Dirigible.prototype=Object.create(Phaser.Sprite.prototype),Dirigible.prototype.constructor=Dirigible,Dirigible.prototype.update=function(){if(!this.alive)return void(this.grpLifeBar.visible=!1);if(this.grpLifeBar.visible=!0,!BasicGame.gamePaused)switch(this.spriterGroup.updateAnimation(),this.spriterGroup.position.setTo(this.x+this.spriterDeviation.x,this.y+this.spriterDeviation.y),this.grpLifeBar.x=this.x-.5*this.grpLifeBar.width,this.grpLifeBar.y=this.y-.98*this.height,this.currentState){case this.stateWalking:null!=this.buildingTarget&&(this.buildingTarget.alive?this.x+.5*this.width<this.buildingTarget.x+.5*this.buildingTarget.width&&(this.currentState=this.stateAttacking):this.buildingTarget=this.getBuildingTarget()),"Dirigible_idle"!=this.spriterGroup.currentAnimationName&&"Dirigible_cierraPuertas"!=this.spriterGroup.currentAnimationName&&this.spriterGroup.playAnimationByName("Dirigible_cierraPuertas"),this.x+=this.walkingSpeed,this.inputOverDirigible();break;case this.stateDeath:break;case this.stateAttacking:null!=this.buildingTarget&&(this.buildingTarget.alive||(this.startWalkingState(),this.buildingTarget=this.getBuildingTarget())),"Dirigible_abrePuertas"!=this.spriterGroup.currentAnimationName&&"DirigibleOpen_idle"!=this.spriterGroup.currentAnimationName&&(this.spriterGroup.playAnimationByName("Dirigible_abrePuertas"),this.prepareLaunchBomb()),this.inputOverDirigible()}},Dirigible.prototype.prepareLaunchBomb=function(){this.currentState==this.stateAttacking&&(this.attackTimer.add(2e3,this.dropBomb,this),this.attackTimer.start())},Dirigible.prototype.dropBomb=function(){this.currentState==this.stateAttacking&&(this.game.state.states[this.game.state.current].spawnBomb(this.x,this.y,this.buildingTarget),this.attackTimer.add(6e3,this.prepareLaunchBomb,this),this.attackTimer.start())},Dirigible.prototype.getBuildingTarget=function(){for(var a=null,b=0,c=0;c<BasicGame.cityBuildings.length;c++)if(BasicGame.cityBuildings[c].alive){var d=BasicGame.cityBuildings[c].x;d>b&&(b=BasicGame.cityBuildings[c].x,a=BasicGame.cityBuildings[c])}return a},Dirigible.prototype.inputOverDirigible=function(){this.game.input.activePointer.isDown&&Phaser.Rectangle.contains(this.body,this.game.input.worldX,this.game.input.worldY)&&(BasicGame.wasClicked||(this.damage(.0015),BasicGame.PPGPlayer.clickOnDirigible(this),BasicGame.wasClicked=!0)),this.game.input.activePointer.isUp&&(BasicGame.wasClicked=!1)},Dirigible.prototype.damage=function(a){return this.alive&&(this.health-=a,this.lifeBarRect.width=224*this.health,this.lifeBar.updateCrop(),this.health<=0&&(this.currentState=this.stateDeath,BasicGame.score+=800,this.spriterGroup.playAnimationByName("Dirigible_dead"),BasicGame.soundFx.play("explosion_1"),BasicGame.soundFx.play("explosion_2"),this.grpLifeBar.visible=!1,BasicGame.wasClicked=!1)),this},Dirigible.prototype.startHitState=function(){this.currentState!=this.stateDeath&&this.spriterGroup.forEach(function(a){a.tint=16711680,this.game.add.tween(a).to({tint:16777215},1e3,Phaser.Easing.Cubic.In,!0)},this)},Dirigible.prototype.startWalkingState=function(){this.currentState!=this.stateDeath&&(this.currentState=this.stateWalking)},Dirigible.prototype.spriterAnimationFinished=function(){"Dirigible_abrePuertas"==this.spriterGroup.currentAnimationName&&this.spriterGroup.playAnimationByName("DirigibleOpen_idle"),"Dirigible_cierraPuertas"==this.spriterGroup.currentAnimationName&&this.spriterGroup.playAnimationByName("Dirigible_idle"),"Dirigible_dead"==this.spriterGroup.currentAnimationName&&(this.kill(),BasicGame.wasClicked=!1)},Dirigible.prototype.spriterAnimationLoopFinished=function(){},Homework=function(a){Phaser.Sprite.call(this,a,0,0,"Homework"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.animations.add("idle",Phaser.Animation.generateFrameNames("marcadorMatemtica_marcadorMatemtica_Loop_",1,12,"",3),15,!0),this.animations.play("idle"),this.anchor.set(.5,1),this.body.setSize(264,129),this.aciertos=0,this.aciertosRequired=1,this.eventFinished=!1,this.showingPanel=!1,this.panelGrp=new Phaser.Group(a),this.game.world.add(this.panelGrp),this.panelGrp.x=this.x,this.panelGrp.y=this.y-280,this.backPanel=new Phaser.Image(a,0,0,"Homework","basePopupMatematica"),this.backPanel.anchor.set(.5),this.panelGrp.add(this.backPanel),this.btnRight=new Phaser.Button(a,5,40,"Homework",this.btnClickedRight,this,"btnR_over","btnR_normal","btnR_down","btnR_normal"),this.btnRight.input.useHandCursor=!1,this.panelGrp.add(this.btnRight),this.btnLeft=new Phaser.Button(a,(-125),40,"Homework",this.btnClickedLeft,this,"btnL_over","btnL_normal","btnL_down","btnL_normal"),this.btnLeft.input.useHandCursor=!1,this.panelGrp.add(this.btnLeft),this.aciertosBar=new Phaser.Image(a,(-123),17,"Homework","barloadingFull"),this.panelGrp.add(this.aciertosBar),this.aciertosBarRect=new Phaser.Rectangle(0,0,0,this.aciertosBar.height),this.aciertosBar.crop(this.aciertosBarRect),this.lastQuestionIndex=0,this.currentQuestion=null,this.questionsList=[["2 + 8 ?","10",!0,"14",!1],["20 + 24 ?","54",!1,"44",!0],["80 + 20 ?","100",!0,"110",!1],["50 + 45 ?","95",!0,"100",!1]],this.txtQuestion=new Phaser.BitmapText(this.game,0,(-50),"PPG_font","2 + 2?",54),this.txtQuestion.anchor.set(.5),this.panelGrp.add(this.txtQuestion),this.txtAnsLeft=new Phaser.BitmapText(this.game,this.btnLeft.x+.5*this.btnLeft.width,this.btnLeft.y+20,"PPG_font","4",54),this.txtAnsLeft.anchor.set(.5),this.panelGrp.add(this.txtAnsLeft),this.txtAnsRight=new Phaser.BitmapText(this.game,this.btnRight.x+.5*this.btnRight.width,this.btnRight.y+20,"PPG_font","6",54),this.txtAnsRight.anchor.set(.5),this.panelGrp.add(this.txtAnsRight),this.hidePanel(),this.kill()},Homework.prototype=Object.create(Phaser.Sprite.prototype),Homework.prototype.constructor=Homework,Homework.prototype.selectNewQuestion=function(){var a=Math.floor(Math.random()*this.questionsList.length);return a==this.lastQuestionIndex?void this.selectNewQuestion():(this.lastQuestionIndex=a,this.currentQuestion=this.questionsList[a],this.txtQuestion.text=this.currentQuestion[0],this.txtAnsLeft.text=this.currentQuestion[1],void(this.txtAnsRight.text=this.currentQuestion[3]))},Homework.prototype.showPanel=function(){this.showingPanel=!0,this.panelGrp.scale.set(0,0),this.game.add.tween(this.panelGrp.scale).to({x:1,y:1},250,Phaser.Easing.Back.Out,!0),this.selectNewQuestion()},Homework.prototype.hidePanel=function(){this.showingPanel=!1,this.panelGrp.scale.set(1,1),this.game.add.tween(this.panelGrp.scale).to({x:0,y:0},250,Phaser.Easing.Back.Out,!0)},Homework.prototype.respawnComputer=function(a,b,c){this.showingPanel=!1,this.panelGrp.x=a,this.panelGrp.y=b-280,this.aciertos=0,this.eventFinished=!1,this.aciertosBarRect.width=0,this.aciertosBar.updateCrop(),this.reset(a,b)},Homework.prototype.update=function(){if(this.alive&&!this.eventFinished&&!BasicGame.gamePaused){var a=BasicGame.PPGPlayer.girlsCenterPoint.distance(this.body);a<300?this.showingPanel||this.showPanel():this.showingPanel&&this.hidePanel()}},Homework.prototype.btnClickedLeft=function(){this.currentQuestion[2]?(this.aciertos++,this.checkAciertosCompleted(),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signGood)):(this.aciertos--,this.checkAciertosCompleted(),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signBad)),this.selectNewQuestion()},Homework.prototype.btnClickedRight=function(){this.currentQuestion[4]?(this.aciertos++,this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signGood),this.checkAciertosCompleted()):(this.aciertos--,this.checkAciertosCompleted(),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signBad)),this.selectNewQuestion()},Homework.prototype.checkAciertosCompleted=function(){this.aciertos>=this.aciertosRequired?(this.eventFinished=!0,this.hidePanel(),BasicGame.score+=150,this.healBuilding(),this.kill()):(this.aciertos=Math.max(this.aciertos,0),this.aciertosBarRect.width=this.aciertos*(313/this.aciertosRequired),this.aciertosBar.updateCrop())},Homework.prototype.healBuilding=function(){for(var a=null,b=null,c=0;c<BasicGame.cityBuildings.length;c++)null==a?a=BasicGame.cityBuildings[c]:(b=BasicGame.cityBuildings[c],b.health<a.health&&(a=b));a.heal(1),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-80,BasicGame.signHeal)},Monster=function(a,b,c){Phaser.Sprite.call(this,a,b,c,"monsterColBox"),this.stateWalking=0,this.stateAttacking=1,this.stateGethit=2,this.stateDeath=3,this.currentState=0,this.game.physics.enable(this,Phaser.Physics.ARCADE),this.walkingSpeed=-1.75,this.anchor.set(.5,1),this.body.setSize(290,670,330,110);var d=new Spriter.Loader,e=new Spriter.SpriterJSON(a.cache.getJSON("monsterAnim"),{imageNameType:Spriter.eImageNameType.FULL_PATH_NO_EXTENSION}),f=d.load(e);this.spriterGroup=new Spriter.SpriterGroup(a,f,"monsterAtlas","monster01"),a.world.add(this.spriterGroup),this.spriterDeviation=new Phaser.Point((-200),0),this.spriterGroup.position.setTo(b+this.spriterDeviation.x,c+this.spriterDeviation.y),this.alpha=0,this.spriterGroup.playAnimationByName("golpear"),this.spriterGroup.onFinish.add(this.spriterAnimationFinished,this),this.spriterGroup.onLoop.add(this.spriterAnimationLoopFinished,this),this.buildingTarget=this.getBuildingTarget(),this.attackTimer=a.time.create(!1),this.grpLifeBar=new Phaser.Group(this.game),this.game.world.add(this.grpLifeBar);var g=new Phaser.Image(this.game,0,0,"HUD","barEnemigos_Empty");this.grpLifeBar.add(g);var h=new Phaser.Sprite(this.game,20,10,"HUD","iconMonster");this.grpLifeBar.add(h),this.lifeBar=new Phaser.Image(this.game,114,50,"HUD","barEnemigos_Full"),this.grpLifeBar.add(this.lifeBar),this.lifeBarRect=new Phaser.Rectangle(0,0,this.lifeBar.width,this.lifeBar.height),this.lifeBar.crop(this.lifeBarRect)},Monster.prototype=Object.create(Phaser.Sprite.prototype),Monster.prototype.constructor=Monster,Monster.prototype.update=function(){if(!this.alive)return void(this.grpLifeBar.visible=!1);if(this.grpLifeBar.visible=!0,!BasicGame.gamePaused)switch(this.spriterGroup.updateAnimation(),this.spriterGroup.position.setTo(this.x+this.spriterDeviation.x,this.y+this.spriterDeviation.y),this.grpLifeBar.x=this.x-.5*this.grpLifeBar.width,this.grpLifeBar.y=this.y-.55*this.height,this.currentState){case this.stateWalking:null!=this.buildingTarget&&(this.buildingTarget.alive?this.x<this.buildingTarget.x+this.buildingTarget.width&&(this.currentState=this.stateAttacking):this.buildingTarget=this.getBuildingTarget()),"caminar"!=this.spriterGroup.currentAnimationName&&(this.spriterGroup.playAnimationByName("caminar"),BasicGame.soundFx.play("avance_monstruo")),this.x+=this.walkingSpeed,this.inputOverMonster();break;case this.stateGethit:"atacadoIn"!=this.spriterGroup.currentAnimationName&&"atacadoLoop"!=this.spriterGroup.currentAnimationName?(this.spriterGroup.playAnimationByName("atacadoIn"),BasicGame.soundFx.play("retroceso_monstruo")):"atacadoLoop"==this.spriterGroup.currentAnimationName&&this.x+.25*this.width<this.game.world.width&&(this.x-=1.25*this.walkingSpeed),BasicGame.soundFx.stop("avance_monstruo"),this.inputOverMonster();break;case this.stateDeath:"muerte"!=this.spriterGroup.currentAnimationName&&(this.spriterGroup.playAnimationByName("muerte"),BasicGame.soundFx.stop("avance_monstruo"),BasicGame.soundFx.play("retroceso_monstruo"),BasicGame.wasClicked=!1);break;case this.stateAttacking:null!=this.buildingTarget&&(this.buildingTarget.alive||(this.startWalkingState(),this.buildingTarget=this.getBuildingTarget())),"golpear"!=this.spriterGroup.currentAnimationName&&(this.spriterGroup.playAnimationByName("golpear"),BasicGame.soundFx.stop("avance_monstruo"),this.attackTimer.add(1200,this.damageBuilding,this),this.attackTimer.start(),this.attackTimer.add(1800,this.damageBuilding,this),this.attackTimer.start()),this.inputOverMonster()}},Monster.prototype.getBuildingTarget=function(){for(var a=null,b=0,c=0;c<BasicGame.cityBuildings.length;c++)if(BasicGame.cityBuildings[c].alive){var d=BasicGame.cityBuildings[c].x;d>b&&(b=BasicGame.cityBuildings[c].x,a=BasicGame.cityBuildings[c])}return a},Monster.prototype.inputOverMonster=function(){this.game.input.activePointer.isDown&&Phaser.Rectangle.contains(this.body,this.game.input.worldX,this.game.input.worldY)&&(BasicGame.wasClicked||(this.damage(.0015),BasicGame.PPGPlayer.clickOnMonster(this),BasicGame.wasClicked=!0)),this.game.input.activePointer.isUp&&(BasicGame.wasClicked=!1)},Monster.prototype.damage=function(a){return this.alive&&(this.health-=a,this.lifeBarRect.width=224*this.health,this.lifeBar.updateCrop(),this.health<=0&&(this.currentState=this.stateDeath,BasicGame.score+=500,this.grpLifeBar.visible=!1)),this},Monster.prototype.startHitState=function(){this.currentState!=this.stateDeath&&(this.currentState!=this.stateGethit&&(this.game.time.events.add(3*Phaser.Timer.SECOND,this.startWalkingState,this),this.currentState=this.stateGethit),this.spriterGroup.forEach(function(a){a.tint=16711680,this.game.add.tween(a).to({
tint:16777215},1e3,Phaser.Easing.Cubic.In,!0)},this))},Monster.prototype.startWalkingState=function(){this.currentState!=this.stateDeath&&(this.currentState=this.stateWalking)},Monster.prototype.spriterAnimationFinished=function(){"atacadoIn"==this.spriterGroup.currentAnimationName&&this.spriterGroup.playAnimationByName("atacadoLoop"),"muerte"==this.spriterGroup.currentAnimationName&&(this.kill(),BasicGame.wasClicked=!1)},Monster.prototype.spriterAnimationLoopFinished=function(){"golpear"==this.spriterGroup.currentAnimationName&&(this.attackTimer.add(1200,this.damageBuilding,this),this.attackTimer.start(),this.attackTimer.add(1800,this.damageBuilding,this),this.attackTimer.start())},Monster.prototype.damageBuilding=function(){this.currentState==this.stateAttacking&&null!=this.buildingTarget&&this.buildingTarget.damage(.03)},Pickles=function(a){Phaser.Sprite.call(this,a,0,0,"HUD","pickles"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.anchor.set(.5,.5)},Pickles.prototype=Object.create(Phaser.Sprite.prototype),Pickles.prototype.constructor=Pickles,Pickles.prototype.getcollected=function(){for(var a=null,b=null,c=0;c<BasicGame.cityBuildings.length;c++)null==a?a=BasicGame.cityBuildings[c]:(b=BasicGame.cityBuildings[c],b.health<a.health&&(a=b));a.heal(.1),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y,BasicGame.signHeal),BasicGame.score+=50,this.kill()},PopSingers=function(a){Phaser.Sprite.call(this,a,0,0,"PopStars"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.animations.add("popWalk",Phaser.Animation.generateFrameNames("popStars_popStars_caminataLoop_",0,62,"",3),60,!0),this.animations.play("popWalk"),this.anchor.set(.5,1),this.selfiePhoneGrp=new Phaser.Group(this.game),this.game.world.add(this.selfiePhoneGrp),this.phone=new Phaser.Sprite(this.game,0,0,"PopStars","Celu"),this.phone.anchor.set(.5),this.selfiePhoneGrp.add(this.phone),this.camBtn=new Phaser.Button(this.game,0,0,"PopStars",this.selfieHeal,this,"btnCamaraOver","btnCamaraNormal","btnCamaraDown","btnCamaraNormal"),this.camBtn.anchor.set(.5,0),this.camBtn.input.useHandCursor=!1,this.selfiePhoneGrp.add(this.camBtn),this.camBtn.alpha=.5},PopSingers.prototype=Object.create(Phaser.Sprite.prototype),PopSingers.prototype.constructor=PopSingers,PopSingers.prototype.update=function(){if(this.alive){this.x<-this.width&&this.killAll();var a=BasicGame.PPGPlayer.girlsCenterPoint.distance(this.body);a<200?(this.selfiePhoneGrp.x=this.x,this.selfiePhoneGrp.y=this.y-80,this.selfiePhoneGrp.visible=!0,this.game.world.bringToTop(this.selfiePhoneGrp)):this.selfiePhoneGrp.visible=!1}},PopSingers.prototype.respawnSinger=function(){this.reset(this.game.world.width,this.game.world.height-30),this.body.velocity.x=-80,this.phone.reset(),this.camBtn.reset()},PopSingers.prototype.selfieHeal=function(){for(var a=null,b=null,c=0;c<BasicGame.cityBuildings.length;c++)null==a?a=BasicGame.cityBuildings[c]:(b=BasicGame.cityBuildings[c],b.health<a.health&&(a=b));a.heal(.02),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-80,BasicGame.signHeal),BasicGame.score+=10},PopSingers.prototype.killAll=function(){this.kill(),this.phone.kill(),this.camBtn.kill()},SocialNetwork=function(a){Phaser.Sprite.call(this,a,0,0,"socialNetworkText"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.animations.add("beat",Phaser.Animation.generateFrameNames("marcadorRedes",1,7,"",2),15,!0),this.animations.add("explode",Phaser.Animation.generateFrameNames("marcadorRedes",1,7,"",2),15,!1),this.animations.play("beat"),this.anchor.set(.5,1),this.body.setSize(264,129),this.txtCountdownExplo=this.game.add.bitmapText(this.x+30,this.y-28,"Commodore","20",24),this.txtCountdownExplo.anchor.set(.5,1),this.currentImageIsGood=!1,this.aciertos=0,this.aciertosRequired=1,this.eventFinished=!1,this.explotionSeconds=15,this.exploTimer=this.game.time.create(!0),this.showingPanel=!1,this.panelGrp=new Phaser.Group(a),this.game.world.add(this.panelGrp),this.panelGrp.x=this.x,this.panelGrp.y=this.y-280,this.backPanel=new Phaser.Image(a,0,0,"socialNetworkText","basePopup"),this.backPanel.anchor.set(.5),this.panelGrp.add(this.backPanel),this.lastImageIndex=0,this.socialImage=new Phaser.Sprite(a,0,(-58),"socialNetworkText"),this.socialImage.animations.add("bad1",["imagenMala01"],60,!0),this.socialImage.animations.add("bad2",["imagenMala02"],60,!0),this.socialImage.animations.add("bad3",["imagenMala03"],60,!0),this.socialImage.animations.add("good1",["imagenBuena01"],60,!0),this.socialImage.animations.add("good2",["imagenBuena02"],60,!0),this.socialImage.animations.add("good3",["imagenBuena03"],60,!0),this.socialImage.animations.play("bad1"),this.socialImage.anchor.set(.5),this.panelGrp.add(this.socialImage),this.girlsFaces=new Phaser.Sprite(a,200,(-40),"socialNetworkText"),this.girlsFaces.animations.add("good",["caritasFelices"],60,!0),this.girlsFaces.animations.add("bad",["caritasTristes"],60,!0),this.girlsFaces.animations.play("bad"),this.girlsFaces.anchor.set(.5),this.panelGrp.add(this.girlsFaces),this.btnLike=new Phaser.Button(a,5,93,"socialNetworkText",this.btnClickedLike,this,"Like_over","Like_normal","Like_down","Like_normal"),this.btnLike.input.useHandCursor=!1,this.panelGrp.add(this.btnLike),this.btnDislike=new Phaser.Button(a,(-160),93,"socialNetworkText",this.btnClickedDislike,this,"NotLike_over","NotLike_normal","NotLike_down","NotLike_normal"),this.btnDislike.input.useHandCursor=!1,this.panelGrp.add(this.btnDislike),this.aciertosBar=new Phaser.Image(a,(-158),62,"socialNetworkText","barloadingFull"),this.panelGrp.add(this.aciertosBar),this.aciertosBarRect=new Phaser.Rectangle(0,0,0,this.aciertosBar.height),this.aciertosBar.crop(this.aciertosBarRect),this.hidePanel(),this.kill()},SocialNetwork.prototype=Object.create(Phaser.Sprite.prototype),SocialNetwork.prototype.constructor=SocialNetwork,SocialNetwork.prototype.selectNewImage=function(){var a=Math.floor(6*Math.random());if(a==this.lastImageIndex)return void this.selectNewImage();switch(this.lastImageIndex=a,a){case 0:this.socialImage.animations.play("bad1"),this.girlsFaces.animations.play("bad"),this.currentImageIsGood=!1;break;case 1:this.socialImage.animations.play("bad2"),this.girlsFaces.animations.play("bad"),this.currentImageIsGood=!1;break;case 2:this.socialImage.animations.play("bad3"),this.girlsFaces.animations.play("bad"),this.currentImageIsGood=!1;break;case 3:this.socialImage.animations.play("good1"),this.girlsFaces.animations.play("good"),this.currentImageIsGood=!0;break;case 4:this.socialImage.animations.play("good2"),this.girlsFaces.animations.play("good"),this.currentImageIsGood=!0;break;case 5:this.socialImage.animations.play("good3"),this.girlsFaces.animations.play("good"),this.currentImageIsGood=!0}},SocialNetwork.prototype.showPanel=function(){this.showingPanel=!0,this.panelGrp.scale.set(0,0),this.game.add.tween(this.panelGrp.scale).to({x:1,y:1},250,Phaser.Easing.Back.Out,!0),this.selectNewImage()},SocialNetwork.prototype.hidePanel=function(){this.showingPanel=!1,this.panelGrp.scale.set(1,1),this.game.add.tween(this.panelGrp.scale).to({x:0,y:0},250,Phaser.Easing.Back.Out,!0)},SocialNetwork.prototype.explodeBomb=function(){null!=this.buildingTarget&&(this.buildingTarget.damage(.5),this.game.state.states[this.game.state.current].freeBuildingFromSocialNetwork(this.buildingTarget)),this.game.state.states[this.game.state.current].spawnExplotion(this.x,this.y-30),this.eventFinished=!0,this.hidePanel(),this.txtCountdownExplo.kill(),this.kill()},SocialNetwork.prototype.respawnComputer=function(a,b,c){this.buildingTarget=c,this.showingPanel=!1,this.panelGrp.x=a,this.panelGrp.y=b-280,this.currentImageIsGood=!1,this.aciertos=0,this.eventFinished=!1,this.aciertosBarRect.width=0,this.aciertosBar.updateCrop(),this.exploded=!1,this.countdownExplotion=Phaser.Timer.SECOND*this.explotionSeconds,this.txtCountdownExplo.reset(a+30,b-28),this.reset(a,b)},SocialNetwork.prototype.update=function(){if(this.alive&&!this.eventFinished&&!BasicGame.gamePaused){var a=BasicGame.PPGPlayer.girlsCenterPoint.distance(this.body);a<300?this.showingPanel||this.showPanel():this.showingPanel&&this.hidePanel(),this.exploded||(this.countdownExplotion-=this.game.time.elapsed,this.countdownExplotion<=0&&(this.exploded=!0,this.explodeBomb())),this.txtCountdownExplo.text=Math.ceil(.001*this.countdownExplotion),this.buildingTarget.alive||(this.explodeBomb(),this.buildingTarget=null)}},SocialNetwork.prototype.btnClickedLike=function(){this.currentImageIsGood?(this.aciertos++,this.checkAciertosCompleted(),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signGood)):(this.aciertos--,this.checkAciertosCompleted(),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signBad)),this.selectNewImage()},SocialNetwork.prototype.btnClickedDislike=function(){this.currentImageIsGood?(this.aciertos--,this.checkAciertosCompleted(),this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signBad)):(this.aciertos++,this.game.state.states[this.game.state.current].spawnFeedbacksign(this.x,this.y-300,BasicGame.signGood),this.checkAciertosCompleted()),this.selectNewImage()},SocialNetwork.prototype.checkAciertosCompleted=function(){this.aciertos>=this.aciertosRequired?(this.eventFinished=!0,this.hidePanel(),this.kill(),this.txtCountdownExplo.kill(),this.game.state.states[this.game.state.current].freeBuildingFromSocialNetwork(this.buildingTarget),BasicGame.score+=200):(this.aciertos=Math.max(this.aciertos,0),this.aciertosBarRect.width=this.aciertos*(313/this.aciertosRequired),this.aciertosBar.updateCrop())},WarningArrow=function(a){Phaser.Sprite.call(this,a,0,0,"HUD"),this.animations.add("loop",["ArrowRed","ArrowOrange","ArrowYellow","ArrowgreenBig","ArrowgreenMedia","ArrowgreenSmall"],0,!1),this.animations.play("loop"),this.animations.stop(),this.anchor.set(.5,.5),this.pivot.x=100,this.warningTarget=null},WarningArrow.prototype=Object.create(Phaser.Sprite.prototype),WarningArrow.prototype.constructor=Comet,WarningArrow.prototype.update=function(){if(null!=this.warningTarget){this.position=BasicGame.PPGPlayer.girlsCenterPoint,this.rotation=Phaser.Point.angle(this.position,this.warningTarget.position);var a=BasicGame.PPGPlayer.girlsCenterPoint.distance(this.warningTarget.position);a<200?this.alpha=.0035*a:this.alpha=1,this.warningTarget.alive||(this.kill(),this.warningTarget=null)}},WarningArrow.prototype.respawnArrow=function(a,b,c){if(this.reset(0,0),b)switch(c){case 2:this.animations.frame=0;break;case 1:this.animations.frame=1;break;case 0:this.animations.frame=2}else switch(c){case 2:this.animations.frame=4;break;case 1:this.animations.frame=3;break;case 0:this.animations.frame=5}this.warningTarget=a,this.scale.set(0),this.game.add.tween(this.scale).to({x:1,y:1},1e3,Phaser.Easing.Bounce.Out,!0)},BuildingDebris=function(a,b,c,d){switch(d){case 0:case 1:Phaser.Sprite.call(this,a,b,c,"building01"),this.animations.add("debris",["escombros01"],1,!0);break;case 2:case 3:Phaser.Sprite.call(this,a,b,c,"building02"),this.animations.add("debris",["escombros02"],1,!0)}this.animations.play("debris"),this.anchor.set(.5,1)},BuildingDebris.prototype=Object.create(Phaser.Sprite.prototype),BuildingDebris.prototype.constructor=BuildingDebris,Buildings=function(a,b,c,d){switch(d){case 0:Phaser.Sprite.call(this,a,b,c,"building01"),this.animations.add("damage01",["building02A"],1,!0),this.animations.add("damage02",["building02B"],1,!0),this.animations.add("damage03",["building02C"],1,!0),this.animations.add("damage04",["building02D"],1,!0);break;case 1:Phaser.Sprite.call(this,a,b,c,"building01"),this.animations.add("damage01",["building04A"],1,!0),this.animations.add("damage02",["building04B"],1,!0),this.animations.add("damage03",["building04C"],1,!0),this.animations.add("damage04",["building04D"],1,!0);break;case 2:Phaser.Sprite.call(this,a,b,c,"building02"),this.animations.add("damage01",["building01A"],1,!0),this.animations.add("damage02",["building01B"],1,!0),this.animations.add("damage03",["building01C"],1,!0),this.animations.add("damage04",["building01D"],1,!0);break;case 3:Phaser.Sprite.call(this,a,b,c,"building02"),this.animations.add("damage01",["building03A"],1,!0),this.animations.add("damage02",["building03B"],1,!0),this.animations.add("damage03",["building03C"],1,!0),this.animations.add("damage04",["building03D"],1,!0)}this.animations.play("damage01"),this.anchor.set(.5,1),this.shakeTween=this.game.add.tween(this),this.shakeTween.to({x:b+5},25,Phaser.Easing.Bounce.InOut,!1,10,4,!0),this.cropRect=new Phaser.Rectangle(0,0,this.width,this.height),this.fallTween=this.game.add.tween(this.cropRect),this.fallTween.to({height:0},2e3,Phaser.Easing.Linear.Out,!1).onComplete.add(function(){this.kill(),this.glassEmitter.destroy(),this.smokeEmitter.destroy();var a=this.game.time.create(!0);a.add(1e3,function(){this.smokeEndEmitter.destroy()},this),a.start();var b=BasicGame.cityBuildings.indexOf(this);BasicGame.cityBuildings.splice(b,1),this.debris.visible=!0},this),this.crop(this.cropRect),this.maxHealth=1,this.debris=new BuildingDebris(this.game,b,c+15,d),this.game.world.add(this.debris),this.debris.visible=!1},Buildings.prototype=Object.create(Phaser.Sprite.prototype),Buildings.prototype.constructor=Buildings,Buildings.prototype.addDestructionParticles=function(){this.glassEmitter=this.game.add.emitter(this.x,this.y-.5*this.height,200),this.glassEmitter.makeParticles("building02",["astilla01A","astilla01B","astilla01C","astilla01D"]),this.glassEmitter.width=.65*this.width,this.glassEmitter.height=.9*this.height,this.glassEmitter.gravity=400,this.smokeEmitter=this.game.add.emitter(this.x,this.y-.5*this.height,20),this.smokeEmitter.makeParticles("building02","humoDestruccion"),this.smokeEmitter.width=.65*this.width,this.smokeEmitter.height=.9*this.height,this.smokeEmitter.setAlpha(1,0,1500),this.smokeEmitter.gravity=-10,this.smokeEmitter.setScale(.1,1,.1,1,1500,Phaser.Easing.Quintic.Out),this.smokeEndEmitter=this.game.add.emitter(this.x,this.y,50),this.smokeEndEmitter.makeParticles("building02","humoDestruccion"),this.smokeEndEmitter.width=this.width,this.smokeEndEmitter.gravity=0,this.smokeEndEmitter.setAlpha(1,0,3e3),this.smokeEndEmitter.setRotation(-45,45),this.smokeEndEmitter.setScale(.1,1,.1,1,3e3,Phaser.Easing.Quintic.Out)},Buildings.prototype.damage=function(a){return this.alive&&this.health>0&&(this.health-=a,BasicGame.soundFx.play("golpe_edificio"),this.shakeTween.start(),this.checkDamageStatus()),this},Buildings.prototype.heal=function(a){return this.alive&&(this.health+=a,this.health>this.maxHealth&&(this.health=this.maxHealth),this.checkDamageStatus()),this},Buildings.prototype.checkDamageStatus=function(){this.health>.8?this.animations.play("damage01"):this.health>.5&&this.health<.8?(this.animations.play("damage02"),this.emitDestructionParticles()):this.health>.3&&this.health<.5?(this.animations.play("damage03"),this.emitDestructionParticles()):this.health>0&&this.health<.2?(this.animations.play("damage04"),this.emitDestructionParticles()):this.health<=0&&(this.fallTween.start(),this.smokeEndEmitter.flow(3e3,300,10),this.game.camera.shake(.005,1e3),BasicGame.soundFx.play("demolicion_edificio"))},Buildings.prototype.emitDestructionParticles=function(){BasicGame.FXEnabled&&(this.glassEmitter.start(!0,2500,null,100),this.smokeEmitter.start(!0,1500,null,10))},Buildings.prototype.update=function(){this.updateCrop()},ButtonLevelSelect=function(a,b,c,d,e){if(Phaser.Group.call(this,a),this.x=b,this.y=c,!d){var f=new Phaser.Image(a,0,0,"HUD","levelBaseLocked");return f.anchor.set(.5),void this.add(f)}this.myLevelInd=e;var g=new Phaser.Image(a,0,0,"HUD","levelBase");g.anchor.set(.5),g.inputEnabled=!0,g.events.onInputDown.add(this.gotoLevel,this),this.add(g);var h=new Phaser.BitmapText(a,g.x,g.y-30,"PPG_font",e+1,80);h.anchor.set(.5),this.add(h);var i=new Phaser.BitmapText(a,g.x,g.y+.3*g.height,"PPG_font",gameLevels.scoresData[e],48);i.anchor.set(.5),this.add(i);var j=g.y-.35*g.height,k=new Phaser.Image(a,g.x-.25*g.width,j,"HUD","score_starOff");k.anchor.set(.5),this.add(k);var l=new Phaser.Image(a,g.x,j,"HUD","score_starOff");l.anchor.set(.5),this.add(l);var m=new Phaser.Image(a,g.x+.25*g.width,j,"HUD","score_starOff");m.anchor.set(.5),this.add(m);var n=new Phaser.Image(a,g.x-.25*g.width,j,"HUD","score_starOn");n.anchor.set(.5),this.add(n);var o=new Phaser.Image(a,g.x,j,"HUD","score_starOn");o.anchor.set(.5),this.add(o);var p=new Phaser.Image(a,g.x+.25*g.width,j,"HUD","score_starOn");p.anchor.set(.5),this.add(p),n.visible=!1,o.visible=!1,p.visible=!1,null!=gameLevels.starsData[e]&&(gameLevels.starsData[e][0]&&(n.visible=!0),gameLevels.starsData[e][1]&&(o.visible=!0),gameLevels.starsData[e][2]&&(p.visible=!0))},ButtonLevelSelect.prototype=Object.create(Phaser.Group.prototype),ButtonLevelSelect.prototype.constructor=ButtonLevelSelect,ButtonLevelSelect.prototype.gotoLevel=function(){gameLevels.currentLevelIndex=this.myLevelInd,this.game.state.start("Game")},Explotion=function(a){Phaser.Sprite.call(this,a,0,0,"scene1"),this.animations.add("explode",Phaser.Animation.generateFrameNames("Explosion Generica/explosionGenerica",0,6,"",2),10,!1),this.anchor.set(.5),this.kill()},Explotion.prototype=Object.create(Phaser.Sprite.prototype),Explotion.prototype.constructor=Explotion,Explotion.prototype.respawnExplotion=function(a,b){this.reset(a,b),this.animations.play("explode"),this.events.onAnimationComplete.addOnce(function(){this.kill()},this);var c=Math.floor(2*Math.random());c>1?BasicGame.soundFx.play("explosion_1"):BasicGame.soundFx.play("explosion_2")},FeedbackSign=function(a){Phaser.Sprite.call(this,a,0,0,"HUD"),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.animations.add("bad",["feedbackNeg"],60,!1),this.animations.add("good",["feedbackPos"],60,!1),this.animations.add("heal",["pluslife"],60,!1),this.animations.play("good"),this.anchor.set(.5,.5)},FeedbackSign.prototype=Object.create(Phaser.Sprite.prototype),FeedbackSign.prototype.constructor=FeedbackSign,FeedbackSign.prototype.respawnSign=function(a,b,c){switch(this.reset(a,b),c){case BasicGame.signGood:this.animations.play("good"),BasicGame.soundFx.play("positive_feedback");break;case BasicGame.signBad:this.animations.play("bad"),BasicGame.soundFx.play("negative_feedback");break;case BasicGame.signHeal:this.animations.play("heal"),BasicGame.soundFx.play("positive_feedback")}this.alpha=1,this.game.add.tween(this).to({y:b-50,alpha:0},500,Phaser.Easing.Linear.In,!0).onComplete.add(this.kill,this)},GameOverGirls=function(a){Phaser.Group.call(this,a);var b=new Spriter.Loader,c=new Spriter.SpriterJSON(a.cache.getJSON("gameOverAnim"),{imageNameType:Spriter.eImageNameType.FULL_PATH_NO_EXTENSION}),d=b.load(c);this.spriterGroup=new Spriter.SpriterGroup(a,d,"gameOverAtlas","GameOver"),this.spriterGroup.fixedToCamera=!0,a.world.add(this.spriterGroup),this.spriterGroup.cameraOffset.set(0,.8*this.game.height),this.spriterGroup.playAnimationByName("ChicasIntro"),this.spriterGroup.onFinish.add(this.spriterAnimationFinished,this),this.spriterGroup.visible=!1},GameOverGirls.prototype=Object.create(Phaser.Group.prototype),GameOverGirls.prototype.constructor=GameOverGirls,GameOverGirls.prototype.showGirls=function(){this.game.world.bringToTop(this.spriterGroup),this.spriterGroup.visible=!0,this.spriterGroup.playAnimationByName("ChicasIntro")},GameOverGirls.prototype.update=function(){this.alive&&(BasicGame.gamePaused||this.spriterGroup.updateAnimation())},GameOverGirls.prototype.spriterAnimationFinished=function(){"ChicasIntro"==this.spriterGroup.currentAnimationName&&this.spriterGroup.playAnimationByName("ChicasLoop")},IntroGirls=function(a){Phaser.Group.call(this,a);var b=new Spriter.Loader,c=new Spriter.SpriterJSON(a.cache.getJSON("introAnim"),{imageNameType:Spriter.eImageNameType.FULL_PATH_NO_EXTENSION}),d=b.load(c);this.spriterGroup=new Spriter.SpriterGroup(a,d,"introAtlas","PPG_Intro"),this.spriterGroup.fixedToCamera=!0,a.world.add(this.spriterGroup),this.spriterGroup.cameraOffset.set(.5*this.game.width-340,this.game.height),this.spriterGroup.onFinish.add(this.spriterAnimationFinished,this),this.spriterGroup.visible=!1},IntroGirls.prototype=Object.create(Phaser.Group.prototype),IntroGirls.prototype.constructor=IntroGirls,IntroGirls.prototype.showGirls=function(){this.game.world.bringToTop(this.spriterGroup),this.spriterGroup.visible=!0,this.spriterGroup.playAnimationByName("intro")},IntroGirls.prototype.update=function(){this.alive&&(BasicGame.gamePaused||this.spriterGroup.updateAnimation())},IntroGirls.prototype.spriterAnimationFinished=function(){BasicGame.lvlFlowState==BasicGame.lvlFlowIntro&&this.game.state.states[this.game.state.current].startPlayState()},Mayor=function(a){Phaser.Group.call(this,a);var b=new Spriter.Loader,c=new Spriter.SpriterJSON(a.cache.getJSON("mayorAnim"),{imageNameType:Spriter.eImageNameType.FULL_PATH_NO_EXTENSION}),d=b.load(c);this.spriterGroup=new Spriter.SpriterGroup(a,d,"mayorAtlas","Mayor"),this.spriterGroup.fixedToCamera=!0,a.world.add(this.spriterGroup),this.spriterGroup.cameraOffset.set(-250,150),this.spriterGroup.playAnimationByName("llamada"),this.spriterGroup.onFinish.add(this.spriterAnimationFinished,this),this.fixedToCamera=!0,this.bubbleChat=new Phaser.Image(this.game,180,50,"HUD","chatbubble"),this.add(this.bubbleChat),this.iconWarning=new Phaser.Sprite(this.game,this.bubbleChat.x+.5*this.bubbleChat.width+10,this.bubbleChat.y+.5*this.bubbleChat.height,"HUD"),this.iconWarning.animations.add("meteor",["iconmeteorito"]),this.iconWarning.animations.add("meteorIce",["iconmeteorito_ice"]),this.iconWarning.animations.add("monster",["iconMonster"]),this.iconWarning.animations.add("redes",["iconRedes"]),this.iconWarning.animations.add("pickles",["iconPickle"]),this.iconWarning.animations.add("pop",["iconPop"]),this.iconWarning.animations.add("tarea",["iconMatematica"]),this.iconWarning.animations.add("dirigible",["iconDirigible"]),this.iconWarning.anchor.set(.5),this.add(this.iconWarning)},Mayor.prototype=Object.create(Phaser.Group.prototype),Mayor.prototype.constructor=Mayor,Mayor.prototype.showWarning=function(a){switch(BasicGame.soundFx.play("alarma"),this.spriterGroup.cameraOffset.x=-85,this.game.add.tween(this.spriterGroup.cameraOffset).to({x:85},1500,Phaser.Easing.Elastic.Out,!0),a){case BasicGame.eventComet:this.iconWarning.animations.play("meteor");break;case BasicGame.eventCometIce:this.iconWarning.animations.play("meteorIce");break;case BasicGame.eventMonster:this.iconWarning.animations.play("monster");break;case BasicGame.eventSocialNetwork:this.iconWarning.animations.play("redes");break;case BasicGame.eventPickles:this.iconWarning.animations.play("pickles");break;case BasicGame.eventPopsinger:this.iconWarning.animations.play("pop");break;case BasicGame.eventHomework:this.iconWarning.animations.play("tarea");break;case BasicGame.eventDirigible:this.iconWarning.animations.play("dirigible")}return a!=BasicGame.eventPickles||this.PicklesStartAnimPlayed?(this.spriterGroup.playAnimationByName("llamada"),void this.game.time.events.add(1.5*Phaser.Timer.SECOND,this.HideWarning,this)):(this.spriterGroup.playAnimationByName("Pickles"),void(this.PicklesStartAnimPlayed=!0))},Mayor.prototype.HideWarning=function(){this.game.add.tween(this.spriterGroup.cameraOffset).to({x:-250},1500,Phaser.Easing.Linear.Out,!0),BasicGame.soundFx.stop("alarma")},Mayor.prototype.spriterAnimationFinished=function(){"Pickles"==this.spriterGroup.currentAnimationName&&this.showWarning(BasicGame.eventPickles)},Mayor.prototype.update=function(){this.alive&&(BasicGame.gamePaused||(this.spriterGroup.updateAnimation(),this.bubbleChat.x=this.spriterGroup.cameraOffset.x+85,this.iconWarning.x=this.bubbleChat.x+.5*this.bubbleChat.width+10))},PausePanel=function(a){Phaser.Group.call(this,a),this.backPausa=new Phaser.TileSprite(a,0,0,this.game.width,this.game.height,"HUD","color16x16"),this.backPausa.fixedToCamera=!0,this.panelPausa=new Phaser.Image(a,this.game.width,0,"HUD","pause_panel"),this.panelPausa.fixedToCamera=!0,this.panelPausa.anchor.set(1,0),this.btnClosePause=new Phaser.Button(a,this.game.width-10,10,"HUD",this.btnPauseClose,this,"btnNo_over","btnNo_normal","btnNo_down","btnNo_normal"),this.btnClosePause.fixedToCamera=!0,this.btnClosePause.input.useHandCursor=!1,this.btnClosePause.anchor.set(1,0),this.btnAudioOn=new Phaser.Button(a,this.game.width-70,240,"HUD",this.btnAudioOnClick,this,"btn_sonidoOver","btn_sonidoNormal","btn_sonidoDown","btn_sonidoNormal"),this.btnAudioOn.fixedToCamera=!0,this.btnAudioOn.input.useHandCursor=!1,this.btnAudioOn.anchor.set(1,0),this.btnAudioOff=new Phaser.Button(a,this.game.width-70,240,"HUD",this.btnAudioOnClick,this,"btn_sonidoOFFOver","btn_sonidoOFFNormal","btn_sonidoOFFDown","btn_sonidoOFFNormal"),this.btnAudioOff.fixedToCamera=!0,this.btnAudioOff.input.useHandCursor=!1,this.btnAudioOff.anchor.set(1,0),this.game.sound.mute?(this.btnAudioOn.visible=!1,this.btnAudioOff.visible=!0):(this.btnAudioOn.visible=!0,this.btnAudioOff.visible=!1),this.btnHome=new Phaser.Button(a,this.game.width-70,320,"HUD",this.btnHomeClick,this,"btn_homeOver","btn_homeNormal","btn_homeDoen","btn_homeNormal"),this.btnHome.fixedToCamera=!0,this.btnHome.input.useHandCursor=!1,this.btnHome.anchor.set(1,0),this.btnHelp=new Phaser.Button(a,this.game.width-70,400,"HUD",this.btnClickHelp,this,"btn_helpOver","btn_helpNormal","btn_helpDown","btn_helpNormal"),this.btnHelp.fixedToCamera=!0,this.btnHelp.input.useHandCursor=!1,this.btnHelp.anchor.set(1,0),this.grpHelpPanel=new TutorialPanel(this.game),this.FxButton=new Phaser.Sprite(a,this.game.width-15,500,"HUD","FX_OFF"),this.FxButton.fixedToCamera=!0,this.FxButton.anchor.set(1,0),this.FxButton.animations.add("off",["FX_OFF"],60,!0),this.FxButton.animations.add("on",["FX_ON"],60,!0),this.FxButton.animations.play("off"),BasicGame.FXEnabled&&this.FxButton.animations.play("on"),this.FxButton.inputEnabled=!0,this.FxButton.events.onInputDown.add(function(){BasicGame.FXEnabled=!BasicGame.FXEnabled,localStorage.setItem("PPGFXEnabled",JSON.stringify(BasicGame.FXEnabled)),this.FxButton.animations.play("off"),BasicGame.FXEnabled&&this.FxButton.animations.play("on")},this),this.groupPauseHideTween=new Phaser.Tween(this,a,a.tweens),this.groupPauseHideTween.to({x:500},250,Phaser.Easing.Linear.Out).onComplete.add(function(){this.visible=!1},this),this.add(this.backPausa),this.add(this.panelPausa),this.add(this.btnClosePause),this.add(this.btnAudioOn),this.add(this.btnAudioOff),this.add(this.btnHome),this.add(this.btnHelp),this.add(this.FxButton),this.add(this.grpHelpPanel),this.visible=!1},PausePanel.prototype=Object.create(Phaser.Group.prototype),PausePanel.prototype.constructor=PausePanel,PausePanel.prototype.btnAudioOnClick=function(){this.game.sound.mute=!this.game.sound.mute,localStorage.setItem("PPGmuteState",JSON.stringify(this.game.sound.mute)),this.game.sound.mute?(this.btnAudioOn.visible=!1,this.btnAudioOff.visible=!0):(this.btnAudioOn.visible=!0,this.btnAudioOff.visible=!1)},PausePanel.prototype.btnHomeClick=function(){this.btnPauseClose(),BasicGame.music.stop(),BasicGame.soundFx.stop(),this.game.state.start("MainMenu")},PausePanel.prototype.btnPauseClose=function(){this.groupPauseHideTween.start(),this.grpHelpPanel.visible=!1,this.game.physics.arcade.isPaused=!1,BasicGame.gamePaused=!1,this.game.state.states[this.game.state.current].resumeEvents()},PausePanel.prototype.btnClickHelp=function(){this.grpHelpPanel.showHidePanel()},PowerPuffGirlsPlayer=function(a,b,c){Phaser.Group.call(this,a),this.powerpuffFollowPoint=new Phaser.Point(b,c),this.punchDamage=.005,this.laserDamage=.0045,this.blossom=new Phaser.Sprite(a,b,c,"Blossom"),this.blossom.anchor.set(.3125,60/99),this.game.physics.enable(this.blossom,Phaser.Physics.ARCADE),this.blossom.animations.add("fly",Phaser.Animation.generateFrameNames("PPF_Blossom_avanzar_",0,31,"",3),60,!0),this.blossom.animations.add("idle",Phaser.Animation.generateFrameNames("PPF_Blossom_Idle_",0,78,"",3),60,!0),this.blossom.animations.add("laserIn",Phaser.Animation.generateFrameNames("PPF_Blossom_LaserIn_",0,28,"",3),60,!1),this.blossom.animations.add("laserLoop",Phaser.Animation.generateFrameNames("PPF_Blossom_LaserLoop_",0,62,"",3),60,!0),this.blossom.animations.add("laserOut",Phaser.Animation.generateFrameNames("PPF_Blossom_LaserOut_",0,28,"",3),60,!1),this.blossom.animations.add("punch",Phaser.Animation.generateFrameNames("PPF_Blossom_Golpe_",0,43,"",3),240,!1).onComplete.add(this.punchMonster,this),this.blossom.play("fly"),this.buttercup=new Phaser.Sprite(a,b,c,"Buttercup"),this.buttercup.anchor.set(28/117,52/91),this.game.physics.enable(this.buttercup,Phaser.Physics.ARCADE),this.buttercup.animations.add("fly",Phaser.Animation.generateFrameNames("PPF_Buttercup_avanzar_",0,31,"",3),60,!0),this.buttercup.animations.add("idle",Phaser.Animation.generateFrameNames("PPF_Buttercup_Idle_",0,78,"",3),60,!0),this.buttercup.animations.add("laserIn",Phaser.Animation.generateFrameNames("PPF_Buttercup_LaserIn_",0,28,"",3),60,!1),this.buttercup.animations.add("laserLoop",Phaser.Animation.generateFrameNames("PPF_Buttercup_LaserLoop_",0,62,"",3),60,!0),this.buttercup.animations.add("laserOut",Phaser.Animation.generateFrameNames("PPF_Buttercup_LaserOut_",0,28,"",3),60,!1),this.buttercup.animations.add("punch",Phaser.Animation.generateFrameNames("PPF_Buttercup_Golpe_",0,43,"",3),240,!1).onComplete.add(this.punchMonster,this),this.buttercup.play("fly"),this.bubbles=new Phaser.Sprite(a,b,c,"Bubbles"),this.bubbles.anchor.set(.3,25/78),this.game.physics.enable(this.bubbles,Phaser.Physics.ARCADE),this.bubbles.animations.add("fly",Phaser.Animation.generateFrameNames("PPF_Buubbles_avanzar_",0,31,"",3),60,!0),this.bubbles.animations.add("idle",Phaser.Animation.generateFrameNames("PPF_Buubbles_Idle_",0,78,"",3),60,!0),this.bubbles.animations.add("laserIn",Phaser.Animation.generateFrameNames("PPF_Buubbles_LaserIn_",0,28,"",3),60,!1),this.bubbles.animations.add("laserLoop",Phaser.Animation.generateFrameNames("PPF_Buubbles_LaserLoop_",0,62,"",3),60,!0),this.bubbles.animations.add("laserOut",Phaser.Animation.generateFrameNames("PPF_Buubbles_LaserOut_",0,28,"",3),60,!1),this.bubbles.animations.add("punch",Phaser.Animation.generateFrameNames("PPF_Buubbles_Golpe_",0,43,"",3),240,!1).onComplete.add(this.punchMonster,this),this.bubbles.play("fly");var d=20;this.pointsBlossomTrail=[];for(var e=0;e<d;e++)this.pointsBlossomTrail.push(new Phaser.Point(0,0));this.trailBlossom=new Phaser.Rope(a,0,0,"trailBlossom",null,this.pointsBlossomTrail),this.add(this.trailBlossom),this.pointsButtercupTrail=[];for(var e=0;e<d;e++)this.pointsButtercupTrail.push(new Phaser.Point(0,0));this.trailButtercup=new Phaser.Rope(a,0,0,"trailButtercup",null,this.pointsButtercupTrail),this.add(this.trailButtercup),this.pointsBubblesTrail=[];for(var e=0;e<d;e++)this.pointsBubblesTrail.push(new Phaser.Point(0,0));this.trailBubbles=new Phaser.Rope(a,0,0,"trailBubbles",null,this.pointsBubblesTrail),this.add(this.trailBubbles),this.attackTarget=null,this.laserIsDamaging=!1,this.activityFlyingNormal=0,this.activityShootingLasers=1,this.activityPunching=2,this.blossom.currentActivity=this.activityFlyingNormal,this.buttercup.currentActivity=this.activityFlyingNormal,this.bubbles.currentActivity=this.activityFlyingNormal,this.blossomPositionNormal=new Phaser.Point(20,10),this.buttercupPositionNormal=new Phaser.Point((-40),30),this.bubblesPositionNormal=new Phaser.Point((-20),(-30)),this.blossomPositionLasers=new Phaser.Point(60,50),this.buttercupPositionLasers=new Phaser.Point((-60),70),this.bubblesPositionLasers=new Phaser.Point((-60),(-50)),this.blossomPositionIceComet=new Phaser.Point(40,30),this.buttercupPositionIceComet=new Phaser.Point((-40),40),this.bubblesPositionIceComet=new Phaser.Point((-40),(-20)),this.blossomPositionMonster=new Phaser.Point(10,(-250)),this.buttercupPositionMonster=new Phaser.Point(20,(-150)),this.bubblesPositionMonster=new Phaser.Point((-40),(-80)),
this.blossomPositionDirigible=new Phaser.Point(10,(-20)),this.buttercupPositionDirigible=new Phaser.Point(20,35),this.bubblesPositionDirigible=new Phaser.Point((-40),30),this.blossomPositionDeviation=this.blossomPositionNormal,this.buttercupPositionDeviation=this.buttercupPositionNormal,this.bubblesPositionDeviation=this.bubblesPositionNormal,this.girlsCenterPoint=new Phaser.Point(0,0),this.moveToPointer=!0,this.add(this.blossom),this.add(this.buttercup),this.add(this.bubbles),BasicGame.currentClickedEvent=BasicGame.eventNone},PowerPuffGirlsPlayer.prototype=Object.create(Phaser.Group.prototype),PowerPuffGirlsPlayer.prototype.constructor=PowerPuffGirlsPlayer,PowerPuffGirlsPlayer.prototype.girlsGoTo=function(a,b){BasicGame.currentClickedEvent==BasicGame.eventNone&&(a=Math.min(this.game.world.width-50,a),b=Math.min(this.game.world.height-50,b),a=Math.max(50,a),b=Math.max(50,b),this.powerpuffFollowPoint.set(a,b),this.blossomPositionDeviation=this.blossomPositionNormal,this.buttercupPositionDeviation=this.buttercupPositionNormal,this.bubblesPositionDeviation=this.bubblesPositionNormal)},PowerPuffGirlsPlayer.prototype.clickOnMeteorite=function(a){BasicGame.eventIsClicked||(BasicGame.eventIsClicked=!0,BasicGame.currentClickedEvent=BasicGame.eventComet,this.blossom.currentActivity=this.activityFlyingNormal,this.buttercup.currentActivity=this.activityFlyingNormal,this.bubbles.currentActivity=this.activityFlyingNormal,this.attackTarget=a,this.blossomPositionDeviation=this.blossomPositionLasers,this.buttercupPositionDeviation=this.buttercupPositionLasers,this.bubblesPositionDeviation=this.bubblesPositionLasers)},PowerPuffGirlsPlayer.prototype.clickOnMonster=function(a){BasicGame.eventIsClicked||(BasicGame.eventIsClicked=!0,BasicGame.currentClickedEvent=BasicGame.eventMonster,this.blossom.currentActivity=this.activityFlyingNormal,this.buttercup.currentActivity=this.activityFlyingNormal,this.bubbles.currentActivity=this.activityFlyingNormal,this.attackTarget=a,this.powerpuffFollowPoint.set(this.attackTarget.x,this.attackTarget.y-.5*this.attackTarget.height),this.blossomPositionDeviation=this.blossomPositionMonster,this.buttercupPositionDeviation=this.buttercupPositionMonster,this.bubblesPositionDeviation=this.bubblesPositionMonster)},PowerPuffGirlsPlayer.prototype.clickOnDirigible=function(a){BasicGame.eventIsClicked||(BasicGame.eventIsClicked=!0,BasicGame.currentClickedEvent=BasicGame.eventDirigible,this.blossom.currentActivity=this.activityFlyingNormal,this.buttercup.currentActivity=this.activityFlyingNormal,this.bubbles.currentActivity=this.activityFlyingNormal,this.attackTarget=a,this.powerpuffFollowPoint.set(this.attackTarget.x,this.attackTarget.y-.5*this.attackTarget.height),this.blossomPositionDeviation=this.blossomPositionDirigible,this.buttercupPositionDeviation=this.buttercupPositionDirigible,this.bubblesPositionDeviation=this.bubblesPositionDirigible)},PowerPuffGirlsPlayer.prototype.clickOnIceMeteorite=function(a){BasicGame.eventIsClicked||(BasicGame.eventIsClicked=!0,BasicGame.currentClickedEvent=BasicGame.eventCometIce,this.blossom.currentActivity=this.activityFlyingNormal,this.buttercup.currentActivity=this.activityFlyingNormal,this.bubbles.currentActivity=this.activityFlyingNormal,this.attackTarget=a,this.powerpuffFollowPoint.set(this.attackTarget.x,this.attackTarget.y),this.blossomPositionDeviation=this.blossomPositionIceComet,this.buttercupPositionDeviation=this.buttercupPositionIceComet,this.bubblesPositionDeviation=this.bubblesPositionIceComet)},PowerPuffGirlsPlayer.prototype.update=function(){BasicGame.gamePaused||(this.girlsCenterPoint=Phaser.Point.centroid([this.blossom.position,this.buttercup.position,this.bubbles.position]),BasicGame.lvlFlowState==BasicGame.lvlFlowPlaying&&this.updateGirlsEventAttack(),this.updateGirlsPosition(this.blossom,this.blossomPositionDeviation.x,this.blossomPositionDeviation.y),this.updateGirlsPosition(this.bubbles,this.bubblesPositionDeviation.x,this.bubblesPositionDeviation.y),this.updateGirlsPosition(this.buttercup,this.buttercupPositionDeviation.x,this.buttercupPositionDeviation.y),this.updateGirlsAnimation(this.blossom),this.updateGirlsAnimation(this.bubbles),this.updateGirlsAnimation(this.buttercup),this.updateTrails(this.trailBlossom,this.blossom,this.pointsBlossomTrail),this.updateTrails(this.trailButtercup,this.buttercup,this.pointsButtercupTrail),this.updateTrails(this.trailBubbles,this.bubbles,this.pointsBubblesTrail))},PowerPuffGirlsPlayer.prototype.updateGirlsEventAttack=function(){if(BasicGame.eventIsClicked)switch(BasicGame.currentClickedEvent){case BasicGame.eventComet:null!=this.attackTarget&&(this.attackTarget.alive?(this.powerpuffFollowPoint.set(this.attackTarget.x,this.attackTarget.y),this.updateLaserAttack(this.blossom),this.updateLaserAttack(this.bubbles),this.updateLaserAttack(this.buttercup)):BasicGame.eventIsClicked=!1),this.game.input.activePointer.isUp&&(this.blossom.currentActivity=this.activityFlyingNormal,this.bubbles.currentActivity=this.activityFlyingNormal,this.buttercup.currentActivity=this.activityFlyingNormal,BasicGame.eventIsClicked=!1);break;case BasicGame.eventMonster:case BasicGame.eventDirigible:this.powerpuffFollowPoint.set(this.attackTarget.x,this.attackTarget.y-.5*this.attackTarget.height),null!=this.attackTarget&&(this.attackTarget.alive?(this.updatePunchAttack(this.blossom,Phaser.Point.add(this.powerpuffFollowPoint,this.blossomPositionDeviation)),this.updatePunchAttack(this.bubbles,Phaser.Point.add(this.powerpuffFollowPoint,this.bubblesPositionDeviation)),this.updatePunchAttack(this.buttercup,Phaser.Point.add(this.powerpuffFollowPoint,this.buttercupPositionDeviation))):BasicGame.eventIsClicked=!1);break;case BasicGame.eventCometIce:this.powerpuffFollowPoint.set(this.attackTarget.x,this.attackTarget.y),null!=this.attackTarget&&(this.attackTarget.alive?(this.updatePunchAttack(this.blossom,Phaser.Point.add(this.powerpuffFollowPoint,this.blossomPositionDeviation)),this.updatePunchAttack(this.bubbles,Phaser.Point.add(this.powerpuffFollowPoint,this.bubblesPositionDeviation)),this.updatePunchAttack(this.buttercup,Phaser.Point.add(this.powerpuffFollowPoint,this.buttercupPositionDeviation))):BasicGame.eventIsClicked=!1);break;case BasicGame.eventSocialNetwork:}else this.game.input.activePointer.isDown&&(BasicGame.wasClicked||(this.girlsGoTo(this.game.input.activePointer.worldX,this.game.input.activePointer.worldY),BasicGame.currentClickedEvent=BasicGame.eventNone))},PowerPuffGirlsPlayer.prototype.updateLaserAttack=function(a){var b=a.position.distance(this.attackTarget);b<100&&(this.laserIsDamaging&&this.attackTarget.damage(this.laserDamage),a.currentActivity=this.activityShootingLasers)},PowerPuffGirlsPlayer.prototype.updatePunchAttack=function(a,b){var c=a.position.distance(b);c<50&&(a.currentActivity=this.activityPunching)},PowerPuffGirlsPlayer.prototype.updateGirlsAnimation=function(a){switch(a.currentActivity){case this.activityShootingLasers:BasicGame.eventIsClicked?"laserLoop"!=a.animations.currentAnim.name&&"laserIn"!=a.animations.currentAnim.name&&(BasicGame.soundFx.play("laser_comienzo"),this.laserIsDamaging=!1,a.play("laserIn").onComplete.addOnce(function(){a.play("laserLoop"),BasicGame.soundFx.play("laser_medio"),this.laserIsDamaging=!0},this)):"laserLoop"!=a.animations.currentAnim.name&&"laserIn"!=a.animations.currentAnim.name||(BasicGame.soundFx.stop("laser_comienzo"),BasicGame.soundFx.play("laser_fin"),a.play("laserOut").onComplete.addOnce(function(){a.currentActivity=this.activityFlyingNormal},this));break;case this.activityPunching:"punch"!=a.animations.currentAnim.name&&a.play("punch"),BasicGame.eventIsClicked||(a.currentActivity=this.activityFlyingNormal);break;case this.activityFlyingNormal:Math.abs(a.body.velocity.x)>50||Math.abs(a.body.velocity.y)>50?a.play("fly"):a.play("idle")}a.x<this.powerpuffFollowPoint.x?a.scale.x=1:a.scale.x=-1},PowerPuffGirlsPlayer.prototype.updateGirlsPosition=function(a,b,c){this.game.physics.arcade.moveToXY(a,this.powerpuffFollowPoint.x+b,this.powerpuffFollowPoint.y+c,1500,250)},PowerPuffGirlsPlayer.prototype.updateTrails=function(a,b,c){if(!BasicGame.FXEnabled)return void(a.visible=!1);a.visible=!0;var d=c.pop(),e=0;switch(b){case this.blossom:e=b.scale.x<0?10:-5;break;case this.buttercup:e=-5;break;case this.bubbles:e=-5}d.setTo(b.x+b.body.velocity.x/60+e,b.y+b.body.velocity.y/60),c.unshift(d);for(var f=0;f<a.points.length;f++)a.points[f].x=c[f].x,a.points[f].y=c[f].y},PowerPuffGirlsPlayer.prototype.punchMonster=function(a){if(BasicGame.currentClickedEvent==BasicGame.eventMonster||BasicGame.currentClickedEvent==BasicGame.eventDirigible||BasicGame.currentClickedEvent==BasicGame.eventCometIce)switch(this.attackTarget.damage(this.punchDamage),this.attackTarget.startHitState(),a.currentActivity=this.activityFlyingNormal,BasicGame.eventIsClicked=!1,a){case this.bubbles:BasicGame.soundFx.play("powerpunch_1");break;case this.blossom:BasicGame.soundFx.play("powerpunch_2");break;case this.buttercup:BasicGame.soundFx.play("powerpunch_3")}};var TutoFinger=function(a){Phaser.Sprite.call(this,a,0,0,"HUD"),this.animations.add("pressing",["manito02"],60,!1),this.animations.add("tapRepeat",["manito01","manito02"],10,!0),this.animations.play("pressing"),this.anchor.set(.25,.15),this.warningTarget=null};TutoFinger.prototype=Object.create(Phaser.Sprite.prototype),TutoFinger.prototype.constructor=TutoFinger,TutoFinger.prototype.respawnFinger=function(a,b){switch(this.reset(0,0),this.type=a,a){case 0:this.animations.play("pressing");break;case 1:case 2:this.animations.play("tapRepeat"),this.game.time.events.add(20*Phaser.Timer.SECOND,function(){this.kill()},this)}this.warningTarget=b},TutoFinger.prototype.update=function(){if(null!=this.warningTarget){var a=0;"tapRepeat"==this.animations.currentAnim.name&&2!=this.type&&(a=.7*-this.warningTarget.height),this.x=this.warningTarget.x,this.y=this.warningTarget.y+a,this.warningTarget.alive||(this.kill(),this.warningTarget=null)}},TutorialPanel=function(a){Phaser.Group.call(this,a),this.tutoPanelIndex=0,this.panelTutorial=new Phaser.Sprite(a,.5*this.game.width,.5*this.game.height-10,"HUD"),this.panelTutorial.anchor.set(.5),this.panelTutorial.fixedToCamera=!0,this.panelTutorial.animations.add("panel01",["panel01"]),this.panelTutorial.animations.add("panel02",["panel02"]),this.panelTutorial.animations.add("panel03",["panel03"]),this.panelTutorial.animations.play("panel01"),this.add(this.panelTutorial),this.btnClosepanelTutorial=new Phaser.Button(a,.5*this.game.width,this.game.height-10,"HUD",this.showHidePanel,this,"btnNo_over","btnNo_normal","btnNo_down","btnNo_normal"),this.btnClosepanelTutorial.fixedToCamera=!0,this.btnClosepanelTutorial.anchor.set(.5,1),this.btnClosepanelTutorial.input.useHandCursor=!1,this.add(this.btnClosepanelTutorial),this.btnNextTutorial=new Phaser.Button(a,.5*this.game.width+150,this.game.height-10,"HUD",this.btnClickHelpNext,this,"btn_siguienteOver","btn_siguienteNormal","btn_siguienteDown","btn_siguienteNormal"),this.btnNextTutorial.fixedToCamera=!0,this.btnNextTutorial.anchor.set(.5,1),this.btnNextTutorial.input.useHandCursor=!1,this.add(this.btnNextTutorial),this.btnBackTutorial=new Phaser.Button(a,.5*this.game.width-150,this.game.height-10,"HUD",this.btnClickHelpBack,this,"btn_back_over","btn_back_normal","btn_back_down","btn_back_normal"),this.btnBackTutorial.fixedToCamera=!0,this.btnBackTutorial.anchor.set(.5,1),this.btnBackTutorial.input.useHandCursor=!1,this.btnBackTutorial.visible=!1,this.add(this.btnBackTutorial),this.visible=!1},TutorialPanel.prototype=Object.create(Phaser.Group.prototype),TutorialPanel.prototype.constructor=TutorialPanel,TutorialPanel.prototype.showHidePanel=function(){this.visible=!this.visible,this.visible?(this.tutoPanelIndex=0,this.selectPanelHelp()):BasicGame.lvlFlowState==BasicGame.lvlFlowTutorial&&this.game.state.states[this.game.state.current].startIntroState()},TutorialPanel.prototype.btnClickHelpNext=function(){this.tutoPanelIndex++,this.tutoPanelIndex>0&&(this.btnBackTutorial.visible=!0),this.tutoPanelIndex>2&&this.showHidePanel(),this.selectPanelHelp()},TutorialPanel.prototype.btnClickHelpBack=function(){this.tutoPanelIndex--,this.tutoPanelIndex<1&&(this.btnBackTutorial.visible=!1),this.selectPanelHelp()},TutorialPanel.prototype.selectPanelHelp=function(){switch(this.tutoPanelIndex){case 0:this.panelTutorial.animations.play("panel01");break;case 1:this.panelTutorial.animations.play("panel02");break;case 2:this.panelTutorial.animations.play("panel03")}};