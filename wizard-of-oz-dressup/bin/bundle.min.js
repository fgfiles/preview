(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var AudioParams       = require("./audio/AudioParams");
var BackgroundScreen  = require('./screens/BackgroundScreen');
var Common            = require('./Common');
var DressupScreen     = require('./screens/DressupScreen');
var PauseOverlay      = require('./overlays/PauseOverlay');
var PhotoScreen       = require('./screens/PhotoScreen');
var TitleScreen       = require('./screens/TitleScreen');


function Application()
{
    this._currentMusic = null;
}
module.exports = Application;

Application.prototype.init = function()
{
    this._generateTextures();
    this.createTitleScreen();

    var params = new AudioParams();
    params.loop = true;
    Common.audio.playSound('sfx_ambient_birdsong_01', params);
};

Application.prototype.createTitleScreen = function()
{
    var screen = new TitleScreen();
    Common.sceneManager.add(screen, this._getTransition());

    screen.signals.requestedMusicPlay.add(this._playMusic, this);
    
    screen.signals.next.addOnce(function(id)
    {
        Common.audio.playSound('sfx_btn_play_start_doorbell_00');
        this.createDressupScreen();
    }, this);

    screen.signals.previous.addOnce(function(id)
    {
        
    }, this);

    screen.signals.guiClick.add(function(id)
    {
        if(id == 'pause')
        {
            this.createPauseOverlay(screen);
        }
    }, this);
    
    Common.currentScreen = screen;
    
    return screen;  
};

Application.prototype.createDressupScreen = function(character)
{
    var screen = new DressupScreen(character);
    Common.sceneManager.add(screen, this._getTransition());

    screen.signals.requestedMusicPlay.add(this._playMusic, this);
    
    screen.signals.next.addOnce(function(id)
    {
        var character = screen.getCharacter();
        this.createBackgroundScreen(character);
    }, this);

    screen.signals.previous.addOnce(function(id)
    {
        
    }, this);

    screen.signals.guiClick.add(function(id)
    {
        if(id == 'pause')
        {
            this.createPauseOverlay(screen);
        }
    }, this);
    
    Common.currentScreen = screen;
    
    return screen; 
};

Application.prototype.createBackgroundScreen = function(character, background)
{
    var screen = new BackgroundScreen(character, background);
    Common.sceneManager.add(screen, this._getTransition());

    screen.signals.requestedMusicPlay.add(this._playMusic, this);
    
    screen.signals.next.addOnce(function(newBackground)
    {
        Common.audio.playSound('sfx_btn_accept_00');
        this.createPhotoScreen(character, newBackground);
    }, this);

    screen.signals.previous.addOnce(function(id)
    {
        Common.audio.playSound('music_restart_00');
        this.createDressupScreen(character);
    }, this);

    screen.signals.guiClick.add(function(id)
    {
        if(id == 'pause')
        {
            this.createPauseOverlay(screen);
        }
        else if(id == 'home')
        {
            this.createTitleScreen();
        }
    }, this);
    
    Common.currentScreen = screen;
    
    return screen;
};

Application.prototype.createPhotoScreen = function(character, background)
{
    var screen = new PhotoScreen(character, background);
    Common.sceneManager.add(screen, this._getTransition());

    screen.signals.requestedMusicPlay.add(this._playMusic, this);
    
    screen.signals.next.addOnce(function(id)
    {
        Common.audio.playSound('sfx_btn_reset_01');
        this.createDressupScreen();
    }, this);

    screen.signals.previous.addOnce(function(state)
    {
        Common.audio.playSound('music_restart_00');
        p3.log(state);
        if(state == 'photo')
            this.createBackgroundScreen(character, background);
        else
            this.createPhotoScreen(character, background);
    }, this);

    screen.signals.guiClick.add(function(id)
    {
        if(id == 'pause')
        {
            this.createPauseOverlay(screen);
        }
        else if(id == 'home')
        {
            this.createTitleScreen();
        }
        else if(id == 'restart')
        {
            this.createBackgroundScreen(character);
        }
    }, this);
    
    Common.currentScreen = screen;
    
    return screen;
};

Application.prototype.createPauseOverlay = function(parentScreen)
{
    if(parentScreen)
    {
        parentScreen.hideGUI();
    }

    var prevMusic = this._currentMusic;

    var screen = new PauseOverlay();
    Common.sceneManager.add(screen, this._getBlankTransition());

    screen.signals.requestedMusicPlay.add(this._playMusic, this);

    screen.signals.guiClick.add(function(id)
    {
        if(id == 'help')
        {
            this.createHelpOverlay(screen);
        }
        else if(id == 'home')
        {
            this.createTitleScreen();
        }
    }, this);
    
    screen.signals.next.addOnce(function(id)
    {
        Common.sceneManager.remove();
        if(parentScreen)
        {
            parentScreen.showGUI();
            this._playMusic(prevMusic);
        }
    }, this);

    screen.signals.previous.addOnce(function(id)
    {

    }, this);

    return screen;
};

Application.prototype._getTransition = function()
{
    var transition = new p3.Transition();
    transition.wait    = false;
    transition.push    = false;
    transition.replace = true;
    
    return transition;
};

Application.prototype._getBlankTransition = function()
{
    var t = new p3.Transition();
    t.replace = false;
    t.push = true;

    return t;
};

Application.prototype._generateTextures = function()
{
    for(var i in Common.colourHexes)
    {
        var g = new PIXI.Graphics();
        g.beginFill(Common.colourHexes[i], 1);
        g.drawRect(0, 0, 2, 2);
        var tmp = Common.renderer.generateTexture(g);
        g.destroy();
        g = null;
        Common.colours[i] = tmp;
    }

    var graphic = new PIXI.Graphics();
    graphic.beginFill(0xFFFFFF);
    graphic.drawRect(0, 0, 200, 100);
    Common.placeHolderButtonBox = Common.renderer.generateTexture(graphic);
};

Application.prototype._playMusic = function(track)
{
    var params = new AudioParams();
    params.loop = true;
    params.fadeIn = 0.5;
    Common.audio.playMusic(track, params);
    this._currentMusic = track;
}

},{"./Common":2,"./audio/AudioParams":7,"./overlays/PauseOverlay":21,"./screens/BackgroundScreen":22,"./screens/DressupScreen":23,"./screens/PhotoScreen":24,"./screens/TitleScreen":27}],2:[function(require,module,exports){

function Common()
{
}
module.exports = Common;

//Stage dimensions
Common.STAGE_WIDTH = 1900;
Common.STAGE_HEIGHT = 768;

//PIXI
Common.view = null;
Common.stage = null;
Common.renderer = null;
Common.isWebGL = false;

//Paths
Common.gameDir = '';
Common.paths = {
	scripts   	: 'scripts/',
	data      	: 'assets/data/',
	images    	: 'assets/images/',
	fonts     	: 'assets/fonts/',
	audio     	: 'assets/audio/',
	particles 	: 'assets/particles/',
	system    	: 'assets/images/system/',
	localisation : 'assets/images/localisation/'
},

//Scene
Common.sceneManager = null;
Common.currentScreen = null;

//Config
Common.config = null;

//Assets
Common.assets = null;

//Audio
Common.audio = null;

//Localisation
Common.language = "en";

//Interaction
Common.input = null;
Common.touch = new PIXI.Point(0, 0);
Common.touching = false;

//Time
Common.delta = null;
Common.fpsMeter = null;
Common.FPS = 60;
Common.frameCount = 0;
Common.paused = false;

//Animation
Common.animator = null;

//Particles
Common.emitter = null;

//Colours
Common.colourHexes = {
	black:0x000000,
	white:0xFFFFFF
}
Common.colours = {};

//Placeholder button
Common.placeHolderButtonBox = null;
Common.placeHolderButtonIcons = {};

//Performance
Common.lowPerformance = true;



/* ___GAME SPECIFIC___ */

Common.tutorialStatesPassed = {clothes:false, scroll:false, categories:false};

Common.savedData = null;




},{}],3:[function(require,module,exports){
var Application      = require("./Application");
var AudioManager     = require("./audio/AudioManager");
var Common           = require('./Common');
var Emitter          = require('./common/Emitter');
var FontLoader       = require('./common/FontLoader');
var Input            = require('./common/Input');
var QueueCalls       = require('./common/QueueCalls');
var PreloaderScreen  = require("./screens/PreloaderScreen");
var SavedData        = require("./SavedData");
    
function Main(width, height, language)
{
    this._width  = width;
    this._height = height;

    this._game   = null;
    this._preloader  = null;
    this._fontLoader = null;

    this._scale = "1x";

    Common.language = language;
}

Main.prototype.init = function()
{
    var params              = new p3.ViewParams();
    params.width            = this._width;
    params.height           = this._height;
    params.holderId         = 'game';
    params.rotateImageUrl   = Common.gameDir + Common.paths.localisation + Common.language + '/rotate_screen_' + Common.language + '.jpg';
    params.rotateImageColor = '#000000';

    PIXI.settings.RETINA_PREFIX = /\_(?=[^_]*$)(.+)x/;

    p3.Device.init(window.bowser);

    if(p3.Device.isMobile)
    {
        p3.log = function(){};
    }
    var isIpad2 = (p3.Device.isIOS && p3.Device.isIpad && window.devicePixelRatio === 1);

    if(p3.Device.isIpadMini || p3.Device.isIpod || isIpad2 || 
       /Android 4/i.test(navigator.userAgent))
    {
        this._scale = '0.5x';
        Common.lowPerformance = true;
    }

    TweenMax.defaultOverwrite = 'none';
    TweenMax.ticker.fps(Common.FPS);
    
    Common.view = new p3.View(params);
    Common.view.signals.ready.addOnce(this.onViewReady, this);

    Common.view.signals.resize.add(this.onCanvasResize, this);
};

Main.prototype.onViewReady = function(canvas)
{
    var isKindle = navigator.userAgent.match(/Kindle|Silk|KFA/) !== null;
    
    var options = {
        view                  : canvas,
        transparent           : isKindle,
        antialias             : false,
        preserveDrawingBuffer : false,
        resolution            : 1
    };
    
    Common.stage = new PIXI.Container();

    if(this._shouldForceCanvas())
    {
        Common.renderer = new PIXI.CanvasRenderer(window.innerWidth, window.innerHeight, options);
    }
    else
    {
        Common.renderer = !p3.Device.isCocoonJS ? 
                            PIXI.autoDetectRenderer(this._width, this._height, options)
                      : 
                            new PIXI.WebGLRenderer(window.innerWidth, window.innerHeight, options);
    }         
    
    Common.isWebGL  = (Common.renderer instanceof PIXI.WebGLRenderer);
    
    if (p3.Device.isCocoonJS)
    {
        Common.stage.scale.x = window.innerHeight / this._height;
        Common.stage.scale.y = window.innerHeight / this._height;
    }

    Common.sceneManager = new p3.SceneManager();
    Common.sceneManager.updateAll = true;
    Common.stage.addChild(Common.sceneManager.view);

    Common.assets   = p3.AssetManager.instance;
    Common.audio    = p3.Button.audio   = new AudioManager();

    Common.input = new Input();
    Common.input.init(Common.stage, canvas);

    Common.animator = new p3.Animator();
    Common.animator.init();

    Common.queueCalls = new QueueCalls();

    Common.emitter = Emitter;

    Common.savedData = new SavedData();

    if(Common.savedData.allTutorialsViewed)
    {
        for(var i in Common.tutorialStatesPassed)
        {
            Common.tutorialStatesPassed[i] = true;
        }
    }

    PIXI.ticker.shared.add(this.update, this);
    
    this.loadPreloader();

    window.delay = function(callback, delay, scope)
    {
        return Common.animator.setTimeout(callback, delay, scope);
    };
    window.delayarg = function(callback, args, delay, scope)
    {
        Common.animator.setTimeout(function() {
            callback.call(scope, args);
        }, delay, this);
    };
}

Main.prototype.onLoadingProgress = function(event)
{
    this._preloader.loaded = event.progress;
};

Main.prototype.onLoadingCompleted = function()
{
    this._preloader.loadedPercentage = 100;
    this._preloader.animateOut(null, this);
    this._preloader = null;

    Common.assets.signals.progress.removeAll();
    Common.assets.signals.complete.removeAll();

    console.log('onLoadingCompleted', this._fontLoader.hasLoaded);
    if(this._fontLoader.hasLoaded)
    {
        this.startGame();
    } 
};

Main.prototype.onFontLoaded = function()
{
    console.log('onFontLoaded');
    if(this._preloader.loadedPercentage == 100)
    {
        this.startGame();
    }
}

Main.prototype.loadPreloader = function()
{
    var files = [
        { name: 'preloader',        url: Common.gameDir + Common.paths.images + '1x/preloader_1x.json' },
        { name: 'clothes_config',   url: Common.gameDir + Common.paths.data + 'clothes.json' },
        { name: 'strings_config',    url: Common.gameDir + Common.paths.data + 'strings.json' },
        { name: 'strings_formatting_config',    url: Common.gameDir + Common.paths.data + 'strings_formatting.json' }
    ];
    
    if(files.length > 0)
    {
        Common.assets.addFiles(files);
        Common.assets.signals.complete.addOnce(this.loadAssets, this);
        Common.assets.load();
    }
    else
    {
        this.loadAssets();
    }

    this._fontLoader = new FontLoader('Windsor Elongated');
    this._fontLoader.signals.loaded.addOnce(this.onFontLoaded, this);
    this._fontLoader.init();
};

Main.prototype.loadAssets = function()
{
    var files = [
        { name: 'dorothy_anim',     url: Common.gameDir + Common.paths.images + 'spine/dorothy.json' },
        { name: 'bg_game_001',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_001_' + this._scale + '.jpg' },
        { name: 'bg_game_002',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_002_' + this._scale + '.jpg' },
        { name: 'bg_game_003',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_003_' + this._scale + '.jpg' },
        { name: 'bg_game_004',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_004_' + this._scale + '.jpg' },
        { name: 'bg_game_005',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_005_' + this._scale + '.jpg' },
        { name: 'bg_game_006',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_006_' + this._scale + '.jpg' },
        { name: 'bg_game_007',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_007_' + this._scale + '.jpg' },
        { name: 'bg_game_008',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_008_' + this._scale + '.jpg' },
        { name: 'bg_game_009',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_009_' + this._scale + '.jpg' },
        { name: 'bg_game_010',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_010_' + this._scale + '.jpg' },
        { name: 'bg_game_011',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_011_' + this._scale + '.jpg' },
        { name: 'bg_game_012',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_012_' + this._scale + '.jpg' },
        { name: 'bg_game_013',      url: Common.gameDir + Common.paths.images + this._scale + '/bg_game_013_' + this._scale + '.jpg' },
        { name: 'bg_splash',        url: Common.gameDir + Common.paths.images + this._scale + '/bg_splash_' + this._scale + '.jpg' },
        { name: 'bg_photo',         url: Common.gameDir + Common.paths.images + this._scale + '/bg_photo_' + this._scale + '.jpg' },
        { name: 'buttons',          url: Common.gameDir + Common.paths.images + this._scale + '/buttons_' + this._scale + '.json' },
        { name: 'clothes',          url: Common.gameDir + Common.paths.images + this._scale + '/clothes_' + this._scale + '.json' },
        { name: 'pose',             url: Common.gameDir + Common.paths.images + this._scale + '/pose_' + this._scale + '.json' },
        { name: 'ui',               url: Common.gameDir + Common.paths.images + this._scale + '/ui_' + this._scale + '.json' },

        { name: 'title',            url: Common.gameDir + Common.paths.images + 'localisation/' + Common.language + '/title_' + Common.language + '.png' },
        { name: 'paused',           url: Common.gameDir + Common.paths.images + 'localisation/' + Common.language + '/paused_' + Common.language + '.png' },
        { name: 'areyousure',       url: Common.gameDir + Common.paths.images + 'localisation/' + Common.language + '/areyousure_' + Common.language + '.png' },
        { name: 'windsor_font',     url: Common.gameDir + Common.paths.fonts + 'windsor_45.xml' },
        { name: 'windsor_ar_font',  url: Common.gameDir + Common.paths.fonts + 'windsor_ar.xml' },
        
        { name: 'particle_emitter_starburst_orange_00', url: Common.gameDir + Common.paths.particles + 'particle_emitter_starburst_orange_00.json' },
        { name: 'particle_emitter_starburst_pink_00', url: Common.gameDir + Common.paths.particles + 'particle_emitter_starburst_pink_00.json' },
        { name: 'particle_emitter_starburst_yellow_00', url: Common.gameDir + Common.paths.particles + 'particle_emitter_starburst_yellow_00.json' },
        { name: 'particle_emitter_starburst_blue_00', url: Common.gameDir + Common.paths.particles + 'particle_emitter_starburst_blue_00.json' },
        { name: 'particle_emitter_starburst_green_00', url: Common.gameDir + Common.paths.particles + 'particle_emitter_starburst_green_00.json' },
    ];

    var sounds = [
        'music_ambient_wardrobe_loop_00',
        'music_camera_loop_00',
        'music_dorothy_complete_00',
        'music_lion_complete_00',
        'music_menu_loop_01',
        'music_pausehelp_menu_00',
        'music_restart_00',
        'music_scarecrow_complete_00',
        'music_stab_change_pose_00',
        'music_stab_change_pose_01',
        'music_stab_change_pose_02',
        'music_stab_change_pose_03',
        'music_tinman_complete_00',
        'music_witch_complete_00',
        'sfx_ambient_birdsong_01',
        'sfx_attach_item_lion_00',
        'sfx_attach_item_scarecrow_00',
        'sfx_attach_item_tinman_00',
        'sfx_background_swipe_00',
        'sfx_btn_accept_00',
        'sfx_btn_change_camera_pose_00',
        'sfx_btn_play_start_doorbell_00',
        'sfx_btn_reset_01',
        'sfx_costume_accept_00',
        'sfx_dorothy_click_heals_00',
        'sfx_dorothy_disappear_00',
        'sfx_dorothy_land_00',
        'sfx_dorothy_skid_in_00',
        'sfx_lion_complete_00',
        'sfx_magic_sparkles_00',
        'sfx_outfit_nome_king_complete_00',
        'sfx_outfit_queen_complete_00',
        'sfx_outfit_scarecrow_complete_00',
        'sfx_outfit_tinman_complete_00',
        'sfx_outfit_witch_complete_00',
        'sfx_scroll_wardrobe_loop_01',
        'sfx_switch_hat_00',
        'sfx_switch_shoes_00',
        'sfx_switch_top_01',
        'sfx_switch_trousers_01',
        'sfx_take_final_photo',
        'sfx_toto_bark_00',
        'sfx_wardrobe_appear_00',
        'sfx_wardrobe_change_draw_01'
    ];

    Common.config = {};
    Common.config.clothes = Common.assets.getJSON('clothes_config');
    Common.config.strings = Common.assets.getJSON('strings_config');
    Common.config.strings_formatting = Common.assets.getJSON('strings_formatting_config');
    
    for(var i in Common.config)
    {
        if(Common.config[i] == null)
        {
            console.warn("CONFIG: " + i + " IS NULL");
        }
    }

    if (files.length > 0)
    {
        this._preloader = new PreloaderScreen();
        Common.sceneManager.add(this._preloader);
        
        Common.assets.addFiles(files);
        Common.assets.signals.progress.add(this.onLoadingProgress, this);
        this._preloader.signals.loadComplete.addOnce(this.onLoadingCompleted, this);
        Common.assets.load();

        Common.audio.addSounds(sounds, ['.ogg', '.mp3', '.m4a'],  Common.gameDir + Common.paths.audio);
    }
    else
    {
        this.startGame();
    }
};

Main.prototype.startGame = function()
{
    Common.animator.setTimeout(function(){
        this._game = new Application();
        this._game.init();
    }, 1, this);
};

Main.prototype.update = function(delta)
{
    Common.delta = delta / PIXI.settings.TARGET_FPMS / 1000;
    p3.Timestep.deltaTime = Common.delta;

    if (!Common.view.isCorrectOrientation()) {
        return;
    }

    Common.frameCount++;
    Common.sceneManager.update();
    Common.animator.update();
    Common.queueCalls.update();

    Common.renderer.render(Common.stage);
};

Main.prototype.onCanvasResize = function(correct)
{
    if (correct)
    {
        Common.renderer.resize(p3.View.width, p3.View.height);
        if (Common.sceneManager)
        {
            Common.sceneManager.resize();
        }
    }
};

Main.prototype._shouldForceCanvas = function()
{
    var androidVersion = -1;

    var ua = (ua || navigator.userAgent).toLowerCase(); 
    var match = ua.match(/android\s([0-9\.]*)/);
    if(match) 
    {
        androidVersion = parseFloat(match[1]);
    }
     
    var isAndroid = ( androidVersion >-1 ) ? true : false;
    var lenovoRes = (window.screen.width / window.screen.height == 1024 / 600 ) ;
     
    // Tab 2
    // Mozilla/5.0 (Linux; Android 4.4.2; Lenovo TAB 2 A7-30F Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.84 Safari/537.36
     
    // Tab 3 - from web
    // Mozilla/5.0 (Linux; Android 6.0.1; Lenovo TB-8703F Build/MMB29M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36
     
    // Tab 3 - from Testology
    // Mozilla/5.0 (Linux; Android 5.0.1; Lenovo TB3-710F Build/LRX21M)
     
    return isAndroid && lenovoRes && navigator.userAgent.indexOf('Lenovo') > -1;
}

module.exports = Main;
},{"./Application":1,"./Common":2,"./SavedData":4,"./audio/AudioManager":6,"./common/Emitter":8,"./common/FontLoader":9,"./common/Input":10,"./common/QueueCalls":11,"./screens/PreloaderScreen":25}],4:[function(require,module,exports){

var Common          = require("./Common");

//===================================================
// CONSTRUCTOR
//===================================================

function SavedData()
{
    this.SAVE_NAME = "oz_dressup";
    this.SAVE_VERSION = "0.0.5"; //remember to update this in image.html!
    this.SAVE_SEED = "x5k0Eo6R177mUkb";

    this.allTutorialsViewed = false;
    this.exportedImage = null;

    this.init();
}
module.exports = SavedData;

//===================================================
// PUBLIC METHODS
//===================================================

SavedData.prototype.init = function()
{
    if (!window.localStorage[this.SAVE_NAME + "_" + this.SAVE_VERSION])
    {
        console.log('reset');
        this.reset();
        this.save();
    }
    else
    {
        console.log('load');    
        this.load();
    }

};

SavedData.prototype.reset = function()
{
    this.allTutorialsViewed = false;
    this.exportedImage = null;
};


SavedData.prototype.load = function()
{
    var data = window.localStorage[this.SAVE_NAME + "_" + this.SAVE_VERSION];
    data = JSON.parse(data);

    var json = JSON.stringify(
    {
        allTutorialsViewed: data.allTutorialsViewed,
        exportedImage: data.exportedImage
    });

    var hash = md5(json + this.SAVE_SEED);
    if (hash != data.hash)
    {
        window.localStorage.removeItem(this.SAVE_NAME + "_" + this.SAVE_VERSION);
        location.reload();
    }
    else
    {
        this.allTutorialsViewed = data.allTutorialsViewed;
        this.exportedImage = data.exportedImage; 
    }
};

SavedData.prototype.save = function()
{
    console.log('save');
    var data = {};
    data.allTutorialsViewed = this.allTutorialsViewed;
    data.exportedImage = this.exportedImage;
    
    var json = JSON.stringify(data);
    data.hash = md5(json + this.SAVE_SEED);

    window.localStorage[this.SAVE_NAME + "_" + this.SAVE_VERSION] = JSON.stringify(data);    
};




//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================


//===================================================
},{"./Common":2}],5:[function(require,module,exports){
/**
 *  Audio
 *
 *  Created by Legman on 12/09/2016.
 *
 */

/**
 * @constructor
 */
function Audio() {
    /**
     * @type {number}
     */
    this.id = -1;

    /**
     * @type {Howl}
     */
    this.howl = null;
}
module.exports = Audio;

Audio.prototype.stop = function() {
    this.howl.stop(this.id);
};

},{}],6:[function(require,module,exports){
/**
 *  AudioManager
 *
 *  Created by Legman on 25/02/2016.
 *
 */

var Audio                   = require("./Audio");
var AudioParams             = require("./AudioParams");

function AudioManager() {
    /**
     * @type {object}
     * @private
     */
    this._cache = {};

    /**
     * @type {Howl}
     * @private
     */
    this._music = null;

    /**
     * @type {boolean}
     * @private
     */
    this._isMuted = false;

    var hidden;
    "undefined" != typeof document.hidden ? (hidden = "hidden",
        this.visibilityChange = "visibilitychange")     : "undefined" != typeof document.mozHidden  ? (hidden = "mozHidden",
        this.visibilityChange = "mozvisibilitychange")  : "undefined" != typeof document.msHidden   ? (hidden = "msHidden",
        this.visibilityChange = "msvisibilitychange")   : "undefined" != typeof document.webkitHidden && (hidden = "webkitHidden",
        this.visibilityChange = "webkitvisibilitychange");

    document.addEventListener(this.visibilityChange, function(){
        document[hidden] ? Howler.volume(0) : Howler.volume(1);
    }, false);

}
module.exports = AudioManager;

/**
 * @param {!Array.<string>} sounds
 * @param {!Array.<string>} extensions
 * @param {string=} basePath
 */
AudioManager.prototype.addSounds = function(sounds, extensions, basePath) {
    basePath = basePath || "";

    var howl, name, url, urls, extension, i, j;
    for (i = 0; i < sounds.length; ++ i) {
        url     = basePath + sounds[i];
        url     = url.split("/");
        name    = url[url.length - 1];

        urls = [];
        for (j = 0; j < extensions.length; ++ j) {
            extension = extensions[j];
            urls.push(url.join("/") + extension);
        }
        howl = new Howl({
            src: urls,
            volume: 1.0,
            loop: false,
            autoplay: false
        });
        howl.name = name;
        this._cache[name] = howl;
    }
};

/**
 * @param {!Array.<string>} name
 * @param {!Array.<string>} sprite
 * @param {!Array.<string>} extensions
 * @param {string=} basePath
 */
AudioManager.prototype.addSoundSprite = function(name, sprite, extensions, basePath) {
    basePath = basePath || "";

    var extension;

    var url = basePath + name;
    url = url.split("/");

    var urls = [];
    for (var i = 0; i < extensions.length; ++ i) {
        extension = extensions[i];
        urls.push(url.join("/") + extension);
    }

    var howl = new Howl({
        src: urls,
        sprite: sprite,
        volume: 1,
        loop: false,
        autoplay: false
    });
    for (var key in sprite) {
        if (sprite.hasOwnProperty(key)) {
            this._cache[key] = howl;
        }
    }
};

/**
 * @param {!Array.<string>} sounds
 */
AudioManager.prototype.removeSounds = function(sounds) {
    var name, n, howl;
    for (var i = 0; i < sounds.length; ++ i) {
        name = sounds[i];
        for (n in this._cache) {
            if (this._cache.hasOwnProperty(key)) {
                howl = this._cache[key];
                if (howl.name == n) {
                    howl.unload();
                    delete this._cache[name];
                    break;
                }
            }
        }
    }
};

/**
 * @param {!string | Array.<string>} name
 * @param {AudioParams=} params
 * @returns {Audio}
 */
AudioManager.prototype.playSound = function(name, params) {

    params = params || new AudioParams();

    var id = -1;

    if (typeof name !== "string") {
        name = name[Math.floor(Math.random() * name.length)];
    }

    var howl = this._cache[name];
    if (!howl) {
        console.warn("Could not find sound - " + name);
        return id;
    }

    id = howl.play();//howl._sprite ? name : 0);
    howl.volume(params.volume, id);
    howl.loop(params.loop, id);

    var audio = new Audio();
    audio.id = id;
    audio.howl = howl;
    return audio;
};

/**
 * @param {!string | Array.<string>} name
 * @param {AudioParams=} params
 * @returns {Audio}
 */
AudioManager.prototype.playMusic = function(name, params) {
    params = params || new AudioParams();

    var id = -1;

    if (typeof name !== "string") {
        name = name[Math.floor(Math.random() * name.length)];
    }

    // skip if no change
    if (this._music && this._music.howl.name == name) {
        return this._music;
    }

    var howl = this._cache[name];
    if (!howl) {
        console.warn("Could not find music - " + name);
        return null;
    }

    // callback
    howl.__onend = function() {
        params.callback && params.callback.call(params.scope);
    };
    howl.on("end", howl.__onend);

    if (p3.Device && p3.Device.isAndroidStockBrowser) {
        howl.buffer = true;
    }

    id = howl.play();
    howl.volume(params.volume, id);
    howl.loop(true, id);

    var audio = new Audio();
    audio.id = id;
    audio.howl = howl;

    if (params.fadeIn > 0.0) {
        if (this._music) {
            this.fadeOut(this._music, params.fadeIn);
        }
        this.fadeIn(audio, params.fadeIn);
    }

    this._music = audio;
    return audio;
};

/**
 * @param {!string} name
 * @param {number=} id
 * @deprecated
 */
AudioManager.prototype.stopSound = function(name, id) {
    var howl = this._cache[name];
    !howl && console.warn("Could not find sound - " + name);
    howl.stop(id);

    console.warn("'AudioManager.stopSound()' is deprecated. Use 'Audio.stop()' instead.")
};

AudioManager.prototype.stopMusic = function() {
    if (this._music) {
        this._music.howl.__onend && this._music.howl.off("end", this._music.howl.__onend);
        this._music.howl.stop();
        this._music = null;
    }
};

/**
 * @param {!boolean} value
 */
AudioManager.prototype.mute = function(value) {
    this._isMuted = value;
    if (this._isMuted) {
        Howler.mute(true);
    } else {
        Howler.mute(false);
    }
};

/**
 * @param {!Audio} audio
 * @param {number=} duration
 * @param {function=} callback
 * @param {*=} scope
 */
AudioManager.prototype.fadeIn = function(audio, duration, callback, scope) {
    duration = duration || 1.0;

    var volume = audio.howl.volume(audio.id);
    audio.howl.volume(0.0, audio.id);
    audio.__volume = 0.0;

    TweenMax.killTweensOf(audio);
    TweenMax.to(audio, duration, {
        __volume: volume,
        ease: Power1.easeInOut,
        onUpdate: function() {
            audio.howl.volume(audio.__volume, audio.id);
        },
        onUpdateScope: this,
        onComplete: callback,
        onCompleteParams: [audio],
        onCompleteScope: scope
    });
};

/**
 * @param {!Audio} audio
 * @param {number=} duration
 * @param {function=} callback
 * @param {*=} scope
 */
AudioManager.prototype.fadeOut = function(audio, duration, callback, scope) {
    duration = duration || 1.0;

    audio.__volume = audio.howl.volume(audio.id);

    TweenMax.killTweensOf(audio);
    TweenMax.to(audio, duration, {
        __volume: 0.0,
        ease: Power1.easeInOut,
        onUpdate: function() {
            audio.howl.volume(audio.__volume, audio.id);
        },
        onUpdateScope: this,
        onComplete: callback,
        onCompleteParams: [audio],
        onCompleteScope: scope
    });
};

/**
 * @param {!Audio} audio
 * @param {!*} object
 * @param {!Camera} camera
 * @param {number=} min
 * @param {number=} max
 */
AudioManager.prototype.setAudioPos3D = function(audio, object, camera, min, max) {
    if (p3.Device.isMobile || !p3.Device.bowser["chrome"]) return;

    min = min || 0.0;
    max = max || 320.0;

    var layer = camera.findLayerForObject(object);
    var x = object.x * (1.0 / layer.parallax.x);
    var sign = (x - camera.position.x);
    sign = sign / Math.abs(sign);

    if (sign == -1) x = Math.min(0.0, ((x + min) - camera.position.x) / (max - min));
    else if (sign == 1) x = Math.max(0.0, ((x - min) - camera.position.x) / (max - min));

    audio.howl.pos(x, 0.0, 0.0, audio.id);
};

/**
 * @param {Audio} audio
 * @param {*} object
 * @param {Camera} camera
 * @param {!number} [min]
 * @param {!number} [max]
 * @param {!number} [offset]
 * @param {boolean} [fallback]
 */
AudioManager.prototype.setAudioPosStereo = function(audio, object, camera, min, max, offset, fallback) {
    if (p3.Device.isMobile || !p3.Device.bowser["chrome"]) {
        fallback = true;
    }

    min = min || 0.0;
    max = max || 320.0;
    offset = offset || 0;

    var layer = camera.findLayerForObject(object);
    var x = (object.x + offset) * (1.0 / layer.parallax.x);
    var sign = (x - camera.position.x);
    sign = sign / Math.abs(sign);

    x = Math.max(0.0, Math.abs((x - min) - camera.position.x) / (max));
    x = Math.max(0.0, Math.min(1.0, 1.0 + (1.0 - x)));

    audio.howl.volume(x, audio.id);

    if (fallback) return;

    x = (object.x + offset) * (1.0 / layer.parallax.x);

    if (sign == -1) x = Math.min(0.0, ((x + min) - camera.position.x) / (max - min));
    else if (sign == 1) x = Math.max(0.0, ((x - min) - camera.position.x) / (max - min));

    x = Math.max(-1.0, Math.min(1.0, x));
    audio.howl.stereo(x, audio.id);
};

Object.defineProperty(AudioManager.prototype, "isMute", {
    /**
     * @returns {!boolean}
     */
    get: function() {
        return this._isMuted;
    }
});

},{"./Audio":5,"./AudioParams":7}],7:[function(require,module,exports){
/**
 *  AudioParams
 *
 *  Created by Legman on 25/02/2016.
 *
 */

/**
 * @constructor
 */
function AudioParams() {
    /**
     * @type {number}
     */
    this.volume = 1.0;

    /**
     * @type {boolean}
     */
    this.loop = false;

    /**
     * @type {number}
     */
    this.delay = 0.0;

    /**
     * @type {number}
     */
    this.fadeIn = 0.0;

    /**
     * @type {number}
     */
    this.priority = 0;

    /**
     * @type {function}
     */
    this.callback = null;

    /**
     * @type {*}
     */
    this.scope = window;
}
module.exports = AudioParams;

},{}],8:[function(require,module,exports){

var Common          = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function Emitter() {
}
module.exports = Emitter;

//===================================================
// PUBLIC METHODS
//===================================================


/**
 * @param {!PIXI.Container} parent
 * @param {!Array<String>} textures
 * @param {!String} json
 * @param {Number=} x
 * @param {Number=} y
 * @param {Number=} removeTime
 * @param {Boolean=} autoEmit
 * @returns {cloudkid.Emitter} emitter
 */
Emitter.add = function(parent, textures, json, x, y, removeTime, autoEmit, destroyTime)
{
    if(autoEmit == undefined) autoEmit = true;
    if(destroyTime == undefined) destroyTime = 1;

    x = x || 0;
    y = y || 0;

    var assetManager = p3.AssetManager.instance;

    for(var i = 0; i < textures.length; i++)
    {
        textures[i] = assetManager.getTexture(textures[i]);
    }    

    var emitter = new PIXI.particles.Emitter(
        parent,
        textures,
        assetManager.getJSON(json)
    );
    if(autoEmit)
        emitter.emit = true;
    else
        emitter.emit = false;

    emitter.updateOwnerPos(x, y);

    Common.animator.add(emitter);

    if(removeTime != null)
    {    
        Common.animator.setTimeout(function(){
            Emitter.destroy(emitter, destroyTime);
        }, removeTime, this);
    }

    return emitter;
};

Emitter.destroy = function(emitter, destroyDelay)
{
    if(emitter != null)
    {    
        destroyDelay = destroyDelay || 0;

        emitter.emit = false;
        Common.animator.setTimeout(function(){
            try{
                Common.animator.remove(emitter);
                emitter.destroy();
            }catch(e){
                //console.log('could not destroy emitter');
            }
        }, destroyDelay, this);
    }
}




//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================
},{"../Common":2}],9:[function(require,module,exports){
var Common                  = require("../Common");

function FontLoader(font)
{
    this._font = font;
    this._hiddenText = null;

    this.hasLoaded = false;

	PIXI.Container.call(this);

    this.signals = {};
    this.signals.loaded = new signals.Signal();
}
module.exports = FontLoader;
FontLoader.prototype = Object.create(PIXI.Container.prototype);
FontLoader.prototype.constructor = FontLoader;


//===================================================
// PUBLIC METHODS
//===================================================

FontLoader.prototype.init = function()
{
    this._hiddenText = new PIXI.Text('LOADING', {
            font:"60px " + this._font
        });
    this.addChild(this._hiddenText);

    Common.animator.setTimeout(this.checkLoaded, .5, this);
};

FontLoader.prototype.destroy = function()
{

};

FontLoader.prototype.update = function()
{
	
};

FontLoader.prototype.checkLoaded = function()
{
    var text = new PIXI.Text('LOADING', {
            font:"60px " + this._font
        });
    if(text.width != this._hiddenText.width || text.height != this._hiddenText.height)
    {
        this.hasLoaded = true;
        this.signals.loaded.dispatch();
    }
    else
    {
        Common.animator.setTimeout(this.checkLoaded, .5, this);
    }
}



//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================


//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2}],10:[function(require,module,exports){

var Common          = require("../Common");

/**
 *  Input
 *
 *  Created by Legman on 8/10/2015.
 *
 */

"use strict";

/**
 * @constructor
 */
function Input() {
    /**
     * @type {boolean}
     */
    this.isKeyUp = false;

    /**
     * @type {boolean}
     */
    this.isKeyLeft = false;

    /**
     * @type {boolean}
     */
    this.isKeyRight = false;

    /**
     * @type {boolean}
     */
    this.isKeyDown = false;

    /**
     * @type {boolean}
     */
    this.isKeyFire = false;

    /**
     * @type {boolean}
     */
    this.isKeyAltFire = false;

    /**
     * @type {PIXI.Point}
     */
    this.touch = new PIXI.Point();

    /**
     * @type {boolean}
     */
    this.isTouch = false;

    /**
     * @type {*}
     */
    this.signals                = {};
    this.signals.mouseMove      = new signals.Signal();
    this.signals.mouseDown      = new signals.Signal();
    this.signals.mouseUp        = new signals.Signal();
    this.signals.mouseOut       = new signals.Signal();
    this.signals.mouseClick     = new signals.Signal();

    this.signals.keyDown        = new signals.Signal();
    this.signals.keyUp          = new signals.Signal();

    /**
     * @type {null}
     * @private
     */
    this._stage = null;
}
module.exports = Input;

/**
 * @type {*}
 */
Input.keys = {};

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.W = 87;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.A = 65;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.S = 83;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.D = 68;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.Z = 90;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.X = 88;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.C = 67;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.SPACE = 32;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.LEFT = 37;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.RIGHT = 39;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.UP = 38;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.DOWN = 40;

/**
 * @type {number}
 * @static
 * @const
 */
Input.keys.ENTER = 13;

/**
 * @param {!PIXI.DisplayObject} stage
 * @param {!*} keyListener
 */
Input.prototype.init = function(stage, keyListener) {
    this._stage                 = stage;
    this._stage.interactive     = true;
    this._stage.mousemove       = this._stage.touchmove     = this.onMouseMove.bind(this);
    this._stage.mousedown       = this._stage.touchstart    = this.onMouseDown.bind(this);
    this._stage.mouseup         = this._stage.touchend      = this.onMouseUp.bind(this);
    this._stage.mouseout                                    = this.onMouseOut.bind(this);
    this._stage.click           = this._stage.tap           = this.onMouseClick.bind(this);

    keyListener.onkeydown       = this.onKeyDown.bind(this);
    keyListener.onkeyup         = this.onKeyUp.bind(this);
    keyListener.focus();
};

Input.prototype.dispose = function() {
    this._stage.mousemove   = this._stage.touchmove     = null;
    this._stage.mousedown   = this._stage.touchstart    = null;
    this._stage.mouseup     = this._stage.touchend      = null;
    this._stage.mouseout                                = null;
    this._stage.click       = this._stage.tap           = null;

    this.signals.mouseMove.dispose();
    this.signals.mouseDown.dispose();
    this.signals.mouseUp.dispose();
    this.signals.mouseOut.dispose();
    this.signals.mouseClick.dispose();

    this.signals.keyDown.dispose();
    this.signals.keyUp.dispose();
};

/**
 * @param {!Event} event
 */
Input.prototype.onMouseMove = function(event) {
    this.touch = event.data.getLocalPosition(this._stage);

    Common.queueCalls.add(function() {
        this.signals.mouseMove.dispatch(event);
    }, [], this);
};

/**
 * @param {!Event} event
 */
Input.prototype.onMouseDown = function(event) {
    this.touch = event.data.getLocalPosition(this._stage);
    this.isTouch = true;

    Common.queueCalls.add(function() {
        this.signals.mouseDown.dispatch(event);
    }, [], this);
};

/**
 * @param {!Event} event
 */
Input.prototype.onMouseUp = function(event) {
    this.touch = event.data.getLocalPosition(this._stage);
    this.isTouch = false;

    Common.queueCalls.add(function() {
        this.signals.mouseUp.dispatch(event);
    }, [], this);
};

/**
 * @param {!Event} event
 */
Input.prototype.onMouseOut = function(event) {
    this.touch = event.data.getLocalPosition(this._stage);
    this.isTouch = false;

    Common.queueCalls.add(function() {
        this.signals.mouseOut.dispatch(event);
    }, [], this);
};

/**
 * @param {!Event} event
 */
Input.prototype.onMouseClick = function(event)
{
    Common.queueCalls.add(function() {
        this.signals.mouseClick.dispatch(event);
    }, [], this);
};

/**
 * @param {!Event} event
 */
Input.prototype.onKeyDown = function(event) {
    switch (event.keyCode) {
        case Input.keys.UP :
        case Input.keys.W : {
            this.isKeyUp = true;
            break;
        }
        case Input.keys.LEFT :
        case Input.keys.A : {
            this.isKeyLeft = true;
            break;
        }
        case Input.keys.RIGHT :
        case Input.keys.D : {
            this.isKeyRight = true;
            break;
        }
        case Input.keys.DOWN :
        case Input.keys.S : {
            this.isKeyDown = true;
            break;
        }
        case Input.keys.Z :
        case Input.keys.SPACE : {
            this.isKeyFire = true;
            break;
        }
        case Input.keys.X : {
            this.isKeyAltFire = true;
            break;
        }
    }

    Common.queueCalls.add(function() {
        this.signals.keyDown.dispatch(event);
    }, [], this);
};

/**
 * @param {!Event} event
 */
Input.prototype.onKeyUp = function(event) {
    switch (event.keyCode) {
        case Input.keys.UP :
        case Input.keys.W : {
            this.isKeyUp = false;
            break;
        }
        case Input.keys.LEFT :
        case Input.keys.A : {
            this.isKeyLeft = false;
            break;
        }
        case Input.keys.RIGHT :
        case Input.keys.D : {
            this.isKeyRight = false;
            break;
        }
        case Input.keys.DOWN :
        case Input.keys.S : {
            this.isKeyDown = false;
            break;
        }
        case Input.keys.Z :
        case Input.keys.SPACE : {
            this.isKeyFire = false;
            break;
        }
        case Input.keys.X : {
            this.isKeyAltFire = false;
            break;
        }
    }

    Common.queueCalls.add(function() {
        this.signals.keyUp.dispatch(event);
    }, [], this);
};

},{"../Common":2}],11:[function(require,module,exports){
var Common = require("../Common");

function QueueCalls()
{
	this._calls = null;
    this.init();
}
QueueCalls.prototype = Object.create(PIXI.Container.prototype);
QueueCalls.prototype.constructor = QueueCalls;
module.exports = QueueCalls;

//===================================================
// PUBLIC METHODS
//===================================================

QueueCalls.prototype.init = function()
{
    this._calls = [];
};

QueueCalls.prototype.update = function()
{
	while(this._calls.length > 0)
	{
		this._calls[0].callback.apply(this._calls[0].scope, this._calls[0].params);
		this._calls.splice(0, 1);
	}
};

QueueCalls.prototype.add = function(callback, params, scope)
{
	this._calls.push({callback:callback, params:params, scope:scope});
};

//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2}],12:[function(require,module,exports){
var Common = require("../Common");

function AnimatedCharacter()
{
	this._spine = null;
	this._spineData = null;
	this._jsonData = null;

	this._slots = {};
	this._attachments = {};

    this._animationTime = 0;

    this.currentAnimation = 'idle1';

    this.currentOutfit = {};

    this.completeAnimations = {
        dorothy:    {animation:true,    music:true,     sfx:false,  animationName:'costume_dorothy',    animationTime:1},
        lion:       {animation:true,    music:true,     sfx:false,  animationName:'costume_lion',       animationTime:3},
        nome_king:  {animation:true,    music:false,    sfx:true,   animationName:'costume_nomeking',   animationTime:3},
        queen:      {animation:false,   music:false,    sfx:true},
        scarecrow:  {animation:true,    music:true,     sfx:true,   animationName:'costume_scarecrow',  animationTime:3},
        tinman:     {animation:true,    music:true,     sfx:true,   animationName:'costume_tinman',     animationTime:3},
        witch:      {animation:false,   music:true,     sfx:true}
    };

    this.photoMode = false;

	PIXI.Container.call(this);

    this.init();
}
module.exports = AnimatedCharacter;
AnimatedCharacter.prototype = Object.create(PIXI.Container.prototype);
AnimatedCharacter.prototype.constructor = AnimatedCharacter;


//===================================================
// PUBLIC METHODS
//===================================================

AnimatedCharacter.prototype.init = function()
{
    this._spine = new PIXI.spine.Spine(Common.assets.getSpineData("dorothy_anim"));
    this._spineData = Common.assets.getSpineData("dorothy_anim");
    //this._spine.skeleton.setToSetupPose();
    this._spine.skeleton.setSkin(null);
    this._spine.scale.set(0.5);
    this._spine.autoUpdate = false;
    this.addChild(this._spine);

    this._spine.state.addListener({
        complete: this.onAnimationComplete.bind(this)
    });

    var idles = ['idle1', 'idle2', 'idle3', 'idle4', 'idle5', 'idle6'];
    var clicks = ['clickhat', 'clickshoes', 'clickskirt', 'clicktop', 'jumpcentre', 
                  'photopose1', 'photopose2', 'photopose3', 'photopose4',
                  'costume_nomeking', 'costume_scarecrow', 'costume_tinman', 'costume_lion', 'costume_dorothy'];

    for(var i in idles)
    {
        for(var j in clicks)
        {
            this._spine.stateData.setMix(idles[i], clicks[j], 0.2);
        }
    }

    for(var i in clicks)
    {
        for(var j in clicks)
        {
            this._spine.stateData.setMix(clicks[i], clicks[j], 0.3);
        }
    }

    this._spine.hitArea = new PIXI.Rectangle(0, 0, 0, 0);
    this._spine.interactive = false;

    this._determineOptions();

    this.resetClothes();

    this._spine.state.setAnimation(0, this.currentAnimation, true);
};

AnimatedCharacter.prototype.destroy = function()
{
    
};

AnimatedCharacter.prototype.update = function()
{
	this._spine.update(Common.delta);
    this._animationTime += Common.delta;
};

AnimatedCharacter.prototype.setAnimation = function(animation, repeat)
{
    this._spine.state.setAnimation(0, animation, repeat || false);
    this.currentAnimation = animation;
    this._animationTime = 0;
};

AnimatedCharacter.prototype.setAttachmentForSlot = function(slotName, attachmentName)
{
	this._slots[slotName].setAttachment(this._attachments[attachmentName]);
};

AnimatedCharacter.prototype.removeAttachmentFromSlot = function(slotName)
{
    this._slots[slotName].setAttachment(null);
};

AnimatedCharacter.prototype.resetClothes = function()
{
    for(var i in Common.config.clothes)
    {
        this.resetBase(Common.config.clothes[i].base_slots);
        for(var j in Common.config.clothes[i].items)
        {
            var item = Common.config.clothes[i].items[j];
            if(item.default)
            {
                this.currentOutfit[i] = item.id;
                for(var k in item.slots_to_clear)
                {
                    this.removeAttachmentFromSlot(item.slots_to_clear[k]);
                }
                for(k in item.attachments)
                {
                    this.setAttachmentForSlot(item.attachments[k].slot, item.attachments[k].attachment);
                }
            }
        }
    }
};

AnimatedCharacter.prototype.resetBase = function(baseSlots)
{
    for(var i in baseSlots)
    {
        this.removeAttachmentFromSlot(baseSlots[i].base_slot);
        this.setAttachmentForSlot(baseSlots[i].base_slot, baseSlots[i].base_attachment);
    }
}

AnimatedCharacter.prototype.intro = function()
{
    this._spine.x = 500;
    this.setAnimation('enterstage'); 
    Common.animator.add(TweenMax.to(this._spine, 1, {x:0, ease:Power1.easeOut}));
    Common.audio.playSound('sfx_dorothy_skid_in_00');
}

AnimatedCharacter.prototype.changeClothesEffect = function(type)
{
    if(!Common.lowPerformance)
    {
        var pos = {footwear:0, lower_body:-100, upper_body:-300, headwear:-500};
        var colours = ['blue', 'green', 'orange', 'pink', 'yellow'];

        var i = Math.floor(colours.length * Math.random());
        var colour1 = colours[i];
        colours.splice(i, 1);
        var colour2 = colours[Math.floor(colours.length * Math.random())];

        Common.emitter.add(this, 
            ['particle_star_00', 'particle_star_01'],
            "particle_emitter_starburst_" + colour1 + "_00", 0, pos[type], 3);
        Common.emitter.add(this, 
            ['particle_star_00', 'particle_star_01'],
            "particle_emitter_starburst_" + colour2 + "_00", 0, pos[type], 3);
    }

    Common.audio.playSound('sfx_magic_sparkles_00');
}

AnimatedCharacter.prototype.hasCompleteOutfit = function(str)
{
    var allSame = true
    for(var j in this.currentOutfit)
    {
        if(this.currentOutfit[j].indexOf(str) == -1)
        {
            allSame = false;
        }
    }
    return allSame;
}

//===================================================
// PRIVATE METHODS
//===================================================

AnimatedCharacter.prototype._determineOptions = function()
{
	for(var i in this._spineData.defaultSkin.attachments)
    {
    	for(var j in this._spineData.defaultSkin.attachments[i])
    	{
    		this._attachments[j] = this._spineData.defaultSkin.attachments[i][j];
    	}
    }

    for(var i in this._spine.skeleton.slots)
    {
    	this._slots[this._spine.skeleton.slots[i].data.name] = this._spine.skeleton.slots[i];
    }

    p3.log(this._slots);
    p3.log(this._attachments);
}

//===================================================
// EVENTS
//===================================================

AnimatedCharacter.prototype.onAnimationComplete = function(entry)
{
    if(this.currentAnimation.indexOf('photopose') > -1) return;

    for(var i in this.completeAnimations)
    {
        if(this.completeAnimations[i].animation &&
           this.currentAnimation == this.completeAnimations[i].animationName && 
           this._animationTime < this.completeAnimations[i].animationTime)
        {
            p3.log('DENIED');
            return;
        }
    }


    var rand = Math.floor(Math.random() * 100);
    var anim;

    var stances = [];

    if(this.photoMode)
    {
        for(var i in this.completeAnimations)
        {
            if(this.completeAnimations[i].animation && this.hasCompleteOutfit(i))
            {
                stances.push(this.completeAnimations[i].animationName);
            }
        }
        if(stances.length > 0)
        {
            stances.push('idle' + String(1 + Math.floor(Math.random() * 6)));
        }
    }
    if(stances.length == 0)
    {
        if(rand < 20) anim = 'idle1';
        else if(rand < 30) anim = 'idle2';
        else if(rand < 45) anim = 'idle3';
        else if(rand < 60) anim = 'idle4';
        else if(rand < 80) anim = 'idle5';
        else anim = 'idle6';
    }
    else
    {
        var split = 100 / stances.length;
        anim = stances[stances.length-1];

        for(var i in stances)
        {
            if(rand < split * (i+1))
            {
                anim = stances[i];
                break;
            }
        }
    }

    this.setAnimation(anim);
}

//===================================================
// GETTERS/SETTERS
//===================================================

Object.defineProperty(AnimatedCharacter.prototype, "isIdle",
{
    get: function()
    {
        return this.currentAnimation.indexOf('idle') > -1;
    }
});

//===================================================

},{"../Common":2}],13:[function(require,module,exports){
var Common                  = require("../Common");

function Butterfly()
{
    var colours = ['blue', 'green', 'red', 'yellow'];

    this._colour = colours[Math.floor(Math.random() * colours.length)];
    this._type = 'side';//Math.random() > 0.5 ? 'side' : 'front';

    this._changeFrame = 6 + Math.floor(Math.random() * 6);
    this._currentFrame = 1;

    this._upperPosLimit = -100;
    this._lowerPosLimit = Common.STAGE_HEIGHT - 200;

    this._sprite = null;
    this._tween = null;

	PIXI.Container.call(this);

    this.init();
}
module.exports = Butterfly;
Butterfly.prototype = Object.create(PIXI.Container.prototype);
Butterfly.prototype.constructor = Butterfly;


//===================================================
// PUBLIC METHODS
//===================================================

Butterfly.prototype.init = function()
{
    this._sprite = new PIXI.Sprite(Common.assets.getTexture('butterfly_' + this._type + '_001_' + this._colour));
    this._sprite.anchor = new PIXI.Point(0.5, 0.5);
    this.addChild(this._sprite);

    //if(this._type == 'front')
    //    this._sprite.rotation = (-70 + (Math.random() * 70)) * PIXI.DEG_TO_RAD;

    this.x = Common.STAGE_WIDTH * Math.random();
    this.y = this._upperPosLimit + ((this._lowerPosLimit - this._upperPosLimit) * Math.random());
};

Butterfly.prototype.destroy = function()
{

};

Butterfly.prototype.update = function()
{
	if(Common.frameCount % this._changeFrame == 0)
    {
        this._currentFrame = this._currentFrame == 1 ? 2 : 1;
        this._sprite.texture = Common.assets.getTexture('butterfly_' + this._type + '_00' + this._currentFrame + '_' + this._colour);
    }

    if(!TweenMax.isTweening(this))
    {
        var lowerLimit = Math.min(this._lowerPosLimit, this.y + 200);
        var upperLimit = Math.max(this._upperPosLimit, this.y - 200);
        var midY = upperLimit + ((lowerLimit - upperLimit) * Math.random());
        var endX = 300 + (400 * Math.random());

        var speed = (5 + (Math.random() * 4)) * (endX / 700);

        var reverse = false;
        if((this.x > Common.STAGE_WIDTH || Math.random() > 0.5) && this.x > 0)
        {
            endX = endX * -1;
            this._type == 'side' && (this.scale.x = -1);
        }
        else
        {
            this._type == 'side' && (this.scale.x = 1);
        }
        endX += this.x;

        var endY;
        if(midY < this.y)
        {
            endY = midY + ((midY - upperLimit) * Math.random());
        }
        else
        {
            endY = upperLimit + ((midY - upperLimit) * Math.random());
        }
        var midX = this.x + ((endX - this.x)/2); 

        Common.animator.add(TweenMax.to(this, speed, {bezier:{autoRotate:this._type == 'front', values:[{x:midX, y:midY}, {x:endX, y:endY}]}, ease:Linear.easeNone}));
    }
};



//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================


//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2}],14:[function(require,module,exports){
var Common = require("../Common");

function ClothesCategoryButton(id, selected, deselected)
{
    this.id = id;
    this._selected = selected;
    this._deselected = deselected;

    this._graphic = null;

    this.selected = false;

    this.signals = {};
    this.signals.clicked = new signals.Signal();

	PIXI.Container.call(this);

    this.init();
}
module.exports = ClothesCategoryButton;
ClothesCategoryButton.prototype = Object.create(PIXI.Container.prototype);
ClothesCategoryButton.prototype.constructor = ClothesCategoryButton;


//===================================================
// PUBLIC METHODS
//===================================================

ClothesCategoryButton.prototype.init = function()
{   
    this._graphic = new PIXI.Sprite(Common.assets.getTexture(this._deselected));
    this._graphic.hitArea = new PIXI.Rectangle(this._graphic._texture.trim.x, this._graphic._texture.trim.y, this._graphic._texture.trim.width, this._graphic._texture.trim.height);
    this.addChild(this._graphic);

    this.interactive = true;
    this.buttonMode = true;
    this.mousedown = this.touchstart = this.onMouseUp.bind(this);
};

ClothesCategoryButton.prototype.select = function()
{
    this.selected = true;
    this._graphic.texture = Common.assets.getTexture(this._selected);
};

ClothesCategoryButton.prototype.deselect = function()
{
    this.selected = false;
    this._graphic.texture = Common.assets.getTexture(this._deselected);
};


//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

ClothesCategoryButton.prototype.onMouseUp = function()
{
    this.signals.clicked.dispatch(this.id);
}

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2}],15:[function(require,module,exports){
var Common = require("../Common");

function ClothesItemButton(texture, id, clearSlots, addSlots)
{
    var states = new p3.ButtonStates(
        Common.assets.getTexture('cell'), null, null, texture);

	p3.Button.call(this, states);

	this.id = id;
	this.defaultIconScale = new PIXI.Point(1, 1);
	this.clearSlots = clearSlots;
	this.addSlots = addSlots;

    this.init();
}
module.exports = ClothesItemButton;
ClothesItemButton.prototype = Object.create(p3.Button.prototype);
ClothesItemButton.prototype.constructor = ClothesItemButton;


//===================================================
// PUBLIC METHODS
//===================================================

ClothesItemButton.prototype.init = function()
{   
    this.animate = false;
    this.animateIcon = false;

    var ws = this._background.width / this._icon.width;
    var hs = this._background.height / this._icon.height;
    this._icon.scale.x = this._icon.scale.y = ws<hs?ws:hs;
    this.defaultIconScale.x = this._icon.scale.x;
    this.defaultIconScale.y = this._icon.scale.y;
};


//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

ClothesItemButton.prototype.onMouseOver = function()
{
	if(TweenMax.isTweening(this._icon))
		return null;

	var tl = new TimelineMax();
	tl.to(this._icon.scale, .15, {x:this.defaultIconScale.x * 1.1, 
								 y:this.defaultIconScale.y * 1.1,
								 ease:Sine.easeInOut});
	tl.to(this._icon.scale, 1, {x:this.defaultIconScale.x,
								y:this.defaultIconScale.y,
								 ease:Elastic.easeOut});
	Common.animator.add(tl);
}

ClothesItemButton.prototype.onMouseOut = function()
{

}

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2}],16:[function(require,module,exports){
var Common                  = require("../Common");
var ClothesCatgeoryButton   = require("./ClothesCategoryButton");
var ClothesItemButton       = require("./ClothesItemButton");
var ScrollBar               = require("./ScrollBar");
var TutorialFinger          = require("./TutorialFinger");

function ClothesMenu()
{
    this._categoryButtons = [];

    this._backing = null;

    this._itemHolder = null;
    this._itemHolderScroll = null;
    this._itemHolderMask = null;
    this._itemHolderScrollWindowSize = 500;

    this._categoryButtonHolder = null;
    this._categoryButtonSelectedHolder = null;
    this._frame = null;

    this._items = [];

    this._touchScrollRect = null;
    this._touchScrollCurrent = null;
    this._touchScrollLast = null;
    this._touchScrollMomentum = 0;

    this.tutorialFinger = null;
    this.promptFinger = null;

    this.currentCategory = null;

    this.signals = {};
    this.signals.itemSelected = new signals.Signal();
    this.signals.tutorialCompleted = new signals.Signal();

	PIXI.Container.call(this);
}
module.exports = ClothesMenu;
ClothesMenu.prototype = Object.create(PIXI.Container.prototype);
ClothesMenu.prototype.constructor = ClothesMenu;


//===================================================
// PUBLIC METHODS
//===================================================

ClothesMenu.prototype.init = function()
{
    this._backing = new PIXI.Sprite(Common.assets.getTexture('panel'));

    this._scrollBar = new ScrollBar(400, -15);
    this._scrollBar.y = 0;
    //this._scrollBar.scale.x = -1;
    this._scrollBar.x = 0;//560;
    this._scrollBar.init();
    this.addChild(this._scrollBar);

    this._scrollBar.forcePosition(400);

    this.addChild(this._backing);

    this._itemHolder = new PIXI.Container();
    this._itemHolder.x = 120;
    this._itemHolder.y = 180;
    this.addChild(this._itemHolder);

    this._itemHolderScroll = new PIXI.Container();
    this._itemHolder.addChild(this._itemHolderScroll);

    this._itemHolderMask = new PIXI.Graphics();
    this._itemHolderMask.beginFill(0x000000);
    this._itemHolderMask.moveTo(4, 70);
    this._itemHolderMask.lineTo(561, 76);
    this._itemHolderMask.lineTo(538, 652);
    this._itemHolderMask.lineTo(30, 656);
    this.addChild(this._itemHolderMask);
    this._itemHolder.mask = this._itemHolderMask;

    this._categoryButtonHolder = new PIXI.Container();
    this.addChild(this._categoryButtonHolder);

    this._frame = new PIXI.Sprite(Common.assets.getTexture('panel_frame'));
    this.addChild(this._frame);

    this._categoryButtonSelectedHolder = new PIXI.Container();
    this.addChild(this._categoryButtonSelectedHolder);

    var count = 0;
    for(var i in Common.config.clothes)
    {
        var button = new ClothesCatgeoryButton(i, Common.config.clothes[i].icon_selected, Common.config.clothes[i].icon_deselected);
        this._categoryButtonHolder.addChild(button);
        this._categoryButtons.push(button);
        button.signals.clicked.add(this.onCategoryButtonClicked, this);
        count++;
    }

    this.setCategory(i);

    this._touchScrollRect = new PIXI.Rectangle(50, 90, 470, 550);
    /*var gr = new PIXI.Graphics();
    gr.lineStyle(1, 0xFFFFFF);
    gr.drawShape(this._touchScrollRect);
    this.addChild(gr);*/

    Common.input.signals.mouseDown.add(this.onTouchStart, this);
    Common.input.signals.mouseUp.add(this.onTouchEnd, this);
    Common.input.signals.mouseMove.add(this.onTouchMove, this);

    document.addEventListener("wheel", function(e)
    {
        this._scrollBar.setTargetY(this._scrollBar.y + (100 * Math.sign(e.deltaY)), false);
    }.bind(this));
};

ClothesMenu.prototype.destroy = function()
{
    Common.input.signals.mouseDown.remove(this.onTouchStart);
    Common.input.signals.mouseUp.remove(this.onTouchEnd);
    Common.input.signals.mouseMove.remove(this.onTouchMove);
    this._scrollBar.dispose();
};

ClothesMenu.prototype.update = function()
{
	var percent = this._scrollBar.update();

    this._itemHolderScroll.y = -(this._itemHolder.height - this._itemHolderScrollWindowSize) * percent;

    if(this._itemHolder.height > this._itemHolderScrollWindowSize)
    {
        this._scrollBar.activate();

        if(!this._scrollBar.dragging)
        {
            if(this._touchScrollCurrent != null)
            {
                this._touchScrollMomentum = (this._touchScrollLast - this._touchScrollCurrent) * 5;
                this._touchScrollLast = this._touchScrollCurrent;
            }
            else
            {
                this._touchScrollMomentum = this._touchScrollMomentum * 0.8;
            }

            if(this._touchScrollMomentum != 0)
            {
                var result = this._scrollBar.setTargetY(this._scrollBar.y + this._touchScrollMomentum, false);
            }

            if(Math.abs(this._touchScrollMomentum) > 10)
            {
                this._tutorialActionPerformed('scroll');
            }

            if(Math.round(this._touchScrollMomentum) == 0)
            {
                this._touchScrollMomentum = 0;
            }
        }
        else
        {
            this._touchScrollMomentum = 0;
        }
    }
    else
    {
        this._scrollBar.deactivate();
    }
};

ClothesMenu.prototype.setCategory = function(id)
{
    for(var i in this._categoryButtons)
    {
        if(this._categoryButtons[i].id == id)
        {
            this._categoryButtons[i].select();
            this._categoryButtonSelectedHolder.addChild(this._categoryButtons[i]);
        }
        else
        {
            this._categoryButtons[i].deselect();
            this._categoryButtonHolder.addChild(this._categoryButtons[i]);
        }
    }

    this.fillMenu(id);
    this._scrollBar.reset();

    this.currentCategory = id;
};

ClothesMenu.prototype.fillMenu = function(id)
{
    while(this._items.length > 0)
    {
        this._itemHolderScroll.removeChild(this._items[0]);
        this._items[0].signals.down.remove(this.onItemButtonClicked);
        this._items.splice(0, 1);
    }

    var json = Common.config.clothes[id].items;

    var row = 0;
    var col = 0;
    var colLimit = 3;
    var rowPadding = 15;
    var colPadding = 15;

    for(var i in json)
    {
        var texture = PIXI.EmptyTexture;

        if(json[i].icon != null)
        {
            texture = Common.assets.getTexture(json[i].icon);
        }

        var item = new ClothesItemButton(texture, json[i].id, json[i].slots_to_clear, json[i].attachments);
        item.x = col*item.width + (col*colPadding);
        item.y = row*item.height + (row*rowPadding);

        if(json[i].icon != null)
        {
            item.signals.down.add(this.onItemButtonClicked, this);
        }

        this._items.push(item);
        this._itemHolderScroll.addChild(item);

        col++;
        if(col >= colLimit)
        {
            col = 0;
            row++;
        }
    }
}

ClothesMenu.prototype.activateButtons = function()
{
    this._itemHolder.alpha = 1;
}

ClothesMenu.prototype.deactivateButtons = function()
{
    this._itemHolder.alpha = 0.6;
}

ClothesMenu.prototype.setFirstTutorial = function()
{
    this.tutorialFinger = new TutorialFinger(0.5);
    this.addChild(this.tutorialFinger);

    this.initialiseTutorial(this.tutorialFinger);
}

ClothesMenu.prototype.setPromptTutorial = function()
{
    if(this.tutorialFinger)
    {
        this.removeChild(this.tutorialFinger);
        this.tutorialFinger = null;
    }

    this.promptFinger = new TutorialFinger(20, true);
    this.addChild(this.promptFinger);

    this.initialiseTutorial(this.promptFinger);
}

ClothesMenu.prototype.initialiseTutorial = function(finger)
{
    var clothes = [
            {type:'move', time:1, x:320, y:283},
            {type:'down', delay:0.2},
            {type:'up', delay:0.6},
            {type:'move', time:1, x:466, y:460},
            {type:'down', delay:0.2},
            {type:'up', delay:0.6},
            {type:'move', time:1, x:310, y:600},
            {type:'down', delay:0.2},
            {type:'up', delay:0.6}
        ];

    var scroll = [
            {type:'target', time:1, target:this._scrollBar, offset:{x:650, y:300}},
            {type:'down', delay:0.2},
            {type:'move', delay:.5, time:1, x:650-30, y:615},
            {type:'move', time:1, x:650, y:298},
            {type:'up', delay:0.6}
        ];

    var categories = [
            {type:'move', time:1, x:255, y:157},
            {type:'down', delay:0.2},
            {type:'up', delay:0.6},
            {type:'move', delay:.5, time:0.9, x:389, y:157},
            {type:'down', delay:0.2},
            {type:'up', delay:0.6},
            {type:'move', delay:.5, time:0.9, x:524, y:157},
            {type:'down', delay:0.2},
            {type:'up', delay:0.6}
        ];

    if(finger === this.tutorialFinger)
    {
        finger.addSequence('clothes', clothes, new PIXI.Point(155, 215), 1, 1);
        finger.addSequence('scroll', scroll, new PIXI.Point(316, 298), 1, 2);
        finger.addSequence('categories', categories, new PIXI.Point(125, 171), 1, 3);
    }
    else
    {
        finger.addSequence('clothes', clothes.concat(scroll, categories), new PIXI.Point(155, 215), -1, 1);
    }
}

//===================================================
// PRIVATE METHODS
//===================================================

ClothesMenu.prototype._isPointWithinScrollRect = function(point)
{
    return point.x > this._touchScrollRect.x && 
           point.x < this._touchScrollRect.x + this._touchScrollRect.width &&
           point.y > this._touchScrollRect.y &&
           point.y < this._touchScrollRect.y + this._touchScrollRect.height;
}

ClothesMenu.prototype._tutorialActionPerformed = function(tutorialId)
{
    if(this.tutorialFinger && this.tutorialFinger.currentSequence == tutorialId)
    {
        Common.tutorialStatesPassed[tutorialId] = true;
        this.tutorialFinger.removeSequence(tutorialId);
        this.signals.tutorialCompleted.dispatch(scroll);
    }
    else if(this.promptFinger)
    {
        this.promptFinger.resetPrompt();
    }
}

//===================================================
// EVENTS
//===================================================

ClothesMenu.prototype.onCategoryButtonClicked = function(id)
{
    this._tutorialActionPerformed('categories');
    this.setCategory(id);
    Common.audio.playSound('sfx_wardrobe_change_draw_01');
};

ClothesMenu.prototype.onItemButtonClicked = function(button)
{
    this._tutorialActionPerformed('clothes');
    this.signals.itemSelected.dispatch({id:button.id, clear:button.clearSlots, add:button.addSlots, baseSlots:Common.config.clothes[this.currentCategory].base_slots});
};

ClothesMenu.prototype.onTouchStart = function(e)
{
    var pos = e.data.getLocalPosition(this);
    if(this._isPointWithinScrollRect(pos))
    {
        if(this._itemHolder.height > this._itemHolderScrollWindowSize)
        {
            this._touchScrollCurrent = pos.y;
            this._touchScrollLast = pos.y;
        }
    }
};

ClothesMenu.prototype.onTouchMove = function(e)
{
    var pos = e.data.getLocalPosition(this);

    if(this._scrollBar.dragging)
    {
        this._scrollBar.setTargetY(e.data.getLocalPosition(this).y);
        this._tutorialActionPerformed('scroll');
    }
    else if(this._touchScrollCurrent != null 
            && this._itemHolder.height > this._itemHolderScrollWindowSize 
            && this._isPointWithinScrollRect(pos))
    {
        this._touchScrollCurrent = pos.y;
    }
}

ClothesMenu.prototype.onTouchEnd = function(e)
{
    if(this._scrollBar.dragging)
    {
        this._scrollBar.onRelease();
    }

    this._touchScrollCurrent = null;
    this._touchScrollLast = null;
}

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2,"./ClothesCategoryButton":14,"./ClothesItemButton":15,"./ScrollBar":17,"./TutorialFinger":19}],17:[function(require,module,exports){
var Common          = require("../Common");
var AudioParams     = require("../audio/AudioParams");

//===================================================
// CONSTRUCTOR
//===================================================

function ScrollBar(verticalRange, horizontalChange)
{
    this._verticalRange = verticalRange;
    this._horizontalChange = horizontalChange;
    this._startingPoint = null;
    this._dragging = false;
    this._offset = null;
    this._clickOffset = new PIXI.Point(0, 0);
    this._targetY = 0;
    this._onDownPos = null;
    this._loopSound = null;

    this.active = false;

    PIXI.Container.call(this);
}
module.exports = ScrollBar;
ScrollBar.prototype = Object.create(PIXI.Container.prototype);
ScrollBar.prototype.constructor = ScrollBar;

//===================================================
// PUBLIC METHODS
//===================================================

ScrollBar.prototype.init = function()
{
    var texture = Common.assets.getTexture('btn_scroll');
	var graphic = new PIXI.Sprite(texture);
    this.addChild(graphic);

    this._startingPoint = new PIXI.Point(this.x, this.y);

    this._offset = new PIXI.Point(-texture.trim.x, -texture.trim.y);

    this.buttonMode = true;
    this.interactive = true;
    this.hitArea = new PIXI.Rectangle(texture.trim.x + (texture.trim.width/2), texture.trim.y, texture.trim.width, texture.trim.height);

    var params = new AudioParams();
    params.loop = true;
    this._loopSound = Common.audio.playSound('sfx_scroll_wardrobe_loop_01', params);
};

ScrollBar.prototype.update = function()
{
    if(Math.round(this.y - this._targetY) == 0 || Common.paused)
    {
        this._loopSound.howl.pause();
    }
    else if(!this._loopSound.howl.playing())
    {
        this._loopSound.howl.play();
    }

    return this.setPosition();
};

ScrollBar.prototype.dispose = function()
{
    this._loopSound.stop();
};

ScrollBar.prototype.setPosition = function()
{
    this.y = this.y + ((this._targetY-this.y) / 7);

    var percent = (this.y - this._startingPoint.y) / this._verticalRange;

    this.x = this._startingPoint.x + (percent * this._horizontalChange);

    return percent;
};

ScrollBar.prototype.setTargetY = function(yPos, includeOffsets)
{
    includeOffsets == undefined && (includeOffsets = true);

    var y = yPos;

    if(includeOffsets)
        y = yPos + this._offset.y + this._clickOffset.y;

    var targetY = Math.min(this._startingPoint.y + this._verticalRange, 
                    Math.max(this._startingPoint.y, 
                    y));

    if(!isNaN(targetY))
        this._targetY = targetY;

    return this._targetY;
};

ScrollBar.prototype.forcePosition = function(y)
{
    this.y = y;
    this._targetY = y;
};

ScrollBar.prototype.setPercentage = function(percentage)
{
    this.setTargetY(this._startingPoint.y + (percentage * this._verticalRange));
}

ScrollBar.prototype.addIncrement = function(inc)
{

}

ScrollBar.prototype.reset = function()
{
    this.setPosition(this.setPercentage(0));
}

ScrollBar.prototype.activate = function()
{
    this._active = true;
    this.alpha = 1;
    this.mousedown = this.touchstart = this.onDown.bind(this);
}

ScrollBar.prototype.deactivate = function()
{
    this._active = true;
    this.alpha = 0.3;
    this.mousedown = this.touchstart = null;
}

//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

ScrollBar.prototype.onDown = function(event)
{
    this._dragging = true;
    this._clickOffset = event.data.getLocalPosition(this);
    this._clickOffset.y = -(this._clickOffset.y + this._offset.y);
    this.buttonMode = false;
    this._onDownPos = this.y;
};

ScrollBar.prototype.onRelease = function(event)
{
    this._dragging = false;
    this.buttonMode = true;

    if(Math.round(this.y) == Math.round(this._onDownPos))
    {
        this.setTargetY(this.y + (this._clickOffset.y < -65 ? 150 : -150), false);
    }
    this._onDownPos = null;
    this._clickOffset = new PIXI.Point(0, 0);
};

//===================================================
// GETTERS/SETTERS
//===================================================

Object.defineProperty(ScrollBar.prototype, "dragging", {

    get: function()
    {
        return this._dragging;
    }
});

Object.defineProperty(ScrollBar.prototype, "offset", {

    get: function()
    {
        return this._offset;
    }
});


//===================================================


},{"../Common":2,"../audio/AudioParams":7}],18:[function(require,module,exports){
var Common                  = require("../Common");

function TitleBar()
{
    this._bar = null;
    this._field = null;

	PIXI.Container.call(this);

    this.init();
}
module.exports = TitleBar;
TitleBar.prototype = Object.create(PIXI.Container.prototype);
TitleBar.prototype.constructor = TitleBar;


//===================================================
// PUBLIC METHODS
//===================================================

TitleBar.prototype.init = function()
{
    this._bar = new PIXI.Sprite(Common.assets.getTexture('hint'));
    this._bar.anchor = new PIXI.Point(0.5, 0.5);
    this.addChild(this._bar);

    //this._field = new PIXI.extras.BitmapText('', {font:"WindsorEF-Elongated", align:'center'});
    this._field = new PIXI.Text('', {
            font:"58px Windsor Elongated", 
            align:'center',
            fillGradientType:PIXI.TEXT_GRADIENT.LINEAR_VERTICAL,
            fill:[0xfef49d, 0xf8b711],
            fillGradientStops:[0, 1],
            dropShadow:true,
            dropShadowAngle:90*PIXI.DEG_TO_RAD,
            dropShadowAlpha:0.5,
            dropShadowDistance:3.5
        });
    this._field.anchor = new PIXI.Point(0.5, 0.5);
    this.addChild(this._field);


    this.scale = new PIXI.Point(0, 0);
};

TitleBar.prototype.destroy = function()
{

};

TitleBar.prototype.update = function()
{
	
};

TitleBar.prototype.show = function(text)
{
    TweenMax.killTweensOf(this);
    this.alpha = 1;

    var textConf = Common.config.strings[text][Common.language];
    var fontConf = Common.config.strings_formatting[text][Common.language];
    this._field.text = textConf;
    this._field.font = fontConf.font;
    this._field.scale = new PIXI.Point(fontConf.sizePercent/100, fontConf.sizePercent/100);

    Common.animator.add(TweenMax.to(this.scale, .3, {startAt:{x:0, y:0}, x:1, ease:Back.easeOut}));
    Common.animator.add(TweenMax.to(this.scale, .3, {delay:.1, y:1, ease:Back.easeOut}));
}

TitleBar.prototype.remove = function(removeTime)
{
    Common.animator.add(TweenMax.to(this, 2, {delay:removeTime, alpha:0}));
}



//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================


//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2}],19:[function(require,module,exports){
var Common   = require("../Common");

function TutorialFinger(sequenceInterval, promptMode)
{
    this.sequences = {};
    this.sequenceInterval = sequenceInterval || 3;
    this.finger = null;
    this.currentSequence = null;
    this.promptMode = promptMode || false;

    this.signals = {};
    this.signals.tutorialStarted = new signals.Signal();

    this.timer = null;

	PIXI.Container.call(this);

    this.init();
}
module.exports = TutorialFinger;
TutorialFinger.prototype = Object.create(PIXI.Container.prototype);
TutorialFinger.prototype.constructor = TutorialFinger;


//===================================================
// PUBLIC METHODS
//===================================================

TutorialFinger.prototype.init = function()
{
    this.finger = new PIXI.Sprite(Common.assets.getTexture('tutorial_hand'));
    this.finger.anchor = new PIXI.Point(0.5, 1);
    this.addChild(this.finger);

    this.alpha = 0;

    this.finger.interactive = false;
    this.finger.hitArea = new PIXI.Rectangle(0, 0, 0, 0);

    this.timer = Common.animator.setTimeout(this.onSequenceIntervalEnded, this.sequenceInterval, this);
};

TutorialFinger.prototype.destroy = function()
{

};

TutorialFinger.prototype.update = function()
{
	
};

TutorialFinger.prototype.addSequence = function(id, sequence, startPoint, repeat, importance)
{
    this.sequences[id] = {sequence:sequence, repeat:repeat, startPoint:startPoint, importance:importance};
};

TutorialFinger.prototype.removeSequence = function(id)
{
    if(this.sequences[id])
    {
        delete this.sequences[id];

        if(this.currentSequence == id)
        {
            TweenMax.killTweensOf(this);
            TweenMax.killTweensOf(this.scale);
            Common.animator.add(TweenMax.to(this.scale, .3, {y:1, ease:Sine.easeOut}));
            Common.animator.add(TweenMax.to(this, .3, {alpha:0, ease:Sine.easeOut}));
            this.timer = Common.animator.setTimeout(this.onSequenceIntervalEnded, this.sequenceInterval, this);
        }
    }
};

TutorialFinger.prototype.setSequence = function(id)
{
    var sequence = this.sequences[id];

    console.log(sequence);

    this.x = sequence.startPoint.x;
    this.y = sequence.startPoint.y;

    var tl = new TimelineMax({repeat:sequence.repeat, onCompleteScope:this, onComplete:function(){
        this.timer = Common.animator.setTimeout(this.onSequenceIntervalEnded, this.sequenceInterval, this);
        this.currentSequence = null;
    }});
    tl.to(this, .3, {alpha:1});
    for(var i in sequence.sequence)
    {
        var s = sequence.sequence[i];
        if(s.type == 'move')
            tl.to(this, s.time, {delay:s.delay, x:s.x, y:s.y, ease:Sine.easeInOut});
        else if(s.type == 'down')
            tl.to(this.scale, s.time || 0.2, {delay:s.delay, y:0.8, ease:Sine.easeInOut});
        else if(s.type == 'up')
            tl.to(this.scale, s.time || 0.3, {delay:s.delay, y:1, ease:Sine.easeInOut});
        else if(s.type == 'target')
        {
            console.log(s);
            tl.to(this, s.time, {delay:s.delay, x:s.target.x + (s.offset ? s.offset.x : 0), y:s.target.y + (s.offset ? s.offset.y : 0), ease:Sine.easeInOut});
        }
    }
    tl.to(this, .3, {alpha:0});
    Common.animator.add(tl);

    this.currentSequence = id;

    this.signals.tutorialStarted.dispatch(id);
}

TutorialFinger.prototype.resetPrompt = function()
{
    TweenMax.killTweensOf(this);
    TweenMax.killTweensOf(this.scale);
    Common.animator.add(TweenMax.to(this.scale, .3, {y:1, ease:Sine.easeOut}));
    Common.animator.add(TweenMax.to(this, .3, {alpha:0}));

    if(!this.timer.complete)
    {
        this.timer.reset();
        this.timer.start();
    }
    else
    {
        this.timer = Common.animator.setTimeout(this.onSequenceIntervalEnded, this.sequenceInterval, this);
    }
}

//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================

TutorialFinger.prototype.onSequenceIntervalEnded = function(id)
{
    console.log('onSequenceIntervalEnded');
    if(!this.promptMode)
    {
        var mostImportant = null;
        var mostImportantNumber = null;
        for(var i in this.sequences)
        {
            if(mostImportantNumber == null || this.sequences[i].importance < mostImportantNumber)
            {
                mostImportant = i;
                mostImportantNumber = this.sequences[i].importance;
            }
        }
        if(mostImportant)
        {
            this.setSequence(mostImportant);
        }
    }
    else
    {
        var arr = [];
        for(var i in this.sequences)
        {
            arr.push(i);
        }
        console.log(arr);

        this.setSequence(arr[0]);
    }
}

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================

},{"../Common":2}],20:[function(require,module,exports){
(function (global){
//import Main from './Main';
var Main = require("./Main");

global.Main = Main;

p3.log = console.log;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./Main":3}],21:[function(require,module,exports){
var Common          = require("../Common");
var SimpleScreen    = require('../screens/SimpleScreen');

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function PauseOverlay()
{
    this._panel = null;
    this._buttons = [];

    this._contents          = null;
    this._imageContainer    = null;
    this._helpText          = null;
    this._confirmContainer  = null;
    this._image             = null;
    this._leftButton        = null;
    this._rightButton       = null;
    this._homeButton        = null;
    this._currentPage       = 0;
    this._currentStep       = 0;
    this._lastStepTime      = 0;

    SimpleScreen.call(this);
}

PauseOverlay.prototype = Object.create(SimpleScreen.prototype);
PauseOverlay.prototype.constructor = PauseOverlay;
module.exports = PauseOverlay;

//===================================================
// PUBLIC METHODS
//===================================================

PauseOverlay.prototype.init = function()
{
    SimpleScreen.prototype.init.call(this);

    Common.paused = true;
    Common.animator.paused = true;

    this.addOverlay();

    this._panel = new PIXI.Sprite(Common.assets.getTexture('pause'));
    this._panel.anchor = new PIXI.Point(0.5, 0.5);
    this._panel.x = Common.STAGE_WIDTH / 2;
    this._panel.y = Common.STAGE_HEIGHT / 2;
    this.addChild(this._panel);

    var title = new PIXI.Sprite(Common.assets.getTexture('paused'));
    title.anchor = new PIXI.Point(0.5, 0.5);
    title.y = -280;
    this._panel.addChild(title);
    
    var muteButton = this.addMuteButton(248, 242);
    this._panel.addChild(muteButton);
    this._buttons.push(muteButton);

    this._homeButton = this.addHomeButton(-215, 242);
    this._panel.addChild(this._homeButton);
    this._buttons.push(this._homeButton);

    var playButton = this._generateButton('icon_play_large', 'resume', 'primary_large');
    playButton.x = 10;
    playButton.y = 250;
    playButton.signals.up.add(this.onPlayButtonClicked, this);
    this._panel.addChild(playButton);
    this._buttons.push(playButton);

    //HELP

    //this._helpText = new PIXI.extras.BitmapText('', {font:"WindsorEF-Elongated", align:'center'});
    this._helpText = new PIXI.Text('', {
            font:"58px Windsor Elongated", 
            align:'center',
            fillGradientType:PIXI.TEXT_GRADIENT.LINEAR_VERTICAL,
            fill:[0xfef49d, 0xf8b711],
            fillGradientStops:[0, 1],
            dropShadow:true,
            dropShadowAngle:90*PIXI.DEG_TO_RAD,
            dropShadowAlpha:0.5,
            dropShadowDistance:3.5
        });
    this._helpText.anchor.set(0.5);
    this._helpText.y = 122;
    this._panel.addChild(this._helpText);

    var setHelpText = function(text)
    {
        var textConf = Common.config.strings[text][Common.language];
        var fontConf = Common.config.strings_formatting[text][Common.language];
        this._helpText.text = textConf;
        this._helpText.font = fontConf.font;
        this._helpText.scale = new PIXI.Point(fontConf.sizePercent/100, fontConf.sizePercent/100);
    }.bind(this);

    var tweenAlphaOut = function(obj, callbackScope, callback){
        TweenMax.to(obj, .3, {alpha:0, onCompleteScope:callbackScope || null, onComplete:callback || null});
    }

    var tweenAlphaIn = function(obj, callbackScope, callback){
        TweenMax.to(obj, .3, {alpha:1, onCompleteScope:callbackScope || null, onComplete:callback || null});
    }

    var dressUpScreen = new PIXI.Container();
        dressUpScreen.bg = this._addImageToTutorialContent(dressUpScreen, 'help_clothes_bg');
        dressUpScreen.icon1 = this._addImageToTutorialContent(dressUpScreen, 'help_clothes_icon1', 0.9);
        dressUpScreen.icon2 = this._addImageToTutorialContent(dressUpScreen, 'help_clothes_icon2', 0.9);
        dressUpScreen.dot1 = this._addImageToTutorialContent(dressUpScreen, 'help_clothes_dorothy1', 0.9);
        dressUpScreen.dot2 = this._addImageToTutorialContent(dressUpScreen, 'help_clothes_dorothy2', 0.9);
        dressUpScreen.camBut = this._createButtonForTutorialContent('icon_camera_off', 'btn_primary_small_off'); 
            dressUpScreen.camBut.position.set(280, 100);
            dressUpScreen.addChild(dressUpScreen.camBut);
        dressUpScreen.finger = this._addImageToTutorialContent(dressUpScreen, 'tutorial_hand', 0.5, new PIXI.Point(0.1, 0.1));

    dressUpScreen.steps = [];
    dressUpScreen.steps[0] = function(){
        this.dot1.alpha = 1;
        this.dot2.alpha = 0;
        setHelpText('tutorial_clothes');
        tweenAlphaOut(this.finger, this, function(){
            this.finger.x = -33;
            this.finger.y = 16;
            tweenAlphaIn(this.finger);
        });
    };
    dressUpScreen.steps[1] = function(){
        this.dot1.alpha = 0;
        this.dot2.alpha = 1;
        this.finger.x = -33;
        this.finger.y = 16;
    };
    dressUpScreen.steps[2] = function(){
        tweenAlphaOut(this.finger, this, function(){
            this.finger.x = -100;
            this.finger.y = 16;
            tweenAlphaIn(this.finger);
        });
    };
    dressUpScreen.steps[3] = function(){
        this.dot2.alpha = 0;
        this.dot1.alpha = 1;
        this.finger.x = -100;
        this.finger.y = 16;
    };
    dressUpScreen.steps[4] = function(){
        tweenAlphaOut(this.finger, this, function(){
            this.finger.x = this.camBut.x;
            this.finger.y = this.camBut.y;
            tweenAlphaIn(this.finger);
        });
    };
    dressUpScreen.steps[5] = function(){};

    var backgroundScreen = new PIXI.Container();
        backgroundScreen.bg1 = this._addImageToTutorialContent(backgroundScreen, 'help_background_bg1');
        backgroundScreen.bg2 = this._addImageToTutorialContent(backgroundScreen, 'help_background_bg2');
        backgroundScreen.dot = this._addImageToTutorialContent(backgroundScreen, 'help_background_dorthy', 0.9);
        backgroundScreen.btns = this._addImageToTutorialContent(backgroundScreen, 'help_background_btns', 1.07);
        backgroundScreen.tickBut = this._createButtonForTutorialContent('icon_tick_off', 'btn_primary_small_off', 0.9); 
            backgroundScreen.tickBut.position.set(280, 100);
            backgroundScreen.addChild(backgroundScreen.tickBut);
        backgroundScreen.finger = this._addImageToTutorialContent(backgroundScreen, 'tutorial_hand', 0.5, new PIXI.Point(0.1, 0.1));


    backgroundScreen.steps = [];
    backgroundScreen.steps[0] = function(){
        setHelpText('tutorial_pick_background');
        this.bg2.alpha = 0;
        tweenAlphaOut(this.finger, this, function(){
            this.finger.x = 320;
            this.finger.y = 0;
            tweenAlphaIn(this.finger);
        });
    };
    backgroundScreen.steps[1] = function(){
        tweenAlphaIn(this.bg2);
    };
    backgroundScreen.steps[2] = function(){
        tweenAlphaOut(this.finger, this, function(){
            this.finger.x = -320;
            tweenAlphaIn(this.finger);
        });
    };
    backgroundScreen.steps[3] = function(){
        tweenAlphaOut(this.bg2);
    };
    backgroundScreen.steps[4] = function(){
        tweenAlphaOut(this.finger, this, function(){
            this.finger.x = this.tickBut.x;
            this.finger.y = this.tickBut.y;
            tweenAlphaIn(this.finger);
        });
    };
    backgroundScreen.steps[5] = function(){};

    var poseScreen = new PIXI.Container();
        poseScreen.bg = this._addImageToTutorialContent(poseScreen, 'help_photo_bg');
        poseScreen.dot1 = this._addImageToTutorialContent(poseScreen, 'help_photo_dorthy1');
        poseScreen.dot2 = this._addImageToTutorialContent(poseScreen, 'help_photo_dorthy2');
        poseScreen.dot3 = this._addImageToTutorialContent(poseScreen, 'help_photo_dorthy3');
        poseScreen.dot4 = this._addImageToTutorialContent(poseScreen, 'help_photo_dorthy4');
        poseScreen.btns = this._addImageToTutorialContent(poseScreen, 'help_photo_btns', 0.84);
        poseScreen.finger = this._addImageToTutorialContent(poseScreen, 'tutorial_hand', 0.5, new PIXI.Point(0.1, 0.1));

    poseScreen.steps = [];
    poseScreen.steps[0] = function(){
        setHelpText('tutorial_pick_pose_picture');
        this.dot1.alpha = 0;
        this.dot2.alpha = 0;
        this.dot3.alpha = 1;
        this.dot4.alpha = 0;
        this.finger.rotation = -30 * PIXI.DEG_TO_RAD;
        tweenAlphaOut(this.finger, this, function(){
            this.finger.x = -160;
            this.finger.y = -75;
            tweenAlphaIn(this.finger); 
        });
    };
    poseScreen.steps[1] = function(){
        this.dot3.alpha = 0;
        this.dot1.alpha = 1;
    };
    poseScreen.steps[2] = function(){
        tweenAlphaOut(this.finger, this, function(){
            this.finger.y = -30;
            tweenAlphaIn(this.finger); 
        });
    };
    poseScreen.steps[3] = function(){
        this.dot1.alpha = 0;
        this.dot2.alpha = 1;
    };
    poseScreen.steps[4] = function(){
        tweenAlphaOut(this.finger, this, function(){
            this.finger.y = 35;
            tweenAlphaIn(this.finger); 
        });
    };
    poseScreen.steps[5] = function(){
        this.dot2.alpha = 0;
        this.dot3.alpha = 1;
    };
    poseScreen.steps[6] = function(){
        tweenAlphaOut(this.finger, this, function(){
            this.finger.y = 100;
            this.finger.x = 10;
            tweenAlphaIn(this.finger);
        });
    };
    poseScreen.steps[7] = function(){}

    var photoScreen = new PIXI.Container();
        photoScreen.bg2 = this._addImageToTutorialContent(photoScreen, 'help_pose_bg2');
        photoScreen.dot1 = this._addImageToTutorialContent(photoScreen, 'help_photo_dorthy1', 0.9);
        photoScreen.finalButtons = new PIXI.Container();
            photoScreen.finalButtons.y = 110;
            photoScreen.finalButtons.back = this._createButtonForTutorialContent('icon_previous_off', 'btn_primary_small_off', 0.9)
            photoScreen.finalButtons.back.position.set(-80, 0);
            photoScreen.finalButtons.addChild(photoScreen.finalButtons.back);
            photoScreen.finalButtons.replay = this._createButtonForTutorialContent('icon_replay_off', 'btn_primary_small_off', 0.9);
            photoScreen.finalButtons.addChild(photoScreen.finalButtons.replay); 
            photoScreen.finalButtons.download = this._createButtonForTutorialContent('icon_download_off', 'btn_primary_small_off', 0.9)
            photoScreen.finalButtons.download.position.set(80, 0);
            photoScreen.finalButtons.addChild(photoScreen.finalButtons.download); 
            photoScreen.addChild(photoScreen.finalButtons);
        photoScreen.finger = this._addImageToTutorialContent(photoScreen, 'tutorial_hand', 0.5, new PIXI.Point(0.1, 0.1));

    photoScreen.steps = [];
    photoScreen.steps[0] = function(){
        setHelpText('tutorial_download');
        tweenAlphaOut(this.finger);
    };
    photoScreen.steps[1] = function(){
        
        this.finger.rotation = -30 * PIXI.DEG_TO_RAD;
        this.finger.x = this.finalButtons.x + this.finalButtons.download.x;
        this.finger.y = this.finalButtons.y;
        tweenAlphaIn(this.finger);
    };
    photoScreen.steps[2] = function(){}

    this._contents = [
        {image:dressUpScreen},
        {image:backgroundScreen},
        {image:poseScreen}//,
        //{image:photoScreen}
    ];

    this._imageContainer = new PIXI.Container();
    this._imageContainer.y = -60;
    this._panel.addChild(this._imageContainer);

    this.addRightButton();
    this.addLeftButton();

    this._leftButton = this._guiButtons.left.button;
    this._rightButton = this._guiButtons.right.button;

    this.setPage(this._currentPage);

    this._confirmContainer = new PIXI.Container();
    this._confirmContainer.visible = false;
    this._panel.addChild(this._confirmContainer);

    this._confirmContainer.tickButton = this._generateButton('icon_tick', 'tick', 'primary_small');
    this._confirmContainer.tickButton.signals.up.add(this.onTickButtonClicked, this);
    this._confirmContainer.tickButton.x = -100;
    this._confirmContainer.tickButton.y = 20;
    this._confirmContainer.addChild(this._confirmContainer.tickButton);

    this._confirmContainer.crossButton = this._generateButton('icon_cross', 'cross', 'primary_small');
    this._confirmContainer.crossButton.signals.up.add(this.onCrossButtonClicked, this);
    this._confirmContainer.crossButton.x = 100;
    this._confirmContainer.crossButton.y = 20;
    this._confirmContainer.addChild(this._confirmContainer.crossButton);

    this._confirmContainer.text = new PIXI.Sprite(Common.assets.getTexture('areyousure'));
    this._confirmContainer.text.anchor.set(0.5);
    this._confirmContainer.text.scale.set(0.5);
    this._confirmContainer.text.y = -110;
    this._confirmContainer.addChild(this._confirmContainer.text);

    this.signals.requestedMusicPlay.dispatch('music_pausehelp_menu_00');
};

PauseOverlay.prototype.destroy = function()
{
    Common.paused = false;
    Common.animator.paused = false;
    SimpleScreen.prototype.destroy.call(this);
};

PauseOverlay.prototype.resize = function()
{
    SimpleScreen.prototype.resize.call(this);
};

PauseOverlay.prototype.update = function()
{
    SimpleScreen.prototype.update.call(this);

    if(Common.frameCount == this._lastStepTime + 100)
    {
        this._currentStep = this._currentStep+1 < this._contents[this._currentPage].image.steps.length ? this._currentStep+1 : 0;
        this._lastStepTime = Common.frameCount;
        this._contents[this._currentPage].image.steps[this._currentStep].call(this._contents[this._currentPage].image);
    }
};

PauseOverlay.prototype.animateIn = function(callback, scope)
{
    SimpleScreen.prototype.animateIn.call(this);

    this._panel.scale = new PIXI.Point(0, 0);
    Common.animator.add(TweenMax.to(this._panel.scale, .2, {x:1, ease:Sine.easeOut}));
    Common.animator.add(TweenMax.to(this._panel.scale, .9, {y:1, ease:Elastic.easeOut}));
};

PauseOverlay.prototype.animateOut = function(callback, scope, args)
{
    SimpleScreen.prototype.animateOut.call(this);

    Common.animator.add(TweenMax.to(this._panel.scale, .45, {x:0, ease:Back.easeIn}));
    Common.animator.add(TweenMax.to(this._panel.scale, .5, {y:0, ease:Back.easeIn, onCompleteScope:this, onComplete:function(){
        callback.call(scope, args);
    }}));
};

PauseOverlay.prototype.disableGUI = function()
{
    for(var i in this._buttons)
    {   
        this._buttons[i].interactive = false;
    }
};

PauseOverlay.prototype.enableGUI = function()
{
    for(var i in this._buttons)
    {   
        this._buttons[i].interactive = true;
    }
};

PauseOverlay.prototype.setPage = function(page)
{
    var newImage = this._contents[page].image;
    newImage.x = this._contents[page].x || 0;
    newImage.y = this._contents[page].y || 0;
    newImage.anchor = new PIXI.Point(0.5, 0.5);
    newImage.alpha = 0;
    this._imageContainer.addChild(newImage);

    this._leftButton.interactive = false;
    this._rightButton.interactive = false;

    if(this._image)
    {
        Common.animator.add(TweenMax.to(this._image, .5, {alpha:0, ease:Sine.easeOut}));
    }
    Common.animator.add(TweenMax.to(newImage, .5, {alpha:1, ease:Sine.easeOut, onCompleteScope:this, onComplete:function(){
        if(this._image)
        {
            this._imageContainer.removeChild(this._image);
        }
        this._image = newImage;
        this._leftButton.interactive = true;
        this._rightButton.interactive = true;
    }}));

    if(page == 0)
        this._leftButton.visible = false;
    else
        this._leftButton.visible = true;

    if(page == this._contents.length-1)
    {
        this._rightButton.visible = false;
    }
    else
    {
        this._rightButton.visible = true;
    }

    this._currentPage = page;
    this._currentStep = 0;
    this._lastStepTime = Common.frameCount;
    this._contents[this._currentPage].image.steps[this._currentStep].call(this._contents[this._currentPage].image);
}

//===================================================
// PRIVATE METHODS
//===================================================

PauseOverlay.prototype._addImageToTutorialContent = function(content, textureName, scale, anchor)
{
    var item = new PIXI.Sprite(Common.assets.getTexture(textureName));
    item.anchor = anchor || new PIXI.Point(0.5, 0.5);
    if(scale !== undefined)
        item.scale = new PIXI.Point(scale, scale);
    content.addChild(item);
    return item;
}

PauseOverlay.prototype._createButtonForTutorialContent = function(iconTexture, buttonTexture)
{
    var button = new PIXI.Sprite(Common.assets.getTexture(buttonTexture));
    button.anchor.set(0.5);
    button.scale.set(0.4);
    var icon = new PIXI.Sprite(Common.assets.getTexture(iconTexture));
    icon.anchor.set(0.5);
    button.addChild(icon);

    return button;
}

//===================================================
// EVENTS
//===================================================

PauseOverlay.prototype.onPlayButtonClicked = function()
{
    this.disableGUI();
    this.animateOut(this.signals.next.dispatch, this);
};

PauseOverlay.prototype.onHomeButtonClicked = function()
{
    TweenMax.to(this._imageContainer, .5, {alpha:0});
    TweenMax.to(this._helpText, .5, {alpha:0});
    this._confirmContainer.visible = true;
    this._confirmContainer.alpha = 0;
    TweenMax.to(this._confirmContainer, .5, {alpha:1});
    this._leftButton.visible = false;
    this._rightButton.visible = false;
}

PauseOverlay.prototype.onCrossButtonClicked = function()
{
    TweenMax.to(this._imageContainer, .5, {alpha:1});
    TweenMax.to(this._helpText, .5, {alpha:1});
    TweenMax.to(this._confirmContainer, .5, {alpha:0, onCompleteScope:this, onComplete:function(){
        this._confirmContainer.visible = false;
    }});
    this._leftButton.visible = true;
    this._rightButton.visible = true;
}

PauseOverlay.prototype.onTickButtonClicked = function()
{
    SimpleScreen.prototype.onGUIButtonClicked.call(this, this._homeButton);
}

PauseOverlay.prototype.onGUIButtonClicked = function(button)
{
    if(button.id == 'home')
    {
        this.onHomeButtonClicked();
    }
    else
    {
        SimpleScreen.prototype.onGUIButtonClicked.call(this, button);
    }
};

PauseOverlay.prototype.onInternalButtonClicked = function(button)
{
    if(button.id == 'right')
    {
        this.setPage(this._currentPage+1);
    }
    else if(button.id == 'left')
    {
        this.setPage(this._currentPage-1);
    }
}

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"../screens/SimpleScreen":26}],22:[function(require,module,exports){
var Common          = require("../Common");
var SimpleScreen    = require('./SimpleScreen');
var TitleBar        = require('../game/TitleBar');

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function BackgroundScreen(character, background)
{
    SimpleScreen.call(this);

    this._character = character;

    this._background = null;
    this._backgroundTextures = [
        'bg_game_001', 
        'bg_game_002', 
        'bg_game_003',
        'bg_game_004',
        'bg_game_005',
        'bg_game_006',
        'bg_game_007',
        'bg_game_008',
        'bg_game_009',
        'bg_game_010',
        'bg_game_011',
        'bg_game_012',
        'bg_game_013'
    ];
    this._currentBackgroundTexture = background == undefined ? 0 : this._backgroundTextures.indexOf(background);

    this._title = null;

    this._photoScene = null;
}

BackgroundScreen.prototype = Object.create(SimpleScreen.prototype);
BackgroundScreen.prototype.constructor = BackgroundScreen;
module.exports = BackgroundScreen;

//===================================================
// PUBLIC METHODS
//===================================================

BackgroundScreen.prototype.init = function()
{
    SimpleScreen.prototype.init.call(this);

    this._character.photoMode = true;

    this._exportBackground = new PIXI.Sprite(Common.assets.getTexture('bg_photo'));
    this.addChild(this._exportBackground);

    this._black = new PIXI.Sprite(Common.colours.black);
    this._black.width = Common.STAGE_WIDTH;
    this._black.height = Common.STAGE_HEIGHT;
    this.addChild(this._black);

    this._photoScene = new PIXI.Container();
    this.addChild(this._photoScene);

    this._background = new PIXI.Sprite(Common.assets.getTexture(this._backgroundTextures[this._currentBackgroundTexture]));
    this._photoScene.addChild(this._background);

    var x = Common.STAGE_WIDTH / 2;
    var y = 700;
    if(this._character.x != x || this._character.y != y)
    {
        this._character.setAnimation('jumpcentre');
        Common.animator.add(TweenMax.to(this._character, .5, {delay:.2, x:x, y:y, ease:Sine.easeInOut}));
    }
    else
    {
        this._character.setAnimation('idle1');
    }
    this._photoScene.addChild(this._character);

    this._setTitle('tutorial_pick_background');

    this.addPauseButton();
    this.addRightButton();
    this.addLeftButton();
    this.addNextButton(null, null, 'icon_tick');
    this.addBackButton();

    this.signals.requestedMusicPlay.dispatch('music_camera_loop_00');
};

BackgroundScreen.prototype.destroy = function()
{
    SimpleScreen.prototype.destroy.call(this);
};

BackgroundScreen.prototype.resize = function()
{
    SimpleScreen.prototype.resize.call(this);
};

BackgroundScreen.prototype.update = function()
{
    if(Common.paused) return true;

    SimpleScreen.prototype.update.call(this);

    if(this._state != 'end')
    {
        this._character.update();
    }
};

//===================================================
// PRIVATE METHODS
//===================================================

BackgroundScreen.prototype._setBackground = function()
{
    this._background.texture = Common.assets.getTexture(this._backgroundTextures[this._currentBackgroundTexture]);
}

BackgroundScreen.prototype._setTitle = function(text)
{
    if(this._title)
        this.removeChild(this._title);

    this._title = new TitleBar();
    this._title.x = Common.STAGE_WIDTH / 2;
    this._title.y = 70;
    this.addChild(this._title);

    this._title.show(text);
}

//===================================================
// EVENTS
//===================================================

BackgroundScreen.prototype.onInternalButtonClicked = function(button)
{
    if(button.id == 'right')
    {
        this._currentBackgroundTexture ++;
        if(this._currentBackgroundTexture >= this._backgroundTextures.length)
            this._currentBackgroundTexture = 0;
        Common.audio.playSound('sfx_background_swipe_00');
    }
    else if(button.id == 'left')
    {
        this._currentBackgroundTexture --;
        if(this._currentBackgroundTexture < 0)
            this._currentBackgroundTexture = this._backgroundTextures.length-1;
        Common.audio.playSound('sfx_background_swipe_00');
    }
    this._setBackground();
}

BackgroundScreen.prototype.onNextButtonClicked = function(button)
{
    this.signals.next.dispatch(this._backgroundTextures[this._currentBackgroundTexture]);
};

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"../game/TitleBar":18,"./SimpleScreen":26}],23:[function(require,module,exports){
var Common              = require("../Common");
var SimpleScreen        = require('./SimpleScreen');
var AnimatedCharacter   = require('../game/AnimatedCharacter');
var ClothesMenu         = require('../game/ClothesMenu');
var TitleBar            = require('../game/TitleBar');

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function DressupScreen(character)
{
    this._character = character;
    this._fresh = !character;
    this._menu = null;
    this._title = null;

    this._currentTutorial = null;

    p3.log(this._fresh);

    SimpleScreen.call(this);
}

DressupScreen.prototype = Object.create(SimpleScreen.prototype);
DressupScreen.prototype.constructor = DressupScreen;
module.exports = DressupScreen;

//===================================================
// PUBLIC METHODS
//===================================================

DressupScreen.prototype.init = function()
{
    SimpleScreen.prototype.init.call(this);

    var background = new PIXI.Sprite(Common.assets.getTexture('bg_game_001'));
    this.addChild(background);

    if(this._character == null)
    {
        this._character = new AnimatedCharacter();
    }

    this._character.photoMode = false;
    
    this._character.x = (Common.STAGE_WIDTH / 2) + 300;
    this._character.y = 700;
    this.addChild(this._character);

    this._menu = new ClothesMenu();
    this._menu.x = (Common.STAGE_WIDTH / 2) - 340;
    this._menu.y = 50;
    this.addChild(this._menu);
    this._menu.init();
    this._menu.signals.itemSelected.add(this.onItemSelected, this);
    this._menu.signals.tutorialCompleted.add(this.onTutorialCompleted, this);

    this._title = new TitleBar();
    this._title.x = Common.STAGE_WIDTH / 2;
    this._title.y = Common.STAGE_HEIGHT - 130;
    this.addChild(this._title);

    var allTutorialsComplete = true;

    for(var i in Common.tutorialStatesPassed)
    {
        if(Common.tutorialStatesPassed[i] == false)
            allTutorialsComplete = false;
    }

    if(!allTutorialsComplete)
    {
        this._menu.setFirstTutorial();
        this._menu.tutorialFinger.signals.tutorialStarted.add(this.onTutorialStarted, this);
    }
    else
    {
        this._title.show('tutorial_clothes');
        this._title.remove(3);
        this._menu.setPromptTutorial();
    }

    this.addPauseButton();
    this.addNextButton(null, null, 'icon_camera');

    if(this._fresh)
    {
        Common.audio.playSound('sfx_wardrobe_appear_00');
        this._character.intro();
    }
    else
    {
        this._character.setAnimation('idle1');
    }

    this._menu.y = Common.STAGE_HEIGHT;
    Common.animator.add(TweenMax.to(this._menu, .8, {y:50, ease:Back.easeOut}));

    this.signals.requestedMusicPlay.dispatch('music_ambient_wardrobe_loop_00');
};

DressupScreen.prototype.destroy = function()
{
    this._menu.destroy();
    SimpleScreen.prototype.destroy.call(this);
};

DressupScreen.prototype.resize = function()
{
    SimpleScreen.prototype.resize.call(this);

    this._character.x = Math.min(this._rightEdge, (Common.STAGE_WIDTH/2) + 320);
    this._menu.x = Math.max(this._leftEdge + 20, (Common.STAGE_WIDTH/2) - 480);
};

DressupScreen.prototype.update = function()
{
    if(Common.paused) return;

    SimpleScreen.prototype.update.call(this);

    this._character.update();
    this._menu.update();
};

DressupScreen.prototype.getCharacter = function()
{
    return this._character;
}


//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

DressupScreen.prototype.onItemSelected = function(obj)
{
    if(this._character.currentOutfit[this._menu.currentCategory] != obj.id)
    {
        this._character.currentOutfit[this._menu.currentCategory] = obj.id;
        this._character.resetBase(obj.baseSlots);

        for(var i in obj.clear)
        {
            this._character.removeAttachmentFromSlot(obj.clear[i]);
        }

        for(var i in obj.add)
        {
            for(var j in obj.baseSlots)
            {
                if(obj.baseSlots[j].outfit_slot == obj.add[i].slot)
                {
                    this._character.removeAttachmentFromSlot(obj.baseSlots[j].base_slot);
                }
            }

            this._character.setAttachmentForSlot(obj.add[i].slot, obj.add[i].attachment);
        }

        var arr = {headwear:'hat', footwear:'shoes', lower_body:'skirt', upper_body:'top'};

        var anim = 'click' + arr[this._menu.currentCategory];
        for(var i in Common.config.clothes[this._menu.currentCategory].items)
        {
            var item = Common.config.clothes[this._menu.currentCategory].items[i];
            if(item.id == obj.id && item.custom_animation)
            {
                anim = item.custom_animation;
            }
        }

        for(var i in this._character.completeAnimations)
        {
            if(this._character.hasCompleteOutfit(i))
            {
                if(this._character.completeAnimations[i].animation)
                {
                    anim = this._character.completeAnimations[i].animationName;
                }
                if(this._character.completeAnimations[i].music)
                {
                    Common.audio.playSound('music_' + i + '_complete_00');
                }
                if(this._character.completeAnimations[i].sfx)
                {
                    Common.audio.playSound('sfx_outfit_' + i + '_complete_00');
                }
            }
        }

        this._character.setAnimation(anim);
        this._character.changeClothesEffect(this._menu.currentCategory);

        var sfx = null;

        if(obj.id.indexOf('lion') > -1)
        {
            sfx = 'sfx_attach_item_lion_00';
        }
        else if(obj.id.indexOf('scarecrow') > -1)
        {
            sfx = 'sfx_attach_item_scarecrow_00';
        }
        else if(obj.id.indexOf('tinman') > -1)
        {
            sfx = 'sfx_attach_item_tinman_00';
        }
        else
        {
            var sounds = {headwear:'sfx_switch_hat_00', 
                          upper_body:'sfx_switch_top_01',
                          lower_body:'sfx_switch_trousers_01',
                          footwear:'sfx_switch_shoes_00'}

            sfx = sounds[this._menu.currentCategory];
        }
        Common.audio.playSound(sfx);
    }
}

DressupScreen.prototype.onTutorialStarted = function(id)
{
    this._currentTutorial = id;
    this._title.show('tutorial_' + id);
}

DressupScreen.prototype.onTutorialCompleted = function(id)
{
    if(this._currentTutorial == id)
    {
        this._currentTutorial = null;
        this._title.remove();
    }
    if(!Common.savedData.allTutorialsViewed &&
        Common.tutorialStatesPassed.clothes == true &&
        Common.tutorialStatesPassed.scroll == true &&
        Common.tutorialStatesPassed.categories == true)
    {
        Common.savedData.allTutorialsViewed = true;
        Common.savedData.save();
        this._title.remove();
        this._menu.setPromptTutorial();
    }
}

DressupScreen.prototype.onNextButtonClicked = function(button)
{
    if(button.id == 'next')
    {
        button.interactive = false;
        Common.audio.playSound('sfx_btn_accept_00');
        Common.animator.add(TweenMax.to(this._menu, .5, {y:Common.STAGE_HEIGHT, ease:Sine.easeIn, onCompleteScope:this, onComplete:function(){
            this.signals.next.dispatch(button.id);
        }}));
    }
    else
    {
        this.signals.next.dispatch(button.id);
    }
};

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"../game/AnimatedCharacter":12,"../game/ClothesMenu":16,"../game/TitleBar":18,"./SimpleScreen":26}],24:[function(require,module,exports){
var Common          = require("../Common");
var SimpleScreen    = require('./SimpleScreen');
var TitleBar        = require('../game/TitleBar');

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function PhotoScreen(character, background)
{
    SimpleScreen.call(this);

    this._state = 'photo';

    this._photoScene = null;
    this._photoSceneCircleMask = null;
    this._photoSceneSquareMask = null;

    this._character = character;

    this._background = null;
    this._backgroundTexture = background !== undefined ? background : 'bg_game_001';

    this._photoFrame = null;
    this._poseButtons = [];
    this._cameraButton = null;
    this._exportFrame = null;

    this._title = null;

    this._exportData = null;
}

PhotoScreen.prototype = Object.create(SimpleScreen.prototype);
PhotoScreen.prototype.constructor = PhotoScreen;
module.exports = PhotoScreen;

//===================================================
// PUBLIC METHODS
//===================================================

PhotoScreen.prototype.init = function()
{
    SimpleScreen.prototype.init.call(this);

    this._character.photoMode = true;

    this._exportBackground = new PIXI.Sprite(Common.assets.getTexture('bg_photo'));
    this.addChild(this._exportBackground);

    this._black = new PIXI.Sprite(Common.colours.black);
    this._black.width = Common.STAGE_WIDTH;
    this._black.height = Common.STAGE_HEIGHT;
    this.addChild(this._black);

    this._photoScene = new PIXI.Container();
    this.addChild(this._photoScene);

    this._photoSceneCircleMask = new PIXI.Graphics();
    this._photoSceneCircleMask.beginFill(0x000000);
    this._photoSceneCircleMask.drawCircle(0, 0, Common.STAGE_WIDTH/2);
    this._photoSceneCircleMask.x = Common.STAGE_WIDTH / 2;
    this._photoSceneCircleMask.y = Common.STAGE_HEIGHT / 2;

    this._photoSceneSquareMask = new PIXI.Graphics();
    this._photoSceneSquareMask.beginFill(0x000000);
    this._photoSceneSquareMask.drawRect(-902/2, -652/2, 902, 652);
    this._photoSceneSquareMask.x = Common.STAGE_WIDTH / 2;
    this._photoSceneSquareMask.y = (Common.STAGE_HEIGHT / 2) + 10;

    this._background = new PIXI.Sprite(Common.assets.getTexture(this._backgroundTexture));
    this._photoScene.addChild(this._background);

    this._exportFrame = new PIXI.Sprite(Common.assets.getTexture('photo_boarder'));
    this._exportFrame.anchor = new PIXI.Point(0.5, 0.5);
    this._exportFrame.x = Common.STAGE_WIDTH / 2;
    this._exportFrame.y = Common.STAGE_HEIGHT / 2;
    this._exportFrame.visible = false;
    this.addChild(this._exportFrame);

    this._photoScene.addChild(this._character);

    this._photoFrame = new PIXI.Sprite(Common.assets.getTexture('frame'));
    this._photoFrame.anchor = new PIXI.Point(0.5, 0.5);
    this._photoFrame.x = Common.STAGE_WIDTH / 2;
    this._photoFrame.y = Common.STAGE_HEIGHT / 2;
    this._photoFrame.visible = false;
    this.addChild(this._photoFrame);

    this.addPauseButton();
    this.addHomeButton();
    this.addBackButton();

    this._guiButtons.home.setX = function()
    {
        this._guiButtons.home.button.x = this._rightEdge - this._guiButtonMargins.right;
    }.bind(this);

    this._guiButtons.home.button.visible = false;

    this.signals.requestedMusicPlay.dispatch('music_camera_loop_00');

    this.setPhotoMode();
};

PhotoScreen.prototype.destroy = function()
{
    SimpleScreen.prototype.destroy.call(this);
};

PhotoScreen.prototype.resize = function()
{
    SimpleScreen.prototype.resize.call(this);
};

PhotoScreen.prototype.update = function()
{
    if(Common.paused) return true;

    SimpleScreen.prototype.update.call(this);

    if(this._state != 'end')
    {
        this._character.update();
    }
};

PhotoScreen.prototype.setPhotoMode = function()
{
    this._state = 'photo';

    this._photoFrame.visible = true;

    var poses = [
        {icon:'icon_pose_001', animation:'photopose1'}, 
        {icon:'icon_pose_002', animation:'photopose2'},
        {icon:'icon_pose_003', animation:'photopose3'},
        {icon:'icon_pose_004', animation:'photopose4'},
    ];
    for(var i = 0; i < poses.length; i++)
    {
        var button = this._generateButton(poses[i].icon, poses[i].animation, 'secondary_small');
        button.signals.up.add(this.onPoseButtonClicked, this);
        button.x = (Common.STAGE_WIDTH / 2) - 420;
        button.y = ((Common.STAGE_HEIGHT / 2)+100) - 240 + (i * 130);
        button.sound = 'music_stab_change_pose_0' + i;
        this.addChild(button);
        button.hitArea = new PIXI.Rectangle(-50, -50, 100, 100);
        this._poseButtons.push(button);
    }

    var button = this._generateButton('icon_flash', 'camera', 'primary_small');
    button.signals.up.add(this.onInternalButtonClicked, this);
    button.x = (Common.STAGE_WIDTH / 2) + 400;
    button.y = (Common.STAGE_HEIGHT / 2) + 280;
    this.addChild(button);
    this._cameraButton = button;

    this._setTitle('tutorial_pick_pose_picture');
};

PhotoScreen.prototype.takePicture = function()
{
    this.addChild(this._photoSceneCircleMask);
    this._photoScene.mask = this._photoSceneCircleMask;
    Common.audio.playSound('sfx_take_final_photo');
    Common.animator.add(TweenMax.to(this._photoSceneCircleMask.scale, .2, {x:0, y:0, onCompleteScope:this, onComplete:this.setEndMode}));
}

PhotoScreen.prototype.setEndMode = function()
{
    this._photoScene.mask = null;
    this._photoSceneCircleMask.scale = new PIXI.Point(0, 0);
    this.removeChild(this._photoSceneCircleMask);

    this._photoScene.mask = this._photoSceneSquareMask;
    this.addChild(this._photoSceneSquareMask);

    this._state = 'end';

    for(var i in this._poseButtons)
    {
        this.removeChild(this._poseButtons[i]);
    }
    this.removeChild(this._cameraButton);
    this.removeChild(this._guiButtons.pause.button);
    this._guiButtons.back.button.visible = false;
    this.removeChild(this._title);

    this._photoFrame.visible = false;

    this._exportFrame.visible = true;
    this._black.visible = false;

    /*
    Common.renderer.render(Common.stage);
    try{
        this._exportData = Common.renderer.extract.base64();
    }
    catch(e){
        this._exportData = document.getElementById('canvas').toDataURL("image/png");
    }   
    Common.savedData.exportedImage = this._exportData;
    Common.savedData.save();
    */

    this._guiButtons.home.button.visible = true;

    this._setTitle('tutorial_great_photo'); 
    
    var button = this._generateButton('icon_previous', 'restart', 'primary_small');
    button.signals.up.add(this.onInternalButtonClicked, this);
    button.x = (Common.STAGE_WIDTH / 2) - 200;
    button.y = (Common.STAGE_HEIGHT / 2) + 280;
    this.addChild(button);
    this._restartButton = button;

    var button = this._generateButton('icon_replay', 'complete', 'primary_small');
    button.signals.up.add(this.onNextButtonClicked, this);
    button.x = (Common.STAGE_WIDTH / 2);
    button.y = (Common.STAGE_HEIGHT / 2) + 280;
    this.addChild(button);
    this._completeButton = button;

    var button = this._generateButton('icon_download', 'download', 'primary_small');
    button.signals.up.add(this.onInternalButtonClicked, this);
    button.x = (Common.STAGE_WIDTH / 2) + 200;
    button.y = (Common.STAGE_HEIGHT / 2) + 280;
    this.addChild(button);
    this._downloadButton = button;

    //Removing download functionality
    this._downloadButton.visible = false;
    this._restartButton.x = (Common.STAGE_WIDTH / 2)-150;
    this._completeButton.x = (Common.STAGE_WIDTH / 2)+150;

}

//===================================================
// PRIVATE METHODS
//===================================================

PhotoScreen.prototype._setTitle = function(text)
{
    if(this._title)
        this.removeChild(this._title);

    this._title = new TitleBar();
    this._title.x = Common.STAGE_WIDTH / 2;
    this._title.y = 70;
    this.addChild(this._title);

    this._title.show(text);
}

//===================================================
// EVENTS
//===================================================

PhotoScreen.prototype.onInternalButtonClicked = function(button)
{
    if(button.id == 'camera')
    {
        this.takePicture();
    }
    else if(button.id == 'download')
    {
        //if(p3.Device.isMobile)
        //   window.open(this._exportData, "_BLANK");
        //else
            window.open(Common.gameDir + 'image.html', "_BLANK");
    }
    else if(button.id == 'restart')
    {
        this.onPreviousButtonClicked();
    }
}

PhotoScreen.prototype.onPreviousButtonClicked = function(button)
{
    p3.log('onPreviousButtonClicked');
    this.signals.previous.dispatch(this._state);
};

PhotoScreen.prototype.onPoseButtonClicked = function(button)
{
    this._character.setAnimation(button.id, true);
    Common.audio.playSound(button.sound);
    Common.audio.playSound('sfx_btn_change_camera_pose_00');
};

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"../game/TitleBar":18,"./SimpleScreen":26}],25:[function(require,module,exports){
var Common       = require("../Common");
var SimpleScreen = require("./SimpleScreen");

/**
 * @constructor
 */
function PreloaderScreen()
{
    SimpleScreen.call(this);

    this.loaded = 0;

    this._loadedSmooth = 0;
    this._logo = null;
    this._bar = null;
    this._text = null;

    this.signals.loadComplete = new signals.Signal();
}

module.exports                        = PreloaderScreen;
PreloaderScreen.prototype             = Object.create(SimpleScreen.prototype);
PreloaderScreen.prototype.constructor = PreloaderScreen;

PreloaderScreen.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

    var g = new PIXI.Graphics();
    g.clear();
    g.beginFill(0x872F87);
    g.drawRect(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
    g.endFill();
    this.addChild(g);

    var holder = new PIXI.Container();
    holder.x = Common.STAGE_WIDTH * 0.5;
    holder.y = Common.STAGE_HEIGHT * 0.5 + 46;
    this.addChild(holder);

    var frames = [];
    for (let i = 1; i < 10; ++ i) {
        frames.push(Common.assets.getTexture("loader_animation000" + i));
    }
    frames.push(Common.assets.getTexture("loader_animation0010"));

    var sequence = new p3.MovieClipSequence();
    sequence.addTextures(frames);

    this._logo = new p3.MovieClip(sequence);
    this._logo.x = 50;
    this._logo.y = 20;
    this._logo.anchor = new PIXI.Point(0.5, 1);
    this._logo.animationSpeed = 1 / 4;
    this._logo.looping = false;
    this._logo.play();
    holder.addChild(this._logo);

    this._bar = new PIXI.Sprite(Common.assets.getTexture("preloader_bg"));
    this._bar.y = 34;
    this._bar.anchor = new PIXI.Point(0.5, 0.5);
    holder.addChild(this._bar);

    this._bar.fill = new PIXI.Sprite(Common.assets.getTexture("preloader_bar"));
    this._bar.fill.anchor = new PIXI.Point(0.5, 0.5);
    this._bar.addChild(this._bar.fill);

    this._bar.fill.mask = new PIXI.Graphics();
    this._bar.fill.mask.x = -this._bar.fill.texture.width * 0.5;
    this._bar.fill.mask.scale.x = 0;
    this._bar.fill.mask.beginFill(0xFF0000);
    this._bar.fill.mask.drawRect(0, -this._bar.fill.texture.height * 0.5,
    this._bar.fill.texture.width, this._bar.fill.texture.height);
    this._bar.fill.addChild(this._bar.fill.mask);

    this._bar.frame = new PIXI.Sprite(Common.assets.getTexture("preloader_overlay"));
    this._bar.frame.anchor = new PIXI.Point(0.5, 0.5);
    this._bar.addChild(this._bar.frame);

    this._text = new PIXI.Text("0%", {fontSize: "32px", fontFamily: "Arial", fill: "#FFFFFF", align: "center"});
    this._text.y = this._bar.y + 60;
    this._text.pivot.x = this._text.width * 0.5;
    this._text.pivot.y = this._text.height * 0.5;
    holder.addChild(this._text);

};

PreloaderScreen.prototype.destroy = function()
{
    SimpleScreen.prototype.destroy.call(this);
};

PreloaderScreen.prototype.animateIn = function()
{

};

PreloaderScreen.prototype.update = function()
{
    this._loadedSmooth += (this.loaded - this._loadedSmooth) * 0.1;

    if(this._loadedSmooth > 99)
        this._loadedSmooth = 100;

    var loaded = Math.min(1, this._loadedSmooth/100);
    this._bar.fill.mask.scale.x += (loaded - this._bar.fill.mask.scale.x) * 0.4;

    this._text.text = "" + Math.round(loaded * 100) + "%";
    this._text.pivot.x = this._text.width * 0.5;

    if(loaded == 1)
    {
        this.signals.loadComplete.dispatch();
    }
};
},{"../Common":2,"./SimpleScreen":26}],26:[function(require,module,exports){

var Common          = require("../Common");
var GUIButtonData   = require("../ui/GUIbuttonData");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function SimpleScreen() {

    p3.Scene.call(this);

    this.signals.next = new signals.Signal();
    this.signals.previous = new signals.Signal();
    this.signals.guiClick = new signals.Signal();
    this.signals.requestedMusicPlay = new signals.Signal();
    this.signals.requestedMusicStop = new signals.Signal();
    this.signals.requestedAmbiencePlay = new signals.Signal();
    this.signals.requestedAmbienceStop = new signals.Signal();
    this.signals.requestedAmbienceStopAll = new signals.Signal();

    this._centre = new PIXI.Point(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2);
    this._leftEdge = 0;
    this._rightEdge = 0;

    this._guiButtonMargins = {top:100, bottom:100, right:100, left:100, minSpacing:150};
    this._guiButtons = {};
}
module.exports = SimpleScreen;
SimpleScreen.prototype = Object.create(p3.Scene.prototype);
SimpleScreen.prototype.constructor = SimpleScreen;

//===================================================
// PUBLIC METHODS
//===================================================


SimpleScreen.prototype.init = function()
{
    
};

SimpleScreen.prototype.destroy = function()
{
    this.signals.next.dispose();
    this.signals.previous.dispose();
    this.signals.guiClick.dispose();
};

SimpleScreen.prototype.update = function()
{

};

SimpleScreen.prototype.addPauseButton = function(x, y)
{
    var button = this._generateButton('icon_pause', 'pause');
    button.signals.up.add(this.onGUIButtonClicked, this);

    if(y == undefined)
    {
        button.y = this._guiButtonMargins.top;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.pause = new GUIButtonData(button, function()
        {
            button.x = this._rightEdge - this._guiButtonMargins.right;
        }.bind(this));
    }
    else
    {
        button.x = x;
    }

    this.addChild(button);

    return button;
}

SimpleScreen.prototype.addHelpButton = function(x, y)
{
    var button = this._generateButton('icon_help', 'help');
    button.signals.up.add(this.onGUIButtonClicked, this);

    if(y == undefined)
    {
        button.y = this._guiButtonMargins.top;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.help = new GUIButtonData(button, function()
        {
            button.x = this._rightEdge - this._guiButtonMargins.right;
            if(this._guiButtons.pause)
            {
                button.x -= this._guiButtonMargins.minSpacing;
            }
        }
        .bind(this));
    }
    else
    {
        button.x = x;
    }

    this.addChild(button);

    return button;
}

SimpleScreen.prototype.addBackButton = function(x, y)
{
    var button = this._generateButton('icon_previous', 'back');
    button.signals.up.add(this.onPreviousButtonClicked, this);

    if(y == undefined)
    {
        button.y = this._guiButtonMargins.top;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.back = new GUIButtonData(button, function()
        {
            button.x = this._leftEdge + this._guiButtonMargins.left;
        }
        .bind(this));
    }
    else
    {
        button.x = x;
    }

    this.addChild(button);

    return button;
}

SimpleScreen.prototype.addNextButton = function(x, y, icon)
{
    var button = this._generateButton(icon || 'icon_next', 'next');
    button.signals.up.add(this.onNextButtonClicked, this);

    if(y == undefined)
    {
        button.y = Common.STAGE_HEIGHT - this._guiButtonMargins.bottom;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.next = new GUIButtonData(button, function()
        {
            button.x = this._rightEdge - this._guiButtonMargins.right;
        }
        .bind(this));
    }
    else
    {
        button.x = x;
    }

    this.addChild(button);

    return button;
}

SimpleScreen.prototype.addRightButton = function(x, y)
{
    var button = this._generateButton('icon_tertairy_next', 'right', 'tertairy');
    button.signals.up.add(this.onInternalButtonClicked, this);

    if(y == undefined)
    {
        button.y = Common.STAGE_HEIGHT/2;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.right = new GUIButtonData(button, function()
        {
            button.x = this._rightEdge - (button.width/2);
        }
        .bind(this));
    }
    else
    {
        button.x = x;
    }

    button.animate = false;
    button._background.scale.x = -1;
    this.addChild(button);

    return button;
}

SimpleScreen.prototype.addLeftButton = function(x, y)
{
    var button = this._generateButton('icon_tertairy_back', 'left', 'tertairy');
    button.signals.up.add(this.onInternalButtonClicked, this);

    if(y == undefined)
    {
        button.y = Common.STAGE_HEIGHT/2;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.left = new GUIButtonData(button, function()
        {
            button.x = this._leftEdge + (button.width/2);
        }
        .bind(this));
    }
    else
    {
        button.x = x;
    }
    button.animate = false;
    this.addChild(button);

    return button;
}

SimpleScreen.prototype.addMuteButton = function(x, y)
{
    var button = this._generateButton('icon_sound', 'mute');

    if(y == undefined)
    {
        button.y = this._guiButtonMargins.top;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.mute = new GUIButtonData(button, function()
        {
            button.x = this._rightEdge - this._guiButtonMargins.right;
            if(this._guiButtons.pause)
            {
                button.x -= this._guiButtonMargins.minSpacing;
            }
            if(this._guiButtons.help)
            {
                button.x -= this._guiButtonMargins.minSpacing;
            }
        }
        .bind(this));
    }
    else
    {
        button.x = x;
    }
    this.addChild(button);
    return button;
}

SimpleScreen.prototype.addHomeButton = function(x, y)
{
    var button = this._generateButton('icon_home', 'home');
    button.signals.up.add(this.onGUIButtonClicked, this);

    if(y == undefined)
    {
        button.y = this._guiButtonMargins.top;
    }
    else
    {
        button.y = y;
    }
    if(x == undefined)
    {
        this._guiButtons.home = new GUIButtonData(button, function()
        {
            button.x = this._leftEdge + this._guiButtonMargins.left;
        }
        .bind(this));
    }
    else
    {
        button.x = x;
    }
    this.addChild(button);
    return button;
}

SimpleScreen.prototype.addOverlay = function()
{
    var overlay = new PIXI.Sprite(Common.colours.black);
    overlay.alpha = 0.7;
    overlay.width = Common.STAGE_WIDTH;
    overlay.height = Common.STAGE_HEIGHT;
    overlay.hitArea = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
    overlay.interactive = true;
    this.addChild(overlay);
}

SimpleScreen.prototype.resize = function()
{
    this.x = (p3.View.width - Common.STAGE_WIDTH) * 0.5;

    this._rightEdge = this._centre.x + (p3.View.width/2);
    this._leftEdge = this._centre.x - (p3.View.width/2);

    for(var i in this._guiButtons)
    {
        if(this._guiButtons[i].setX)
        {
            this._guiButtons[i].setX();
        }
    }
};


SimpleScreen.prototype.hideGUI = function()
{


};

SimpleScreen.prototype.showGUI = function()
{

};


//===================================================
// PRIVATE METHODS
//===================================================

SimpleScreen.prototype._generateButton = function(icon, id, type)
{
    type = type || 'primary_small';
    var buttonStates = new p3.ButtonStates(
        Common.assets.getTexture('btn_' + type + '_off'),
        Common.assets.getTexture('btn_' + type + '_over'),
        Common.assets.getTexture('btn_' + type + '_down'),
        Common.assets.getTexture(icon + '_off')
    );

    buttonStates.iconOver = Common.assets.getTexture(icon + '_over');
    buttonStates.iconDown = Common.assets.getTexture(icon + '_down');

    var button;
    if(id == 'mute')
    {
        buttonStates.iconAlt = Common.assets.getTexture('icon_mute_off');
        buttonStates.iconOverAlt = Common.assets.getTexture('icon_mute_over');
        buttonStates.iconDownAlt = Common.assets.getTexture('icon_mute_down');
        button = new p3.MuteButton(buttonStates);
    }
    else
    {
        button = new p3.Button(buttonStates);
    }
    button.id = id;
    return button;
}

SimpleScreen.prototype._generatePlaceholderButton = function(text, id, mute)
{
    if(Common.placeHolderButtonIcons[id] == null)
    {   
        var text = new PIXI.Text(text, {font:'30px Tahoma', fill:0x000000, align:'center'});
        Common.placeHolderButtonIcons[id] = text.generateTexture(Common.renderer, 1.0, PIXI.SCALE_MODES.LINEAR);
    }
    var buttonStates = new p3.ButtonStates(
        Common.placeHolderButtonBox,
        Common.placeHolderButtonBox,
        Common.placeHolderButtonBox,
        Common.placeHolderButtonIcons[id]
    );

    var button;
    if(mute)
    {
        if(Common.placeHolderButtonIcons.unmute == null)
        {   
            var text = new PIXI.Text('Unmute', {font:'30px Tahoma', fill:0x000000, align:'center'});
            Common.placeHolderButtonIcons.unmute = text.generateTexture(Common.renderer, 1.0, PIXI.SCALE_MODES.LINEAR);
        }
        buttonStates.iconAlt = Common.placeHolderButtonIcons.unmute;
        button = new p3.MuteButton(buttonStates);
    }
    else
    {
        button = new p3.Button(buttonStates);
    }
    button.animate = false;
    button.animateIcon = false;
    button.id = id;
    return button;
}

//===================================================
// EVENTS
//===================================================

SimpleScreen.prototype.onGUIButtonClicked = function(button)
{
    if(button.id == "back")
        this.signals.previous.dispatch(button.id);
    else
        this.signals.guiClick.dispatch(button.id);
};

SimpleScreen.prototype.onInternalButtonClicked = function(button)
{

}

SimpleScreen.prototype.onNextButtonClicked = function(button)
{
    this.signals.next.dispatch(button.id);
};

SimpleScreen.prototype.onPreviousButtonClicked = function(button)
{
    this.signals.previous.dispatch(button.id);
};


//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"../ui/GUIbuttonData":28}],27:[function(require,module,exports){
var Common              = require("../Common");
var SimpleScreen        = require('./SimpleScreen');
var GUIButtonData       = require("../ui/GUIbuttonData");
var AnimatedCharacter   = require('../game/AnimatedCharacter');
var Butterfly           = require('../game/Butterfly');

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function TitleScreen()
{
    this._character = null;
    this._toto = null;

    this._butterflies = null;

    SimpleScreen.call(this);
}

TitleScreen.prototype = Object.create(SimpleScreen.prototype);
TitleScreen.prototype.constructor = TitleScreen;
module.exports = TitleScreen;

//===================================================
// PUBLIC METHODS
//===================================================

TitleScreen.prototype.init = function()
{
	var background = new PIXI.Sprite(Common.assets.getTexture('bg_splash'));
    this.addChild(background);

    this._butterflies = [];

    for(var i = 0; i < 5 + Math.floor(Math.random() * 3); i++)
    {
        var bf = new Butterfly();
        this.addChild(bf);
        this._butterflies.push(bf);
    }

    var title = new PIXI.Sprite(Common.assets.getTexture('title'));
    title.anchor = new PIXI.Point(0.5, 0.5);
    title.x = Common.STAGE_WIDTH / 2;
    title.y = (Common.STAGE_HEIGHT / 2) - 200;
    title.scale = new PIXI.Point(0, 0);
    title.rotation = 20 * PIXI.DEG_TO_RAD;
    this.addChild(title);

    this._character = new AnimatedCharacter();
    this._character.x = (Common.STAGE_WIDTH / 2);
    this._character.y = 740;
    this._character.scale = new PIXI.Point(0.8, 0.8);
    this.addChild(this._character);

    this._toto = new PIXI.Sprite(Common.assets.getTexture('splash_dog'));
    this._toto.anchor = new PIXI.Point(0.5, 1);
    this._toto.x = (Common.STAGE_WIDTH / 2) - 200;
    this._toto.y = 740;

    Common.animator.add(TweenMax.to(this._toto.scale, 1, {y:0.98, ease:Sine.easeInOut, repeat:-1, yoyo:true}));

    var totoShadow = new PIXI.Sprite(Common.assets.getTexture('splash_dog_shadow'));
    totoShadow.anchor = new PIXI.Point(0.3, 0.5);
    totoShadow.x = this._toto.x;
    totoShadow.y = this._toto.y;
    this.addChild(totoShadow);

    this.addChild(this._toto);

    var delay = 0.4;
    Common.animator.add(TweenMax.to(title.scale, 1, {delay:delay, x:1, ease:Elastic.easeOut}));
    Common.animator.add(TweenMax.to(title.scale, 1.1, {delay:delay, y:1, ease:Elastic.easeOut}));
    Common.animator.add(TweenMax.to(title, 0.8, {delay:delay, rotation:0, ease:Back.easeOut}));

	var playButton = this._generateButton('icon_play_large', 'play', 'primary_large');
    playButton.signals.up.add(this.onNextButtonClicked, this);
    playButton.y = Common.STAGE_HEIGHT - (this._guiButtonMargins.bottom * 1.38);
    this._guiButtons.play = new GUIButtonData(playButton, function()
    {
        playButton.x = this._rightEdge - (this._guiButtonMargins.right * 1.38);
    }
    .bind(this));
    this.addChild(playButton);

    this.addMuteButton();

    this.signals.requestedMusicPlay.dispatch('music_menu_loop_01');

    SimpleScreen.prototype.init.call(this);
};

TitleScreen.prototype.destroy = function()
{
    SimpleScreen.prototype.destroy.call(this);
};

TitleScreen.prototype.resize = function()
{
    SimpleScreen.prototype.resize.call(this);
};

TitleScreen.prototype.update = function()
{
    if(Common.paused) return true;

    if(Common.frameCount % 30 == 0 && Math.floor(Math.random() * 5) == 0)
    {
        this._toto.texture = Common.assets.getTexture('splash_dog_blink');
        Common.animator.setTimeout(function(){
            this._toto.texture = Common.assets.getTexture('splash_dog');
        }, .2, this);
    }

    this._character.update();

    for(var i in this._butterflies)
    {
        this._butterflies[i].update();
    }
    
    SimpleScreen.prototype.update.call(this);
};

//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================


//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"../game/AnimatedCharacter":12,"../game/Butterfly":13,"../ui/GUIbuttonData":28,"./SimpleScreen":26}],28:[function(require,module,exports){

function GUIButtonData(button, setX)
{
    this.button = button;
    this.setX = setX;    
}
module.exports = GUIButtonData;

},{}]},{},[20])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L1VzZXJzL09sbGllL0FwcERhdGEvUm9hbWluZy9ucG0vbm9kZV9tb2R1bGVzL3dhdGNoaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvQXBwbGljYXRpb24uanMiLCJzcmMvQ29tbW9uLmpzIiwic3JjL01haW4uanMiLCJzcmMvU2F2ZWREYXRhLmpzIiwic3JjL2F1ZGlvL0F1ZGlvLmpzIiwic3JjL2F1ZGlvL0F1ZGlvTWFuYWdlci5qcyIsInNyYy9hdWRpby9BdWRpb1BhcmFtcy5qcyIsInNyYy9jb21tb24vRW1pdHRlci5qcyIsInNyYy9jb21tb24vRm9udExvYWRlci5qcyIsInNyYy9jb21tb24vSW5wdXQuanMiLCJzcmMvY29tbW9uL1F1ZXVlQ2FsbHMuanMiLCJzcmMvZ2FtZS9BbmltYXRlZENoYXJhY3Rlci5qcyIsInNyYy9nYW1lL0J1dHRlcmZseS5qcyIsInNyYy9nYW1lL0Nsb3RoZXNDYXRlZ29yeUJ1dHRvbi5qcyIsInNyYy9nYW1lL0Nsb3RoZXNJdGVtQnV0dG9uLmpzIiwic3JjL2dhbWUvQ2xvdGhlc01lbnUuanMiLCJzcmMvZ2FtZS9TY3JvbGxCYXIuanMiLCJzcmMvZ2FtZS9UaXRsZUJhci5qcyIsInNyYy9nYW1lL1R1dG9yaWFsRmluZ2VyLmpzIiwic3JjL2luZGV4V2F0Y2guanMiLCJzcmMvb3ZlcmxheXMvUGF1c2VPdmVybGF5LmpzIiwic3JjL3NjcmVlbnMvQmFja2dyb3VuZFNjcmVlbi5qcyIsInNyYy9zY3JlZW5zL0RyZXNzdXBTY3JlZW4uanMiLCJzcmMvc2NyZWVucy9QaG90b1NjcmVlbi5qcyIsInNyYy9zY3JlZW5zL1ByZWxvYWRlclNjcmVlbi5qcyIsInNyYy9zY3JlZW5zL1NpbXBsZVNjcmVlbi5qcyIsInNyYy9zY3JlZW5zL1RpdGxlU2NyZWVuLmpzIiwic3JjL3VpL0dVSWJ1dHRvbkRhdGEuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3paQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDaExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaGhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1U0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Y0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9JQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBBdWRpb1BhcmFtcyAgICAgICA9IHJlcXVpcmUoXCIuL2F1ZGlvL0F1ZGlvUGFyYW1zXCIpO1xudmFyIEJhY2tncm91bmRTY3JlZW4gID0gcmVxdWlyZSgnLi9zY3JlZW5zL0JhY2tncm91bmRTY3JlZW4nKTtcbnZhciBDb21tb24gICAgICAgICAgICA9IHJlcXVpcmUoJy4vQ29tbW9uJyk7XG52YXIgRHJlc3N1cFNjcmVlbiAgICAgPSByZXF1aXJlKCcuL3NjcmVlbnMvRHJlc3N1cFNjcmVlbicpO1xudmFyIFBhdXNlT3ZlcmxheSAgICAgID0gcmVxdWlyZSgnLi9vdmVybGF5cy9QYXVzZU92ZXJsYXknKTtcbnZhciBQaG90b1NjcmVlbiAgICAgICA9IHJlcXVpcmUoJy4vc2NyZWVucy9QaG90b1NjcmVlbicpO1xudmFyIFRpdGxlU2NyZWVuICAgICAgID0gcmVxdWlyZSgnLi9zY3JlZW5zL1RpdGxlU2NyZWVuJyk7XG5cblxuZnVuY3Rpb24gQXBwbGljYXRpb24oKVxue1xuICAgIHRoaXMuX2N1cnJlbnRNdXNpYyA9IG51bGw7XG59XG5tb2R1bGUuZXhwb3J0cyA9IEFwcGxpY2F0aW9uO1xuXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcbntcbiAgICB0aGlzLl9nZW5lcmF0ZVRleHR1cmVzKCk7XG4gICAgdGhpcy5jcmVhdGVUaXRsZVNjcmVlbigpO1xuXG4gICAgdmFyIHBhcmFtcyA9IG5ldyBBdWRpb1BhcmFtcygpO1xuICAgIHBhcmFtcy5sb29wID0gdHJ1ZTtcbiAgICBDb21tb24uYXVkaW8ucGxheVNvdW5kKCdzZnhfYW1iaWVudF9iaXJkc29uZ18wMScsIHBhcmFtcyk7XG59O1xuXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuY3JlYXRlVGl0bGVTY3JlZW4gPSBmdW5jdGlvbigpXG57XG4gICAgdmFyIHNjcmVlbiA9IG5ldyBUaXRsZVNjcmVlbigpO1xuICAgIENvbW1vbi5zY2VuZU1hbmFnZXIuYWRkKHNjcmVlbiwgdGhpcy5fZ2V0VHJhbnNpdGlvbigpKTtcblxuICAgIHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZE11c2ljUGxheS5hZGQodGhpcy5fcGxheU11c2ljLCB0aGlzKTtcbiAgICBcbiAgICBzY3JlZW4uc2lnbmFscy5uZXh0LmFkZE9uY2UoZnVuY3Rpb24oaWQpXG4gICAge1xuICAgICAgICBDb21tb24uYXVkaW8ucGxheVNvdW5kKCdzZnhfYnRuX3BsYXlfc3RhcnRfZG9vcmJlbGxfMDAnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVEcmVzc3VwU2NyZWVuKCk7XG4gICAgfSwgdGhpcyk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5wcmV2aW91cy5hZGRPbmNlKGZ1bmN0aW9uKGlkKVxuICAgIHtcbiAgICAgICAgXG4gICAgfSwgdGhpcyk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5ndWlDbGljay5hZGQoZnVuY3Rpb24oaWQpXG4gICAge1xuICAgICAgICBpZihpZCA9PSAncGF1c2UnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVBhdXNlT3ZlcmxheShzY3JlZW4pO1xuICAgICAgICB9XG4gICAgfSwgdGhpcyk7XG4gICAgXG4gICAgQ29tbW9uLmN1cnJlbnRTY3JlZW4gPSBzY3JlZW47XG4gICAgXG4gICAgcmV0dXJuIHNjcmVlbjsgIFxufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLmNyZWF0ZURyZXNzdXBTY3JlZW4gPSBmdW5jdGlvbihjaGFyYWN0ZXIpXG57XG4gICAgdmFyIHNjcmVlbiA9IG5ldyBEcmVzc3VwU2NyZWVuKGNoYXJhY3Rlcik7XG4gICAgQ29tbW9uLnNjZW5lTWFuYWdlci5hZGQoc2NyZWVuLCB0aGlzLl9nZXRUcmFuc2l0aW9uKCkpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkTXVzaWNQbGF5LmFkZCh0aGlzLl9wbGF5TXVzaWMsIHRoaXMpO1xuICAgIFxuICAgIHNjcmVlbi5zaWduYWxzLm5leHQuYWRkT25jZShmdW5jdGlvbihpZClcbiAgICB7XG4gICAgICAgIHZhciBjaGFyYWN0ZXIgPSBzY3JlZW4uZ2V0Q2hhcmFjdGVyKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlQmFja2dyb3VuZFNjcmVlbihjaGFyYWN0ZXIpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMucHJldmlvdXMuYWRkT25jZShmdW5jdGlvbihpZClcbiAgICB7XG4gICAgICAgIFxuICAgIH0sIHRoaXMpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMuZ3VpQ2xpY2suYWRkKGZ1bmN0aW9uKGlkKVxuICAgIHtcbiAgICAgICAgaWYoaWQgPT0gJ3BhdXNlJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVQYXVzZU92ZXJsYXkoc2NyZWVuKTtcbiAgICAgICAgfVxuICAgIH0sIHRoaXMpO1xuICAgIFxuICAgIENvbW1vbi5jdXJyZW50U2NyZWVuID0gc2NyZWVuO1xuICAgIFxuICAgIHJldHVybiBzY3JlZW47IFxufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLmNyZWF0ZUJhY2tncm91bmRTY3JlZW4gPSBmdW5jdGlvbihjaGFyYWN0ZXIsIGJhY2tncm91bmQpXG57XG4gICAgdmFyIHNjcmVlbiA9IG5ldyBCYWNrZ3JvdW5kU2NyZWVuKGNoYXJhY3RlciwgYmFja2dyb3VuZCk7XG4gICAgQ29tbW9uLnNjZW5lTWFuYWdlci5hZGQoc2NyZWVuLCB0aGlzLl9nZXRUcmFuc2l0aW9uKCkpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkTXVzaWNQbGF5LmFkZCh0aGlzLl9wbGF5TXVzaWMsIHRoaXMpO1xuICAgIFxuICAgIHNjcmVlbi5zaWduYWxzLm5leHQuYWRkT25jZShmdW5jdGlvbihuZXdCYWNrZ3JvdW5kKVxuICAgIHtcbiAgICAgICAgQ29tbW9uLmF1ZGlvLnBsYXlTb3VuZCgnc2Z4X2J0bl9hY2NlcHRfMDAnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVQaG90b1NjcmVlbihjaGFyYWN0ZXIsIG5ld0JhY2tncm91bmQpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMucHJldmlvdXMuYWRkT25jZShmdW5jdGlvbihpZClcbiAgICB7XG4gICAgICAgIENvbW1vbi5hdWRpby5wbGF5U291bmQoJ211c2ljX3Jlc3RhcnRfMDAnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVEcmVzc3VwU2NyZWVuKGNoYXJhY3Rlcik7XG4gICAgfSwgdGhpcyk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5ndWlDbGljay5hZGQoZnVuY3Rpb24oaWQpXG4gICAge1xuICAgICAgICBpZihpZCA9PSAncGF1c2UnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVBhdXNlT3ZlcmxheShzY3JlZW4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoaWQgPT0gJ2hvbWUnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVRpdGxlU2NyZWVuKCk7XG4gICAgICAgIH1cbiAgICB9LCB0aGlzKTtcbiAgICBcbiAgICBDb21tb24uY3VycmVudFNjcmVlbiA9IHNjcmVlbjtcbiAgICBcbiAgICByZXR1cm4gc2NyZWVuO1xufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLmNyZWF0ZVBob3RvU2NyZWVuID0gZnVuY3Rpb24oY2hhcmFjdGVyLCBiYWNrZ3JvdW5kKVxue1xuICAgIHZhciBzY3JlZW4gPSBuZXcgUGhvdG9TY3JlZW4oY2hhcmFjdGVyLCBiYWNrZ3JvdW5kKTtcbiAgICBDb21tb24uc2NlbmVNYW5hZ2VyLmFkZChzY3JlZW4sIHRoaXMuX2dldFRyYW5zaXRpb24oKSk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRNdXNpY1BsYXkuYWRkKHRoaXMuX3BsYXlNdXNpYywgdGhpcyk7XG4gICAgXG4gICAgc2NyZWVuLnNpZ25hbHMubmV4dC5hZGRPbmNlKGZ1bmN0aW9uKGlkKVxuICAgIHtcbiAgICAgICAgQ29tbW9uLmF1ZGlvLnBsYXlTb3VuZCgnc2Z4X2J0bl9yZXNldF8wMScpO1xuICAgICAgICB0aGlzLmNyZWF0ZURyZXNzdXBTY3JlZW4oKTtcbiAgICB9LCB0aGlzKTtcblxuICAgIHNjcmVlbi5zaWduYWxzLnByZXZpb3VzLmFkZE9uY2UoZnVuY3Rpb24oc3RhdGUpXG4gICAge1xuICAgICAgICBDb21tb24uYXVkaW8ucGxheVNvdW5kKCdtdXNpY19yZXN0YXJ0XzAwJyk7XG4gICAgICAgIHAzLmxvZyhzdGF0ZSk7XG4gICAgICAgIGlmKHN0YXRlID09ICdwaG90bycpXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUJhY2tncm91bmRTY3JlZW4oY2hhcmFjdGVyLCBiYWNrZ3JvdW5kKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhpcy5jcmVhdGVQaG90b1NjcmVlbihjaGFyYWN0ZXIsIGJhY2tncm91bmQpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMuZ3VpQ2xpY2suYWRkKGZ1bmN0aW9uKGlkKVxuICAgIHtcbiAgICAgICAgaWYoaWQgPT0gJ3BhdXNlJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVQYXVzZU92ZXJsYXkoc2NyZWVuKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGlkID09ICdob21lJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVUaXRsZVNjcmVlbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoaWQgPT0gJ3Jlc3RhcnQnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUJhY2tncm91bmRTY3JlZW4oY2hhcmFjdGVyKTtcbiAgICAgICAgfVxuICAgIH0sIHRoaXMpO1xuICAgIFxuICAgIENvbW1vbi5jdXJyZW50U2NyZWVuID0gc2NyZWVuO1xuICAgIFxuICAgIHJldHVybiBzY3JlZW47XG59O1xuXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuY3JlYXRlUGF1c2VPdmVybGF5ID0gZnVuY3Rpb24ocGFyZW50U2NyZWVuKVxue1xuICAgIGlmKHBhcmVudFNjcmVlbilcbiAgICB7XG4gICAgICAgIHBhcmVudFNjcmVlbi5oaWRlR1VJKCk7XG4gICAgfVxuXG4gICAgdmFyIHByZXZNdXNpYyA9IHRoaXMuX2N1cnJlbnRNdXNpYztcblxuICAgIHZhciBzY3JlZW4gPSBuZXcgUGF1c2VPdmVybGF5KCk7XG4gICAgQ29tbW9uLnNjZW5lTWFuYWdlci5hZGQoc2NyZWVuLCB0aGlzLl9nZXRCbGFua1RyYW5zaXRpb24oKSk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRNdXNpY1BsYXkuYWRkKHRoaXMuX3BsYXlNdXNpYywgdGhpcyk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5ndWlDbGljay5hZGQoZnVuY3Rpb24oaWQpXG4gICAge1xuICAgICAgICBpZihpZCA9PSAnaGVscCcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlSGVscE92ZXJsYXkoc2NyZWVuKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGlkID09ICdob21lJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVUaXRsZVNjcmVlbigpO1xuICAgICAgICB9XG4gICAgfSwgdGhpcyk7XG4gICAgXG4gICAgc2NyZWVuLnNpZ25hbHMubmV4dC5hZGRPbmNlKGZ1bmN0aW9uKGlkKVxuICAgIHtcbiAgICAgICAgQ29tbW9uLnNjZW5lTWFuYWdlci5yZW1vdmUoKTtcbiAgICAgICAgaWYocGFyZW50U2NyZWVuKVxuICAgICAgICB7XG4gICAgICAgICAgICBwYXJlbnRTY3JlZW4uc2hvd0dVSSgpO1xuICAgICAgICAgICAgdGhpcy5fcGxheU11c2ljKHByZXZNdXNpYyk7XG4gICAgICAgIH1cbiAgICB9LCB0aGlzKTtcblxuICAgIHNjcmVlbi5zaWduYWxzLnByZXZpb3VzLmFkZE9uY2UoZnVuY3Rpb24oaWQpXG4gICAge1xuXG4gICAgfSwgdGhpcyk7XG5cbiAgICByZXR1cm4gc2NyZWVuO1xufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLl9nZXRUcmFuc2l0aW9uID0gZnVuY3Rpb24oKVxue1xuICAgIHZhciB0cmFuc2l0aW9uID0gbmV3IHAzLlRyYW5zaXRpb24oKTtcbiAgICB0cmFuc2l0aW9uLndhaXQgICAgPSBmYWxzZTtcbiAgICB0cmFuc2l0aW9uLnB1c2ggICAgPSBmYWxzZTtcbiAgICB0cmFuc2l0aW9uLnJlcGxhY2UgPSB0cnVlO1xuICAgIFxuICAgIHJldHVybiB0cmFuc2l0aW9uO1xufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLl9nZXRCbGFua1RyYW5zaXRpb24gPSBmdW5jdGlvbigpXG57XG4gICAgdmFyIHQgPSBuZXcgcDMuVHJhbnNpdGlvbigpO1xuICAgIHQucmVwbGFjZSA9IGZhbHNlO1xuICAgIHQucHVzaCA9IHRydWU7XG5cbiAgICByZXR1cm4gdDtcbn07XG5cbkFwcGxpY2F0aW9uLnByb3RvdHlwZS5fZ2VuZXJhdGVUZXh0dXJlcyA9IGZ1bmN0aW9uKClcbntcbiAgICBmb3IodmFyIGkgaW4gQ29tbW9uLmNvbG91ckhleGVzKVxuICAgIHtcbiAgICAgICAgdmFyIGcgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgICBnLmJlZ2luRmlsbChDb21tb24uY29sb3VySGV4ZXNbaV0sIDEpO1xuICAgICAgICBnLmRyYXdSZWN0KDAsIDAsIDIsIDIpO1xuICAgICAgICB2YXIgdG1wID0gQ29tbW9uLnJlbmRlcmVyLmdlbmVyYXRlVGV4dHVyZShnKTtcbiAgICAgICAgZy5kZXN0cm95KCk7XG4gICAgICAgIGcgPSBudWxsO1xuICAgICAgICBDb21tb24uY29sb3Vyc1tpXSA9IHRtcDtcbiAgICB9XG5cbiAgICB2YXIgZ3JhcGhpYyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgZ3JhcGhpYy5iZWdpbkZpbGwoMHhGRkZGRkYpO1xuICAgIGdyYXBoaWMuZHJhd1JlY3QoMCwgMCwgMjAwLCAxMDApO1xuICAgIENvbW1vbi5wbGFjZUhvbGRlckJ1dHRvbkJveCA9IENvbW1vbi5yZW5kZXJlci5nZW5lcmF0ZVRleHR1cmUoZ3JhcGhpYyk7XG59O1xuXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuX3BsYXlNdXNpYyA9IGZ1bmN0aW9uKHRyYWNrKVxue1xuICAgIHZhciBwYXJhbXMgPSBuZXcgQXVkaW9QYXJhbXMoKTtcbiAgICBwYXJhbXMubG9vcCA9IHRydWU7XG4gICAgcGFyYW1zLmZhZGVJbiA9IDAuNTtcbiAgICBDb21tb24uYXVkaW8ucGxheU11c2ljKHRyYWNrLCBwYXJhbXMpO1xuICAgIHRoaXMuX2N1cnJlbnRNdXNpYyA9IHRyYWNrO1xufVxuIiwiXG5mdW5jdGlvbiBDb21tb24oKVxue1xufVxubW9kdWxlLmV4cG9ydHMgPSBDb21tb247XG5cbi8vU3RhZ2UgZGltZW5zaW9uc1xuQ29tbW9uLlNUQUdFX1dJRFRIID0gMTkwMDtcbkNvbW1vbi5TVEFHRV9IRUlHSFQgPSA3Njg7XG5cbi8vUElYSVxuQ29tbW9uLnZpZXcgPSBudWxsO1xuQ29tbW9uLnN0YWdlID0gbnVsbDtcbkNvbW1vbi5yZW5kZXJlciA9IG51bGw7XG5Db21tb24uaXNXZWJHTCA9IGZhbHNlO1xuXG4vL1BhdGhzXG5Db21tb24uZ2FtZURpciA9ICcnO1xuQ29tbW9uLnBhdGhzID0ge1xuXHRzY3JpcHRzICAgXHQ6ICdzY3JpcHRzLycsXG5cdGRhdGEgICAgICBcdDogJ2Fzc2V0cy9kYXRhLycsXG5cdGltYWdlcyAgICBcdDogJ2Fzc2V0cy9pbWFnZXMvJyxcblx0Zm9udHMgICAgIFx0OiAnYXNzZXRzL2ZvbnRzLycsXG5cdGF1ZGlvICAgICBcdDogJ2Fzc2V0cy9hdWRpby8nLFxuXHRwYXJ0aWNsZXMgXHQ6ICdhc3NldHMvcGFydGljbGVzLycsXG5cdHN5c3RlbSAgICBcdDogJ2Fzc2V0cy9pbWFnZXMvc3lzdGVtLycsXG5cdGxvY2FsaXNhdGlvbiA6ICdhc3NldHMvaW1hZ2VzL2xvY2FsaXNhdGlvbi8nXG59LFxuXG4vL1NjZW5lXG5Db21tb24uc2NlbmVNYW5hZ2VyID0gbnVsbDtcbkNvbW1vbi5jdXJyZW50U2NyZWVuID0gbnVsbDtcblxuLy9Db25maWdcbkNvbW1vbi5jb25maWcgPSBudWxsO1xuXG4vL0Fzc2V0c1xuQ29tbW9uLmFzc2V0cyA9IG51bGw7XG5cbi8vQXVkaW9cbkNvbW1vbi5hdWRpbyA9IG51bGw7XG5cbi8vTG9jYWxpc2F0aW9uXG5Db21tb24ubGFuZ3VhZ2UgPSBcImVuXCI7XG5cbi8vSW50ZXJhY3Rpb25cbkNvbW1vbi5pbnB1dCA9IG51bGw7XG5Db21tb24udG91Y2ggPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcbkNvbW1vbi50b3VjaGluZyA9IGZhbHNlO1xuXG4vL1RpbWVcbkNvbW1vbi5kZWx0YSA9IG51bGw7XG5Db21tb24uZnBzTWV0ZXIgPSBudWxsO1xuQ29tbW9uLkZQUyA9IDYwO1xuQ29tbW9uLmZyYW1lQ291bnQgPSAwO1xuQ29tbW9uLnBhdXNlZCA9IGZhbHNlO1xuXG4vL0FuaW1hdGlvblxuQ29tbW9uLmFuaW1hdG9yID0gbnVsbDtcblxuLy9QYXJ0aWNsZXNcbkNvbW1vbi5lbWl0dGVyID0gbnVsbDtcblxuLy9Db2xvdXJzXG5Db21tb24uY29sb3VySGV4ZXMgPSB7XG5cdGJsYWNrOjB4MDAwMDAwLFxuXHR3aGl0ZToweEZGRkZGRlxufVxuQ29tbW9uLmNvbG91cnMgPSB7fTtcblxuLy9QbGFjZWhvbGRlciBidXR0b25cbkNvbW1vbi5wbGFjZUhvbGRlckJ1dHRvbkJveCA9IG51bGw7XG5Db21tb24ucGxhY2VIb2xkZXJCdXR0b25JY29ucyA9IHt9O1xuXG4vL1BlcmZvcm1hbmNlXG5Db21tb24ubG93UGVyZm9ybWFuY2UgPSB0cnVlO1xuXG5cblxuLyogX19fR0FNRSBTUEVDSUZJQ19fXyAqL1xuXG5Db21tb24udHV0b3JpYWxTdGF0ZXNQYXNzZWQgPSB7Y2xvdGhlczpmYWxzZSwgc2Nyb2xsOmZhbHNlLCBjYXRlZ29yaWVzOmZhbHNlfTtcblxuQ29tbW9uLnNhdmVkRGF0YSA9IG51bGw7XG5cblxuXG4iLCJ2YXIgQXBwbGljYXRpb24gICAgICA9IHJlcXVpcmUoXCIuL0FwcGxpY2F0aW9uXCIpO1xyXG52YXIgQXVkaW9NYW5hZ2VyICAgICA9IHJlcXVpcmUoXCIuL2F1ZGlvL0F1ZGlvTWFuYWdlclwiKTtcclxudmFyIENvbW1vbiAgICAgICAgICAgPSByZXF1aXJlKCcuL0NvbW1vbicpO1xyXG52YXIgRW1pdHRlciAgICAgICAgICA9IHJlcXVpcmUoJy4vY29tbW9uL0VtaXR0ZXInKTtcclxudmFyIEZvbnRMb2FkZXIgICAgICAgPSByZXF1aXJlKCcuL2NvbW1vbi9Gb250TG9hZGVyJyk7XHJcbnZhciBJbnB1dCAgICAgICAgICAgID0gcmVxdWlyZSgnLi9jb21tb24vSW5wdXQnKTtcclxudmFyIFF1ZXVlQ2FsbHMgICAgICAgPSByZXF1aXJlKCcuL2NvbW1vbi9RdWV1ZUNhbGxzJyk7XHJcbnZhciBQcmVsb2FkZXJTY3JlZW4gID0gcmVxdWlyZShcIi4vc2NyZWVucy9QcmVsb2FkZXJTY3JlZW5cIik7XHJcbnZhciBTYXZlZERhdGEgICAgICAgID0gcmVxdWlyZShcIi4vU2F2ZWREYXRhXCIpO1xyXG4gICAgXHJcbmZ1bmN0aW9uIE1haW4od2lkdGgsIGhlaWdodCwgbGFuZ3VhZ2UpXHJcbntcclxuICAgIHRoaXMuX3dpZHRoICA9IHdpZHRoO1xyXG4gICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xyXG5cclxuICAgIHRoaXMuX2dhbWUgICA9IG51bGw7XHJcbiAgICB0aGlzLl9wcmVsb2FkZXIgID0gbnVsbDtcclxuICAgIHRoaXMuX2ZvbnRMb2FkZXIgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuX3NjYWxlID0gXCIxeFwiO1xyXG5cclxuICAgIENvbW1vbi5sYW5ndWFnZSA9IGxhbmd1YWdlO1xyXG59XHJcblxyXG5NYWluLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB2YXIgcGFyYW1zICAgICAgICAgICAgICA9IG5ldyBwMy5WaWV3UGFyYW1zKCk7XHJcbiAgICBwYXJhbXMud2lkdGggICAgICAgICAgICA9IHRoaXMuX3dpZHRoO1xyXG4gICAgcGFyYW1zLmhlaWdodCAgICAgICAgICAgPSB0aGlzLl9oZWlnaHQ7XHJcbiAgICBwYXJhbXMuaG9sZGVySWQgICAgICAgICA9ICdnYW1lJztcclxuICAgIHBhcmFtcy5yb3RhdGVJbWFnZVVybCAgID0gQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMubG9jYWxpc2F0aW9uICsgQ29tbW9uLmxhbmd1YWdlICsgJy9yb3RhdGVfc2NyZWVuXycgKyBDb21tb24ubGFuZ3VhZ2UgKyAnLmpwZyc7XHJcbiAgICBwYXJhbXMucm90YXRlSW1hZ2VDb2xvciA9ICcjMDAwMDAwJztcclxuXHJcbiAgICBQSVhJLnNldHRpbmdzLlJFVElOQV9QUkVGSVggPSAvXFxfKD89W15fXSokKSguKyl4LztcclxuXHJcbiAgICBwMy5EZXZpY2UuaW5pdCh3aW5kb3cuYm93c2VyKTtcclxuXHJcbiAgICBpZihwMy5EZXZpY2UuaXNNb2JpbGUpXHJcbiAgICB7XHJcbiAgICAgICAgcDMubG9nID0gZnVuY3Rpb24oKXt9O1xyXG4gICAgfVxyXG4gICAgdmFyIGlzSXBhZDIgPSAocDMuRGV2aWNlLmlzSU9TICYmIHAzLkRldmljZS5pc0lwYWQgJiYgd2luZG93LmRldmljZVBpeGVsUmF0aW8gPT09IDEpO1xyXG5cclxuICAgIGlmKHAzLkRldmljZS5pc0lwYWRNaW5pIHx8IHAzLkRldmljZS5pc0lwb2QgfHwgaXNJcGFkMiB8fCBcclxuICAgICAgIC9BbmRyb2lkIDQvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3NjYWxlID0gJzAuNXgnO1xyXG4gICAgICAgIENvbW1vbi5sb3dQZXJmb3JtYW5jZSA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgVHdlZW5NYXguZGVmYXVsdE92ZXJ3cml0ZSA9ICdub25lJztcclxuICAgIFR3ZWVuTWF4LnRpY2tlci5mcHMoQ29tbW9uLkZQUyk7XHJcbiAgICBcclxuICAgIENvbW1vbi52aWV3ID0gbmV3IHAzLlZpZXcocGFyYW1zKTtcclxuICAgIENvbW1vbi52aWV3LnNpZ25hbHMucmVhZHkuYWRkT25jZSh0aGlzLm9uVmlld1JlYWR5LCB0aGlzKTtcclxuXHJcbiAgICBDb21tb24udmlldy5zaWduYWxzLnJlc2l6ZS5hZGQodGhpcy5vbkNhbnZhc1Jlc2l6ZSwgdGhpcyk7XHJcbn07XHJcblxyXG5NYWluLnByb3RvdHlwZS5vblZpZXdSZWFkeSA9IGZ1bmN0aW9uKGNhbnZhcylcclxue1xyXG4gICAgdmFyIGlzS2luZGxlID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvS2luZGxlfFNpbGt8S0ZBLykgIT09IG51bGw7XHJcbiAgICBcclxuICAgIHZhciBvcHRpb25zID0ge1xyXG4gICAgICAgIHZpZXcgICAgICAgICAgICAgICAgICA6IGNhbnZhcyxcclxuICAgICAgICB0cmFuc3BhcmVudCAgICAgICAgICAgOiBpc0tpbmRsZSxcclxuICAgICAgICBhbnRpYWxpYXMgICAgICAgICAgICAgOiBmYWxzZSxcclxuICAgICAgICBwcmVzZXJ2ZURyYXdpbmdCdWZmZXIgOiBmYWxzZSxcclxuICAgICAgICByZXNvbHV0aW9uICAgICAgICAgICAgOiAxXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBDb21tb24uc3RhZ2UgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHJcbiAgICBpZih0aGlzLl9zaG91bGRGb3JjZUNhbnZhcygpKVxyXG4gICAge1xyXG4gICAgICAgIENvbW1vbi5yZW5kZXJlciA9IG5ldyBQSVhJLkNhbnZhc1JlbmRlcmVyKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQsIG9wdGlvbnMpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIENvbW1vbi5yZW5kZXJlciA9ICFwMy5EZXZpY2UuaXNDb2Nvb25KUyA/IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUElYSS5hdXRvRGV0ZWN0UmVuZGVyZXIodGhpcy5fd2lkdGgsIHRoaXMuX2hlaWdodCwgb3B0aW9ucylcclxuICAgICAgICAgICAgICAgICAgICAgIDogXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUElYSS5XZWJHTFJlbmRlcmVyKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQsIG9wdGlvbnMpO1xyXG4gICAgfSAgICAgICAgIFxyXG4gICAgXHJcbiAgICBDb21tb24uaXNXZWJHTCAgPSAoQ29tbW9uLnJlbmRlcmVyIGluc3RhbmNlb2YgUElYSS5XZWJHTFJlbmRlcmVyKTtcclxuICAgIFxyXG4gICAgaWYgKHAzLkRldmljZS5pc0NvY29vbkpTKVxyXG4gICAge1xyXG4gICAgICAgIENvbW1vbi5zdGFnZS5zY2FsZS54ID0gd2luZG93LmlubmVySGVpZ2h0IC8gdGhpcy5faGVpZ2h0O1xyXG4gICAgICAgIENvbW1vbi5zdGFnZS5zY2FsZS55ID0gd2luZG93LmlubmVySGVpZ2h0IC8gdGhpcy5faGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIENvbW1vbi5zY2VuZU1hbmFnZXIgPSBuZXcgcDMuU2NlbmVNYW5hZ2VyKCk7XHJcbiAgICBDb21tb24uc2NlbmVNYW5hZ2VyLnVwZGF0ZUFsbCA9IHRydWU7XHJcbiAgICBDb21tb24uc3RhZ2UuYWRkQ2hpbGQoQ29tbW9uLnNjZW5lTWFuYWdlci52aWV3KTtcclxuXHJcbiAgICBDb21tb24uYXNzZXRzICAgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XHJcbiAgICBDb21tb24uYXVkaW8gICAgPSBwMy5CdXR0b24uYXVkaW8gICA9IG5ldyBBdWRpb01hbmFnZXIoKTtcclxuXHJcbiAgICBDb21tb24uaW5wdXQgPSBuZXcgSW5wdXQoKTtcclxuICAgIENvbW1vbi5pbnB1dC5pbml0KENvbW1vbi5zdGFnZSwgY2FudmFzKTtcclxuXHJcbiAgICBDb21tb24uYW5pbWF0b3IgPSBuZXcgcDMuQW5pbWF0b3IoKTtcclxuICAgIENvbW1vbi5hbmltYXRvci5pbml0KCk7XHJcblxyXG4gICAgQ29tbW9uLnF1ZXVlQ2FsbHMgPSBuZXcgUXVldWVDYWxscygpO1xyXG5cclxuICAgIENvbW1vbi5lbWl0dGVyID0gRW1pdHRlcjtcclxuXHJcbiAgICBDb21tb24uc2F2ZWREYXRhID0gbmV3IFNhdmVkRGF0YSgpO1xyXG5cclxuICAgIGlmKENvbW1vbi5zYXZlZERhdGEuYWxsVHV0b3JpYWxzVmlld2VkKVxyXG4gICAge1xyXG4gICAgICAgIGZvcih2YXIgaSBpbiBDb21tb24udHV0b3JpYWxTdGF0ZXNQYXNzZWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBDb21tb24udHV0b3JpYWxTdGF0ZXNQYXNzZWRbaV0gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBQSVhJLnRpY2tlci5zaGFyZWQuYWRkKHRoaXMudXBkYXRlLCB0aGlzKTtcclxuICAgIFxyXG4gICAgdGhpcy5sb2FkUHJlbG9hZGVyKCk7XHJcblxyXG4gICAgd2luZG93LmRlbGF5ID0gZnVuY3Rpb24oY2FsbGJhY2ssIGRlbGF5LCBzY29wZSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gQ29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoY2FsbGJhY2ssIGRlbGF5LCBzY29wZSk7XHJcbiAgICB9O1xyXG4gICAgd2luZG93LmRlbGF5YXJnID0gZnVuY3Rpb24oY2FsbGJhY2ssIGFyZ3MsIGRlbGF5LCBzY29wZSlcclxuICAgIHtcclxuICAgICAgICBDb21tb24uYW5pbWF0b3Iuc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY2FsbGJhY2suY2FsbChzY29wZSwgYXJncyk7XHJcbiAgICAgICAgfSwgZGVsYXksIHRoaXMpO1xyXG4gICAgfTtcclxufVxyXG5cclxuTWFpbi5wcm90b3R5cGUub25Mb2FkaW5nUHJvZ3Jlc3MgPSBmdW5jdGlvbihldmVudClcclxue1xyXG4gICAgdGhpcy5fcHJlbG9hZGVyLmxvYWRlZCA9IGV2ZW50LnByb2dyZXNzO1xyXG59O1xyXG5cclxuTWFpbi5wcm90b3R5cGUub25Mb2FkaW5nQ29tcGxldGVkID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9wcmVsb2FkZXIubG9hZGVkUGVyY2VudGFnZSA9IDEwMDtcclxuICAgIHRoaXMuX3ByZWxvYWRlci5hbmltYXRlT3V0KG51bGwsIHRoaXMpO1xyXG4gICAgdGhpcy5fcHJlbG9hZGVyID0gbnVsbDtcclxuXHJcbiAgICBDb21tb24uYXNzZXRzLnNpZ25hbHMucHJvZ3Jlc3MucmVtb3ZlQWxsKCk7XHJcbiAgICBDb21tb24uYXNzZXRzLnNpZ25hbHMuY29tcGxldGUucmVtb3ZlQWxsKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ29uTG9hZGluZ0NvbXBsZXRlZCcsIHRoaXMuX2ZvbnRMb2FkZXIuaGFzTG9hZGVkKTtcclxuICAgIGlmKHRoaXMuX2ZvbnRMb2FkZXIuaGFzTG9hZGVkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuc3RhcnRHYW1lKCk7XHJcbiAgICB9IFxyXG59O1xyXG5cclxuTWFpbi5wcm90b3R5cGUub25Gb250TG9hZGVkID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBjb25zb2xlLmxvZygnb25Gb250TG9hZGVkJyk7XHJcbiAgICBpZih0aGlzLl9wcmVsb2FkZXIubG9hZGVkUGVyY2VudGFnZSA9PSAxMDApXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5zdGFydEdhbWUoKTtcclxuICAgIH1cclxufVxyXG5cclxuTWFpbi5wcm90b3R5cGUubG9hZFByZWxvYWRlciA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdmFyIGZpbGVzID0gW1xyXG4gICAgICAgIHsgbmFtZTogJ3ByZWxvYWRlcicsICAgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArICcxeC9wcmVsb2FkZXJfMXguanNvbicgfSxcclxuICAgICAgICB7IG5hbWU6ICdjbG90aGVzX2NvbmZpZycsICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5kYXRhICsgJ2Nsb3RoZXMuanNvbicgfSxcclxuICAgICAgICB7IG5hbWU6ICdzdHJpbmdzX2NvbmZpZycsICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuZGF0YSArICdzdHJpbmdzLmpzb24nIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnc3RyaW5nc19mb3JtYXR0aW5nX2NvbmZpZycsICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuZGF0YSArICdzdHJpbmdzX2Zvcm1hdHRpbmcuanNvbicgfVxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgaWYoZmlsZXMubGVuZ3RoID4gMClcclxuICAgIHtcclxuICAgICAgICBDb21tb24uYXNzZXRzLmFkZEZpbGVzKGZpbGVzKTtcclxuICAgICAgICBDb21tb24uYXNzZXRzLnNpZ25hbHMuY29tcGxldGUuYWRkT25jZSh0aGlzLmxvYWRBc3NldHMsIHRoaXMpO1xyXG4gICAgICAgIENvbW1vbi5hc3NldHMubG9hZCgpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMubG9hZEFzc2V0cygpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2ZvbnRMb2FkZXIgPSBuZXcgRm9udExvYWRlcignV2luZHNvciBFbG9uZ2F0ZWQnKTtcclxuICAgIHRoaXMuX2ZvbnRMb2FkZXIuc2lnbmFscy5sb2FkZWQuYWRkT25jZSh0aGlzLm9uRm9udExvYWRlZCwgdGhpcyk7XHJcbiAgICB0aGlzLl9mb250TG9hZGVyLmluaXQoKTtcclxufTtcclxuXHJcbk1haW4ucHJvdG90eXBlLmxvYWRBc3NldHMgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHZhciBmaWxlcyA9IFtcclxuICAgICAgICB7IG5hbWU6ICdkb3JvdGh5X2FuaW0nLCAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyAnc3BpbmUvZG9yb3RoeS5qc29uJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ2JnX2dhbWVfMDAxJywgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArIHRoaXMuX3NjYWxlICsgJy9iZ19nYW1lXzAwMV8nICsgdGhpcy5fc2NhbGUgKyAnLmpwZycgfSxcclxuICAgICAgICB7IG5hbWU6ICdiZ19nYW1lXzAwMicsICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyB0aGlzLl9zY2FsZSArICcvYmdfZ2FtZV8wMDJfJyArIHRoaXMuX3NjYWxlICsgJy5qcGcnIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnYmdfZ2FtZV8wMDMnLCAgICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuaW1hZ2VzICsgdGhpcy5fc2NhbGUgKyAnL2JnX2dhbWVfMDAzXycgKyB0aGlzLl9zY2FsZSArICcuanBnJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ2JnX2dhbWVfMDA0JywgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArIHRoaXMuX3NjYWxlICsgJy9iZ19nYW1lXzAwNF8nICsgdGhpcy5fc2NhbGUgKyAnLmpwZycgfSxcclxuICAgICAgICB7IG5hbWU6ICdiZ19nYW1lXzAwNScsICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyB0aGlzLl9zY2FsZSArICcvYmdfZ2FtZV8wMDVfJyArIHRoaXMuX3NjYWxlICsgJy5qcGcnIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnYmdfZ2FtZV8wMDYnLCAgICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuaW1hZ2VzICsgdGhpcy5fc2NhbGUgKyAnL2JnX2dhbWVfMDA2XycgKyB0aGlzLl9zY2FsZSArICcuanBnJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ2JnX2dhbWVfMDA3JywgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArIHRoaXMuX3NjYWxlICsgJy9iZ19nYW1lXzAwN18nICsgdGhpcy5fc2NhbGUgKyAnLmpwZycgfSxcclxuICAgICAgICB7IG5hbWU6ICdiZ19nYW1lXzAwOCcsICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyB0aGlzLl9zY2FsZSArICcvYmdfZ2FtZV8wMDhfJyArIHRoaXMuX3NjYWxlICsgJy5qcGcnIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnYmdfZ2FtZV8wMDknLCAgICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuaW1hZ2VzICsgdGhpcy5fc2NhbGUgKyAnL2JnX2dhbWVfMDA5XycgKyB0aGlzLl9zY2FsZSArICcuanBnJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ2JnX2dhbWVfMDEwJywgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArIHRoaXMuX3NjYWxlICsgJy9iZ19nYW1lXzAxMF8nICsgdGhpcy5fc2NhbGUgKyAnLmpwZycgfSxcclxuICAgICAgICB7IG5hbWU6ICdiZ19nYW1lXzAxMScsICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyB0aGlzLl9zY2FsZSArICcvYmdfZ2FtZV8wMTFfJyArIHRoaXMuX3NjYWxlICsgJy5qcGcnIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnYmdfZ2FtZV8wMTInLCAgICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuaW1hZ2VzICsgdGhpcy5fc2NhbGUgKyAnL2JnX2dhbWVfMDEyXycgKyB0aGlzLl9zY2FsZSArICcuanBnJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ2JnX2dhbWVfMDEzJywgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArIHRoaXMuX3NjYWxlICsgJy9iZ19nYW1lXzAxM18nICsgdGhpcy5fc2NhbGUgKyAnLmpwZycgfSxcclxuICAgICAgICB7IG5hbWU6ICdiZ19zcGxhc2gnLCAgICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyB0aGlzLl9zY2FsZSArICcvYmdfc3BsYXNoXycgKyB0aGlzLl9zY2FsZSArICcuanBnJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ2JnX3Bob3RvJywgICAgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArIHRoaXMuX3NjYWxlICsgJy9iZ19waG90b18nICsgdGhpcy5fc2NhbGUgKyAnLmpwZycgfSxcclxuICAgICAgICB7IG5hbWU6ICdidXR0b25zJywgICAgICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyB0aGlzLl9zY2FsZSArICcvYnV0dG9uc18nICsgdGhpcy5fc2NhbGUgKyAnLmpzb24nIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnY2xvdGhlcycsICAgICAgICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuaW1hZ2VzICsgdGhpcy5fc2NhbGUgKyAnL2Nsb3RoZXNfJyArIHRoaXMuX3NjYWxlICsgJy5qc29uJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ3Bvc2UnLCAgICAgICAgICAgICB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmltYWdlcyArIHRoaXMuX3NjYWxlICsgJy9wb3NlXycgKyB0aGlzLl9zY2FsZSArICcuanNvbicgfSxcclxuICAgICAgICB7IG5hbWU6ICd1aScsICAgICAgICAgICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyB0aGlzLl9zY2FsZSArICcvdWlfJyArIHRoaXMuX3NjYWxlICsgJy5qc29uJyB9LFxyXG5cclxuICAgICAgICB7IG5hbWU6ICd0aXRsZScsICAgICAgICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyAnbG9jYWxpc2F0aW9uLycgKyBDb21tb24ubGFuZ3VhZ2UgKyAnL3RpdGxlXycgKyBDb21tb24ubGFuZ3VhZ2UgKyAnLnBuZycgfSxcclxuICAgICAgICB7IG5hbWU6ICdwYXVzZWQnLCAgICAgICAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5pbWFnZXMgKyAnbG9jYWxpc2F0aW9uLycgKyBDb21tb24ubGFuZ3VhZ2UgKyAnL3BhdXNlZF8nICsgQ29tbW9uLmxhbmd1YWdlICsgJy5wbmcnIH0sXHJcbiAgICAgICAgeyBuYW1lOiAnYXJleW91c3VyZScsICAgICAgIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMuaW1hZ2VzICsgJ2xvY2FsaXNhdGlvbi8nICsgQ29tbW9uLmxhbmd1YWdlICsgJy9hcmV5b3VzdXJlXycgKyBDb21tb24ubGFuZ3VhZ2UgKyAnLnBuZycgfSxcclxuICAgICAgICB7IG5hbWU6ICd3aW5kc29yX2ZvbnQnLCAgICAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5mb250cyArICd3aW5kc29yXzQ1LnhtbCcgfSxcclxuICAgICAgICB7IG5hbWU6ICd3aW5kc29yX2FyX2ZvbnQnLCAgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5mb250cyArICd3aW5kc29yX2FyLnhtbCcgfSxcclxuICAgICAgICBcclxuICAgICAgICB7IG5hbWU6ICdwYXJ0aWNsZV9lbWl0dGVyX3N0YXJidXJzdF9vcmFuZ2VfMDAnLCB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLnBhcnRpY2xlcyArICdwYXJ0aWNsZV9lbWl0dGVyX3N0YXJidXJzdF9vcmFuZ2VfMDAuanNvbicgfSxcclxuICAgICAgICB7IG5hbWU6ICdwYXJ0aWNsZV9lbWl0dGVyX3N0YXJidXJzdF9waW5rXzAwJywgdXJsOiBDb21tb24uZ2FtZURpciArIENvbW1vbi5wYXRocy5wYXJ0aWNsZXMgKyAncGFydGljbGVfZW1pdHRlcl9zdGFyYnVyc3RfcGlua18wMC5qc29uJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ3BhcnRpY2xlX2VtaXR0ZXJfc3RhcmJ1cnN0X3llbGxvd18wMCcsIHVybDogQ29tbW9uLmdhbWVEaXIgKyBDb21tb24ucGF0aHMucGFydGljbGVzICsgJ3BhcnRpY2xlX2VtaXR0ZXJfc3RhcmJ1cnN0X3llbGxvd18wMC5qc29uJyB9LFxyXG4gICAgICAgIHsgbmFtZTogJ3BhcnRpY2xlX2VtaXR0ZXJfc3RhcmJ1cnN0X2JsdWVfMDAnLCB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLnBhcnRpY2xlcyArICdwYXJ0aWNsZV9lbWl0dGVyX3N0YXJidXJzdF9ibHVlXzAwLmpzb24nIH0sXHJcbiAgICAgICAgeyBuYW1lOiAncGFydGljbGVfZW1pdHRlcl9zdGFyYnVyc3RfZ3JlZW5fMDAnLCB1cmw6IENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLnBhcnRpY2xlcyArICdwYXJ0aWNsZV9lbWl0dGVyX3N0YXJidXJzdF9ncmVlbl8wMC5qc29uJyB9LFxyXG4gICAgXTtcclxuXHJcbiAgICB2YXIgc291bmRzID0gW1xyXG4gICAgICAgICdtdXNpY19hbWJpZW50X3dhcmRyb2JlX2xvb3BfMDAnLFxyXG4gICAgICAgICdtdXNpY19jYW1lcmFfbG9vcF8wMCcsXHJcbiAgICAgICAgJ211c2ljX2Rvcm90aHlfY29tcGxldGVfMDAnLFxyXG4gICAgICAgICdtdXNpY19saW9uX2NvbXBsZXRlXzAwJyxcclxuICAgICAgICAnbXVzaWNfbWVudV9sb29wXzAxJyxcclxuICAgICAgICAnbXVzaWNfcGF1c2VoZWxwX21lbnVfMDAnLFxyXG4gICAgICAgICdtdXNpY19yZXN0YXJ0XzAwJyxcclxuICAgICAgICAnbXVzaWNfc2NhcmVjcm93X2NvbXBsZXRlXzAwJyxcclxuICAgICAgICAnbXVzaWNfc3RhYl9jaGFuZ2VfcG9zZV8wMCcsXHJcbiAgICAgICAgJ211c2ljX3N0YWJfY2hhbmdlX3Bvc2VfMDEnLFxyXG4gICAgICAgICdtdXNpY19zdGFiX2NoYW5nZV9wb3NlXzAyJyxcclxuICAgICAgICAnbXVzaWNfc3RhYl9jaGFuZ2VfcG9zZV8wMycsXHJcbiAgICAgICAgJ211c2ljX3Rpbm1hbl9jb21wbGV0ZV8wMCcsXHJcbiAgICAgICAgJ211c2ljX3dpdGNoX2NvbXBsZXRlXzAwJyxcclxuICAgICAgICAnc2Z4X2FtYmllbnRfYmlyZHNvbmdfMDEnLFxyXG4gICAgICAgICdzZnhfYXR0YWNoX2l0ZW1fbGlvbl8wMCcsXHJcbiAgICAgICAgJ3NmeF9hdHRhY2hfaXRlbV9zY2FyZWNyb3dfMDAnLFxyXG4gICAgICAgICdzZnhfYXR0YWNoX2l0ZW1fdGlubWFuXzAwJyxcclxuICAgICAgICAnc2Z4X2JhY2tncm91bmRfc3dpcGVfMDAnLFxyXG4gICAgICAgICdzZnhfYnRuX2FjY2VwdF8wMCcsXHJcbiAgICAgICAgJ3NmeF9idG5fY2hhbmdlX2NhbWVyYV9wb3NlXzAwJyxcclxuICAgICAgICAnc2Z4X2J0bl9wbGF5X3N0YXJ0X2Rvb3JiZWxsXzAwJyxcclxuICAgICAgICAnc2Z4X2J0bl9yZXNldF8wMScsXHJcbiAgICAgICAgJ3NmeF9jb3N0dW1lX2FjY2VwdF8wMCcsXHJcbiAgICAgICAgJ3NmeF9kb3JvdGh5X2NsaWNrX2hlYWxzXzAwJyxcclxuICAgICAgICAnc2Z4X2Rvcm90aHlfZGlzYXBwZWFyXzAwJyxcclxuICAgICAgICAnc2Z4X2Rvcm90aHlfbGFuZF8wMCcsXHJcbiAgICAgICAgJ3NmeF9kb3JvdGh5X3NraWRfaW5fMDAnLFxyXG4gICAgICAgICdzZnhfbGlvbl9jb21wbGV0ZV8wMCcsXHJcbiAgICAgICAgJ3NmeF9tYWdpY19zcGFya2xlc18wMCcsXHJcbiAgICAgICAgJ3NmeF9vdXRmaXRfbm9tZV9raW5nX2NvbXBsZXRlXzAwJyxcclxuICAgICAgICAnc2Z4X291dGZpdF9xdWVlbl9jb21wbGV0ZV8wMCcsXHJcbiAgICAgICAgJ3NmeF9vdXRmaXRfc2NhcmVjcm93X2NvbXBsZXRlXzAwJyxcclxuICAgICAgICAnc2Z4X291dGZpdF90aW5tYW5fY29tcGxldGVfMDAnLFxyXG4gICAgICAgICdzZnhfb3V0Zml0X3dpdGNoX2NvbXBsZXRlXzAwJyxcclxuICAgICAgICAnc2Z4X3Njcm9sbF93YXJkcm9iZV9sb29wXzAxJyxcclxuICAgICAgICAnc2Z4X3N3aXRjaF9oYXRfMDAnLFxyXG4gICAgICAgICdzZnhfc3dpdGNoX3Nob2VzXzAwJyxcclxuICAgICAgICAnc2Z4X3N3aXRjaF90b3BfMDEnLFxyXG4gICAgICAgICdzZnhfc3dpdGNoX3Ryb3VzZXJzXzAxJyxcclxuICAgICAgICAnc2Z4X3Rha2VfZmluYWxfcGhvdG8nLFxyXG4gICAgICAgICdzZnhfdG90b19iYXJrXzAwJyxcclxuICAgICAgICAnc2Z4X3dhcmRyb2JlX2FwcGVhcl8wMCcsXHJcbiAgICAgICAgJ3NmeF93YXJkcm9iZV9jaGFuZ2VfZHJhd18wMSdcclxuICAgIF07XHJcblxyXG4gICAgQ29tbW9uLmNvbmZpZyA9IHt9O1xyXG4gICAgQ29tbW9uLmNvbmZpZy5jbG90aGVzID0gQ29tbW9uLmFzc2V0cy5nZXRKU09OKCdjbG90aGVzX2NvbmZpZycpO1xyXG4gICAgQ29tbW9uLmNvbmZpZy5zdHJpbmdzID0gQ29tbW9uLmFzc2V0cy5nZXRKU09OKCdzdHJpbmdzX2NvbmZpZycpO1xyXG4gICAgQ29tbW9uLmNvbmZpZy5zdHJpbmdzX2Zvcm1hdHRpbmcgPSBDb21tb24uYXNzZXRzLmdldEpTT04oJ3N0cmluZ3NfZm9ybWF0dGluZ19jb25maWcnKTtcclxuICAgIFxyXG4gICAgZm9yKHZhciBpIGluIENvbW1vbi5jb25maWcpXHJcbiAgICB7XHJcbiAgICAgICAgaWYoQ29tbW9uLmNvbmZpZ1tpXSA9PSBudWxsKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiQ09ORklHOiBcIiArIGkgKyBcIiBJUyBOVUxMXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsZXMubGVuZ3RoID4gMClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9wcmVsb2FkZXIgPSBuZXcgUHJlbG9hZGVyU2NyZWVuKCk7XHJcbiAgICAgICAgQ29tbW9uLnNjZW5lTWFuYWdlci5hZGQodGhpcy5fcHJlbG9hZGVyKTtcclxuICAgICAgICBcclxuICAgICAgICBDb21tb24uYXNzZXRzLmFkZEZpbGVzKGZpbGVzKTtcclxuICAgICAgICBDb21tb24uYXNzZXRzLnNpZ25hbHMucHJvZ3Jlc3MuYWRkKHRoaXMub25Mb2FkaW5nUHJvZ3Jlc3MsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX3ByZWxvYWRlci5zaWduYWxzLmxvYWRDb21wbGV0ZS5hZGRPbmNlKHRoaXMub25Mb2FkaW5nQ29tcGxldGVkLCB0aGlzKTtcclxuICAgICAgICBDb21tb24uYXNzZXRzLmxvYWQoKTtcclxuXHJcbiAgICAgICAgQ29tbW9uLmF1ZGlvLmFkZFNvdW5kcyhzb3VuZHMsIFsnLm9nZycsICcubXAzJywgJy5tNGEnXSwgIENvbW1vbi5nYW1lRGlyICsgQ29tbW9uLnBhdGhzLmF1ZGlvKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICB0aGlzLnN0YXJ0R2FtZSgpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuTWFpbi5wcm90b3R5cGUuc3RhcnRHYW1lID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBDb21tb24uYW5pbWF0b3Iuc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMuX2dhbWUgPSBuZXcgQXBwbGljYXRpb24oKTtcclxuICAgICAgICB0aGlzLl9nYW1lLmluaXQoKTtcclxuICAgIH0sIDEsIHRoaXMpO1xyXG59O1xyXG5cclxuTWFpbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oZGVsdGEpXHJcbntcclxuICAgIENvbW1vbi5kZWx0YSA9IGRlbHRhIC8gUElYSS5zZXR0aW5ncy5UQVJHRVRfRlBNUyAvIDEwMDA7XHJcbiAgICBwMy5UaW1lc3RlcC5kZWx0YVRpbWUgPSBDb21tb24uZGVsdGE7XHJcblxyXG4gICAgaWYgKCFDb21tb24udmlldy5pc0NvcnJlY3RPcmllbnRhdGlvbigpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIENvbW1vbi5mcmFtZUNvdW50Kys7XHJcbiAgICBDb21tb24uc2NlbmVNYW5hZ2VyLnVwZGF0ZSgpO1xyXG4gICAgQ29tbW9uLmFuaW1hdG9yLnVwZGF0ZSgpO1xyXG4gICAgQ29tbW9uLnF1ZXVlQ2FsbHMudXBkYXRlKCk7XHJcblxyXG4gICAgQ29tbW9uLnJlbmRlcmVyLnJlbmRlcihDb21tb24uc3RhZ2UpO1xyXG59O1xyXG5cclxuTWFpbi5wcm90b3R5cGUub25DYW52YXNSZXNpemUgPSBmdW5jdGlvbihjb3JyZWN0KVxyXG57XHJcbiAgICBpZiAoY29ycmVjdClcclxuICAgIHtcclxuICAgICAgICBDb21tb24ucmVuZGVyZXIucmVzaXplKHAzLlZpZXcud2lkdGgsIHAzLlZpZXcuaGVpZ2h0KTtcclxuICAgICAgICBpZiAoQ29tbW9uLnNjZW5lTWFuYWdlcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIENvbW1vbi5zY2VuZU1hbmFnZXIucmVzaXplKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuTWFpbi5wcm90b3R5cGUuX3Nob3VsZEZvcmNlQ2FudmFzID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB2YXIgYW5kcm9pZFZlcnNpb24gPSAtMTtcclxuXHJcbiAgICB2YXIgdWEgPSAodWEgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudCkudG9Mb3dlckNhc2UoKTsgXHJcbiAgICB2YXIgbWF0Y2ggPSB1YS5tYXRjaCgvYW5kcm9pZFxccyhbMC05XFwuXSopLyk7XHJcbiAgICBpZihtYXRjaCkgXHJcbiAgICB7XHJcbiAgICAgICAgYW5kcm9pZFZlcnNpb24gPSBwYXJzZUZsb2F0KG1hdGNoWzFdKTtcclxuICAgIH1cclxuICAgICBcclxuICAgIHZhciBpc0FuZHJvaWQgPSAoIGFuZHJvaWRWZXJzaW9uID4tMSApID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgdmFyIGxlbm92b1JlcyA9ICh3aW5kb3cuc2NyZWVuLndpZHRoIC8gd2luZG93LnNjcmVlbi5oZWlnaHQgPT0gMTAyNCAvIDYwMCApIDtcclxuICAgICBcclxuICAgIC8vIFRhYiAyXHJcbiAgICAvLyBNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNC40LjI7IExlbm92byBUQUIgMiBBNy0zMEYgQnVpbGQvS09UNDlIKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNDUuMC4yNDU0Ljg0IFNhZmFyaS81MzcuMzZcclxuICAgICBcclxuICAgIC8vIFRhYiAzIC0gZnJvbSB3ZWJcclxuICAgIC8vIE1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA2LjAuMTsgTGVub3ZvIFRCLTg3MDNGIEJ1aWxkL01NQjI5TSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzU2LjAuMjkyNC44NyBTYWZhcmkvNTM3LjM2XHJcbiAgICAgXHJcbiAgICAvLyBUYWIgMyAtIGZyb20gVGVzdG9sb2d5XHJcbiAgICAvLyBNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNS4wLjE7IExlbm92byBUQjMtNzEwRiBCdWlsZC9MUlgyMU0pXHJcbiAgICAgXHJcbiAgICByZXR1cm4gaXNBbmRyb2lkICYmIGxlbm92b1JlcyAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0xlbm92bycpID4gLTE7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTWFpbjsiLCJcclxudmFyIENvbW1vbiAgICAgICAgICA9IHJlcXVpcmUoXCIuL0NvbW1vblwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5mdW5jdGlvbiBTYXZlZERhdGEoKVxyXG57XHJcbiAgICB0aGlzLlNBVkVfTkFNRSA9IFwib3pfZHJlc3N1cFwiO1xyXG4gICAgdGhpcy5TQVZFX1ZFUlNJT04gPSBcIjAuMC41XCI7IC8vcmVtZW1iZXIgdG8gdXBkYXRlIHRoaXMgaW4gaW1hZ2UuaHRtbCFcclxuICAgIHRoaXMuU0FWRV9TRUVEID0gXCJ4NWswRW82UjE3N21Va2JcIjtcclxuXHJcbiAgICB0aGlzLmFsbFR1dG9yaWFsc1ZpZXdlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5leHBvcnRlZEltYWdlID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLmluaXQoKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IFNhdmVkRGF0YTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5TYXZlZERhdGEucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGlmICghd2luZG93LmxvY2FsU3RvcmFnZVt0aGlzLlNBVkVfTkFNRSArIFwiX1wiICsgdGhpcy5TQVZFX1ZFUlNJT05dKVxyXG4gICAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdyZXNldCcpO1xyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgICAgICB0aGlzLnNhdmUoKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnbG9hZCcpOyAgICBcclxuICAgICAgICB0aGlzLmxvYWQoKTtcclxuICAgIH1cclxuXHJcbn07XHJcblxyXG5TYXZlZERhdGEucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLmFsbFR1dG9yaWFsc1ZpZXdlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5leHBvcnRlZEltYWdlID0gbnVsbDtcclxufTtcclxuXHJcblxyXG5TYXZlZERhdGEucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHZhciBkYXRhID0gd2luZG93LmxvY2FsU3RvcmFnZVt0aGlzLlNBVkVfTkFNRSArIFwiX1wiICsgdGhpcy5TQVZFX1ZFUlNJT05dO1xyXG4gICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XHJcblxyXG4gICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeShcclxuICAgIHtcclxuICAgICAgICBhbGxUdXRvcmlhbHNWaWV3ZWQ6IGRhdGEuYWxsVHV0b3JpYWxzVmlld2VkLFxyXG4gICAgICAgIGV4cG9ydGVkSW1hZ2U6IGRhdGEuZXhwb3J0ZWRJbWFnZVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGhhc2ggPSBtZDUoanNvbiArIHRoaXMuU0FWRV9TRUVEKTtcclxuICAgIGlmIChoYXNoICE9IGRhdGEuaGFzaClcclxuICAgIHtcclxuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5TQVZFX05BTUUgKyBcIl9cIiArIHRoaXMuU0FWRV9WRVJTSU9OKTtcclxuICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICB0aGlzLmFsbFR1dG9yaWFsc1ZpZXdlZCA9IGRhdGEuYWxsVHV0b3JpYWxzVmlld2VkO1xyXG4gICAgICAgIHRoaXMuZXhwb3J0ZWRJbWFnZSA9IGRhdGEuZXhwb3J0ZWRJbWFnZTsgXHJcbiAgICB9XHJcbn07XHJcblxyXG5TYXZlZERhdGEucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGNvbnNvbGUubG9nKCdzYXZlJyk7XHJcbiAgICB2YXIgZGF0YSA9IHt9O1xyXG4gICAgZGF0YS5hbGxUdXRvcmlhbHNWaWV3ZWQgPSB0aGlzLmFsbFR1dG9yaWFsc1ZpZXdlZDtcclxuICAgIGRhdGEuZXhwb3J0ZWRJbWFnZSA9IHRoaXMuZXhwb3J0ZWRJbWFnZTtcclxuICAgIFxyXG4gICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuICAgIGRhdGEuaGFzaCA9IG1kNShqc29uICsgdGhpcy5TQVZFX1NFRUQpO1xyXG5cclxuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2VbdGhpcy5TQVZFX05BTUUgKyBcIl9cIiArIHRoaXMuU0FWRV9WRVJTSU9OXSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOyAgICBcclxufTtcclxuXHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iLCIvKipcclxuICogIEF1ZGlvXHJcbiAqXHJcbiAqICBDcmVhdGVkIGJ5IExlZ21hbiBvbiAxMi8wOS8yMDE2LlxyXG4gKlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIEF1ZGlvKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxyXG4gICAgICovXHJcbiAgICB0aGlzLmlkID0gLTE7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7SG93bH1cclxuICAgICAqL1xyXG4gICAgdGhpcy5ob3dsID0gbnVsbDtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IEF1ZGlvO1xyXG5cclxuQXVkaW8ucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuaG93bC5zdG9wKHRoaXMuaWQpO1xyXG59O1xyXG4iLCIvKipcbiAqICBBdWRpb01hbmFnZXJcbiAqXG4gKiAgQ3JlYXRlZCBieSBMZWdtYW4gb24gMjUvMDIvMjAxNi5cbiAqXG4gKi9cblxudmFyIEF1ZGlvICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcIi4vQXVkaW9cIik7XG52YXIgQXVkaW9QYXJhbXMgICAgICAgICAgICAgPSByZXF1aXJlKFwiLi9BdWRpb1BhcmFtc1wiKTtcblxuZnVuY3Rpb24gQXVkaW9NYW5hZ2VyKCkge1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLl9jYWNoZSA9IHt9O1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge0hvd2x9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLl9tdXNpYyA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuX2lzTXV0ZWQgPSBmYWxzZTtcblxuICAgIHZhciBoaWRkZW47XG4gICAgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZG9jdW1lbnQuaGlkZGVuID8gKGhpZGRlbiA9IFwiaGlkZGVuXCIsXG4gICAgICAgIHRoaXMudmlzaWJpbGl0eUNoYW5nZSA9IFwidmlzaWJpbGl0eWNoYW5nZVwiKSAgICAgOiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBkb2N1bWVudC5tb3pIaWRkZW4gID8gKGhpZGRlbiA9IFwibW96SGlkZGVuXCIsXG4gICAgICAgIHRoaXMudmlzaWJpbGl0eUNoYW5nZSA9IFwibW96dmlzaWJpbGl0eWNoYW5nZVwiKSAgOiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBkb2N1bWVudC5tc0hpZGRlbiAgID8gKGhpZGRlbiA9IFwibXNIaWRkZW5cIixcbiAgICAgICAgdGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gXCJtc3Zpc2liaWxpdHljaGFuZ2VcIikgICA6IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGRvY3VtZW50LndlYmtpdEhpZGRlbiAmJiAoaGlkZGVuID0gXCJ3ZWJraXRIaWRkZW5cIixcbiAgICAgICAgdGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gXCJ3ZWJraXR2aXNpYmlsaXR5Y2hhbmdlXCIpO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnZpc2liaWxpdHlDaGFuZ2UsIGZ1bmN0aW9uKCl7XG4gICAgICAgIGRvY3VtZW50W2hpZGRlbl0gPyBIb3dsZXIudm9sdW1lKDApIDogSG93bGVyLnZvbHVtZSgxKTtcbiAgICB9LCBmYWxzZSk7XG5cbn1cbm1vZHVsZS5leHBvcnRzID0gQXVkaW9NYW5hZ2VyO1xuXG4vKipcbiAqIEBwYXJhbSB7IUFycmF5LjxzdHJpbmc+fSBzb3VuZHNcbiAqIEBwYXJhbSB7IUFycmF5LjxzdHJpbmc+fSBleHRlbnNpb25zXG4gKiBAcGFyYW0ge3N0cmluZz19IGJhc2VQYXRoXG4gKi9cbkF1ZGlvTWFuYWdlci5wcm90b3R5cGUuYWRkU291bmRzID0gZnVuY3Rpb24oc291bmRzLCBleHRlbnNpb25zLCBiYXNlUGF0aCkge1xuICAgIGJhc2VQYXRoID0gYmFzZVBhdGggfHwgXCJcIjtcblxuICAgIHZhciBob3dsLCBuYW1lLCB1cmwsIHVybHMsIGV4dGVuc2lvbiwgaSwgajtcbiAgICBmb3IgKGkgPSAwOyBpIDwgc291bmRzLmxlbmd0aDsgKysgaSkge1xuICAgICAgICB1cmwgICAgID0gYmFzZVBhdGggKyBzb3VuZHNbaV07XG4gICAgICAgIHVybCAgICAgPSB1cmwuc3BsaXQoXCIvXCIpO1xuICAgICAgICBuYW1lICAgID0gdXJsW3VybC5sZW5ndGggLSAxXTtcblxuICAgICAgICB1cmxzID0gW107XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBleHRlbnNpb25zLmxlbmd0aDsgKysgaikge1xuICAgICAgICAgICAgZXh0ZW5zaW9uID0gZXh0ZW5zaW9uc1tqXTtcbiAgICAgICAgICAgIHVybHMucHVzaCh1cmwuam9pbihcIi9cIikgKyBleHRlbnNpb24pO1xuICAgICAgICB9XG4gICAgICAgIGhvd2wgPSBuZXcgSG93bCh7XG4gICAgICAgICAgICBzcmM6IHVybHMsXG4gICAgICAgICAgICB2b2x1bWU6IDEuMCxcbiAgICAgICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICBob3dsLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLl9jYWNoZVtuYW1lXSA9IGhvd2w7XG4gICAgfVxufTtcblxuLyoqXG4gKiBAcGFyYW0geyFBcnJheS48c3RyaW5nPn0gbmFtZVxuICogQHBhcmFtIHshQXJyYXkuPHN0cmluZz59IHNwcml0ZVxuICogQHBhcmFtIHshQXJyYXkuPHN0cmluZz59IGV4dGVuc2lvbnNcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYmFzZVBhdGhcbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5hZGRTb3VuZFNwcml0ZSA9IGZ1bmN0aW9uKG5hbWUsIHNwcml0ZSwgZXh0ZW5zaW9ucywgYmFzZVBhdGgpIHtcbiAgICBiYXNlUGF0aCA9IGJhc2VQYXRoIHx8IFwiXCI7XG5cbiAgICB2YXIgZXh0ZW5zaW9uO1xuXG4gICAgdmFyIHVybCA9IGJhc2VQYXRoICsgbmFtZTtcbiAgICB1cmwgPSB1cmwuc3BsaXQoXCIvXCIpO1xuXG4gICAgdmFyIHVybHMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4dGVuc2lvbnMubGVuZ3RoOyArKyBpKSB7XG4gICAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnNbaV07XG4gICAgICAgIHVybHMucHVzaCh1cmwuam9pbihcIi9cIikgKyBleHRlbnNpb24pO1xuICAgIH1cblxuICAgIHZhciBob3dsID0gbmV3IEhvd2woe1xuICAgICAgICBzcmM6IHVybHMsXG4gICAgICAgIHNwcml0ZTogc3ByaXRlLFxuICAgICAgICB2b2x1bWU6IDEsXG4gICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICBhdXRvcGxheTogZmFsc2VcbiAgICB9KTtcbiAgICBmb3IgKHZhciBrZXkgaW4gc3ByaXRlKSB7XG4gICAgICAgIGlmIChzcHJpdGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgdGhpcy5fY2FjaGVba2V5XSA9IGhvd2w7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7IUFycmF5LjxzdHJpbmc+fSBzb3VuZHNcbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5yZW1vdmVTb3VuZHMgPSBmdW5jdGlvbihzb3VuZHMpIHtcbiAgICB2YXIgbmFtZSwgbiwgaG93bDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvdW5kcy5sZW5ndGg7ICsrIGkpIHtcbiAgICAgICAgbmFtZSA9IHNvdW5kc1tpXTtcbiAgICAgICAgZm9yIChuIGluIHRoaXMuX2NhY2hlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY2FjaGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIGhvd2wgPSB0aGlzLl9jYWNoZVtrZXldO1xuICAgICAgICAgICAgICAgIGlmIChob3dsLm5hbWUgPT0gbikge1xuICAgICAgICAgICAgICAgICAgICBob3dsLnVubG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fY2FjaGVbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHshc3RyaW5nIHwgQXJyYXkuPHN0cmluZz59IG5hbWVcbiAqIEBwYXJhbSB7QXVkaW9QYXJhbXM9fSBwYXJhbXNcbiAqIEByZXR1cm5zIHtBdWRpb31cbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5wbGF5U291bmQgPSBmdW5jdGlvbihuYW1lLCBwYXJhbXMpIHtcblxuICAgIHBhcmFtcyA9IHBhcmFtcyB8fCBuZXcgQXVkaW9QYXJhbXMoKTtcblxuICAgIHZhciBpZCA9IC0xO1xuXG4gICAgaWYgKHR5cGVvZiBuYW1lICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG5hbWUgPSBuYW1lW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG5hbWUubGVuZ3RoKV07XG4gICAgfVxuXG4gICAgdmFyIGhvd2wgPSB0aGlzLl9jYWNoZVtuYW1lXTtcbiAgICBpZiAoIWhvd2wpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiQ291bGQgbm90IGZpbmQgc291bmQgLSBcIiArIG5hbWUpO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgfVxuXG4gICAgaWQgPSBob3dsLnBsYXkoKTsvL2hvd2wuX3Nwcml0ZSA/IG5hbWUgOiAwKTtcbiAgICBob3dsLnZvbHVtZShwYXJhbXMudm9sdW1lLCBpZCk7XG4gICAgaG93bC5sb29wKHBhcmFtcy5sb29wLCBpZCk7XG5cbiAgICB2YXIgYXVkaW8gPSBuZXcgQXVkaW8oKTtcbiAgICBhdWRpby5pZCA9IGlkO1xuICAgIGF1ZGlvLmhvd2wgPSBob3dsO1xuICAgIHJldHVybiBhdWRpbztcbn07XG5cbi8qKlxuICogQHBhcmFtIHshc3RyaW5nIHwgQXJyYXkuPHN0cmluZz59IG5hbWVcbiAqIEBwYXJhbSB7QXVkaW9QYXJhbXM9fSBwYXJhbXNcbiAqIEByZXR1cm5zIHtBdWRpb31cbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5wbGF5TXVzaWMgPSBmdW5jdGlvbihuYW1lLCBwYXJhbXMpIHtcbiAgICBwYXJhbXMgPSBwYXJhbXMgfHwgbmV3IEF1ZGlvUGFyYW1zKCk7XG5cbiAgICB2YXIgaWQgPSAtMTtcblxuICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBuYW1lID0gbmFtZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuYW1lLmxlbmd0aCldO1xuICAgIH1cblxuICAgIC8vIHNraXAgaWYgbm8gY2hhbmdlXG4gICAgaWYgKHRoaXMuX211c2ljICYmIHRoaXMuX211c2ljLmhvd2wubmFtZSA9PSBuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tdXNpYztcbiAgICB9XG5cbiAgICB2YXIgaG93bCA9IHRoaXMuX2NhY2hlW25hbWVdO1xuICAgIGlmICghaG93bCkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgZmluZCBtdXNpYyAtIFwiICsgbmFtZSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIGNhbGxiYWNrXG4gICAgaG93bC5fX29uZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHBhcmFtcy5jYWxsYmFjayAmJiBwYXJhbXMuY2FsbGJhY2suY2FsbChwYXJhbXMuc2NvcGUpO1xuICAgIH07XG4gICAgaG93bC5vbihcImVuZFwiLCBob3dsLl9fb25lbmQpO1xuXG4gICAgaWYgKHAzLkRldmljZSAmJiBwMy5EZXZpY2UuaXNBbmRyb2lkU3RvY2tCcm93c2VyKSB7XG4gICAgICAgIGhvd2wuYnVmZmVyID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZCA9IGhvd2wucGxheSgpO1xuICAgIGhvd2wudm9sdW1lKHBhcmFtcy52b2x1bWUsIGlkKTtcbiAgICBob3dsLmxvb3AodHJ1ZSwgaWQpO1xuXG4gICAgdmFyIGF1ZGlvID0gbmV3IEF1ZGlvKCk7XG4gICAgYXVkaW8uaWQgPSBpZDtcbiAgICBhdWRpby5ob3dsID0gaG93bDtcblxuICAgIGlmIChwYXJhbXMuZmFkZUluID4gMC4wKSB7XG4gICAgICAgIGlmICh0aGlzLl9tdXNpYykge1xuICAgICAgICAgICAgdGhpcy5mYWRlT3V0KHRoaXMuX211c2ljLCBwYXJhbXMuZmFkZUluKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZhZGVJbihhdWRpbywgcGFyYW1zLmZhZGVJbik7XG4gICAgfVxuXG4gICAgdGhpcy5fbXVzaWMgPSBhdWRpbztcbiAgICByZXR1cm4gYXVkaW87XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7IXN0cmluZ30gbmFtZVxuICogQHBhcmFtIHtudW1iZXI9fSBpZFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zdG9wU291bmQgPSBmdW5jdGlvbihuYW1lLCBpZCkge1xuICAgIHZhciBob3dsID0gdGhpcy5fY2FjaGVbbmFtZV07XG4gICAgIWhvd2wgJiYgY29uc29sZS53YXJuKFwiQ291bGQgbm90IGZpbmQgc291bmQgLSBcIiArIG5hbWUpO1xuICAgIGhvd2wuc3RvcChpZCk7XG5cbiAgICBjb25zb2xlLndhcm4oXCInQXVkaW9NYW5hZ2VyLnN0b3BTb3VuZCgpJyBpcyBkZXByZWNhdGVkLiBVc2UgJ0F1ZGlvLnN0b3AoKScgaW5zdGVhZC5cIilcbn07XG5cbkF1ZGlvTWFuYWdlci5wcm90b3R5cGUuc3RvcE11c2ljID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX211c2ljKSB7XG4gICAgICAgIHRoaXMuX211c2ljLmhvd2wuX19vbmVuZCAmJiB0aGlzLl9tdXNpYy5ob3dsLm9mZihcImVuZFwiLCB0aGlzLl9tdXNpYy5ob3dsLl9fb25lbmQpO1xuICAgICAgICB0aGlzLl9tdXNpYy5ob3dsLnN0b3AoKTtcbiAgICAgICAgdGhpcy5fbXVzaWMgPSBudWxsO1xuICAgIH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHshYm9vbGVhbn0gdmFsdWVcbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5tdXRlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICB0aGlzLl9pc011dGVkID0gdmFsdWU7XG4gICAgaWYgKHRoaXMuX2lzTXV0ZWQpIHtcbiAgICAgICAgSG93bGVyLm11dGUodHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgSG93bGVyLm11dGUoZmFsc2UpO1xuICAgIH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHshQXVkaW99IGF1ZGlvXG4gKiBAcGFyYW0ge251bWJlcj19IGR1cmF0aW9uXG4gKiBAcGFyYW0ge2Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19IHNjb3BlXG4gKi9cbkF1ZGlvTWFuYWdlci5wcm90b3R5cGUuZmFkZUluID0gZnVuY3Rpb24oYXVkaW8sIGR1cmF0aW9uLCBjYWxsYmFjaywgc2NvcGUpIHtcbiAgICBkdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDEuMDtcblxuICAgIHZhciB2b2x1bWUgPSBhdWRpby5ob3dsLnZvbHVtZShhdWRpby5pZCk7XG4gICAgYXVkaW8uaG93bC52b2x1bWUoMC4wLCBhdWRpby5pZCk7XG4gICAgYXVkaW8uX192b2x1bWUgPSAwLjA7XG5cbiAgICBUd2Vlbk1heC5raWxsVHdlZW5zT2YoYXVkaW8pO1xuICAgIFR3ZWVuTWF4LnRvKGF1ZGlvLCBkdXJhdGlvbiwge1xuICAgICAgICBfX3ZvbHVtZTogdm9sdW1lLFxuICAgICAgICBlYXNlOiBQb3dlcjEuZWFzZUluT3V0LFxuICAgICAgICBvblVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBhdWRpby5ob3dsLnZvbHVtZShhdWRpby5fX3ZvbHVtZSwgYXVkaW8uaWQpO1xuICAgICAgICB9LFxuICAgICAgICBvblVwZGF0ZVNjb3BlOiB0aGlzLFxuICAgICAgICBvbkNvbXBsZXRlOiBjYWxsYmFjayxcbiAgICAgICAgb25Db21wbGV0ZVBhcmFtczogW2F1ZGlvXSxcbiAgICAgICAgb25Db21wbGV0ZVNjb3BlOiBzY29wZVxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBAcGFyYW0geyFBdWRpb30gYXVkaW9cbiAqIEBwYXJhbSB7bnVtYmVyPX0gZHVyYXRpb25cbiAqIEBwYXJhbSB7ZnVuY3Rpb249fSBjYWxsYmFja1xuICogQHBhcmFtIHsqPX0gc2NvcGVcbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5mYWRlT3V0ID0gZnVuY3Rpb24oYXVkaW8sIGR1cmF0aW9uLCBjYWxsYmFjaywgc2NvcGUpIHtcbiAgICBkdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDEuMDtcblxuICAgIGF1ZGlvLl9fdm9sdW1lID0gYXVkaW8uaG93bC52b2x1bWUoYXVkaW8uaWQpO1xuXG4gICAgVHdlZW5NYXgua2lsbFR3ZWVuc09mKGF1ZGlvKTtcbiAgICBUd2Vlbk1heC50byhhdWRpbywgZHVyYXRpb24sIHtcbiAgICAgICAgX192b2x1bWU6IDAuMCxcbiAgICAgICAgZWFzZTogUG93ZXIxLmVhc2VJbk91dCxcbiAgICAgICAgb25VcGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYXVkaW8uaG93bC52b2x1bWUoYXVkaW8uX192b2x1bWUsIGF1ZGlvLmlkKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25VcGRhdGVTY29wZTogdGhpcyxcbiAgICAgICAgb25Db21wbGV0ZTogY2FsbGJhY2ssXG4gICAgICAgIG9uQ29tcGxldGVQYXJhbXM6IFthdWRpb10sXG4gICAgICAgIG9uQ29tcGxldGVTY29wZTogc2NvcGVcbiAgICB9KTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHshQXVkaW99IGF1ZGlvXG4gKiBAcGFyYW0geyEqfSBvYmplY3RcbiAqIEBwYXJhbSB7IUNhbWVyYX0gY2FtZXJhXG4gKiBAcGFyYW0ge251bWJlcj19IG1pblxuICogQHBhcmFtIHtudW1iZXI9fSBtYXhcbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zZXRBdWRpb1BvczNEID0gZnVuY3Rpb24oYXVkaW8sIG9iamVjdCwgY2FtZXJhLCBtaW4sIG1heCkge1xuICAgIGlmIChwMy5EZXZpY2UuaXNNb2JpbGUgfHwgIXAzLkRldmljZS5ib3dzZXJbXCJjaHJvbWVcIl0pIHJldHVybjtcblxuICAgIG1pbiA9IG1pbiB8fCAwLjA7XG4gICAgbWF4ID0gbWF4IHx8IDMyMC4wO1xuXG4gICAgdmFyIGxheWVyID0gY2FtZXJhLmZpbmRMYXllckZvck9iamVjdChvYmplY3QpO1xuICAgIHZhciB4ID0gb2JqZWN0LnggKiAoMS4wIC8gbGF5ZXIucGFyYWxsYXgueCk7XG4gICAgdmFyIHNpZ24gPSAoeCAtIGNhbWVyYS5wb3NpdGlvbi54KTtcbiAgICBzaWduID0gc2lnbiAvIE1hdGguYWJzKHNpZ24pO1xuXG4gICAgaWYgKHNpZ24gPT0gLTEpIHggPSBNYXRoLm1pbigwLjAsICgoeCArIG1pbikgLSBjYW1lcmEucG9zaXRpb24ueCkgLyAobWF4IC0gbWluKSk7XG4gICAgZWxzZSBpZiAoc2lnbiA9PSAxKSB4ID0gTWF0aC5tYXgoMC4wLCAoKHggLSBtaW4pIC0gY2FtZXJhLnBvc2l0aW9uLngpIC8gKG1heCAtIG1pbikpO1xuXG4gICAgYXVkaW8uaG93bC5wb3MoeCwgMC4wLCAwLjAsIGF1ZGlvLmlkKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtBdWRpb30gYXVkaW9cbiAqIEBwYXJhbSB7Kn0gb2JqZWN0XG4gKiBAcGFyYW0ge0NhbWVyYX0gY2FtZXJhXG4gKiBAcGFyYW0geyFudW1iZXJ9IFttaW5dXG4gKiBAcGFyYW0geyFudW1iZXJ9IFttYXhdXG4gKiBAcGFyYW0geyFudW1iZXJ9IFtvZmZzZXRdXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtmYWxsYmFja11cbiAqL1xuQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zZXRBdWRpb1Bvc1N0ZXJlbyA9IGZ1bmN0aW9uKGF1ZGlvLCBvYmplY3QsIGNhbWVyYSwgbWluLCBtYXgsIG9mZnNldCwgZmFsbGJhY2spIHtcbiAgICBpZiAocDMuRGV2aWNlLmlzTW9iaWxlIHx8ICFwMy5EZXZpY2UuYm93c2VyW1wiY2hyb21lXCJdKSB7XG4gICAgICAgIGZhbGxiYWNrID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBtaW4gPSBtaW4gfHwgMC4wO1xuICAgIG1heCA9IG1heCB8fCAzMjAuMDtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIHZhciBsYXllciA9IGNhbWVyYS5maW5kTGF5ZXJGb3JPYmplY3Qob2JqZWN0KTtcbiAgICB2YXIgeCA9IChvYmplY3QueCArIG9mZnNldCkgKiAoMS4wIC8gbGF5ZXIucGFyYWxsYXgueCk7XG4gICAgdmFyIHNpZ24gPSAoeCAtIGNhbWVyYS5wb3NpdGlvbi54KTtcbiAgICBzaWduID0gc2lnbiAvIE1hdGguYWJzKHNpZ24pO1xuXG4gICAgeCA9IE1hdGgubWF4KDAuMCwgTWF0aC5hYnMoKHggLSBtaW4pIC0gY2FtZXJhLnBvc2l0aW9uLngpIC8gKG1heCkpO1xuICAgIHggPSBNYXRoLm1heCgwLjAsIE1hdGgubWluKDEuMCwgMS4wICsgKDEuMCAtIHgpKSk7XG5cbiAgICBhdWRpby5ob3dsLnZvbHVtZSh4LCBhdWRpby5pZCk7XG5cbiAgICBpZiAoZmFsbGJhY2spIHJldHVybjtcblxuICAgIHggPSAob2JqZWN0LnggKyBvZmZzZXQpICogKDEuMCAvIGxheWVyLnBhcmFsbGF4LngpO1xuXG4gICAgaWYgKHNpZ24gPT0gLTEpIHggPSBNYXRoLm1pbigwLjAsICgoeCArIG1pbikgLSBjYW1lcmEucG9zaXRpb24ueCkgLyAobWF4IC0gbWluKSk7XG4gICAgZWxzZSBpZiAoc2lnbiA9PSAxKSB4ID0gTWF0aC5tYXgoMC4wLCAoKHggLSBtaW4pIC0gY2FtZXJhLnBvc2l0aW9uLngpIC8gKG1heCAtIG1pbikpO1xuXG4gICAgeCA9IE1hdGgubWF4KC0xLjAsIE1hdGgubWluKDEuMCwgeCkpO1xuICAgIGF1ZGlvLmhvd2wuc3RlcmVvKHgsIGF1ZGlvLmlkKTtcbn07XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdWRpb01hbmFnZXIucHJvdG90eXBlLCBcImlzTXV0ZVwiLCB7XG4gICAgLyoqXG4gICAgICogQHJldHVybnMgeyFib29sZWFufVxuICAgICAqL1xuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc011dGVkO1xuICAgIH1cbn0pO1xuIiwiLyoqXG4gKiAgQXVkaW9QYXJhbXNcbiAqXG4gKiAgQ3JlYXRlZCBieSBMZWdtYW4gb24gMjUvMDIvMjAxNi5cbiAqXG4gKi9cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gQXVkaW9QYXJhbXMoKSB7XG4gICAgLyoqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLnZvbHVtZSA9IDEuMDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMubG9vcCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLmRlbGF5ID0gMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLmZhZGVJbiA9IDAuMDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5wcmlvcml0eSA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7ZnVuY3Rpb259XG4gICAgICovXG4gICAgdGhpcy5jYWxsYmFjayA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Kn1cbiAgICAgKi9cbiAgICB0aGlzLnNjb3BlID0gd2luZG93O1xufVxubW9kdWxlLmV4cG9ydHMgPSBBdWRpb1BhcmFtcztcbiIsIlxyXG52YXIgQ29tbW9uICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBFbWl0dGVyKCkge1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gRW1pdHRlcjtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7IVBJWEkuQ29udGFpbmVyfSBwYXJlbnRcclxuICogQHBhcmFtIHshQXJyYXk8U3RyaW5nPn0gdGV4dHVyZXNcclxuICogQHBhcmFtIHshU3RyaW5nfSBqc29uXHJcbiAqIEBwYXJhbSB7TnVtYmVyPX0geFxyXG4gKiBAcGFyYW0ge051bWJlcj19IHlcclxuICogQHBhcmFtIHtOdW1iZXI9fSByZW1vdmVUaW1lXHJcbiAqIEBwYXJhbSB7Qm9vbGVhbj19IGF1dG9FbWl0XHJcbiAqIEByZXR1cm5zIHtjbG91ZGtpZC5FbWl0dGVyfSBlbWl0dGVyXHJcbiAqL1xyXG5FbWl0dGVyLmFkZCA9IGZ1bmN0aW9uKHBhcmVudCwgdGV4dHVyZXMsIGpzb24sIHgsIHksIHJlbW92ZVRpbWUsIGF1dG9FbWl0LCBkZXN0cm95VGltZSlcclxue1xyXG4gICAgaWYoYXV0b0VtaXQgPT0gdW5kZWZpbmVkKSBhdXRvRW1pdCA9IHRydWU7XHJcbiAgICBpZihkZXN0cm95VGltZSA9PSB1bmRlZmluZWQpIGRlc3Ryb3lUaW1lID0gMTtcclxuXHJcbiAgICB4ID0geCB8fCAwO1xyXG4gICAgeSA9IHkgfHwgMDtcclxuXHJcbiAgICB2YXIgYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xyXG5cclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0ZXh0dXJlcy5sZW5ndGg7IGkrKylcclxuICAgIHtcclxuICAgICAgICB0ZXh0dXJlc1tpXSA9IGFzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRleHR1cmVzW2ldKTtcclxuICAgIH0gICAgXHJcblxyXG4gICAgdmFyIGVtaXR0ZXIgPSBuZXcgUElYSS5wYXJ0aWNsZXMuRW1pdHRlcihcclxuICAgICAgICBwYXJlbnQsXHJcbiAgICAgICAgdGV4dHVyZXMsXHJcbiAgICAgICAgYXNzZXRNYW5hZ2VyLmdldEpTT04oanNvbilcclxuICAgICk7XHJcbiAgICBpZihhdXRvRW1pdClcclxuICAgICAgICBlbWl0dGVyLmVtaXQgPSB0cnVlO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIGVtaXR0ZXIuZW1pdCA9IGZhbHNlO1xyXG5cclxuICAgIGVtaXR0ZXIudXBkYXRlT3duZXJQb3MoeCwgeSk7XHJcblxyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChlbWl0dGVyKTtcclxuXHJcbiAgICBpZihyZW1vdmVUaW1lICE9IG51bGwpXHJcbiAgICB7ICAgIFxyXG4gICAgICAgIENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIEVtaXR0ZXIuZGVzdHJveShlbWl0dGVyLCBkZXN0cm95VGltZSk7XHJcbiAgICAgICAgfSwgcmVtb3ZlVGltZSwgdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGVtaXR0ZXI7XHJcbn07XHJcblxyXG5FbWl0dGVyLmRlc3Ryb3kgPSBmdW5jdGlvbihlbWl0dGVyLCBkZXN0cm95RGVsYXkpXHJcbntcclxuICAgIGlmKGVtaXR0ZXIgIT0gbnVsbClcclxuICAgIHsgICAgXHJcbiAgICAgICAgZGVzdHJveURlbGF5ID0gZGVzdHJveURlbGF5IHx8IDA7XHJcblxyXG4gICAgICAgIGVtaXR0ZXIuZW1pdCA9IGZhbHNlO1xyXG4gICAgICAgIENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRyeXtcclxuICAgICAgICAgICAgICAgIENvbW1vbi5hbmltYXRvci5yZW1vdmUoZW1pdHRlcik7XHJcbiAgICAgICAgICAgICAgICBlbWl0dGVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgfWNhdGNoKGUpe1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY291bGQgbm90IGRlc3Ryb3kgZW1pdHRlcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgZGVzdHJveURlbGF5LCB0aGlzKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iLCJ2YXIgQ29tbW9uICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG5cclxuZnVuY3Rpb24gRm9udExvYWRlcihmb250KVxyXG57XHJcbiAgICB0aGlzLl9mb250ID0gZm9udDtcclxuICAgIHRoaXMuX2hpZGRlblRleHQgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuaGFzTG9hZGVkID0gZmFsc2U7XHJcblxyXG5cdFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcblxyXG4gICAgdGhpcy5zaWduYWxzID0ge307XHJcbiAgICB0aGlzLnNpZ25hbHMubG9hZGVkID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBGb250TG9hZGVyO1xyXG5Gb250TG9hZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuRm9udExvYWRlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBGb250TG9hZGVyO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5Gb250TG9hZGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9oaWRkZW5UZXh0ID0gbmV3IFBJWEkuVGV4dCgnTE9BRElORycsIHtcclxuICAgICAgICAgICAgZm9udDpcIjYwcHggXCIgKyB0aGlzLl9mb250XHJcbiAgICAgICAgfSk7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX2hpZGRlblRleHQpO1xyXG5cclxuICAgIENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KHRoaXMuY2hlY2tMb2FkZWQsIC41LCB0aGlzKTtcclxufTtcclxuXHJcbkZvbnRMb2FkZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn07XHJcblxyXG5Gb250TG9hZGVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuXHRcclxufTtcclxuXHJcbkZvbnRMb2FkZXIucHJvdG90eXBlLmNoZWNrTG9hZGVkID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoJ0xPQURJTkcnLCB7XHJcbiAgICAgICAgICAgIGZvbnQ6XCI2MHB4IFwiICsgdGhpcy5fZm9udFxyXG4gICAgICAgIH0pO1xyXG4gICAgaWYodGV4dC53aWR0aCAhPSB0aGlzLl9oaWRkZW5UZXh0LndpZHRoIHx8IHRleHQuaGVpZ2h0ICE9IHRoaXMuX2hpZGRlblRleHQuaGVpZ2h0KVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuaGFzTG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNpZ25hbHMubG9hZGVkLmRpc3BhdGNoKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgQ29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQodGhpcy5jaGVja0xvYWRlZCwgLjUsIHRoaXMpO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuIiwiXG52YXIgQ29tbW9uICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcblxuLyoqXG4gKiAgSW5wdXRcbiAqXG4gKiAgQ3JlYXRlZCBieSBMZWdtYW4gb24gOC8xMC8yMDE1LlxuICpcbiAqL1xuXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gSW5wdXQoKSB7XG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5pc0tleVVwID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB0aGlzLmlzS2V5TGVmdCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5pc0tleVJpZ2h0ID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB0aGlzLmlzS2V5RG93biA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5pc0tleUZpcmUgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMuaXNLZXlBbHRGaXJlID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7UElYSS5Qb2ludH1cbiAgICAgKi9cbiAgICB0aGlzLnRvdWNoID0gbmV3IFBJWEkuUG9pbnQoKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHRoaXMuaXNUb3VjaCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUgeyp9XG4gICAgICovXG4gICAgdGhpcy5zaWduYWxzICAgICAgICAgICAgICAgID0ge307XG4gICAgdGhpcy5zaWduYWxzLm1vdXNlTW92ZSAgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG4gICAgdGhpcy5zaWduYWxzLm1vdXNlRG93biAgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG4gICAgdGhpcy5zaWduYWxzLm1vdXNlVXAgICAgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG4gICAgdGhpcy5zaWduYWxzLm1vdXNlT3V0ICAgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG4gICAgdGhpcy5zaWduYWxzLm1vdXNlQ2xpY2sgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG5cbiAgICB0aGlzLnNpZ25hbHMua2V5RG93biAgICAgICAgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcbiAgICB0aGlzLnNpZ25hbHMua2V5VXAgICAgICAgICAgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtudWxsfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5fc3RhZ2UgPSBudWxsO1xufVxubW9kdWxlLmV4cG9ydHMgPSBJbnB1dDtcblxuLyoqXG4gKiBAdHlwZSB7Kn1cbiAqL1xuSW5wdXQua2V5cyA9IHt9O1xuXG4vKipcbiAqIEB0eXBlIHtudW1iZXJ9XG4gKiBAc3RhdGljXG4gKiBAY29uc3RcbiAqL1xuSW5wdXQua2V5cy5XID0gODc7XG5cbi8qKlxuICogQHR5cGUge251bWJlcn1cbiAqIEBzdGF0aWNcbiAqIEBjb25zdFxuICovXG5JbnB1dC5rZXlzLkEgPSA2NTtcblxuLyoqXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQHN0YXRpY1xuICogQGNvbnN0XG4gKi9cbklucHV0LmtleXMuUyA9IDgzO1xuXG4vKipcbiAqIEB0eXBlIHtudW1iZXJ9XG4gKiBAc3RhdGljXG4gKiBAY29uc3RcbiAqL1xuSW5wdXQua2V5cy5EID0gNjg7XG5cbi8qKlxuICogQHR5cGUge251bWJlcn1cbiAqIEBzdGF0aWNcbiAqIEBjb25zdFxuICovXG5JbnB1dC5rZXlzLlogPSA5MDtcblxuLyoqXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQHN0YXRpY1xuICogQGNvbnN0XG4gKi9cbklucHV0LmtleXMuWCA9IDg4O1xuXG4vKipcbiAqIEB0eXBlIHtudW1iZXJ9XG4gKiBAc3RhdGljXG4gKiBAY29uc3RcbiAqL1xuSW5wdXQua2V5cy5DID0gNjc7XG5cbi8qKlxuICogQHR5cGUge251bWJlcn1cbiAqIEBzdGF0aWNcbiAqIEBjb25zdFxuICovXG5JbnB1dC5rZXlzLlNQQUNFID0gMzI7XG5cbi8qKlxuICogQHR5cGUge251bWJlcn1cbiAqIEBzdGF0aWNcbiAqIEBjb25zdFxuICovXG5JbnB1dC5rZXlzLkxFRlQgPSAzNztcblxuLyoqXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQHN0YXRpY1xuICogQGNvbnN0XG4gKi9cbklucHV0LmtleXMuUklHSFQgPSAzOTtcblxuLyoqXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQHN0YXRpY1xuICogQGNvbnN0XG4gKi9cbklucHV0LmtleXMuVVAgPSAzODtcblxuLyoqXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQHN0YXRpY1xuICogQGNvbnN0XG4gKi9cbklucHV0LmtleXMuRE9XTiA9IDQwO1xuXG4vKipcbiAqIEB0eXBlIHtudW1iZXJ9XG4gKiBAc3RhdGljXG4gKiBAY29uc3RcbiAqL1xuSW5wdXQua2V5cy5FTlRFUiA9IDEzO1xuXG4vKipcbiAqIEBwYXJhbSB7IVBJWEkuRGlzcGxheU9iamVjdH0gc3RhZ2VcbiAqIEBwYXJhbSB7ISp9IGtleUxpc3RlbmVyXG4gKi9cbklucHV0LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oc3RhZ2UsIGtleUxpc3RlbmVyKSB7XG4gICAgdGhpcy5fc3RhZ2UgICAgICAgICAgICAgICAgID0gc3RhZ2U7XG4gICAgdGhpcy5fc3RhZ2UuaW50ZXJhY3RpdmUgICAgID0gdHJ1ZTtcbiAgICB0aGlzLl9zdGFnZS5tb3VzZW1vdmUgICAgICAgPSB0aGlzLl9zdGFnZS50b3VjaG1vdmUgICAgID0gdGhpcy5vbk1vdXNlTW92ZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX3N0YWdlLm1vdXNlZG93biAgICAgICA9IHRoaXMuX3N0YWdlLnRvdWNoc3RhcnQgICAgPSB0aGlzLm9uTW91c2VEb3duLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fc3RhZ2UubW91c2V1cCAgICAgICAgID0gdGhpcy5fc3RhZ2UudG91Y2hlbmQgICAgICA9IHRoaXMub25Nb3VzZVVwLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fc3RhZ2UubW91c2VvdXQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHRoaXMub25Nb3VzZU91dC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX3N0YWdlLmNsaWNrICAgICAgICAgICA9IHRoaXMuX3N0YWdlLnRhcCAgICAgICAgICAgPSB0aGlzLm9uTW91c2VDbGljay5iaW5kKHRoaXMpO1xuXG4gICAga2V5TGlzdGVuZXIub25rZXlkb3duICAgICAgID0gdGhpcy5vbktleURvd24uYmluZCh0aGlzKTtcbiAgICBrZXlMaXN0ZW5lci5vbmtleXVwICAgICAgICAgPSB0aGlzLm9uS2V5VXAuYmluZCh0aGlzKTtcbiAgICBrZXlMaXN0ZW5lci5mb2N1cygpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9zdGFnZS5tb3VzZW1vdmUgICA9IHRoaXMuX3N0YWdlLnRvdWNobW92ZSAgICAgPSBudWxsO1xuICAgIHRoaXMuX3N0YWdlLm1vdXNlZG93biAgID0gdGhpcy5fc3RhZ2UudG91Y2hzdGFydCAgICA9IG51bGw7XG4gICAgdGhpcy5fc3RhZ2UubW91c2V1cCAgICAgPSB0aGlzLl9zdGFnZS50b3VjaGVuZCAgICAgID0gbnVsbDtcbiAgICB0aGlzLl9zdGFnZS5tb3VzZW91dCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBudWxsO1xuICAgIHRoaXMuX3N0YWdlLmNsaWNrICAgICAgID0gdGhpcy5fc3RhZ2UudGFwICAgICAgICAgICA9IG51bGw7XG5cbiAgICB0aGlzLnNpZ25hbHMubW91c2VNb3ZlLmRpc3Bvc2UoKTtcbiAgICB0aGlzLnNpZ25hbHMubW91c2VEb3duLmRpc3Bvc2UoKTtcbiAgICB0aGlzLnNpZ25hbHMubW91c2VVcC5kaXNwb3NlKCk7XG4gICAgdGhpcy5zaWduYWxzLm1vdXNlT3V0LmRpc3Bvc2UoKTtcbiAgICB0aGlzLnNpZ25hbHMubW91c2VDbGljay5kaXNwb3NlKCk7XG5cbiAgICB0aGlzLnNpZ25hbHMua2V5RG93bi5kaXNwb3NlKCk7XG4gICAgdGhpcy5zaWduYWxzLmtleVVwLmRpc3Bvc2UoKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gKi9cbklucHV0LnByb3RvdHlwZS5vbk1vdXNlTW92ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy50b3VjaCA9IGV2ZW50LmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzLl9zdGFnZSk7XG5cbiAgICBDb21tb24ucXVldWVDYWxscy5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2lnbmFscy5tb3VzZU1vdmUuZGlzcGF0Y2goZXZlbnQpO1xuICAgIH0sIFtdLCB0aGlzKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gKi9cbklucHV0LnByb3RvdHlwZS5vbk1vdXNlRG93biA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy50b3VjaCA9IGV2ZW50LmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzLl9zdGFnZSk7XG4gICAgdGhpcy5pc1RvdWNoID0gdHJ1ZTtcblxuICAgIENvbW1vbi5xdWV1ZUNhbGxzLmFkZChmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zaWduYWxzLm1vdXNlRG93bi5kaXNwYXRjaChldmVudCk7XG4gICAgfSwgW10sIHRoaXMpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0geyFFdmVudH0gZXZlbnRcbiAqL1xuSW5wdXQucHJvdG90eXBlLm9uTW91c2VVcCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy50b3VjaCA9IGV2ZW50LmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzLl9zdGFnZSk7XG4gICAgdGhpcy5pc1RvdWNoID0gZmFsc2U7XG5cbiAgICBDb21tb24ucXVldWVDYWxscy5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2lnbmFscy5tb3VzZVVwLmRpc3BhdGNoKGV2ZW50KTtcbiAgICB9LCBbXSwgdGhpcyk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7IUV2ZW50fSBldmVudFxuICovXG5JbnB1dC5wcm90b3R5cGUub25Nb3VzZU91dCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy50b3VjaCA9IGV2ZW50LmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzLl9zdGFnZSk7XG4gICAgdGhpcy5pc1RvdWNoID0gZmFsc2U7XG5cbiAgICBDb21tb24ucXVldWVDYWxscy5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2lnbmFscy5tb3VzZU91dC5kaXNwYXRjaChldmVudCk7XG4gICAgfSwgW10sIHRoaXMpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0geyFFdmVudH0gZXZlbnRcbiAqL1xuSW5wdXQucHJvdG90eXBlLm9uTW91c2VDbGljayA9IGZ1bmN0aW9uKGV2ZW50KVxue1xuICAgIENvbW1vbi5xdWV1ZUNhbGxzLmFkZChmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zaWduYWxzLm1vdXNlQ2xpY2suZGlzcGF0Y2goZXZlbnQpO1xuICAgIH0sIFtdLCB0aGlzKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gKi9cbklucHV0LnByb3RvdHlwZS5vbktleURvd24gPSBmdW5jdGlvbihldmVudCkge1xuICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xuICAgICAgICBjYXNlIElucHV0LmtleXMuVVAgOlxuICAgICAgICBjYXNlIElucHV0LmtleXMuVyA6IHtcbiAgICAgICAgICAgIHRoaXMuaXNLZXlVcCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlIElucHV0LmtleXMuTEVGVCA6XG4gICAgICAgIGNhc2UgSW5wdXQua2V5cy5BIDoge1xuICAgICAgICAgICAgdGhpcy5pc0tleUxlZnQgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlJJR0hUIDpcbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLkQgOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5UmlnaHQgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLkRPV04gOlxuICAgICAgICBjYXNlIElucHV0LmtleXMuUyA6IHtcbiAgICAgICAgICAgIHRoaXMuaXNLZXlEb3duID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgSW5wdXQua2V5cy5aIDpcbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlNQQUNFIDoge1xuICAgICAgICAgICAgdGhpcy5pc0tleUZpcmUgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlggOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5QWx0RmlyZSA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIENvbW1vbi5xdWV1ZUNhbGxzLmFkZChmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zaWduYWxzLmtleURvd24uZGlzcGF0Y2goZXZlbnQpO1xuICAgIH0sIFtdLCB0aGlzKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gKi9cbklucHV0LnByb3RvdHlwZS5vbktleVVwID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHtcbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlVQIDpcbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlcgOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5VXAgPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgSW5wdXQua2V5cy5MRUZUIDpcbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLkEgOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5TGVmdCA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlJJR0hUIDpcbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLkQgOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5UmlnaHQgPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgSW5wdXQua2V5cy5ET1dOIDpcbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlMgOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5RG93biA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlogOlxuICAgICAgICBjYXNlIElucHV0LmtleXMuU1BBQ0UgOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5RmlyZSA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBJbnB1dC5rZXlzLlggOiB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5QWx0RmlyZSA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBDb21tb24ucXVldWVDYWxscy5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2lnbmFscy5rZXlVcC5kaXNwYXRjaChldmVudCk7XG4gICAgfSwgW10sIHRoaXMpO1xufTtcbiIsInZhciBDb21tb24gPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG5cclxuZnVuY3Rpb24gUXVldWVDYWxscygpXHJcbntcclxuXHR0aGlzLl9jYWxscyA9IG51bGw7XHJcbiAgICB0aGlzLmluaXQoKTtcclxufVxyXG5RdWV1ZUNhbGxzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuUXVldWVDYWxscy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBRdWV1ZUNhbGxzO1xyXG5tb2R1bGUuZXhwb3J0cyA9IFF1ZXVlQ2FsbHM7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuUXVldWVDYWxscy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdGhpcy5fY2FsbHMgPSBbXTtcclxufTtcclxuXHJcblF1ZXVlQ2FsbHMucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHdoaWxlKHRoaXMuX2NhbGxzLmxlbmd0aCA+IDApXHJcblx0e1xyXG5cdFx0dGhpcy5fY2FsbHNbMF0uY2FsbGJhY2suYXBwbHkodGhpcy5fY2FsbHNbMF0uc2NvcGUsIHRoaXMuX2NhbGxzWzBdLnBhcmFtcyk7XHJcblx0XHR0aGlzLl9jYWxscy5zcGxpY2UoMCwgMSk7XHJcblx0fVxyXG59O1xyXG5cclxuUXVldWVDYWxscy5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24oY2FsbGJhY2ssIHBhcmFtcywgc2NvcGUpXHJcbntcclxuXHR0aGlzLl9jYWxscy5wdXNoKHtjYWxsYmFjazpjYWxsYmFjaywgcGFyYW1zOnBhcmFtcywgc2NvcGU6c2NvcGV9KTtcclxufTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiIsInZhciBDb21tb24gPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG5cclxuZnVuY3Rpb24gQW5pbWF0ZWRDaGFyYWN0ZXIoKVxyXG57XHJcblx0dGhpcy5fc3BpbmUgPSBudWxsO1xyXG5cdHRoaXMuX3NwaW5lRGF0YSA9IG51bGw7XHJcblx0dGhpcy5fanNvbkRhdGEgPSBudWxsO1xyXG5cclxuXHR0aGlzLl9zbG90cyA9IHt9O1xyXG5cdHRoaXMuX2F0dGFjaG1lbnRzID0ge307XHJcblxyXG4gICAgdGhpcy5fYW5pbWF0aW9uVGltZSA9IDA7XHJcblxyXG4gICAgdGhpcy5jdXJyZW50QW5pbWF0aW9uID0gJ2lkbGUxJztcclxuXHJcbiAgICB0aGlzLmN1cnJlbnRPdXRmaXQgPSB7fTtcclxuXHJcbiAgICB0aGlzLmNvbXBsZXRlQW5pbWF0aW9ucyA9IHtcclxuICAgICAgICBkb3JvdGh5OiAgICB7YW5pbWF0aW9uOnRydWUsICAgIG11c2ljOnRydWUsICAgICBzZng6ZmFsc2UsICBhbmltYXRpb25OYW1lOidjb3N0dW1lX2Rvcm90aHknLCAgICBhbmltYXRpb25UaW1lOjF9LFxyXG4gICAgICAgIGxpb246ICAgICAgIHthbmltYXRpb246dHJ1ZSwgICAgbXVzaWM6dHJ1ZSwgICAgIHNmeDpmYWxzZSwgIGFuaW1hdGlvbk5hbWU6J2Nvc3R1bWVfbGlvbicsICAgICAgIGFuaW1hdGlvblRpbWU6M30sXHJcbiAgICAgICAgbm9tZV9raW5nOiAge2FuaW1hdGlvbjp0cnVlLCAgICBtdXNpYzpmYWxzZSwgICAgc2Z4OnRydWUsICAgYW5pbWF0aW9uTmFtZTonY29zdHVtZV9ub21la2luZycsICAgYW5pbWF0aW9uVGltZTozfSxcclxuICAgICAgICBxdWVlbjogICAgICB7YW5pbWF0aW9uOmZhbHNlLCAgIG11c2ljOmZhbHNlLCAgICBzZng6dHJ1ZX0sXHJcbiAgICAgICAgc2NhcmVjcm93OiAge2FuaW1hdGlvbjp0cnVlLCAgICBtdXNpYzp0cnVlLCAgICAgc2Z4OnRydWUsICAgYW5pbWF0aW9uTmFtZTonY29zdHVtZV9zY2FyZWNyb3cnLCAgYW5pbWF0aW9uVGltZTozfSxcclxuICAgICAgICB0aW5tYW46ICAgICB7YW5pbWF0aW9uOnRydWUsICAgIG11c2ljOnRydWUsICAgICBzZng6dHJ1ZSwgICBhbmltYXRpb25OYW1lOidjb3N0dW1lX3Rpbm1hbicsICAgICBhbmltYXRpb25UaW1lOjN9LFxyXG4gICAgICAgIHdpdGNoOiAgICAgIHthbmltYXRpb246ZmFsc2UsICAgbXVzaWM6dHJ1ZSwgICAgIHNmeDp0cnVlfVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnBob3RvTW9kZSA9IGZhbHNlO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuaW5pdCgpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gQW5pbWF0ZWRDaGFyYWN0ZXI7XHJcbkFuaW1hdGVkQ2hhcmFjdGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuQW5pbWF0ZWRDaGFyYWN0ZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQW5pbWF0ZWRDaGFyYWN0ZXI7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkFuaW1hdGVkQ2hhcmFjdGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9zcGluZSA9IG5ldyBQSVhJLnNwaW5lLlNwaW5lKENvbW1vbi5hc3NldHMuZ2V0U3BpbmVEYXRhKFwiZG9yb3RoeV9hbmltXCIpKTtcclxuICAgIHRoaXMuX3NwaW5lRGF0YSA9IENvbW1vbi5hc3NldHMuZ2V0U3BpbmVEYXRhKFwiZG9yb3RoeV9hbmltXCIpO1xyXG4gICAgLy90aGlzLl9zcGluZS5za2VsZXRvbi5zZXRUb1NldHVwUG9zZSgpO1xyXG4gICAgdGhpcy5fc3BpbmUuc2tlbGV0b24uc2V0U2tpbihudWxsKTtcclxuICAgIHRoaXMuX3NwaW5lLnNjYWxlLnNldCgwLjUpO1xyXG4gICAgdGhpcy5fc3BpbmUuYXV0b1VwZGF0ZSA9IGZhbHNlO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9zcGluZSk7XHJcblxyXG4gICAgdGhpcy5fc3BpbmUuc3RhdGUuYWRkTGlzdGVuZXIoe1xyXG4gICAgICAgIGNvbXBsZXRlOiB0aGlzLm9uQW5pbWF0aW9uQ29tcGxldGUuYmluZCh0aGlzKVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGlkbGVzID0gWydpZGxlMScsICdpZGxlMicsICdpZGxlMycsICdpZGxlNCcsICdpZGxlNScsICdpZGxlNiddO1xyXG4gICAgdmFyIGNsaWNrcyA9IFsnY2xpY2toYXQnLCAnY2xpY2tzaG9lcycsICdjbGlja3NraXJ0JywgJ2NsaWNrdG9wJywgJ2p1bXBjZW50cmUnLCBcclxuICAgICAgICAgICAgICAgICAgJ3Bob3RvcG9zZTEnLCAncGhvdG9wb3NlMicsICdwaG90b3Bvc2UzJywgJ3Bob3RvcG9zZTQnLFxyXG4gICAgICAgICAgICAgICAgICAnY29zdHVtZV9ub21la2luZycsICdjb3N0dW1lX3NjYXJlY3JvdycsICdjb3N0dW1lX3Rpbm1hbicsICdjb3N0dW1lX2xpb24nLCAnY29zdHVtZV9kb3JvdGh5J107XHJcblxyXG4gICAgZm9yKHZhciBpIGluIGlkbGVzKVxyXG4gICAge1xyXG4gICAgICAgIGZvcih2YXIgaiBpbiBjbGlja3MpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLl9zcGluZS5zdGF0ZURhdGEuc2V0TWl4KGlkbGVzW2ldLCBjbGlja3Nbal0sIDAuMik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZvcih2YXIgaSBpbiBjbGlja3MpXHJcbiAgICB7XHJcbiAgICAgICAgZm9yKHZhciBqIGluIGNsaWNrcylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NwaW5lLnN0YXRlRGF0YS5zZXRNaXgoY2xpY2tzW2ldLCBjbGlja3Nbal0sIDAuMyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3NwaW5lLmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgMCwgMCk7XHJcbiAgICB0aGlzLl9zcGluZS5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgIHRoaXMuX2RldGVybWluZU9wdGlvbnMoKTtcclxuXHJcbiAgICB0aGlzLnJlc2V0Q2xvdGhlcygpO1xyXG5cclxuICAgIHRoaXMuX3NwaW5lLnN0YXRlLnNldEFuaW1hdGlvbigwLCB0aGlzLmN1cnJlbnRBbmltYXRpb24sIHRydWUpO1xyXG59O1xyXG5cclxuQW5pbWF0ZWRDaGFyYWN0ZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIFxyXG59O1xyXG5cclxuQW5pbWF0ZWRDaGFyYWN0ZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuX3NwaW5lLnVwZGF0ZShDb21tb24uZGVsdGEpO1xyXG4gICAgdGhpcy5fYW5pbWF0aW9uVGltZSArPSBDb21tb24uZGVsdGE7XHJcbn07XHJcblxyXG5BbmltYXRlZENoYXJhY3Rlci5wcm90b3R5cGUuc2V0QW5pbWF0aW9uID0gZnVuY3Rpb24oYW5pbWF0aW9uLCByZXBlYXQpXHJcbntcclxuICAgIHRoaXMuX3NwaW5lLnN0YXRlLnNldEFuaW1hdGlvbigwLCBhbmltYXRpb24sIHJlcGVhdCB8fCBmYWxzZSk7XHJcbiAgICB0aGlzLmN1cnJlbnRBbmltYXRpb24gPSBhbmltYXRpb247XHJcbiAgICB0aGlzLl9hbmltYXRpb25UaW1lID0gMDtcclxufTtcclxuXHJcbkFuaW1hdGVkQ2hhcmFjdGVyLnByb3RvdHlwZS5zZXRBdHRhY2htZW50Rm9yU2xvdCA9IGZ1bmN0aW9uKHNsb3ROYW1lLCBhdHRhY2htZW50TmFtZSlcclxue1xyXG5cdHRoaXMuX3Nsb3RzW3Nsb3ROYW1lXS5zZXRBdHRhY2htZW50KHRoaXMuX2F0dGFjaG1lbnRzW2F0dGFjaG1lbnROYW1lXSk7XHJcbn07XHJcblxyXG5BbmltYXRlZENoYXJhY3Rlci5wcm90b3R5cGUucmVtb3ZlQXR0YWNobWVudEZyb21TbG90ID0gZnVuY3Rpb24oc2xvdE5hbWUpXHJcbntcclxuICAgIHRoaXMuX3Nsb3RzW3Nsb3ROYW1lXS5zZXRBdHRhY2htZW50KG51bGwpO1xyXG59O1xyXG5cclxuQW5pbWF0ZWRDaGFyYWN0ZXIucHJvdG90eXBlLnJlc2V0Q2xvdGhlcyA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgZm9yKHZhciBpIGluIENvbW1vbi5jb25maWcuY2xvdGhlcylcclxuICAgIHtcclxuICAgICAgICB0aGlzLnJlc2V0QmFzZShDb21tb24uY29uZmlnLmNsb3RoZXNbaV0uYmFzZV9zbG90cyk7XHJcbiAgICAgICAgZm9yKHZhciBqIGluIENvbW1vbi5jb25maWcuY2xvdGhlc1tpXS5pdGVtcylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBpdGVtID0gQ29tbW9uLmNvbmZpZy5jbG90aGVzW2ldLml0ZW1zW2pdO1xyXG4gICAgICAgICAgICBpZihpdGVtLmRlZmF1bHQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE91dGZpdFtpXSA9IGl0ZW0uaWQ7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGsgaW4gaXRlbS5zbG90c190b19jbGVhcilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUF0dGFjaG1lbnRGcm9tU2xvdChpdGVtLnNsb3RzX3RvX2NsZWFyW2tdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvcihrIGluIGl0ZW0uYXR0YWNobWVudHMpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBdHRhY2htZW50Rm9yU2xvdChpdGVtLmF0dGFjaG1lbnRzW2tdLnNsb3QsIGl0ZW0uYXR0YWNobWVudHNba10uYXR0YWNobWVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcblxyXG5BbmltYXRlZENoYXJhY3Rlci5wcm90b3R5cGUucmVzZXRCYXNlID0gZnVuY3Rpb24oYmFzZVNsb3RzKVxyXG57XHJcbiAgICBmb3IodmFyIGkgaW4gYmFzZVNsb3RzKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQXR0YWNobWVudEZyb21TbG90KGJhc2VTbG90c1tpXS5iYXNlX3Nsb3QpO1xyXG4gICAgICAgIHRoaXMuc2V0QXR0YWNobWVudEZvclNsb3QoYmFzZVNsb3RzW2ldLmJhc2Vfc2xvdCwgYmFzZVNsb3RzW2ldLmJhc2VfYXR0YWNobWVudCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbkFuaW1hdGVkQ2hhcmFjdGVyLnByb3RvdHlwZS5pbnRybyA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdGhpcy5fc3BpbmUueCA9IDUwMDtcclxuICAgIHRoaXMuc2V0QW5pbWF0aW9uKCdlbnRlcnN0YWdlJyk7IFxyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLl9zcGluZSwgMSwge3g6MCwgZWFzZTpQb3dlcjEuZWFzZU91dH0pKTtcclxuICAgIENvbW1vbi5hdWRpby5wbGF5U291bmQoJ3NmeF9kb3JvdGh5X3NraWRfaW5fMDAnKTtcclxufVxyXG5cclxuQW5pbWF0ZWRDaGFyYWN0ZXIucHJvdG90eXBlLmNoYW5nZUNsb3RoZXNFZmZlY3QgPSBmdW5jdGlvbih0eXBlKVxyXG57XHJcbiAgICBpZighQ29tbW9uLmxvd1BlcmZvcm1hbmNlKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBwb3MgPSB7Zm9vdHdlYXI6MCwgbG93ZXJfYm9keTotMTAwLCB1cHBlcl9ib2R5Oi0zMDAsIGhlYWR3ZWFyOi01MDB9O1xyXG4gICAgICAgIHZhciBjb2xvdXJzID0gWydibHVlJywgJ2dyZWVuJywgJ29yYW5nZScsICdwaW5rJywgJ3llbGxvdyddO1xyXG5cclxuICAgICAgICB2YXIgaSA9IE1hdGguZmxvb3IoY29sb3Vycy5sZW5ndGggKiBNYXRoLnJhbmRvbSgpKTtcclxuICAgICAgICB2YXIgY29sb3VyMSA9IGNvbG91cnNbaV07XHJcbiAgICAgICAgY29sb3Vycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgdmFyIGNvbG91cjIgPSBjb2xvdXJzW01hdGguZmxvb3IoY29sb3Vycy5sZW5ndGggKiBNYXRoLnJhbmRvbSgpKV07XHJcblxyXG4gICAgICAgIENvbW1vbi5lbWl0dGVyLmFkZCh0aGlzLCBcclxuICAgICAgICAgICAgWydwYXJ0aWNsZV9zdGFyXzAwJywgJ3BhcnRpY2xlX3N0YXJfMDEnXSxcclxuICAgICAgICAgICAgXCJwYXJ0aWNsZV9lbWl0dGVyX3N0YXJidXJzdF9cIiArIGNvbG91cjEgKyBcIl8wMFwiLCAwLCBwb3NbdHlwZV0sIDMpO1xyXG4gICAgICAgIENvbW1vbi5lbWl0dGVyLmFkZCh0aGlzLCBcclxuICAgICAgICAgICAgWydwYXJ0aWNsZV9zdGFyXzAwJywgJ3BhcnRpY2xlX3N0YXJfMDEnXSxcclxuICAgICAgICAgICAgXCJwYXJ0aWNsZV9lbWl0dGVyX3N0YXJidXJzdF9cIiArIGNvbG91cjIgKyBcIl8wMFwiLCAwLCBwb3NbdHlwZV0sIDMpO1xyXG4gICAgfVxyXG5cclxuICAgIENvbW1vbi5hdWRpby5wbGF5U291bmQoJ3NmeF9tYWdpY19zcGFya2xlc18wMCcpO1xyXG59XHJcblxyXG5BbmltYXRlZENoYXJhY3Rlci5wcm90b3R5cGUuaGFzQ29tcGxldGVPdXRmaXQgPSBmdW5jdGlvbihzdHIpXHJcbntcclxuICAgIHZhciBhbGxTYW1lID0gdHJ1ZVxyXG4gICAgZm9yKHZhciBqIGluIHRoaXMuY3VycmVudE91dGZpdClcclxuICAgIHtcclxuICAgICAgICBpZih0aGlzLmN1cnJlbnRPdXRmaXRbal0uaW5kZXhPZihzdHIpID09IC0xKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYWxsU2FtZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBhbGxTYW1lO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkFuaW1hdGVkQ2hhcmFjdGVyLnByb3RvdHlwZS5fZGV0ZXJtaW5lT3B0aW9ucyA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGZvcih2YXIgaSBpbiB0aGlzLl9zcGluZURhdGEuZGVmYXVsdFNraW4uYXR0YWNobWVudHMpXHJcbiAgICB7XHJcbiAgICBcdGZvcih2YXIgaiBpbiB0aGlzLl9zcGluZURhdGEuZGVmYXVsdFNraW4uYXR0YWNobWVudHNbaV0pXHJcbiAgICBcdHtcclxuICAgIFx0XHR0aGlzLl9hdHRhY2htZW50c1tqXSA9IHRoaXMuX3NwaW5lRGF0YS5kZWZhdWx0U2tpbi5hdHRhY2htZW50c1tpXVtqXTtcclxuICAgIFx0fVxyXG4gICAgfVxyXG5cclxuICAgIGZvcih2YXIgaSBpbiB0aGlzLl9zcGluZS5za2VsZXRvbi5zbG90cylcclxuICAgIHtcclxuICAgIFx0dGhpcy5fc2xvdHNbdGhpcy5fc3BpbmUuc2tlbGV0b24uc2xvdHNbaV0uZGF0YS5uYW1lXSA9IHRoaXMuX3NwaW5lLnNrZWxldG9uLnNsb3RzW2ldO1xyXG4gICAgfVxyXG5cclxuICAgIHAzLmxvZyh0aGlzLl9zbG90cyk7XHJcbiAgICBwMy5sb2codGhpcy5fYXR0YWNobWVudHMpO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkFuaW1hdGVkQ2hhcmFjdGVyLnByb3RvdHlwZS5vbkFuaW1hdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24oZW50cnkpXHJcbntcclxuICAgIGlmKHRoaXMuY3VycmVudEFuaW1hdGlvbi5pbmRleE9mKCdwaG90b3Bvc2UnKSA+IC0xKSByZXR1cm47XHJcblxyXG4gICAgZm9yKHZhciBpIGluIHRoaXMuY29tcGxldGVBbmltYXRpb25zKVxyXG4gICAge1xyXG4gICAgICAgIGlmKHRoaXMuY29tcGxldGVBbmltYXRpb25zW2ldLmFuaW1hdGlvbiAmJlxyXG4gICAgICAgICAgIHRoaXMuY3VycmVudEFuaW1hdGlvbiA9PSB0aGlzLmNvbXBsZXRlQW5pbWF0aW9uc1tpXS5hbmltYXRpb25OYW1lICYmIFxyXG4gICAgICAgICAgIHRoaXMuX2FuaW1hdGlvblRpbWUgPCB0aGlzLmNvbXBsZXRlQW5pbWF0aW9uc1tpXS5hbmltYXRpb25UaW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcDMubG9nKCdERU5JRUQnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIHJhbmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xyXG4gICAgdmFyIGFuaW07XHJcblxyXG4gICAgdmFyIHN0YW5jZXMgPSBbXTtcclxuXHJcbiAgICBpZih0aGlzLnBob3RvTW9kZSlcclxuICAgIHtcclxuICAgICAgICBmb3IodmFyIGkgaW4gdGhpcy5jb21wbGV0ZUFuaW1hdGlvbnMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0aGlzLmNvbXBsZXRlQW5pbWF0aW9uc1tpXS5hbmltYXRpb24gJiYgdGhpcy5oYXNDb21wbGV0ZU91dGZpdChpKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhbmNlcy5wdXNoKHRoaXMuY29tcGxldGVBbmltYXRpb25zW2ldLmFuaW1hdGlvbk5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHN0YW5jZXMubGVuZ3RoID4gMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHN0YW5jZXMucHVzaCgnaWRsZScgKyBTdHJpbmcoMSArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDYpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYoc3RhbmNlcy5sZW5ndGggPT0gMClcclxuICAgIHtcclxuICAgICAgICBpZihyYW5kIDwgMjApIGFuaW0gPSAnaWRsZTEnO1xyXG4gICAgICAgIGVsc2UgaWYocmFuZCA8IDMwKSBhbmltID0gJ2lkbGUyJztcclxuICAgICAgICBlbHNlIGlmKHJhbmQgPCA0NSkgYW5pbSA9ICdpZGxlMyc7XHJcbiAgICAgICAgZWxzZSBpZihyYW5kIDwgNjApIGFuaW0gPSAnaWRsZTQnO1xyXG4gICAgICAgIGVsc2UgaWYocmFuZCA8IDgwKSBhbmltID0gJ2lkbGU1JztcclxuICAgICAgICBlbHNlIGFuaW0gPSAnaWRsZTYnO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIHZhciBzcGxpdCA9IDEwMCAvIHN0YW5jZXMubGVuZ3RoO1xyXG4gICAgICAgIGFuaW0gPSBzdGFuY2VzW3N0YW5jZXMubGVuZ3RoLTFdO1xyXG5cclxuICAgICAgICBmb3IodmFyIGkgaW4gc3RhbmNlcylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHJhbmQgPCBzcGxpdCAqIChpKzEpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBhbmltID0gc3RhbmNlc1tpXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc2V0QW5pbWF0aW9uKGFuaW0pO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmltYXRlZENoYXJhY3Rlci5wcm90b3R5cGUsIFwiaXNJZGxlXCIsXHJcbntcclxuICAgIGdldDogZnVuY3Rpb24oKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRBbmltYXRpb24uaW5kZXhPZignaWRsZScpID4gLTE7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuIiwidmFyIENvbW1vbiAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxuXHJcbmZ1bmN0aW9uIEJ1dHRlcmZseSgpXHJcbntcclxuICAgIHZhciBjb2xvdXJzID0gWydibHVlJywgJ2dyZWVuJywgJ3JlZCcsICd5ZWxsb3cnXTtcclxuXHJcbiAgICB0aGlzLl9jb2xvdXIgPSBjb2xvdXJzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbG91cnMubGVuZ3RoKV07XHJcbiAgICB0aGlzLl90eXBlID0gJ3NpZGUnOy8vTWF0aC5yYW5kb20oKSA+IDAuNSA/ICdzaWRlJyA6ICdmcm9udCc7XHJcblxyXG4gICAgdGhpcy5fY2hhbmdlRnJhbWUgPSA2ICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNik7XHJcbiAgICB0aGlzLl9jdXJyZW50RnJhbWUgPSAxO1xyXG5cclxuICAgIHRoaXMuX3VwcGVyUG9zTGltaXQgPSAtMTAwO1xyXG4gICAgdGhpcy5fbG93ZXJQb3NMaW1pdCA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLSAyMDA7XHJcblxyXG4gICAgdGhpcy5fc3ByaXRlID0gbnVsbDtcclxuICAgIHRoaXMuX3R3ZWVuID0gbnVsbDtcclxuXHJcblx0UElYSS5Db250YWluZXIuY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLmluaXQoKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IEJ1dHRlcmZseTtcclxuQnV0dGVyZmx5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuQnV0dGVyZmx5LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEJ1dHRlcmZseTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuQnV0dGVyZmx5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdidXR0ZXJmbHlfJyArIHRoaXMuX3R5cGUgKyAnXzAwMV8nICsgdGhpcy5fY29sb3VyKSk7XHJcbiAgICB0aGlzLl9zcHJpdGUuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9zcHJpdGUpO1xyXG5cclxuICAgIC8vaWYodGhpcy5fdHlwZSA9PSAnZnJvbnQnKVxyXG4gICAgLy8gICAgdGhpcy5fc3ByaXRlLnJvdGF0aW9uID0gKC03MCArIChNYXRoLnJhbmRvbSgpICogNzApKSAqIFBJWEkuREVHX1RPX1JBRDtcclxuXHJcbiAgICB0aGlzLnggPSBDb21tb24uU1RBR0VfV0lEVEggKiBNYXRoLnJhbmRvbSgpO1xyXG4gICAgdGhpcy55ID0gdGhpcy5fdXBwZXJQb3NMaW1pdCArICgodGhpcy5fbG93ZXJQb3NMaW1pdCAtIHRoaXMuX3VwcGVyUG9zTGltaXQpICogTWF0aC5yYW5kb20oKSk7XHJcbn07XHJcblxyXG5CdXR0ZXJmbHkucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn07XHJcblxyXG5CdXR0ZXJmbHkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKENvbW1vbi5mcmFtZUNvdW50ICUgdGhpcy5fY2hhbmdlRnJhbWUgPT0gMClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9jdXJyZW50RnJhbWUgPSB0aGlzLl9jdXJyZW50RnJhbWUgPT0gMSA/IDIgOiAxO1xyXG4gICAgICAgIHRoaXMuX3Nwcml0ZS50ZXh0dXJlID0gQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdidXR0ZXJmbHlfJyArIHRoaXMuX3R5cGUgKyAnXzAwJyArIHRoaXMuX2N1cnJlbnRGcmFtZSArICdfJyArIHRoaXMuX2NvbG91cik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYoIVR3ZWVuTWF4LmlzVHdlZW5pbmcodGhpcykpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGxvd2VyTGltaXQgPSBNYXRoLm1pbih0aGlzLl9sb3dlclBvc0xpbWl0LCB0aGlzLnkgKyAyMDApO1xyXG4gICAgICAgIHZhciB1cHBlckxpbWl0ID0gTWF0aC5tYXgodGhpcy5fdXBwZXJQb3NMaW1pdCwgdGhpcy55IC0gMjAwKTtcclxuICAgICAgICB2YXIgbWlkWSA9IHVwcGVyTGltaXQgKyAoKGxvd2VyTGltaXQgLSB1cHBlckxpbWl0KSAqIE1hdGgucmFuZG9tKCkpO1xyXG4gICAgICAgIHZhciBlbmRYID0gMzAwICsgKDQwMCAqIE1hdGgucmFuZG9tKCkpO1xyXG5cclxuICAgICAgICB2YXIgc3BlZWQgPSAoNSArIChNYXRoLnJhbmRvbSgpICogNCkpICogKGVuZFggLyA3MDApO1xyXG5cclxuICAgICAgICB2YXIgcmV2ZXJzZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmKCh0aGlzLnggPiBDb21tb24uU1RBR0VfV0lEVEggfHwgTWF0aC5yYW5kb20oKSA+IDAuNSkgJiYgdGhpcy54ID4gMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGVuZFggPSBlbmRYICogLTE7XHJcbiAgICAgICAgICAgIHRoaXMuX3R5cGUgPT0gJ3NpZGUnICYmICh0aGlzLnNjYWxlLnggPSAtMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3R5cGUgPT0gJ3NpZGUnICYmICh0aGlzLnNjYWxlLnggPSAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZW5kWCArPSB0aGlzLng7XHJcblxyXG4gICAgICAgIHZhciBlbmRZO1xyXG4gICAgICAgIGlmKG1pZFkgPCB0aGlzLnkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBlbmRZID0gbWlkWSArICgobWlkWSAtIHVwcGVyTGltaXQpICogTWF0aC5yYW5kb20oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGVuZFkgPSB1cHBlckxpbWl0ICsgKChtaWRZIC0gdXBwZXJMaW1pdCkgKiBNYXRoLnJhbmRvbSgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1pZFggPSB0aGlzLnggKyAoKGVuZFggLSB0aGlzLngpLzIpOyBcclxuXHJcbiAgICAgICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLCBzcGVlZCwge2Jlemllcjp7YXV0b1JvdGF0ZTp0aGlzLl90eXBlID09ICdmcm9udCcsIHZhbHVlczpbe3g6bWlkWCwgeTptaWRZfSwge3g6ZW5kWCwgeTplbmRZfV19LCBlYXNlOkxpbmVhci5lYXNlTm9uZX0pKTtcclxuICAgIH1cclxufTtcclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4iLCJ2YXIgQ29tbW9uID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxuXHJcbmZ1bmN0aW9uIENsb3RoZXNDYXRlZ29yeUJ1dHRvbihpZCwgc2VsZWN0ZWQsIGRlc2VsZWN0ZWQpXHJcbntcclxuICAgIHRoaXMuaWQgPSBpZDtcclxuICAgIHRoaXMuX3NlbGVjdGVkID0gc2VsZWN0ZWQ7XHJcbiAgICB0aGlzLl9kZXNlbGVjdGVkID0gZGVzZWxlY3RlZDtcclxuXHJcbiAgICB0aGlzLl9ncmFwaGljID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5zaWduYWxzID0ge307XHJcbiAgICB0aGlzLnNpZ25hbHMuY2xpY2tlZCA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuaW5pdCgpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gQ2xvdGhlc0NhdGVnb3J5QnV0dG9uO1xyXG5DbG90aGVzQ2F0ZWdvcnlCdXR0b24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQSVhJLkNvbnRhaW5lci5wcm90b3R5cGUpO1xyXG5DbG90aGVzQ2F0ZWdvcnlCdXR0b24ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2xvdGhlc0NhdGVnb3J5QnV0dG9uO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5DbG90aGVzQ2F0ZWdvcnlCdXR0b24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbnsgICBcclxuICAgIHRoaXMuX2dyYXBoaWMgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKHRoaXMuX2Rlc2VsZWN0ZWQpKTtcclxuICAgIHRoaXMuX2dyYXBoaWMuaGl0QXJlYSA9IG5ldyBQSVhJLlJlY3RhbmdsZSh0aGlzLl9ncmFwaGljLl90ZXh0dXJlLnRyaW0ueCwgdGhpcy5fZ3JhcGhpYy5fdGV4dHVyZS50cmltLnksIHRoaXMuX2dyYXBoaWMuX3RleHR1cmUudHJpbS53aWR0aCwgdGhpcy5fZ3JhcGhpYy5fdGV4dHVyZS50cmltLmhlaWdodCk7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX2dyYXBoaWMpO1xyXG5cclxuICAgIHRoaXMuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG4gICAgdGhpcy5idXR0b25Nb2RlID0gdHJ1ZTtcclxuICAgIHRoaXMubW91c2Vkb3duID0gdGhpcy50b3VjaHN0YXJ0ID0gdGhpcy5vbk1vdXNlVXAuYmluZCh0aGlzKTtcclxufTtcclxuXHJcbkNsb3RoZXNDYXRlZ29yeUJ1dHRvbi5wcm90b3R5cGUuc2VsZWN0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcclxuICAgIHRoaXMuX2dyYXBoaWMudGV4dHVyZSA9IENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSh0aGlzLl9zZWxlY3RlZCk7XHJcbn07XHJcblxyXG5DbG90aGVzQ2F0ZWdvcnlCdXR0b24ucHJvdG90eXBlLmRlc2VsZWN0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9ncmFwaGljLnRleHR1cmUgPSBDb21tb24uYXNzZXRzLmdldFRleHR1cmUodGhpcy5fZGVzZWxlY3RlZCk7XHJcbn07XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNsb3RoZXNDYXRlZ29yeUJ1dHRvbi5wcm90b3R5cGUub25Nb3VzZVVwID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLnNpZ25hbHMuY2xpY2tlZC5kaXNwYXRjaCh0aGlzLmlkKTtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4iLCJ2YXIgQ29tbW9uID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxuXHJcbmZ1bmN0aW9uIENsb3RoZXNJdGVtQnV0dG9uKHRleHR1cmUsIGlkLCBjbGVhclNsb3RzLCBhZGRTbG90cylcclxue1xyXG4gICAgdmFyIHN0YXRlcyA9IG5ldyBwMy5CdXR0b25TdGF0ZXMoXHJcbiAgICAgICAgQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdjZWxsJyksIG51bGwsIG51bGwsIHRleHR1cmUpO1xyXG5cclxuXHRwMy5CdXR0b24uY2FsbCh0aGlzLCBzdGF0ZXMpO1xyXG5cclxuXHR0aGlzLmlkID0gaWQ7XHJcblx0dGhpcy5kZWZhdWx0SWNvblNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XHJcblx0dGhpcy5jbGVhclNsb3RzID0gY2xlYXJTbG90cztcclxuXHR0aGlzLmFkZFNsb3RzID0gYWRkU2xvdHM7XHJcblxyXG4gICAgdGhpcy5pbml0KCk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBDbG90aGVzSXRlbUJ1dHRvbjtcclxuQ2xvdGhlc0l0ZW1CdXR0b24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShwMy5CdXR0b24ucHJvdG90eXBlKTtcclxuQ2xvdGhlc0l0ZW1CdXR0b24ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2xvdGhlc0l0ZW1CdXR0b247XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNsb3RoZXNJdGVtQnV0dG9uLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57ICAgXHJcbiAgICB0aGlzLmFuaW1hdGUgPSBmYWxzZTtcclxuICAgIHRoaXMuYW5pbWF0ZUljb24gPSBmYWxzZTtcclxuXHJcbiAgICB2YXIgd3MgPSB0aGlzLl9iYWNrZ3JvdW5kLndpZHRoIC8gdGhpcy5faWNvbi53aWR0aDtcclxuICAgIHZhciBocyA9IHRoaXMuX2JhY2tncm91bmQuaGVpZ2h0IC8gdGhpcy5faWNvbi5oZWlnaHQ7XHJcbiAgICB0aGlzLl9pY29uLnNjYWxlLnggPSB0aGlzLl9pY29uLnNjYWxlLnkgPSB3czxocz93czpocztcclxuICAgIHRoaXMuZGVmYXVsdEljb25TY2FsZS54ID0gdGhpcy5faWNvbi5zY2FsZS54O1xyXG4gICAgdGhpcy5kZWZhdWx0SWNvblNjYWxlLnkgPSB0aGlzLl9pY29uLnNjYWxlLnk7XHJcbn07XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNsb3RoZXNJdGVtQnV0dG9uLnByb3RvdHlwZS5vbk1vdXNlT3ZlciA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKFR3ZWVuTWF4LmlzVHdlZW5pbmcodGhpcy5faWNvbikpXHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0dGwudG8odGhpcy5faWNvbi5zY2FsZSwgLjE1LCB7eDp0aGlzLmRlZmF1bHRJY29uU2NhbGUueCAqIDEuMSwgXHJcblx0XHRcdFx0XHRcdFx0XHQgeTp0aGlzLmRlZmF1bHRJY29uU2NhbGUueSAqIDEuMSxcclxuXHRcdFx0XHRcdFx0XHRcdCBlYXNlOlNpbmUuZWFzZUluT3V0fSk7XHJcblx0dGwudG8odGhpcy5faWNvbi5zY2FsZSwgMSwge3g6dGhpcy5kZWZhdWx0SWNvblNjYWxlLngsXHJcblx0XHRcdFx0XHRcdFx0XHR5OnRoaXMuZGVmYXVsdEljb25TY2FsZS55LFxyXG5cdFx0XHRcdFx0XHRcdFx0IGVhc2U6RWxhc3RpYy5lYXNlT3V0fSk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn1cclxuXHJcbkNsb3RoZXNJdGVtQnV0dG9uLnByb3RvdHlwZS5vbk1vdXNlT3V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiIsInZhciBDb21tb24gICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBDbG90aGVzQ2F0Z2VvcnlCdXR0b24gICA9IHJlcXVpcmUoXCIuL0Nsb3RoZXNDYXRlZ29yeUJ1dHRvblwiKTtcclxudmFyIENsb3RoZXNJdGVtQnV0dG9uICAgICAgID0gcmVxdWlyZShcIi4vQ2xvdGhlc0l0ZW1CdXR0b25cIik7XHJcbnZhciBTY3JvbGxCYXIgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuL1Njcm9sbEJhclwiKTtcclxudmFyIFR1dG9yaWFsRmluZ2VyICAgICAgICAgID0gcmVxdWlyZShcIi4vVHV0b3JpYWxGaW5nZXJcIik7XHJcblxyXG5mdW5jdGlvbiBDbG90aGVzTWVudSgpXHJcbntcclxuICAgIHRoaXMuX2NhdGVnb3J5QnV0dG9ucyA9IFtdO1xyXG5cclxuICAgIHRoaXMuX2JhY2tpbmcgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuX2l0ZW1Ib2xkZXIgPSBudWxsO1xyXG4gICAgdGhpcy5faXRlbUhvbGRlclNjcm9sbCA9IG51bGw7XHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyTWFzayA9IG51bGw7XHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyU2Nyb2xsV2luZG93U2l6ZSA9IDUwMDtcclxuXHJcbiAgICB0aGlzLl9jYXRlZ29yeUJ1dHRvbkhvbGRlciA9IG51bGw7XHJcbiAgICB0aGlzLl9jYXRlZ29yeUJ1dHRvblNlbGVjdGVkSG9sZGVyID0gbnVsbDtcclxuICAgIHRoaXMuX2ZyYW1lID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLl9pdGVtcyA9IFtdO1xyXG5cclxuICAgIHRoaXMuX3RvdWNoU2Nyb2xsUmVjdCA9IG51bGw7XHJcbiAgICB0aGlzLl90b3VjaFNjcm9sbEN1cnJlbnQgPSBudWxsO1xyXG4gICAgdGhpcy5fdG91Y2hTY3JvbGxMYXN0ID0gbnVsbDtcclxuICAgIHRoaXMuX3RvdWNoU2Nyb2xsTW9tZW50dW0gPSAwO1xyXG5cclxuICAgIHRoaXMudHV0b3JpYWxGaW5nZXIgPSBudWxsO1xyXG4gICAgdGhpcy5wcm9tcHRGaW5nZXIgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuY3VycmVudENhdGVnb3J5ID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLnNpZ25hbHMgPSB7fTtcclxuICAgIHRoaXMuc2lnbmFscy5pdGVtU2VsZWN0ZWQgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcclxuICAgIHRoaXMuc2lnbmFscy50dXRvcmlhbENvbXBsZXRlZCA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gQ2xvdGhlc01lbnU7XHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2xvdGhlc01lbnU7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9iYWNraW5nID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSgncGFuZWwnKSk7XHJcblxyXG4gICAgdGhpcy5fc2Nyb2xsQmFyID0gbmV3IFNjcm9sbEJhcig0MDAsIC0xNSk7XHJcbiAgICB0aGlzLl9zY3JvbGxCYXIueSA9IDA7XHJcbiAgICAvL3RoaXMuX3Njcm9sbEJhci5zY2FsZS54ID0gLTE7XHJcbiAgICB0aGlzLl9zY3JvbGxCYXIueCA9IDA7Ly81NjA7XHJcbiAgICB0aGlzLl9zY3JvbGxCYXIuaW5pdCgpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9zY3JvbGxCYXIpO1xyXG5cclxuICAgIHRoaXMuX3Njcm9sbEJhci5mb3JjZVBvc2l0aW9uKDQwMCk7XHJcblxyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9iYWNraW5nKTtcclxuXHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyLnggPSAxMjA7XHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyLnkgPSAxODA7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX2l0ZW1Ib2xkZXIpO1xyXG5cclxuICAgIHRoaXMuX2l0ZW1Ib2xkZXJTY3JvbGwgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuICAgIHRoaXMuX2l0ZW1Ib2xkZXIuYWRkQ2hpbGQodGhpcy5faXRlbUhvbGRlclNjcm9sbCk7XHJcblxyXG4gICAgdGhpcy5faXRlbUhvbGRlck1hc2sgPSBuZXcgUElYSS5HcmFwaGljcygpO1xyXG4gICAgdGhpcy5faXRlbUhvbGRlck1hc2suYmVnaW5GaWxsKDB4MDAwMDAwKTtcclxuICAgIHRoaXMuX2l0ZW1Ib2xkZXJNYXNrLm1vdmVUbyg0LCA3MCk7XHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyTWFzay5saW5lVG8oNTYxLCA3Nik7XHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyTWFzay5saW5lVG8oNTM4LCA2NTIpO1xyXG4gICAgdGhpcy5faXRlbUhvbGRlck1hc2subGluZVRvKDMwLCA2NTYpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9pdGVtSG9sZGVyTWFzayk7XHJcbiAgICB0aGlzLl9pdGVtSG9sZGVyLm1hc2sgPSB0aGlzLl9pdGVtSG9sZGVyTWFzaztcclxuXHJcbiAgICB0aGlzLl9jYXRlZ29yeUJ1dHRvbkhvbGRlciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9jYXRlZ29yeUJ1dHRvbkhvbGRlcik7XHJcblxyXG4gICAgdGhpcy5fZnJhbWUgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdwYW5lbF9mcmFtZScpKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fZnJhbWUpO1xyXG5cclxuICAgIHRoaXMuX2NhdGVnb3J5QnV0dG9uU2VsZWN0ZWRIb2xkZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fY2F0ZWdvcnlCdXR0b25TZWxlY3RlZEhvbGRlcik7XHJcblxyXG4gICAgdmFyIGNvdW50ID0gMDtcclxuICAgIGZvcih2YXIgaSBpbiBDb21tb24uY29uZmlnLmNsb3RoZXMpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGJ1dHRvbiA9IG5ldyBDbG90aGVzQ2F0Z2VvcnlCdXR0b24oaSwgQ29tbW9uLmNvbmZpZy5jbG90aGVzW2ldLmljb25fc2VsZWN0ZWQsIENvbW1vbi5jb25maWcuY2xvdGhlc1tpXS5pY29uX2Rlc2VsZWN0ZWQpO1xyXG4gICAgICAgIHRoaXMuX2NhdGVnb3J5QnV0dG9uSG9sZGVyLmFkZENoaWxkKGJ1dHRvbik7XHJcbiAgICAgICAgdGhpcy5fY2F0ZWdvcnlCdXR0b25zLnB1c2goYnV0dG9uKTtcclxuICAgICAgICBidXR0b24uc2lnbmFscy5jbGlja2VkLmFkZCh0aGlzLm9uQ2F0ZWdvcnlCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuICAgICAgICBjb3VudCsrO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc2V0Q2F0ZWdvcnkoaSk7XHJcblxyXG4gICAgdGhpcy5fdG91Y2hTY3JvbGxSZWN0ID0gbmV3IFBJWEkuUmVjdGFuZ2xlKDUwLCA5MCwgNDcwLCA1NTApO1xyXG4gICAgLyp2YXIgZ3IgPSBuZXcgUElYSS5HcmFwaGljcygpO1xyXG4gICAgZ3IubGluZVN0eWxlKDEsIDB4RkZGRkZGKTtcclxuICAgIGdyLmRyYXdTaGFwZSh0aGlzLl90b3VjaFNjcm9sbFJlY3QpO1xyXG4gICAgdGhpcy5hZGRDaGlsZChncik7Ki9cclxuXHJcbiAgICBDb21tb24uaW5wdXQuc2lnbmFscy5tb3VzZURvd24uYWRkKHRoaXMub25Ub3VjaFN0YXJ0LCB0aGlzKTtcclxuICAgIENvbW1vbi5pbnB1dC5zaWduYWxzLm1vdXNlVXAuYWRkKHRoaXMub25Ub3VjaEVuZCwgdGhpcyk7XHJcbiAgICBDb21tb24uaW5wdXQuc2lnbmFscy5tb3VzZU1vdmUuYWRkKHRoaXMub25Ub3VjaE1vdmUsIHRoaXMpO1xyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCBmdW5jdGlvbihlKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3Njcm9sbEJhci5zZXRUYXJnZXRZKHRoaXMuX3Njcm9sbEJhci55ICsgKDEwMCAqIE1hdGguc2lnbihlLmRlbHRhWSkpLCBmYWxzZSk7XHJcbiAgICB9LmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIENvbW1vbi5pbnB1dC5zaWduYWxzLm1vdXNlRG93bi5yZW1vdmUodGhpcy5vblRvdWNoU3RhcnQpO1xyXG4gICAgQ29tbW9uLmlucHV0LnNpZ25hbHMubW91c2VVcC5yZW1vdmUodGhpcy5vblRvdWNoRW5kKTtcclxuICAgIENvbW1vbi5pbnB1dC5zaWduYWxzLm1vdXNlTW92ZS5yZW1vdmUodGhpcy5vblRvdWNoTW92ZSk7XHJcbiAgICB0aGlzLl9zY3JvbGxCYXIuZGlzcG9zZSgpO1xyXG59O1xyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHZhciBwZXJjZW50ID0gdGhpcy5fc2Nyb2xsQmFyLnVwZGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2l0ZW1Ib2xkZXJTY3JvbGwueSA9IC0odGhpcy5faXRlbUhvbGRlci5oZWlnaHQgLSB0aGlzLl9pdGVtSG9sZGVyU2Nyb2xsV2luZG93U2l6ZSkgKiBwZXJjZW50O1xyXG5cclxuICAgIGlmKHRoaXMuX2l0ZW1Ib2xkZXIuaGVpZ2h0ID4gdGhpcy5faXRlbUhvbGRlclNjcm9sbFdpbmRvd1NpemUpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fc2Nyb2xsQmFyLmFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLl9zY3JvbGxCYXIuZHJhZ2dpbmcpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0aGlzLl90b3VjaFNjcm9sbEN1cnJlbnQgIT0gbnVsbClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hTY3JvbGxNb21lbnR1bSA9ICh0aGlzLl90b3VjaFNjcm9sbExhc3QgLSB0aGlzLl90b3VjaFNjcm9sbEN1cnJlbnQpICogNTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvdWNoU2Nyb2xsTGFzdCA9IHRoaXMuX3RvdWNoU2Nyb2xsQ3VycmVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvdWNoU2Nyb2xsTW9tZW50dW0gPSB0aGlzLl90b3VjaFNjcm9sbE1vbWVudHVtICogMC44O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZih0aGlzLl90b3VjaFNjcm9sbE1vbWVudHVtICE9IDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9zY3JvbGxCYXIuc2V0VGFyZ2V0WSh0aGlzLl9zY3JvbGxCYXIueSArIHRoaXMuX3RvdWNoU2Nyb2xsTW9tZW50dW0sIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoTWF0aC5hYnModGhpcy5fdG91Y2hTY3JvbGxNb21lbnR1bSkgPiAxMClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHV0b3JpYWxBY3Rpb25QZXJmb3JtZWQoJ3Njcm9sbCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihNYXRoLnJvdW5kKHRoaXMuX3RvdWNoU2Nyb2xsTW9tZW50dW0pID09IDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvdWNoU2Nyb2xsTW9tZW50dW0gPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RvdWNoU2Nyb2xsTW9tZW50dW0gPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9zY3JvbGxCYXIuZGVhY3RpdmF0ZSgpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLnNldENhdGVnb3J5ID0gZnVuY3Rpb24oaWQpXHJcbntcclxuICAgIGZvcih2YXIgaSBpbiB0aGlzLl9jYXRlZ29yeUJ1dHRvbnMpXHJcbiAgICB7XHJcbiAgICAgICAgaWYodGhpcy5fY2F0ZWdvcnlCdXR0b25zW2ldLmlkID09IGlkKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fY2F0ZWdvcnlCdXR0b25zW2ldLnNlbGVjdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9jYXRlZ29yeUJ1dHRvblNlbGVjdGVkSG9sZGVyLmFkZENoaWxkKHRoaXMuX2NhdGVnb3J5QnV0dG9uc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhdGVnb3J5QnV0dG9uc1tpXS5kZXNlbGVjdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9jYXRlZ29yeUJ1dHRvbkhvbGRlci5hZGRDaGlsZCh0aGlzLl9jYXRlZ29yeUJ1dHRvbnNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmZpbGxNZW51KGlkKTtcclxuICAgIHRoaXMuX3Njcm9sbEJhci5yZXNldCgpO1xyXG5cclxuICAgIHRoaXMuY3VycmVudENhdGVnb3J5ID0gaWQ7XHJcbn07XHJcblxyXG5DbG90aGVzTWVudS5wcm90b3R5cGUuZmlsbE1lbnUgPSBmdW5jdGlvbihpZClcclxue1xyXG4gICAgd2hpbGUodGhpcy5faXRlbXMubGVuZ3RoID4gMClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9pdGVtSG9sZGVyU2Nyb2xsLnJlbW92ZUNoaWxkKHRoaXMuX2l0ZW1zWzBdKTtcclxuICAgICAgICB0aGlzLl9pdGVtc1swXS5zaWduYWxzLmRvd24ucmVtb3ZlKHRoaXMub25JdGVtQnV0dG9uQ2xpY2tlZCk7XHJcbiAgICAgICAgdGhpcy5faXRlbXMuc3BsaWNlKDAsIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBqc29uID0gQ29tbW9uLmNvbmZpZy5jbG90aGVzW2lkXS5pdGVtcztcclxuXHJcbiAgICB2YXIgcm93ID0gMDtcclxuICAgIHZhciBjb2wgPSAwO1xyXG4gICAgdmFyIGNvbExpbWl0ID0gMztcclxuICAgIHZhciByb3dQYWRkaW5nID0gMTU7XHJcbiAgICB2YXIgY29sUGFkZGluZyA9IDE1O1xyXG5cclxuICAgIGZvcih2YXIgaSBpbiBqc29uKVxyXG4gICAge1xyXG4gICAgICAgIHZhciB0ZXh0dXJlID0gUElYSS5FbXB0eVRleHR1cmU7XHJcblxyXG4gICAgICAgIGlmKGpzb25baV0uaWNvbiAhPSBudWxsKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGV4dHVyZSA9IENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZShqc29uW2ldLmljb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGl0ZW0gPSBuZXcgQ2xvdGhlc0l0ZW1CdXR0b24odGV4dHVyZSwganNvbltpXS5pZCwganNvbltpXS5zbG90c190b19jbGVhciwganNvbltpXS5hdHRhY2htZW50cyk7XHJcbiAgICAgICAgaXRlbS54ID0gY29sKml0ZW0ud2lkdGggKyAoY29sKmNvbFBhZGRpbmcpO1xyXG4gICAgICAgIGl0ZW0ueSA9IHJvdyppdGVtLmhlaWdodCArIChyb3cqcm93UGFkZGluZyk7XHJcblxyXG4gICAgICAgIGlmKGpzb25baV0uaWNvbiAhPSBudWxsKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaXRlbS5zaWduYWxzLmRvd24uYWRkKHRoaXMub25JdGVtQnV0dG9uQ2xpY2tlZCwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9pdGVtcy5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIHRoaXMuX2l0ZW1Ib2xkZXJTY3JvbGwuYWRkQ2hpbGQoaXRlbSk7XHJcblxyXG4gICAgICAgIGNvbCsrO1xyXG4gICAgICAgIGlmKGNvbCA+PSBjb2xMaW1pdClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbCA9IDA7XHJcbiAgICAgICAgICAgIHJvdysrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLmFjdGl2YXRlQnV0dG9ucyA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdGhpcy5faXRlbUhvbGRlci5hbHBoYSA9IDE7XHJcbn1cclxuXHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZS5kZWFjdGl2YXRlQnV0dG9ucyA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdGhpcy5faXRlbUhvbGRlci5hbHBoYSA9IDAuNjtcclxufVxyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLnNldEZpcnN0VHV0b3JpYWwgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMudHV0b3JpYWxGaW5nZXIgPSBuZXcgVHV0b3JpYWxGaW5nZXIoMC41KTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy50dXRvcmlhbEZpbmdlcik7XHJcblxyXG4gICAgdGhpcy5pbml0aWFsaXNlVHV0b3JpYWwodGhpcy50dXRvcmlhbEZpbmdlcik7XHJcbn1cclxuXHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZS5zZXRQcm9tcHRUdXRvcmlhbCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgaWYodGhpcy50dXRvcmlhbEZpbmdlcilcclxuICAgIHtcclxuICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKHRoaXMudHV0b3JpYWxGaW5nZXIpO1xyXG4gICAgICAgIHRoaXMudHV0b3JpYWxGaW5nZXIgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucHJvbXB0RmluZ2VyID0gbmV3IFR1dG9yaWFsRmluZ2VyKDIwLCB0cnVlKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5wcm9tcHRGaW5nZXIpO1xyXG5cclxuICAgIHRoaXMuaW5pdGlhbGlzZVR1dG9yaWFsKHRoaXMucHJvbXB0RmluZ2VyKTtcclxufVxyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLmluaXRpYWxpc2VUdXRvcmlhbCA9IGZ1bmN0aW9uKGZpbmdlcilcclxue1xyXG4gICAgdmFyIGNsb3RoZXMgPSBbXHJcbiAgICAgICAgICAgIHt0eXBlOidtb3ZlJywgdGltZToxLCB4OjMyMCwgeToyODN9LFxyXG4gICAgICAgICAgICB7dHlwZTonZG93bicsIGRlbGF5OjAuMn0sXHJcbiAgICAgICAgICAgIHt0eXBlOid1cCcsIGRlbGF5OjAuNn0sXHJcbiAgICAgICAgICAgIHt0eXBlOidtb3ZlJywgdGltZToxLCB4OjQ2NiwgeTo0NjB9LFxyXG4gICAgICAgICAgICB7dHlwZTonZG93bicsIGRlbGF5OjAuMn0sXHJcbiAgICAgICAgICAgIHt0eXBlOid1cCcsIGRlbGF5OjAuNn0sXHJcbiAgICAgICAgICAgIHt0eXBlOidtb3ZlJywgdGltZToxLCB4OjMxMCwgeTo2MDB9LFxyXG4gICAgICAgICAgICB7dHlwZTonZG93bicsIGRlbGF5OjAuMn0sXHJcbiAgICAgICAgICAgIHt0eXBlOid1cCcsIGRlbGF5OjAuNn1cclxuICAgICAgICBdO1xyXG5cclxuICAgIHZhciBzY3JvbGwgPSBbXHJcbiAgICAgICAgICAgIHt0eXBlOid0YXJnZXQnLCB0aW1lOjEsIHRhcmdldDp0aGlzLl9zY3JvbGxCYXIsIG9mZnNldDp7eDo2NTAsIHk6MzAwfX0sXHJcbiAgICAgICAgICAgIHt0eXBlOidkb3duJywgZGVsYXk6MC4yfSxcclxuICAgICAgICAgICAge3R5cGU6J21vdmUnLCBkZWxheTouNSwgdGltZToxLCB4OjY1MC0zMCwgeTo2MTV9LFxyXG4gICAgICAgICAgICB7dHlwZTonbW92ZScsIHRpbWU6MSwgeDo2NTAsIHk6Mjk4fSxcclxuICAgICAgICAgICAge3R5cGU6J3VwJywgZGVsYXk6MC42fVxyXG4gICAgICAgIF07XHJcblxyXG4gICAgdmFyIGNhdGVnb3JpZXMgPSBbXHJcbiAgICAgICAgICAgIHt0eXBlOidtb3ZlJywgdGltZToxLCB4OjI1NSwgeToxNTd9LFxyXG4gICAgICAgICAgICB7dHlwZTonZG93bicsIGRlbGF5OjAuMn0sXHJcbiAgICAgICAgICAgIHt0eXBlOid1cCcsIGRlbGF5OjAuNn0sXHJcbiAgICAgICAgICAgIHt0eXBlOidtb3ZlJywgZGVsYXk6LjUsIHRpbWU6MC45LCB4OjM4OSwgeToxNTd9LFxyXG4gICAgICAgICAgICB7dHlwZTonZG93bicsIGRlbGF5OjAuMn0sXHJcbiAgICAgICAgICAgIHt0eXBlOid1cCcsIGRlbGF5OjAuNn0sXHJcbiAgICAgICAgICAgIHt0eXBlOidtb3ZlJywgZGVsYXk6LjUsIHRpbWU6MC45LCB4OjUyNCwgeToxNTd9LFxyXG4gICAgICAgICAgICB7dHlwZTonZG93bicsIGRlbGF5OjAuMn0sXHJcbiAgICAgICAgICAgIHt0eXBlOid1cCcsIGRlbGF5OjAuNn1cclxuICAgICAgICBdO1xyXG5cclxuICAgIGlmKGZpbmdlciA9PT0gdGhpcy50dXRvcmlhbEZpbmdlcilcclxuICAgIHtcclxuICAgICAgICBmaW5nZXIuYWRkU2VxdWVuY2UoJ2Nsb3RoZXMnLCBjbG90aGVzLCBuZXcgUElYSS5Qb2ludCgxNTUsIDIxNSksIDEsIDEpO1xyXG4gICAgICAgIGZpbmdlci5hZGRTZXF1ZW5jZSgnc2Nyb2xsJywgc2Nyb2xsLCBuZXcgUElYSS5Qb2ludCgzMTYsIDI5OCksIDEsIDIpO1xyXG4gICAgICAgIGZpbmdlci5hZGRTZXF1ZW5jZSgnY2F0ZWdvcmllcycsIGNhdGVnb3JpZXMsIG5ldyBQSVhJLlBvaW50KDEyNSwgMTcxKSwgMSwgMyk7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgZmluZ2VyLmFkZFNlcXVlbmNlKCdjbG90aGVzJywgY2xvdGhlcy5jb25jYXQoc2Nyb2xsLCBjYXRlZ29yaWVzKSwgbmV3IFBJWEkuUG9pbnQoMTU1LCAyMTUpLCAtMSwgMSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLl9pc1BvaW50V2l0aGluU2Nyb2xsUmVjdCA9IGZ1bmN0aW9uKHBvaW50KVxyXG57XHJcbiAgICByZXR1cm4gcG9pbnQueCA+IHRoaXMuX3RvdWNoU2Nyb2xsUmVjdC54ICYmIFxyXG4gICAgICAgICAgIHBvaW50LnggPCB0aGlzLl90b3VjaFNjcm9sbFJlY3QueCArIHRoaXMuX3RvdWNoU2Nyb2xsUmVjdC53aWR0aCAmJlxyXG4gICAgICAgICAgIHBvaW50LnkgPiB0aGlzLl90b3VjaFNjcm9sbFJlY3QueSAmJlxyXG4gICAgICAgICAgIHBvaW50LnkgPCB0aGlzLl90b3VjaFNjcm9sbFJlY3QueSArIHRoaXMuX3RvdWNoU2Nyb2xsUmVjdC5oZWlnaHQ7XHJcbn1cclxuXHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZS5fdHV0b3JpYWxBY3Rpb25QZXJmb3JtZWQgPSBmdW5jdGlvbih0dXRvcmlhbElkKVxyXG57XHJcbiAgICBpZih0aGlzLnR1dG9yaWFsRmluZ2VyICYmIHRoaXMudHV0b3JpYWxGaW5nZXIuY3VycmVudFNlcXVlbmNlID09IHR1dG9yaWFsSWQpXHJcbiAgICB7XHJcbiAgICAgICAgQ29tbW9uLnR1dG9yaWFsU3RhdGVzUGFzc2VkW3R1dG9yaWFsSWRdID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnR1dG9yaWFsRmluZ2VyLnJlbW92ZVNlcXVlbmNlKHR1dG9yaWFsSWQpO1xyXG4gICAgICAgIHRoaXMuc2lnbmFscy50dXRvcmlhbENvbXBsZXRlZC5kaXNwYXRjaChzY3JvbGwpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZih0aGlzLnByb21wdEZpbmdlcilcclxuICAgIHtcclxuICAgICAgICB0aGlzLnByb21wdEZpbmdlci5yZXNldFByb21wdCgpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZS5vbkNhdGVnb3J5QnV0dG9uQ2xpY2tlZCA9IGZ1bmN0aW9uKGlkKVxyXG57XHJcbiAgICB0aGlzLl90dXRvcmlhbEFjdGlvblBlcmZvcm1lZCgnY2F0ZWdvcmllcycpO1xyXG4gICAgdGhpcy5zZXRDYXRlZ29yeShpZCk7XHJcbiAgICBDb21tb24uYXVkaW8ucGxheVNvdW5kKCdzZnhfd2FyZHJvYmVfY2hhbmdlX2RyYXdfMDEnKTtcclxufTtcclxuXHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZS5vbkl0ZW1CdXR0b25DbGlja2VkID0gZnVuY3Rpb24oYnV0dG9uKVxyXG57XHJcbiAgICB0aGlzLl90dXRvcmlhbEFjdGlvblBlcmZvcm1lZCgnY2xvdGhlcycpO1xyXG4gICAgdGhpcy5zaWduYWxzLml0ZW1TZWxlY3RlZC5kaXNwYXRjaCh7aWQ6YnV0dG9uLmlkLCBjbGVhcjpidXR0b24uY2xlYXJTbG90cywgYWRkOmJ1dHRvbi5hZGRTbG90cywgYmFzZVNsb3RzOkNvbW1vbi5jb25maWcuY2xvdGhlc1t0aGlzLmN1cnJlbnRDYXRlZ29yeV0uYmFzZV9zbG90c30pO1xyXG59O1xyXG5cclxuQ2xvdGhlc01lbnUucHJvdG90eXBlLm9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uKGUpXHJcbntcclxuICAgIHZhciBwb3MgPSBlLmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzKTtcclxuICAgIGlmKHRoaXMuX2lzUG9pbnRXaXRoaW5TY3JvbGxSZWN0KHBvcykpXHJcbiAgICB7XHJcbiAgICAgICAgaWYodGhpcy5faXRlbUhvbGRlci5oZWlnaHQgPiB0aGlzLl9pdGVtSG9sZGVyU2Nyb2xsV2luZG93U2l6ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RvdWNoU2Nyb2xsQ3VycmVudCA9IHBvcy55O1xyXG4gICAgICAgICAgICB0aGlzLl90b3VjaFNjcm9sbExhc3QgPSBwb3MueTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcblxyXG5DbG90aGVzTWVudS5wcm90b3R5cGUub25Ub3VjaE1vdmUgPSBmdW5jdGlvbihlKVxyXG57XHJcbiAgICB2YXIgcG9zID0gZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcyk7XHJcblxyXG4gICAgaWYodGhpcy5fc2Nyb2xsQmFyLmRyYWdnaW5nKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3Njcm9sbEJhci5zZXRUYXJnZXRZKGUuZGF0YS5nZXRMb2NhbFBvc2l0aW9uKHRoaXMpLnkpO1xyXG4gICAgICAgIHRoaXMuX3R1dG9yaWFsQWN0aW9uUGVyZm9ybWVkKCdzY3JvbGwnKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYodGhpcy5fdG91Y2hTY3JvbGxDdXJyZW50ICE9IG51bGwgXHJcbiAgICAgICAgICAgICYmIHRoaXMuX2l0ZW1Ib2xkZXIuaGVpZ2h0ID4gdGhpcy5faXRlbUhvbGRlclNjcm9sbFdpbmRvd1NpemUgXHJcbiAgICAgICAgICAgICYmIHRoaXMuX2lzUG9pbnRXaXRoaW5TY3JvbGxSZWN0KHBvcykpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fdG91Y2hTY3JvbGxDdXJyZW50ID0gcG9zLnk7XHJcbiAgICB9XHJcbn1cclxuXHJcbkNsb3RoZXNNZW51LnByb3RvdHlwZS5vblRvdWNoRW5kID0gZnVuY3Rpb24oZSlcclxue1xyXG4gICAgaWYodGhpcy5fc2Nyb2xsQmFyLmRyYWdnaW5nKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3Njcm9sbEJhci5vblJlbGVhc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl90b3VjaFNjcm9sbEN1cnJlbnQgPSBudWxsO1xyXG4gICAgdGhpcy5fdG91Y2hTY3JvbGxMYXN0ID0gbnVsbDtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4iLCJ2YXIgQ29tbW9uICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEF1ZGlvUGFyYW1zICAgICA9IHJlcXVpcmUoXCIuLi9hdWRpby9BdWRpb1BhcmFtc1wiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5mdW5jdGlvbiBTY3JvbGxCYXIodmVydGljYWxSYW5nZSwgaG9yaXpvbnRhbENoYW5nZSlcclxue1xyXG4gICAgdGhpcy5fdmVydGljYWxSYW5nZSA9IHZlcnRpY2FsUmFuZ2U7XHJcbiAgICB0aGlzLl9ob3Jpem9udGFsQ2hhbmdlID0gaG9yaXpvbnRhbENoYW5nZTtcclxuICAgIHRoaXMuX3N0YXJ0aW5nUG9pbnQgPSBudWxsO1xyXG4gICAgdGhpcy5fZHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgIHRoaXMuX29mZnNldCA9IG51bGw7XHJcbiAgICB0aGlzLl9jbGlja09mZnNldCA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xyXG4gICAgdGhpcy5fdGFyZ2V0WSA9IDA7XHJcbiAgICB0aGlzLl9vbkRvd25Qb3MgPSBudWxsO1xyXG4gICAgdGhpcy5fbG9vcFNvdW5kID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgIFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBTY3JvbGxCYXI7XHJcblNjcm9sbEJhci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcblNjcm9sbEJhci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTY3JvbGxCYXI7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuU2Nyb2xsQmFyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB2YXIgdGV4dHVyZSA9IENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSgnYnRuX3Njcm9sbCcpO1xyXG5cdHZhciBncmFwaGljID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xyXG4gICAgdGhpcy5hZGRDaGlsZChncmFwaGljKTtcclxuXHJcbiAgICB0aGlzLl9zdGFydGluZ1BvaW50ID0gbmV3IFBJWEkuUG9pbnQodGhpcy54LCB0aGlzLnkpO1xyXG5cclxuICAgIHRoaXMuX29mZnNldCA9IG5ldyBQSVhJLlBvaW50KC10ZXh0dXJlLnRyaW0ueCwgLXRleHR1cmUudHJpbS55KTtcclxuXHJcbiAgICB0aGlzLmJ1dHRvbk1vZGUgPSB0cnVlO1xyXG4gICAgdGhpcy5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcbiAgICB0aGlzLmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUodGV4dHVyZS50cmltLnggKyAodGV4dHVyZS50cmltLndpZHRoLzIpLCB0ZXh0dXJlLnRyaW0ueSwgdGV4dHVyZS50cmltLndpZHRoLCB0ZXh0dXJlLnRyaW0uaGVpZ2h0KTtcclxuXHJcbiAgICB2YXIgcGFyYW1zID0gbmV3IEF1ZGlvUGFyYW1zKCk7XHJcbiAgICBwYXJhbXMubG9vcCA9IHRydWU7XHJcbiAgICB0aGlzLl9sb29wU291bmQgPSBDb21tb24uYXVkaW8ucGxheVNvdW5kKCdzZnhfc2Nyb2xsX3dhcmRyb2JlX2xvb3BfMDEnLCBwYXJhbXMpO1xyXG59O1xyXG5cclxuU2Nyb2xsQmFyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGlmKE1hdGgucm91bmQodGhpcy55IC0gdGhpcy5fdGFyZ2V0WSkgPT0gMCB8fCBDb21tb24ucGF1c2VkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2xvb3BTb3VuZC5ob3dsLnBhdXNlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKCF0aGlzLl9sb29wU291bmQuaG93bC5wbGF5aW5nKCkpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fbG9vcFNvdW5kLmhvd2wucGxheSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLnNldFBvc2l0aW9uKCk7XHJcbn07XHJcblxyXG5TY3JvbGxCYXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMuX2xvb3BTb3VuZC5zdG9wKCk7XHJcbn07XHJcblxyXG5TY3JvbGxCYXIucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLnkgPSB0aGlzLnkgKyAoKHRoaXMuX3RhcmdldFktdGhpcy55KSAvIDcpO1xyXG5cclxuICAgIHZhciBwZXJjZW50ID0gKHRoaXMueSAtIHRoaXMuX3N0YXJ0aW5nUG9pbnQueSkgLyB0aGlzLl92ZXJ0aWNhbFJhbmdlO1xyXG5cclxuICAgIHRoaXMueCA9IHRoaXMuX3N0YXJ0aW5nUG9pbnQueCArIChwZXJjZW50ICogdGhpcy5faG9yaXpvbnRhbENoYW5nZSk7XHJcblxyXG4gICAgcmV0dXJuIHBlcmNlbnQ7XHJcbn07XHJcblxyXG5TY3JvbGxCYXIucHJvdG90eXBlLnNldFRhcmdldFkgPSBmdW5jdGlvbih5UG9zLCBpbmNsdWRlT2Zmc2V0cylcclxue1xyXG4gICAgaW5jbHVkZU9mZnNldHMgPT0gdW5kZWZpbmVkICYmIChpbmNsdWRlT2Zmc2V0cyA9IHRydWUpO1xyXG5cclxuICAgIHZhciB5ID0geVBvcztcclxuXHJcbiAgICBpZihpbmNsdWRlT2Zmc2V0cylcclxuICAgICAgICB5ID0geVBvcyArIHRoaXMuX29mZnNldC55ICsgdGhpcy5fY2xpY2tPZmZzZXQueTtcclxuXHJcbiAgICB2YXIgdGFyZ2V0WSA9IE1hdGgubWluKHRoaXMuX3N0YXJ0aW5nUG9pbnQueSArIHRoaXMuX3ZlcnRpY2FsUmFuZ2UsIFxyXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KHRoaXMuX3N0YXJ0aW5nUG9pbnQueSwgXHJcbiAgICAgICAgICAgICAgICAgICAgeSkpO1xyXG5cclxuICAgIGlmKCFpc05hTih0YXJnZXRZKSlcclxuICAgICAgICB0aGlzLl90YXJnZXRZID0gdGFyZ2V0WTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fdGFyZ2V0WTtcclxufTtcclxuXHJcblNjcm9sbEJhci5wcm90b3R5cGUuZm9yY2VQb3NpdGlvbiA9IGZ1bmN0aW9uKHkpXHJcbntcclxuICAgIHRoaXMueSA9IHk7XHJcbiAgICB0aGlzLl90YXJnZXRZID0geTtcclxufTtcclxuXHJcblNjcm9sbEJhci5wcm90b3R5cGUuc2V0UGVyY2VudGFnZSA9IGZ1bmN0aW9uKHBlcmNlbnRhZ2UpXHJcbntcclxuICAgIHRoaXMuc2V0VGFyZ2V0WSh0aGlzLl9zdGFydGluZ1BvaW50LnkgKyAocGVyY2VudGFnZSAqIHRoaXMuX3ZlcnRpY2FsUmFuZ2UpKTtcclxufVxyXG5cclxuU2Nyb2xsQmFyLnByb3RvdHlwZS5hZGRJbmNyZW1lbnQgPSBmdW5jdGlvbihpbmMpXHJcbntcclxuXHJcbn1cclxuXHJcblNjcm9sbEJhci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMuc2V0UG9zaXRpb24odGhpcy5zZXRQZXJjZW50YWdlKDApKTtcclxufVxyXG5cclxuU2Nyb2xsQmFyLnByb3RvdHlwZS5hY3RpdmF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdGhpcy5fYWN0aXZlID0gdHJ1ZTtcclxuICAgIHRoaXMuYWxwaGEgPSAxO1xyXG4gICAgdGhpcy5tb3VzZWRvd24gPSB0aGlzLnRvdWNoc3RhcnQgPSB0aGlzLm9uRG93bi5iaW5kKHRoaXMpO1xyXG59XHJcblxyXG5TY3JvbGxCYXIucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMuX2FjdGl2ZSA9IHRydWU7XHJcbiAgICB0aGlzLmFscGhhID0gMC4zO1xyXG4gICAgdGhpcy5tb3VzZWRvd24gPSB0aGlzLnRvdWNoc3RhcnQgPSBudWxsO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuU2Nyb2xsQmFyLnByb3RvdHlwZS5vbkRvd24gPSBmdW5jdGlvbihldmVudClcclxue1xyXG4gICAgdGhpcy5fZHJhZ2dpbmcgPSB0cnVlO1xyXG4gICAgdGhpcy5fY2xpY2tPZmZzZXQgPSBldmVudC5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcyk7XHJcbiAgICB0aGlzLl9jbGlja09mZnNldC55ID0gLSh0aGlzLl9jbGlja09mZnNldC55ICsgdGhpcy5fb2Zmc2V0LnkpO1xyXG4gICAgdGhpcy5idXR0b25Nb2RlID0gZmFsc2U7XHJcbiAgICB0aGlzLl9vbkRvd25Qb3MgPSB0aGlzLnk7XHJcbn07XHJcblxyXG5TY3JvbGxCYXIucHJvdG90eXBlLm9uUmVsZWFzZSA9IGZ1bmN0aW9uKGV2ZW50KVxyXG57XHJcbiAgICB0aGlzLl9kcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgdGhpcy5idXR0b25Nb2RlID0gdHJ1ZTtcclxuXHJcbiAgICBpZihNYXRoLnJvdW5kKHRoaXMueSkgPT0gTWF0aC5yb3VuZCh0aGlzLl9vbkRvd25Qb3MpKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuc2V0VGFyZ2V0WSh0aGlzLnkgKyAodGhpcy5fY2xpY2tPZmZzZXQueSA8IC02NSA/IDE1MCA6IC0xNTApLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9vbkRvd25Qb3MgPSBudWxsO1xyXG4gICAgdGhpcy5fY2xpY2tPZmZzZXQgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcclxufTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbEJhci5wcm90b3R5cGUsIFwiZHJhZ2dpbmdcIiwge1xyXG5cclxuICAgIGdldDogZnVuY3Rpb24oKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kcmFnZ2luZztcclxuICAgIH1cclxufSk7XHJcblxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsQmFyLnByb3RvdHlwZSwgXCJvZmZzZXRcIiwge1xyXG5cclxuICAgIGdldDogZnVuY3Rpb24oKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vZmZzZXQ7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4iLCJ2YXIgQ29tbW9uICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG5cclxuZnVuY3Rpb24gVGl0bGVCYXIoKVxyXG57XHJcbiAgICB0aGlzLl9iYXIgPSBudWxsO1xyXG4gICAgdGhpcy5fZmllbGQgPSBudWxsO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuaW5pdCgpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gVGl0bGVCYXI7XHJcblRpdGxlQmFyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuVGl0bGVCYXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVGl0bGVCYXI7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblRpdGxlQmFyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9iYXIgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdoaW50JykpO1xyXG4gICAgdGhpcy5fYmFyLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fYmFyKTtcclxuXHJcbiAgICAvL3RoaXMuX2ZpZWxkID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoJycsIHtmb250OlwiV2luZHNvckVGLUVsb25nYXRlZFwiLCBhbGlnbjonY2VudGVyJ30pO1xyXG4gICAgdGhpcy5fZmllbGQgPSBuZXcgUElYSS5UZXh0KCcnLCB7XHJcbiAgICAgICAgICAgIGZvbnQ6XCI1OHB4IFdpbmRzb3IgRWxvbmdhdGVkXCIsIFxyXG4gICAgICAgICAgICBhbGlnbjonY2VudGVyJyxcclxuICAgICAgICAgICAgZmlsbEdyYWRpZW50VHlwZTpQSVhJLlRFWFRfR1JBRElFTlQuTElORUFSX1ZFUlRJQ0FMLFxyXG4gICAgICAgICAgICBmaWxsOlsweGZlZjQ5ZCwgMHhmOGI3MTFdLFxyXG4gICAgICAgICAgICBmaWxsR3JhZGllbnRTdG9wczpbMCwgMV0sXHJcbiAgICAgICAgICAgIGRyb3BTaGFkb3c6dHJ1ZSxcclxuICAgICAgICAgICAgZHJvcFNoYWRvd0FuZ2xlOjkwKlBJWEkuREVHX1RPX1JBRCxcclxuICAgICAgICAgICAgZHJvcFNoYWRvd0FscGhhOjAuNSxcclxuICAgICAgICAgICAgZHJvcFNoYWRvd0Rpc3RhbmNlOjMuNVxyXG4gICAgICAgIH0pO1xyXG4gICAgdGhpcy5fZmllbGQuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9maWVsZCk7XHJcblxyXG5cclxuICAgIHRoaXMuc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcclxufTtcclxuXHJcblRpdGxlQmFyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59O1xyXG5cclxuVGl0bGVCYXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdFxyXG59O1xyXG5cclxuVGl0bGVCYXIucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbih0ZXh0KVxyXG57XHJcbiAgICBUd2Vlbk1heC5raWxsVHdlZW5zT2YodGhpcyk7XHJcbiAgICB0aGlzLmFscGhhID0gMTtcclxuXHJcbiAgICB2YXIgdGV4dENvbmYgPSBDb21tb24uY29uZmlnLnN0cmluZ3NbdGV4dF1bQ29tbW9uLmxhbmd1YWdlXTtcclxuICAgIHZhciBmb250Q29uZiA9IENvbW1vbi5jb25maWcuc3RyaW5nc19mb3JtYXR0aW5nW3RleHRdW0NvbW1vbi5sYW5ndWFnZV07XHJcbiAgICB0aGlzLl9maWVsZC50ZXh0ID0gdGV4dENvbmY7XHJcbiAgICB0aGlzLl9maWVsZC5mb250ID0gZm9udENvbmYuZm9udDtcclxuICAgIHRoaXMuX2ZpZWxkLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoZm9udENvbmYuc2l6ZVBlcmNlbnQvMTAwLCBmb250Q29uZi5zaXplUGVyY2VudC8xMDApO1xyXG5cclxuICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGhpcy5zY2FsZSwgLjMsIHtzdGFydEF0Ont4OjAsIHk6MH0sIHg6MSwgZWFzZTpCYWNrLmVhc2VPdXR9KSk7XHJcbiAgICBDb21tb24uYW5pbWF0b3IuYWRkKFR3ZWVuTWF4LnRvKHRoaXMuc2NhbGUsIC4zLCB7ZGVsYXk6LjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9KSk7XHJcbn1cclxuXHJcblRpdGxlQmFyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbihyZW1vdmVUaW1lKVxyXG57XHJcbiAgICBDb21tb24uYW5pbWF0b3IuYWRkKFR3ZWVuTWF4LnRvKHRoaXMsIDIsIHtkZWxheTpyZW1vdmVUaW1lLCBhbHBoYTowfSkpO1xyXG59XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuIiwidmFyIENvbW1vbiAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxuXHJcbmZ1bmN0aW9uIFR1dG9yaWFsRmluZ2VyKHNlcXVlbmNlSW50ZXJ2YWwsIHByb21wdE1vZGUpXHJcbntcclxuICAgIHRoaXMuc2VxdWVuY2VzID0ge307XHJcbiAgICB0aGlzLnNlcXVlbmNlSW50ZXJ2YWwgPSBzZXF1ZW5jZUludGVydmFsIHx8IDM7XHJcbiAgICB0aGlzLmZpbmdlciA9IG51bGw7XHJcbiAgICB0aGlzLmN1cnJlbnRTZXF1ZW5jZSA9IG51bGw7XHJcbiAgICB0aGlzLnByb21wdE1vZGUgPSBwcm9tcHRNb2RlIHx8IGZhbHNlO1xyXG5cclxuICAgIHRoaXMuc2lnbmFscyA9IHt9O1xyXG4gICAgdGhpcy5zaWduYWxzLnR1dG9yaWFsU3RhcnRlZCA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cclxuICAgIHRoaXMudGltZXIgPSBudWxsO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuaW5pdCgpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gVHV0b3JpYWxGaW5nZXI7XHJcblR1dG9yaWFsRmluZ2VyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuVHV0b3JpYWxGaW5nZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVHV0b3JpYWxGaW5nZXI7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblR1dG9yaWFsRmluZ2VyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLmZpbmdlciA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uYXNzZXRzLmdldFRleHR1cmUoJ3R1dG9yaWFsX2hhbmQnKSk7XHJcbiAgICB0aGlzLmZpbmdlci5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDEpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLmZpbmdlcik7XHJcblxyXG4gICAgdGhpcy5hbHBoYSA9IDA7XHJcblxyXG4gICAgdGhpcy5maW5nZXIuaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuICAgIHRoaXMuZmluZ2VyLmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgMCwgMCk7XHJcblxyXG4gICAgdGhpcy50aW1lciA9IENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KHRoaXMub25TZXF1ZW5jZUludGVydmFsRW5kZWQsIHRoaXMuc2VxdWVuY2VJbnRlcnZhbCwgdGhpcyk7XHJcbn07XHJcblxyXG5UdXRvcmlhbEZpbmdlci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufTtcclxuXHJcblR1dG9yaWFsRmluZ2VyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuXHRcclxufTtcclxuXHJcblR1dG9yaWFsRmluZ2VyLnByb3RvdHlwZS5hZGRTZXF1ZW5jZSA9IGZ1bmN0aW9uKGlkLCBzZXF1ZW5jZSwgc3RhcnRQb2ludCwgcmVwZWF0LCBpbXBvcnRhbmNlKVxyXG57XHJcbiAgICB0aGlzLnNlcXVlbmNlc1tpZF0gPSB7c2VxdWVuY2U6c2VxdWVuY2UsIHJlcGVhdDpyZXBlYXQsIHN0YXJ0UG9pbnQ6c3RhcnRQb2ludCwgaW1wb3J0YW5jZTppbXBvcnRhbmNlfTtcclxufTtcclxuXHJcblR1dG9yaWFsRmluZ2VyLnByb3RvdHlwZS5yZW1vdmVTZXF1ZW5jZSA9IGZ1bmN0aW9uKGlkKVxyXG57XHJcbiAgICBpZih0aGlzLnNlcXVlbmNlc1tpZF0pXHJcbiAgICB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMuc2VxdWVuY2VzW2lkXTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5jdXJyZW50U2VxdWVuY2UgPT0gaWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBUd2Vlbk1heC5raWxsVHdlZW5zT2YodGhpcyk7XHJcbiAgICAgICAgICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZih0aGlzLnNjYWxlKTtcclxuICAgICAgICAgICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLnNjYWxlLCAuMywge3k6MSwgZWFzZTpTaW5lLmVhc2VPdXR9KSk7XHJcbiAgICAgICAgICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGhpcywgLjMsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZU91dH0pKTtcclxuICAgICAgICAgICAgdGhpcy50aW1lciA9IENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KHRoaXMub25TZXF1ZW5jZUludGVydmFsRW5kZWQsIHRoaXMuc2VxdWVuY2VJbnRlcnZhbCwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuVHV0b3JpYWxGaW5nZXIucHJvdG90eXBlLnNldFNlcXVlbmNlID0gZnVuY3Rpb24oaWQpXHJcbntcclxuICAgIHZhciBzZXF1ZW5jZSA9IHRoaXMuc2VxdWVuY2VzW2lkXTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhzZXF1ZW5jZSk7XHJcblxyXG4gICAgdGhpcy54ID0gc2VxdWVuY2Uuc3RhcnRQb2ludC54O1xyXG4gICAgdGhpcy55ID0gc2VxdWVuY2Uuc3RhcnRQb2ludC55O1xyXG5cclxuICAgIHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7cmVwZWF0OnNlcXVlbmNlLnJlcGVhdCwgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtcclxuICAgICAgICB0aGlzLnRpbWVyID0gQ29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQodGhpcy5vblNlcXVlbmNlSW50ZXJ2YWxFbmRlZCwgdGhpcy5zZXF1ZW5jZUludGVydmFsLCB0aGlzKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZXF1ZW5jZSA9IG51bGw7XHJcbiAgICB9fSk7XHJcbiAgICB0bC50byh0aGlzLCAuMywge2FscGhhOjF9KTtcclxuICAgIGZvcih2YXIgaSBpbiBzZXF1ZW5jZS5zZXF1ZW5jZSlcclxuICAgIHtcclxuICAgICAgICB2YXIgcyA9IHNlcXVlbmNlLnNlcXVlbmNlW2ldO1xyXG4gICAgICAgIGlmKHMudHlwZSA9PSAnbW92ZScpXHJcbiAgICAgICAgICAgIHRsLnRvKHRoaXMsIHMudGltZSwge2RlbGF5OnMuZGVsYXksIHg6cy54LCB5OnMueSwgZWFzZTpTaW5lLmVhc2VJbk91dH0pO1xyXG4gICAgICAgIGVsc2UgaWYocy50eXBlID09ICdkb3duJylcclxuICAgICAgICAgICAgdGwudG8odGhpcy5zY2FsZSwgcy50aW1lIHx8IDAuMiwge2RlbGF5OnMuZGVsYXksIHk6MC44LCBlYXNlOlNpbmUuZWFzZUluT3V0fSk7XHJcbiAgICAgICAgZWxzZSBpZihzLnR5cGUgPT0gJ3VwJylcclxuICAgICAgICAgICAgdGwudG8odGhpcy5zY2FsZSwgcy50aW1lIHx8IDAuMywge2RlbGF5OnMuZGVsYXksIHk6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0pO1xyXG4gICAgICAgIGVsc2UgaWYocy50eXBlID09ICd0YXJnZXQnKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocyk7XHJcbiAgICAgICAgICAgIHRsLnRvKHRoaXMsIHMudGltZSwge2RlbGF5OnMuZGVsYXksIHg6cy50YXJnZXQueCArIChzLm9mZnNldCA/IHMub2Zmc2V0LnggOiAwKSwgeTpzLnRhcmdldC55ICsgKHMub2Zmc2V0ID8gcy5vZmZzZXQueSA6IDApLCBlYXNlOlNpbmUuZWFzZUluT3V0fSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGwudG8odGhpcywgLjMsIHthbHBoYTowfSk7XHJcbiAgICBDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcbiAgICB0aGlzLmN1cnJlbnRTZXF1ZW5jZSA9IGlkO1xyXG5cclxuICAgIHRoaXMuc2lnbmFscy50dXRvcmlhbFN0YXJ0ZWQuZGlzcGF0Y2goaWQpO1xyXG59XHJcblxyXG5UdXRvcmlhbEZpbmdlci5wcm90b3R5cGUucmVzZXRQcm9tcHQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZih0aGlzKTtcclxuICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZih0aGlzLnNjYWxlKTtcclxuICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGhpcy5zY2FsZSwgLjMsIHt5OjEsIGVhc2U6U2luZS5lYXNlT3V0fSkpO1xyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLCAuMywge2FscGhhOjB9KSk7XHJcblxyXG4gICAgaWYoIXRoaXMudGltZXIuY29tcGxldGUpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy50aW1lci5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMudGltZXIuc3RhcnQoKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICB0aGlzLnRpbWVyID0gQ29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQodGhpcy5vblNlcXVlbmNlSW50ZXJ2YWxFbmRlZCwgdGhpcy5zZXF1ZW5jZUludGVydmFsLCB0aGlzKTtcclxuICAgIH1cclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5UdXRvcmlhbEZpbmdlci5wcm90b3R5cGUub25TZXF1ZW5jZUludGVydmFsRW5kZWQgPSBmdW5jdGlvbihpZClcclxue1xyXG4gICAgY29uc29sZS5sb2coJ29uU2VxdWVuY2VJbnRlcnZhbEVuZGVkJyk7XHJcbiAgICBpZighdGhpcy5wcm9tcHRNb2RlKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBtb3N0SW1wb3J0YW50ID0gbnVsbDtcclxuICAgICAgICB2YXIgbW9zdEltcG9ydGFudE51bWJlciA9IG51bGw7XHJcbiAgICAgICAgZm9yKHZhciBpIGluIHRoaXMuc2VxdWVuY2VzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYobW9zdEltcG9ydGFudE51bWJlciA9PSBudWxsIHx8IHRoaXMuc2VxdWVuY2VzW2ldLmltcG9ydGFuY2UgPCBtb3N0SW1wb3J0YW50TnVtYmVyKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBtb3N0SW1wb3J0YW50ID0gaTtcclxuICAgICAgICAgICAgICAgIG1vc3RJbXBvcnRhbnROdW1iZXIgPSB0aGlzLnNlcXVlbmNlc1tpXS5pbXBvcnRhbmNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKG1vc3RJbXBvcnRhbnQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnNldFNlcXVlbmNlKG1vc3RJbXBvcnRhbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICB2YXIgYXJyID0gW107XHJcbiAgICAgICAgZm9yKHZhciBpIGluIHRoaXMuc2VxdWVuY2VzKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYXJyLnB1c2goaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGFycik7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U2VxdWVuY2UoYXJyWzBdKTtcclxuICAgIH1cclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4iLCIvL2ltcG9ydCBNYWluIGZyb20gJy4vTWFpbic7XHJcbnZhciBNYWluID0gcmVxdWlyZShcIi4vTWFpblwiKTtcclxuXHJcbmdsb2JhbC5NYWluID0gTWFpbjtcclxuXHJcbnAzLmxvZyA9IGNvbnNvbGUubG9nO1xyXG4iLCJ2YXIgQ29tbW9uICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiAgICA9IHJlcXVpcmUoJy4uL3NjcmVlbnMvU2ltcGxlU2NyZWVuJyk7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gUGF1c2VPdmVybGF5KClcclxue1xyXG4gICAgdGhpcy5fcGFuZWwgPSBudWxsO1xyXG4gICAgdGhpcy5fYnV0dG9ucyA9IFtdO1xyXG5cclxuICAgIHRoaXMuX2NvbnRlbnRzICAgICAgICAgID0gbnVsbDtcclxuICAgIHRoaXMuX2ltYWdlQ29udGFpbmVyICAgID0gbnVsbDtcclxuICAgIHRoaXMuX2hlbHBUZXh0ICAgICAgICAgID0gbnVsbDtcclxuICAgIHRoaXMuX2NvbmZpcm1Db250YWluZXIgID0gbnVsbDtcclxuICAgIHRoaXMuX2ltYWdlICAgICAgICAgICAgID0gbnVsbDtcclxuICAgIHRoaXMuX2xlZnRCdXR0b24gICAgICAgID0gbnVsbDtcclxuICAgIHRoaXMuX3JpZ2h0QnV0dG9uICAgICAgID0gbnVsbDtcclxuICAgIHRoaXMuX2hvbWVCdXR0b24gICAgICAgID0gbnVsbDtcclxuICAgIHRoaXMuX2N1cnJlbnRQYWdlICAgICAgID0gMDtcclxuICAgIHRoaXMuX2N1cnJlbnRTdGVwICAgICAgID0gMDtcclxuICAgIHRoaXMuX2xhc3RTdGVwVGltZSAgICAgID0gMDtcclxuXHJcbiAgICBTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxufVxyXG5cclxuUGF1c2VPdmVybGF5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQYXVzZU92ZXJsYXk7XHJcbm1vZHVsZS5leHBvcnRzID0gUGF1c2VPdmVybGF5O1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG4gICAgQ29tbW9uLnBhdXNlZCA9IHRydWU7XHJcbiAgICBDb21tb24uYW5pbWF0b3IucGF1c2VkID0gdHJ1ZTtcclxuXHJcbiAgICB0aGlzLmFkZE92ZXJsYXkoKTtcclxuXHJcbiAgICB0aGlzLl9wYW5lbCA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uYXNzZXRzLmdldFRleHR1cmUoJ3BhdXNlJykpO1xyXG4gICAgdGhpcy5fcGFuZWwuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xyXG4gICAgdGhpcy5fcGFuZWwueCA9IENvbW1vbi5TVEFHRV9XSURUSCAvIDI7XHJcbiAgICB0aGlzLl9wYW5lbC55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDI7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3BhbmVsKTtcclxuXHJcbiAgICB2YXIgdGl0bGUgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdwYXVzZWQnKSk7XHJcbiAgICB0aXRsZS5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XHJcbiAgICB0aXRsZS55ID0gLTI4MDtcclxuICAgIHRoaXMuX3BhbmVsLmFkZENoaWxkKHRpdGxlKTtcclxuICAgIFxyXG4gICAgdmFyIG11dGVCdXR0b24gPSB0aGlzLmFkZE11dGVCdXR0b24oMjQ4LCAyNDIpO1xyXG4gICAgdGhpcy5fcGFuZWwuYWRkQ2hpbGQobXV0ZUJ1dHRvbik7XHJcbiAgICB0aGlzLl9idXR0b25zLnB1c2gobXV0ZUJ1dHRvbik7XHJcblxyXG4gICAgdGhpcy5faG9tZUJ1dHRvbiA9IHRoaXMuYWRkSG9tZUJ1dHRvbigtMjE1LCAyNDIpO1xyXG4gICAgdGhpcy5fcGFuZWwuYWRkQ2hpbGQodGhpcy5faG9tZUJ1dHRvbik7XHJcbiAgICB0aGlzLl9idXR0b25zLnB1c2godGhpcy5faG9tZUJ1dHRvbik7XHJcblxyXG4gICAgdmFyIHBsYXlCdXR0b24gPSB0aGlzLl9nZW5lcmF0ZUJ1dHRvbignaWNvbl9wbGF5X2xhcmdlJywgJ3Jlc3VtZScsICdwcmltYXJ5X2xhcmdlJyk7XHJcbiAgICBwbGF5QnV0dG9uLnggPSAxMDtcclxuICAgIHBsYXlCdXR0b24ueSA9IDI1MDtcclxuICAgIHBsYXlCdXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vblBsYXlCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuICAgIHRoaXMuX3BhbmVsLmFkZENoaWxkKHBsYXlCdXR0b24pO1xyXG4gICAgdGhpcy5fYnV0dG9ucy5wdXNoKHBsYXlCdXR0b24pO1xyXG5cclxuICAgIC8vSEVMUFxyXG5cclxuICAgIC8vdGhpcy5faGVscFRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dCgnJywge2ZvbnQ6XCJXaW5kc29yRUYtRWxvbmdhdGVkXCIsIGFsaWduOidjZW50ZXInfSk7XHJcbiAgICB0aGlzLl9oZWxwVGV4dCA9IG5ldyBQSVhJLlRleHQoJycsIHtcclxuICAgICAgICAgICAgZm9udDpcIjU4cHggV2luZHNvciBFbG9uZ2F0ZWRcIiwgXHJcbiAgICAgICAgICAgIGFsaWduOidjZW50ZXInLFxyXG4gICAgICAgICAgICBmaWxsR3JhZGllbnRUeXBlOlBJWEkuVEVYVF9HUkFESUVOVC5MSU5FQVJfVkVSVElDQUwsXHJcbiAgICAgICAgICAgIGZpbGw6WzB4ZmVmNDlkLCAweGY4YjcxMV0sXHJcbiAgICAgICAgICAgIGZpbGxHcmFkaWVudFN0b3BzOlswLCAxXSxcclxuICAgICAgICAgICAgZHJvcFNoYWRvdzp0cnVlLFxyXG4gICAgICAgICAgICBkcm9wU2hhZG93QW5nbGU6OTAqUElYSS5ERUdfVE9fUkFELFxyXG4gICAgICAgICAgICBkcm9wU2hhZG93QWxwaGE6MC41LFxyXG4gICAgICAgICAgICBkcm9wU2hhZG93RGlzdGFuY2U6My41XHJcbiAgICAgICAgfSk7XHJcbiAgICB0aGlzLl9oZWxwVGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcbiAgICB0aGlzLl9oZWxwVGV4dC55ID0gMTIyO1xyXG4gICAgdGhpcy5fcGFuZWwuYWRkQ2hpbGQodGhpcy5faGVscFRleHQpO1xyXG5cclxuICAgIHZhciBzZXRIZWxwVGV4dCA9IGZ1bmN0aW9uKHRleHQpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIHRleHRDb25mID0gQ29tbW9uLmNvbmZpZy5zdHJpbmdzW3RleHRdW0NvbW1vbi5sYW5ndWFnZV07XHJcbiAgICAgICAgdmFyIGZvbnRDb25mID0gQ29tbW9uLmNvbmZpZy5zdHJpbmdzX2Zvcm1hdHRpbmdbdGV4dF1bQ29tbW9uLmxhbmd1YWdlXTtcclxuICAgICAgICB0aGlzLl9oZWxwVGV4dC50ZXh0ID0gdGV4dENvbmY7XHJcbiAgICAgICAgdGhpcy5faGVscFRleHQuZm9udCA9IGZvbnRDb25mLmZvbnQ7XHJcbiAgICAgICAgdGhpcy5faGVscFRleHQuc2NhbGUgPSBuZXcgUElYSS5Qb2ludChmb250Q29uZi5zaXplUGVyY2VudC8xMDAsIGZvbnRDb25mLnNpemVQZXJjZW50LzEwMCk7XHJcbiAgICB9LmJpbmQodGhpcyk7XHJcblxyXG4gICAgdmFyIHR3ZWVuQWxwaGFPdXQgPSBmdW5jdGlvbihvYmosIGNhbGxiYWNrU2NvcGUsIGNhbGxiYWNrKXtcclxuICAgICAgICBUd2Vlbk1heC50byhvYmosIC4zLCB7YWxwaGE6MCwgb25Db21wbGV0ZVNjb3BlOmNhbGxiYWNrU2NvcGUgfHwgbnVsbCwgb25Db21wbGV0ZTpjYWxsYmFjayB8fCBudWxsfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHR3ZWVuQWxwaGFJbiA9IGZ1bmN0aW9uKG9iaiwgY2FsbGJhY2tTY29wZSwgY2FsbGJhY2spe1xyXG4gICAgICAgIFR3ZWVuTWF4LnRvKG9iaiwgLjMsIHthbHBoYToxLCBvbkNvbXBsZXRlU2NvcGU6Y2FsbGJhY2tTY29wZSB8fCBudWxsLCBvbkNvbXBsZXRlOmNhbGxiYWNrIHx8IG51bGx9KTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgZHJlc3NVcFNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgICAgIGRyZXNzVXBTY3JlZW4uYmcgPSB0aGlzLl9hZGRJbWFnZVRvVHV0b3JpYWxDb250ZW50KGRyZXNzVXBTY3JlZW4sICdoZWxwX2Nsb3RoZXNfYmcnKTtcclxuICAgICAgICBkcmVzc1VwU2NyZWVuLmljb24xID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChkcmVzc1VwU2NyZWVuLCAnaGVscF9jbG90aGVzX2ljb24xJywgMC45KTtcclxuICAgICAgICBkcmVzc1VwU2NyZWVuLmljb24yID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChkcmVzc1VwU2NyZWVuLCAnaGVscF9jbG90aGVzX2ljb24yJywgMC45KTtcclxuICAgICAgICBkcmVzc1VwU2NyZWVuLmRvdDEgPSB0aGlzLl9hZGRJbWFnZVRvVHV0b3JpYWxDb250ZW50KGRyZXNzVXBTY3JlZW4sICdoZWxwX2Nsb3RoZXNfZG9yb3RoeTEnLCAwLjkpO1xyXG4gICAgICAgIGRyZXNzVXBTY3JlZW4uZG90MiA9IHRoaXMuX2FkZEltYWdlVG9UdXRvcmlhbENvbnRlbnQoZHJlc3NVcFNjcmVlbiwgJ2hlbHBfY2xvdGhlc19kb3JvdGh5MicsIDAuOSk7XHJcbiAgICAgICAgZHJlc3NVcFNjcmVlbi5jYW1CdXQgPSB0aGlzLl9jcmVhdGVCdXR0b25Gb3JUdXRvcmlhbENvbnRlbnQoJ2ljb25fY2FtZXJhX29mZicsICdidG5fcHJpbWFyeV9zbWFsbF9vZmYnKTsgXHJcbiAgICAgICAgICAgIGRyZXNzVXBTY3JlZW4uY2FtQnV0LnBvc2l0aW9uLnNldCgyODAsIDEwMCk7XHJcbiAgICAgICAgICAgIGRyZXNzVXBTY3JlZW4uYWRkQ2hpbGQoZHJlc3NVcFNjcmVlbi5jYW1CdXQpO1xyXG4gICAgICAgIGRyZXNzVXBTY3JlZW4uZmluZ2VyID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChkcmVzc1VwU2NyZWVuLCAndHV0b3JpYWxfaGFuZCcsIDAuNSwgbmV3IFBJWEkuUG9pbnQoMC4xLCAwLjEpKTtcclxuXHJcbiAgICBkcmVzc1VwU2NyZWVuLnN0ZXBzID0gW107XHJcbiAgICBkcmVzc1VwU2NyZWVuLnN0ZXBzWzBdID0gZnVuY3Rpb24oKXtcclxuICAgICAgICB0aGlzLmRvdDEuYWxwaGEgPSAxO1xyXG4gICAgICAgIHRoaXMuZG90Mi5hbHBoYSA9IDA7XHJcbiAgICAgICAgc2V0SGVscFRleHQoJ3R1dG9yaWFsX2Nsb3RoZXMnKTtcclxuICAgICAgICB0d2VlbkFscGhhT3V0KHRoaXMuZmluZ2VyLCB0aGlzLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aGlzLmZpbmdlci54ID0gLTMzO1xyXG4gICAgICAgICAgICB0aGlzLmZpbmdlci55ID0gMTY7XHJcbiAgICAgICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmZpbmdlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgZHJlc3NVcFNjcmVlbi5zdGVwc1sxXSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5kb3QxLmFscGhhID0gMDtcclxuICAgICAgICB0aGlzLmRvdDIuYWxwaGEgPSAxO1xyXG4gICAgICAgIHRoaXMuZmluZ2VyLnggPSAtMzM7XHJcbiAgICAgICAgdGhpcy5maW5nZXIueSA9IDE2O1xyXG4gICAgfTtcclxuICAgIGRyZXNzVXBTY3JlZW4uc3RlcHNbMl0gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHR3ZWVuQWxwaGFPdXQodGhpcy5maW5nZXIsIHRoaXMsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRoaXMuZmluZ2VyLnggPSAtMTAwO1xyXG4gICAgICAgICAgICB0aGlzLmZpbmdlci55ID0gMTY7XHJcbiAgICAgICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmZpbmdlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgZHJlc3NVcFNjcmVlbi5zdGVwc1szXSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5kb3QyLmFscGhhID0gMDtcclxuICAgICAgICB0aGlzLmRvdDEuYWxwaGEgPSAxO1xyXG4gICAgICAgIHRoaXMuZmluZ2VyLnggPSAtMTAwO1xyXG4gICAgICAgIHRoaXMuZmluZ2VyLnkgPSAxNjtcclxuICAgIH07XHJcbiAgICBkcmVzc1VwU2NyZWVuLnN0ZXBzWzRdID0gZnVuY3Rpb24oKXtcclxuICAgICAgICB0d2VlbkFscGhhT3V0KHRoaXMuZmluZ2VyLCB0aGlzLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aGlzLmZpbmdlci54ID0gdGhpcy5jYW1CdXQueDtcclxuICAgICAgICAgICAgdGhpcy5maW5nZXIueSA9IHRoaXMuY2FtQnV0Lnk7XHJcbiAgICAgICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmZpbmdlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgZHJlc3NVcFNjcmVlbi5zdGVwc1s1XSA9IGZ1bmN0aW9uKCl7fTtcclxuXHJcbiAgICB2YXIgYmFja2dyb3VuZFNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgICAgIGJhY2tncm91bmRTY3JlZW4uYmcxID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChiYWNrZ3JvdW5kU2NyZWVuLCAnaGVscF9iYWNrZ3JvdW5kX2JnMScpO1xyXG4gICAgICAgIGJhY2tncm91bmRTY3JlZW4uYmcyID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChiYWNrZ3JvdW5kU2NyZWVuLCAnaGVscF9iYWNrZ3JvdW5kX2JnMicpO1xyXG4gICAgICAgIGJhY2tncm91bmRTY3JlZW4uZG90ID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChiYWNrZ3JvdW5kU2NyZWVuLCAnaGVscF9iYWNrZ3JvdW5kX2RvcnRoeScsIDAuOSk7XHJcbiAgICAgICAgYmFja2dyb3VuZFNjcmVlbi5idG5zID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChiYWNrZ3JvdW5kU2NyZWVuLCAnaGVscF9iYWNrZ3JvdW5kX2J0bnMnLCAxLjA3KTtcclxuICAgICAgICBiYWNrZ3JvdW5kU2NyZWVuLnRpY2tCdXQgPSB0aGlzLl9jcmVhdGVCdXR0b25Gb3JUdXRvcmlhbENvbnRlbnQoJ2ljb25fdGlja19vZmYnLCAnYnRuX3ByaW1hcnlfc21hbGxfb2ZmJywgMC45KTsgXHJcbiAgICAgICAgICAgIGJhY2tncm91bmRTY3JlZW4udGlja0J1dC5wb3NpdGlvbi5zZXQoMjgwLCAxMDApO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kU2NyZWVuLmFkZENoaWxkKGJhY2tncm91bmRTY3JlZW4udGlja0J1dCk7XHJcbiAgICAgICAgYmFja2dyb3VuZFNjcmVlbi5maW5nZXIgPSB0aGlzLl9hZGRJbWFnZVRvVHV0b3JpYWxDb250ZW50KGJhY2tncm91bmRTY3JlZW4sICd0dXRvcmlhbF9oYW5kJywgMC41LCBuZXcgUElYSS5Qb2ludCgwLjEsIDAuMSkpO1xyXG5cclxuXHJcbiAgICBiYWNrZ3JvdW5kU2NyZWVuLnN0ZXBzID0gW107XHJcbiAgICBiYWNrZ3JvdW5kU2NyZWVuLnN0ZXBzWzBdID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBzZXRIZWxwVGV4dCgndHV0b3JpYWxfcGlja19iYWNrZ3JvdW5kJyk7XHJcbiAgICAgICAgdGhpcy5iZzIuYWxwaGEgPSAwO1xyXG4gICAgICAgIHR3ZWVuQWxwaGFPdXQodGhpcy5maW5nZXIsIHRoaXMsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRoaXMuZmluZ2VyLnggPSAzMjA7XHJcbiAgICAgICAgICAgIHRoaXMuZmluZ2VyLnkgPSAwO1xyXG4gICAgICAgICAgICB0d2VlbkFscGhhSW4odGhpcy5maW5nZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIGJhY2tncm91bmRTY3JlZW4uc3RlcHNbMV0gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmJnMik7XHJcbiAgICB9O1xyXG4gICAgYmFja2dyb3VuZFNjcmVlbi5zdGVwc1syXSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdHdlZW5BbHBoYU91dCh0aGlzLmZpbmdlciwgdGhpcywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5maW5nZXIueCA9IC0zMjA7XHJcbiAgICAgICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmZpbmdlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgYmFja2dyb3VuZFNjcmVlbi5zdGVwc1szXSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdHdlZW5BbHBoYU91dCh0aGlzLmJnMik7XHJcbiAgICB9O1xyXG4gICAgYmFja2dyb3VuZFNjcmVlbi5zdGVwc1s0XSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdHdlZW5BbHBoYU91dCh0aGlzLmZpbmdlciwgdGhpcywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5maW5nZXIueCA9IHRoaXMudGlja0J1dC54O1xyXG4gICAgICAgICAgICB0aGlzLmZpbmdlci55ID0gdGhpcy50aWNrQnV0Lnk7XHJcbiAgICAgICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmZpbmdlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgYmFja2dyb3VuZFNjcmVlbi5zdGVwc1s1XSA9IGZ1bmN0aW9uKCl7fTtcclxuXHJcbiAgICB2YXIgcG9zZVNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgICAgIHBvc2VTY3JlZW4uYmcgPSB0aGlzLl9hZGRJbWFnZVRvVHV0b3JpYWxDb250ZW50KHBvc2VTY3JlZW4sICdoZWxwX3Bob3RvX2JnJyk7XHJcbiAgICAgICAgcG9zZVNjcmVlbi5kb3QxID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChwb3NlU2NyZWVuLCAnaGVscF9waG90b19kb3J0aHkxJyk7XHJcbiAgICAgICAgcG9zZVNjcmVlbi5kb3QyID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChwb3NlU2NyZWVuLCAnaGVscF9waG90b19kb3J0aHkyJyk7XHJcbiAgICAgICAgcG9zZVNjcmVlbi5kb3QzID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChwb3NlU2NyZWVuLCAnaGVscF9waG90b19kb3J0aHkzJyk7XHJcbiAgICAgICAgcG9zZVNjcmVlbi5kb3Q0ID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChwb3NlU2NyZWVuLCAnaGVscF9waG90b19kb3J0aHk0Jyk7XHJcbiAgICAgICAgcG9zZVNjcmVlbi5idG5zID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChwb3NlU2NyZWVuLCAnaGVscF9waG90b19idG5zJywgMC44NCk7XHJcbiAgICAgICAgcG9zZVNjcmVlbi5maW5nZXIgPSB0aGlzLl9hZGRJbWFnZVRvVHV0b3JpYWxDb250ZW50KHBvc2VTY3JlZW4sICd0dXRvcmlhbF9oYW5kJywgMC41LCBuZXcgUElYSS5Qb2ludCgwLjEsIDAuMSkpO1xyXG5cclxuICAgIHBvc2VTY3JlZW4uc3RlcHMgPSBbXTtcclxuICAgIHBvc2VTY3JlZW4uc3RlcHNbMF0gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHNldEhlbHBUZXh0KCd0dXRvcmlhbF9waWNrX3Bvc2VfcGljdHVyZScpO1xyXG4gICAgICAgIHRoaXMuZG90MS5hbHBoYSA9IDA7XHJcbiAgICAgICAgdGhpcy5kb3QyLmFscGhhID0gMDtcclxuICAgICAgICB0aGlzLmRvdDMuYWxwaGEgPSAxO1xyXG4gICAgICAgIHRoaXMuZG90NC5hbHBoYSA9IDA7XHJcbiAgICAgICAgdGhpcy5maW5nZXIucm90YXRpb24gPSAtMzAgKiBQSVhJLkRFR19UT19SQUQ7XHJcbiAgICAgICAgdHdlZW5BbHBoYU91dCh0aGlzLmZpbmdlciwgdGhpcywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5maW5nZXIueCA9IC0xNjA7XHJcbiAgICAgICAgICAgIHRoaXMuZmluZ2VyLnkgPSAtNzU7XHJcbiAgICAgICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmZpbmdlcik7IFxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHBvc2VTY3JlZW4uc3RlcHNbMV0gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMuZG90My5hbHBoYSA9IDA7XHJcbiAgICAgICAgdGhpcy5kb3QxLmFscGhhID0gMTtcclxuICAgIH07XHJcbiAgICBwb3NlU2NyZWVuLnN0ZXBzWzJdID0gZnVuY3Rpb24oKXtcclxuICAgICAgICB0d2VlbkFscGhhT3V0KHRoaXMuZmluZ2VyLCB0aGlzLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aGlzLmZpbmdlci55ID0gLTMwO1xyXG4gICAgICAgICAgICB0d2VlbkFscGhhSW4odGhpcy5maW5nZXIpOyBcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBwb3NlU2NyZWVuLnN0ZXBzWzNdID0gZnVuY3Rpb24oKXtcclxuICAgICAgICB0aGlzLmRvdDEuYWxwaGEgPSAwO1xyXG4gICAgICAgIHRoaXMuZG90Mi5hbHBoYSA9IDE7XHJcbiAgICB9O1xyXG4gICAgcG9zZVNjcmVlbi5zdGVwc1s0XSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdHdlZW5BbHBoYU91dCh0aGlzLmZpbmdlciwgdGhpcywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5maW5nZXIueSA9IDM1O1xyXG4gICAgICAgICAgICB0d2VlbkFscGhhSW4odGhpcy5maW5nZXIpOyBcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBwb3NlU2NyZWVuLnN0ZXBzWzVdID0gZnVuY3Rpb24oKXtcclxuICAgICAgICB0aGlzLmRvdDIuYWxwaGEgPSAwO1xyXG4gICAgICAgIHRoaXMuZG90My5hbHBoYSA9IDE7XHJcbiAgICB9O1xyXG4gICAgcG9zZVNjcmVlbi5zdGVwc1s2XSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdHdlZW5BbHBoYU91dCh0aGlzLmZpbmdlciwgdGhpcywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5maW5nZXIueSA9IDEwMDtcclxuICAgICAgICAgICAgdGhpcy5maW5nZXIueCA9IDEwO1xyXG4gICAgICAgICAgICB0d2VlbkFscGhhSW4odGhpcy5maW5nZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHBvc2VTY3JlZW4uc3RlcHNbN10gPSBmdW5jdGlvbigpe31cclxuXHJcbiAgICB2YXIgcGhvdG9TY3JlZW4gPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuICAgICAgICBwaG90b1NjcmVlbi5iZzIgPSB0aGlzLl9hZGRJbWFnZVRvVHV0b3JpYWxDb250ZW50KHBob3RvU2NyZWVuLCAnaGVscF9wb3NlX2JnMicpO1xyXG4gICAgICAgIHBob3RvU2NyZWVuLmRvdDEgPSB0aGlzLl9hZGRJbWFnZVRvVHV0b3JpYWxDb250ZW50KHBob3RvU2NyZWVuLCAnaGVscF9waG90b19kb3J0aHkxJywgMC45KTtcclxuICAgICAgICBwaG90b1NjcmVlbi5maW5hbEJ1dHRvbnMgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuICAgICAgICAgICAgcGhvdG9TY3JlZW4uZmluYWxCdXR0b25zLnkgPSAxMTA7XHJcbiAgICAgICAgICAgIHBob3RvU2NyZWVuLmZpbmFsQnV0dG9ucy5iYWNrID0gdGhpcy5fY3JlYXRlQnV0dG9uRm9yVHV0b3JpYWxDb250ZW50KCdpY29uX3ByZXZpb3VzX29mZicsICdidG5fcHJpbWFyeV9zbWFsbF9vZmYnLCAwLjkpXHJcbiAgICAgICAgICAgIHBob3RvU2NyZWVuLmZpbmFsQnV0dG9ucy5iYWNrLnBvc2l0aW9uLnNldCgtODAsIDApO1xyXG4gICAgICAgICAgICBwaG90b1NjcmVlbi5maW5hbEJ1dHRvbnMuYWRkQ2hpbGQocGhvdG9TY3JlZW4uZmluYWxCdXR0b25zLmJhY2spO1xyXG4gICAgICAgICAgICBwaG90b1NjcmVlbi5maW5hbEJ1dHRvbnMucmVwbGF5ID0gdGhpcy5fY3JlYXRlQnV0dG9uRm9yVHV0b3JpYWxDb250ZW50KCdpY29uX3JlcGxheV9vZmYnLCAnYnRuX3ByaW1hcnlfc21hbGxfb2ZmJywgMC45KTtcclxuICAgICAgICAgICAgcGhvdG9TY3JlZW4uZmluYWxCdXR0b25zLmFkZENoaWxkKHBob3RvU2NyZWVuLmZpbmFsQnV0dG9ucy5yZXBsYXkpOyBcclxuICAgICAgICAgICAgcGhvdG9TY3JlZW4uZmluYWxCdXR0b25zLmRvd25sb2FkID0gdGhpcy5fY3JlYXRlQnV0dG9uRm9yVHV0b3JpYWxDb250ZW50KCdpY29uX2Rvd25sb2FkX29mZicsICdidG5fcHJpbWFyeV9zbWFsbF9vZmYnLCAwLjkpXHJcbiAgICAgICAgICAgIHBob3RvU2NyZWVuLmZpbmFsQnV0dG9ucy5kb3dubG9hZC5wb3NpdGlvbi5zZXQoODAsIDApO1xyXG4gICAgICAgICAgICBwaG90b1NjcmVlbi5maW5hbEJ1dHRvbnMuYWRkQ2hpbGQocGhvdG9TY3JlZW4uZmluYWxCdXR0b25zLmRvd25sb2FkKTsgXHJcbiAgICAgICAgICAgIHBob3RvU2NyZWVuLmFkZENoaWxkKHBob3RvU2NyZWVuLmZpbmFsQnV0dG9ucyk7XHJcbiAgICAgICAgcGhvdG9TY3JlZW4uZmluZ2VyID0gdGhpcy5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudChwaG90b1NjcmVlbiwgJ3R1dG9yaWFsX2hhbmQnLCAwLjUsIG5ldyBQSVhJLlBvaW50KDAuMSwgMC4xKSk7XHJcblxyXG4gICAgcGhvdG9TY3JlZW4uc3RlcHMgPSBbXTtcclxuICAgIHBob3RvU2NyZWVuLnN0ZXBzWzBdID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBzZXRIZWxwVGV4dCgndHV0b3JpYWxfZG93bmxvYWQnKTtcclxuICAgICAgICB0d2VlbkFscGhhT3V0KHRoaXMuZmluZ2VyKTtcclxuICAgIH07XHJcbiAgICBwaG90b1NjcmVlbi5zdGVwc1sxXSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5maW5nZXIucm90YXRpb24gPSAtMzAgKiBQSVhJLkRFR19UT19SQUQ7XHJcbiAgICAgICAgdGhpcy5maW5nZXIueCA9IHRoaXMuZmluYWxCdXR0b25zLnggKyB0aGlzLmZpbmFsQnV0dG9ucy5kb3dubG9hZC54O1xyXG4gICAgICAgIHRoaXMuZmluZ2VyLnkgPSB0aGlzLmZpbmFsQnV0dG9ucy55O1xyXG4gICAgICAgIHR3ZWVuQWxwaGFJbih0aGlzLmZpbmdlcik7XHJcbiAgICB9O1xyXG4gICAgcGhvdG9TY3JlZW4uc3RlcHNbMl0gPSBmdW5jdGlvbigpe31cclxuXHJcbiAgICB0aGlzLl9jb250ZW50cyA9IFtcclxuICAgICAgICB7aW1hZ2U6ZHJlc3NVcFNjcmVlbn0sXHJcbiAgICAgICAge2ltYWdlOmJhY2tncm91bmRTY3JlZW59LFxyXG4gICAgICAgIHtpbWFnZTpwb3NlU2NyZWVufS8vLFxyXG4gICAgICAgIC8ve2ltYWdlOnBob3RvU2NyZWVufVxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLl9pbWFnZUNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgdGhpcy5faW1hZ2VDb250YWluZXIueSA9IC02MDtcclxuICAgIHRoaXMuX3BhbmVsLmFkZENoaWxkKHRoaXMuX2ltYWdlQ29udGFpbmVyKTtcclxuXHJcbiAgICB0aGlzLmFkZFJpZ2h0QnV0dG9uKCk7XHJcbiAgICB0aGlzLmFkZExlZnRCdXR0b24oKTtcclxuXHJcbiAgICB0aGlzLl9sZWZ0QnV0dG9uID0gdGhpcy5fZ3VpQnV0dG9ucy5sZWZ0LmJ1dHRvbjtcclxuICAgIHRoaXMuX3JpZ2h0QnV0dG9uID0gdGhpcy5fZ3VpQnV0dG9ucy5yaWdodC5idXR0b247XHJcblxyXG4gICAgdGhpcy5zZXRQYWdlKHRoaXMuX2N1cnJlbnRQYWdlKTtcclxuXHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLnZpc2libGUgPSBmYWxzZTtcclxuICAgIHRoaXMuX3BhbmVsLmFkZENoaWxkKHRoaXMuX2NvbmZpcm1Db250YWluZXIpO1xyXG5cclxuICAgIHRoaXMuX2NvbmZpcm1Db250YWluZXIudGlja0J1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKCdpY29uX3RpY2snLCAndGljaycsICdwcmltYXJ5X3NtYWxsJyk7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLnRpY2tCdXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vblRpY2tCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuICAgIHRoaXMuX2NvbmZpcm1Db250YWluZXIudGlja0J1dHRvbi54ID0gLTEwMDtcclxuICAgIHRoaXMuX2NvbmZpcm1Db250YWluZXIudGlja0J1dHRvbi55ID0gMjA7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2NvbmZpcm1Db250YWluZXIudGlja0J1dHRvbik7XHJcblxyXG4gICAgdGhpcy5fY29uZmlybUNvbnRhaW5lci5jcm9zc0J1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKCdpY29uX2Nyb3NzJywgJ2Nyb3NzJywgJ3ByaW1hcnlfc21hbGwnKTtcclxuICAgIHRoaXMuX2NvbmZpcm1Db250YWluZXIuY3Jvc3NCdXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vbkNyb3NzQnV0dG9uQ2xpY2tlZCwgdGhpcyk7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLmNyb3NzQnV0dG9uLnggPSAxMDA7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLmNyb3NzQnV0dG9uLnkgPSAyMDtcclxuICAgIHRoaXMuX2NvbmZpcm1Db250YWluZXIuYWRkQ2hpbGQodGhpcy5fY29uZmlybUNvbnRhaW5lci5jcm9zc0J1dHRvbik7XHJcblxyXG4gICAgdGhpcy5fY29uZmlybUNvbnRhaW5lci50ZXh0ID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSgnYXJleW91c3VyZScpKTtcclxuICAgIHRoaXMuX2NvbmZpcm1Db250YWluZXIudGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLnRleHQuc2NhbGUuc2V0KDAuNSk7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLnRleHQueSA9IC0xMTA7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2NvbmZpcm1Db250YWluZXIudGV4dCk7XHJcblxyXG4gICAgdGhpcy5zaWduYWxzLnJlcXVlc3RlZE11c2ljUGxheS5kaXNwYXRjaCgnbXVzaWNfcGF1c2VoZWxwX21lbnVfMDAnKTtcclxufTtcclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgQ29tbW9uLnBhdXNlZCA9IGZhbHNlO1xyXG4gICAgQ29tbW9uLmFuaW1hdG9yLnBhdXNlZCA9IGZhbHNlO1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnVwZGF0ZS5jYWxsKHRoaXMpO1xyXG5cclxuICAgIGlmKENvbW1vbi5mcmFtZUNvdW50ID09IHRoaXMuX2xhc3RTdGVwVGltZSArIDEwMClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9jdXJyZW50U3RlcCA9IHRoaXMuX2N1cnJlbnRTdGVwKzEgPCB0aGlzLl9jb250ZW50c1t0aGlzLl9jdXJyZW50UGFnZV0uaW1hZ2Uuc3RlcHMubGVuZ3RoID8gdGhpcy5fY3VycmVudFN0ZXArMSA6IDA7XHJcbiAgICAgICAgdGhpcy5fbGFzdFN0ZXBUaW1lID0gQ29tbW9uLmZyYW1lQ291bnQ7XHJcbiAgICAgICAgdGhpcy5fY29udGVudHNbdGhpcy5fY3VycmVudFBhZ2VdLmltYWdlLnN0ZXBzW3RoaXMuX2N1cnJlbnRTdGVwXS5jYWxsKHRoaXMuX2NvbnRlbnRzW3RoaXMuX2N1cnJlbnRQYWdlXS5pbWFnZSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLl9wYW5lbC5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLl9wYW5lbC5zY2FsZSwgLjIsIHt4OjEsIGVhc2U6U2luZS5lYXNlT3V0fSkpO1xyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLl9wYW5lbC5zY2FsZSwgLjksIHt5OjEsIGVhc2U6RWxhc3RpYy5lYXNlT3V0fSkpO1xyXG59O1xyXG5cclxuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlLCBhcmdzKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcclxuXHJcbiAgICBDb21tb24uYW5pbWF0b3IuYWRkKFR3ZWVuTWF4LnRvKHRoaXMuX3BhbmVsLnNjYWxlLCAuNDUsIHt4OjAsIGVhc2U6QmFjay5lYXNlSW59KSk7XHJcbiAgICBDb21tb24uYW5pbWF0b3IuYWRkKFR3ZWVuTWF4LnRvKHRoaXMuX3BhbmVsLnNjYWxlLCAuNSwge3k6MCwgZWFzZTpCYWNrLmVhc2VJbiwgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtcclxuICAgICAgICBjYWxsYmFjay5jYWxsKHNjb3BlLCBhcmdzKTtcclxuICAgIH19KSk7XHJcbn07XHJcblxyXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLmRpc2FibGVHVUkgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGZvcih2YXIgaSBpbiB0aGlzLl9idXR0b25zKVxyXG4gICAgeyAgIFxyXG4gICAgICAgIHRoaXMuX2J1dHRvbnNbaV0uaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuICAgIH1cclxufTtcclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuZW5hYmxlR1VJID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBmb3IodmFyIGkgaW4gdGhpcy5fYnV0dG9ucylcclxuICAgIHsgICBcclxuICAgICAgICB0aGlzLl9idXR0b25zW2ldLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuICAgIH1cclxufTtcclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuc2V0UGFnZSA9IGZ1bmN0aW9uKHBhZ2UpXHJcbntcclxuICAgIHZhciBuZXdJbWFnZSA9IHRoaXMuX2NvbnRlbnRzW3BhZ2VdLmltYWdlO1xyXG4gICAgbmV3SW1hZ2UueCA9IHRoaXMuX2NvbnRlbnRzW3BhZ2VdLnggfHwgMDtcclxuICAgIG5ld0ltYWdlLnkgPSB0aGlzLl9jb250ZW50c1twYWdlXS55IHx8IDA7XHJcbiAgICBuZXdJbWFnZS5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XHJcbiAgICBuZXdJbWFnZS5hbHBoYSA9IDA7XHJcbiAgICB0aGlzLl9pbWFnZUNvbnRhaW5lci5hZGRDaGlsZChuZXdJbWFnZSk7XHJcblxyXG4gICAgdGhpcy5fbGVmdEJ1dHRvbi5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgdGhpcy5fcmlnaHRCdXR0b24uaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICBpZih0aGlzLl9pbWFnZSlcclxuICAgIHtcclxuICAgICAgICBDb21tb24uYW5pbWF0b3IuYWRkKFR3ZWVuTWF4LnRvKHRoaXMuX2ltYWdlLCAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlT3V0fSkpO1xyXG4gICAgfVxyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byhuZXdJbWFnZSwgLjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZU91dCwgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtcclxuICAgICAgICBpZih0aGlzLl9pbWFnZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX2ltYWdlQ29udGFpbmVyLnJlbW92ZUNoaWxkKHRoaXMuX2ltYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSBuZXdJbWFnZTtcclxuICAgICAgICB0aGlzLl9sZWZ0QnV0dG9uLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9yaWdodEJ1dHRvbi5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9fSkpO1xyXG5cclxuICAgIGlmKHBhZ2UgPT0gMClcclxuICAgICAgICB0aGlzLl9sZWZ0QnV0dG9uLnZpc2libGUgPSBmYWxzZTtcclxuICAgIGVsc2VcclxuICAgICAgICB0aGlzLl9sZWZ0QnV0dG9uLnZpc2libGUgPSB0cnVlO1xyXG5cclxuICAgIGlmKHBhZ2UgPT0gdGhpcy5fY29udGVudHMubGVuZ3RoLTEpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fcmlnaHRCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3JpZ2h0QnV0dG9uLnZpc2libGUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2N1cnJlbnRQYWdlID0gcGFnZTtcclxuICAgIHRoaXMuX2N1cnJlbnRTdGVwID0gMDtcclxuICAgIHRoaXMuX2xhc3RTdGVwVGltZSA9IENvbW1vbi5mcmFtZUNvdW50O1xyXG4gICAgdGhpcy5fY29udGVudHNbdGhpcy5fY3VycmVudFBhZ2VdLmltYWdlLnN0ZXBzW3RoaXMuX2N1cnJlbnRTdGVwXS5jYWxsKHRoaXMuX2NvbnRlbnRzW3RoaXMuX2N1cnJlbnRQYWdlXS5pbWFnZSk7XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5fYWRkSW1hZ2VUb1R1dG9yaWFsQ29udGVudCA9IGZ1bmN0aW9uKGNvbnRlbnQsIHRleHR1cmVOYW1lLCBzY2FsZSwgYW5jaG9yKVxyXG57XHJcbiAgICB2YXIgaXRlbSA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uYXNzZXRzLmdldFRleHR1cmUodGV4dHVyZU5hbWUpKTtcclxuICAgIGl0ZW0uYW5jaG9yID0gYW5jaG9yIHx8IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuICAgIGlmKHNjYWxlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgaXRlbS5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KHNjYWxlLCBzY2FsZSk7XHJcbiAgICBjb250ZW50LmFkZENoaWxkKGl0ZW0pO1xyXG4gICAgcmV0dXJuIGl0ZW07XHJcbn1cclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuX2NyZWF0ZUJ1dHRvbkZvclR1dG9yaWFsQ29udGVudCA9IGZ1bmN0aW9uKGljb25UZXh0dXJlLCBidXR0b25UZXh0dXJlKVxyXG57XHJcbiAgICB2YXIgYnV0dG9uID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZShidXR0b25UZXh0dXJlKSk7XHJcbiAgICBidXR0b24uYW5jaG9yLnNldCgwLjUpO1xyXG4gICAgYnV0dG9uLnNjYWxlLnNldCgwLjQpO1xyXG4gICAgdmFyIGljb24gPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKGljb25UZXh0dXJlKSk7XHJcbiAgICBpY29uLmFuY2hvci5zZXQoMC41KTtcclxuICAgIGJ1dHRvbi5hZGRDaGlsZChpY29uKTtcclxuXHJcbiAgICByZXR1cm4gYnV0dG9uO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUub25QbGF5QnV0dG9uQ2xpY2tlZCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdGhpcy5kaXNhYmxlR1VJKCk7XHJcbiAgICB0aGlzLmFuaW1hdGVPdXQodGhpcy5zaWduYWxzLm5leHQuZGlzcGF0Y2gsIHRoaXMpO1xyXG59O1xyXG5cclxuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5vbkhvbWVCdXR0b25DbGlja2VkID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9pbWFnZUNvbnRhaW5lciwgLjUsIHthbHBoYTowfSk7XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9oZWxwVGV4dCwgLjUsIHthbHBoYTowfSk7XHJcbiAgICB0aGlzLl9jb25maXJtQ29udGFpbmVyLnZpc2libGUgPSB0cnVlO1xyXG4gICAgdGhpcy5fY29uZmlybUNvbnRhaW5lci5hbHBoYSA9IDA7XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9jb25maXJtQ29udGFpbmVyLCAuNSwge2FscGhhOjF9KTtcclxuICAgIHRoaXMuX2xlZnRCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgdGhpcy5fcmlnaHRCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xyXG59XHJcblxyXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLm9uQ3Jvc3NCdXR0b25DbGlja2VkID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9pbWFnZUNvbnRhaW5lciwgLjUsIHthbHBoYToxfSk7XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9oZWxwVGV4dCwgLjUsIHthbHBoYToxfSk7XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9jb25maXJtQ29udGFpbmVyLCAuNSwge2FscGhhOjAsIG9uQ29tcGxldGVTY29wZTp0aGlzLCBvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5fY29uZmlybUNvbnRhaW5lci52aXNpYmxlID0gZmFsc2U7XHJcbiAgICB9fSk7XHJcbiAgICB0aGlzLl9sZWZ0QnV0dG9uLnZpc2libGUgPSB0cnVlO1xyXG4gICAgdGhpcy5fcmlnaHRCdXR0b24udmlzaWJsZSA9IHRydWU7XHJcbn1cclxuXHJcblBhdXNlT3ZlcmxheS5wcm90b3R5cGUub25UaWNrQnV0dG9uQ2xpY2tlZCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5vbkdVSUJ1dHRvbkNsaWNrZWQuY2FsbCh0aGlzLCB0aGlzLl9ob21lQnV0dG9uKTtcclxufVxyXG5cclxuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5vbkdVSUJ1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXHJcbntcclxuICAgIGlmKGJ1dHRvbi5pZCA9PSAnaG9tZScpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5vbkhvbWVCdXR0b25DbGlja2VkKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5vbkdVSUJ1dHRvbkNsaWNrZWQuY2FsbCh0aGlzLCBidXR0b24pO1xyXG4gICAgfVxyXG59O1xyXG5cclxuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5vbkludGVybmFsQnV0dG9uQ2xpY2tlZCA9IGZ1bmN0aW9uKGJ1dHRvbilcclxue1xyXG4gICAgaWYoYnV0dG9uLmlkID09ICdyaWdodCcpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5zZXRQYWdlKHRoaXMuX2N1cnJlbnRQYWdlKzEpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZihidXR0b24uaWQgPT0gJ2xlZnQnKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuc2V0UGFnZSh0aGlzLl9jdXJyZW50UGFnZS0xKTtcclxuICAgIH1cclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuIiwidmFyIENvbW1vbiAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBTaW1wbGVTY3JlZW4gICAgPSByZXF1aXJlKCcuL1NpbXBsZVNjcmVlbicpO1xyXG52YXIgVGl0bGVCYXIgICAgICAgID0gcmVxdWlyZSgnLi4vZ2FtZS9UaXRsZUJhcicpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIEJhY2tncm91bmRTY3JlZW4oY2hhcmFjdGVyLCBiYWNrZ3JvdW5kKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLl9jaGFyYWN0ZXIgPSBjaGFyYWN0ZXI7XHJcblxyXG4gICAgdGhpcy5fYmFja2dyb3VuZCA9IG51bGw7XHJcbiAgICB0aGlzLl9iYWNrZ3JvdW5kVGV4dHVyZXMgPSBbXHJcbiAgICAgICAgJ2JnX2dhbWVfMDAxJywgXHJcbiAgICAgICAgJ2JnX2dhbWVfMDAyJywgXHJcbiAgICAgICAgJ2JnX2dhbWVfMDAzJyxcclxuICAgICAgICAnYmdfZ2FtZV8wMDQnLFxyXG4gICAgICAgICdiZ19nYW1lXzAwNScsXHJcbiAgICAgICAgJ2JnX2dhbWVfMDA2JyxcclxuICAgICAgICAnYmdfZ2FtZV8wMDcnLFxyXG4gICAgICAgICdiZ19nYW1lXzAwOCcsXHJcbiAgICAgICAgJ2JnX2dhbWVfMDA5JyxcclxuICAgICAgICAnYmdfZ2FtZV8wMTAnLFxyXG4gICAgICAgICdiZ19nYW1lXzAxMScsXHJcbiAgICAgICAgJ2JnX2dhbWVfMDEyJyxcclxuICAgICAgICAnYmdfZ2FtZV8wMTMnXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fY3VycmVudEJhY2tncm91bmRUZXh0dXJlID0gYmFja2dyb3VuZCA9PSB1bmRlZmluZWQgPyAwIDogdGhpcy5fYmFja2dyb3VuZFRleHR1cmVzLmluZGV4T2YoYmFja2dyb3VuZCk7XHJcblxyXG4gICAgdGhpcy5fdGl0bGUgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuX3Bob3RvU2NlbmUgPSBudWxsO1xyXG59XHJcblxyXG5CYWNrZ3JvdW5kU2NyZWVuLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XHJcbkJhY2tncm91bmRTY3JlZW4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQmFja2dyb3VuZFNjcmVlbjtcclxubW9kdWxlLmV4cG9ydHMgPSBCYWNrZ3JvdW5kU2NyZWVuO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkJhY2tncm91bmRTY3JlZW4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuX2NoYXJhY3Rlci5waG90b01vZGUgPSB0cnVlO1xyXG5cclxuICAgIHRoaXMuX2V4cG9ydEJhY2tncm91bmQgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdiZ19waG90bycpKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fZXhwb3J0QmFja2dyb3VuZCk7XHJcblxyXG4gICAgdGhpcy5fYmxhY2sgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmNvbG91cnMuYmxhY2spO1xyXG4gICAgdGhpcy5fYmxhY2sud2lkdGggPSBDb21tb24uU1RBR0VfV0lEVEg7XHJcbiAgICB0aGlzLl9ibGFjay5oZWlnaHQgPSBDb21tb24uU1RBR0VfSEVJR0hUO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9ibGFjayk7XHJcblxyXG4gICAgdGhpcy5fcGhvdG9TY2VuZSA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9waG90b1NjZW5lKTtcclxuXHJcbiAgICB0aGlzLl9iYWNrZ3JvdW5kID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSh0aGlzLl9iYWNrZ3JvdW5kVGV4dHVyZXNbdGhpcy5fY3VycmVudEJhY2tncm91bmRUZXh0dXJlXSkpO1xyXG4gICAgdGhpcy5fcGhvdG9TY2VuZS5hZGRDaGlsZCh0aGlzLl9iYWNrZ3JvdW5kKTtcclxuXHJcbiAgICB2YXIgeCA9IENvbW1vbi5TVEFHRV9XSURUSCAvIDI7XHJcbiAgICB2YXIgeSA9IDcwMDtcclxuICAgIGlmKHRoaXMuX2NoYXJhY3Rlci54ICE9IHggfHwgdGhpcy5fY2hhcmFjdGVyLnkgIT0geSlcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9jaGFyYWN0ZXIuc2V0QW5pbWF0aW9uKCdqdW1wY2VudHJlJyk7XHJcbiAgICAgICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLl9jaGFyYWN0ZXIsIC41LCB7ZGVsYXk6LjIsIHg6eCwgeTp5LCBlYXNlOlNpbmUuZWFzZUluT3V0fSkpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2NoYXJhY3Rlci5zZXRBbmltYXRpb24oJ2lkbGUxJyk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9waG90b1NjZW5lLmFkZENoaWxkKHRoaXMuX2NoYXJhY3Rlcik7XHJcblxyXG4gICAgdGhpcy5fc2V0VGl0bGUoJ3R1dG9yaWFsX3BpY2tfYmFja2dyb3VuZCcpO1xyXG5cclxuICAgIHRoaXMuYWRkUGF1c2VCdXR0b24oKTtcclxuICAgIHRoaXMuYWRkUmlnaHRCdXR0b24oKTtcclxuICAgIHRoaXMuYWRkTGVmdEJ1dHRvbigpO1xyXG4gICAgdGhpcy5hZGROZXh0QnV0dG9uKG51bGwsIG51bGwsICdpY29uX3RpY2snKTtcclxuICAgIHRoaXMuYWRkQmFja0J1dHRvbigpO1xyXG5cclxuICAgIHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRNdXNpY1BsYXkuZGlzcGF0Y2goJ211c2ljX2NhbWVyYV9sb29wXzAwJyk7XHJcbn07XHJcblxyXG5CYWNrZ3JvdW5kU2NyZWVuLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbkJhY2tncm91bmRTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbkJhY2tncm91bmRTY3JlZW4ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgaWYoQ29tbW9uLnBhdXNlZCkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS51cGRhdGUuY2FsbCh0aGlzKTtcclxuXHJcbiAgICBpZih0aGlzLl9zdGF0ZSAhPSAnZW5kJylcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9jaGFyYWN0ZXIudXBkYXRlKCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkJhY2tncm91bmRTY3JlZW4ucHJvdG90eXBlLl9zZXRCYWNrZ3JvdW5kID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9iYWNrZ3JvdW5kLnRleHR1cmUgPSBDb21tb24uYXNzZXRzLmdldFRleHR1cmUodGhpcy5fYmFja2dyb3VuZFRleHR1cmVzW3RoaXMuX2N1cnJlbnRCYWNrZ3JvdW5kVGV4dHVyZV0pO1xyXG59XHJcblxyXG5CYWNrZ3JvdW5kU2NyZWVuLnByb3RvdHlwZS5fc2V0VGl0bGUgPSBmdW5jdGlvbih0ZXh0KVxyXG57XHJcbiAgICBpZih0aGlzLl90aXRsZSlcclxuICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHJcbiAgICB0aGlzLl90aXRsZSA9IG5ldyBUaXRsZUJhcigpO1xyXG4gICAgdGhpcy5fdGl0bGUueCA9IENvbW1vbi5TVEFHRV9XSURUSCAvIDI7XHJcbiAgICB0aGlzLl90aXRsZS55ID0gNzA7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHJcbiAgICB0aGlzLl90aXRsZS5zaG93KHRleHQpO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkJhY2tncm91bmRTY3JlZW4ucHJvdG90eXBlLm9uSW50ZXJuYWxCdXR0b25DbGlja2VkID0gZnVuY3Rpb24oYnV0dG9uKVxyXG57XHJcbiAgICBpZihidXR0b24uaWQgPT0gJ3JpZ2h0JylcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9jdXJyZW50QmFja2dyb3VuZFRleHR1cmUgKys7XHJcbiAgICAgICAgaWYodGhpcy5fY3VycmVudEJhY2tncm91bmRUZXh0dXJlID49IHRoaXMuX2JhY2tncm91bmRUZXh0dXJlcy5sZW5ndGgpXHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRCYWNrZ3JvdW5kVGV4dHVyZSA9IDA7XHJcbiAgICAgICAgQ29tbW9uLmF1ZGlvLnBsYXlTb3VuZCgnc2Z4X2JhY2tncm91bmRfc3dpcGVfMDAnKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYoYnV0dG9uLmlkID09ICdsZWZ0JylcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9jdXJyZW50QmFja2dyb3VuZFRleHR1cmUgLS07XHJcbiAgICAgICAgaWYodGhpcy5fY3VycmVudEJhY2tncm91bmRUZXh0dXJlIDwgMClcclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudEJhY2tncm91bmRUZXh0dXJlID0gdGhpcy5fYmFja2dyb3VuZFRleHR1cmVzLmxlbmd0aC0xO1xyXG4gICAgICAgIENvbW1vbi5hdWRpby5wbGF5U291bmQoJ3NmeF9iYWNrZ3JvdW5kX3N3aXBlXzAwJyk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9zZXRCYWNrZ3JvdW5kKCk7XHJcbn1cclxuXHJcbkJhY2tncm91bmRTY3JlZW4ucHJvdG90eXBlLm9uTmV4dEJ1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXHJcbntcclxuICAgIHRoaXMuc2lnbmFscy5uZXh0LmRpc3BhdGNoKHRoaXMuX2JhY2tncm91bmRUZXh0dXJlc1t0aGlzLl9jdXJyZW50QmFja2dyb3VuZFRleHR1cmVdKTtcclxufTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiAgICAgICAgPSByZXF1aXJlKCcuL1NpbXBsZVNjcmVlbicpO1xyXG52YXIgQW5pbWF0ZWRDaGFyYWN0ZXIgICA9IHJlcXVpcmUoJy4uL2dhbWUvQW5pbWF0ZWRDaGFyYWN0ZXInKTtcclxudmFyIENsb3RoZXNNZW51ICAgICAgICAgPSByZXF1aXJlKCcuLi9nYW1lL0Nsb3RoZXNNZW51Jyk7XHJcbnZhciBUaXRsZUJhciAgICAgICAgICAgID0gcmVxdWlyZSgnLi4vZ2FtZS9UaXRsZUJhcicpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIERyZXNzdXBTY3JlZW4oY2hhcmFjdGVyKVxyXG57XHJcbiAgICB0aGlzLl9jaGFyYWN0ZXIgPSBjaGFyYWN0ZXI7XHJcbiAgICB0aGlzLl9mcmVzaCA9ICFjaGFyYWN0ZXI7XHJcbiAgICB0aGlzLl9tZW51ID0gbnVsbDtcclxuICAgIHRoaXMuX3RpdGxlID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLl9jdXJyZW50VHV0b3JpYWwgPSBudWxsO1xyXG5cclxuICAgIHAzLmxvZyh0aGlzLl9mcmVzaCk7XHJcblxyXG4gICAgU2ltcGxlU2NyZWVuLmNhbGwodGhpcyk7XHJcbn1cclxuXHJcbkRyZXNzdXBTY3JlZW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcclxuRHJlc3N1cFNjcmVlbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBEcmVzc3VwU2NyZWVuO1xyXG5tb2R1bGUuZXhwb3J0cyA9IERyZXNzdXBTY3JlZW47XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuRHJlc3N1cFNjcmVlbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG4gICAgdmFyIGJhY2tncm91bmQgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdiZ19nYW1lXzAwMScpKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoYmFja2dyb3VuZCk7XHJcblxyXG4gICAgaWYodGhpcy5fY2hhcmFjdGVyID09IG51bGwpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fY2hhcmFjdGVyID0gbmV3IEFuaW1hdGVkQ2hhcmFjdGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY2hhcmFjdGVyLnBob3RvTW9kZSA9IGZhbHNlO1xyXG4gICAgXHJcbiAgICB0aGlzLl9jaGFyYWN0ZXIueCA9IChDb21tb24uU1RBR0VfV0lEVEggLyAyKSArIDMwMDtcclxuICAgIHRoaXMuX2NoYXJhY3Rlci55ID0gNzAwO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9jaGFyYWN0ZXIpO1xyXG5cclxuICAgIHRoaXMuX21lbnUgPSBuZXcgQ2xvdGhlc01lbnUoKTtcclxuICAgIHRoaXMuX21lbnUueCA9IChDb21tb24uU1RBR0VfV0lEVEggLyAyKSAtIDM0MDtcclxuICAgIHRoaXMuX21lbnUueSA9IDUwO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9tZW51KTtcclxuICAgIHRoaXMuX21lbnUuaW5pdCgpO1xyXG4gICAgdGhpcy5fbWVudS5zaWduYWxzLml0ZW1TZWxlY3RlZC5hZGQodGhpcy5vbkl0ZW1TZWxlY3RlZCwgdGhpcyk7XHJcbiAgICB0aGlzLl9tZW51LnNpZ25hbHMudHV0b3JpYWxDb21wbGV0ZWQuYWRkKHRoaXMub25UdXRvcmlhbENvbXBsZXRlZCwgdGhpcyk7XHJcblxyXG4gICAgdGhpcy5fdGl0bGUgPSBuZXcgVGl0bGVCYXIoKTtcclxuICAgIHRoaXMuX3RpdGxlLnggPSBDb21tb24uU1RBR0VfV0lEVEggLyAyO1xyXG4gICAgdGhpcy5fdGl0bGUueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLSAxMzA7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHJcbiAgICB2YXIgYWxsVHV0b3JpYWxzQ29tcGxldGUgPSB0cnVlO1xyXG5cclxuICAgIGZvcih2YXIgaSBpbiBDb21tb24udHV0b3JpYWxTdGF0ZXNQYXNzZWQpXHJcbiAgICB7XHJcbiAgICAgICAgaWYoQ29tbW9uLnR1dG9yaWFsU3RhdGVzUGFzc2VkW2ldID09IGZhbHNlKVxyXG4gICAgICAgICAgICBhbGxUdXRvcmlhbHNDb21wbGV0ZSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKCFhbGxUdXRvcmlhbHNDb21wbGV0ZSlcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9tZW51LnNldEZpcnN0VHV0b3JpYWwoKTtcclxuICAgICAgICB0aGlzLl9tZW51LnR1dG9yaWFsRmluZ2VyLnNpZ25hbHMudHV0b3JpYWxTdGFydGVkLmFkZCh0aGlzLm9uVHV0b3JpYWxTdGFydGVkLCB0aGlzKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICB0aGlzLl90aXRsZS5zaG93KCd0dXRvcmlhbF9jbG90aGVzJyk7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUucmVtb3ZlKDMpO1xyXG4gICAgICAgIHRoaXMuX21lbnUuc2V0UHJvbXB0VHV0b3JpYWwoKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmFkZFBhdXNlQnV0dG9uKCk7XHJcbiAgICB0aGlzLmFkZE5leHRCdXR0b24obnVsbCwgbnVsbCwgJ2ljb25fY2FtZXJhJyk7XHJcblxyXG4gICAgaWYodGhpcy5fZnJlc2gpXHJcbiAgICB7XHJcbiAgICAgICAgQ29tbW9uLmF1ZGlvLnBsYXlTb3VuZCgnc2Z4X3dhcmRyb2JlX2FwcGVhcl8wMCcpO1xyXG4gICAgICAgIHRoaXMuX2NoYXJhY3Rlci5pbnRybygpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2NoYXJhY3Rlci5zZXRBbmltYXRpb24oJ2lkbGUxJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fbWVudS55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcclxuICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGhpcy5fbWVudSwgLjgsIHt5OjUwLCBlYXNlOkJhY2suZWFzZU91dH0pKTtcclxuXHJcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkTXVzaWNQbGF5LmRpc3BhdGNoKCdtdXNpY19hbWJpZW50X3dhcmRyb2JlX2xvb3BfMDAnKTtcclxufTtcclxuXHJcbkRyZXNzdXBTY3JlZW4ucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMuX21lbnUuZGVzdHJveSgpO1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG5EcmVzc3VwU2NyZWVuLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIFNpbXBsZVNjcmVlbi5wcm90b3R5cGUucmVzaXplLmNhbGwodGhpcyk7XHJcblxyXG4gICAgdGhpcy5fY2hhcmFjdGVyLnggPSBNYXRoLm1pbih0aGlzLl9yaWdodEVkZ2UsIChDb21tb24uU1RBR0VfV0lEVEgvMikgKyAzMjApO1xyXG4gICAgdGhpcy5fbWVudS54ID0gTWF0aC5tYXgodGhpcy5fbGVmdEVkZ2UgKyAyMCwgKENvbW1vbi5TVEFHRV9XSURUSC8yKSAtIDQ4MCk7XHJcbn07XHJcblxyXG5EcmVzc3VwU2NyZWVuLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGlmKENvbW1vbi5wYXVzZWQpIHJldHVybjtcclxuXHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnVwZGF0ZS5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuX2NoYXJhY3Rlci51cGRhdGUoKTtcclxuICAgIHRoaXMuX21lbnUudXBkYXRlKCk7XHJcbn07XHJcblxyXG5EcmVzc3VwU2NyZWVuLnByb3RvdHlwZS5nZXRDaGFyYWN0ZXIgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHJldHVybiB0aGlzLl9jaGFyYWN0ZXI7XHJcbn1cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuRHJlc3N1cFNjcmVlbi5wcm90b3R5cGUub25JdGVtU2VsZWN0ZWQgPSBmdW5jdGlvbihvYmopXHJcbntcclxuICAgIGlmKHRoaXMuX2NoYXJhY3Rlci5jdXJyZW50T3V0Zml0W3RoaXMuX21lbnUuY3VycmVudENhdGVnb3J5XSAhPSBvYmouaWQpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fY2hhcmFjdGVyLmN1cnJlbnRPdXRmaXRbdGhpcy5fbWVudS5jdXJyZW50Q2F0ZWdvcnldID0gb2JqLmlkO1xyXG4gICAgICAgIHRoaXMuX2NoYXJhY3Rlci5yZXNldEJhc2Uob2JqLmJhc2VTbG90cyk7XHJcblxyXG4gICAgICAgIGZvcih2YXIgaSBpbiBvYmouY2xlYXIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLl9jaGFyYWN0ZXIucmVtb3ZlQXR0YWNobWVudEZyb21TbG90KG9iai5jbGVhcltpXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IodmFyIGkgaW4gb2JqLmFkZClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaiBpbiBvYmouYmFzZVNsb3RzKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZihvYmouYmFzZVNsb3RzW2pdLm91dGZpdF9zbG90ID09IG9iai5hZGRbaV0uc2xvdClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFyYWN0ZXIucmVtb3ZlQXR0YWNobWVudEZyb21TbG90KG9iai5iYXNlU2xvdHNbal0uYmFzZV9zbG90KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fY2hhcmFjdGVyLnNldEF0dGFjaG1lbnRGb3JTbG90KG9iai5hZGRbaV0uc2xvdCwgb2JqLmFkZFtpXS5hdHRhY2htZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBhcnIgPSB7aGVhZHdlYXI6J2hhdCcsIGZvb3R3ZWFyOidzaG9lcycsIGxvd2VyX2JvZHk6J3NraXJ0JywgdXBwZXJfYm9keTondG9wJ307XHJcblxyXG4gICAgICAgIHZhciBhbmltID0gJ2NsaWNrJyArIGFyclt0aGlzLl9tZW51LmN1cnJlbnRDYXRlZ29yeV07XHJcbiAgICAgICAgZm9yKHZhciBpIGluIENvbW1vbi5jb25maWcuY2xvdGhlc1t0aGlzLl9tZW51LmN1cnJlbnRDYXRlZ29yeV0uaXRlbXMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaXRlbSA9IENvbW1vbi5jb25maWcuY2xvdGhlc1t0aGlzLl9tZW51LmN1cnJlbnRDYXRlZ29yeV0uaXRlbXNbaV07XHJcbiAgICAgICAgICAgIGlmKGl0ZW0uaWQgPT0gb2JqLmlkICYmIGl0ZW0uY3VzdG9tX2FuaW1hdGlvbilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYW5pbSA9IGl0ZW0uY3VzdG9tX2FuaW1hdGlvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yKHZhciBpIGluIHRoaXMuX2NoYXJhY3Rlci5jb21wbGV0ZUFuaW1hdGlvbnMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZih0aGlzLl9jaGFyYWN0ZXIuaGFzQ29tcGxldGVPdXRmaXQoaSkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX2NoYXJhY3Rlci5jb21wbGV0ZUFuaW1hdGlvbnNbaV0uYW5pbWF0aW9uKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuaW0gPSB0aGlzLl9jaGFyYWN0ZXIuY29tcGxldGVBbmltYXRpb25zW2ldLmFuaW1hdGlvbk5hbWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9jaGFyYWN0ZXIuY29tcGxldGVBbmltYXRpb25zW2ldLm11c2ljKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIENvbW1vbi5hdWRpby5wbGF5U291bmQoJ211c2ljXycgKyBpICsgJ19jb21wbGV0ZV8wMCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5fY2hhcmFjdGVyLmNvbXBsZXRlQW5pbWF0aW9uc1tpXS5zZngpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ29tbW9uLmF1ZGlvLnBsYXlTb3VuZCgnc2Z4X291dGZpdF8nICsgaSArICdfY29tcGxldGVfMDAnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fY2hhcmFjdGVyLnNldEFuaW1hdGlvbihhbmltKTtcclxuICAgICAgICB0aGlzLl9jaGFyYWN0ZXIuY2hhbmdlQ2xvdGhlc0VmZmVjdCh0aGlzLl9tZW51LmN1cnJlbnRDYXRlZ29yeSk7XHJcblxyXG4gICAgICAgIHZhciBzZnggPSBudWxsO1xyXG5cclxuICAgICAgICBpZihvYmouaWQuaW5kZXhPZignbGlvbicpID4gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzZnggPSAnc2Z4X2F0dGFjaF9pdGVtX2xpb25fMDAnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKG9iai5pZC5pbmRleE9mKCdzY2FyZWNyb3cnKSA+IC0xKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Z4ID0gJ3NmeF9hdHRhY2hfaXRlbV9zY2FyZWNyb3dfMDAnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKG9iai5pZC5pbmRleE9mKCd0aW5tYW4nKSA+IC0xKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Z4ID0gJ3NmeF9hdHRhY2hfaXRlbV90aW5tYW5fMDAnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgc291bmRzID0ge2hlYWR3ZWFyOidzZnhfc3dpdGNoX2hhdF8wMCcsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyX2JvZHk6J3NmeF9zd2l0Y2hfdG9wXzAxJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dlcl9ib2R5OidzZnhfc3dpdGNoX3Ryb3VzZXJzXzAxJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb290d2Vhcjonc2Z4X3N3aXRjaF9zaG9lc18wMCd9XHJcblxyXG4gICAgICAgICAgICBzZnggPSBzb3VuZHNbdGhpcy5fbWVudS5jdXJyZW50Q2F0ZWdvcnldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBDb21tb24uYXVkaW8ucGxheVNvdW5kKHNmeCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbkRyZXNzdXBTY3JlZW4ucHJvdG90eXBlLm9uVHV0b3JpYWxTdGFydGVkID0gZnVuY3Rpb24oaWQpXHJcbntcclxuICAgIHRoaXMuX2N1cnJlbnRUdXRvcmlhbCA9IGlkO1xyXG4gICAgdGhpcy5fdGl0bGUuc2hvdygndHV0b3JpYWxfJyArIGlkKTtcclxufVxyXG5cclxuRHJlc3N1cFNjcmVlbi5wcm90b3R5cGUub25UdXRvcmlhbENvbXBsZXRlZCA9IGZ1bmN0aW9uKGlkKVxyXG57XHJcbiAgICBpZih0aGlzLl9jdXJyZW50VHV0b3JpYWwgPT0gaWQpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudFR1dG9yaWFsID0gbnVsbDtcclxuICAgICAgICB0aGlzLl90aXRsZS5yZW1vdmUoKTtcclxuICAgIH1cclxuICAgIGlmKCFDb21tb24uc2F2ZWREYXRhLmFsbFR1dG9yaWFsc1ZpZXdlZCAmJlxyXG4gICAgICAgIENvbW1vbi50dXRvcmlhbFN0YXRlc1Bhc3NlZC5jbG90aGVzID09IHRydWUgJiZcclxuICAgICAgICBDb21tb24udHV0b3JpYWxTdGF0ZXNQYXNzZWQuc2Nyb2xsID09IHRydWUgJiZcclxuICAgICAgICBDb21tb24udHV0b3JpYWxTdGF0ZXNQYXNzZWQuY2F0ZWdvcmllcyA9PSB0cnVlKVxyXG4gICAge1xyXG4gICAgICAgIENvbW1vbi5zYXZlZERhdGEuYWxsVHV0b3JpYWxzVmlld2VkID0gdHJ1ZTtcclxuICAgICAgICBDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcclxuICAgICAgICB0aGlzLl90aXRsZS5yZW1vdmUoKTtcclxuICAgICAgICB0aGlzLl9tZW51LnNldFByb21wdFR1dG9yaWFsKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbkRyZXNzdXBTY3JlZW4ucHJvdG90eXBlLm9uTmV4dEJ1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXHJcbntcclxuICAgIGlmKGJ1dHRvbi5pZCA9PSAnbmV4dCcpXHJcbiAgICB7XHJcbiAgICAgICAgYnV0dG9uLmludGVyYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgQ29tbW9uLmF1ZGlvLnBsYXlTb3VuZCgnc2Z4X2J0bl9hY2NlcHRfMDAnKTtcclxuICAgICAgICBDb21tb24uYW5pbWF0b3IuYWRkKFR3ZWVuTWF4LnRvKHRoaXMuX21lbnUsIC41LCB7eTpDb21tb24uU1RBR0VfSEVJR0hULCBlYXNlOlNpbmUuZWFzZUluLCBvbkNvbXBsZXRlU2NvcGU6dGhpcywgb25Db21wbGV0ZTpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aGlzLnNpZ25hbHMubmV4dC5kaXNwYXRjaChidXR0b24uaWQpO1xyXG4gICAgICAgIH19KSk7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5zaWduYWxzLm5leHQuZGlzcGF0Y2goYnV0dG9uLmlkKTtcclxuICAgIH1cclxufTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgU2ltcGxlU2NyZWVuICAgID0gcmVxdWlyZSgnLi9TaW1wbGVTY3JlZW4nKTtcclxudmFyIFRpdGxlQmFyICAgICAgICA9IHJlcXVpcmUoJy4uL2dhbWUvVGl0bGVCYXInKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBQaG90b1NjcmVlbihjaGFyYWN0ZXIsIGJhY2tncm91bmQpXHJcbntcclxuICAgIFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuX3N0YXRlID0gJ3Bob3RvJztcclxuXHJcbiAgICB0aGlzLl9waG90b1NjZW5lID0gbnVsbDtcclxuICAgIHRoaXMuX3Bob3RvU2NlbmVDaXJjbGVNYXNrID0gbnVsbDtcclxuICAgIHRoaXMuX3Bob3RvU2NlbmVTcXVhcmVNYXNrID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLl9jaGFyYWN0ZXIgPSBjaGFyYWN0ZXI7XHJcblxyXG4gICAgdGhpcy5fYmFja2dyb3VuZCA9IG51bGw7XHJcbiAgICB0aGlzLl9iYWNrZ3JvdW5kVGV4dHVyZSA9IGJhY2tncm91bmQgIT09IHVuZGVmaW5lZCA/IGJhY2tncm91bmQgOiAnYmdfZ2FtZV8wMDEnO1xyXG5cclxuICAgIHRoaXMuX3Bob3RvRnJhbWUgPSBudWxsO1xyXG4gICAgdGhpcy5fcG9zZUJ1dHRvbnMgPSBbXTtcclxuICAgIHRoaXMuX2NhbWVyYUJ1dHRvbiA9IG51bGw7XHJcbiAgICB0aGlzLl9leHBvcnRGcmFtZSA9IG51bGw7XHJcblxyXG4gICAgdGhpcy5fdGl0bGUgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuX2V4cG9ydERhdGEgPSBudWxsO1xyXG59XHJcblxyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQaG90b1NjcmVlbjtcclxubW9kdWxlLmV4cG9ydHMgPSBQaG90b1NjcmVlbjtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG4gICAgdGhpcy5fY2hhcmFjdGVyLnBob3RvTW9kZSA9IHRydWU7XHJcblxyXG4gICAgdGhpcy5fZXhwb3J0QmFja2dyb3VuZCA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uYXNzZXRzLmdldFRleHR1cmUoJ2JnX3Bob3RvJykpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9leHBvcnRCYWNrZ3JvdW5kKTtcclxuXHJcbiAgICB0aGlzLl9ibGFjayA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uY29sb3Vycy5ibGFjayk7XHJcbiAgICB0aGlzLl9ibGFjay53aWR0aCA9IENvbW1vbi5TVEFHRV9XSURUSDtcclxuICAgIHRoaXMuX2JsYWNrLmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX2JsYWNrKTtcclxuXHJcbiAgICB0aGlzLl9waG90b1NjZW5lID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3Bob3RvU2NlbmUpO1xyXG5cclxuICAgIHRoaXMuX3Bob3RvU2NlbmVDaXJjbGVNYXNrID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuICAgIHRoaXMuX3Bob3RvU2NlbmVDaXJjbGVNYXNrLmJlZ2luRmlsbCgweDAwMDAwMCk7XHJcbiAgICB0aGlzLl9waG90b1NjZW5lQ2lyY2xlTWFzay5kcmF3Q2lyY2xlKDAsIDAsIENvbW1vbi5TVEFHRV9XSURUSC8yKTtcclxuICAgIHRoaXMuX3Bob3RvU2NlbmVDaXJjbGVNYXNrLnggPSBDb21tb24uU1RBR0VfV0lEVEggLyAyO1xyXG4gICAgdGhpcy5fcGhvdG9TY2VuZUNpcmNsZU1hc2sueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyO1xyXG5cclxuICAgIHRoaXMuX3Bob3RvU2NlbmVTcXVhcmVNYXNrID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuICAgIHRoaXMuX3Bob3RvU2NlbmVTcXVhcmVNYXNrLmJlZ2luRmlsbCgweDAwMDAwMCk7XHJcbiAgICB0aGlzLl9waG90b1NjZW5lU3F1YXJlTWFzay5kcmF3UmVjdCgtOTAyLzIsIC02NTIvMiwgOTAyLCA2NTIpO1xyXG4gICAgdGhpcy5fcGhvdG9TY2VuZVNxdWFyZU1hc2sueCA9IENvbW1vbi5TVEFHRV9XSURUSCAvIDI7XHJcbiAgICB0aGlzLl9waG90b1NjZW5lU3F1YXJlTWFzay55ID0gKENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyKSArIDEwO1xyXG5cclxuICAgIHRoaXMuX2JhY2tncm91bmQgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKHRoaXMuX2JhY2tncm91bmRUZXh0dXJlKSk7XHJcbiAgICB0aGlzLl9waG90b1NjZW5lLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmQpO1xyXG5cclxuICAgIHRoaXMuX2V4cG9ydEZyYW1lID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSgncGhvdG9fYm9hcmRlcicpKTtcclxuICAgIHRoaXMuX2V4cG9ydEZyYW1lLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuICAgIHRoaXMuX2V4cG9ydEZyYW1lLnggPSBDb21tb24uU1RBR0VfV0lEVEggLyAyO1xyXG4gICAgdGhpcy5fZXhwb3J0RnJhbWUueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyO1xyXG4gICAgdGhpcy5fZXhwb3J0RnJhbWUudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9leHBvcnRGcmFtZSk7XHJcblxyXG4gICAgdGhpcy5fcGhvdG9TY2VuZS5hZGRDaGlsZCh0aGlzLl9jaGFyYWN0ZXIpO1xyXG5cclxuICAgIHRoaXMuX3Bob3RvRnJhbWUgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdmcmFtZScpKTtcclxuICAgIHRoaXMuX3Bob3RvRnJhbWUuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xyXG4gICAgdGhpcy5fcGhvdG9GcmFtZS54ID0gQ29tbW9uLlNUQUdFX1dJRFRIIC8gMjtcclxuICAgIHRoaXMuX3Bob3RvRnJhbWUueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyO1xyXG4gICAgdGhpcy5fcGhvdG9GcmFtZS52aXNpYmxlID0gZmFsc2U7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3Bob3RvRnJhbWUpO1xyXG5cclxuICAgIHRoaXMuYWRkUGF1c2VCdXR0b24oKTtcclxuICAgIHRoaXMuYWRkSG9tZUJ1dHRvbigpO1xyXG4gICAgdGhpcy5hZGRCYWNrQnV0dG9uKCk7XHJcblxyXG4gICAgdGhpcy5fZ3VpQnV0dG9ucy5ob21lLnNldFggPSBmdW5jdGlvbigpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fZ3VpQnV0dG9ucy5ob21lLmJ1dHRvbi54ID0gdGhpcy5fcmlnaHRFZGdlIC0gdGhpcy5fZ3VpQnV0dG9uTWFyZ2lucy5yaWdodDtcclxuICAgIH0uYmluZCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLl9ndWlCdXR0b25zLmhvbWUuYnV0dG9uLnZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkTXVzaWNQbGF5LmRpc3BhdGNoKCdtdXNpY19jYW1lcmFfbG9vcF8wMCcpO1xyXG5cclxuICAgIHRoaXMuc2V0UGhvdG9Nb2RlKCk7XHJcbn07XHJcblxyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xyXG59O1xyXG5cclxuUGhvdG9TY3JlZW4ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgaWYoQ29tbW9uLnBhdXNlZCkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS51cGRhdGUuY2FsbCh0aGlzKTtcclxuXHJcbiAgICBpZih0aGlzLl9zdGF0ZSAhPSAnZW5kJylcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9jaGFyYWN0ZXIudXBkYXRlKCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUuc2V0UGhvdG9Nb2RlID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLl9zdGF0ZSA9ICdwaG90byc7XHJcblxyXG4gICAgdGhpcy5fcGhvdG9GcmFtZS52aXNpYmxlID0gdHJ1ZTtcclxuXHJcbiAgICB2YXIgcG9zZXMgPSBbXHJcbiAgICAgICAge2ljb246J2ljb25fcG9zZV8wMDEnLCBhbmltYXRpb246J3Bob3RvcG9zZTEnfSwgXHJcbiAgICAgICAge2ljb246J2ljb25fcG9zZV8wMDInLCBhbmltYXRpb246J3Bob3RvcG9zZTInfSxcclxuICAgICAgICB7aWNvbjonaWNvbl9wb3NlXzAwMycsIGFuaW1hdGlvbjoncGhvdG9wb3NlMyd9LFxyXG4gICAgICAgIHtpY29uOidpY29uX3Bvc2VfMDA0JywgYW5pbWF0aW9uOidwaG90b3Bvc2U0J30sXHJcbiAgICBdO1xyXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHBvc2VzLmxlbmd0aDsgaSsrKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBidXR0b24gPSB0aGlzLl9nZW5lcmF0ZUJ1dHRvbihwb3Nlc1tpXS5pY29uLCBwb3Nlc1tpXS5hbmltYXRpb24sICdzZWNvbmRhcnlfc21hbGwnKTtcclxuICAgICAgICBidXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vblBvc2VCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuICAgICAgICBidXR0b24ueCA9IChDb21tb24uU1RBR0VfV0lEVEggLyAyKSAtIDQyMDtcclxuICAgICAgICBidXR0b24ueSA9ICgoQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDIpKzEwMCkgLSAyNDAgKyAoaSAqIDEzMCk7XHJcbiAgICAgICAgYnV0dG9uLnNvdW5kID0gJ211c2ljX3N0YWJfY2hhbmdlX3Bvc2VfMCcgKyBpO1xyXG4gICAgICAgIHRoaXMuYWRkQ2hpbGQoYnV0dG9uKTtcclxuICAgICAgICBidXR0b24uaGl0QXJlYSA9IG5ldyBQSVhJLlJlY3RhbmdsZSgtNTAsIC01MCwgMTAwLCAxMDApO1xyXG4gICAgICAgIHRoaXMuX3Bvc2VCdXR0b25zLnB1c2goYnV0dG9uKTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5fZ2VuZXJhdGVCdXR0b24oJ2ljb25fZmxhc2gnLCAnY2FtZXJhJywgJ3ByaW1hcnlfc21hbGwnKTtcclxuICAgIGJ1dHRvbi5zaWduYWxzLnVwLmFkZCh0aGlzLm9uSW50ZXJuYWxCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuICAgIGJ1dHRvbi54ID0gKENvbW1vbi5TVEFHRV9XSURUSCAvIDIpICsgNDAwO1xyXG4gICAgYnV0dG9uLnkgPSAoQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDIpICsgMjgwO1xyXG4gICAgdGhpcy5hZGRDaGlsZChidXR0b24pO1xyXG4gICAgdGhpcy5fY2FtZXJhQnV0dG9uID0gYnV0dG9uO1xyXG5cclxuICAgIHRoaXMuX3NldFRpdGxlKCd0dXRvcmlhbF9waWNrX3Bvc2VfcGljdHVyZScpO1xyXG59O1xyXG5cclxuUGhvdG9TY3JlZW4ucHJvdG90eXBlLnRha2VQaWN0dXJlID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3Bob3RvU2NlbmVDaXJjbGVNYXNrKTtcclxuICAgIHRoaXMuX3Bob3RvU2NlbmUubWFzayA9IHRoaXMuX3Bob3RvU2NlbmVDaXJjbGVNYXNrO1xyXG4gICAgQ29tbW9uLmF1ZGlvLnBsYXlTb3VuZCgnc2Z4X3Rha2VfZmluYWxfcGhvdG8nKTtcclxuICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGhpcy5fcGhvdG9TY2VuZUNpcmNsZU1hc2suc2NhbGUsIC4yLCB7eDowLCB5OjAsIG9uQ29tcGxldGVTY29wZTp0aGlzLCBvbkNvbXBsZXRlOnRoaXMuc2V0RW5kTW9kZX0pKTtcclxufVxyXG5cclxuUGhvdG9TY3JlZW4ucHJvdG90eXBlLnNldEVuZE1vZGUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMuX3Bob3RvU2NlbmUubWFzayA9IG51bGw7XHJcbiAgICB0aGlzLl9waG90b1NjZW5lQ2lyY2xlTWFzay5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsIDApO1xyXG4gICAgdGhpcy5yZW1vdmVDaGlsZCh0aGlzLl9waG90b1NjZW5lQ2lyY2xlTWFzayk7XHJcblxyXG4gICAgdGhpcy5fcGhvdG9TY2VuZS5tYXNrID0gdGhpcy5fcGhvdG9TY2VuZVNxdWFyZU1hc2s7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3Bob3RvU2NlbmVTcXVhcmVNYXNrKTtcclxuXHJcbiAgICB0aGlzLl9zdGF0ZSA9ICdlbmQnO1xyXG5cclxuICAgIGZvcih2YXIgaSBpbiB0aGlzLl9wb3NlQnV0dG9ucylcclxuICAgIHtcclxuICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKHRoaXMuX3Bvc2VCdXR0b25zW2ldKTtcclxuICAgIH1cclxuICAgIHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5fY2FtZXJhQnV0dG9uKTtcclxuICAgIHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5fZ3VpQnV0dG9ucy5wYXVzZS5idXR0b24pO1xyXG4gICAgdGhpcy5fZ3VpQnV0dG9ucy5iYWNrLmJ1dHRvbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICB0aGlzLnJlbW92ZUNoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHJcbiAgICB0aGlzLl9waG90b0ZyYW1lLnZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICB0aGlzLl9leHBvcnRGcmFtZS52aXNpYmxlID0gdHJ1ZTtcclxuICAgIHRoaXMuX2JsYWNrLnZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICAvKlxyXG4gICAgQ29tbW9uLnJlbmRlcmVyLnJlbmRlcihDb21tb24uc3RhZ2UpO1xyXG4gICAgdHJ5e1xyXG4gICAgICAgIHRoaXMuX2V4cG9ydERhdGEgPSBDb21tb24ucmVuZGVyZXIuZXh0cmFjdC5iYXNlNjQoKTtcclxuICAgIH1cclxuICAgIGNhdGNoKGUpe1xyXG4gICAgICAgIHRoaXMuX2V4cG9ydERhdGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJykudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpO1xyXG4gICAgfSAgIFxyXG4gICAgQ29tbW9uLnNhdmVkRGF0YS5leHBvcnRlZEltYWdlID0gdGhpcy5fZXhwb3J0RGF0YTtcclxuICAgIENvbW1vbi5zYXZlZERhdGEuc2F2ZSgpO1xyXG4gICAgKi9cclxuXHJcbiAgICB0aGlzLl9ndWlCdXR0b25zLmhvbWUuYnV0dG9uLnZpc2libGUgPSB0cnVlO1xyXG5cclxuICAgIHRoaXMuX3NldFRpdGxlKCd0dXRvcmlhbF9ncmVhdF9waG90bycpOyBcclxuICAgIFxyXG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKCdpY29uX3ByZXZpb3VzJywgJ3Jlc3RhcnQnLCAncHJpbWFyeV9zbWFsbCcpO1xyXG4gICAgYnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25JbnRlcm5hbEJ1dHRvbkNsaWNrZWQsIHRoaXMpO1xyXG4gICAgYnV0dG9uLnggPSAoQ29tbW9uLlNUQUdFX1dJRFRIIC8gMikgLSAyMDA7XHJcbiAgICBidXR0b24ueSA9IChDb21tb24uU1RBR0VfSEVJR0hUIC8gMikgKyAyODA7XHJcbiAgICB0aGlzLmFkZENoaWxkKGJ1dHRvbik7XHJcbiAgICB0aGlzLl9yZXN0YXJ0QnV0dG9uID0gYnV0dG9uO1xyXG5cclxuICAgIHZhciBidXR0b24gPSB0aGlzLl9nZW5lcmF0ZUJ1dHRvbignaWNvbl9yZXBsYXknLCAnY29tcGxldGUnLCAncHJpbWFyeV9zbWFsbCcpO1xyXG4gICAgYnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25OZXh0QnV0dG9uQ2xpY2tlZCwgdGhpcyk7XHJcbiAgICBidXR0b24ueCA9IChDb21tb24uU1RBR0VfV0lEVEggLyAyKTtcclxuICAgIGJ1dHRvbi55ID0gKENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyKSArIDI4MDtcclxuICAgIHRoaXMuYWRkQ2hpbGQoYnV0dG9uKTtcclxuICAgIHRoaXMuX2NvbXBsZXRlQnV0dG9uID0gYnV0dG9uO1xyXG5cclxuICAgIHZhciBidXR0b24gPSB0aGlzLl9nZW5lcmF0ZUJ1dHRvbignaWNvbl9kb3dubG9hZCcsICdkb3dubG9hZCcsICdwcmltYXJ5X3NtYWxsJyk7XHJcbiAgICBidXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vbkludGVybmFsQnV0dG9uQ2xpY2tlZCwgdGhpcyk7XHJcbiAgICBidXR0b24ueCA9IChDb21tb24uU1RBR0VfV0lEVEggLyAyKSArIDIwMDtcclxuICAgIGJ1dHRvbi55ID0gKENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyKSArIDI4MDtcclxuICAgIHRoaXMuYWRkQ2hpbGQoYnV0dG9uKTtcclxuICAgIHRoaXMuX2Rvd25sb2FkQnV0dG9uID0gYnV0dG9uO1xyXG5cclxuICAgIC8vUmVtb3ZpbmcgZG93bmxvYWQgZnVuY3Rpb25hbGl0eVxyXG4gICAgdGhpcy5fZG93bmxvYWRCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgdGhpcy5fcmVzdGFydEJ1dHRvbi54ID0gKENvbW1vbi5TVEFHRV9XSURUSCAvIDIpLTE1MDtcclxuICAgIHRoaXMuX2NvbXBsZXRlQnV0dG9uLnggPSAoQ29tbW9uLlNUQUdFX1dJRFRIIC8gMikrMTUwO1xyXG5cclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUuX3NldFRpdGxlID0gZnVuY3Rpb24odGV4dClcclxue1xyXG4gICAgaWYodGhpcy5fdGl0bGUpXHJcbiAgICAgICAgdGhpcy5yZW1vdmVDaGlsZCh0aGlzLl90aXRsZSk7XHJcblxyXG4gICAgdGhpcy5fdGl0bGUgPSBuZXcgVGl0bGVCYXIoKTtcclxuICAgIHRoaXMuX3RpdGxlLnggPSBDb21tb24uU1RBR0VfV0lEVEggLyAyO1xyXG4gICAgdGhpcy5fdGl0bGUueSA9IDcwO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl90aXRsZSk7XHJcblxyXG4gICAgdGhpcy5fdGl0bGUuc2hvdyh0ZXh0KTtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5QaG90b1NjcmVlbi5wcm90b3R5cGUub25JbnRlcm5hbEJ1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXHJcbntcclxuICAgIGlmKGJ1dHRvbi5pZCA9PSAnY2FtZXJhJylcclxuICAgIHtcclxuICAgICAgICB0aGlzLnRha2VQaWN0dXJlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKGJ1dHRvbi5pZCA9PSAnZG93bmxvYWQnKVxyXG4gICAge1xyXG4gICAgICAgIC8vaWYocDMuRGV2aWNlLmlzTW9iaWxlKVxyXG4gICAgICAgIC8vICAgd2luZG93Lm9wZW4odGhpcy5fZXhwb3J0RGF0YSwgXCJfQkxBTktcIik7XHJcbiAgICAgICAgLy9lbHNlXHJcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKENvbW1vbi5nYW1lRGlyICsgJ2ltYWdlLmh0bWwnLCBcIl9CTEFOS1wiKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYoYnV0dG9uLmlkID09ICdyZXN0YXJ0JylcclxuICAgIHtcclxuICAgICAgICB0aGlzLm9uUHJldmlvdXNCdXR0b25DbGlja2VkKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcblBob3RvU2NyZWVuLnByb3RvdHlwZS5vblByZXZpb3VzQnV0dG9uQ2xpY2tlZCA9IGZ1bmN0aW9uKGJ1dHRvbilcclxue1xyXG4gICAgcDMubG9nKCdvblByZXZpb3VzQnV0dG9uQ2xpY2tlZCcpO1xyXG4gICAgdGhpcy5zaWduYWxzLnByZXZpb3VzLmRpc3BhdGNoKHRoaXMuX3N0YXRlKTtcclxufTtcclxuXHJcblBob3RvU2NyZWVuLnByb3RvdHlwZS5vblBvc2VCdXR0b25DbGlja2VkID0gZnVuY3Rpb24oYnV0dG9uKVxyXG57XHJcbiAgICB0aGlzLl9jaGFyYWN0ZXIuc2V0QW5pbWF0aW9uKGJ1dHRvbi5pZCwgdHJ1ZSk7XHJcbiAgICBDb21tb24uYXVkaW8ucGxheVNvdW5kKGJ1dHRvbi5zb3VuZCk7XHJcbiAgICBDb21tb24uYXVkaW8ucGxheVNvdW5kKCdzZnhfYnRuX2NoYW5nZV9jYW1lcmFfcG9zZV8wMCcpO1xyXG59O1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuIiwidmFyIENvbW1vbiAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBTaW1wbGVTY3JlZW4gPSByZXF1aXJlKFwiLi9TaW1wbGVTY3JlZW5cIik7XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBQcmVsb2FkZXJTY3JlZW4oKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLmxvYWRlZCA9IDA7XHJcblxyXG4gICAgdGhpcy5fbG9hZGVkU21vb3RoID0gMDtcclxuICAgIHRoaXMuX2xvZ28gPSBudWxsO1xyXG4gICAgdGhpcy5fYmFyID0gbnVsbDtcclxuICAgIHRoaXMuX3RleHQgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuc2lnbmFscy5sb2FkQ29tcGxldGUgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgICAgICAgICAgICAgICAgICAgICAgICA9IFByZWxvYWRlclNjcmVlbjtcclxuUHJlbG9hZGVyU2NyZWVuLnByb3RvdHlwZSAgICAgICAgICAgICA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XHJcblByZWxvYWRlclNjcmVlbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQcmVsb2FkZXJTY3JlZW47XHJcblxyXG5QcmVsb2FkZXJTY3JlZW4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcclxuXHJcbiAgICB2YXIgZyA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XHJcbiAgICBnLmNsZWFyKCk7XHJcbiAgICBnLmJlZ2luRmlsbCgweDg3MkY4Nyk7XHJcbiAgICBnLmRyYXdSZWN0KDAsIDAsIENvbW1vbi5TVEFHRV9XSURUSCwgQ29tbW9uLlNUQUdFX0hFSUdIVCk7XHJcbiAgICBnLmVuZEZpbGwoKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoZyk7XHJcblxyXG4gICAgdmFyIGhvbGRlciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgaG9sZGVyLnggPSBDb21tb24uU1RBR0VfV0lEVEggKiAwLjU7XHJcbiAgICBob2xkZXIueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgKiAwLjUgKyA0NjtcclxuICAgIHRoaXMuYWRkQ2hpbGQoaG9sZGVyKTtcclxuXHJcbiAgICB2YXIgZnJhbWVzID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IDEwOyArKyBpKSB7XHJcbiAgICAgICAgZnJhbWVzLnB1c2goQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKFwibG9hZGVyX2FuaW1hdGlvbjAwMFwiICsgaSkpO1xyXG4gICAgfVxyXG4gICAgZnJhbWVzLnB1c2goQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKFwibG9hZGVyX2FuaW1hdGlvbjAwMTBcIikpO1xyXG5cclxuICAgIHZhciBzZXF1ZW5jZSA9IG5ldyBwMy5Nb3ZpZUNsaXBTZXF1ZW5jZSgpO1xyXG4gICAgc2VxdWVuY2UuYWRkVGV4dHVyZXMoZnJhbWVzKTtcclxuXHJcbiAgICB0aGlzLl9sb2dvID0gbmV3IHAzLk1vdmllQ2xpcChzZXF1ZW5jZSk7XHJcbiAgICB0aGlzLl9sb2dvLnggPSA1MDtcclxuICAgIHRoaXMuX2xvZ28ueSA9IDIwO1xyXG4gICAgdGhpcy5fbG9nby5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDEpO1xyXG4gICAgdGhpcy5fbG9nby5hbmltYXRpb25TcGVlZCA9IDEgLyA0O1xyXG4gICAgdGhpcy5fbG9nby5sb29waW5nID0gZmFsc2U7XHJcbiAgICB0aGlzLl9sb2dvLnBsYXkoKTtcclxuICAgIGhvbGRlci5hZGRDaGlsZCh0aGlzLl9sb2dvKTtcclxuXHJcbiAgICB0aGlzLl9iYXIgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKFwicHJlbG9hZGVyX2JnXCIpKTtcclxuICAgIHRoaXMuX2Jhci55ID0gMzQ7XHJcbiAgICB0aGlzLl9iYXIuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xyXG4gICAgaG9sZGVyLmFkZENoaWxkKHRoaXMuX2Jhcik7XHJcblxyXG4gICAgdGhpcy5fYmFyLmZpbGwgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKFwicHJlbG9hZGVyX2JhclwiKSk7XHJcbiAgICB0aGlzLl9iYXIuZmlsbC5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XHJcbiAgICB0aGlzLl9iYXIuYWRkQ2hpbGQodGhpcy5fYmFyLmZpbGwpO1xyXG5cclxuICAgIHRoaXMuX2Jhci5maWxsLm1hc2sgPSBuZXcgUElYSS5HcmFwaGljcygpO1xyXG4gICAgdGhpcy5fYmFyLmZpbGwubWFzay54ID0gLXRoaXMuX2Jhci5maWxsLnRleHR1cmUud2lkdGggKiAwLjU7XHJcbiAgICB0aGlzLl9iYXIuZmlsbC5tYXNrLnNjYWxlLnggPSAwO1xyXG4gICAgdGhpcy5fYmFyLmZpbGwubWFzay5iZWdpbkZpbGwoMHhGRjAwMDApO1xyXG4gICAgdGhpcy5fYmFyLmZpbGwubWFzay5kcmF3UmVjdCgwLCAtdGhpcy5fYmFyLmZpbGwudGV4dHVyZS5oZWlnaHQgKiAwLjUsXHJcbiAgICB0aGlzLl9iYXIuZmlsbC50ZXh0dXJlLndpZHRoLCB0aGlzLl9iYXIuZmlsbC50ZXh0dXJlLmhlaWdodCk7XHJcbiAgICB0aGlzLl9iYXIuZmlsbC5hZGRDaGlsZCh0aGlzLl9iYXIuZmlsbC5tYXNrKTtcclxuXHJcbiAgICB0aGlzLl9iYXIuZnJhbWUgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKFwicHJlbG9hZGVyX292ZXJsYXlcIikpO1xyXG4gICAgdGhpcy5fYmFyLmZyYW1lLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuICAgIHRoaXMuX2Jhci5hZGRDaGlsZCh0aGlzLl9iYXIuZnJhbWUpO1xyXG5cclxuICAgIHRoaXMuX3RleHQgPSBuZXcgUElYSS5UZXh0KFwiMCVcIiwge2ZvbnRTaXplOiBcIjMycHhcIiwgZm9udEZhbWlseTogXCJBcmlhbFwiLCBmaWxsOiBcIiNGRkZGRkZcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuICAgIHRoaXMuX3RleHQueSA9IHRoaXMuX2Jhci55ICsgNjA7XHJcbiAgICB0aGlzLl90ZXh0LnBpdm90LnggPSB0aGlzLl90ZXh0LndpZHRoICogMC41O1xyXG4gICAgdGhpcy5fdGV4dC5waXZvdC55ID0gdGhpcy5fdGV4dC5oZWlnaHQgKiAwLjU7XHJcbiAgICBob2xkZXIuYWRkQ2hpbGQodGhpcy5fdGV4dCk7XHJcblxyXG59O1xyXG5cclxuUHJlbG9hZGVyU2NyZWVuLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcblByZWxvYWRlclNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59O1xyXG5cclxuUHJlbG9hZGVyU2NyZWVuLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMuX2xvYWRlZFNtb290aCArPSAodGhpcy5sb2FkZWQgLSB0aGlzLl9sb2FkZWRTbW9vdGgpICogMC4xO1xyXG5cclxuICAgIGlmKHRoaXMuX2xvYWRlZFNtb290aCA+IDk5KVxyXG4gICAgICAgIHRoaXMuX2xvYWRlZFNtb290aCA9IDEwMDtcclxuXHJcbiAgICB2YXIgbG9hZGVkID0gTWF0aC5taW4oMSwgdGhpcy5fbG9hZGVkU21vb3RoLzEwMCk7XHJcbiAgICB0aGlzLl9iYXIuZmlsbC5tYXNrLnNjYWxlLnggKz0gKGxvYWRlZCAtIHRoaXMuX2Jhci5maWxsLm1hc2suc2NhbGUueCkgKiAwLjQ7XHJcblxyXG4gICAgdGhpcy5fdGV4dC50ZXh0ID0gXCJcIiArIE1hdGgucm91bmQobG9hZGVkICogMTAwKSArIFwiJVwiO1xyXG4gICAgdGhpcy5fdGV4dC5waXZvdC54ID0gdGhpcy5fdGV4dC53aWR0aCAqIDAuNTtcclxuXHJcbiAgICBpZihsb2FkZWQgPT0gMSlcclxuICAgIHtcclxuICAgICAgICB0aGlzLnNpZ25hbHMubG9hZENvbXBsZXRlLmRpc3BhdGNoKCk7XHJcbiAgICB9XHJcbn07IiwiXHJcbnZhciBDb21tb24gICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgR1VJQnV0dG9uRGF0YSAgID0gcmVxdWlyZShcIi4uL3VpL0dVSWJ1dHRvbkRhdGFcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gU2ltcGxlU2NyZWVuKCkge1xyXG5cclxuICAgIHAzLlNjZW5lLmNhbGwodGhpcyk7XHJcblxyXG4gICAgdGhpcy5zaWduYWxzLm5leHQgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcclxuICAgIHRoaXMuc2lnbmFscy5wcmV2aW91cyA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG4gICAgdGhpcy5zaWduYWxzLmd1aUNsaWNrID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkTXVzaWNQbGF5ID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkTXVzaWNTdG9wID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkQW1iaWVuY2VQbGF5ID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkQW1iaWVuY2VTdG9wID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkQW1iaWVuY2VTdG9wQWxsID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcblxyXG4gICAgdGhpcy5fY2VudHJlID0gbmV3IFBJWEkuUG9pbnQoQ29tbW9uLlNUQUdFX1dJRFRILzIsIENvbW1vbi5TVEFHRV9IRUlHSFQvMik7XHJcbiAgICB0aGlzLl9sZWZ0RWRnZSA9IDA7XHJcbiAgICB0aGlzLl9yaWdodEVkZ2UgPSAwO1xyXG5cclxuICAgIHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMgPSB7dG9wOjEwMCwgYm90dG9tOjEwMCwgcmlnaHQ6MTAwLCBsZWZ0OjEwMCwgbWluU3BhY2luZzoxNTB9O1xyXG4gICAgdGhpcy5fZ3VpQnV0dG9ucyA9IHt9O1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gU2ltcGxlU2NyZWVuO1xyXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShwMy5TY2VuZS5wcm90b3R5cGUpO1xyXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gU2ltcGxlU2NyZWVuO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblxyXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIFxyXG59O1xyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICB0aGlzLnNpZ25hbHMubmV4dC5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLnNpZ25hbHMucHJldmlvdXMuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy5zaWduYWxzLmd1aUNsaWNrLmRpc3Bvc2UoKTtcclxufTtcclxuXHJcblNpbXBsZVNjcmVlbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59O1xyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hZGRQYXVzZUJ1dHRvbiA9IGZ1bmN0aW9uKHgsIHkpXHJcbntcclxuICAgIHZhciBidXR0b24gPSB0aGlzLl9nZW5lcmF0ZUJ1dHRvbignaWNvbl9wYXVzZScsICdwYXVzZScpO1xyXG4gICAgYnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25HVUlCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuXHJcbiAgICBpZih5ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMudG9wO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi55ID0geTtcclxuICAgIH1cclxuICAgIGlmKHggPT0gdW5kZWZpbmVkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2d1aUJ1dHRvbnMucGF1c2UgPSBuZXcgR1VJQnV0dG9uRGF0YShidXR0b24sIGZ1bmN0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJ1dHRvbi54ID0gdGhpcy5fcmlnaHRFZGdlIC0gdGhpcy5fZ3VpQnV0dG9uTWFyZ2lucy5yaWdodDtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi54ID0geDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKGJ1dHRvbik7XHJcblxyXG4gICAgcmV0dXJuIGJ1dHRvbjtcclxufVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hZGRIZWxwQnV0dG9uID0gZnVuY3Rpb24oeCwgeSlcclxue1xyXG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKCdpY29uX2hlbHAnLCAnaGVscCcpO1xyXG4gICAgYnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25HVUlCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuXHJcbiAgICBpZih5ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMudG9wO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi55ID0geTtcclxuICAgIH1cclxuICAgIGlmKHggPT0gdW5kZWZpbmVkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2d1aUJ1dHRvbnMuaGVscCA9IG5ldyBHVUlCdXR0b25EYXRhKGJ1dHRvbiwgZnVuY3Rpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYnV0dG9uLnggPSB0aGlzLl9yaWdodEVkZ2UgLSB0aGlzLl9ndWlCdXR0b25NYXJnaW5zLnJpZ2h0O1xyXG4gICAgICAgICAgICBpZih0aGlzLl9ndWlCdXR0b25zLnBhdXNlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24ueCAtPSB0aGlzLl9ndWlCdXR0b25NYXJnaW5zLm1pblNwYWNpbmc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi54ID0geDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKGJ1dHRvbik7XHJcblxyXG4gICAgcmV0dXJuIGJ1dHRvbjtcclxufVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hZGRCYWNrQnV0dG9uID0gZnVuY3Rpb24oeCwgeSlcclxue1xyXG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKCdpY29uX3ByZXZpb3VzJywgJ2JhY2snKTtcclxuICAgIGJ1dHRvbi5zaWduYWxzLnVwLmFkZCh0aGlzLm9uUHJldmlvdXNCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuXHJcbiAgICBpZih5ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMudG9wO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi55ID0geTtcclxuICAgIH1cclxuICAgIGlmKHggPT0gdW5kZWZpbmVkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2d1aUJ1dHRvbnMuYmFjayA9IG5ldyBHVUlCdXR0b25EYXRhKGJ1dHRvbiwgZnVuY3Rpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYnV0dG9uLnggPSB0aGlzLl9sZWZ0RWRnZSArIHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMubGVmdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi54ID0geDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKGJ1dHRvbik7XHJcblxyXG4gICAgcmV0dXJuIGJ1dHRvbjtcclxufVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hZGROZXh0QnV0dG9uID0gZnVuY3Rpb24oeCwgeSwgaWNvbilcclxue1xyXG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKGljb24gfHwgJ2ljb25fbmV4dCcsICduZXh0Jyk7XHJcbiAgICBidXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vbk5leHRCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuXHJcbiAgICBpZih5ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLSB0aGlzLl9ndWlCdXR0b25NYXJnaW5zLmJvdHRvbTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IHk7XHJcbiAgICB9XHJcbiAgICBpZih4ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9ndWlCdXR0b25zLm5leHQgPSBuZXcgR1VJQnV0dG9uRGF0YShidXR0b24sIGZ1bmN0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJ1dHRvbi54ID0gdGhpcy5fcmlnaHRFZGdlIC0gdGhpcy5fZ3VpQnV0dG9uTWFyZ2lucy5yaWdodDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi54ID0geDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKGJ1dHRvbik7XHJcblxyXG4gICAgcmV0dXJuIGJ1dHRvbjtcclxufVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hZGRSaWdodEJ1dHRvbiA9IGZ1bmN0aW9uKHgsIHkpXHJcbntcclxuICAgIHZhciBidXR0b24gPSB0aGlzLl9nZW5lcmF0ZUJ1dHRvbignaWNvbl90ZXJ0YWlyeV9uZXh0JywgJ3JpZ2h0JywgJ3RlcnRhaXJ5Jyk7XHJcbiAgICBidXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vbkludGVybmFsQnV0dG9uQ2xpY2tlZCwgdGhpcyk7XHJcblxyXG4gICAgaWYoeSA9PSB1bmRlZmluZWQpXHJcbiAgICB7XHJcbiAgICAgICAgYnV0dG9uLnkgPSBDb21tb24uU1RBR0VfSEVJR0hULzI7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgYnV0dG9uLnkgPSB5O1xyXG4gICAgfVxyXG4gICAgaWYoeCA9PSB1bmRlZmluZWQpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fZ3VpQnV0dG9ucy5yaWdodCA9IG5ldyBHVUlCdXR0b25EYXRhKGJ1dHRvbiwgZnVuY3Rpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYnV0dG9uLnggPSB0aGlzLl9yaWdodEVkZ2UgLSAoYnV0dG9uLndpZHRoLzIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgYnV0dG9uLnggPSB4O1xyXG4gICAgfVxyXG5cclxuICAgIGJ1dHRvbi5hbmltYXRlID0gZmFsc2U7XHJcbiAgICBidXR0b24uX2JhY2tncm91bmQuc2NhbGUueCA9IC0xO1xyXG4gICAgdGhpcy5hZGRDaGlsZChidXR0b24pO1xyXG5cclxuICAgIHJldHVybiBidXR0b247XHJcbn1cclxuXHJcblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYWRkTGVmdEJ1dHRvbiA9IGZ1bmN0aW9uKHgsIHkpXHJcbntcclxuICAgIHZhciBidXR0b24gPSB0aGlzLl9nZW5lcmF0ZUJ1dHRvbignaWNvbl90ZXJ0YWlyeV9iYWNrJywgJ2xlZnQnLCAndGVydGFpcnknKTtcclxuICAgIGJ1dHRvbi5zaWduYWxzLnVwLmFkZCh0aGlzLm9uSW50ZXJuYWxCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuXHJcbiAgICBpZih5ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQvMjtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IHk7XHJcbiAgICB9XHJcbiAgICBpZih4ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9ndWlCdXR0b25zLmxlZnQgPSBuZXcgR1VJQnV0dG9uRGF0YShidXR0b24sIGZ1bmN0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJ1dHRvbi54ID0gdGhpcy5fbGVmdEVkZ2UgKyAoYnV0dG9uLndpZHRoLzIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgYnV0dG9uLnggPSB4O1xyXG4gICAgfVxyXG4gICAgYnV0dG9uLmFuaW1hdGUgPSBmYWxzZTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoYnV0dG9uKTtcclxuXHJcbiAgICByZXR1cm4gYnV0dG9uO1xyXG59XHJcblxyXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFkZE11dGVCdXR0b24gPSBmdW5jdGlvbih4LCB5KVxyXG57XHJcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5fZ2VuZXJhdGVCdXR0b24oJ2ljb25fc291bmQnLCAnbXV0ZScpO1xyXG5cclxuICAgIGlmKHkgPT0gdW5kZWZpbmVkKVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi55ID0gdGhpcy5fZ3VpQnV0dG9uTWFyZ2lucy50b3A7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgYnV0dG9uLnkgPSB5O1xyXG4gICAgfVxyXG4gICAgaWYoeCA9PSB1bmRlZmluZWQpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fZ3VpQnV0dG9ucy5tdXRlID0gbmV3IEdVSUJ1dHRvbkRhdGEoYnV0dG9uLCBmdW5jdGlvbigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBidXR0b24ueCA9IHRoaXMuX3JpZ2h0RWRnZSAtIHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMucmlnaHQ7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2d1aUJ1dHRvbnMucGF1c2UpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi54IC09IHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMubWluU3BhY2luZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLl9ndWlCdXR0b25zLmhlbHApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi54IC09IHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMubWluU3BhY2luZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlXHJcbiAgICB7XHJcbiAgICAgICAgYnV0dG9uLnggPSB4O1xyXG4gICAgfVxyXG4gICAgdGhpcy5hZGRDaGlsZChidXR0b24pO1xyXG4gICAgcmV0dXJuIGJ1dHRvbjtcclxufVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hZGRIb21lQnV0dG9uID0gZnVuY3Rpb24oeCwgeSlcclxue1xyXG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKCdpY29uX2hvbWUnLCAnaG9tZScpO1xyXG4gICAgYnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25HVUlCdXR0b25DbGlja2VkLCB0aGlzKTtcclxuXHJcbiAgICBpZih5ID09IHVuZGVmaW5lZClcclxuICAgIHtcclxuICAgICAgICBidXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMudG9wO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi55ID0geTtcclxuICAgIH1cclxuICAgIGlmKHggPT0gdW5kZWZpbmVkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2d1aUJ1dHRvbnMuaG9tZSA9IG5ldyBHVUlCdXR0b25EYXRhKGJ1dHRvbiwgZnVuY3Rpb24oKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYnV0dG9uLnggPSB0aGlzLl9sZWZ0RWRnZSArIHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMubGVmdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIGJ1dHRvbi54ID0geDtcclxuICAgIH1cclxuICAgIHRoaXMuYWRkQ2hpbGQoYnV0dG9uKTtcclxuICAgIHJldHVybiBidXR0b247XHJcbn1cclxuXHJcblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYWRkT3ZlcmxheSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgdmFyIG92ZXJsYXkgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmNvbG91cnMuYmxhY2spO1xyXG4gICAgb3ZlcmxheS5hbHBoYSA9IDAuNztcclxuICAgIG92ZXJsYXkud2lkdGggPSBDb21tb24uU1RBR0VfV0lEVEg7XHJcbiAgICBvdmVybGF5LmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XHJcbiAgICBvdmVybGF5LmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgQ29tbW9uLlNUQUdFX1dJRFRILCBDb21tb24uU1RBR0VfSEVJR0hUKTtcclxuICAgIG92ZXJsYXkuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG4gICAgdGhpcy5hZGRDaGlsZChvdmVybGF5KTtcclxufVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMueCA9IChwMy5WaWV3LndpZHRoIC0gQ29tbW9uLlNUQUdFX1dJRFRIKSAqIDAuNTtcclxuXHJcbiAgICB0aGlzLl9yaWdodEVkZ2UgPSB0aGlzLl9jZW50cmUueCArIChwMy5WaWV3LndpZHRoLzIpO1xyXG4gICAgdGhpcy5fbGVmdEVkZ2UgPSB0aGlzLl9jZW50cmUueCAtIChwMy5WaWV3LndpZHRoLzIpO1xyXG5cclxuICAgIGZvcih2YXIgaSBpbiB0aGlzLl9ndWlCdXR0b25zKVxyXG4gICAge1xyXG4gICAgICAgIGlmKHRoaXMuX2d1aUJ1dHRvbnNbaV0uc2V0WClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX2d1aUJ1dHRvbnNbaV0uc2V0WCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcblxyXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLmhpZGVHVUkgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcblxyXG59O1xyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5zaG93R1VJID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59O1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5fZ2VuZXJhdGVCdXR0b24gPSBmdW5jdGlvbihpY29uLCBpZCwgdHlwZSlcclxue1xyXG4gICAgdHlwZSA9IHR5cGUgfHwgJ3ByaW1hcnlfc21hbGwnO1xyXG4gICAgdmFyIGJ1dHRvblN0YXRlcyA9IG5ldyBwMy5CdXR0b25TdGF0ZXMoXHJcbiAgICAgICAgQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdidG5fJyArIHR5cGUgKyAnX29mZicpLFxyXG4gICAgICAgIENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSgnYnRuXycgKyB0eXBlICsgJ19vdmVyJyksXHJcbiAgICAgICAgQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdidG5fJyArIHR5cGUgKyAnX2Rvd24nKSxcclxuICAgICAgICBDb21tb24uYXNzZXRzLmdldFRleHR1cmUoaWNvbiArICdfb2ZmJylcclxuICAgICk7XHJcblxyXG4gICAgYnV0dG9uU3RhdGVzLmljb25PdmVyID0gQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKGljb24gKyAnX292ZXInKTtcclxuICAgIGJ1dHRvblN0YXRlcy5pY29uRG93biA9IENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZShpY29uICsgJ19kb3duJyk7XHJcblxyXG4gICAgdmFyIGJ1dHRvbjtcclxuICAgIGlmKGlkID09ICdtdXRlJylcclxuICAgIHtcclxuICAgICAgICBidXR0b25TdGF0ZXMuaWNvbkFsdCA9IENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSgnaWNvbl9tdXRlX29mZicpO1xyXG4gICAgICAgIGJ1dHRvblN0YXRlcy5pY29uT3ZlckFsdCA9IENvbW1vbi5hc3NldHMuZ2V0VGV4dHVyZSgnaWNvbl9tdXRlX292ZXInKTtcclxuICAgICAgICBidXR0b25TdGF0ZXMuaWNvbkRvd25BbHQgPSBDb21tb24uYXNzZXRzLmdldFRleHR1cmUoJ2ljb25fbXV0ZV9kb3duJyk7XHJcbiAgICAgICAgYnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b24oYnV0dG9uU3RhdGVzKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICBidXR0b24gPSBuZXcgcDMuQnV0dG9uKGJ1dHRvblN0YXRlcyk7XHJcbiAgICB9XHJcbiAgICBidXR0b24uaWQgPSBpZDtcclxuICAgIHJldHVybiBidXR0b247XHJcbn1cclxuXHJcblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuX2dlbmVyYXRlUGxhY2Vob2xkZXJCdXR0b24gPSBmdW5jdGlvbih0ZXh0LCBpZCwgbXV0ZSlcclxue1xyXG4gICAgaWYoQ29tbW9uLnBsYWNlSG9sZGVyQnV0dG9uSWNvbnNbaWRdID09IG51bGwpXHJcbiAgICB7ICAgXHJcbiAgICAgICAgdmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KHRleHQsIHtmb250OiczMHB4IFRhaG9tYScsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcbiAgICAgICAgQ29tbW9uLnBsYWNlSG9sZGVyQnV0dG9uSWNvbnNbaWRdID0gdGV4dC5nZW5lcmF0ZVRleHR1cmUoQ29tbW9uLnJlbmRlcmVyLCAxLjAsIFBJWEkuU0NBTEVfTU9ERVMuTElORUFSKTtcclxuICAgIH1cclxuICAgIHZhciBidXR0b25TdGF0ZXMgPSBuZXcgcDMuQnV0dG9uU3RhdGVzKFxyXG4gICAgICAgIENvbW1vbi5wbGFjZUhvbGRlckJ1dHRvbkJveCxcclxuICAgICAgICBDb21tb24ucGxhY2VIb2xkZXJCdXR0b25Cb3gsXHJcbiAgICAgICAgQ29tbW9uLnBsYWNlSG9sZGVyQnV0dG9uQm94LFxyXG4gICAgICAgIENvbW1vbi5wbGFjZUhvbGRlckJ1dHRvbkljb25zW2lkXVxyXG4gICAgKTtcclxuXHJcbiAgICB2YXIgYnV0dG9uO1xyXG4gICAgaWYobXV0ZSlcclxuICAgIHtcclxuICAgICAgICBpZihDb21tb24ucGxhY2VIb2xkZXJCdXR0b25JY29ucy51bm11dGUgPT0gbnVsbClcclxuICAgICAgICB7ICAgXHJcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dCgnVW5tdXRlJywge2ZvbnQ6JzMwcHggVGFob21hJywgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcclxuICAgICAgICAgICAgQ29tbW9uLnBsYWNlSG9sZGVyQnV0dG9uSWNvbnMudW5tdXRlID0gdGV4dC5nZW5lcmF0ZVRleHR1cmUoQ29tbW9uLnJlbmRlcmVyLCAxLjAsIFBJWEkuU0NBTEVfTU9ERVMuTElORUFSKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnV0dG9uU3RhdGVzLmljb25BbHQgPSBDb21tb24ucGxhY2VIb2xkZXJCdXR0b25JY29ucy51bm11dGU7XHJcbiAgICAgICAgYnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b24oYnV0dG9uU3RhdGVzKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICBidXR0b24gPSBuZXcgcDMuQnV0dG9uKGJ1dHRvblN0YXRlcyk7XHJcbiAgICB9XHJcbiAgICBidXR0b24uYW5pbWF0ZSA9IGZhbHNlO1xyXG4gICAgYnV0dG9uLmFuaW1hdGVJY29uID0gZmFsc2U7XHJcbiAgICBidXR0b24uaWQgPSBpZDtcclxuICAgIHJldHVybiBidXR0b247XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5vbkdVSUJ1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXHJcbntcclxuICAgIGlmKGJ1dHRvbi5pZCA9PSBcImJhY2tcIilcclxuICAgICAgICB0aGlzLnNpZ25hbHMucHJldmlvdXMuZGlzcGF0Y2goYnV0dG9uLmlkKTtcclxuICAgIGVsc2VcclxuICAgICAgICB0aGlzLnNpZ25hbHMuZ3VpQ2xpY2suZGlzcGF0Y2goYnV0dG9uLmlkKTtcclxufTtcclxuXHJcblNpbXBsZVNjcmVlbi5wcm90b3R5cGUub25JbnRlcm5hbEJ1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXHJcbntcclxuXHJcbn1cclxuXHJcblNpbXBsZVNjcmVlbi5wcm90b3R5cGUub25OZXh0QnV0dG9uQ2xpY2tlZCA9IGZ1bmN0aW9uKGJ1dHRvbilcclxue1xyXG4gICAgdGhpcy5zaWduYWxzLm5leHQuZGlzcGF0Y2goYnV0dG9uLmlkKTtcclxufTtcclxuXHJcblNpbXBsZVNjcmVlbi5wcm90b3R5cGUub25QcmV2aW91c0J1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXHJcbntcclxuICAgIHRoaXMuc2lnbmFscy5wcmV2aW91cy5kaXNwYXRjaChidXR0b24uaWQpO1xyXG59O1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiAgICAgICAgPSByZXF1aXJlKCcuL1NpbXBsZVNjcmVlbicpO1xyXG52YXIgR1VJQnV0dG9uRGF0YSAgICAgICA9IHJlcXVpcmUoXCIuLi91aS9HVUlidXR0b25EYXRhXCIpO1xyXG52YXIgQW5pbWF0ZWRDaGFyYWN0ZXIgICA9IHJlcXVpcmUoJy4uL2dhbWUvQW5pbWF0ZWRDaGFyYWN0ZXInKTtcclxudmFyIEJ1dHRlcmZseSAgICAgICAgICAgPSByZXF1aXJlKCcuLi9nYW1lL0J1dHRlcmZseScpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIFRpdGxlU2NyZWVuKClcclxue1xyXG4gICAgdGhpcy5fY2hhcmFjdGVyID0gbnVsbDtcclxuICAgIHRoaXMuX3RvdG8gPSBudWxsO1xyXG5cclxuICAgIHRoaXMuX2J1dHRlcmZsaWVzID0gbnVsbDtcclxuXHJcbiAgICBTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxufVxyXG5cclxuVGl0bGVTY3JlZW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcclxuVGl0bGVTY3JlZW4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVGl0bGVTY3JlZW47XHJcbm1vZHVsZS5leHBvcnRzID0gVGl0bGVTY3JlZW47XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuVGl0bGVTY3JlZW4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR2YXIgYmFja2dyb3VuZCA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uYXNzZXRzLmdldFRleHR1cmUoJ2JnX3NwbGFzaCcpKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoYmFja2dyb3VuZCk7XHJcblxyXG4gICAgdGhpcy5fYnV0dGVyZmxpZXMgPSBbXTtcclxuXHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgNSArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpOyBpKyspXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGJmID0gbmV3IEJ1dHRlcmZseSgpO1xyXG4gICAgICAgIHRoaXMuYWRkQ2hpbGQoYmYpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRlcmZsaWVzLnB1c2goYmYpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciB0aXRsZSA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uYXNzZXRzLmdldFRleHR1cmUoJ3RpdGxlJykpO1xyXG4gICAgdGl0bGUuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xyXG4gICAgdGl0bGUueCA9IENvbW1vbi5TVEFHRV9XSURUSCAvIDI7XHJcbiAgICB0aXRsZS55ID0gKENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyKSAtIDIwMDtcclxuICAgIHRpdGxlLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XHJcbiAgICB0aXRsZS5yb3RhdGlvbiA9IDIwICogUElYSS5ERUdfVE9fUkFEO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aXRsZSk7XHJcblxyXG4gICAgdGhpcy5fY2hhcmFjdGVyID0gbmV3IEFuaW1hdGVkQ2hhcmFjdGVyKCk7XHJcbiAgICB0aGlzLl9jaGFyYWN0ZXIueCA9IChDb21tb24uU1RBR0VfV0lEVEggLyAyKTtcclxuICAgIHRoaXMuX2NoYXJhY3Rlci55ID0gNzQwO1xyXG4gICAgdGhpcy5fY2hhcmFjdGVyLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMC44LCAwLjgpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9jaGFyYWN0ZXIpO1xyXG5cclxuICAgIHRoaXMuX3RvdG8gPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdzcGxhc2hfZG9nJykpO1xyXG4gICAgdGhpcy5fdG90by5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDEpO1xyXG4gICAgdGhpcy5fdG90by54ID0gKENvbW1vbi5TVEFHRV9XSURUSCAvIDIpIC0gMjAwO1xyXG4gICAgdGhpcy5fdG90by55ID0gNzQwO1xyXG5cclxuICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGhpcy5fdG90by5zY2FsZSwgMSwge3k6MC45OCwgZWFzZTpTaW5lLmVhc2VJbk91dCwgcmVwZWF0Oi0xLCB5b3lvOnRydWV9KSk7XHJcblxyXG4gICAgdmFyIHRvdG9TaGFkb3cgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdzcGxhc2hfZG9nX3NoYWRvdycpKTtcclxuICAgIHRvdG9TaGFkb3cuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC4zLCAwLjUpO1xyXG4gICAgdG90b1NoYWRvdy54ID0gdGhpcy5fdG90by54O1xyXG4gICAgdG90b1NoYWRvdy55ID0gdGhpcy5fdG90by55O1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0b3RvU2hhZG93KTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3RvdG8pO1xyXG5cclxuICAgIHZhciBkZWxheSA9IDAuNDtcclxuICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGl0bGUuc2NhbGUsIDEsIHtkZWxheTpkZWxheSwgeDoxLCBlYXNlOkVsYXN0aWMuZWFzZU91dH0pKTtcclxuICAgIENvbW1vbi5hbmltYXRvci5hZGQoVHdlZW5NYXgudG8odGl0bGUuc2NhbGUsIDEuMSwge2RlbGF5OmRlbGF5LCB5OjEsIGVhc2U6RWxhc3RpYy5lYXNlT3V0fSkpO1xyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aXRsZSwgMC44LCB7ZGVsYXk6ZGVsYXksIHJvdGF0aW9uOjAsIGVhc2U6QmFjay5lYXNlT3V0fSkpO1xyXG5cclxuXHR2YXIgcGxheUJ1dHRvbiA9IHRoaXMuX2dlbmVyYXRlQnV0dG9uKCdpY29uX3BsYXlfbGFyZ2UnLCAncGxheScsICdwcmltYXJ5X2xhcmdlJyk7XHJcbiAgICBwbGF5QnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25OZXh0QnV0dG9uQ2xpY2tlZCwgdGhpcyk7XHJcbiAgICBwbGF5QnV0dG9uLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC0gKHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMuYm90dG9tICogMS4zOCk7XHJcbiAgICB0aGlzLl9ndWlCdXR0b25zLnBsYXkgPSBuZXcgR1VJQnV0dG9uRGF0YShwbGF5QnV0dG9uLCBmdW5jdGlvbigpXHJcbiAgICB7XHJcbiAgICAgICAgcGxheUJ1dHRvbi54ID0gdGhpcy5fcmlnaHRFZGdlIC0gKHRoaXMuX2d1aUJ1dHRvbk1hcmdpbnMucmlnaHQgKiAxLjM4KTtcclxuICAgIH1cclxuICAgIC5iaW5kKHRoaXMpKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQocGxheUJ1dHRvbik7XHJcblxyXG4gICAgdGhpcy5hZGRNdXRlQnV0dG9uKCk7XHJcblxyXG4gICAgdGhpcy5zaWduYWxzLnJlcXVlc3RlZE11c2ljUGxheS5kaXNwYXRjaCgnbXVzaWNfbWVudV9sb29wXzAxJyk7XHJcblxyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG5UaXRsZVNjcmVlbi5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG5UaXRsZVNjcmVlbi5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xyXG59O1xyXG5cclxuVGl0bGVTY3JlZW4ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgaWYoQ29tbW9uLnBhdXNlZCkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgaWYoQ29tbW9uLmZyYW1lQ291bnQgJSAzMCA9PSAwICYmIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpID09IDApXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fdG90by50ZXh0dXJlID0gQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdzcGxhc2hfZG9nX2JsaW5rJyk7XHJcbiAgICAgICAgQ29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5fdG90by50ZXh0dXJlID0gQ29tbW9uLmFzc2V0cy5nZXRUZXh0dXJlKCdzcGxhc2hfZG9nJyk7XHJcbiAgICAgICAgfSwgLjIsIHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NoYXJhY3Rlci51cGRhdGUoKTtcclxuXHJcbiAgICBmb3IodmFyIGkgaW4gdGhpcy5fYnV0dGVyZmxpZXMpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fYnV0dGVyZmxpZXNbaV0udXBkYXRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIFNpbXBsZVNjcmVlbi5wcm90b3R5cGUudXBkYXRlLmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsIlxyXG5mdW5jdGlvbiBHVUlCdXR0b25EYXRhKGJ1dHRvbiwgc2V0WClcclxue1xyXG4gICAgdGhpcy5idXR0b24gPSBidXR0b247XHJcbiAgICB0aGlzLnNldFggPSBzZXRYOyAgICBcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IEdVSUJ1dHRvbkRhdGE7XHJcbiJdfQ==
