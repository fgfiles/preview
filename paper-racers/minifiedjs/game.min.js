!function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var t=this||e;return t._counter=1e3,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.mobileAutoEnable=!0,t._setup(),t},volume:function(t){var i=this||e;if(t=parseFloat(t),i.ctx||c(),void 0!==t&&t>=0&&t<=1){if(i._volume=t,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var o=i._howls[n]._getSoundIds(),r=0;r<o.length;r++){var a=i._howls[n]._soundById(o[r]);a&&a._node&&(a._node.volume=a._volume*t)}return i}return i._volume},mute:function(t){var i=this||e;i.ctx||c(),i._muted=t,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(t?0:i._volume,e.ctx.currentTime);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var o=i._howls[n]._getSoundIds(),r=0;r<o.length;r++){var a=i._howls[n]._soundById(o[r]);a&&a._node&&(a._node.muted=!!t||a._muted)}return i},unload:function(){for(var t=this||e,i=t._howls.length-1;i>=0;i--)t._howls[i].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,c()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx?t.ctx.state||"running":"running",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(i=new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{var i=new Audio;i.muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,i=null;try{i="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!i||"function"!=typeof i.canPlayType)return t;var n=i.canPlayType("audio/mpeg;").replace(/^no$/,""),o=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),r=o&&parseInt(o[0].split("/")[1],10)<33;return t._codecs={mp3:!(r||!n&&!i.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_enableMobileAudio:function(){var t=this||e,i=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome/i.test(t._navigator&&t._navigator.userAgent);if(!t._mobileEnabled&&t.ctx&&i){t._mobileEnabled=!1,t.mobileAutoEnable=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var n=function(i){i.preventDefault(),e._autoResume();var o=t.ctx.createBufferSource();o.buffer=t._scratchBuffer,o.connect(t.ctx.destination),void 0===o.start?o.noteOn(0):o.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),o.onended=function(){o.disconnect(0),t._mobileEnabled=!0,document.removeEventListener("touchstart",n,!0),document.removeEventListener("touchend",n,!0),document.removeEventListener("click",n,!0);for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("unlock")}};return document.addEventListener("touchstart",n,!0),document.addEventListener("touchend",n,!0),document.addEventListener("click",n,!0),t}},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var i=0;i<t._howls.length;i++)if(t._howls[i]._webAudio)for(var n=0;n<t._howls[i]._sounds.length;n++)if(!t._howls[i]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then(function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())}))},3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new t,i=function(t){var e=this;t.src&&0!==t.src.length?e.init(t):console.error("An array of source files must be passed with any new Howl.")};i.prototype={init:function(t){var i=this;return e.ctx||c(),i._autoplay=t.autoplay||!1,i._format="string"!=typeof t.format?t.format:[t.format],i._html5=t.html5||!1,i._muted=t.mute||!1,i._loop=t.loop||!1,i._pool=t.pool||5,i._preload="boolean"!=typeof t.preload||t.preload,i._rate=t.rate||1,i._sprite=t.sprite||{},i._src="string"!=typeof t.src?t.src:[t.src],i._volume=void 0!==t.volume?t.volume:1,i._xhrWithCredentials=t.xhrWithCredentials||!1,i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=t.onend?[{fn:t.onend}]:[],i._onfade=t.onfade?[{fn:t.onfade}]:[],i._onload=t.onload?[{fn:t.onload}]:[],i._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],i._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],i._onpause=t.onpause?[{fn:t.onpause}]:[],i._onplay=t.onplay?[{fn:t.onplay}]:[],i._onstop=t.onstop?[{fn:t.onstop}]:[],i._onmute=t.onmute?[{fn:t.onmute}]:[],i._onvolume=t.onvolume?[{fn:t.onvolume}]:[],i._onrate=t.onrate?[{fn:t.onrate}]:[],i._onseek=t.onseek?[{fn:t.onseek}]:[],i._onunlock=t.onunlock?[{fn:t.onunlock}]:[],i._onresume=[],i._webAudio=e.usingWebAudio&&!i._html5,void 0!==e.ctx&&e.ctx&&e.mobileAutoEnable&&e._enableMobileAudio(),e._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i.load(),i},load:function(){var t=this,i=null;if(e.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var o=0;o<t._src.length;o++){var a,s;if(t._format&&t._format[o])a=t._format[o];else{if("string"!=typeof(s=t._src[o])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(a=/^data:audio\/([^;,]+);/i.exec(s))||(a=/\.([^.]+)$/.exec(s.split("?",1)[0])),a&&(a=a[1].toLowerCase())}if(a||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),a&&e.codecs(a)){i=t._src[o];break}}if(i)return t._src=i,t._state="loading","https:"===window.location.protocol&&"http:"===i.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new n(t),t._webAudio&&r(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,i){var n=this,o=null;if("number"==typeof t)o=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t){t="__default";for(var r=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(r++,o=n._sounds[a]._id);1===r?t=null:o=null}}var s=o?n._soundById(o):n._inactiveSound();if(!s)return null;if(o&&!t&&(t=s._sprite||"__default"),"loaded"!==n._state){s._sprite=t,s._ended=!1;var l=s._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(o&&!s._paused)return i||n._loadQueue("play"),s._id;n._webAudio&&e._autoResume();var c=Math.max(0,s._seek>0?s._seek:n._sprite[t][0]/1e3),h=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-c),p=1e3*h/Math.abs(s._rate);if(s._paused=!1,s._ended=!1,s._sprite=t,s._seek=c,s._start=n._sprite[t][0]/1e3,s._stop=(n._sprite[t][0]+n._sprite[t][1])/1e3,s._loop=!(!s._loop&&!n._sprite[t][2]),!(s._seek>=s._stop)){var u=s._node;if(n._webAudio){var d=function(){n._refreshBuffer(s);var t=s._muted||n._muted?0:s._volume;u.gain.setValueAtTime(t,e.ctx.currentTime),s._playStart=e.ctx.currentTime,void 0===u.bufferSource.start?s._loop?u.bufferSource.noteGrainOn(0,c,86400):u.bufferSource.noteGrainOn(0,c,h):s._loop?u.bufferSource.start(0,c,86400):u.bufferSource.start(0,c,h),p!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),p)),i||setTimeout(function(){n._emit("play",s._id)},0)};"running"===e.state?d():(n.once("resume",d),n._clearTimer(s._id))}else{var f=function(){u.currentTime=c,u.muted=s._muted||n._muted||e._muted||u.muted,u.volume=s._volume*e.volume(),u.playbackRate=s._rate;try{var o=u.play();if("undefined"!=typeof Promise&&(o instanceof Promise||"function"==typeof o.then)?(n._playLock=!0,o.then(function(){n._playLock=!1,i||n._emit("play",s._id)}).catch(function(){n._playLock=!1,n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.")})):i||n._emit("play",s._id),u.playbackRate=s._rate,u.paused)return void n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||s._loop?n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),p):(n._endTimers[s._id]=function(){n._ended(s),u.removeEventListener("ended",n._endTimers[s._id],!1)},u.addEventListener("ended",n._endTimers[s._id],!1))}catch(t){n._emit("playerror",s._id,t)}},m=window&&window.ejecta||!u.readyState&&e._navigator.isCocoonJS;if(u.readyState>=3||m)f();else{var g=function(){f(),u.removeEventListener(e._canPlayEvent,g,!1)};u.addEventListener(e._canPlayEvent,g,!1),n._clearTimer(s._id)}}return s._id}n._ended(s)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var i=e._getSoundIds(t),n=0;n<i.length;n++){e._clearTimer(i[n]);var o=e._soundById(i[n]);if(o&&!o._paused&&(o._seek=e.seek(i[n]),o._rateSeek=0,o._paused=!0,e._stopFade(i[n]),o._node))if(e._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),e._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||e._emit("pause",o?o._id:null)}return e},stop:function(t,e){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(t)}}),i;for(var n=i._getSoundIds(t),o=0;o<n.length;o++){i._clearTimer(n[o]);var r=i._soundById(n[o]);r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,i._stopFade(n[o]),r._node&&(i._webAudio?r._node.bufferSource&&(void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),i._cleanBuffer(r._node)):isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause())),e||i._emit("stop",r._id))}return i},mute:function(t,i){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,i)}}),n;if(void 0===i){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var o=n._getSoundIds(i),r=0;r<o.length;r++){var a=n._soundById(o[r]);a&&(a._muted=t,a._interval&&n._stopFade(a._id),n._webAudio&&a._node?a._node.gain.setValueAtTime(t?0:a._volume,e.ctx.currentTime):a._node&&(a._node.muted=!!e._muted||t),n._emit("mute",a._id))}return n},volume:function(){var t,i,n=this,o=arguments;if(0===o.length)return n._volume;1===o.length||2===o.length&&void 0===o[1]?n._getSoundIds().indexOf(o[0])>=0?i=parseInt(o[0],10):t=parseFloat(o[0]):o.length>=2&&(t=parseFloat(o[0]),i=parseInt(o[1],10));var r;if(!(void 0!==t&&t>=0&&t<=1))return(r=i?n._soundById(i):n._sounds[0])?r._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;void 0===i&&(n._volume=t),i=n._getSoundIds(i);for(var a=0;a<i.length;a++)(r=n._soundById(i[a]))&&(r._volume=t,o[2]||n._stopFade(i[a]),n._webAudio&&r._node&&!r._muted?r._node.gain.setValueAtTime(t,e.ctx.currentTime):r._node&&!r._muted&&(r._node.volume=t*e.volume()),n._emit("volume",r._id));return n},fade:function(t,i,n,o){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(t,i,n,o)}}),r;r.volume(t,o);for(var a=r._getSoundIds(o),s=0;s<a.length;s++){var l=r._soundById(a[s]);if(l){if(o||r._stopFade(a[s]),r._webAudio&&!l._muted){var c=e.ctx.currentTime,h=c+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,c),l._node.gain.linearRampToValueAtTime(i,h)}r._startFadeInterval(l,t,i,n,a[s],void 0===o)}}return r},_startFadeInterval:function(t,e,i,n,o,r){var a=this,s=e,l=i-e,c=Math.abs(l/.01),h=Math.max(4,c>0?n/c:n),p=Date.now();t._fadeTo=i,t._interval=setInterval(function(){var o=(Date.now()-p)/n;p=Date.now(),s+=l*o,s=Math.max(0,s),s=Math.min(1,s),s=Math.round(100*s)/100,a._webAudio?t._volume=s:a.volume(s,t._id,!0),r&&(a._volume=s),(i<e&&s<=i||i>e&&s>=i)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,a.volume(i,t._id),a._emit("fade",t._id))},h)},_stopFade:function(t){var i=this,n=i._soundById(t);return n&&n._interval&&(i._webAudio&&n._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(n._interval),n._interval=null,i.volume(n._fadeTo,t),n._fadeTo=null,i._emit("fade",t)),i},loop:function(){var t,e,i,n=this,o=arguments;if(0===o.length)return n._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(i=n._soundById(parseInt(o[0],10)))&&i._loop;t=o[0],n._loop=t}else 2===o.length&&(t=o[0],e=parseInt(o[1],10));for(var r=n._getSoundIds(e),a=0;a<r.length;a++)(i=n._soundById(r[a]))&&(i._loop=t,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=t,t&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return n},rate:function(){var t,i,n=this,o=arguments;0===o.length?i=n._sounds[0]._id:1===o.length?n._getSoundIds().indexOf(o[0])>=0?i=parseInt(o[0],10):t=parseFloat(o[0]):2===o.length&&(t=parseFloat(o[0]),i=parseInt(o[1],10));var r;if("number"!=typeof t)return(r=n._soundById(i))?r._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;void 0===i&&(n._rate=t),i=n._getSoundIds(i);for(var a=0;a<i.length;a++)if(r=n._soundById(i[a])){r._rateSeek=n.seek(i[a]),r._playStart=n._webAudio?e.ctx.currentTime:r._playStart,r._rate=t,n._webAudio&&r._node&&r._node.bufferSource?r._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):r._node&&(r._node.playbackRate=t);var s=n.seek(i[a]),l=1e3*((n._sprite[r._sprite][0]+n._sprite[r._sprite][1])/1e3-s)/Math.abs(r._rate);!n._endTimers[i[a]]&&r._paused||(n._clearTimer(i[a]),n._endTimers[i[a]]=setTimeout(n._ended.bind(n,r),l)),n._emit("rate",r._id)}return n},seek:function(){var t,i,n=this,o=arguments;if(0===o.length?i=n._sounds[0]._id:1===o.length?n._getSoundIds().indexOf(o[0])>=0?i=parseInt(o[0],10):n._sounds.length&&(i=n._sounds[0]._id,t=parseFloat(o[0])):2===o.length&&(t=parseFloat(o[0]),i=parseInt(o[1],10)),void 0===i)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var r=n._soundById(i);if(r){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var a=n.playing(i)?e.ctx.currentTime-r._playStart:0,s=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(s+a*Math.abs(r._rate))}return r._node.currentTime}var l=n.playing(i);l&&n.pause(i,!0),r._seek=t,r._ended=!1,n._clearTimer(i),!n._webAudio&&r._node&&(r._node.currentTime=t);var c=function(){n._emit("seek",i),l&&n.play(i,!0)};if(l&&!n._webAudio){var h=function(){n._playLock?setTimeout(h,0):c()};setTimeout(h,0)}else c()}return n},playing:function(t){var e=this;if("number"==typeof t){var i=e._soundById(t);return!!i&&!i._paused}for(var n=0;n<e._sounds.length;n++)if(!e._sounds[n]._paused)return!0;return!1},duration:function(t){var e=this,i=e._duration,n=e._soundById(t);return n&&(i=e._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var t=this,i=t._sounds,n=0;n<i.length;n++)i[n]._paused||t.stop(i[n]._id),t._webAudio||(/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(i[n]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),i[n]._node.removeEventListener("error",i[n]._errorFn,!1),i[n]._node.removeEventListener(e._canPlayEvent,i[n]._loadFn,!1)),delete i[n]._node,t._clearTimer(i[n]._id);var r=e._howls.indexOf(t);r>=0&&e._howls.splice(r,1);var a=!0;for(n=0;n<e._howls.length;n++)if(e._howls[n]._src===t._src){a=!1;break}return o&&a&&delete o[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,i,n){var o=this,r=o["_on"+t];return"function"==typeof e&&r.push(n?{id:i,fn:e,once:n}:{id:i,fn:e}),o},off:function(t,e,i){var n=this,o=n["_on"+t],r=0;if("number"==typeof e&&(i=e,e=null),e||i)for(r=0;r<o.length;r++){var a=i===o[r].id;if(e===o[r].fn&&a||!e&&a){o.splice(r,1);break}}else if(t)n["_on"+t]=[];else{var s=Object.keys(n);for(r=0;r<s.length;r++)0===s[r].indexOf("_on")&&Array.isArray(n[s[r]])&&(n[s[r]]=[])}return n},once:function(t,e,i){var n=this;return n.on(t,e,i,1),n},_emit:function(t,e,i){for(var n=this,o=n["_on"+t],r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,i)}.bind(n,o[r].fn),0),o[r].once&&n.off(t,o[r].fn,o[r].id));return n._loadQueue(t),n},_loadQueue:function(t){var e=this;if(e._queue.length>0){var i=e._queue[0];i.event===t&&(e._queue.shift(),e._loadQueue()),t||i.action()}return e},_ended:function(t){var i=this,n=t._sprite;if(!i._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(i._ended.bind(i,t),100),i;var o=!(!t._loop&&!i._sprite[n][2]);if(i._emit("end",t._id),!i._webAudio&&o&&i.stop(t._id,!0).play(t._id),i._webAudio&&o){i._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);i._endTimers[t._id]=setTimeout(i._ended.bind(i,t),r)}return i._webAudio&&!o&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,i._clearTimer(t._id),i._cleanBuffer(t._node),e._autoSuspend()),i._webAudio||o||i.stop(t._id,!0),i},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var i=e._soundById(t);i&&i._node&&i._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,i=0;i<e._sounds.length;i++)if(t===e._sounds[i]._id)return e._sounds[i];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new n(t)},_drain:function(){var t=this,e=t._pool,i=0,n=0;if(!(t._sounds.length<e)){for(n=0;n<t._sounds.length;n++)t._sounds[n]._ended&&i++;for(n=t._sounds.length-1;n>=0;n--){if(i<=e)return;t._sounds[n]._ended&&(t._webAudio&&t._sounds[n]._node&&t._sounds[n]._node.disconnect(0),t._sounds.splice(n,1),i--)}}},_getSoundIds:function(t){var e=this;if(void 0===t){for(var i=[],n=0;n<e._sounds.length;n++)i.push(e._sounds[n]._id);return i}return[t]},_refreshBuffer:function(t){var i=this;return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=o[i._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),i},_cleanBuffer:function(t){var i=this;if(e._scratchBuffer&&t.bufferSource){t.bufferSource.onended=null,t.bufferSource.disconnect(0);try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}}return t.bufferSource=null,i}};var n=function(t){this._parent=t,this.init()};n.prototype={init:function(){var t=this,i=t._parent;return t._muted=i._muted,t._loop=i._loop,t._volume=i._volume,t._rate=i._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,i._sounds.push(t),t.create(),t},create:function(){var t=this,i=t._parent,n=e._muted||t._muted||t._parent._muted?0:t._volume;return i._webAudio?(t._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(n,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):(t._node=new Audio,t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._node.src=i._src,t._node.preload="auto",t._node.volume=n*e.volume(),t._node.load()),t},reset:function(){var t=this,i=t._parent;return t._muted=i._muted,t._loop=i._loop,t._volume=i._volume,t._rate=i._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,i=t._parent;i._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(i._sprite).length&&(i._sprite={__default:[0,1e3*i._duration]}),"loaded"!==i._state&&(i._state="loaded",i._emit("load"),i._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)}};var o={},r=function(t){var e=t._src;if(o[e])return t._duration=o[e].duration,void l(t);if(/^data:[^;]+;base64,/.test(e)){for(var i=atob(e.split(",")[1]),n=new Uint8Array(i.length),r=0;r<i.length;++r)n[r]=i.charCodeAt(r);s(n.buffer,t)}else{var c=new XMLHttpRequest;c.open("GET",e,!0),c.withCredentials=t._xhrWithCredentials,c.responseType="arraybuffer",c.onload=function(){var e=(c.status+"")[0];"0"===e||"2"===e||"3"===e?s(c.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+c.status+".")},c.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete o[e],t.load())},a(c)}},a=function(t){try{t.send()}catch(e){t.onerror()}},s=function(t,i){var n=function(t){t&&i._sounds.length>0?(o[i._src]=t,l(i,t)):onError()},r=function(){i._emit("loaderror",null,"Decoding audio data failed.")};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(n).catch(r):e.ctx.decodeAudioData(t,n,r)},l=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},c=function(){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(t){e.usingWebAudio=!1}var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),i=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=i?parseInt(i[1],10):null;if(t&&n&&n<9){var o=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());(e._navigator&&e._navigator.standalone&&!o||e._navigator&&!e._navigator.standalone&&!o)&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:1,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:e,Howl:i}}),"undefined"!=typeof exports&&(exports.Howler=e,exports.Howl=i),"undefined"!=typeof window?(window.HowlerGlobal=t,window.Howler=e,window.Howl=i,window.Sound=n):"undefined"!=typeof global&&(global.HowlerGlobal=t,global.Howler=e,global.Howl=i,global.Sound=n)}(),function(t,e){"use strict";function i(i,n){function o(t){return gt.preferFlash&&lt&&!gt.ignoreFlash&&gt.flash[t]!==e&&gt.flash[t]}function r(t){return function(e){var i,n=this._s;return n&&n._a?i=t.call(this,e):(n&&n.id?gt._wD(n.id+": Ignoring "+e.type):gt._wD(xt+"Ignoring "+e.type),i=null),i}}this.setupOptions={url:i||null,flashVersion:8,debugMode:!1,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,forceUseGlobalHTML5Audio:!1,ignoreMobileRestrictions:!1,html5Test:/^(probably|maybe)$/i,preferFlash:!1,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=n||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20150601",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null},this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var a,s,l,c,h,p,u,d,f,m,g,y,v,b,w,x,_,S,T,P,C,I,k,A,M,O,R,B,G,E,D,L,j,F,N,X,U,V,H,q,z,W,Y,K,Q,Z,J,$,tt,et,it,nt,ot,rt,at,st,lt,ct,ht,pt,ut,dt,ft,mt,gt=this,yt=null,vt=null,bt="soundManager",wt=bt+": ",xt="HTML5::",_t=navigator.userAgent,St=t.location.href.toString(),Tt=document,Pt=[],Ct=!0,It=!1,kt=!1,At=!1,Mt=!1,Ot=!1,Rt=0,Bt=["log","info","warn","error"],Gt=null,Et=null,Dt=!1,Lt=!1,jt=0,Ft=null,Nt=[],Xt=null,Ut=Array.prototype.slice,Vt=!1,Ht=0,qt=_t.match(/(ipad|iphone|ipod)/i),zt=_t.match(/android/i),Wt=_t.match(/msie/i),Yt=_t.match(/webkit/i),Kt=_t.match(/safari/i)&&!_t.match(/chrome/i),Qt=_t.match(/opera/i),Zt=_t.match(/(mobile|pre\/|xoom)/i)||qt||zt,Jt=!St.match(/usehtml5audio/i)&&!St.match(/sm2\-ignorebadua/i)&&Kt&&!_t.match(/silk/i)&&_t.match(/OS X 10_6_([3-7])/i),$t=t.console!==e&&console.log!==e,te=Tt.hasFocus!==e?Tt.hasFocus():null,ee=Kt&&(Tt.hasFocus===e||!Tt.hasFocus()),ie=!ee,ne=/(mp3|mp4|mpa|m4a|m4b)/i,oe=Tt.location?Tt.location.protocol.match(/http/i):null,re=oe?"":"http://",ae=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,se=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],le=new RegExp("\\.("+se.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!oe,U={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},this.hasHTML5=function(){try{return Audio!==e&&(Qt&&opera!==e&&opera.version()<10?new Audio(null):new Audio).canPlayType!==e}catch(t){return!1}}(),this.setup=function(t){var i=!gt.url;return t!==e&&At&&Xt&&gt.ok()&&(t.flashVersion!==e||t.url!==e||t.html5Test!==e)&&z(F("setupLate")),g(t),Vt||(Zt?gt.setupOptions.ignoreMobileRestrictions&&!gt.setupOptions.forceUseGlobalHTML5Audio||(Nt.push(C.globalHTML5),Vt=!0):gt.setupOptions.forceUseGlobalHTML5Audio&&(Nt.push(C.globalHTML5),Vt=!0)),!mt&&Zt&&(gt.setupOptions.ignoreMobileRestrictions?Nt.push(C.ignoreMobile):(gt.setupOptions.useHTML5Audio&&!gt.setupOptions.preferFlash||gt._wD(C.mobileUA),gt.setupOptions.useHTML5Audio=!0,gt.setupOptions.preferFlash=!1,qt?gt.ignoreFlash=!0:(zt&&!_t.match(/android\s2\.3/i)||!zt)&&(gt._wD(C.globalHTML5),Vt=!0))),t&&(i&&M&&t.url!==e&&gt.beginDelayedInit(),M||t.url===e||"complete"!==Tt.readyState||setTimeout(k,1)),mt=!0,gt},this.ok=function(){return Xt?At&&!Mt:gt.useHTML5Audio&&gt.hasHTML5},this.supported=this.ok,this.getMovie=function(e){return s(e)||Tt[e]||t[e]},this.createSound=function(t,i){function n(){return s=H(s),gt.sounds[s.id]=new a(s),gt.soundIDs.push(s.id),gt.sounds[s.id]}var o,r,s,l=null;if(o=bt+".createSound(): ",r=o+F(At?"notOK":"notReady"),!At||!gt.ok())return z(r),!1;if(i!==e&&(t={id:t,url:i}),s=m(t),s.url=Z(s.url),s.id===e&&(s.id=gt.setupOptions.idPrefix+Ht++),s.id.toString().charAt(0).match(/^[0-9]$/)&&gt._wD(o+F("badID",s.id),2),gt._wD(o+s.id+(s.url?" ("+s.url+")":""),1),W(s.id,!0))return gt._wD(o+s.id+" exists",1),gt.sounds[s.id];if(tt(s))l=n(),gt.html5Only||gt._wD(s.id+": Using HTML5"),l._setup_html5(s);else{if(gt.html5Only)return gt._wD(s.id+": No HTML5 support for this sound, and no Flash. Exiting."),n();if(gt.html5.usingFlash&&s.url&&s.url.match(/data\:/i))return gt._wD(s.id+": data: URIs not supported via Flash. Exiting."),n();p>8&&(null===s.isMovieStar&&(s.isMovieStar=!!(s.serverURL||s.type&&s.type.match(ae)||s.url&&s.url.match(le))),s.isMovieStar&&(gt._wD(o+"using MovieStar handling"),s.loops>1&&d("noNSLoop"))),s=q(s,o),l=n(),8===p?vt._createSound(s.id,s.loops||1,s.usePolicyFile):(vt._createSound(s.id,s.url,s.usePeakData,s.useWaveformData,s.useEQData,s.isMovieStar,!!s.isMovieStar&&s.bufferTime,s.loops||1,s.serverURL,s.duration||null,s.autoPlay,!0,s.autoLoad,s.usePolicyFile),s.serverURL||(l.connected=!0,s.onconnect&&s.onconnect.apply(l))),s.serverURL||!s.autoLoad&&!s.autoPlay||l.load(s)}return!s.serverURL&&s.autoPlay&&l.play(),l},this.destroySound=function(t,e){if(!W(t))return!1;var i,n=gt.sounds[t];for(n.stop(),n._iO={},n.unload(),i=0;i<gt.soundIDs.length;i++)if(gt.soundIDs[i]===t){gt.soundIDs.splice(i,1);break}return e||n.destruct(!0),n=null,delete gt.sounds[t],!0},this.load=function(t,e){return!!W(t)&&gt.sounds[t].load(e)},this.unload=function(t){return!!W(t)&&gt.sounds[t].unload()},this.onPosition=function(t,e,i,n){return!!W(t)&&gt.sounds[t].onposition(e,i,n)},this.onposition=this.onPosition,this.clearOnPosition=function(t,e,i){return!!W(t)&&gt.sounds[t].clearOnPosition(e,i)},this.play=function(t,e){var i=null,n=e&&!(e instanceof Object);if(!At||!gt.ok())return z(bt+".play(): "+F(At?"notOK":"notReady")),!1;if(W(t,n))n&&(e={url:e});else{if(!n)return!1;n&&(e={url:e}),e&&e.url&&(gt._wD(bt+'.play(): Attempting to create "'+t+'"',1),e.id=t,i=gt.createSound(e).play())}return null===i&&(i=gt.sounds[t].play(e)),i},this.start=this.play,this.setPosition=function(t,e){return!!W(t)&&gt.sounds[t].setPosition(e)},this.stop=function(t){return!!W(t)&&(gt._wD(bt+".stop("+t+")",1),gt.sounds[t].stop())},this.stopAll=function(){var t;gt._wD(bt+".stopAll()",1);for(t in gt.sounds)gt.sounds.hasOwnProperty(t)&&gt.sounds[t].stop()},this.pause=function(t){return!!W(t)&&gt.sounds[t].pause()},this.pauseAll=function(){var t;for(t=gt.soundIDs.length-1;t>=0;t--)gt.sounds[gt.soundIDs[t]].pause()},this.resume=function(t){return!!W(t)&&gt.sounds[t].resume()},this.resumeAll=function(){var t;for(t=gt.soundIDs.length-1;t>=0;t--)gt.sounds[gt.soundIDs[t]].resume()},this.togglePause=function(t){return!!W(t)&&gt.sounds[t].togglePause()},this.setPan=function(t,e){return!!W(t)&&gt.sounds[t].setPan(e)},this.setVolume=function(t,i){var n,o;{if(t===e||isNaN(t)||i!==e)return!!W(t)&&gt.sounds[t].setVolume(i);for(n=0,o=gt.soundIDs.length;n<o;n++)gt.sounds[gt.soundIDs[n]].setVolume(t)}},this.mute=function(t){var e=0;if(t instanceof String&&(t=null),t)return!!W(t)&&(gt._wD(bt+'.mute(): Muting "'+t+'"'),gt.sounds[t].mute());for(gt._wD(bt+".mute(): Muting all sounds"),e=gt.soundIDs.length-1;e>=0;e--)gt.sounds[gt.soundIDs[e]].mute();return gt.muted=!0,!0},this.muteAll=function(){gt.mute()},this.unmute=function(t){var e;if(t instanceof String&&(t=null),t)return!!W(t)&&(gt._wD(bt+'.unmute(): Unmuting "'+t+'"'),gt.sounds[t].unmute());for(gt._wD(bt+".unmute(): Unmuting all sounds"),e=gt.soundIDs.length-1;e>=0;e--)gt.sounds[gt.soundIDs[e]].unmute();return gt.muted=!1,!0},this.unmuteAll=function(){gt.unmute()},this.toggleMute=function(t){return!!W(t)&&gt.sounds[t].toggleMute()},this.getMemoryUse=function(){var t=0;return vt&&8!==p&&(t=parseInt(vt._getMemoryUse(),10)),t},this.disable=function(i){var n;if(i===e&&(i=!1),Mt)return!1;for(Mt=!0,d("shutdown",1),n=gt.soundIDs.length-1;n>=0;n--)D(gt.sounds[gt.soundIDs[n]]);return f(i),at.remove(t,"load",w),!0},this.canPlayMIME=function(t){var e;return gt.hasHTML5&&(e=et({type:t})),!e&&Xt&&(e=t&&gt.ok()?!!((p>8?t.match(ae):null)||t.match(gt.mimePattern)):null),e},this.canPlayURL=function(t){var e;return gt.hasHTML5&&(e=et({url:t})),!e&&Xt&&(e=t&&gt.ok()?!!t.match(gt.filePattern):null),e},this.canPlayLink=function(t){return!(t.type===e||!t.type||!gt.canPlayMIME(t.type))||gt.canPlayURL(t.href)},this.getSoundById=function(t,e){if(!t)return null;var i=gt.sounds[t];return i||e||gt._wD(bt+'.getSoundById(): Sound "'+t+'" not found.',2),i},this.onready=function(e,i){if("function"!=typeof e)throw F("needFunction","onready");return At&&gt._wD(F("queue","onready")),i||(i=t),v("onready",e,i),b(),!0},this.ontimeout=function(e,i){var n="ontimeout";if("function"!=typeof e)throw F("needFunction",n);return At&&gt._wD(F("queue",n)),i||(i=t),v(n,e,i),b({type:n}),!0},this._writeDebug=function(t,i){var n,o;return!!gt.setupOptions.debugMode&&(!!($t&&gt.useConsole&&(i&&"object"==typeof i?console.log(t,i):Bt[i]!==e?console[Bt[i]](t):console.log(t),gt.consoleOnly))||!!(n=s("soundmanager-debug"))&&(o=Tt.createElement("div"),++Rt%2==0&&(o.className="sm2-alt"),i=i===e?0:parseInt(i,10),o.appendChild(Tt.createTextNode(t)),i&&(i>=2&&(o.style.fontWeight="bold"),3===i&&(o.style.color="#ff3333")),n.insertBefore(o,n.firstChild),n=null,!0))},-1!==St.indexOf("sm2-debug=alert")&&(this._writeDebug=function(e){t.alert(e)}),this._wD=this._writeDebug,this._debug=function(){var t,e;for(d("currentObj",1),t=0,e=gt.soundIDs.length;t<e;t++)gt.sounds[gt.soundIDs[t]]._debug()},this.reboot=function(e,i){gt.soundIDs.length&&gt._wD("Destroying "+gt.soundIDs.length+" SMSound object"+(1!==gt.soundIDs.length?"s":"")+"...");var n,o,r;for(n=gt.soundIDs.length-1;n>=0;n--)gt.sounds[gt.soundIDs[n]].destruct();if(vt)try{Wt&&(Et=vt.innerHTML),Gt=vt.parentNode.removeChild(vt)}catch(t){d("badRemove",2)}if(Et=Gt=Xt=vt=null,gt.enabled=M=At=Dt=Lt=It=kt=Mt=Vt=gt.swfLoaded=!1,gt.soundIDs=[],gt.sounds={},Ht=0,mt=!1,e)Pt=[];else for(n in Pt)if(Pt.hasOwnProperty(n))for(o=0,r=Pt[n].length;o<r;o++)Pt[n][o].fired=!1;return i||gt._wD(bt+": Rebooting..."),gt.html5={usingFlash:null},gt.flash={},gt.html5Only=!1,gt.ignoreFlash=!1,t.setTimeout(function(){i||gt.beginDelayedInit()},20),gt},this.reset=function(){return d("reset"),gt.reboot(!0,!0)},this.getMoviePercent=function(){return vt&&"PercentLoaded"in vt?vt.PercentLoaded():null},this.beginDelayedInit=function(){Ot=!0,k(),setTimeout(function(){return!Lt&&(R(),I(),Lt=!0,!0)},20),x()},this.destruct=function(){gt._wD(bt+".destruct()"),gt.disable(!0)},a=function(t){var i,n,o,r,a,s,l,c,h,f,g=this,y=!1,v=[],b=0,w=null;h={duration:null,time:null},this.id=t.id,this.sID=this.id,this.url=t.url,this.options=m(t),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,f=!this.url,this.id3={},this._debug=function(){gt._wD(g.id+": Merged options:",g.options)},this.load=function(t){var i;if(t!==e?g._iO=m(t,g.options):(t=g.options,g._iO=t,w&&w!==g.url&&(d("manURL"),g._iO.url=g.url,g.url=null)),g._iO.url||(g._iO.url=g.url),g._iO.url=Z(g._iO.url),g.instanceOptions=g._iO,i=g._iO,gt._wD(g.id+": load ("+i.url+")"),!i.url&&!g.url)return gt._wD(g.id+": load(): url is unassigned. Exiting.",2),g;if(g.isHTML5||8!==p||g.url||i.autoPlay||gt._wD(g.id+": Flash 8 load() limitation: Wait for onload() before calling play().",1),i.url===g.url&&0!==g.readyState&&2!==g.readyState)return d("onURL",1),3===g.readyState&&i.onload&&ft(g,function(){i.onload.apply(g,[!!g.duration])}),g;if(g.loaded=!1,g.readyState=1,g.playState=0,g.id3={},tt(i))g._setup_html5(i)._called_load?gt._wD(g.id+": Ignoring request to load again"):(g._html5_canplay=!1,g.url!==i.url&&(gt._wD(d("manURL")+": "+i.url),g._a.src=i.url,g.setPosition(0)),g._a.autobuffer="auto",g._a.preload="auto",g._a._called_load=!0);else{if(gt.html5Only)return gt._wD(g.id+": No flash support. Exiting."),g;if(g._iO.url&&g._iO.url.match(/data\:/i))return gt._wD(g.id+": data: URIs not supported via Flash. Exiting."),g;try{g.isHTML5=!1,g._iO=q(H(i)),g._iO.autoPlay&&(g._iO.position||g._iO.from)&&(gt._wD(g.id+": Disabling autoPlay because of non-zero offset case"),g._iO.autoPlay=!1),i=g._iO,8===p?vt._load(g.id,i.url,i.stream,i.autoPlay,i.usePolicyFile):vt._load(g.id,i.url,!!i.stream,!!i.autoPlay,i.loops||1,!!i.autoLoad,i.usePolicyFile)}catch(t){d("smError",2),u("onload",!1),B({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return g.url=i.url,g},this.unload=function(){return 0!==g.readyState&&(gt._wD(g.id+": unload()"),g.isHTML5?(r(),g._a&&(g._a.pause(),w=nt(g._a))):8===p?vt._unload(g.id,"about:blank"):vt._unload(g.id),i()),g},this.destruct=function(t){gt._wD(g.id+": Destruct"),g.isHTML5?(r(),g._a&&(g._a.pause(),nt(g._a),Vt||o(),g._a._s=null,g._a=null)):(g._iO.onfailure=null,vt._destroySound(g.id)),t||gt.destroySound(g.id,!0)},this.play=function(t,i){var n,o,r,l,h,u,d=!0,v=null;if(n=g.id+": play(): ",i=i===e||i,t||(t={}),g.url&&(g._iO.url=g.url),g._iO=m(g._iO,g.options),g._iO=m(t,g._iO),g._iO.url=Z(g._iO.url),g.instanceOptions=g._iO,!g.isHTML5&&g._iO.serverURL&&!g.connected)return g.getAutoPlay()||(gt._wD(n+" Netstream not connected yet - setting autoPlay"),g.setAutoPlay(!0)),g;if(tt(g._iO)&&(g._setup_html5(g._iO),a()),1!==g.playState||g.paused||(g._iO.multiShot?gt._wD(n+"Already playing (multi-shot)",1):(gt._wD(n+"Already playing (one-shot)",1),g.isHTML5&&g.setPosition(g._iO.position),v=g)),null!==v)return v;if(t.url&&t.url!==g.url&&(g.readyState||g.isHTML5||8!==p||!f?g.load(g._iO):f=!1),g.loaded?gt._wD(n.substr(0,n.lastIndexOf(":"))):0===g.readyState?(gt._wD(n+"Attempting to load"),g.isHTML5||gt.html5Only?g.isHTML5?g.load(g._iO):(gt._wD(n+"Unsupported type. Exiting."),v=g):(g._iO.autoPlay=!0,g.load(g._iO)),g.instanceOptions=g._iO):2===g.readyState?(gt._wD(n+"Could not load - exiting",2),v=g):gt._wD(n+"Loading - attempting to play..."),null!==v)return v;if(!g.isHTML5&&9===p&&g.position>0&&g.position===g.duration&&(gt._wD(n+"Sound at end, resetting to position: 0"),t.position=0),g.paused&&g.position>=0&&(!g._iO.serverURL||g.position>0))gt._wD(n+"Resuming from paused state",1),g.resume();else{if(g._iO=m(t,g._iO),(!g.isHTML5&&null!==g._iO.position&&g._iO.position>0||null!==g._iO.from&&g._iO.from>0||null!==g._iO.to)&&0===g.instanceCount&&0===g.playState&&!g._iO.serverURL){if(r=function(){g._iO=m(t,g._iO),g.play(g._iO)},g.isHTML5&&!g._html5_canplay?(gt._wD(n+"Beginning load for non-zero offset case"),g.load({_oncanplay:r}),v=!1):g.isHTML5||g.loaded||g.readyState&&2===g.readyState||(gt._wD(n+"Preloading for non-zero offset case"),g.load({onload:r}),v=!1),null!==v)return v;g._iO=c()}(!g.instanceCount||g._iO.multiShotEvents||g.isHTML5&&g._iO.multiShot&&!Vt||!g.isHTML5&&p>8&&!g.getAutoPlay())&&g.instanceCount++,g._iO.onposition&&0===g.playState&&s(g),g.playState=1,g.paused=!1,g.position=g._iO.position===e||isNaN(g._iO.position)?0:g._iO.position,g.isHTML5||(g._iO=q(H(g._iO))),g._iO.onplay&&i&&(g._iO.onplay.apply(g),y=!0),g.setVolume(g._iO.volume,!0),g.setPan(g._iO.pan,!0),g.isHTML5?g.instanceCount<2?(a(),o=g._setup_html5(),g.setPosition(g._iO.position),o.play()):(gt._wD(g.id+": Cloning Audio() for instance #"+g.instanceCount+"..."),l=new Audio(g._iO.url),h=function(){at.remove(l,"ended",h),g._onfinish(g),nt(l),l=null},u=function(){at.remove(l,"canplay",u);try{l.currentTime=g._iO.position/1e3}catch(t){z(g.id+": multiShot play() failed to apply position of "+g._iO.position/1e3)}l.play()},at.add(l,"ended",h),g._iO.volume!==e&&(l.volume=Math.max(0,Math.min(1,g._iO.volume/100))),g.muted&&(l.muted=!0),g._iO.position?at.add(l,"canplay",u):l.play()):(d=vt._start(g.id,g._iO.loops||1,9===p?g.position:g.position/1e3,g._iO.multiShot||!1),9!==p||d||(gt._wD(n+"No sound hardware, or 32-sound ceiling hit",2),g._iO.onplayerror&&g._iO.onplayerror.apply(g)))}return g},this.start=this.play,this.stop=function(t){var e,i=g._iO;return 1===g.playState&&(gt._wD(g.id+": stop()"),g._onbufferchange(0),g._resetOnPosition(0),g.paused=!1,g.isHTML5||(g.playState=0),l(),i.to&&g.clearOnPosition(i.to),g.isHTML5?g._a&&(e=g.position,g.setPosition(0),g.position=e,g._a.pause(),g.playState=0,g._onTimer(),r()):(vt._stop(g.id,t),i.serverURL&&g.unload()),g.instanceCount=0,g._iO={},i.onstop&&i.onstop.apply(g)),g},this.setAutoPlay=function(t){gt._wD(g.id+": Autoplay turned "+(t?"on":"off")),g._iO.autoPlay=t,g.isHTML5||(vt._setAutoPlay(g.id,t),t&&(g.instanceCount||1!==g.readyState||(g.instanceCount++,gt._wD(g.id+": Incremented instance count to "+g.instanceCount))))},this.getAutoPlay=function(){return g._iO.autoPlay},this.setPosition=function(t){t===e&&(t=0);var i,n,o=g.isHTML5?Math.max(t,0):Math.min(g.duration||g._iO.duration,Math.max(t,0));if(g.position=o,n=g.position/1e3,g._resetOnPosition(g.position),g._iO.position=o,g.isHTML5){if(g._a){if(g._html5_canplay){if(g._a.currentTime!==n){gt._wD(g.id+": setPosition("+n+")");try{g._a.currentTime=n,(0===g.playState||g.paused)&&g._a.pause()}catch(t){gt._wD(g.id+": setPosition("+n+") failed: "+t.message,2)}}}else if(n)return gt._wD(g.id+": setPosition("+n+"): Cannot seek yet, sound not ready",2),g;g.paused&&g._onTimer(!0)}}else i=9===p?g.position:n,g.readyState&&2!==g.readyState&&vt._setPosition(g.id,i,g.paused||!g.playState,g._iO.multiShot);return g},this.pause=function(t){return g.paused||0===g.playState&&1!==g.readyState?g:(gt._wD(g.id+": pause()"),g.paused=!0,g.isHTML5?(g._setup_html5().pause(),r()):(t||t===e)&&vt._pause(g.id,g._iO.multiShot),g._iO.onpause&&g._iO.onpause.apply(g),g)},this.resume=function(){var t=g._iO;return g.paused?(gt._wD(g.id+": resume()"),g.paused=!1,g.playState=1,g.isHTML5?(g._setup_html5().play(),a()):(t.isMovieStar&&!t.serverURL&&g.setPosition(g.position),vt._pause(g.id,t.multiShot)),!y&&t.onplay?(t.onplay.apply(g),y=!0):t.onresume&&t.onresume.apply(g),g):g},this.togglePause=function(){return gt._wD(g.id+": togglePause()"),0===g.playState?(g.play({position:9!==p||g.isHTML5?g.position/1e3:g.position}),g):(g.paused?g.resume():g.pause(),g)},this.setPan=function(t,i){return t===e&&(t=0),i===e&&(i=!1),g.isHTML5||vt._setPan(g.id,t),g._iO.pan=t,i||(g.pan=t,g.options.pan=t),g},this.setVolume=function(t,i){return t===e&&(t=100),i===e&&(i=!1),g.isHTML5?g._a&&(gt.muted&&!g.muted&&(g.muted=!0,g._a.muted=!0),g._a.volume=Math.max(0,Math.min(1,t/100))):vt._setVolume(g.id,gt.muted&&!g.muted||g.muted?0:t),g._iO.volume=t,i||(g.volume=t,g.options.volume=t),g},this.mute=function(){return g.muted=!0,g.isHTML5?g._a&&(g._a.muted=!0):vt._setVolume(g.id,0),g},this.unmute=function(){g.muted=!1;var t=g._iO.volume!==e;return g.isHTML5?g._a&&(g._a.muted=!1):vt._setVolume(g.id,t?g._iO.volume:g.options.volume),g},this.toggleMute=function(){return g.muted?g.unmute():g.mute()},this.onPosition=function(t,i,n){return v.push({position:parseInt(t,10),method:i,scope:n!==e?n:g,fired:!1}),g},this.onposition=this.onPosition,this.clearOnPosition=function(t,e){var i;if(t=parseInt(t,10),isNaN(t))return!1;for(i=0;i<v.length;i++)t===v[i].position&&(e&&e!==v[i].method||(v[i].fired&&b--,v.splice(i,1)))},this._processOnPosition=function(){var t,e,i=v.length;if(!i||!g.playState||b>=i)return!1;for(t=i-1;t>=0;t--)!(e=v[t]).fired&&g.position>=e.position&&(e.fired=!0,b++,e.method.apply(e.scope,[e.position]),i=v.length);return!0},this._resetOnPosition=function(t){var e,i,n=v.length;if(!n)return!1;for(e=n-1;e>=0;e--)(i=v[e]).fired&&t<=i.position&&(i.fired=!1,b--);return!0},c=function(){var t,e,i=g._iO,n=i.from,o=i.to;return e=function(){gt._wD(g.id+': "To" time of '+o+" reached."),g.clearOnPosition(o,e),g.stop()},t=function(){gt._wD(g.id+': Playing "from" '+n),null===o||isNaN(o)||g.onPosition(o,e)},null===n||isNaN(n)||(i.position=n,i.multiShot=!1,t()),i},s=function(){var t,e=g._iO.onposition;if(e)for(t in e)e.hasOwnProperty(t)&&g.onPosition(parseInt(t,10),e[t])},l=function(){var t,e=g._iO.onposition;if(e)for(t in e)e.hasOwnProperty(t)&&g.clearOnPosition(parseInt(t,10))},a=function(){g.isHTML5&&Y(g)},r=function(){g.isHTML5&&K(g)},(i=function(t){t||(v=[],b=0),y=!1,g._hasTimer=null,g._a=null,g._html5_canplay=!1,g.bytesLoaded=null,g.bytesTotal=null,g.duration=g._iO&&g._iO.duration?g._iO.duration:null,g.durationEstimate=null,g.buffered=[],g.eqData=[],g.eqData.left=[],g.eqData.right=[],g.failures=0,g.isBuffering=!1,g.instanceOptions={},g.instanceCount=0,g.loaded=!1,g.metadata={},g.readyState=0,g.muted=!1,g.paused=!1,g.peakData={left:0,right:0},g.waveformData={left:[],right:[]},g.playState=0,g.position=null,g.id3={}})(),this._onTimer=function(t){var e,i,n=!1,o={};if(g._hasTimer||t)return g._a&&(t||(g.playState>0||1===g.readyState)&&!g.paused)&&((e=g._get_html5_duration())!==h.duration&&(h.duration=e,g.duration=e,n=!0),g.durationEstimate=g.duration,(i=1e3*g._a.currentTime||0)!==h.time&&(h.time=i,n=!0),(n||t)&&g._whileplaying(i,o,o,o,o)),n},this._get_html5_duration=function(){var t=g._iO,e=g._a&&g._a.duration?1e3*g._a.duration:t&&t.duration?t.duration:null;return e&&!isNaN(e)&&e!==1/0?e:null},this._apply_loop=function(t,e){!t.loop&&e>1&&gt._wD("Note: Native HTML5 looping is infinite.",1),t.loop=e>1?"loop":""},this._setup_html5=function(t){var e,o=m(g._iO,t),r=Vt?yt:g._a,a=decodeURI(o.url);if(Vt?a===decodeURI(st)&&(e=!0):a===decodeURI(w)&&(e=!0),r){if(r._s)if(Vt)r._s&&r._s.playState&&!e&&r._s.stop();else if(!Vt&&a===decodeURI(w))return g._apply_loop(r,o.loops),r;e||(w&&i(!1),r.src=o.url,g.url=o.url,w=o.url,st=o.url,r._called_load=!1)}else o.autoLoad||o.autoPlay?(g._a=new Audio(o.url),g._a.load()):g._a=Qt&&opera.version()<10?new Audio(null):new Audio,(r=g._a)._called_load=!1,Vt&&(yt=r);return g.isHTML5=!0,g._a=r,r._s=g,n(),g._apply_loop(r,o.loops),o.autoLoad||o.autoPlay?g.load():(r.autobuffer=!1,r.preload="auto"),r},n=function(){if(g._a._added_events)return!1;var t;g._a._added_events=!0;for(t in pt)pt.hasOwnProperty(t)&&function(t,e,i){g._a&&g._a.addEventListener(t,e,i||!1)}(t,pt[t]);return!0},o=function(){var t;gt._wD(g.id+": Removing event listeners"),g._a._added_events=!1;for(t in pt)pt.hasOwnProperty(t)&&function(t,e,i){g._a&&g._a.removeEventListener(t,e,i||!1)}(t,pt[t])},this._onload=function(t){var e,i=!!t||!g.isHTML5&&8===p&&g.duration;return e=g.id+": ",gt._wD(e+(i?"onload()":"Failed to load / invalid sound?"+(g.duration?" -":" Zero-length duration reported.")+" ("+g.url+")"),i?1:2),i||g.isHTML5||(!0===gt.sandbox.noRemote&&gt._wD(e+F("noNet"),1),!0===gt.sandbox.noLocal&&gt._wD(e+F("noLocal"),1)),g.loaded=i,g.readyState=i?3:2,g._onbufferchange(0),g._iO.onload&&ft(g,function(){g._iO.onload.apply(g,[i])}),!0},this._onbufferchange=function(t){return 0!==g.playState&&(!(t&&g.isBuffering||!t&&!g.isBuffering)&&(g.isBuffering=1===t,g._iO.onbufferchange&&(gt._wD(g.id+": Buffer state change: "+t),g._iO.onbufferchange.apply(g,[t])),!0))},this._onsuspend=function(){return g._iO.onsuspend&&(gt._wD(g.id+": Playback suspended"),g._iO.onsuspend.apply(g)),!0},this._onfailure=function(t,e,i){g.failures++,gt._wD(g.id+": Failure ("+g.failures+"): "+t),g._iO.onfailure&&1===g.failures?g._iO.onfailure(t,e,i):gt._wD(g.id+": Ignoring failure")},this._onwarning=function(t,e,i){g._iO.onwarning&&g._iO.onwarning(t,e,i)},this._onfinish=function(){var t=g._iO.onfinish;g._onbufferchange(0),g._resetOnPosition(0),g.instanceCount&&(g.instanceCount--,g.instanceCount||(l(),g.playState=0,g.paused=!1,g.instanceCount=0,g.instanceOptions={},g._iO={},r(),g.isHTML5&&(g.position=0)),g.instanceCount&&!g._iO.multiShotEvents||t&&(gt._wD(g.id+": onfinish()"),ft(g,function(){t.apply(g)})))},this._whileloading=function(t,e,i,n){var o=g._iO;g.bytesLoaded=t,g.bytesTotal=e,g.duration=Math.floor(i),g.bufferLength=n,g.isHTML5||o.isMovieStar?g.durationEstimate=g.duration:o.duration?g.durationEstimate=g.duration>o.duration?g.duration:o.duration:g.durationEstimate=parseInt(g.bytesTotal/g.bytesLoaded*g.duration,10),g.isHTML5||(g.buffered=[{start:0,end:g.duration}]),(3!==g.readyState||g.isHTML5)&&o.whileloading&&o.whileloading.apply(g)},this._whileplaying=function(t,i,n,o,r){var a,s=g._iO;return!isNaN(t)&&null!==t&&(g.position=Math.max(0,t),g._processOnPosition(),!g.isHTML5&&p>8&&(s.usePeakData&&i!==e&&i&&(g.peakData={left:i.leftPeak,right:i.rightPeak}),s.useWaveformData&&n!==e&&n&&(g.waveformData={left:n.split(","),right:o.split(",")}),s.useEQData&&r!==e&&r&&r.leftEQ&&(a=r.leftEQ.split(","),g.eqData=a,g.eqData.left=a,r.rightEQ!==e&&r.rightEQ&&(g.eqData.right=r.rightEQ.split(",")))),1===g.playState&&(g.isHTML5||8!==p||g.position||!g.isBuffering||g._onbufferchange(0),s.whileplaying&&s.whileplaying.apply(g)),!0)},this._oncaptiondata=function(t){gt._wD(g.id+": Caption data received."),g.captiondata=t,g._iO.oncaptiondata&&g._iO.oncaptiondata.apply(g,[t])},this._onmetadata=function(t,e){gt._wD(g.id+": Metadata received.");var i,n,o={};for(i=0,n=t.length;i<n;i++)o[t[i]]=e[i];g.metadata=o,g._iO.onmetadata&&g._iO.onmetadata.call(g,g.metadata)},this._onid3=function(t,e){gt._wD(g.id+": ID3 data received.");var i,n,o=[];for(i=0,n=t.length;i<n;i++)o[t[i]]=e[i];g.id3=m(g.id3,o),g._iO.onid3&&g._iO.onid3.apply(g)},this._onconnect=function(t){t=1===t,gt._wD(g.id+": "+(t?"Connected.":"Failed to connect? - "+g.url),t?1:2),g.connected=t,t&&(g.failures=0,W(g.id)&&(g.getAutoPlay()?g.play(e,g.getAutoPlay()):g._iO.autoLoad&&g.load()),g._iO.onconnect&&g._iO.onconnect.apply(g,[t]))},this._ondataerror=function(t){g.playState>0&&(gt._wD(g.id+": Data error: "+t),g._iO.ondataerror&&g._iO.ondataerror.apply(g))},this._debug()},O=function(){return Tt.body||Tt.getElementsByTagName("div")[0]},s=function(t){return Tt.getElementById(t)},m=function(t,i){var n,o,r=t||{};n=i===e?gt.defaultOptions:i;for(o in n)n.hasOwnProperty(o)&&r[o]===e&&("object"!=typeof n[o]||null===n[o]?r[o]=n[o]:r[o]=m(r[o],n[o]));return r},ft=function(e,i){e.isHTML5||8!==p?i():t.setTimeout(i,0)},y={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},g=function(t,i){var n,o=!0,r=i!==e,a=gt.setupOptions,s=y;if(t===e){o=[];for(n in a)a.hasOwnProperty(n)&&o.push(n);for(n in s)s.hasOwnProperty(n)&&("object"==typeof gt[n]?o.push(n+": {...}"):gt[n]instanceof Function?o.push(n+": function() {...}"):o.push(n));return gt._wD(F("setup",o.join(", "))),!1}for(n in t)if(t.hasOwnProperty(n))if("object"!=typeof t[n]||null===t[n]||t[n]instanceof Array||t[n]instanceof RegExp)r&&s[i]!==e?gt[i][n]=t[n]:a[n]!==e?(gt.setupOptions[n]=t[n],gt[n]=t[n]):s[n]===e?(z(F(gt[n]===e?"setupUndef":"setupError",n),2),o=!1):gt[n]instanceof Function?gt[n].apply(gt,t[n]instanceof Array?t[n]:[t[n]]):gt[n]=t[n];else{if(s[n]!==e)return g(t[n],n);z(F(gt[n]===e?"setupUndef":"setupError",n),2),o=!1}return o},at=function(){function e(t){var e=Ut.call(t),i=e.length;return n?(e[1]="on"+e[1],i>3&&e.pop()):3===i&&e.push(!1),e}function i(t,e){var i=t.shift(),r=[o[e]];n?i[r](t[0],t[1]):i[r].apply(i,t)}var n=t.attachEvent,o={add:n?"attachEvent":"addEventListener",remove:n?"detachEvent":"removeEventListener"};return{add:function(){i(e(arguments),"add")},remove:function(){i(e(arguments),"remove")}}}(),pt={abort:r(function(){gt._wD(this._s.id+": abort")}),canplay:r(function(){var t,i=this._s;if(i._html5_canplay)return!0;if(i._html5_canplay=!0,gt._wD(i.id+": canplay"),i._onbufferchange(0),t=i._iO.position===e||isNaN(i._iO.position)?null:i._iO.position/1e3,this.currentTime!==t){gt._wD(i.id+": canplay: Setting position to "+t);try{this.currentTime=t}catch(e){gt._wD(i.id+": canplay: Setting position of "+t+" failed: "+e.message,2)}}i._iO._oncanplay&&i._iO._oncanplay()}),canplaythrough:r(function(){var t=this._s;t.loaded||(t._onbufferchange(0),t._whileloading(t.bytesLoaded,t.bytesTotal,t._get_html5_duration()),t._onload(!0))}),durationchange:r(function(){var t,e=this._s;t=e._get_html5_duration(),isNaN(t)||t===e.duration||(gt._wD(this._s.id+": durationchange ("+t+")"+(e.duration?", previously "+e.duration:"")),e.durationEstimate=e.duration=t)}),ended:r(function(){var t=this._s;gt._wD(t.id+": ended"),t._onfinish()}),error:r(function(){gt._wD(this._s.id+": HTML5 error, code "+this.error.code),this._s._onload(!1)}),loadeddata:r(function(){var t=this._s;gt._wD(t.id+": loadeddata"),t._loaded||Kt||(t.duration=t._get_html5_duration())}),loadedmetadata:r(function(){gt._wD(this._s.id+": loadedmetadata")}),loadstart:r(function(){gt._wD(this._s.id+": loadstart"),this._s._onbufferchange(1)}),play:r(function(){this._s._onbufferchange(0)}),playing:r(function(){gt._wD(this._s.id+": playing "+String.fromCharCode(9835)),this._s._onbufferchange(0)}),progress:r(function(t){var e,i,n,o=this._s,r=0,a="progress"===t.type,s=t.target.buffered,l=t.loaded||0,c=t.total||1;if(o.buffered=[],s&&s.length){for(e=0,i=s.length;e<i;e++)o.buffered.push({start:1e3*s.start(e),end:1e3*s.end(e)});if(r=1e3*(s.end(0)-s.start(0)),l=Math.min(1,r/(1e3*t.target.duration)),a&&s.length>1){for(n=[],i=s.length,e=0;e<i;e++)n.push(1e3*t.target.buffered.start(e)+"-"+1e3*t.target.buffered.end(e));gt._wD(this._s.id+": progress, timeRanges: "+n.join(", "))}a&&!isNaN(l)&&gt._wD(this._s.id+": progress, "+Math.floor(100*l)+"% loaded")}isNaN(l)||(o._whileloading(l,c,o._get_html5_duration()),l&&c&&l===c&&pt.canplaythrough.call(this,t))}),ratechange:r(function(){gt._wD(this._s.id+": ratechange")}),suspend:r(function(t){var e=this._s;gt._wD(this._s.id+": suspend"),pt.progress.call(this,t),e._onsuspend()}),stalled:r(function(){gt._wD(this._s.id+": stalled")}),timeupdate:r(function(){this._s._onTimer()}),waiting:r(function(){var t=this._s;gt._wD(this._s.id+": waiting"),t._onbufferchange(1)})},tt=function(t){return!(!t||!(t.type||t.url||t.serverURL))&&(!(t.serverURL||t.type&&o(t.type))&&(t.type?et({type:t.type}):et({url:t.url})||gt.html5Only||t.url.match(/data\:/i)))},nt=function(t){var i;return t&&(i=Kt?"about:blank":gt.html5.canPlayType("audio/wav")?"data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==":"about:blank",t.src=i,t._called_unload!==e&&(t._called_load=!1)),Vt&&(st=null),i},et=function(t){if(!gt.useHTML5Audio||!gt.hasHTML5)return!1;var i,n,r,a,s=t.url||null,l=t.type||null,c=gt.audioFormats;if(l&&gt.html5[l]!==e)return gt.html5[l]&&!o(l);if(!it){it=[];for(a in c)c.hasOwnProperty(a)&&(it.push(a),c[a].related&&(it=it.concat(c[a].related)));it=new RegExp("\\.("+it.join("|")+")(\\?.*)?$","i")}return(r=s?s.toLowerCase().match(it):null)&&r.length?r=r[1]:l?r=(-1!==(n=l.indexOf(";"))?l.substr(0,n):l).substr(6):i=!1,r&&gt.html5[r]!==e?i=gt.html5[r]&&!o(r):(l="audio/"+r,i=gt.html5.canPlayType({type:l}),gt.html5[r]=i,i=i&&gt.html5[l]&&!o(l)),i},rt=function(){function t(t){var e,i,n=!1,o=!1;if(!a||"function"!=typeof a.canPlayType)return n;if(t instanceof Array){for(r=0,i=t.length;r<i;r++)(gt.html5[t[r]]||a.canPlayType(t[r]).match(gt.html5Test))&&(o=!0,gt.html5[t[r]]=!0,gt.flash[t[r]]=!!t[r].match(ne));n=o}else n=!(!(e=!(!a||"function"!=typeof a.canPlayType)&&a.canPlayType(t))||!e.match(gt.html5Test));return n}if(!gt.useHTML5Audio||!gt.hasHTML5)return gt.html5.usingFlash=!0,Xt=!0,!1;var i,n,o,r,a=Audio!==e?Qt&&opera.version()<10?new Audio(null):new Audio:null,s={};o=gt.audioFormats;for(i in o)if(o.hasOwnProperty(i)&&(n="audio/"+i,s[i]=t(o[i].type),s[n]=s[i],i.match(ne)?(gt.flash[i]=!0,gt.flash[n]=!0):(gt.flash[i]=!1,gt.flash[n]=!1),o[i]&&o[i].related))for(r=o[i].related.length-1;r>=0;r--)s["audio/"+o[i].related[r]]=s[i],gt.html5[o[i].related[r]]=s[i],gt.flash[o[i].related[r]]=s[i];return s.canPlayType=a?t:null,gt.html5=m(gt.html5,s),gt.html5.usingFlash=$(),Xt=gt.html5.usingFlash,!0},C={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:bt+"exception caught while appending SWF to DOM.",spcWmode:"Removing wmode, preventing known SWF loading issue(s)",swf404:wt+"Verify that %s is a valid path.",tryDebug:"Try "+bt+".debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:wt+"Non-HTTP page ("+Tt.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:wt+"Special case: Waiting for SWF to load with window focus...",waitForever:wt+"Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:wt+"Waiting for 100% SWF load...",needFunction:wt+"Function object expected for %s",badID:'Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:wt+"_debug(): Current sound objects",waitOnload:wt+"Waiting for window.onload()",docLoaded:wt+"Document already loaded",onload:wt+"initComplete(): calling soundManager.onload()",onloadOK:bt+".onload() complete",didInit:wt+"init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:wt+"Failed to remove Flash node.",shutdown:bt+".disable(): Shutting down",queue:wt+"Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying ."+U.swfTimedout+" CSS...",fbLoaded:"Flash loaded",fbHandler:wt+"flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:bt+".load(): current URL already assigned.",badFV:bt+'.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:wt+"Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:wt+"Got window focus.",policy:"Enabling usePolicyFile for data access",setup:bt+".setup(): allowed parameters: %s",setupError:bt+'.setup(): "%s" cannot be assigned with this method.',setupUndef:bt+'.setup(): Could not find option "%s"',setupLate:bt+".setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",noURL:wt+"Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready. "+String.fromCharCode(10003),reset:bt+".reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device.",ignoreMobile:"Ignoring mobile restrictions for this device."},F=function(){var t,e,i,n,o;if(t=Ut.call(arguments),n=t.shift(),(o=C&&C[n]?C[n]:"")&&t&&t.length)for(e=0,i=t.length;e<i;e++)o=o.replace("%s",t[e]);return o},H=function(t){return 8===p&&t.loops>1&&t.stream&&(d("as2loop"),t.stream=!1),t},q=function(t,e){return t&&!t.usePolicyFile&&(t.onid3||t.usePeakData||t.useWaveformData||t.useEQData)&&(gt._wD((e||"")+F("policy")),t.usePolicyFile=!0),t},z=function(t){$t&&console.warn!==e?console.warn(t):gt._wD(t)},l=function(){return!1},D=function(t){var e;for(e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(t[e]=l);e=null},L=function(t){t===e&&(t=!1),(Mt||t)&&gt.disable(t)},j=function(t){var e;if(t)if(t.match(/\.swf(\?.*)?$/i)){if(t.substr(t.toLowerCase().lastIndexOf(".swf?")+4))return t}else t.lastIndexOf("/")!==t.length-1&&(t+="/");return e=(t&&-1!==t.lastIndexOf("/")?t.substr(0,t.lastIndexOf("/")+1):"./")+gt.movieURL,gt.noSWFCache&&(e+="?ts="+(new Date).getTime()),e},T=function(){8!==(p=parseInt(gt.flashVersion,10))&&9!==p&&(gt._wD(F("badFV",p,8)),gt.flashVersion=p=8);var t=gt.debugMode||gt.debugFlash?"_debug.swf":".swf";gt.useHTML5Audio&&!gt.html5Only&&gt.audioFormats.mp4.required&&p<9&&(gt._wD(F("needfl9")),gt.flashVersion=p=9),gt.version=gt.versionNumber+(gt.html5Only?" (HTML5-only mode)":9===p?" (AS3/Flash 9)":" (AS2/Flash 8)"),p>8?(gt.defaultOptions=m(gt.defaultOptions,gt.flash9Options),gt.features.buffering=!0,gt.defaultOptions=m(gt.defaultOptions,gt.movieStarOptions),gt.filePatterns.flash9=new RegExp("\\.(mp3|"+se.join("|")+")(\\?.*)?$","i"),gt.features.movieStar=!0):gt.features.movieStar=!1,gt.filePattern=gt.filePatterns[8!==p?"flash9":"flash8"],gt.movieURL=(8===p?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",t),gt.features.peakData=gt.features.waveformData=gt.features.eqData=p>8},G=function(t,e){if(!vt)return!1;vt._setPolling(t,e)},E=function(){if(gt.debugURLParam.test(St)&&(gt.setupOptions.debugMode=gt.debugMode=!0),s(gt.debugID))return!1;var t,e,i,n,o;if(gt.debugMode&&!s(gt.debugID)&&(!$t||!gt.useConsole||!gt.consoleOnly)){(t=Tt.createElement("div")).id=gt.debugID+"-toggle",n={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001},t.appendChild(Tt.createTextNode("-")),t.onclick=V,t.title="Toggle SM2 debug console",_t.match(/msie 6/i)&&(t.style.position="absolute",t.style.cursor="hand");for(o in n)n.hasOwnProperty(o)&&(t.style[o]=n[o]);if(e=Tt.createElement("div"),e.id=gt.debugID,e.style.display=gt.debugMode?"block":"none",gt.debugMode&&!s(t.id)){try{(i=O()).appendChild(t)}catch(t){throw new Error(F("domError")+" \n"+t.toString())}i.appendChild(e)}}i=null},W=this.getSoundById,d=function(t,e){return t?gt._wD(F(t),e):""},V=function(){var t=s(gt.debugID),e=s(gt.debugID+"-toggle");if(!t)return!1;Ct?(e.innerHTML="+",t.style.display="none"):(e.innerHTML="-",t.style.display="block"),Ct=!Ct},u=function(i,n,o){if(t.sm2Debugger!==e)try{sm2Debugger.handleEvent(i,n,o)}catch(t){return!1}return!0},X=function(){var t=[];return gt.debugMode&&t.push(U.sm2Debug),gt.debugFlash&&t.push(U.flashDebug),gt.useHighPerformance&&t.push(U.highPerf),t.join(" ")},N=function(){var t=F("fbHandler"),e=gt.getMoviePercent(),i=U,n={type:"FLASHBLOCK"};if(gt.html5Only)return!1;gt.ok()?(gt.didFlashBlock&&gt._wD(t+": Unblocked"),gt.oMC&&(gt.oMC.className=[X(),i.swfDefault,i.swfLoaded+(gt.didFlashBlock?" "+i.swfUnblocked:"")].join(" "))):(Xt&&(gt.oMC.className=X()+" "+i.swfDefault+" "+(null===e?i.swfTimedout:i.swfError),gt._wD(t+": "+F("fbTimeout")+(e?" ("+F("fbLoaded")+")":""))),gt.didFlashBlock=!0,b({type:"ontimeout",ignoreInit:!0,error:n}),B(n))},v=function(t,i,n){Pt[t]===e&&(Pt[t]=[]),Pt[t].push({method:i,scope:n||null,fired:!1})},b=function(t){if(t||(t={type:gt.ok()?"onready":"ontimeout"}),!At&&t&&!t.ignoreInit)return!1;if("ontimeout"===t.type&&(gt.ok()||Mt&&!t.ignoreInit))return!1;var e,i,n={success:t&&t.ignoreInit?gt.ok():!Mt},o=t&&t.type?Pt[t.type]||[]:[],r=[],a=[n],s=Xt&&!gt.ok();for(t.error&&(a[0].error=t.error),e=0,i=o.length;e<i;e++)!0!==o[e].fired&&r.push(o[e]);if(r.length)for(e=0,i=r.length;e<i;e++)r[e].scope?r[e].method.apply(r[e].scope,a):r[e].method.apply(this,a),s||(r[e].fired=!0);return!0},w=function(){t.setTimeout(function(){gt.useFlashBlock&&N(),b(),"function"==typeof gt.onload&&(d("onload",1),gt.onload.apply(t),d("onloadOK",1)),gt.waitForWindowLoad&&at.add(t,"load",w)},1)},ct=function(){if(lt!==e)return lt;var i,n,o,r=!1,a=navigator,s=a.plugins,l=t.ActiveXObject;if(s&&s.length)n="application/x-shockwave-flash",(o=a.mimeTypes)&&o[n]&&o[n].enabledPlugin&&o[n].enabledPlugin.description&&(r=!0);else if(l!==e&&!_t.match(/MSAppHost/i)){try{i=new l("ShockwaveFlash.ShockwaveFlash")}catch(t){i=null}r=!!i,i=null}return lt=r,r},$=function(){var t,e,i=gt.audioFormats;if(qt&&!!_t.match(/os (1|2|3_0|3_1)\s/i)?(gt.hasHTML5=!1,gt.html5Only=!0,gt.oMC&&(gt.oMC.style.display="none")):gt.useHTML5Audio&&(gt.html5&&gt.html5.canPlayType||(gt._wD("SoundManager: No HTML5 Audio() support detected."),gt.hasHTML5=!1),Jt&&gt._wD(wt+"Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(lt?"will use flash fallback for MP3/MP4, if available":" would use flash fallback for MP3/MP4, but none detected."),1)),gt.useHTML5Audio&&gt.hasHTML5){J=!0;for(e in i)i.hasOwnProperty(e)&&i[e].required&&(gt.html5.canPlayType(i[e].type)?gt.preferFlash&&(gt.flash[e]||gt.flash[i[e].type])&&(t=!0):(J=!1,t=!0))}return gt.ignoreFlash&&(t=!1,J=!0),gt.html5Only=gt.hasHTML5&&gt.useHTML5Audio&&!t,!gt.html5Only},Z=function(t){var e,i,n,o=0;if(t instanceof Array){for(e=0,i=t.length;e<i;e++)if(t[e]instanceof Object){if(gt.canPlayMIME(t[e].type)){o=e;break}}else if(gt.canPlayURL(t[e])){o=e;break}t[o].url&&(t[o]=t[o].url),n=t[o]}else n=t;return n},Y=function(t){t._hasTimer||(t._hasTimer=!0,!Zt&&gt.html5PollingInterval&&(null===Ft&&0===jt&&(Ft=setInterval(Q,gt.html5PollingInterval)),jt++))},K=function(t){t._hasTimer&&(t._hasTimer=!1,!Zt&&gt.html5PollingInterval&&jt--)},Q=function(){var t;if(null!==Ft&&!jt)return clearInterval(Ft),Ft=null,!1;for(t=gt.soundIDs.length-1;t>=0;t--)gt.sounds[gt.soundIDs[t]].isHTML5&&gt.sounds[gt.soundIDs[t]]._hasTimer&&gt.sounds[gt.soundIDs[t]]._onTimer()},B=function(i){i=i!==e?i:{},"function"==typeof gt.onerror&&gt.onerror.apply(t,[{type:i.type!==e?i.type:null}]),i.fatal!==e&&i.fatal&&gt.disable()},ht=function(){if(!Jt||!ct())return!1;var t,e,i=gt.audioFormats;for(e in i)if(i.hasOwnProperty(e)&&("mp3"===e||"mp4"===e)&&(gt._wD(bt+": Using flash fallback for "+e+" format"),gt.html5[e]=!1,i[e]&&i[e].related))for(t=i[e].related.length-1;t>=0;t--)gt.html5[i[e].related[t]]=!1},this._setSandboxType=function(t){var i=gt.sandbox;i.type=t,i.description=i.types[i.types[t]!==e?t:"unknown"],"localWithFile"===i.type?(i.noRemote=!0,i.noLocal=!1,d("secNote",2)):"localWithNetwork"===i.type?(i.noRemote=!1,i.noLocal=!0):"localTrusted"===i.type&&(i.noRemote=!1,i.noLocal=!1)},this._externalInterfaceOK=function(t){if(gt.swfLoaded)return!1;var e;if(u("swf",!0),u("flashtojs",!0),gt.swfLoaded=!0,ee=!1,Jt&&ht(),!t||t.replace(/\+dev/i,"")!==gt.versionNumber.replace(/\+dev/i,""))return e=bt+': Fatal: JavaScript file build "'+gt.versionNumber+'" does not match Flash SWF build "'+t+'" at '+gt.url+". Ensure both are up-to-date.",setTimeout(function(){throw new Error(e)},0),!1;setTimeout(h,Wt?100:1)},R=function(t,i){function n(){var t,e=[],i=[];t="SoundManager "+gt.version+(!gt.html5Only&&gt.useHTML5Audio?gt.hasHTML5?" + HTML5 audio":", no HTML5 audio support":""),gt.html5Only?gt.html5PollingInterval&&e.push("html5PollingInterval ("+gt.html5PollingInterval+"ms)"):(gt.preferFlash&&e.push("preferFlash"),gt.useHighPerformance&&e.push("useHighPerformance"),gt.flashPollingInterval&&e.push("flashPollingInterval ("+gt.flashPollingInterval+"ms)"),gt.html5PollingInterval&&e.push("html5PollingInterval ("+gt.html5PollingInterval+"ms)"),gt.wmode&&e.push("wmode ("+gt.wmode+")"),gt.debugFlash&&e.push("debugFlash"),gt.useFlashBlock&&e.push("flashBlock")),e.length&&(i=i.concat([e.join(" + ")])),gt._wD(t+(i.length?" + "+i.join(", "):""),1),ut()}function o(t,e){return'<param name="'+t+'" value="'+e+'" />'}if(It&&kt)return!1;if(gt.html5Only)return T(),n(),gt.oMC=s(gt.movieID),h(),It=!0,kt=!0,!1;var r,a,l,c,p,u,d,f,m=i||gt.url,g=gt.altURL||m,y=O(),v=X(),b=null,w=Tt.getElementsByTagName("html")[0];if(b=w&&w.dir&&w.dir.match(/rtl/i),t=t===e?gt.id:t,T(),gt.url=j(oe?m:g),i=gt.url,gt.wmode=!gt.wmode&&gt.useHighPerformance?"transparent":gt.wmode,null!==gt.wmode&&(_t.match(/msie 8/i)||!Wt&&!gt.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(Nt.push(C.spcWmode),gt.wmode=null),r={name:t,id:t,src:i,quality:"high",allowScriptAccess:gt.allowScriptAccess,bgcolor:gt.bgColor,pluginspage:re+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:gt.wmode,hasPriority:"true"},gt.debugFlash&&(r.FlashVars="debug=1"),gt.wmode||delete r.wmode,Wt)a=Tt.createElement("div"),c=['<object id="'+t+'" data="'+i+'" type="'+r.type+'" title="'+r.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',o("movie",i),o("AllowScriptAccess",gt.allowScriptAccess),o("quality",r.quality),gt.wmode?o("wmode",gt.wmode):"",o("bgcolor",gt.bgColor),o("hasPriority","true"),gt.debugFlash?o("FlashVars",r.FlashVars):"","</object>"].join("");else{a=Tt.createElement("embed");for(l in r)r.hasOwnProperty(l)&&a.setAttribute(l,r[l])}if(E(),v=X(),y=O())if(gt.oMC=s(gt.movieID)||Tt.createElement("div"),gt.oMC.id)f=gt.oMC.className,gt.oMC.className=(f?f+" ":U.swfDefault)+(v?" "+v:""),gt.oMC.appendChild(a),Wt&&((p=gt.oMC.appendChild(Tt.createElement("div"))).className=U.swfBox,p.innerHTML=c),kt=!0;else{if(gt.oMC.id=gt.movieID,gt.oMC.className=U.swfDefault+" "+v,u=null,p=null,gt.useFlashBlock||(gt.useHighPerformance?u={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(u={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},b&&(u.left=Math.abs(parseInt(u.left,10))+"px"))),Yt&&(gt.oMC.style.zIndex=1e4),!gt.debugFlash)for(d in u)u.hasOwnProperty(d)&&(gt.oMC.style[d]=u[d]);try{Wt||gt.oMC.appendChild(a),y.appendChild(gt.oMC),Wt&&((p=gt.oMC.appendChild(Tt.createElement("div"))).className=U.swfBox,p.innerHTML=c),kt=!0}catch(t){throw new Error(F("domError")+" \n"+t.toString())}}return It=!0,n(),!0},I=function(){return gt.html5Only?(R(),!1):!vt&&(gt.url?((vt=gt.getMovie(gt.id))||(Gt?(Wt?gt.oMC.innerHTML=Et:gt.oMC.appendChild(Gt),Gt=null,It=!0):R(gt.id,gt.url),vt=gt.getMovie(gt.id)),"function"==typeof gt.oninitmovie&&setTimeout(gt.oninitmovie,1),dt(),!0):(d("noURL"),!1))},x=function(){setTimeout(_,1e3)},S=function(){t.setTimeout(function(){z(wt+"useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false..."),gt.setup({preferFlash:!1}).reboot(),gt.didFlashBlock=!0,gt.beginDelayedInit()},1)},_=function(){var e,i=!1;return!!gt.url&&(!Dt&&(Dt=!0,at.remove(t,"load",x),lt&&ee&&!te?(d("waitFocus"),!1):(At||(e=gt.getMoviePercent())>0&&e<100&&(i=!0),void setTimeout(function(){if(e=gt.getMoviePercent(),i)return Dt=!1,gt._wD(F("waitSWF")),t.setTimeout(x,1),!1;At||(gt._wD(bt+": No Flash response within expected time. Likely causes: "+(0===e?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(gt.debugFlash?" "+F("checkSWF"):""),2),!oe&&e&&(d("localFail",2),gt.debugFlash||d("tryDebug",2)),0===e&&gt._wD(F("swf404",gt.url),1),u("flashtojs",!1,": Timed out"+(oe?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)"))),!At&&ie&&(null===e?gt.useFlashBlock||0===gt.flashLoadTimeout?(gt.useFlashBlock&&N(),d("waitForever")):!gt.useFlashBlock&&J?S():(d("waitForever"),b({type:"ontimeout",ignoreInit:!0,error:{type:"INIT_FLASHBLOCK"}})):0===gt.flashLoadTimeout?d("waitForever"):!gt.useFlashBlock&&J?S():L(!0))},gt.flashLoadTimeout))))},P=function(){function e(){at.remove(t,"focus",P)}return te||!ee?(e(),!0):(ie=!0,te=!0,d("gotFocus"),Dt=!1,x(),e(),!0)},dt=function(){Nt.length&&(gt._wD("SoundManager 2: "+Nt.join(" "),1),Nt=[])},ut=function(){dt();var t,e=[];if(gt.useHTML5Audio&&gt.hasHTML5){for(t in gt.audioFormats)gt.audioFormats.hasOwnProperty(t)&&e.push(t+" = "+gt.html5[t]+(!gt.html5[t]&&Xt&&gt.flash[t]?" (using flash)":gt.preferFlash&&gt.flash[t]&&Xt?" (preferring flash)":gt.html5[t]?"":" ("+(gt.audioFormats[t].required?"required, ":"")+"and no flash support)"));gt._wD("SoundManager 2 HTML5 support: "+e.join(", "),1)}},f=function(e){if(At)return!1;if(gt.html5Only)return d("sm2Loaded",1),At=!0,w(),u("onload",!0),!0;var i,n=!0;return gt.useFlashBlock&&gt.flashLoadTimeout&&!gt.getMoviePercent()||(At=!0),i={type:!lt&&Xt?"NO_FLASH":"INIT_TIMEOUT"},gt._wD("SoundManager 2 "+(Mt?"failed to load":"loaded")+" ("+(Mt?"Flash security/load error":"OK")+") "+String.fromCharCode(Mt?10006:10003),Mt?2:1),Mt||e?(gt.useFlashBlock&&gt.oMC&&(gt.oMC.className=X()+" "+(null===gt.getMoviePercent()?U.swfTimedout:U.swfError)),b({type:"ontimeout",error:i,ignoreInit:!0}),u("onload",!1),B(i),n=!1):u("onload",!0),Mt||(gt.waitForWindowLoad&&!Ot?(d("waitOnload"),at.add(t,"load",w)):(gt.waitForWindowLoad&&Ot&&d("docLoaded"),w())),n},c=function(){var t,i=gt.setupOptions;for(t in i)i.hasOwnProperty(t)&&(gt[t]===e?gt[t]=i[t]:gt[t]!==i[t]&&(gt.setupOptions[t]=gt[t]))},h=function(){function e(){at.remove(t,"load",gt.beginDelayedInit)}if(At)return d("didInit"),!1;if(gt.html5Only)return At||(e(),gt.enabled=!0,f()),!0;I();try{vt._externalInterfaceTest(!1),G(!0,gt.flashPollingInterval||(gt.useHighPerformance?10:50)),gt.debugMode||vt._disableDebug(),gt.enabled=!0,u("jstoflash",!0),gt.html5Only||at.add(t,"unload",l)}catch(t){return gt._wD("js/flash exception: "+t.toString()),u("jstoflash",!1),B({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),L(!0),f(),!1}return f(),e(),!0},k=function(){return!M&&(M=!0,c(),E(),!lt&&gt.hasHTML5&&(gt._wD("SoundManager 2: No Flash detected"+(gt.useHTML5Audio?". Trying HTML5-only mode.":", enabling HTML5."),1),gt.setup({useHTML5Audio:!0,preferFlash:!1})),rt(),!lt&&Xt&&(Nt.push(C.needFlash),gt.setup({flashLoadTimeout:1})),Tt.removeEventListener&&Tt.removeEventListener("DOMContentLoaded",k,!1),I(),!0)},ot=function(){return"complete"===Tt.readyState&&(k(),Tt.detachEvent("onreadystatechange",ot)),!0},A=function(){Ot=!0,k(),at.remove(t,"load",A)},ct(),at.add(t,"focus",P),at.add(t,"load",x),at.add(t,"load",A),Tt.addEventListener?Tt.addEventListener("DOMContentLoaded",k,!1):Tt.attachEvent?Tt.attachEvent("onreadystatechange",ot):(u("onload",!1),B({type:"NO_DOM2_EVENTS",fatal:!0}))}if(!t||!t.document)throw new Error("SoundManager requires a browser with window and document objects.");var n=null;t.SM2_DEFER!==e&&SM2_DEFER||(n=new i),"object"==typeof module&&module&&"object"==typeof module.exports?(module.exports.SoundManager=i,module.exports.soundManager=n):"function"==typeof define&&define.amd&&define(function(){return{constructor:i,getInstance:function(e){if(!t.soundManager&&e instanceof Function){var n=e(i);n instanceof i&&(t.soundManager=n)}return t.soundManager}}}),t.SoundManager=i,t.soundManager=n}(window);var Stats=function(){function t(t,e,i){var n=document.createElement(t);return n.id=e,n.style.cssText=i,n}function e(e,i,n){var o=t("div",e,"padding:0 0 3px 3px;text-align:left;background:"+n),r=t("div",e+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+i);r.innerHTML=e.toUpperCase(),o.appendChild(r);var a=t("div",e+"Graph","width:74px;height:30px;background:"+i);o.appendChild(a);for(var s=0;s<74;s++)a.appendChild(t("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+n));return o}function i(t){for(var e=c.children,i=0;i<e.length;i++)e[i].style.display=i===t?"block":"none";l=t}function n(t,e){t.appendChild(t.firstChild).style.height=Math.min(30,30-30*e)+"px"}var o=performance&&performance.now?performance.now.bind(performance):Date.now,r=o(),a=r,s=0,l=0,c=t("div","stats","width:80px;opacity:0.9;cursor:pointer");c.addEventListener("mousedown",function(t){t.preventDefault(),i(++l%c.children.length)},!1);var h=0,p=1/0,u=0,d=e("fps","#0ff","#002"),f=d.children[0],m=d.children[1];c.appendChild(d);var g=0,y=1/0,v=0,b=e("ms","#0f0","#020"),w=b.children[0],x=b.children[1];if(c.appendChild(b),performance&&performance.memory){var _=0,S=1/0,T=0,P=e("mb","#f08","#201"),C=P.children[0],I=P.children[1];c.appendChild(P)}return i(l),{REVISION:14,domElement:c,setMode:i,begin:function(){r=o()},end:function(){var t=o();if(g=t-r,y=Math.min(y,g),v=Math.max(v,g),w.textContent=(0|g)+" MS ("+(0|y)+"-"+(0|v)+")",n(x,g/200),s++,t>a+1e3&&(h=Math.round(1e3*s/(t-a)),p=Math.min(p,h),u=Math.max(u,h),f.textContent=h+" FPS ("+p+"-"+u+")",n(m,h/100),a=t,s=0,void 0!==_)){var e=performance.memory.usedJSHeapSize,i=performance.memory.jsHeapSizeLimit;_=Math.round(9.54e-7*e),S=Math.min(S,_),T=Math.max(T,_),C.textContent=_+" MB ("+S+"-"+T+")",n(I,e/i)}return t},update:function(){r=this.end()}}};"object"==typeof module&&(module.exports=Stats),function(t){"use strict";function e(t){switch(typeof t){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";default:return null===t?"null":"object"}}function i(t){return Object.prototype.toString.call(t).replace(/^\[object *|\]$/g,"")}function n(t){return"function"==typeof t}function o(t){if(null===t||t===A)throw TypeError();return Object(t)}function r(t){return t>>0}function a(t){return t>>>0}function s(t){if(t.length>M)throw RangeError("Array too large for polyfill");var e;for(e=0;e<t.length;e+=1)!function(e){Object.defineProperty(t,e,{get:function(){return t._getter(e)},set:function(i){t._setter(e,i)},enumerable:!0,configurable:!1})}(e)}function l(t,e){var i=32-e;return t<<i>>i}function c(t,e){var i=32-e;return t<<i>>>i}function h(t){return[255&t]}function p(t){return l(t[0],8)}function u(t){return[255&t]}function d(t){return c(t[0],8)}function f(t){return t=j(Number(t)),[t<0?0:t>255?255:255&t]}function m(t){return[t>>8&255,255&t]}function g(t){return l(t[0]<<8|t[1],16)}function y(t){return[t>>8&255,255&t]}function v(t){return c(t[0]<<8|t[1],16)}function b(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]}function w(t){return l(t[0]<<24|t[1]<<16|t[2]<<8|t[3],32)}function x(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]}function _(t){return c(t[0]<<24|t[1]<<16|t[2]<<8|t[3],32)}function S(t,e,i){function n(t){var e=B(t),i=t-e;return i<.5?e:i>.5?e+1:e%2?e+1:e}var o,r,a,s,l,c,h,p=(1<<e-1)-1;for(t!==t?(r=(1<<e)-1,a=L(2,i-1),o=0):t===1/0||t===-1/0?(r=(1<<e)-1,a=0,o=t<0?1:0):0===t?(r=0,a=0,o=1/t==-1/0?1:0):(o=t<0,(t=R(t))>=L(2,1-p)?(r=D(B(G(t)/O),1023),(a=n(t/L(2,r)*L(2,i)))/L(2,i)>=2&&(r+=1,a=1),r>p?(r=(1<<e)-1,a=0):(r+=p,a-=L(2,i))):(r=0,a=n(t/L(2,1-p-i)))),l=[],s=i;s;s-=1)l.push(a%2?1:0),a=B(a/2);for(s=e;s;s-=1)l.push(r%2?1:0),r=B(r/2);for(l.push(o?1:0),l.reverse(),c=l.join(""),h=[];c.length;)h.push(parseInt(c.substring(0,8),2)),c=c.substring(8);return h}function T(t,e,i){var n,o,r,a,s,l,c,h,p=[];for(n=t.length;n;n-=1)for(r=t[n-1],o=8;o;o-=1)p.push(r%2?1:0),r>>=1;return p.reverse(),a=p.join(""),s=(1<<e-1)-1,l=parseInt(a.substring(0,1),2)?-1:1,c=parseInt(a.substring(1,1+e),2),h=parseInt(a.substring(1+e),2),c===(1<<e)-1?0!==h?NaN:l*(1/0):c>0?l*L(2,c-s)*(1+h/L(2,i)):0!==h?l*L(2,-(s-1))*(h/L(2,i)):l<0?-0:0}function P(t){return T(t,11,52)}function C(t){return S(t,11,52)}function I(t){return T(t,8,23)}function k(t){return S(t,8,23)}var A=void 0,M=1e5,O=Math.LN2,R=Math.abs,B=Math.floor,G=Math.log,E=Math.max,D=Math.min,L=Math.pow,j=Math.round;!function(){var t=Object.defineProperty,e=!function(){try{return Object.defineProperty({},"x",{})}catch(t){return!1}}();t&&!e||(Object.defineProperty=function(e,i,n){if(t)try{return t(e,i,n)}catch(t){}if(e!==Object(e))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in n&&Object.prototype.__defineGetter__.call(e,i,n.get),Object.prototype.__defineSetter__&&"set"in n&&Object.prototype.__defineSetter__.call(e,i,n.set),"value"in n&&(e[i]=n.value),e})}(),function(){function l(t){if((t=r(t))<0)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:t}),Object.defineProperty(this,"_bytes",{value:Array(t)});for(var e=0;e<t;e+=1)this._bytes[e]=0}function c(){if(!arguments.length||"object"!=typeof arguments[0])return function(t){if((t=r(t))<0)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:t}),Object.defineProperty(this,"byteLength",{value:t*this.BYTES_PER_ELEMENT}),Object.defineProperty(this,"buffer",{value:new l(this.byteLength)}),Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments);if(arguments.length>=1&&"object"===e(arguments[0])&&arguments[0]instanceof c)return function(t){if(this.constructor!==t.constructor)throw TypeError();var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new l(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var i=0;i<this.length;i+=1)this._setter(i,t._getter(i))}.apply(this,arguments);if(arguments.length>=1&&"object"===e(arguments[0])&&!(arguments[0]instanceof c)&&!(arguments[0]instanceof l||"ArrayBuffer"===i(arguments[0])))return function(t){var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new l(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var i=0;i<this.length;i+=1){var n=t[i];this._setter(i,Number(n))}}.apply(this,arguments);if(arguments.length>=1&&"object"===e(arguments[0])&&(arguments[0]instanceof l||"ArrayBuffer"===i(arguments[0])))return function(t,e,i){if((e=a(e))>t.byteLength)throw RangeError("byteOffset out of range");if(e%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(i===A){var n=t.byteLength-e;if(n%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");i=n/this.BYTES_PER_ELEMENT}else n=(i=a(i))*this.BYTES_PER_ELEMENT;if(e+n>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:n}),Object.defineProperty(this,"byteOffset",{value:e}),Object.defineProperty(this,"length",{value:i})}.apply(this,arguments);throw TypeError()}function S(t,e,i){var n=function(){Object.defineProperty(this,"constructor",{value:n}),c.apply(this,arguments),s(this)};"__proto__"in n?n.__proto__=c:(n.from=c.from,n.of=c.of),n.BYTES_PER_ELEMENT=t;var o=function(){};return o.prototype=T,n.prototype=new o,Object.defineProperty(n.prototype,"BYTES_PER_ELEMENT",{value:t}),Object.defineProperty(n.prototype,"_pack",{value:e}),Object.defineProperty(n.prototype,"_unpack",{value:i}),n}t.ArrayBuffer=t.ArrayBuffer||l,Object.defineProperty(c,"from",{value:function(t){return new this(t)}}),Object.defineProperty(c,"of",{value:function(){return new this(arguments)}});var T={};c.prototype=T,Object.defineProperty(c.prototype,"_getter",{value:function(t){if(arguments.length<1)throw SyntaxError("Not enough arguments");if((t=a(t))>=this.length)return A;var e,i,n=[];for(e=0,i=this.byteOffset+t*this.BYTES_PER_ELEMENT;e<this.BYTES_PER_ELEMENT;e+=1,i+=1)n.push(this.buffer._bytes[i]);return this._unpack(n)}}),Object.defineProperty(c.prototype,"get",{value:c.prototype._getter}),Object.defineProperty(c.prototype,"_setter",{value:function(t,e){if(arguments.length<2)throw SyntaxError("Not enough arguments");if(!((t=a(t))>=this.length)){var i,n,o=this._pack(e);for(i=0,n=this.byteOffset+t*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,n+=1)this.buffer._bytes[n]=o[i]}}}),Object.defineProperty(c.prototype,"constructor",{value:c}),Object.defineProperty(c.prototype,"copyWithin",{value:function(t,e){var i=arguments[2],n=o(this),s=a(n.length);s=E(s,0);var l,c=r(t);l=c<0?E(s+c,0):D(c,s);var h,p=r(e);h=p<0?E(s+p,0):D(p,s);var u,d;d=(u=i===A?s:r(i))<0?E(s+u,0):D(u,s);var f,m=D(d-h,s-l);for(h<l&&l<h+m?(f=-1,h=h+m-1,l=l+m-1):f=1;m>0;)n._setter(l,n._getter(h)),h+=f,l+=f,m-=1;return n}}),Object.defineProperty(c.prototype,"every",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(!n(t))throw TypeError();for(var o=arguments[1],r=0;r<i;r++)if(!t.call(o,e._getter(r),r,e))return!1;return!0}}),Object.defineProperty(c.prototype,"fill",{value:function(t){var e=arguments[1],i=arguments[2],n=o(this),s=a(n.length);s=E(s,0);var l,c=r(e);l=c<0?E(s+c,0):D(c,s);var h,p;for(p=(h=i===A?s:r(i))<0?E(s+h,0):D(h,s);l<p;)n._setter(l,t),l+=1;return n}}),Object.defineProperty(c.prototype,"filter",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(!n(t))throw TypeError();for(var o=[],r=arguments[1],s=0;s<i;s++){var l=e._getter(s);t.call(r,l,s,e)&&o.push(l)}return new this.constructor(o)}}),Object.defineProperty(c.prototype,"find",{value:function(t){var e=o(this),i=a(e.length);if(!n(t))throw TypeError();for(var r=arguments.length>1?arguments[1]:A,s=0;s<i;){var l=e._getter(s),c=t.call(r,l,s,e);if(Boolean(c))return l;++s}return A}}),Object.defineProperty(c.prototype,"findIndex",{value:function(t){var e=o(this),i=a(e.length);if(!n(t))throw TypeError();for(var r=arguments.length>1?arguments[1]:A,s=0;s<i;){var l=e._getter(s),c=t.call(r,l,s,e);if(Boolean(c))return s;++s}return-1}}),Object.defineProperty(c.prototype,"forEach",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(!n(t))throw TypeError();for(var o=arguments[1],r=0;r<i;r++)t.call(o,e._getter(r),r,e)}}),Object.defineProperty(c.prototype,"indexOf",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(0===i)return-1;var n=0;if(arguments.length>0&&((n=Number(arguments[1]))!==n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*B(R(n)))),n>=i)return-1;for(var o=n>=0?n:E(i-R(n),0);o<i;o++)if(e._getter(o)===t)return o;return-1}}),Object.defineProperty(c.prototype,"join",{value:function(t){if(this===A||null===this)throw TypeError();for(var e=Object(this),i=a(e.length),n=Array(i),o=0;o<i;++o)n[o]=e._getter(o);return n.join(t===A?",":t)}}),Object.defineProperty(c.prototype,"lastIndexOf",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(0===i)return-1;var n=i;arguments.length>1&&((n=Number(arguments[1]))!==n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*B(R(n))));for(var o=n>=0?D(n,i-1):i-R(n);o>=0;o--)if(e._getter(o)===t)return o;return-1}}),Object.defineProperty(c.prototype,"map",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(!n(t))throw TypeError();var o=[];o.length=i;for(var r=arguments[1],s=0;s<i;s++)o[s]=t.call(r,e._getter(s),s,e);return new this.constructor(o)}}),Object.defineProperty(c.prototype,"reduce",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(!n(t))throw TypeError();if(0===i&&1===arguments.length)throw TypeError();var o,r=0;for(o=arguments.length>=2?arguments[1]:e._getter(r++);r<i;)o=t.call(A,o,e._getter(r),r,e),r++;return o}}),Object.defineProperty(c.prototype,"reduceRight",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(!n(t))throw TypeError();if(0===i&&1===arguments.length)throw TypeError();var o,r=i-1;for(o=arguments.length>=2?arguments[1]:e._getter(r--);r>=0;)o=t.call(A,o,e._getter(r),r,e),r--;return o}}),Object.defineProperty(c.prototype,"reverse",{value:function(){if(this===A||null===this)throw TypeError();for(var t=Object(this),e=a(t.length),i=B(e/2),n=0,o=e-1;n<i;++n,--o){var r=t._getter(n);t._setter(n,t._getter(o)),t._setter(o,r)}return t}}),Object.defineProperty(c.prototype,"set",{value:function(t,e){if(arguments.length<1)throw SyntaxError("Not enough arguments");var i,n,o,r,s,l,c,h,p,u;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(i=arguments[0],(o=a(arguments[1]))+i.length>this.length)throw RangeError("Offset plus length of array is out of range");if(h=this.byteOffset+o*this.BYTES_PER_ELEMENT,p=i.length*this.BYTES_PER_ELEMENT,i.buffer===this.buffer){for(u=[],s=0,l=i.byteOffset;s<p;s+=1,l+=1)u[s]=i.buffer._bytes[l];for(s=0,c=h;s<p;s+=1,c+=1)this.buffer._bytes[c]=u[s]}else for(s=0,l=i.byteOffset,c=h;s<p;s+=1,l+=1,c+=1)this.buffer._bytes[c]=i.buffer._bytes[l]}else{if("object"!=typeof arguments[0]||void 0===arguments[0].length)throw TypeError("Unexpected argument type(s)");if(n=arguments[0],r=a(n.length),(o=a(arguments[1]))+r>this.length)throw RangeError("Offset plus length of array is out of range");for(s=0;s<r;s+=1)l=n[s],this._setter(o+s,Number(l))}}}),Object.defineProperty(c.prototype,"slice",{value:function(t,e){for(var i=o(this),n=a(i.length),s=r(t),l=s<0?E(n+s,0):D(s,n),c=e===A?n:r(e),h=c<0?E(n+c,0):D(c,n),p=h-l,u=new(0,i.constructor)(p),d=0;l<h;){var f=i._getter(l);u._setter(d,f),++l,++d}return u}}),Object.defineProperty(c.prototype,"some",{value:function(t){if(this===A||null===this)throw TypeError();var e=Object(this),i=a(e.length);if(!n(t))throw TypeError();for(var o=arguments[1],r=0;r<i;r++)if(t.call(o,e._getter(r),r,e))return!0;return!1}}),Object.defineProperty(c.prototype,"sort",{value:function(t){if(this===A||null===this)throw TypeError();for(var e=Object(this),i=a(e.length),n=Array(i),o=0;o<i;++o)n[o]=e._getter(o);for(t?n.sort(t):n.sort(),o=0;o<i;++o)e._setter(o,n[o]);return e}}),Object.defineProperty(c.prototype,"subarray",{value:function(t,e){function i(t,e,i){return t<e?e:t>i?i:t}t=r(t),e=r(e),arguments.length<1&&(t=0),arguments.length<2&&(e=this.length),t<0&&(t=this.length+t),e<0&&(e=this.length+e),t=i(t,0,this.length);var n=(e=i(e,0,this.length))-t;return n<0&&(n=0),new this.constructor(this.buffer,this.byteOffset+t*this.BYTES_PER_ELEMENT,n)}});var M=S(1,h,p),O=S(1,u,d),G=S(1,f,d),L=S(2,m,g),j=S(2,y,v),F=S(4,b,w),N=S(4,x,_),X=S(4,k,I),U=S(8,C,P);t.Int8Array=t.Int8Array||M,t.Uint8Array=t.Uint8Array||O,t.Uint8ClampedArray=t.Uint8ClampedArray||G,t.Int16Array=t.Int16Array||L,t.Uint16Array=t.Uint16Array||j,t.Int32Array=t.Int32Array||F,t.Uint32Array=t.Uint32Array||N,t.Float32Array=t.Float32Array||X,t.Float64Array=t.Float64Array||U}(),function(){function e(t,e){return n(t.get)?t.get(e):t[e]}function o(t,e,n){if(!(t instanceof ArrayBuffer||"ArrayBuffer"===i(t)))throw TypeError();if((e=a(e))>t.byteLength)throw RangeError("byteOffset out of range");if(n=n===A?t.byteLength-e:a(n),e+n>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:n}),Object.defineProperty(this,"byteOffset",{value:e})}function r(t){return function(i,n){if((i=a(i))+t.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");i+=this.byteOffset;for(var o=new Uint8Array(this.buffer,i,t.BYTES_PER_ELEMENT),r=[],s=0;s<t.BYTES_PER_ELEMENT;s+=1)r.push(e(o,s));return Boolean(n)===Boolean(l)&&r.reverse(),e(new t(new Uint8Array(r).buffer),0)}}function s(t){return function(i,n,o){if((i=a(i))+t.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");var r,s=new t([n]),c=new Uint8Array(s.buffer),h=[];for(r=0;r<t.BYTES_PER_ELEMENT;r+=1)h.push(e(c,r));Boolean(o)===Boolean(l)&&h.reverse(),new Uint8Array(this.buffer,i,t.BYTES_PER_ELEMENT).set(h)}}var l=function(){var t=new Uint16Array([4660]);return 18===e(new Uint8Array(t.buffer),0)}();Object.defineProperty(o.prototype,"getUint8",{value:r(Uint8Array)}),Object.defineProperty(o.prototype,"getInt8",{value:r(Int8Array)}),Object.defineProperty(o.prototype,"getUint16",{value:r(Uint16Array)}),Object.defineProperty(o.prototype,"getInt16",{value:r(Int16Array)}),Object.defineProperty(o.prototype,"getUint32",{value:r(Uint32Array)}),Object.defineProperty(o.prototype,"getInt32",{value:r(Int32Array)}),Object.defineProperty(o.prototype,"getFloat32",{value:r(Float32Array)}),Object.defineProperty(o.prototype,"getFloat64",{value:r(Float64Array)}),Object.defineProperty(o.prototype,"setUint8",{value:s(Uint8Array)}),Object.defineProperty(o.prototype,"setInt8",{value:s(Int8Array)}),Object.defineProperty(o.prototype,"setUint16",{value:s(Uint16Array)}),Object.defineProperty(o.prototype,"setInt16",{value:s(Int16Array)}),Object.defineProperty(o.prototype,"setUint32",{value:s(Uint32Array)}),Object.defineProperty(o.prototype,"setInt32",{value:s(Int32Array)}),Object.defineProperty(o.prototype,"setFloat32",{value:s(Float32Array)}),Object.defineProperty(o.prototype,"setFloat64",{value:s(Float64Array)}),t.DataView=t.DataView||o}()}(this);var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var n=function(t){var e,i=[],n=t.length;for(e=0;e!==n;i.push(t[e++]));return i},o=function(t,e,i){var n,o,r=t.cycle;for(n in r)o=r[n],t[n]="function"==typeof o?o(i,e[i]):o[i%o.length];delete t.cycle},r=function(t,e,n){i.call(this,t,e,n),this._cycle=0,this._yoyo=!0===this.vars.yoyo,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=r.prototype.render},a=i._internals,s=a.isSelector,l=a.isArray,c=r.prototype=i.to({},.1,{}),h=[];r.version="1.19.1",c.constructor=r,c.kill()._gc=!1,r.killTweensOf=r.killDelayedCallsTo=i.killTweensOf,r.getTweensOf=i.getTweensOf,r.lagSmoothing=i.lagSmoothing,r.ticker=i.ticker,r.render=i.render,c.invalidate=function(){return this._yoyo=!0===this.vars.yoyo,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),i.prototype.invalidate.call(this)},c.updateTo=function(t,e){var n,o=this.ratio,r=this.vars.immediateRender||t.immediateRender;e&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(n in t)this.vars[n]=t[n];if(this._initted||r)if(e)this._initted=!1,r&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&i._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var a=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(a,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||r)for(var s,l=1/(1-o),c=this._firstPT;c;)s=c.s+c.c,c.c*=l,c.s=s-c.c,c=c._next;return this},c.render=function(t,e,i){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var n,o,r,s,l,c,h,p,u=this._dirty?this.totalDuration():this._totalDuration,d=this._time,f=this._totalTime,m=this._cycle,g=this._duration,y=this._rawPrevTime;if(t>=u-1e-7&&t>=0?(this._totalTime=u,this._cycle=this._repeat,this._yoyo&&0!=(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=g,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(n=!0,o="onComplete",i=i||this._timeline.autoRemoveChildren),0===g&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(y<0||t<=0&&t>=-1e-7||1e-10===y&&"isPause"!==this.data)&&y!==t&&(i=!0,y>1e-10&&(o="onReverseComplete")),this._rawPrevTime=p=!e||t||y===t?t:1e-10)):t<1e-7?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==f||0===g&&y>0)&&(o="onReverseComplete",n=this._reversed),t<0&&(this._active=!1,0===g&&(this._initted||!this.vars.lazy||i)&&(y>=0&&(i=!0),this._rawPrevTime=p=!e||t||y===t?t:1e-10)),this._initted||(i=!0)):(this._totalTime=this._time=t,0!==this._repeat&&(s=g+this._repeatDelay,this._cycle=this._totalTime/s>>0,0!==this._cycle&&this._cycle===this._totalTime/s&&f<=t&&this._cycle--,this._time=this._totalTime-this._cycle*s,this._yoyo&&0!=(1&this._cycle)&&(this._time=g-this._time),this._time>g?this._time=g:this._time<0&&(this._time=0)),this._easeType?(l=this._time/g,c=this._easeType,h=this._easePower,(1===c||3===c&&l>=.5)&&(l=1-l),3===c&&(l*=2),1===h?l*=l:2===h?l*=l*l:3===h?l*=l*l*l:4===h&&(l*=l*l*l*l),1===c?this.ratio=1-l:2===c?this.ratio=l:this._time/g<.5?this.ratio=l/2:this.ratio=1-l/2):this.ratio=this._ease.getRatio(this._time/g)),d!==this._time||i||m!==this._cycle){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=d,this._totalTime=f,this._rawPrevTime=y,this._cycle=m,a.lazyTweens.push(this),void(this._lazy=[t,e]);this._time&&!n?this.ratio=this._ease.getRatio(this._time/g):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==d&&t>=0&&(this._active=!0),0===f&&(2===this._initted&&t>0&&this._init(),this._startAt&&(t>=0?this._startAt.render(t,e,i):o||(o="_dummyGS")),this.vars.onStart&&(0===this._totalTime&&0!==g||e||this._callback("onStart"))),r=this._firstPT;r;)r.f?r.t[r.p](r.c*this.ratio+r.s):r.t[r.p]=r.c*this.ratio+r.s,r=r._next;this._onUpdate&&(t<0&&this._startAt&&this._startTime&&this._startAt.render(t,e,i),e||(this._totalTime!==f||o)&&this._callback("onUpdate")),this._cycle!==m&&(e||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),o&&(this._gc&&!i||(t<0&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,e,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[o]&&this._callback(o),0===g&&1e-10===this._rawPrevTime&&1e-10!==p&&(this._rawPrevTime=0)))}else f!==this._totalTime&&this._onUpdate&&(e||this._callback("onUpdate"))},r.to=function(t,e,i){return new r(t,e,i)},r.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new r(t,e,i)},r.fromTo=function(t,e,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new r(t,e,n)},r.staggerTo=r.allTo=function(t,e,a,c,p,u,d){c=c||0;var f,m,g,y,v=0,b=[],w=a.cycle,x=a.startAt&&a.startAt.cycle;for(l(t)||("string"==typeof t&&(t=i.selector(t)||t),s(t)&&(t=n(t))),t=t||[],c<0&&((t=n(t)).reverse(),c*=-1),f=t.length-1,g=0;g<=f;g++){m={};for(y in a)m[y]=a[y];if(w&&(o(m,t,g),null!=m.duration&&(e=m.duration,delete m.duration)),x){x=m.startAt={};for(y in a.startAt)x[y]=a.startAt[y];o(m.startAt,t,g)}m.delay=v+(m.delay||0),g===f&&p&&(m.onComplete=function(){a.onComplete&&a.onComplete.apply(a.onCompleteScope||this,arguments),p.apply(d||a.callbackScope||this,u||h)}),b[g]=new r(t[g],e,m),v+=c}return b},r.staggerFrom=r.allFrom=function(t,e,i,n,o,a,s){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,r.staggerTo(t,e,i,n,o,a,s)},r.staggerFromTo=r.allFromTo=function(t,e,i,n,o,a,s,l){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,r.staggerTo(t,e,n,o,a,s,l)},r.delayedCall=function(t,e,i,n,o){return new r(e,0,{delay:t,onComplete:e,onCompleteParams:i,callbackScope:n,onReverseComplete:e,onReverseCompleteParams:i,immediateRender:!1,useFrames:o,overwrite:0})},r.set=function(t,e){return new r(t,0,e)},r.isTweening=function(t){return i.getTweensOf(t,!0).length>0};var p=function(t,e){for(var n=[],o=0,r=t._first;r;)r instanceof i?n[o++]=r:(e&&(n[o++]=r),o=(n=n.concat(p(r,e))).length),r=r._next;return n},u=r.getAllTweens=function(e){return p(t._rootTimeline,e).concat(p(t._rootFramesTimeline,e))};r.killAll=function(t,i,n,o){null==i&&(i=!0),null==n&&(n=!0);var r,a,s,l=u(0!=o),c=l.length,h=i&&n&&o;for(s=0;s<c;s++)a=l[s],(h||a instanceof e||(r=a.target===a.vars.onComplete)&&n||i&&!r)&&(t?a.totalTime(a._reversed?0:a.totalDuration()):a._enabled(!1,!1))},r.killChildTweensOf=function(t,e){if(null!=t){var o,c,h,p,u,d=a.tweenLookup;if("string"==typeof t&&(t=i.selector(t)||t),s(t)&&(t=n(t)),l(t))for(p=t.length;--p>-1;)r.killChildTweensOf(t[p],e);else{o=[];for(h in d)for(c=d[h].target.parentNode;c;)c===t&&(o=o.concat(d[h].tweens)),c=c.parentNode;for(u=o.length,p=0;p<u;p++)e&&o[p].totalTime(o[p].totalDuration()),o[p]._enabled(!1,!1)}}};var d=function(t,i,n,o){i=!1!==i,n=!1!==n;for(var r,a,s=u(o=!1!==o),l=i&&n&&o,c=s.length;--c>-1;)a=s[c],(l||a instanceof e||(r=a.target===a.vars.onComplete)&&n||i&&!r)&&a.paused(t)};return r.pauseAll=function(t,e,i){d(!0,t,e,i)},r.resumeAll=function(t,e,i){d(!1,t,e,i)},r.globalTimeScale=function(e){var n=t._rootTimeline,o=i.ticker.time;return arguments.length?(e=e||1e-10,n._startTime=o-(o-n._startTime)*n._timeScale/e,n=t._rootFramesTimeline,o=i.ticker.frame,n._startTime=o-(o-n._startTime)*n._timeScale/e,n._timeScale=t._rootTimeline._timeScale=e,e):n._timeScale},c.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!=(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),e):this._time/this.duration()},c.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this._totalTime/this.totalDuration()},c.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),t>this._duration&&(t=this._duration),this._yoyo&&0!=(1&this._cycle)?t=this._duration-t+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(t+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(t,e)):this._time},c.duration=function(e){return arguments.length?t.prototype.duration.call(this,e):this._duration},c.totalDuration=function(t){return arguments.length?-1===this._repeat?this:this.duration((t-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},c.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},c.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},c.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},r},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var n=function(t){e.call(this,t),this._labels={},this.autoRemoveChildren=!0===this.vars.autoRemoveChildren,this.smoothChildTiming=!0===this.vars.smoothChildTiming,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var i,n,o=this.vars;for(n in o)i=o[n],s(i)&&-1!==i.join("").indexOf("{self}")&&(o[n]=this._swapSelfInParams(i));s(o.tweens)&&this.add(o.tweens,0,o.align,o.stagger)},o=i._internals,r=n._internals={},a=o.isSelector,s=o.isArray,l=o.lazyTweens,c=o.lazyRender,h=_gsScope._gsDefine.globals,p=function(t){var e,i={};for(e in t)i[e]=t[e];return i},u=function(t,e,i){var n,o,r=t.cycle;for(n in r)o=r[n],t[n]="function"==typeof o?o(i,e[i]):o[i%o.length];delete t.cycle},d=r.pauseCallback=function(){},f=function(t){var e,i=[],n=t.length;for(e=0;e!==n;i.push(t[e++]));return i},m=n.prototype=new e;return n.version="1.19.1",m.constructor=n,m.kill()._gc=m._forcingPlayhead=m._hasPause=!1,m.to=function(t,e,n,o){var r=n.repeat&&h.TweenMax||i;return e?this.add(new r(t,e,n),o):this.set(t,n,o)},m.from=function(t,e,n,o){return this.add((n.repeat&&h.TweenMax||i).from(t,e,n),o)},m.fromTo=function(t,e,n,o,r){var a=o.repeat&&h.TweenMax||i;return e?this.add(a.fromTo(t,e,n,o),r):this.set(t,o,r)},m.staggerTo=function(t,e,o,r,s,l,c,h){var d,m,g=new n({onComplete:l,onCompleteParams:c,callbackScope:h,smoothChildTiming:this.smoothChildTiming}),y=o.cycle;for("string"==typeof t&&(t=i.selector(t)||t),a(t=t||[])&&(t=f(t)),(r=r||0)<0&&((t=f(t)).reverse(),r*=-1),m=0;m<t.length;m++)(d=p(o)).startAt&&(d.startAt=p(d.startAt),d.startAt.cycle&&u(d.startAt,t,m)),y&&(u(d,t,m),null!=d.duration&&(e=d.duration,delete d.duration)),g.to(t[m],e,d,m*r);return this.add(g,s)},m.staggerFrom=function(t,e,i,n,o,r,a,s){return i.immediateRender=0!=i.immediateRender,i.runBackwards=!0,this.staggerTo(t,e,i,n,o,r,a,s)},m.staggerFromTo=function(t,e,i,n,o,r,a,s,l){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,this.staggerTo(t,e,n,o,r,a,s,l)},m.call=function(t,e,n,o){return this.add(i.delayedCall(0,t,e,n),o)},m.set=function(t,e,n){return n=this._parseTimeOrLabel(n,0,!0),null==e.immediateRender&&(e.immediateRender=n===this._time&&!this._paused),this.add(new i(t,0,e),n)},n.exportRoot=function(t,e){null==(t=t||{}).smoothChildTiming&&(t.smoothChildTiming=!0);var o,r,a=new n(t),s=a._timeline;for(null==e&&(e=!0),s._remove(a,!0),a._startTime=0,a._rawPrevTime=a._time=a._totalTime=s._time,o=s._first;o;)r=o._next,e&&o instanceof i&&o.target===o.vars.onComplete||a.add(o,o._startTime-o._delay),o=r;return s.add(a,0),a},m.add=function(o,r,a,l){var c,h,p,u,d,f;if("number"!=typeof r&&(r=this._parseTimeOrLabel(r,0,!0,o)),!(o instanceof t)){if(o instanceof Array||o&&o.push&&s(o)){for(a=a||"normal",l=l||0,c=r,h=o.length,p=0;p<h;p++)s(u=o[p])&&(u=new n({tweens:u})),this.add(u,c),"string"!=typeof u&&"function"!=typeof u&&("sequence"===a?c=u._startTime+u.totalDuration()/u._timeScale:"start"===a&&(u._startTime-=u.delay())),c+=l;return this._uncache(!0)}if("string"==typeof o)return this.addLabel(o,r);if("function"!=typeof o)throw"Cannot add "+o+" into the timeline; it is not a tween, timeline, function, or string.";o=i.delayedCall(0,o)}if(e.prototype.add.call(this,o,r),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(f=(d=this).rawTime()>o._startTime;d._timeline;)f&&d._timeline.smoothChildTiming?d.totalTime(d._totalTime,!0):d._gc&&d._enabled(!0,!1),d=d._timeline;return this},m.remove=function(e){if(e instanceof t){this._remove(e,!1);var i=e._timeline=e.vars.useFrames?t._rootFramesTimeline:t._rootTimeline;return e._startTime=(e._paused?e._pauseTime:i._time)-(e._reversed?e.totalDuration()-e._totalTime:e._totalTime)/e._timeScale,this}if(e instanceof Array||e&&e.push&&s(e)){for(var n=e.length;--n>-1;)this.remove(e[n]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},m._remove=function(t,i){return e.prototype._remove.call(this,t,i),this._last?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},m.append=function(t,e){return this.add(t,this._parseTimeOrLabel(null,e,!0,t))},m.insert=m.insertMultiple=function(t,e,i,n){return this.add(t,e||0,i,n)},m.appendMultiple=function(t,e,i,n){return this.add(t,this._parseTimeOrLabel(null,e,!0,t),i,n)},m.addLabel=function(t,e){return this._labels[t]=this._parseTimeOrLabel(e),this},m.addPause=function(t,e,n,o){var r=i.delayedCall(0,d,n,o||this);return r.vars.onComplete=r.vars.onReverseComplete=e,r.data="isPause",this._hasPause=!0,this.add(r,t)},m.removeLabel=function(t){return delete this._labels[t],this},m.getLabelTime=function(t){return null!=this._labels[t]?this._labels[t]:-1},m._parseTimeOrLabel=function(e,i,n,o){var r;if(o instanceof t&&o.timeline===this)this.remove(o);else if(o&&(o instanceof Array||o.push&&s(o)))for(r=o.length;--r>-1;)o[r]instanceof t&&o[r].timeline===this&&this.remove(o[r]);if("string"==typeof i)return this._parseTimeOrLabel(i,n&&"number"==typeof e&&null==this._labels[i]?e-this.duration():0,n);if(i=i||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=this.duration());else{if(-1===(r=e.indexOf("=")))return null==this._labels[e]?n?this._labels[e]=this.duration()+i:i:this._labels[e]+i;i=parseInt(e.charAt(r-1)+"1",10)*Number(e.substr(r+1)),e=r>1?this._parseTimeOrLabel(e.substr(0,r-1),0,n):this.duration()}return Number(e)+i},m.seek=function(t,e){return this.totalTime("number"==typeof t?t:this._parseTimeOrLabel(t),!1!==e)},m.stop=function(){return this.paused(!0)},m.gotoAndPlay=function(t,e){return this.play(t,e)},m.gotoAndStop=function(t,e){return this.pause(t,e)},m.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var n,o,r,a,s,h,p,u=this._dirty?this.totalDuration():this._totalDuration,d=this._time,f=this._startTime,m=this._timeScale,g=this._paused;if(t>=u-1e-7&&t>=0)this._totalTime=this._time=u,this._reversed||this._hasPausedChild()||(o=!0,a="onComplete",s=!!this._timeline.autoRemoveChildren,0===this._duration&&(t<=0&&t>=-1e-7||this._rawPrevTime<0||1e-10===this._rawPrevTime)&&this._rawPrevTime!==t&&this._first&&(s=!0,this._rawPrevTime>1e-10&&(a="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:1e-10,t=u+1e-4;else if(t<1e-7)if(this._totalTime=this._time=0,(0!==d||0===this._duration&&1e-10!==this._rawPrevTime&&(this._rawPrevTime>0||t<0&&this._rawPrevTime>=0))&&(a="onReverseComplete",o=this._reversed),t<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(s=o=!0,a="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(s=!0),this._rawPrevTime=t;else{if(this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:1e-10,0===t&&o)for(n=this._first;n&&0===n._startTime;)n._duration||(o=!1),n=n._next;t=0,this._initted||(s=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!e){if(t>=d)for(n=this._first;n&&n._startTime<=t&&!h;)n._duration||"isPause"!==n.data||n.ratio||0===n._startTime&&0===this._rawPrevTime||(h=n),n=n._next;else for(n=this._last;n&&n._startTime>=t&&!h;)n._duration||"isPause"===n.data&&n._rawPrevTime>0&&(h=n),n=n._prev;h&&(this._time=t=h._startTime,this._totalTime=t+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=t}if(this._time!==d&&this._first||i||s||h){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==d&&t>0&&(this._active=!0),0===d&&this.vars.onStart&&(0===this._time&&this._duration||e||this._callback("onStart")),(p=this._time)>=d)for(n=this._first;n&&(r=n._next,p===this._time&&(!this._paused||g));)(n._active||n._startTime<=p&&!n._paused&&!n._gc)&&(h===n&&this.pause(),n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,i):n.render((t-n._startTime)*n._timeScale,e,i)),n=r;else for(n=this._last;n&&(r=n._prev,p===this._time&&(!this._paused||g));){if(n._active||n._startTime<=d&&!n._paused&&!n._gc){if(h===n){for(h=n._prev;h&&h.endTime()>this._time;)h.render(h._reversed?h.totalDuration()-(t-h._startTime)*h._timeScale:(t-h._startTime)*h._timeScale,e,i),h=h._prev;h=null,this.pause()}n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,i):n.render((t-n._startTime)*n._timeScale,e,i)}n=r}this._onUpdate&&(e||(l.length&&c(),this._callback("onUpdate"))),a&&(this._gc||f!==this._startTime&&m===this._timeScale||(0===this._time||u>=this.totalDuration())&&(o&&(l.length&&c(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[a]&&this._callback(a)))}},m._hasPausedChild=function(){for(var t=this._first;t;){if(t._paused||t instanceof n&&t._hasPausedChild())return!0;t=t._next}return!1},m.getChildren=function(t,e,n,o){o=o||-9999999999;for(var r=[],a=this._first,s=0;a;)a._startTime<o||(a instanceof i?!1!==e&&(r[s++]=a):(!1!==n&&(r[s++]=a),!1!==t&&(s=(r=r.concat(a.getChildren(!0,e,n))).length))),a=a._next;return r},m.getTweensOf=function(t,e){var n,o,r=this._gc,a=[],s=0;for(r&&this._enabled(!0,!0),o=(n=i.getTweensOf(t)).length;--o>-1;)(n[o].timeline===this||e&&this._contains(n[o]))&&(a[s++]=n[o]);return r&&this._enabled(!1,!0),a},m.recent=function(){return this._recent},m._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},m.shiftChildren=function(t,e,i){i=i||0;for(var n,o=this._first,r=this._labels;o;)o._startTime>=i&&(o._startTime+=t),o=o._next;if(e)for(n in r)r[n]>=i&&(r[n]+=t);return this._uncache(!0)},m._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var i=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),n=i.length,o=!1;--n>-1;)i[n]._kill(t,e)&&(o=!0);return o},m.clear=function(t){var e=this.getChildren(!1,!0,!0),i=e.length;for(this._time=this._totalTime=0;--i>-1;)e[i]._enabled(!1,!1);return!1!==t&&(this._labels={}),this._uncache(!0)},m.invalidate=function(){for(var e=this._first;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},m._enabled=function(t,i){if(t===this._gc)for(var n=this._first;n;)n._enabled(t,!0),n=n._next;return e.prototype._enabled.call(this,t,i)},m.totalTime=function(e,i,n){this._forcingPlayhead=!0;var o=t.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,o},m.duration=function(t){return arguments.length?(0!==this.duration()&&0!==t&&this.timeScale(this._duration/t),this):(this._dirty&&this.totalDuration(),this._duration)},m.totalDuration=function(t){if(!arguments.length){if(this._dirty){for(var e,i,n=0,o=this._last,r=999999999999;o;)e=o._prev,o._dirty&&o.totalDuration(),o._startTime>r&&this._sortChildren&&!o._paused?this.add(o,o._startTime-o._delay):r=o._startTime,o._startTime<0&&!o._paused&&(n-=o._startTime,this._timeline.smoothChildTiming&&(this._startTime+=o._startTime/this._timeScale),this.shiftChildren(-o._startTime,!1,-9999999999),r=0),(i=o._startTime+o._totalDuration/o._timeScale)>n&&(n=i),o=e;this._duration=this._totalDuration=n,this._dirty=!1}return this._totalDuration}return t&&this.totalDuration()?this.timeScale(this._totalDuration/t):this},m.paused=function(e){if(!e)for(var i=this._first,n=this._time;i;)i._startTime===n&&"isPause"===i.data&&(i._rawPrevTime=0),i=i._next;return t.prototype.paused.apply(this,arguments)},m.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===t._rootFramesTimeline},m.rawTime=function(t){return t&&(this._paused||this._repeat&&this.time()>0&&this.totalProgress()<1)?this._totalTime%(this._duration+this._repeatDelay):this._paused?this._totalTime:(this._timeline.rawTime(t)-this._startTime)*this._timeScale},n},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(t,e,i){var n=function(e){t.call(this,e),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=!0===this.vars.yoyo,this._dirty=!0},o=e._internals,r=o.lazyTweens,a=o.lazyRender,s=_gsScope._gsDefine.globals,l=new i(null,null,1,0),c=n.prototype=new t;return c.constructor=n,c.kill()._gc=!1,n.version="1.19.1",c.invalidate=function(){return this._yoyo=!0===this.vars.yoyo,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),t.prototype.invalidate.call(this)},c.addCallback=function(t,i,n,o){return this.add(e.delayedCall(0,t,n,o),i)},c.removeCallback=function(t,e){if(t)if(null==e)this._kill(null,t);else for(var i=this.getTweensOf(t,!1),n=i.length,o=this._parseTimeOrLabel(e);--n>-1;)i[n]._startTime===o&&i[n]._enabled(!1,!1);return this},c.removePause=function(e){return this.removeCallback(t._internals.pauseCallback,e)},c.tweenTo=function(t,i){i=i||{};var n,o,r,a={ease:l,useFrames:this.usesFrames(),immediateRender:!1},c=i.repeat&&s.TweenMax||e;for(o in i)a[o]=i[o];return a.time=this._parseTimeOrLabel(t),n=Math.abs(Number(a.time)-this._time)/this._timeScale||.001,r=new c(this,n,a),a.onStart=function(){r.target.paused(!0),r.vars.time!==r.target.time()&&n===r.duration()&&r.duration(Math.abs(r.vars.time-r.target.time())/r.target._timeScale),i.onStart&&i.onStart.apply(i.onStartScope||i.callbackScope||r,i.onStartParams||[])},r},c.tweenFromTo=function(t,e,i){i=i||{},t=this._parseTimeOrLabel(t),i.startAt={onComplete:this.seek,onCompleteParams:[t],callbackScope:this},i.immediateRender=!1!==i.immediateRender;var n=this.tweenTo(e,i);return n.duration(Math.abs(n.vars.time-t)/this._timeScale||.001)},c.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var n,o,s,l,c,h,p,u,d=this._dirty?this.totalDuration():this._totalDuration,f=this._duration,m=this._time,g=this._totalTime,y=this._startTime,v=this._timeScale,b=this._rawPrevTime,w=this._paused,x=this._cycle;if(t>=d-1e-7&&t>=0)this._locked||(this._totalTime=d,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(o=!0,l="onComplete",c=!!this._timeline.autoRemoveChildren,0===this._duration&&(t<=0&&t>=-1e-7||b<0||1e-10===b)&&b!==t&&this._first&&(c=!0,b>1e-10&&(l="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:1e-10,this._yoyo&&0!=(1&this._cycle)?this._time=t=0:(this._time=f,t=f+1e-4);else if(t<1e-7)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==m||0===f&&1e-10!==b&&(b>0||t<0&&b>=0)&&!this._locked)&&(l="onReverseComplete",o=this._reversed),t<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(c=o=!0,l="onReverseComplete"):b>=0&&this._first&&(c=!0),this._rawPrevTime=t;else{if(this._rawPrevTime=f||!e||t||this._rawPrevTime===t?t:1e-10,0===t&&o)for(n=this._first;n&&0===n._startTime;)n._duration||(o=!1),n=n._next;t=0,this._initted||(c=!0)}else if(0===f&&b<0&&(c=!0),this._time=this._rawPrevTime=t,this._locked||(this._totalTime=t,0!==this._repeat&&(h=f+this._repeatDelay,this._cycle=this._totalTime/h>>0,0!==this._cycle&&this._cycle===this._totalTime/h&&g<=t&&this._cycle--,this._time=this._totalTime-this._cycle*h,this._yoyo&&0!=(1&this._cycle)&&(this._time=f-this._time),this._time>f?(this._time=f,t=f+1e-4):this._time<0?this._time=t=0:t=this._time)),this._hasPause&&!this._forcingPlayhead&&!e&&t<f){if((t=this._time)>=m||this._repeat&&x!==this._cycle)for(n=this._first;n&&n._startTime<=t&&!p;)n._duration||"isPause"!==n.data||n.ratio||0===n._startTime&&0===this._rawPrevTime||(p=n),n=n._next;else for(n=this._last;n&&n._startTime>=t&&!p;)n._duration||"isPause"===n.data&&n._rawPrevTime>0&&(p=n),n=n._prev;p&&(this._time=t=p._startTime,this._totalTime=t+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==x&&!this._locked){var _=this._yoyo&&0!=(1&x),S=_===(this._yoyo&&0!=(1&this._cycle)),T=this._totalTime,P=this._cycle,C=this._rawPrevTime,I=this._time;if(this._totalTime=x*f,this._cycle<x?_=!_:this._totalTime+=f,this._time=m,this._rawPrevTime=0===f?b-1e-4:b,this._cycle=x,this._locked=!0,m=_?0:f,this.render(m,e,0===f),e||this._gc||this.vars.onRepeat&&(this._cycle=P,this._locked=!1,this._callback("onRepeat")),m!==this._time)return;if(S&&(this._cycle=x,this._locked=!0,m=_?f+1e-4:-1e-4,this.render(m,!0,!1)),this._locked=!1,this._paused&&!w)return;this._time=I,this._totalTime=T,this._cycle=P,this._rawPrevTime=C}if(this._time!==m&&this._first||i||c||p){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==g&&t>0&&(this._active=!0),0===g&&this.vars.onStart&&(0===this._totalTime&&this._totalDuration||e||this._callback("onStart")),(u=this._time)>=m)for(n=this._first;n&&(s=n._next,u===this._time&&(!this._paused||w));)(n._active||n._startTime<=this._time&&!n._paused&&!n._gc)&&(p===n&&this.pause(),n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,i):n.render((t-n._startTime)*n._timeScale,e,i)),n=s;else for(n=this._last;n&&(s=n._prev,u===this._time&&(!this._paused||w));){if(n._active||n._startTime<=m&&!n._paused&&!n._gc){if(p===n){for(p=n._prev;p&&p.endTime()>this._time;)p.render(p._reversed?p.totalDuration()-(t-p._startTime)*p._timeScale:(t-p._startTime)*p._timeScale,e,i),p=p._prev;p=null,this.pause()}n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,i):n.render((t-n._startTime)*n._timeScale,e,i)}n=s}this._onUpdate&&(e||(r.length&&a(),this._callback("onUpdate"))),l&&(this._locked||this._gc||y!==this._startTime&&v===this._timeScale||(0===this._time||d>=this.totalDuration())&&(o&&(r.length&&a(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[l]&&this._callback(l)))}else g!==this._totalTime&&this._onUpdate&&(e||this._callback("onUpdate"))},c.getActive=function(t,e,i){null==t&&(t=!0),null==e&&(e=!0),null==i&&(i=!1);var n,o,r=[],a=this.getChildren(t,e,i),s=0,l=a.length;for(n=0;n<l;n++)(o=a[n]).isActive()&&(r[s++]=o);return r},c.getLabelAfter=function(t){t||0!==t&&(t=this._time);var e,i=this.getLabelsArray(),n=i.length;for(e=0;e<n;e++)if(i[e].time>t)return i[e].name;return null},c.getLabelBefore=function(t){null==t&&(t=this._time);for(var e=this.getLabelsArray(),i=e.length;--i>-1;)if(e[i].time<t)return e[i].name;return null},c.getLabelsArray=function(){var t,e=[],i=0;for(t in this._labels)e[i++]={time:this._labels[t],name:t};return e.sort(function(t,e){return t.time-e.time}),e},c.invalidate=function(){return this._locked=!1,t.prototype.invalidate.call(this)},c.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!=(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),e):this._time/this.duration()},c.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this._totalTime/this.totalDuration()},c.totalDuration=function(e){return arguments.length?-1!==this._repeat&&e?this.timeScale(this.totalDuration()/e):this:(this._dirty&&(t.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},c.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),t>this._duration&&(t=this._duration),this._yoyo&&0!=(1&this._cycle)?t=this._duration-t+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(t+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(t,e)):this._time},c.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},c.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},c.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},c.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.getLabelBefore(this._time+1e-8)},n},!0),function(){var t=180/Math.PI,e=[],i=[],n=[],o={},r=_gsScope._gsDefine.globals,a=function(t,e,i,n){i===n&&(i=n-(n-e)/1e6),t===e&&(e=t+(i-t)/1e6),this.a=t,this.b=e,this.c=i,this.d=n,this.da=n-t,this.ca=i-t,this.ba=e-t},s=function(t,e,i,n){var o={a:t},r={},a={},s={c:n},l=(t+e)/2,c=(e+i)/2,h=(i+n)/2,p=(l+c)/2,u=(c+h)/2,d=(u-p)/8;return o.b=l+(t-l)/4,r.b=p+d,o.c=r.a=(o.b+r.b)/2,r.c=a.a=(p+u)/2,a.b=u-d,s.b=h+(n-h)/4,a.c=s.a=(a.b+s.b)/2,[o,r,a,s]},l=function(t,o,r,a,l){var c,h,p,u,d,f,m,g,y,v,b,w,x,_=t.length-1,S=0,T=t[0].a;for(c=0;c<_;c++)h=(d=t[S]).a,p=d.d,u=t[S+1].d,l?(b=e[c],x=((w=i[c])+b)*o*.25/(a?.5:n[c]||.5),g=p-((f=p-(p-h)*(a?.5*o:0!==b?x/b:0))+(((m=p+(u-p)*(a?.5*o:0!==w?x/w:0))-f)*(3*b/(b+w)+.5)/4||0))):g=p-((f=p-(p-h)*o*.5)+(m=p+(u-p)*o*.5))/2,f+=g,m+=g,d.c=y=f,d.b=0!==c?T:T=d.a+.6*(d.c-d.a),d.da=p-h,d.ca=y-h,d.ba=T-h,r?(v=s(h,T,y,p),t.splice(S,1,v[0],v[1],v[2],v[3]),S+=4):S++,T=m;(d=t[S]).b=T,d.c=T+.4*(d.d-T),d.da=d.d-d.a,d.ca=d.c-d.a,d.ba=T-d.a,r&&(v=s(d.a,T,d.c,d.d),t.splice(S,1,v[0],v[1],v[2],v[3]))},c=function(t,n,o,r){var s,l,c,h,p,u,d=[];if(r)for(l=(t=[r].concat(t)).length;--l>-1;)"string"==typeof(u=t[l][n])&&"="===u.charAt(1)&&(t[l][n]=r[n]+Number(u.charAt(0)+u.substr(2)));if((s=t.length-2)<0)return d[0]=new a(t[0][n],0,0,t[s<-1?0:1][n]),d;for(l=0;l<s;l++)c=t[l][n],h=t[l+1][n],d[l]=new a(c,0,0,h),o&&(p=t[l+2][n],e[l]=(e[l]||0)+(h-c)*(h-c),i[l]=(i[l]||0)+(p-h)*(p-h));return d[l]=new a(t[l][n],0,0,t[l+1][n]),d},h=function(t,r,a,s,h,p){var u,d,f,m,g,y,v,b,w={},x=[],_=p||t[0];h="string"==typeof h?","+h+",":",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",null==r&&(r=1);for(d in t[0])x.push(d);if(t.length>1){for(b=t[t.length-1],v=!0,u=x.length;--u>-1;)if(d=x[u],Math.abs(_[d]-b[d])>.05){v=!1;break}v&&(t=t.concat(),p&&t.unshift(p),t.push(t[1]),p=t[t.length-3])}for(e.length=i.length=n.length=0,u=x.length;--u>-1;)d=x[u],o[d]=-1!==h.indexOf(","+d+","),w[d]=c(t,d,o[d],p);for(u=e.length;--u>-1;)e[u]=Math.sqrt(e[u]),i[u]=Math.sqrt(i[u]);if(!s){for(u=x.length;--u>-1;)if(o[d])for(y=(f=w[x[u]]).length-1,m=0;m<y;m++)g=f[m+1].da/i[m]+f[m].da/e[m]||0,n[m]=(n[m]||0)+g*g;for(u=n.length;--u>-1;)n[u]=Math.sqrt(n[u])}for(u=x.length,m=a?4:1;--u>-1;)f=w[d=x[u]],l(f,r,a,s,o[d]),v&&(f.splice(0,m),f.splice(f.length-m,m));return w},p=function(t,e,i){var n,o,r,s,l,c,h,p,u,d,f,m={},g="cubic"===(e=e||"soft")?3:2,y="soft"===e,v=[];if(y&&i&&(t=[i].concat(t)),null==t||t.length<g+1)throw"invalid Bezier data";for(u in t[0])v.push(u);for(c=v.length;--c>-1;){for(m[u=v[c]]=l=[],d=0,p=t.length,h=0;h<p;h++)n=null==i?t[h][u]:"string"==typeof(f=t[h][u])&&"="===f.charAt(1)?i[u]+Number(f.charAt(0)+f.substr(2)):Number(f),y&&h>1&&h<p-1&&(l[d++]=(n+l[d-2])/2),l[d++]=n;for(p=d-g+1,d=0,h=0;h<p;h+=g)n=l[h],o=l[h+1],r=l[h+2],s=2===g?0:l[h+3],l[d++]=f=3===g?new a(n,o,r,s):new a(n,(2*o+n)/3,(2*o+r)/3,r);l.length=d}return m},u=function(t,e,i){for(var n,o,r,a,s,l,c,h,p,u,d,f=1/i,m=t.length;--m>-1;)for(r=(u=t[m]).a,a=u.d-r,s=u.c-r,l=u.b-r,n=o=0,h=1;h<=i;h++)n=o-(o=((c=f*h)*c*a+3*(p=1-c)*(c*s+p*l))*c),e[d=m*i+h-1]=(e[d]||0)+n*n},d=function(t,e){var i,n,o,r,a=[],s=[],l=0,c=0,h=(e=e>>0||6)-1,p=[],d=[];for(i in t)u(t[i],a,e);for(o=a.length,n=0;n<o;n++)l+=Math.sqrt(a[n]),d[r=n%e]=l,r===h&&(c+=l,p[r=n/e>>0]=d,s[r]=c,l=0,d=[]);return{length:c,lengths:s,segments:p}},f=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.7",API:2,global:!0,init:function(t,e,i){this._target=t,e instanceof Array&&(e={values:e}),this._func={},this._mod={},this._props=[],this._timeRes=null==e.timeResolution?6:parseInt(e.timeResolution,10);var n,o,r,a,s,l=e.values||[],c={},u=l[0],f=e.autoRotate||i.vars.orientToBezier;this._autoRotate=f?f instanceof Array?f:[["x","y","rotation",!0===f?0:Number(f)||0]]:null;for(n in u)this._props.push(n);for(r=this._props.length;--r>-1;)n=this._props[r],this._overwriteProps.push(n),o=this._func[n]="function"==typeof t[n],c[n]=o?t[n.indexOf("set")||"function"!=typeof t["get"+n.substr(3)]?n:"get"+n.substr(3)]():parseFloat(t[n]),s||c[n]!==l[0][n]&&(s=c);if(this._beziers="cubic"!==e.type&&"quadratic"!==e.type&&"soft"!==e.type?h(l,isNaN(e.curviness)?1:e.curviness,!1,"thruBasic"===e.type,e.correlate,s):p(l,e.type,c),this._segCount=this._beziers[n].length,this._timeRes){var m=d(this._beziers,this._timeRes);this._length=m.length,this._lengths=m.lengths,this._segments=m.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(f=this._autoRotate)for(this._initialRotations=[],f[0]instanceof Array||(this._autoRotate=f=[f]),r=f.length;--r>-1;){for(a=0;a<3;a++)n=f[r][a],this._func[n]="function"==typeof t[n]&&t[n.indexOf("set")||"function"!=typeof t["get"+n.substr(3)]?n:"get"+n.substr(3)];n=f[r][2],this._initialRotations[r]=(this._func[n]?this._func[n].call(this._target):this._target[n])||0,this._overwriteProps.push(n)}return this._startRatio=i.vars.runBackwards?1:0,!0},set:function(e){var i,n,o,r,a,s,l,c,h,p,u=this._segCount,d=this._func,f=this._target,m=e!==this._startRatio;if(this._timeRes){if(h=this._lengths,p=this._curSeg,e*=this._length,o=this._li,e>this._l2&&o<u-1){for(c=u-1;o<c&&(this._l2=h[++o])<=e;);this._l1=h[o-1],this._li=o,this._curSeg=p=this._segments[o],this._s2=p[this._s1=this._si=0]}else if(e<this._l1&&o>0){for(;o>0&&(this._l1=h[--o])>=e;);0===o&&e<this._l1?this._l1=0:o++,this._l2=h[o],this._li=o,this._curSeg=p=this._segments[o],this._s1=p[(this._si=p.length-1)-1]||0,this._s2=p[this._si]}if(i=o,e-=this._l1,o=this._si,e>this._s2&&o<p.length-1){for(c=p.length-1;o<c&&(this._s2=p[++o])<=e;);this._s1=p[o-1],this._si=o}else if(e<this._s1&&o>0){for(;o>0&&(this._s1=p[--o])>=e;);0===o&&e<this._s1?this._s1=0:o++,this._s2=p[o],this._si=o}s=(o+(e-this._s1)/(this._s2-this._s1))*this._prec||0}else s=(e-(i=e<0?0:e>=1?u-1:u*e>>0)*(1/u))*u;for(n=1-s,o=this._props.length;--o>-1;)r=this._props[o],l=(s*s*(a=this._beziers[r][i]).da+3*n*(s*a.ca+n*a.ba))*s+a.a,this._mod[r]&&(l=this._mod[r](l,f)),d[r]?f[r](l):f[r]=l;if(this._autoRotate){var g,y,v,b,w,x,_,S=this._autoRotate;for(o=S.length;--o>-1;)r=S[o][2],x=S[o][3]||0,_=!0===S[o][4]?1:t,a=this._beziers[S[o][0]],g=this._beziers[S[o][1]],a&&g&&(a=a[i],g=g[i],y=a.a+(a.b-a.a)*s,y+=((b=a.b+(a.c-a.b)*s)-y)*s,b+=(a.c+(a.d-a.c)*s-b)*s,v=g.a+(g.b-g.a)*s,v+=((w=g.b+(g.c-g.b)*s)-v)*s,w+=(g.c+(g.d-g.c)*s-w)*s,l=m?Math.atan2(w-v,b-y)*_+x:this._initialRotations[o],this._mod[r]&&(l=this._mod[r](l,f)),d[r]?f[r](l):f[r]=l)}}}),m=f.prototype;f.bezierThrough=h,f.cubicToQuadratic=s,f._autoCSS=!0,f.quadraticToCubic=function(t,e,i){return new a(t,(2*e+t)/3,(2*e+i)/3,i)},f._cssRegister=function(){var t=r.CSSPlugin;if(t){var e=t._internals,i=e._parseToProxy,n=e._setPluginRatio,o=e.CSSPropTween;e._registerComplexSpecialProp("bezier",{parser:function(t,e,r,a,s,l){e instanceof Array&&(e={values:e}),l=new f;var c,h,p,u=e.values,d=u.length-1,m=[],g={};if(d<0)return s;for(c=0;c<=d;c++)p=i(t,u[c],a,s,l,d!==c),m[c]=p.end;for(h in e)g[h]=e[h];return g.values=m,s=new o(t,"bezier",0,0,p.pt,2),s.data=p,s.plugin=l,s.setRatio=n,0===g.autoRotate&&(g.autoRotate=!0),!g.autoRotate||g.autoRotate instanceof Array||(c=!0===g.autoRotate?0:Number(g.autoRotate),g.autoRotate=null!=p.end.left?[["left","top","rotation",c,!1]]:null!=p.end.x&&[["x","y","rotation",c,!1]]),g.autoRotate&&(a._transform||a._enableTransforms(!1),p.autoRotate=a._target._gsTransform,p.proxy.rotation=p.autoRotate.rotation||0,a._overwriteProps.push("rotation")),l._onInitTween(p.proxy,g,a._tween),s}})}},m._mod=function(t){for(var e,i=this._overwriteProps,n=i.length;--n>-1;)(e=t[i[n]])&&"function"==typeof e&&(this._mod[i[n]]=e)},m._kill=function(t){var e,i,n=this._props;for(e in this._beziers)if(e in t)for(delete this._beziers[e],delete this._func[e],i=n.length;--i>-1;)n[i]===e&&n.splice(i,1);if(n=this._autoRotate)for(i=n.length;--i>-1;)t[n[i][2]]&&n.splice(i,1);return this._super._kill.call(this,t)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(t,e){var i,n,o,r,a=function(){t.call(this,"css"),this._overwriteProps.length=0,this.setRatio=a.prototype.setRatio},s=_gsScope._gsDefine.globals,l={},c=a.prototype=new t("css");c.constructor=a,a.version="1.19.1",a.API=2,a.defaultTransformPerspective=0,a.defaultSkewType="compensated",a.defaultSmoothOrigin=!0,c="px",a.suffixMap={top:c,right:c,bottom:c,left:c,width:c,height:c,fontSize:c,padding:c,margin:c,perspective:c,lineHeight:""};var h,p,u,d,f,m,g,y,v=/(?:\-|\.|\b)(\d|\.|e\-)+/g,b=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,w=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,x=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,_=/(?:\d|\-|\+|=|#|\.)*/g,S=/opacity *= *([^)]*)/i,T=/opacity:([^;]*)/i,P=/alpha\(opacity *=.+?\)/i,C=/^(rgb|hsl)/,I=/([A-Z])/g,k=/-([a-z])/gi,A=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,M=function(t,e){return e.toUpperCase()},O=/(?:Left|Right|Width)/i,R=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,B=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,G=/,(?=[^\)]*(?:\(|$))/gi,E=/[\s,\(]/i,D=Math.PI/180,L=180/Math.PI,j={},F={style:{}},N=_gsScope.document||{createElement:function(){return F}},X=function(t,e){return N.createElementNS?N.createElementNS(e||"http://www.w3.org/1999/xhtml",t):N.createElement(t)},U=X("div"),V=X("img"),H=a._internals={_specialProps:l},q=(_gsScope.navigator||{}).userAgent||"",z=function(){var t=q.indexOf("Android"),e=X("a");return u=-1!==q.indexOf("Safari")&&-1===q.indexOf("Chrome")&&(-1===t||parseFloat(q.substr(t+8,2))>3),f=u&&parseFloat(q.substr(q.indexOf("Version/")+8,2))<6,d=-1!==q.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(q)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(q))&&(m=parseFloat(RegExp.$1)),!!e&&(e.style.cssText="top:1px;opacity:.55;",/^0.55/.test(e.style.opacity))}(),W=function(t){return S.test("string"==typeof t?t:(t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100:1},Y=function(t){_gsScope.console&&console.log(t)},K="",Q="",Z=function(t,e){var i,n,o=(e=e||U).style;if(void 0!==o[t])return t;for(t=t.charAt(0).toUpperCase()+t.substr(1),i=["O","Moz","ms","Ms","Webkit"],n=5;--n>-1&&void 0===o[i[n]+t];);return n>=0?(Q=3===n?"ms":i[n],K="-"+Q.toLowerCase()+"-",Q+t):null},J=N.defaultView?N.defaultView.getComputedStyle:function(){},$=a.getStyle=function(t,e,i,n,o){var r;return z||"opacity"!==e?(!n&&t.style[e]?r=t.style[e]:(i=i||J(t))?r=i[e]||i.getPropertyValue(e)||i.getPropertyValue(e.replace(I,"-$1").toLowerCase()):t.currentStyle&&(r=t.currentStyle[e]),null==o||r&&"none"!==r&&"auto"!==r&&"auto auto"!==r?r:o):W(t)},tt=H.convertToPixels=function(t,i,n,o,r){if("px"===o||!o)return n;if("auto"===o||!n)return 0;var s,l,c,h=O.test(i),p=t,u=U.style,d=n<0,f=1===n;if(d&&(n=-n),f&&(n*=100),"%"===o&&-1!==i.indexOf("border"))s=n/100*(h?t.clientWidth:t.clientHeight);else{if(u.cssText="border:0 solid red;position:"+$(t,"position")+";line-height:0;","%"!==o&&p.appendChild&&"v"!==o.charAt(0)&&"rem"!==o)u[h?"borderLeftWidth":"borderTopWidth"]=n+o;else{if(p=t.parentNode||N.body,l=p._gsCache,c=e.ticker.frame,l&&h&&l.time===c)return l.width*n/100;u[h?"width":"height"]=n+o}p.appendChild(U),s=parseFloat(U[h?"offsetWidth":"offsetHeight"]),p.removeChild(U),h&&"%"===o&&!1!==a.cacheWidths&&((l=p._gsCache=p._gsCache||{}).time=c,l.width=s/n*100),0!==s||r||(s=tt(t,i,n,o,!0))}return f&&(s/=100),d?-s:s},et=H.calculateOffset=function(t,e,i){if("absolute"!==$(t,"position",i))return 0;var n="left"===e?"Left":"Top",o=$(t,"margin"+n,i);return t["offset"+n]-(tt(t,e,parseFloat(o),o.replace(_,""))||0)},it=function(t,e){var i,n,o,r={};if(e=e||J(t,null))if(i=e.length)for(;--i>-1;)-1!==(o=e[i]).indexOf("-transform")&&At!==o||(r[o.replace(k,M)]=e.getPropertyValue(o));else for(i in e)-1!==i.indexOf("Transform")&&kt!==i||(r[i]=e[i]);else if(e=t.currentStyle||t.style)for(i in e)"string"==typeof i&&void 0===r[i]&&(r[i.replace(k,M)]=e[i]);return z||(r.opacity=W(t)),n=Vt(t,e,!1),r.rotation=n.rotation,r.skewX=n.skewX,r.scaleX=n.scaleX,r.scaleY=n.scaleY,r.x=n.x,r.y=n.y,Ot&&(r.z=n.z,r.rotationX=n.rotationX,r.rotationY=n.rotationY,r.scaleZ=n.scaleZ),r.filters&&delete r.filters,r},nt=function(t,e,i,n,o){var r,a,s,l={},c=t.style;for(a in i)"cssText"!==a&&"length"!==a&&isNaN(a)&&(e[a]!==(r=i[a])||o&&o[a])&&-1===a.indexOf("Origin")&&("number"!=typeof r&&"string"!=typeof r||(l[a]="auto"!==r||"left"!==a&&"top"!==a?""!==r&&"auto"!==r&&"none"!==r||"string"!=typeof e[a]||""===e[a].replace(x,"")?r:0:et(t,a),void 0!==c[a]&&(s=new vt(c,a,c[a],s))));if(n)for(a in n)"className"!==a&&(l[a]=n[a]);return{difs:l,firstMPT:s}},ot={width:["Left","Right"],height:["Top","Bottom"]},rt=["marginLeft","marginRight","marginTop","marginBottom"],at=function(t,e,i){if("svg"===(t.nodeName+"").toLowerCase())return(i||J(t))[e]||0;if(t.getCTM&&Nt(t))return t.getBBox()[e]||0;var n=parseFloat("width"===e?t.offsetWidth:t.offsetHeight),o=ot[e],r=o.length;for(i=i||J(t,null);--r>-1;)n-=parseFloat($(t,"padding"+o[r],i,!0))||0,n-=parseFloat($(t,"border"+o[r]+"Width",i,!0))||0;return n},st=function(t,e){if("contain"===t||"auto"===t||"auto auto"===t)return t+" ";null!=t&&""!==t||(t="0 0");var i,n=t.split(" "),o=-1!==t.indexOf("left")?"0%":-1!==t.indexOf("right")?"100%":n[0],r=-1!==t.indexOf("top")?"0%":-1!==t.indexOf("bottom")?"100%":n[1];if(n.length>3&&!e){for(n=t.split(", ").join(",").split(","),t=[],i=0;i<n.length;i++)t.push(st(n[i]));return t.join(",")}return null==r?r="center"===o?"50%":"0":"center"===r&&(r="50%"),("center"===o||isNaN(parseFloat(o))&&-1===(o+"").indexOf("="))&&(o="50%"),t=o+" "+r+(n.length>2?" "+n[2]:""),e&&(e.oxp=-1!==o.indexOf("%"),e.oyp=-1!==r.indexOf("%"),e.oxr="="===o.charAt(1),e.oyr="="===r.charAt(1),e.ox=parseFloat(o.replace(x,"")),e.oy=parseFloat(r.replace(x,"")),e.v=t),e||t},lt=function(t,e){return"function"==typeof t&&(t=t(y,g)),"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2)):parseFloat(t)-parseFloat(e)||0},ct=function(t,e){return"function"==typeof t&&(t=t(y,g)),null==t?e:"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2))+e:parseFloat(t)||0},ht=function(t,e,i,n){var o,r,a,s,l;return"function"==typeof t&&(t=t(y,g)),null==t?s=e:"number"==typeof t?s=t:(o=360,r=t.split("_"),a=((l="="===t.charAt(1))?parseInt(t.charAt(0)+"1",10)*parseFloat(r[0].substr(2)):parseFloat(r[0]))*(-1===t.indexOf("rad")?1:L)-(l?0:e),r.length&&(n&&(n[i]=e+a),-1!==t.indexOf("short")&&(a%=o)!==a%(o/2)&&(a=a<0?a+o:a-o),-1!==t.indexOf("_cw")&&a<0?a=(a+9999999999*o)%o-(a/o|0)*o:-1!==t.indexOf("ccw")&&a>0&&(a=(a-9999999999*o)%o-(a/o|0)*o)),s=e+a),s<1e-6&&s>-1e-6&&(s=0),s},pt={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},ut=function(t,e,i){return 255*(6*(t=t<0?t+1:t>1?t-1:t)<1?e+(i-e)*t*6:t<.5?i:3*t<2?e+(i-e)*(2/3-t)*6:e)+.5|0},dt=a.parseColor=function(t,e){var i,n,o,r,a,s,l,c,h,p,u;if(t)if("number"==typeof t)i=[t>>16,t>>8&255,255&t];else{if(","===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),pt[t])i=pt[t];else if("#"===t.charAt(0))4===t.length&&(t="#"+(n=t.charAt(1))+n+(o=t.charAt(2))+o+(r=t.charAt(3))+r),i=[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t];else if("hsl"===t.substr(0,3))if(i=u=t.match(v),e){if(-1!==t.indexOf("="))return t.match(b)}else a=Number(i[0])%360/360,s=Number(i[1])/100,n=2*(l=Number(i[2])/100)-(o=l<=.5?l*(s+1):l+s-l*s),i.length>3&&(i[3]=Number(t[3])),i[0]=ut(a+1/3,n,o),i[1]=ut(a,n,o),i[2]=ut(a-1/3,n,o);else i=t.match(v)||pt.transparent;i[0]=Number(i[0]),i[1]=Number(i[1]),i[2]=Number(i[2]),i.length>3&&(i[3]=Number(i[3]))}else i=pt.black;return e&&!u&&(n=i[0]/255,o=i[1]/255,r=i[2]/255,l=((c=Math.max(n,o,r))+(h=Math.min(n,o,r)))/2,c===h?a=s=0:(p=c-h,s=l>.5?p/(2-c-h):p/(c+h),a=c===n?(o-r)/p+(o<r?6:0):c===o?(r-n)/p+2:(n-o)/p+4,a*=60),i[0]=a+.5|0,i[1]=100*s+.5|0,i[2]=100*l+.5|0),i},ft=function(t,e){var i,n,o,r=t.match(mt)||[],a=0,s=r.length?"":t;for(i=0;i<r.length;i++)n=r[i],a+=(o=t.substr(a,t.indexOf(n,a)-a)).length+n.length,3===(n=dt(n,e)).length&&n.push(1),s+=o+(e?"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+n[3]:"rgba("+n.join(","))+")";return s+t.substr(a)},mt="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(c in pt)mt+="|"+c+"\\b";mt=new RegExp(mt+")","gi"),a.colorStringFilter=function(t){var e,i=t[0]+t[1];mt.test(i)&&(e=-1!==i.indexOf("hsl(")||-1!==i.indexOf("hsla("),t[0]=ft(t[0],e),t[1]=ft(t[1],e)),mt.lastIndex=0},e.defaultStringFilter||(e.defaultStringFilter=a.colorStringFilter);var gt=function(t,e,i,n){if(null==t)return function(t){return t};var o,r=e?(t.match(mt)||[""])[0]:"",a=t.split(r).join("").match(w)||[],s=t.substr(0,t.indexOf(a[0])),l=")"===t.charAt(t.length-1)?")":"",c=-1!==t.indexOf(" ")?" ":",",h=a.length,p=h>0?a[0].replace(v,""):"";return h?o=e?function(t){var e,u,d,f;if("number"==typeof t)t+=p;else if(n&&G.test(t)){for(f=t.replace(G,"|").split("|"),d=0;d<f.length;d++)f[d]=o(f[d]);return f.join(",")}if(e=(t.match(mt)||[r])[0],u=t.split(e).join("").match(w)||[],d=u.length,h>d--)for(;++d<h;)u[d]=i?u[(d-1)/2|0]:a[d];return s+u.join(c)+c+e+l+(-1!==t.indexOf("inset")?" inset":"")}:function(t){var e,r,u;if("number"==typeof t)t+=p;else if(n&&G.test(t)){for(r=t.replace(G,"|").split("|"),u=0;u<r.length;u++)r[u]=o(r[u]);return r.join(",")}if(e=t.match(w)||[],u=e.length,h>u--)for(;++u<h;)e[u]=i?e[(u-1)/2|0]:a[u];return s+e.join(c)+l}:function(t){return t}},yt=function(t){return t=t.split(","),function(e,i,n,o,r,a,s){var l,c=(i+"").split(" ");for(s={},l=0;l<4;l++)s[t[l]]=c[l]=c[l]||c[(l-1)/2>>0];return o.parse(e,s,r,a)}},vt=(H._setPluginRatio=function(t){this.plugin.setRatio(t);for(var e,i,n,o,r,a=this.data,s=a.proxy,l=a.firstMPT;l;)e=s[l.v],l.r?e=Math.round(e):e<1e-6&&e>-1e-6&&(e=0),l.t[l.p]=e,l=l._next;if(a.autoRotate&&(a.autoRotate.rotation=a.mod?a.mod(s.rotation,this.t):s.rotation),1===t||0===t)for(l=a.firstMPT,r=1===t?"e":"b";l;){if((i=l.t).type){if(1===i.type){for(o=i.xs0+i.s+i.xs1,n=1;n<i.l;n++)o+=i["xn"+n]+i["xs"+(n+1)];i[r]=o}}else i[r]=i.s+i.xs0;l=l._next}},function(t,e,i,n,o){this.t=t,this.p=e,this.v=i,this.r=o,n&&(n._prev=this,this._next=n)}),bt=(H._parseToProxy=function(t,e,i,n,o,r){var a,s,l,c,h,p=n,u={},d={},f=i._transform,m=j;for(i._transform=null,j=e,n=h=i.parse(t,e,n,o),j=m,r&&(i._transform=f,p&&(p._prev=null,p._prev&&(p._prev._next=null)));n&&n!==p;){if(n.type<=1&&(s=n.p,d[s]=n.s+n.c,u[s]=n.s,r||(c=new vt(n,"s",s,c,n.r),n.c=0),1===n.type))for(a=n.l;--a>0;)l="xn"+a,d[s=n.p+"_"+l]=n.data[l],u[s]=n[l],r||(c=new vt(n,l,s,c,n.rxp[l]));n=n._next}return{proxy:u,end:d,firstMPT:c,pt:h}},H.CSSPropTween=function(t,e,n,o,a,s,l,c,h,p,u){this.t=t,this.p=e,this.s=n,this.c=o,this.n=l||e,t instanceof bt||r.push(this.n),this.r=c,this.type=s||0,h&&(this.pr=h,i=!0),this.b=void 0===p?n:p,this.e=void 0===u?n+o:u,a&&(this._next=a,a._prev=this)}),wt=function(t,e,i,n,o,r){var a=new bt(t,e,i,n-i,o,-1,r);return a.b=i,a.e=a.xs0=n,a},xt=a.parseComplex=function(t,e,i,n,o,r,s,l,c,p){i=i||r||"","function"==typeof n&&(n=n(y,g)),s=new bt(t,e,0,0,s,p?2:1,null,!1,l,i,n),n+="",o&&mt.test(n+i)&&(n=[i,n],a.colorStringFilter(n),i=n[0],n=n[1]);var u,d,f,m,w,x,_,S,T,P,C,I,k,A=i.split(", ").join(",").split(" "),M=n.split(", ").join(",").split(" "),O=A.length,R=!1!==h;for(-1===n.indexOf(",")&&-1===i.indexOf(",")||(A=A.join(" ").replace(G,", ").split(" "),M=M.join(" ").replace(G,", ").split(" "),O=A.length),O!==M.length&&(O=(A=(r||"").split(" ")).length),s.plugin=c,s.setRatio=p,mt.lastIndex=0,u=0;u<O;u++)if(m=A[u],w=M[u],(S=parseFloat(m))||0===S)s.appendXtra("",S,lt(w,S),w.replace(b,""),R&&-1!==w.indexOf("px"),!0);else if(o&&mt.test(m))I=")"+((I=w.indexOf(")")+1)?w.substr(I):""),k=-1!==w.indexOf("hsl")&&z,m=dt(m,k),w=dt(w,k),(T=m.length+w.length>6)&&!z&&0===w[3]?(s["xs"+s.l]+=s.l?" transparent":"transparent",s.e=s.e.split(M[u]).join("transparent")):(z||(T=!1),k?s.appendXtra(T?"hsla(":"hsl(",m[0],lt(w[0],m[0]),",",!1,!0).appendXtra("",m[1],lt(w[1],m[1]),"%,",!1).appendXtra("",m[2],lt(w[2],m[2]),T?"%,":"%"+I,!1):s.appendXtra(T?"rgba(":"rgb(",m[0],w[0]-m[0],",",!0,!0).appendXtra("",m[1],w[1]-m[1],",",!0).appendXtra("",m[2],w[2]-m[2],T?",":I,!0),T&&(m=m.length<4?1:m[3],s.appendXtra("",m,(w.length<4?1:w[3])-m,I,!1))),mt.lastIndex=0;else if(x=m.match(v)){if(!(_=w.match(b))||_.length!==x.length)return s;for(f=0,d=0;d<x.length;d++)C=x[d],P=m.indexOf(C,f),s.appendXtra(m.substr(f,P-f),Number(C),lt(_[d],C),"",R&&"px"===m.substr(P+C.length,2),0===d),f=P+C.length;s["xs"+s.l]+=m.substr(f)}else s["xs"+s.l]+=s.l||s["xs"+s.l]?" "+w:w;if(-1!==n.indexOf("=")&&s.data){for(I=s.xs0+s.data.s,u=1;u<s.l;u++)I+=s["xs"+u]+s.data["xn"+u];s.e=I+s["xs"+u]}return s.l||(s.type=-1,s.xs0=s.e),s.xfirst||s},_t=9;for((c=bt.prototype).l=c.pr=0;--_t>0;)c["xn"+_t]=0,c["xs"+_t]="";c.xs0="",c._next=c._prev=c.xfirst=c.data=c.plugin=c.setRatio=c.rxp=null,c.appendXtra=function(t,e,i,n,o,r){var a=this,s=a.l;return a["xs"+s]+=r&&(s||a["xs"+s])?" "+t:t||"",i||0===s||a.plugin?(a.l++,a.type=a.setRatio?2:1,a["xs"+a.l]=n||"",s>0?(a.data["xn"+s]=e+i,a.rxp["xn"+s]=o,a["xn"+s]=e,a.plugin||(a.xfirst=new bt(a,"xn"+s,e,i,a.xfirst||a,0,a.n,o,a.pr),a.xfirst.xs0=0),a):(a.data={s:e+i},a.rxp={},a.s=e,a.c=i,a.r=o,a)):(a["xs"+s]+=e+(n||""),a)};var St=function(t,e){e=e||{},this.p=e.prefix?Z(t)||t:t,l[t]=l[this.p]=this,this.format=e.formatter||gt(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},Tt=H._registerComplexSpecialProp=function(t,e,i){"object"!=typeof e&&(e={parser:i});var n,o=t.split(","),r=e.defaultValue;for(i=i||[r],n=0;n<o.length;n++)e.prefix=0===n&&e.prefix,e.defaultValue=i[n]||r,new St(o[n],e)},Pt=H._registerPluginProp=function(t){if(!l[t]){var e=t.charAt(0).toUpperCase()+t.substr(1)+"Plugin";Tt(t,{parser:function(t,i,n,o,r,a,c){var h=s.com.greensock.plugins[e];return h?(h._cssRegister(),l[n].parse(t,i,n,o,r,a,c)):(Y("Error: "+e+" js file not loaded."),r)}})}};(c=St.prototype).parseComplex=function(t,e,i,n,o,r){var a,s,l,c,h,p,u=this.keyword;if(this.multi&&(G.test(i)||G.test(e)?(s=e.replace(G,"|").split("|"),l=i.replace(G,"|").split("|")):u&&(s=[e],l=[i])),l){for(c=l.length>s.length?l.length:s.length,a=0;a<c;a++)e=s[a]=s[a]||this.dflt,i=l[a]=l[a]||this.dflt,u&&(h=e.indexOf(u))!==(p=i.indexOf(u))&&(-1===p?s[a]=s[a].split(u).join(""):-1===h&&(s[a]+=" "+u));e=s.join(", "),i=l.join(", ")}return xt(t,this.p,e,i,this.clrs,this.dflt,n,this.pr,o,r)},c.parse=function(t,e,i,n,r,a,s){return this.parseComplex(t.style,this.format($(t,this.p,o,!1,this.dflt)),this.format(e),r,a)},a.registerSpecialProp=function(t,e,i){Tt(t,{parser:function(t,n,o,r,a,s,l){var c=new bt(t,o,0,0,a,2,o,!1,i);return c.plugin=s,c.setRatio=e(t,n,r._tween,o),c},priority:i})},a.useSVGTransformAttr=!0;var Ct,It="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),kt=Z("transform"),At=K+"transform",Mt=Z("transformOrigin"),Ot=null!==Z("perspective"),Rt=H.Transform=function(){this.perspective=parseFloat(a.defaultTransformPerspective)||0,this.force3D=!(!1===a.defaultForce3D||!Ot)&&(a.defaultForce3D||"auto")},Bt=_gsScope.SVGElement,Gt=function(t,e,i){var n,o=N.createElementNS("http://www.w3.org/2000/svg",t),r=/([a-z])([A-Z])/g;for(n in i)o.setAttributeNS(null,n.replace(r,"$1-$2").toLowerCase(),i[n]);return e.appendChild(o),o},Et=N.documentElement||{},Dt=function(){var t,e,i,n=m||/Android/i.test(q)&&!_gsScope.chrome;return N.createElementNS&&!n&&(t=Gt("svg",Et),i=(e=Gt("rect",t,{width:100,height:50,x:100})).getBoundingClientRect().width,e.style[Mt]="50% 50%",e.style[kt]="scaleX(0.5)",n=i===e.getBoundingClientRect().width&&!(d&&Ot),Et.removeChild(t)),n}(),Lt=function(t,e,i,n,o,r){var s,l,c,h,p,u,d,f,m,g,y,v,b,w,x=t._gsTransform,_=Ut(t,!0);x&&(b=x.xOrigin,w=x.yOrigin),(!n||(s=n.split(" ")).length<2)&&(0===(d=t.getBBox()).x&&0===d.y&&d.width+d.height===0&&(d={x:parseFloat(t.hasAttribute("x")?t.getAttribute("x"):t.hasAttribute("cx")?t.getAttribute("cx"):0)||0,y:parseFloat(t.hasAttribute("y")?t.getAttribute("y"):t.hasAttribute("cy")?t.getAttribute("cy"):0)||0,width:0,height:0}),s=[(-1!==(e=st(e).split(" "))[0].indexOf("%")?parseFloat(e[0])/100*d.width:parseFloat(e[0]))+d.x,(-1!==e[1].indexOf("%")?parseFloat(e[1])/100*d.height:parseFloat(e[1]))+d.y]),i.xOrigin=h=parseFloat(s[0]),i.yOrigin=p=parseFloat(s[1]),n&&_!==Xt&&(u=_[0],d=_[1],f=_[2],m=_[3],g=_[4],y=_[5],(v=u*m-d*f)&&(l=h*(m/v)+p*(-f/v)+(f*y-m*g)/v,c=h*(-d/v)+p*(u/v)-(u*y-d*g)/v,h=i.xOrigin=s[0]=l,p=i.yOrigin=s[1]=c)),x&&(r&&(i.xOffset=x.xOffset,i.yOffset=x.yOffset,x=i),o||!1!==o&&!1!==a.defaultSmoothOrigin?(l=h-b,c=p-w,x.xOffset+=l*_[0]+c*_[2]-l,x.yOffset+=l*_[1]+c*_[3]-c):x.xOffset=x.yOffset=0),r||t.setAttribute("data-svg-origin",s.join(" "))},jt=function(t){var e,i=X("svg",this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,o=this.nextSibling,r=this.style.cssText;if(Et.appendChild(i),i.appendChild(this),this.style.display="block",t)try{e=this.getBBox(),this._originalGetBBox=this.getBBox,this.getBBox=jt}catch(t){}else this._originalGetBBox&&(e=this._originalGetBBox());return o?n.insertBefore(this,o):n.appendChild(this),Et.removeChild(i),this.style.cssText=r,e},Ft=function(t){try{return t.getBBox()}catch(e){return jt.call(t,!0)}},Nt=function(t){return!(!(Bt&&t.getCTM&&Ft(t))||t.parentNode&&!t.ownerSVGElement)},Xt=[1,0,0,1,0,0],Ut=function(t,e){var i,n,o,r,a,s,l=t._gsTransform||new Rt,c=t.style;if(kt?n=$(t,At,null,!0):t.currentStyle&&(n=(n=t.currentStyle.filter.match(R))&&4===n.length?[n[0].substr(4),Number(n[2].substr(4)),Number(n[1].substr(4)),n[3].substr(4),l.x||0,l.y||0].join(","):""),(i=!n||"none"===n||"matrix(1, 0, 0, 1, 0, 0)"===n)&&kt&&((s="none"===J(t).display)||!t.parentNode)&&(s&&(r=c.display,c.display="block"),t.parentNode||(a=1,Et.appendChild(t)),i=!(n=$(t,At,null,!0))||"none"===n||"matrix(1, 0, 0, 1, 0, 0)"===n,r?c.display=r:s&&Wt(c,"display"),a&&Et.removeChild(t)),(l.svg||t.getCTM&&Nt(t))&&(i&&-1!==(c[kt]+"").indexOf("matrix")&&(n=c[kt],i=0),o=t.getAttribute("transform"),i&&o&&(-1!==o.indexOf("matrix")?(n=o,i=0):-1!==o.indexOf("translate")&&(n="matrix(1,0,0,1,"+o.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",i=0))),i)return Xt;for(o=(n||"").match(v)||[],_t=o.length;--_t>-1;)r=Number(o[_t]),o[_t]=(a=r-(r|=0))?(1e5*a+(a<0?-.5:.5)|0)/1e5+r:r;return e&&o.length>6?[o[0],o[1],o[4],o[5],o[12],o[13]]:o},Vt=H.getTransform=function(t,i,n,o){if(t._gsTransform&&n&&!o)return t._gsTransform;var r,s,l,c,h,p,u=n?t._gsTransform||new Rt:new Rt,d=u.scaleX<0,f=Ot?parseFloat($(t,Mt,i,!1,"0 0 0").split(" ")[2])||u.zOrigin||0:0,m=parseFloat(a.defaultTransformPerspective)||0;if(u.svg=!(!t.getCTM||!Nt(t)),u.svg&&(Lt(t,$(t,Mt,i,!1,"50% 50%")+"",u,t.getAttribute("data-svg-origin")),Ct=a.useSVGTransformAttr||Dt),(r=Ut(t))!==Xt){if(16===r.length){var g,y,v,b,w,x=r[0],_=r[1],S=r[2],T=r[3],P=r[4],C=r[5],I=r[6],k=r[7],A=r[8],M=r[9],O=r[10],R=r[12],B=r[13],G=r[14],E=r[11],D=Math.atan2(I,O);u.zOrigin&&(R=A*(G=-u.zOrigin)-r[12],B=M*G-r[13],G=O*G+u.zOrigin-r[14]),u.rotationX=D*L,D&&(g=P*(b=Math.cos(-D))+A*(w=Math.sin(-D)),y=C*b+M*w,v=I*b+O*w,A=P*-w+A*b,M=C*-w+M*b,O=I*-w+O*b,E=k*-w+E*b,P=g,C=y,I=v),D=Math.atan2(-S,O),u.rotationY=D*L,D&&(y=_*(b=Math.cos(-D))-M*(w=Math.sin(-D)),v=S*b-O*w,M=_*w+M*b,O=S*w+O*b,E=T*w+E*b,x=g=x*b-A*w,_=y,S=v),D=Math.atan2(_,x),u.rotation=D*L,D&&(x=x*(b=Math.cos(-D))+P*(w=Math.sin(-D)),y=_*b+C*w,C=_*-w+C*b,I=S*-w+I*b,_=y),u.rotationX&&Math.abs(u.rotationX)+Math.abs(u.rotation)>359.9&&(u.rotationX=u.rotation=0,u.rotationY=180-u.rotationY),u.scaleX=(1e5*Math.sqrt(x*x+_*_)+.5|0)/1e5,u.scaleY=(1e5*Math.sqrt(C*C+M*M)+.5|0)/1e5,u.scaleZ=(1e5*Math.sqrt(I*I+O*O)+.5|0)/1e5,u.rotationX||u.rotationY?u.skewX=0:(u.skewX=P||C?Math.atan2(P,C)*L+u.rotation:u.skewX||0,Math.abs(u.skewX)>90&&Math.abs(u.skewX)<270&&(d?(u.scaleX*=-1,u.skewX+=u.rotation<=0?180:-180,u.rotation+=u.rotation<=0?180:-180):(u.scaleY*=-1,u.skewX+=u.skewX<=0?180:-180))),u.perspective=E?1/(E<0?-E:E):0,u.x=R,u.y=B,u.z=G,u.svg&&(u.x-=u.xOrigin-(u.xOrigin*x-u.yOrigin*P),u.y-=u.yOrigin-(u.yOrigin*_-u.xOrigin*C))}else if(!Ot||o||!r.length||u.x!==r[4]||u.y!==r[5]||!u.rotationX&&!u.rotationY){var j=r.length>=6,F=j?r[0]:1,N=r[1]||0,X=r[2]||0,U=j?r[3]:1;u.x=r[4]||0,u.y=r[5]||0,l=Math.sqrt(F*F+N*N),c=Math.sqrt(U*U+X*X),h=F||N?Math.atan2(N,F)*L:u.rotation||0,p=X||U?Math.atan2(X,U)*L+h:u.skewX||0,Math.abs(p)>90&&Math.abs(p)<270&&(d?(l*=-1,p+=h<=0?180:-180,h+=h<=0?180:-180):(c*=-1,p+=p<=0?180:-180)),u.scaleX=l,u.scaleY=c,u.rotation=h,u.skewX=p,Ot&&(u.rotationX=u.rotationY=u.z=0,u.perspective=m,u.scaleZ=1),u.svg&&(u.x-=u.xOrigin-(u.xOrigin*F+u.yOrigin*X),u.y-=u.yOrigin-(u.xOrigin*N+u.yOrigin*U))}u.zOrigin=f;for(s in u)u[s]<2e-5&&u[s]>-2e-5&&(u[s]=0)}return n&&(t._gsTransform=u,u.svg&&(Ct&&t.style[kt]?e.delayedCall(.001,function(){Wt(t.style,kt)}):!Ct&&t.getAttribute("transform")&&e.delayedCall(.001,function(){t.removeAttribute("transform")}))),u},Ht=function(t){var e,i,n=this.data,o=-n.rotation*D,r=o+n.skewX*D,a=(Math.cos(o)*n.scaleX*1e5|0)/1e5,s=(Math.sin(o)*n.scaleX*1e5|0)/1e5,l=(Math.sin(r)*-n.scaleY*1e5|0)/1e5,c=(Math.cos(r)*n.scaleY*1e5|0)/1e5,h=this.t.style,p=this.t.currentStyle;if(p){i=s,s=-l,l=-i,e=p.filter,h.filter="";var u,d,f=this.t.offsetWidth,g=this.t.offsetHeight,y="absolute"!==p.position,v="progid:DXImageTransform.Microsoft.Matrix(M11="+a+", M12="+s+", M21="+l+", M22="+c,b=n.x+f*n.xPercent/100,w=n.y+g*n.yPercent/100;if(null!=n.ox&&(b+=(u=(n.oxp?f*n.ox*.01:n.ox)-f/2)-(u*a+(d=(n.oyp?g*n.oy*.01:n.oy)-g/2)*s),w+=d-(u*l+d*c)),v+=y?", Dx="+((u=f/2)-(u*a+(d=g/2)*s)+b)+", Dy="+(d-(u*l+d*c)+w)+")":", sizingMethod='auto expand')",-1!==e.indexOf("DXImageTransform.Microsoft.Matrix(")?h.filter=e.replace(B,v):h.filter=v+" "+e,0!==t&&1!==t||1===a&&0===s&&0===l&&1===c&&(y&&-1===v.indexOf("Dx=0, Dy=0")||S.test(e)&&100!==parseFloat(RegExp.$1)||-1===e.indexOf(e.indexOf("Alpha"))&&h.removeAttribute("filter")),!y){var x,T,P,C=m<8?1:-1;for(u=n.ieOffsetX||0,d=n.ieOffsetY||0,n.ieOffsetX=Math.round((f-((a<0?-a:a)*f+(s<0?-s:s)*g))/2+b),n.ieOffsetY=Math.round((g-((c<0?-c:c)*g+(l<0?-l:l)*f))/2+w),_t=0;_t<4;_t++)P=(i=-1!==(x=p[T=rt[_t]]).indexOf("px")?parseFloat(x):tt(this.t,T,parseFloat(x),x.replace(_,""))||0)!==n[T]?_t<2?-n.ieOffsetX:-n.ieOffsetY:_t<2?u-n.ieOffsetX:d-n.ieOffsetY,h[T]=(n[T]=Math.round(i-P*(0===_t||2===_t?1:C)))+"px"}}},qt=H.set3DTransformRatio=H.setTransformRatio=function(t){var e,i,n,o,r,a,s,l,c,h,p,u,f,m,g,y,v,b,w,x,_,S=this.data,T=this.t.style,P=S.rotation,C=S.rotationX,I=S.rotationY,k=S.scaleX,A=S.scaleY,M=S.scaleZ,O=S.x,R=S.y,B=S.z,G=S.svg,E=S.perspective,L=S.force3D,j=S.skewY,F=S.skewX;if(j&&(F+=j,P+=j),!((1!==t&&0!==t||"auto"!==L||this.tween._totalTime!==this.tween._totalDuration&&this.tween._totalTime)&&L||B||E||I||C||1!==M)||Ct&&G||!Ot)P||F||G?(P*=D,x=F*D,_=1e5,i=Math.cos(P)*k,r=Math.sin(P)*k,n=Math.sin(P-x)*-A,a=Math.cos(P-x)*A,x&&"simple"===S.skewType&&(e=Math.tan(x-j*D),n*=e=Math.sqrt(1+e*e),a*=e,j&&(e=Math.tan(j*D),i*=e=Math.sqrt(1+e*e),r*=e)),G&&(O+=S.xOrigin-(S.xOrigin*i+S.yOrigin*n)+S.xOffset,R+=S.yOrigin-(S.xOrigin*r+S.yOrigin*a)+S.yOffset,Ct&&(S.xPercent||S.yPercent)&&(g=this.t.getBBox(),O+=.01*S.xPercent*g.width,R+=.01*S.yPercent*g.height),O<(g=1e-6)&&O>-g&&(O=0),R<g&&R>-g&&(R=0)),w=(i*_|0)/_+","+(r*_|0)/_+","+(n*_|0)/_+","+(a*_|0)/_+","+O+","+R+")",G&&Ct?this.t.setAttribute("transform","matrix("+w):T[kt]=(S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) matrix(":"matrix(")+w):T[kt]=(S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) matrix(":"matrix(")+k+",0,0,"+A+","+O+","+R+")";else{if(d&&(k<(g=1e-4)&&k>-g&&(k=M=2e-5),A<g&&A>-g&&(A=M=2e-5),!E||S.z||S.rotationX||S.rotationY||(E=0)),P||F)P*=D,y=i=Math.cos(P),v=r=Math.sin(P),F&&(P-=F*D,y=Math.cos(P),v=Math.sin(P),"simple"===S.skewType&&(e=Math.tan((F-j)*D),y*=e=Math.sqrt(1+e*e),v*=e,S.skewY&&(e=Math.tan(j*D),i*=e=Math.sqrt(1+e*e),r*=e))),n=-v,a=y;else{if(!(I||C||1!==M||E||G))return void(T[kt]=(S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) translate3d(":"translate3d(")+O+"px,"+R+"px,"+B+"px)"+(1!==k||1!==A?" scale("+k+","+A+")":""));i=a=1,n=r=0}h=1,o=s=l=c=p=u=0,f=E?-1/E:0,m=S.zOrigin,g=1e-6,",","0",(P=I*D)&&(y=Math.cos(P),l=-(v=Math.sin(P)),p=f*-v,o=i*v,s=r*v,h=y,f*=y,i*=y,r*=y),(P=C*D)&&(e=n*(y=Math.cos(P))+o*(v=Math.sin(P)),b=a*y+s*v,c=h*v,u=f*v,o=n*-v+o*y,s=a*-v+s*y,h*=y,f*=y,n=e,a=b),1!==M&&(o*=M,s*=M,h*=M,f*=M),1!==A&&(n*=A,a*=A,c*=A,u*=A),1!==k&&(i*=k,r*=k,l*=k,p*=k),(m||G)&&(m&&(O+=o*-m,R+=s*-m,B+=h*-m+m),G&&(O+=S.xOrigin-(S.xOrigin*i+S.yOrigin*n)+S.xOffset,R+=S.yOrigin-(S.xOrigin*r+S.yOrigin*a)+S.yOffset),O<g&&O>-g&&(O="0"),R<g&&R>-g&&(R="0"),B<g&&B>-g&&(B=0)),w=S.xPercent||S.yPercent?"translate("+S.xPercent+"%,"+S.yPercent+"%) matrix3d(":"matrix3d(",w+=(i<g&&i>-g?"0":i)+","+(r<g&&r>-g?"0":r)+","+(l<g&&l>-g?"0":l),w+=","+(p<g&&p>-g?"0":p)+","+(n<g&&n>-g?"0":n)+","+(a<g&&a>-g?"0":a),C||I||1!==M?(w+=","+(c<g&&c>-g?"0":c)+","+(u<g&&u>-g?"0":u)+","+(o<g&&o>-g?"0":o),w+=","+(s<g&&s>-g?"0":s)+","+(h<g&&h>-g?"0":h)+","+(f<g&&f>-g?"0":f)+","):w+=",0,0,0,0,1,0,",w+=O+","+R+","+B+","+(E?1+-B/E:1)+")",T[kt]=w}};(c=Rt.prototype).x=c.y=c.z=c.skewX=c.skewY=c.rotation=c.rotationX=c.rotationY=c.zOrigin=c.xPercent=c.yPercent=c.xOffset=c.yOffset=0,c.scaleX=c.scaleY=c.scaleZ=1,Tt("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(t,e,i,n,r,s,l){if(n._lastParsedTransform===l)return r;n._lastParsedTransform=l;var c,h=l.scale&&"function"==typeof l.scale?l.scale:0;"function"==typeof l[i]&&(c=l[i],l[i]=e),h&&(l.scale=h(y,t));var p,u,d,f,m,v,b,w,x,_=t._gsTransform,S=t.style,T=It.length,P=l,C={},I=Vt(t,o,!0,P.parseTransform),k=P.transform&&("function"==typeof P.transform?P.transform(y,g):P.transform);if(n._transform=I,k&&"string"==typeof k&&kt)(u=U.style)[kt]=k,u.display="block",u.position="absolute",N.body.appendChild(U),p=Vt(U,null,!1),I.svg&&(v=I.xOrigin,b=I.yOrigin,p.x-=I.xOffset,p.y-=I.yOffset,(P.transformOrigin||P.svgOrigin)&&(k={},Lt(t,st(P.transformOrigin),k,P.svgOrigin,P.smoothOrigin,!0),v=k.xOrigin,b=k.yOrigin,p.x-=k.xOffset-I.xOffset,p.y-=k.yOffset-I.yOffset),(v||b)&&(w=Ut(U,!0),p.x-=v-(v*w[0]+b*w[2]),p.y-=b-(v*w[1]+b*w[3]))),N.body.removeChild(U),p.perspective||(p.perspective=I.perspective),null!=P.xPercent&&(p.xPercent=ct(P.xPercent,I.xPercent)),null!=P.yPercent&&(p.yPercent=ct(P.yPercent,I.yPercent));else if("object"==typeof P){if(p={scaleX:ct(null!=P.scaleX?P.scaleX:P.scale,I.scaleX),scaleY:ct(null!=P.scaleY?P.scaleY:P.scale,I.scaleY),scaleZ:ct(P.scaleZ,I.scaleZ),x:ct(P.x,I.x),y:ct(P.y,I.y),z:ct(P.z,I.z),xPercent:ct(P.xPercent,I.xPercent),yPercent:ct(P.yPercent,I.yPercent),perspective:ct(P.transformPerspective,I.perspective)},null!=(m=P.directionalRotation))if("object"==typeof m)for(u in m)P[u]=m[u];else P.rotation=m;"string"==typeof P.x&&-1!==P.x.indexOf("%")&&(p.x=0,p.xPercent=ct(P.x,I.xPercent)),"string"==typeof P.y&&-1!==P.y.indexOf("%")&&(p.y=0,p.yPercent=ct(P.y,I.yPercent)),p.rotation=ht("rotation"in P?P.rotation:"shortRotation"in P?P.shortRotation+"_short":"rotationZ"in P?P.rotationZ:I.rotation,I.rotation,"rotation",C),Ot&&(p.rotationX=ht("rotationX"in P?P.rotationX:"shortRotationX"in P?P.shortRotationX+"_short":I.rotationX||0,I.rotationX,"rotationX",C),p.rotationY=ht("rotationY"in P?P.rotationY:"shortRotationY"in P?P.shortRotationY+"_short":I.rotationY||0,I.rotationY,"rotationY",C)),p.skewX=ht(P.skewX,I.skewX),p.skewY=ht(P.skewY,I.skewY)}for(Ot&&null!=P.force3D&&(I.force3D=P.force3D,f=!0),I.skewType=P.skewType||I.skewType||a.defaultSkewType,(d=I.force3D||I.z||I.rotationX||I.rotationY||p.z||p.rotationX||p.rotationY||p.perspective)||null==P.scale||(p.scaleZ=1);--T>-1;)((k=p[x=It[T]]-I[x])>1e-6||k<-1e-6||null!=P[x]||null!=j[x])&&(f=!0,r=new bt(I,x,I[x],k,r),x in C&&(r.e=C[x]),r.xs0=0,r.plugin=s,n._overwriteProps.push(r.n));return k=P.transformOrigin,I.svg&&(k||P.svgOrigin)&&(v=I.xOffset,b=I.yOffset,Lt(t,st(k),p,P.svgOrigin,P.smoothOrigin),r=wt(I,"xOrigin",(_?I:p).xOrigin,p.xOrigin,r,"transformOrigin"),r=wt(I,"yOrigin",(_?I:p).yOrigin,p.yOrigin,r,"transformOrigin"),v===I.xOffset&&b===I.yOffset||(r=wt(I,"xOffset",_?v:I.xOffset,I.xOffset,r,"transformOrigin"),r=wt(I,"yOffset",_?b:I.yOffset,I.yOffset,r,"transformOrigin")),k="0px 0px"),(k||Ot&&d&&I.zOrigin)&&(kt?(f=!0,x=Mt,k=(k||$(t,x,o,!1,"50% 50%"))+"",(r=new bt(S,x,0,0,r,-1,"transformOrigin")).b=S[x],r.plugin=s,Ot?(u=I.zOrigin,k=k.split(" "),I.zOrigin=(k.length>2&&(0===u||"0px"!==k[2])?parseFloat(k[2]):u)||0,r.xs0=r.e=k[0]+" "+(k[1]||"50%")+" 0px",(r=new bt(I,"zOrigin",0,0,r,-1,r.n)).b=u,r.xs0=r.e=I.zOrigin):r.xs0=r.e=k):st(k+"",I)),f&&(n._transformType=I.svg&&Ct||!d&&3!==this._transformType?2:3),c&&(l[i]=c),h&&(l.scale=h),r},prefix:!0}),Tt("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),Tt("borderRadius",{defaultValue:"0px",parser:function(t,e,i,r,a,s){e=this.format(e);var l,c,h,p,u,d,f,m,g,y,v,b,w,x,_,S,T=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],P=t.style;for(g=parseFloat(t.offsetWidth),y=parseFloat(t.offsetHeight),l=e.split(" "),c=0;c<T.length;c++)this.p.indexOf("border")&&(T[c]=Z(T[c])),-1!==(u=p=$(t,T[c],o,!1,"0px")).indexOf(" ")&&(u=(p=u.split(" "))[0],p=p[1]),d=h=l[c],f=parseFloat(u),b=u.substr((f+"").length),(w="="===d.charAt(1))?(m=parseInt(d.charAt(0)+"1",10),d=d.substr(2),m*=parseFloat(d),v=d.substr((m+"").length-(m<0?1:0))||""):(m=parseFloat(d),v=d.substr((m+"").length)),""===v&&(v=n[i]||b),v!==b&&(x=tt(t,"borderLeft",f,b),_=tt(t,"borderTop",f,b),"%"===v?(u=x/g*100+"%",p=_/y*100+"%"):"em"===v?(u=x/(S=tt(t,"borderLeft",1,"em"))+"em",p=_/S+"em"):(u=x+"px",p=_+"px"),w&&(d=parseFloat(u)+m+v,h=parseFloat(p)+m+v)),a=xt(P,T[c],u+" "+p,d+" "+h,!1,"0px",a);return a},prefix:!0,formatter:gt("0px 0px 0px 0px",!1,!0)}),Tt("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(t,e,i,n,r,a){return xt(t.style,i,this.format($(t,i,o,!1,"0px 0px")),this.format(e),!1,"0px",r)},prefix:!0,formatter:gt("0px 0px",!1,!0)}),Tt("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,i,n,r,a){var s,l,c,h,p,u,d="background-position",f=o||J(t,null),g=this.format((f?m?f.getPropertyValue(d+"-x")+" "+f.getPropertyValue(d+"-y"):f.getPropertyValue(d):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),y=this.format(e);if(-1!==g.indexOf("%")!=(-1!==y.indexOf("%"))&&y.split(",").length<2&&(u=$(t,"backgroundImage").replace(A,""))&&"none"!==u){for(s=g.split(" "),l=y.split(" "),V.setAttribute("src",u),c=2;--c>-1;)(h=-1!==(g=s[c]).indexOf("%"))!==(-1!==l[c].indexOf("%"))&&(p=0===c?t.offsetWidth-V.width:t.offsetHeight-V.height,s[c]=h?parseFloat(g)/100*p+"px":parseFloat(g)/p*100+"%");g=s.join(" ")}return this.parseComplex(t.style,g,y,r,a)},formatter:st}),Tt("backgroundSize",{defaultValue:"0 0",formatter:function(t){return t+="",st(-1===t.indexOf(" ")?t+" "+t:t)}}),Tt("perspective",{defaultValue:"0px",prefix:!0}),Tt("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),Tt("transformStyle",{prefix:!0}),Tt("backfaceVisibility",{prefix:!0}),Tt("userSelect",{prefix:!0}),Tt("margin",{parser:yt("marginTop,marginRight,marginBottom,marginLeft")}),Tt("padding",{parser:yt("paddingTop,paddingRight,paddingBottom,paddingLeft")}),Tt("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,i,n,r,a){var s,l,c;return m<9?(l=t.currentStyle,c=m<8?" ":",",s="rect("+l.clipTop+c+l.clipRight+c+l.clipBottom+c+l.clipLeft+")",e=this.format(e).split(",").join(c)):(s=this.format($(t,this.p,o,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,s,e,r,a)}}),Tt("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),Tt("autoRound,strictUnits",{parser:function(t,e,i,n,o){return o}}),Tt("border",{defaultValue:"0px solid #000",parser:function(t,e,i,n,r,a){var s=$(t,"borderTopWidth",o,!1,"0px"),l=this.format(e).split(" "),c=l[0].replace(_,"");return"px"!==c&&(s=parseFloat(s)/tt(t,"borderTopWidth",1,c)+c),this.parseComplex(t.style,this.format(s+" "+$(t,"borderTopStyle",o,!1,"solid")+" "+$(t,"borderTopColor",o,!1,"#000")),l.join(" "),r,a)},color:!0,formatter:function(t){var e=t.split(" ");return e[0]+" "+(e[1]||"solid")+" "+(t.match(mt)||["#000"])[0]}}),Tt("borderWidth",{parser:yt("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),Tt("float,cssFloat,styleFloat",{parser:function(t,e,i,n,o,r){var a=t.style,s="cssFloat"in a?"cssFloat":"styleFloat";return new bt(a,s,0,0,o,-1,i,!1,0,a[s],e)}});var zt=function(t){var e,i=this.t,n=i.filter||$(this.data,"filter")||"",o=this.s+this.c*t|0;100===o&&(-1===n.indexOf("atrix(")&&-1===n.indexOf("radient(")&&-1===n.indexOf("oader(")?(i.removeAttribute("filter"),e=!$(this.data,"filter")):(i.filter=n.replace(P,""),e=!0)),e||(this.xn1&&(i.filter=n=n||"alpha(opacity="+o+")"),-1===n.indexOf("pacity")?0===o&&this.xn1||(i.filter=n+" alpha(opacity="+o+")"):i.filter=n.replace(S,"opacity="+o))};Tt("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,i,n,r,a){var s=parseFloat($(t,"opacity",o,!1,"1")),l=t.style,c="autoAlpha"===i;return"string"==typeof e&&"="===e.charAt(1)&&(e=("-"===e.charAt(0)?-1:1)*parseFloat(e.substr(2))+s),c&&1===s&&"hidden"===$(t,"visibility",o)&&0!==e&&(s=0),z?r=new bt(l,"opacity",s,e-s,r):((r=new bt(l,"opacity",100*s,100*(e-s),r)).xn1=c?1:0,l.zoom=1,r.type=2,r.b="alpha(opacity="+r.s+")",r.e="alpha(opacity="+(r.s+r.c)+")",r.data=t,r.plugin=a,r.setRatio=zt),c&&((r=new bt(l,"visibility",0,0,r,-1,null,!1,0,0!==s?"inherit":"hidden",0===e?"hidden":"inherit")).xs0="inherit",n._overwriteProps.push(r.n),n._overwriteProps.push(i)),r}});var Wt=function(t,e){e&&(t.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),t.removeProperty(e.replace(I,"-$1").toLowerCase())):t.removeAttribute(e))},Yt=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.setAttribute("class",0===t?this.b:this.e);for(var e=this.data,i=this.t.style;e;)e.v?i[e.p]=e.v:Wt(i,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};Tt("className",{parser:function(t,e,n,r,a,s,l){var c,h,p,u,d,f=t.getAttribute("class")||"",m=t.style.cssText;if(a=r._classNamePT=new bt(t,n,0,0,a,2),a.setRatio=Yt,a.pr=-11,i=!0,a.b=f,h=it(t,o),p=t._gsClassPT){for(u={},d=p.data;d;)u[d.p]=1,d=d._next;p.setRatio(1)}return t._gsClassPT=a,a.e="="!==e.charAt(1)?e:f.replace(new RegExp("(?:\\s|^)"+e.substr(2)+"(?![\\w-])"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),t.setAttribute("class",a.e),c=nt(t,h,it(t),l,u),t.setAttribute("class",f),a.data=c.firstMPT,t.style.cssText=m,a=a.xfirst=r.parse(t,c.difs,a,s)}});var Kt=function(t){if((1===t||0===t)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var e,i,n,o,r,a=this.t.style,s=l.transform.parse;if("all"===this.e)a.cssText="",o=!0;else for(n=(e=this.e.split(" ").join("").split(",")).length;--n>-1;)i=e[n],l[i]&&(l[i].parse===s?o=!0:i="transformOrigin"===i?Mt:l[i].p),Wt(a,i);o&&(Wt(a,kt),(r=this.t._gsTransform)&&(r.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(Tt("clearProps",{parser:function(t,e,n,o,r){return r=new bt(t,n,0,0,r,2),r.setRatio=Kt,r.e=e,r.pr=-10,r.data=o._tween,i=!0,r}}),c="bezier,throwProps,physicsProps,physics2D".split(","),_t=c.length;_t--;)Pt(c[_t]);(c=a.prototype)._firstPT=c._lastParsedTransform=c._transform=null,c._onInitTween=function(t,e,s,c){if(!t.nodeType)return!1;this._target=g=t,this._tween=s,this._vars=e,y=c,h=e.autoRound,i=!1,n=e.suffixMap||a.suffixMap,o=J(t,""),r=this._overwriteProps;var d,m,v,b,w,x,_,S,P,C=t.style;if(p&&""===C.zIndex&&("auto"!==(d=$(t,"zIndex",o))&&""!==d||this._addLazySet(C,"zIndex",0)),"string"==typeof e&&(b=C.cssText,d=it(t,o),C.cssText=b+";"+e,d=nt(t,d,it(t)).difs,!z&&T.test(e)&&(d.opacity=parseFloat(RegExp.$1)),e=d,C.cssText=b),e.className?this._firstPT=m=l.className.parse(t,e.className,"className",this,null,null,e):this._firstPT=m=this.parse(t,e,null),this._transformType){for(P=3===this._transformType,kt?u&&(p=!0,""===C.zIndex&&("auto"!==(_=$(t,"zIndex",o))&&""!==_||this._addLazySet(C,"zIndex",0)),f&&this._addLazySet(C,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(P?"visible":"hidden"))):C.zoom=1,v=m;v&&v._next;)v=v._next;S=new bt(t,"transform",0,0,null,2),this._linkCSSP(S,null,v),S.setRatio=kt?qt:Ht,S.data=this._transform||Vt(t,o,!0),S.tween=s,S.pr=-1,r.pop()}if(i){for(;m;){for(x=m._next,v=b;v&&v.pr>m.pr;)v=v._next;(m._prev=v?v._prev:w)?m._prev._next=m:b=m,(m._next=v)?v._prev=m:w=m,m=x}this._firstPT=b}return!0},c.parse=function(t,e,i,r){var a,s,c,p,u,d,f,m,v,b,w=t.style;for(a in e)"function"==typeof(d=e[a])&&(d=d(y,g)),(s=l[a])?i=s.parse(t,d,a,this,i,r,e):(u=$(t,a,o)+"",v="string"==typeof d,"color"===a||"fill"===a||"stroke"===a||-1!==a.indexOf("Color")||v&&C.test(d)?(v||(d=((d=dt(d)).length>3?"rgba(":"rgb(")+d.join(",")+")"),i=xt(w,a,u,d,!0,"transparent",i,0,r)):v&&E.test(d)?i=xt(w,a,u,d,!0,null,i,0,r):(f=(c=parseFloat(u))||0===c?u.substr((c+"").length):"",""!==u&&"auto"!==u||("width"===a||"height"===a?(c=at(t,a,o),f="px"):"left"===a||"top"===a?(c=et(t,a,o),f="px"):(c="opacity"!==a?0:1,f="")),(b=v&&"="===d.charAt(1))?(p=parseInt(d.charAt(0)+"1",10),d=d.substr(2),p*=parseFloat(d),m=d.replace(_,"")):(p=parseFloat(d),m=v?d.replace(_,""):""),""===m&&(m=a in n?n[a]:f),d=p||0===p?(b?p+c:p)+m:e[a],f!==m&&""!==m&&(p||0===p)&&c&&(c=tt(t,a,c,f),"%"===m?(c/=tt(t,a,100,"%")/100,!0!==e.strictUnits&&(u=c+"%")):"em"===m||"rem"===m||"vw"===m||"vh"===m?c/=tt(t,a,1,m):"px"!==m&&(p=tt(t,a,p,m),m="px"),b&&(p||0===p)&&(d=p+c+m)),b&&(p+=c),!c&&0!==c||!p&&0!==p?void 0!==w[a]&&(d||d+""!="NaN"&&null!=d)?(i=new bt(w,a,p||c||0,0,i,-1,a,!1,0,u,d)).xs0="none"!==d||"display"!==a&&-1===a.indexOf("Style")?d:u:Y("invalid "+a+" tween value: "+e[a]):(i=new bt(w,a,c,p-c,i,0,a,!1!==h&&("px"===m||"zIndex"===a),0,u,d)).xs0=m)),r&&i&&!i.plugin&&(i.plugin=r);return i},c.setRatio=function(t){var e,i,n,o=this._firstPT;if(1!==t||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(t||this._tween._time!==this._tween._duration&&0!==this._tween._time||-1e-6===this._tween._rawPrevTime)for(;o;){if(e=o.c*t+o.s,o.r?e=Math.round(e):e<1e-6&&e>-1e-6&&(e=0),o.type)if(1===o.type)if(2===(n=o.l))o.t[o.p]=o.xs0+e+o.xs1+o.xn1+o.xs2;else if(3===n)o.t[o.p]=o.xs0+e+o.xs1+o.xn1+o.xs2+o.xn2+o.xs3;else if(4===n)o.t[o.p]=o.xs0+e+o.xs1+o.xn1+o.xs2+o.xn2+o.xs3+o.xn3+o.xs4;else if(5===n)o.t[o.p]=o.xs0+e+o.xs1+o.xn1+o.xs2+o.xn2+o.xs3+o.xn3+o.xs4+o.xn4+o.xs5;else{for(i=o.xs0+e+o.xs1,n=1;n<o.l;n++)i+=o["xn"+n]+o["xs"+(n+1)];o.t[o.p]=i}else-1===o.type?o.t[o.p]=o.xs0:o.setRatio&&o.setRatio(t);else o.t[o.p]=e+o.xs0;o=o._next}else for(;o;)2!==o.type?o.t[o.p]=o.b:o.setRatio(t),o=o._next;else for(;o;){if(2!==o.type)if(o.r&&-1!==o.type)if(e=Math.round(o.s+o.c),o.type){if(1===o.type){for(n=o.l,i=o.xs0+e+o.xs1,n=1;n<o.l;n++)i+=o["xn"+n]+o["xs"+(n+1)];o.t[o.p]=i}}else o.t[o.p]=e+o.xs0;else o.t[o.p]=o.e;else o.setRatio(t);o=o._next}},c._enableTransforms=function(t){this._transform=this._transform||Vt(this._target,o,!0),this._transformType=this._transform.svg&&Ct||!t&&3!==this._transformType?2:3};var Qt=function(t){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};c._addLazySet=function(t,e,i){var n=this._firstPT=new bt(t,e,0,0,this._firstPT,2);n.e=i,n.setRatio=Qt,n.data=this},c._linkCSSP=function(t,e,i,n){return t&&(e&&(e._prev=t),t._next&&(t._next._prev=t._prev),t._prev?t._prev._next=t._next:this._firstPT===t&&(this._firstPT=t._next,n=!0),i?i._next=t:n||null!==this._firstPT||(this._firstPT=t),t._next=e,t._prev=i),t},c._mod=function(t){for(var e=this._firstPT;e;)"function"==typeof t[e.p]&&t[e.p]===Math.round&&(e.r=1),e=e._next},c._kill=function(e){var i,n,o,r=e;if(e.autoAlpha||e.alpha){r={};for(n in e)r[n]=e[n];r.opacity=1,r.autoAlpha&&(r.visibility=1)}for(e.className&&(i=this._classNamePT)&&((o=i.xfirst)&&o._prev?this._linkCSSP(o._prev,i._next,o._prev._prev):o===this._firstPT&&(this._firstPT=i._next),i._next&&this._linkCSSP(i._next,i._next._next,o._prev),this._classNamePT=null),i=this._firstPT;i;)i.plugin&&i.plugin!==n&&i.plugin._kill&&(i.plugin._kill(e),n=i.plugin),i=i._next;return t.prototype._kill.call(this,r)};var Zt=function(t,e,i){var n,o,r,a;if(t.slice)for(o=t.length;--o>-1;)Zt(t[o],e,i);else for(o=(n=t.childNodes).length;--o>-1;)a=(r=n[o]).type,r.style&&(e.push(it(r)),i&&i.push(r)),1!==a&&9!==a&&11!==a||!r.childNodes.length||Zt(r,e,i)};return a.cascadeTo=function(t,i,n){var o,r,a,s,l=e.to(t,i,n),c=[l],h=[],p=[],u=[],d=e._internals.reservedProps;for(t=l._targets||l.target,Zt(t,h,u),l.render(i,!0,!0),Zt(t,p),l.render(0,!0,!0),l._enabled(!0),o=u.length;--o>-1;)if((r=nt(u[o],h[o],p[o])).firstMPT){r=r.difs;for(a in n)d[a]&&(r[a]=n[a]);s={};for(a in r)s[a]=h[o][a];c.push(e.fromTo(u[o],i,s,r))}return c},t.activate([a]),a},!0),function(){var t=function(t){for(;t;)t.f||t.blob||(t.m=Math.round),t=t._next},e=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.6.0",priority:-1,API:2,init:function(t,e,i){return this._tween=i,!0}}).prototype;e._onInitAllProps=function(){for(var e,i,n,o=this._tween,r=o.vars.roundProps.join?o.vars.roundProps:o.vars.roundProps.split(","),a=r.length,s={},l=o._propLookup.roundProps;--a>-1;)s[r[a]]=Math.round;for(a=r.length;--a>-1;)for(e=r[a],i=o._firstPT;i;)n=i._next,i.pg?i.t._mod(s):i.n===e&&(2===i.f&&i.t?t(i.t._firstPT):(this._add(i.t,e,i.s,i.c),n&&(n._prev=i._prev),i._prev?i._prev._next=n:o._firstPT===i&&(o._firstPT=n),i._next=i._prev=null,o._propLookup[e]=l)),i=n;return!1},e._add=function(t,e,i,n){this._addTween(t,e,i,i+n,e,Math.round),this._overwriteProps.push(e)}}(),_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.6.0",init:function(t,e,i,n){var o,r;if("function"!=typeof t.setAttribute)return!1;for(o in e)"function"==typeof(r=e[o])&&(r=r(n,t)),this._addTween(t,"setAttribute",t.getAttribute(o)+"",r+"",o,!1,o),this._overwriteProps.push(o);return!0}}),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.3.0",API:2,init:function(t,e,i,n){"object"!=typeof e&&(e={rotation:e}),this.finals={};var o,r,a,s,l,c,h=!0===e.useRadians?2*Math.PI:360;for(o in e)"useRadians"!==o&&("function"==typeof(s=e[o])&&(s=s(n,t)),r=(c=(s+"").split("_"))[0],a=parseFloat("function"!=typeof t[o]?t[o]:t[o.indexOf("set")||"function"!=typeof t["get"+o.substr(3)]?o:"get"+o.substr(3)]()),l=(s=this.finals[o]="string"==typeof r&&"="===r.charAt(1)?a+parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)):Number(r)||0)-a,c.length&&(-1!==(r=c.join("_")).indexOf("short")&&(l%=h)!==l%(h/2)&&(l=l<0?l+h:l-h),-1!==r.indexOf("_cw")&&l<0?l=(l+9999999999*h)%h-(l/h|0)*h:-1!==r.indexOf("ccw")&&l>0&&(l=(l-9999999999*h)%h-(l/h|0)*h)),(l>1e-6||l<-1e-6)&&(this._addTween(t,o,a,a+l,o),this._overwriteProps.push(o)));return!0},set:function(t){var e;if(1!==t)this._super.setRatio.call(this,t);else for(e=this._firstPT;e;)e.f?e.t[e.p](this.finals[e.p]):e.t[e.p]=this.finals[e.p],e=e._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(t){var e,i,n,o=_gsScope.GreenSockGlobals||_gsScope,r=o.com.greensock,a=2*Math.PI,s=Math.PI/2,l=r._class,c=function(e,i){var n=l("easing."+e,function(){},!0),o=n.prototype=new t;return o.constructor=n,o.getRatio=i,n},h=t.register||function(){},p=function(t,e,i,n,o){var r=l("easing."+t,{easeOut:new e,easeIn:new i,easeInOut:new n},!0);return h(r,t),r},u=function(t,e,i){this.t=t,this.v=e,i&&(this.next=i,i.prev=this,this.c=i.v-e,this.gap=i.t-t)},d=function(e,i){var n=l("easing."+e,function(t){this._p1=t||0===t?t:1.70158,this._p2=1.525*this._p1},!0),o=n.prototype=new t;return o.constructor=n,o.getRatio=i,o.config=function(t){return new n(t)},n},f=p("Back",d("BackOut",function(t){return(t-=1)*t*((this._p1+1)*t+this._p1)+1}),d("BackIn",function(t){return t*t*((this._p1+1)*t-this._p1)}),d("BackInOut",function(t){return(t*=2)<1?.5*t*t*((this._p2+1)*t-this._p2):.5*((t-=2)*t*((this._p2+1)*t+this._p2)+2)})),m=l("easing.SlowMo",function(t,e,i){e=e||0===e?e:.7,null==t?t=.7:t>1&&(t=1),this._p=1!==t?e:0,this._p1=(1-t)/2,this._p2=t,this._p3=this._p1+this._p2,this._calcEnd=!0===i},!0),g=m.prototype=new t;return g.constructor=m,g.getRatio=function(t){var e=t+(.5-t)*this._p;return t<this._p1?this._calcEnd?1-(t=1-t/this._p1)*t:e-(t=1-t/this._p1)*t*t*t*e:t>this._p3?this._calcEnd?1-(t=(t-this._p3)/this._p1)*t:e+(t-e)*(t=(t-this._p3)/this._p1)*t*t*t:this._calcEnd?1:e},m.ease=new m(.7,.7),g.config=m.config=function(t,e,i){return new m(t,e,i)},e=l("easing.SteppedEase",function(t){t=t||1,this._p1=1/t,this._p2=t+1},!0),g=e.prototype=new t,g.constructor=e,g.getRatio=function(t){return t<0?t=0:t>=1&&(t=.999999999),(this._p2*t>>0)*this._p1},g.config=e.config=function(t){return new e(t)},i=l("easing.RoughEase",function(e){for(var i,n,o,r,a,s,l=(e=e||{}).taper||"none",c=[],h=0,p=0|(e.points||20),d=p,f=!1!==e.randomize,m=!0===e.clamp,g=e.template instanceof t?e.template:null,y="number"==typeof e.strength?.4*e.strength:.4;--d>-1;)i=f?Math.random():1/p*d,n=g?g.getRatio(i):i,o="none"===l?y:"out"===l?(r=1-i)*r*y:"in"===l?i*i*y:i<.5?(r=2*i)*r*.5*y:(r=2*(1-i))*r*.5*y,f?n+=Math.random()*o-.5*o:d%2?n+=.5*o:n-=.5*o,m&&(n>1?n=1:n<0&&(n=0)),c[h++]={x:i,y:n};for(c.sort(function(t,e){return t.x-e.x}),s=new u(1,1,null),d=p;--d>-1;)a=c[d],s=new u(a.x,a.y,s);this._prev=new u(0,0,0!==s.t?s:s.next)},!0),g=i.prototype=new t,g.constructor=i,g.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&t<=e.t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},g.config=function(t){return new i(t)},i.ease=new i,p("Bounce",c("BounceOut",function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),c("BounceIn",function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),c("BounceInOut",function(t){var e=t<.5;return(t=e?1-2*t:2*t-1)<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})),p("Circ",c("CircOut",function(t){return Math.sqrt(1-(t-=1)*t)}),c("CircIn",function(t){return-(Math.sqrt(1-t*t)-1)}),c("CircInOut",function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})),n=function(e,i,n){var o=l("easing."+e,function(t,e){this._p1=t>=1?t:1,this._p2=(e||n)/(t<1?t:1),this._p3=this._p2/a*(Math.asin(1/this._p1)||0),this._p2=a/this._p2},!0),r=o.prototype=new t;return r.constructor=o,r.getRatio=i,r.config=function(t,e){return new o(t,e)},o},p("Elastic",n("ElasticOut",function(t){return this._p1*Math.pow(2,-10*t)*Math.sin((t-this._p3)*this._p2)+1},.3),n("ElasticIn",function(t){return-this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2)},.3),n("ElasticInOut",function(t){return(t*=2)<1?this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2)*-.5:this._p1*Math.pow(2,-10*(t-=1))*Math.sin((t-this._p3)*this._p2)*.5+1},.45)),p("Expo",c("ExpoOut",function(t){return 1-Math.pow(2,-10*t)}),c("ExpoIn",function(t){return Math.pow(2,10*(t-1))-.001}),c("ExpoInOut",function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})),p("Sine",c("SineOut",function(t){return Math.sin(t*s)}),c("SineIn",function(t){return 1-Math.cos(t*s)}),c("SineInOut",function(t){return-.5*(Math.cos(Math.PI*t)-1)})),l("easing.EaseLookup",{find:function(e){return t.map[e]}},!0),h(o.SlowMo,"SlowMo","ease,"),h(i,"RoughEase","ease,"),h(e,"SteppedEase","ease,"),f},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t,e){"use strict";var i={},n=t.document,o=t.GreenSockGlobals=t.GreenSockGlobals||t;if(!o.TweenLite){var r,a,s,l,c,h=function(t){var e,i=t.split("."),n=o;for(e=0;e<i.length;e++)n[i[e]]=n=n[i[e]]||{};return n},p=h("com.greensock"),u=function(t){var e,i=[],n=t.length;for(e=0;e!==n;i.push(t[e++]));return i},d=function(){},f=function(){var t=Object.prototype.toString,e=t.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&t.call(i)===e)}}(),m={},g=function(e,n,r,a){this.sc=m[e]?m[e].sc:[],m[e]=this,this.gsClass=null,this.func=r;var s=[];this.check=function(l){for(var c,p,u,d,f,y=n.length,v=y;--y>-1;)(c=m[n[y]]||new g(n[y],[])).gsClass?(s[y]=c.gsClass,v--):l&&c.sc.push(this);if(0===v&&r){if(p=("com.greensock."+e).split("."),u=p.pop(),d=h(p.join("."))[u]=this.gsClass=r.apply(r,s),a)if(o[u]=i[u]=d,!(f="undefined"!=typeof module&&module.exports)&&"function"==typeof define&&define.amd)define((t.GreenSockAMDPath?t.GreenSockAMDPath+"/":"")+e.split(".").pop(),[],function(){return d});else if(f)if("TweenMax"===e){module.exports=i.TweenMax=d;for(y in i)d[y]=i[y]}else i.TweenMax&&(i.TweenMax[u]=d);for(y=0;y<this.sc.length;y++)this.sc[y].check()}},this.check(!0)},y=t._gsDefine=function(t,e,i,n){return new g(t,e,i,n)},v=p._class=function(t,e,i){return e=e||function(){},y(t,[],function(){return e},i),e};y.globals=o;var b=[0,0,1,1],w=v("easing.Ease",function(t,e,i,n){this._func=t,this._type=i||0,this._power=n||0,this._params=e?b.concat(e):b},!0),x=w.map={},_=w.register=function(t,e,i,n){for(var o,r,a,s,l=e.split(","),c=l.length,h=(i||"easeIn,easeOut,easeInOut").split(",");--c>-1;)for(r=l[c],o=n?v("easing."+r,null,!0):p.easing[r]||{},a=h.length;--a>-1;)s=h[a],x[r+"."+s]=x[s+r]=o[s]=t.getRatio?t:t[s]||new t};for((s=w.prototype)._calcEnd=!1,s.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,i=this._power,n=1===e?1-t:2===e?t:t<.5?2*t:2*(1-t);return 1===i?n*=n:2===i?n*=n*n:3===i?n*=n*n*n:4===i&&(n*=n*n*n*n),1===e?1-n:2===e?n:t<.5?n/2:1-n/2},a=(r=["Linear","Quad","Cubic","Quart","Quint,Strong"]).length;--a>-1;)s=r[a]+",Power"+a,_(new w(null,null,1,a),s,"easeOut",!0),_(new w(null,null,2,a),s,"easeIn"+(0===a?",easeNone":"")),_(new w(null,null,3,a),s,"easeInOut");x.linear=p.easing.Linear.easeIn,x.swing=p.easing.Quad.easeInOut;var S=v("events.EventDispatcher",function(t){this._listeners={},this._eventTarget=t||this});(s=S.prototype).addEventListener=function(t,e,i,n,o){o=o||0;var r,a,s=this._listeners[t],h=0;for(this!==l||c||l.wake(),null==s&&(this._listeners[t]=s=[]),a=s.length;--a>-1;)(r=s[a]).c===e&&r.s===i?s.splice(a,1):0===h&&r.pr<o&&(h=a+1);s.splice(h,0,{c:e,s:i,up:n,pr:o})},s.removeEventListener=function(t,e){var i,n=this._listeners[t];if(n)for(i=n.length;--i>-1;)if(n[i].c===e)return void n.splice(i,1)},s.dispatchEvent=function(t){var e,i,n,o=this._listeners[t];if(o)for((e=o.length)>1&&(o=o.slice(0)),i=this._eventTarget;--e>-1;)(n=o[e])&&(n.up?n.c.call(n.s||i,{type:t,target:i}):n.c.call(n.s||i))};var T=t.requestAnimationFrame,P=t.cancelAnimationFrame,C=Date.now||function(){return(new Date).getTime()},I=C();for(a=(r=["ms","moz","webkit","o"]).length;--a>-1&&!T;)T=t[r[a]+"RequestAnimationFrame"],P=t[r[a]+"CancelAnimationFrame"]||t[r[a]+"CancelRequestAnimationFrame"];v("Ticker",function(t,e){var i,o,r,a,s,h=this,p=C(),u=!(!1===e||!T)&&"auto",f=500,m=33,g=function(t){var e,n,l=C()-I;l>f&&(p+=l-m),I+=l,h.time=(I-p)/1e3,e=h.time-s,(!i||e>0||!0===t)&&(h.frame++,s+=e+(e>=a?.004:a-e),n=!0),!0!==t&&(r=o(g)),n&&h.dispatchEvent("tick")};S.call(h),h.time=h.frame=0,h.tick=function(){g(!0)},h.lagSmoothing=function(t,e){f=t||1e10,m=Math.min(e,f,0)},h.sleep=function(){null!=r&&(u&&P?P(r):clearTimeout(r),o=d,r=null,h===l&&(c=!1))},h.wake=function(t){null!==r?h.sleep():t?p+=-I+(I=C()):h.frame>10&&(I=C()-f+5),o=0===i?d:u&&T?T:function(t){return setTimeout(t,1e3*(s-h.time)+1|0)},h===l&&(c=!0),g(2)},h.fps=function(t){if(!arguments.length)return i;a=1/((i=t)||60),s=this.time+a,h.wake()},h.useRAF=function(t){if(!arguments.length)return u;h.sleep(),u=t,h.fps(i)},h.fps(t),setTimeout(function(){"auto"===u&&h.frame<5&&"hidden"!==n.visibilityState&&h.useRAF(!1)},1500)}),(s=p.Ticker.prototype=new p.events.EventDispatcher).constructor=p.Ticker;var k=v("core.Animation",function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=!0===e.immediateRender,this.data=e.data,this._reversed=!0===e.reversed,W){c||l.wake();var i=this.vars.useFrames?z:W;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});l=k.ticker=new p.Ticker,(s=k.prototype)._dirty=s._gc=s._initted=s._paused=!1,s._totalTime=s._time=0,s._rawPrevTime=-1,s._next=s._last=s._onUpdate=s._timeline=s.timeline=null,s._paused=!1;var A=function(){c&&C()-I>2e3&&l.wake(),setTimeout(A,2e3)};A(),s.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},s.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},s.resume=function(t,e){return null!=t&&this.seek(t,e),this.paused(!1)},s.seek=function(t,e){return this.totalTime(Number(t),!1!==e)},s.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,!1!==e,!0)},s.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},s.render=function(t,e,i){},s.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,!this._gc&&this.timeline||this._enabled(!0),this},s.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime(!0))>=i&&t<i+this.totalDuration()/this._timeScale},s._enabled=function(t,e){return c||l.wake(),this._gc=!t,this._active=this.isActive(),!0!==e&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},s._kill=function(t,e){return this._enabled(!1,!1)},s.kill=function(t,e){return this._kill(t,e),this},s._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},s._swapSelfInParams=function(t){for(var e=t.length,i=t.concat();--e>-1;)"{self}"===t[e]&&(i[e]=this);return i},s._callback=function(t){var e=this.vars,i=e[t],n=e[t+"Params"],o=e[t+"Scope"]||e.callbackScope||this;switch(n?n.length:0){case 0:i.call(o);break;case 1:i.call(o,n[0]);break;case 2:i.call(o,n[0],n[1]);break;default:i.apply(o,n)}},s.eventCallback=function(t,e,i,n){if("on"===(t||"").substr(0,2)){var o=this.vars;if(1===arguments.length)return o[t];null==e?delete o[t]:(o[t]=e,o[t+"Params"]=f(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,o[t+"Scope"]=n),"onUpdate"===t&&(this._onUpdate=e)}return this},s.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},s.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},s.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},s.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},s.totalTime=function(t,e,i){if(c||l.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(t<0&&!i&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var n=this._totalDuration,o=this._timeline;if(t>n&&!i&&(t=n),this._startTime=(this._paused?this._pauseTime:o._time)-(this._reversed?n-t:t)/this._timeScale,o._dirty||this._uncache(!1),o._timeline)for(;o._timeline;)o._timeline._time!==(o._startTime+o._totalTime)/o._timeScale&&o.totalTime(o._totalTime,!0),o=o._timeline}this._gc&&this._enabled(!0,!1),this._totalTime===t&&0!==this._duration||(G.length&&K(),this.render(t,e,!1),G.length&&K())}return this},s.progress=s.totalProgress=function(t,e){var i=this.duration();return arguments.length?this.totalTime(i*t,e):i?this._time/i:this.ratio},s.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},s.endTime=function(t){return this._startTime+(0!=t?this.totalDuration():this.duration())/this._timeScale},s.timeScale=function(t){if(!arguments.length)return this._timeScale;if(t=t||1e-10,this._timeline&&this._timeline.smoothChildTiming){var e=this._pauseTime,i=e||0===e?e:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/t}return this._timeScale=t,this._uncache(!1)},s.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},s.paused=function(t){if(!arguments.length)return this._paused;var e,i,n=this._timeline;return t!=this._paused&&n&&(c||t||l.wake(),i=(e=n.rawTime())-this._pauseTime,!t&&n.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=t?e:null,this._paused=t,this._active=this.isActive(),!t&&0!==i&&this._initted&&this.duration()&&(e=n.smoothChildTiming?this._totalTime:(e-this._startTime)/this._timeScale,this.render(e,e===this._totalTime,!0))),this._gc&&!t&&this._enabled(!0,!1),this};var M=v("core.SimpleTimeline",function(t){k.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0});(s=M.prototype=new k).constructor=M,s.kill()._gc=!1,s._first=s._last=s._recent=null,s._sortChildren=!1,s.add=s.insert=function(t,e,i,n){var o,r;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=t._startTime+(this.rawTime()-t._startTime)/t._timeScale),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),o=this._last,this._sortChildren)for(r=t._startTime;o&&o._startTime>r;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=o,this._recent=t,this._timeline&&this._uncache(!0),this},s._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),t._next=t._prev=t.timeline=null,t===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},s.render=function(t,e,i){var n,o=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;o;)n=o._next,(o._active||t>=o._startTime&&!o._paused)&&(o._reversed?o.render((o._dirty?o.totalDuration():o._totalDuration)-(t-o._startTime)*o._timeScale,e,i):o.render((t-o._startTime)*o._timeScale,e,i)),o=n},s.rawTime=function(){return c||l.wake(),this._totalTime};var O=v("TweenLite",function(e,i,n){if(k.call(this,i,n),this.render=O.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:O.selector(e)||e;var o,r,a,s=e.jquery||e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType),l=this.vars.overwrite;if(this._overwrite=l=null==l?q[O.defaultOverwrite]:"number"==typeof l?l>>0:q[l],(s||e instanceof Array||e.push&&f(e))&&"number"!=typeof e[0])for(this._targets=a=u(e),this._propLookup=[],this._siblings=[],o=0;o<a.length;o++)(r=a[o])?"string"!=typeof r?r.length&&r!==t&&r[0]&&(r[0]===t||r[0].nodeType&&r[0].style&&!r.nodeType)?(a.splice(o--,1),this._targets=a=a.concat(u(r))):(this._siblings[o]=Q(r,this,!1),1===l&&this._siblings[o].length>1&&J(r,this,null,1,this._siblings[o])):"string"==typeof(r=a[o--]=O.selector(r))&&a.splice(o+1,1):a.splice(o--,1);else this._propLookup={},this._siblings=Q(e,this,!1),1===l&&this._siblings.length>1&&J(e,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&!1!==this.vars.immediateRender)&&(this._time=-1e-10,this.render(Math.min(0,-this._delay)))},!0),R=function(e){return e&&e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType)},B=function(t,e){var i,n={};for(i in t)H[i]||i in e&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!X[i]||X[i]&&X[i]._autoCSS)||(n[i]=t[i],delete t[i]);t.css=n};(s=O.prototype=new k).constructor=O,s.kill()._gc=!1,s.ratio=0,s._firstPT=s._targets=s._overwrittenProps=s._startAt=null,s._notifyPluginsOfEnabled=s._lazy=!1,O.version="1.19.1",O.defaultEase=s._ease=new w(null,null,1,1),O.defaultOverwrite="auto",O.ticker=l,O.autoSleep=120,O.lagSmoothing=function(t,e){l.lagSmoothing(t,e)},O.selector=t.$||t.jQuery||function(e){var i=t.$||t.jQuery;return i?(O.selector=i,i(e)):void 0===n?e:n.querySelectorAll?n.querySelectorAll(e):n.getElementById("#"===e.charAt(0)?e.substr(1):e)};var G=[],E={},D=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,L=function(t){for(var e,i=this._firstPT;i;)e=i.blob?1===t?this.end:t?this.join(""):this.start:i.c*t+i.s,i.m?e=i.m(e,this._target||i.t):e<1e-6&&e>-1e-6&&!i.blob&&(e=0),i.f?i.fp?i.t[i.p](i.fp,e):i.t[i.p](e):i.t[i.p]=e,i=i._next},j=function(t,e,i,n){var o,r,a,s,l,c,h,p=[],u=0,d="",f=0;for(p.start=t,p.end=e,t=p[0]=t+"",e=p[1]=e+"",i&&(i(p),t=p[0],e=p[1]),p.length=0,o=t.match(D)||[],r=e.match(D)||[],n&&(n._next=null,n.blob=1,p._firstPT=p._applyPT=n),l=r.length,s=0;s<l;s++)h=r[s],d+=(c=e.substr(u,e.indexOf(h,u)-u))||!s?c:",",u+=c.length,f?f=(f+1)%5:"rgba("===c.substr(-5)&&(f=1),h===o[s]||o.length<=s?d+=h:(d&&(p.push(d),d=""),a=parseFloat(o[s]),p.push(a),p._firstPT={_next:p._firstPT,t:p,p:p.length-1,s:a,c:("="===h.charAt(1)?parseInt(h.charAt(0)+"1",10)*parseFloat(h.substr(2)):parseFloat(h)-a)||0,f:0,m:f&&f<4?Math.round:0}),u+=h.length;return(d+=e.substr(u))&&p.push(d),p.setRatio=L,p},F=function(t,e,i,n,o,r,a,s,l){"function"==typeof n&&(n=n(l||0,t));var c=typeof t[e],h="function"!==c?"":e.indexOf("set")||"function"!=typeof t["get"+e.substr(3)]?e:"get"+e.substr(3),p="get"!==i?i:h?a?t[h](a):t[h]():t[e],u="string"==typeof n&&"="===n.charAt(1),d={t:t,p:e,s:p,f:"function"===c,pg:0,n:o||e,m:r?"function"==typeof r?r:Math.round:0,pr:0,c:u?parseInt(n.charAt(0)+"1",10)*parseFloat(n.substr(2)):parseFloat(n)-p||0};if(("number"!=typeof p||"number"!=typeof n&&!u)&&(a||isNaN(p)||!u&&isNaN(n)||"boolean"==typeof p||"boolean"==typeof n?(d.fp=a,d={t:j(p,u?d.s+d.c:n,s||O.defaultStringFilter,d),p:"setRatio",s:0,c:1,f:2,pg:0,n:o||e,pr:0,m:0}):(d.s=parseFloat(p),u||(d.c=parseFloat(n)-d.s||0))),d.c)return(d._next=this._firstPT)&&(d._next._prev=d),this._firstPT=d,d},N=O._internals={isArray:f,isSelector:R,lazyTweens:G,blobDif:j},X=O._plugins={},U=N.tweenLookup={},V=0,H=N.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1},q={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},z=k._rootFramesTimeline=new M,W=k._rootTimeline=new M,Y=30,K=N.lazyRender=function(){var t,e=G.length;for(E={};--e>-1;)(t=G[e])&&!1!==t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0),t._lazy=!1);G.length=0};W._startTime=l.time,z._startTime=l.frame,W._active=z._active=!0,setTimeout(K,1),k._updateRoot=O.render=function(){var t,e,i;if(G.length&&K(),W.render((l.time-W._startTime)*W._timeScale,!1,!1),z.render((l.frame-z._startTime)*z._timeScale,!1,!1),G.length&&K(),l.frame>=Y){Y=l.frame+(parseInt(O.autoSleep,10)||120);for(i in U){for(t=(e=U[i].tweens).length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete U[i]}if((!(i=W._first)||i._paused)&&O.autoSleep&&!z._first&&1===l._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||l.sleep()}}},l.addEventListener("tick",k._updateRoot);var Q=function(t,e,i){var n,o,r=t._gsTweenID;if(U[r||(t._gsTweenID=r="t"+V++)]||(U[r]={target:t,tweens:[]}),e&&(n=U[r].tweens,n[o=n.length]=e,i))for(;--o>-1;)n[o]===e&&n.splice(o,1);return U[r].tweens},Z=function(t,e,i,n){var o,r,a=t.vars.onOverwrite;return a&&(o=a(t,e,i,n)),(a=O.onOverwrite)&&(r=a(t,e,i,n)),!1!==o&&!1!==r},J=function(t,e,i,n,o){var r,a,s,l;if(1===n||n>=4){for(l=o.length,r=0;r<l;r++)if((s=o[r])!==e)s._gc||s._kill(null,t,e)&&(a=!0);else if(5===n)break;return a}var c,h=e._startTime+1e-10,p=[],u=0,d=0===e._duration;for(r=o.length;--r>-1;)(s=o[r])===e||s._gc||s._paused||(s._timeline!==e._timeline?(c=c||$(e,0,d),0===$(s,c,d)&&(p[u++]=s)):s._startTime<=h&&s._startTime+s.totalDuration()/s._timeScale>h&&((d||!s._initted)&&h-s._startTime<=2e-10||(p[u++]=s)));for(r=u;--r>-1;)if(s=p[r],2===n&&s._kill(i,t,e)&&(a=!0),2!==n||!s._firstPT&&s._initted){if(2!==n&&!Z(s,e))continue;s._enabled(!1,!1)&&(a=!0)}return a},$=function(t,e,i){for(var n=t._timeline,o=n._timeScale,r=t._startTime;n._timeline;){if(r+=n._startTime,o*=n._timeScale,n._paused)return-100;n=n._timeline}return(r/=o)>e?r-e:i&&r===e||!t._initted&&r-e<2e-10?1e-10:(r+=t.totalDuration()/t._timeScale/o)>e+1e-10?0:r-e-1e-10};s._init=function(){var t,e,i,n,o,r,a=this.vars,s=this._overwrittenProps,l=this._duration,c=!!a.immediateRender,h=a.ease;if(a.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),o={};for(n in a.startAt)o[n]=a.startAt[n];if(o.overwrite=!1,o.immediateRender=!0,o.lazy=c&&!1!==a.lazy,o.startAt=o.delay=null,this._startAt=O.to(this.target,0,o),c)if(this._time>0)this._startAt=null;else if(0!==l)return}else if(a.runBackwards&&0!==l)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(c=!1),i={};for(n in a)H[n]&&"autoCSS"!==n||(i[n]=a[n]);if(i.overwrite=0,i.data="isFromStart",i.lazy=c&&!1!==a.lazy,i.immediateRender=c,this._startAt=O.to(this.target,0,i),c){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=h=h?h instanceof w?h:"function"==typeof h?new w(h,a.easeParams):x[h]||O.defaultEase:O.defaultEase,a.easeParams instanceof Array&&h.config&&(this._ease=h.config.apply(h,a.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(r=this._targets.length,t=0;t<r;t++)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],s?s[t]:null,t)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,s,0);if(e&&O._onPluginEvent("_onInitAllProps",this),s&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),a.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=a.onUpdate,this._initted=!0},s._initProps=function(e,i,n,o,r){var a,s,l,c,h,p;if(null==e)return!1;E[e._gsTweenID]&&K(),this.vars.css||e.style&&e!==t&&e.nodeType&&X.css&&!1!==this.vars.autoCSS&&B(this.vars,e);for(a in this.vars)if(p=this.vars[a],H[a])p&&(p instanceof Array||p.push&&f(p))&&-1!==p.join("").indexOf("{self}")&&(this.vars[a]=p=this._swapSelfInParams(p,this));else if(X[a]&&(c=new X[a])._onInitTween(e,this.vars[a],this,r)){for(this._firstPT=h={_next:this._firstPT,t:c,p:"setRatio",s:0,c:1,f:1,n:a,pg:1,pr:c._priority,m:0},s=c._overwriteProps.length;--s>-1;)i[c._overwriteProps[s]]=this._firstPT;(c._priority||c._onInitAllProps)&&(l=!0),(c._onDisable||c._onEnable)&&(this._notifyPluginsOfEnabled=!0),h._next&&(h._next._prev=h)}else i[a]=F.call(this,e,a,"get",p,a,0,null,this.vars.stringFilter,r);return o&&this._kill(o,e)?this._initProps(e,i,n,o,r):this._overwrite>1&&this._firstPT&&n.length>1&&J(e,this,i,this._overwrite,n)?(this._kill(i,e),this._initProps(e,i,n,o,r)):(this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration)&&(E[e._gsTweenID]=!0),l)},s.render=function(t,e,i){var n,o,r,a,s=this._time,l=this._duration,c=this._rawPrevTime;if(t>=l-1e-7&&t>=0)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(n=!0,o="onComplete",i=i||this._timeline.autoRemoveChildren),0===l&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(c<0||t<=0&&t>=-1e-7||1e-10===c&&"isPause"!==this.data)&&c!==t&&(i=!0,c>1e-10&&(o="onReverseComplete")),this._rawPrevTime=a=!e||t||c===t?t:1e-10);else if(t<1e-7)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===l&&c>0)&&(o="onReverseComplete",n=this._reversed),t<0&&(this._active=!1,0===l&&(this._initted||!this.vars.lazy||i)&&(c>=0&&(1e-10!==c||"isPause"!==this.data)&&(i=!0),this._rawPrevTime=a=!e||t||c===t?t:1e-10)),this._initted||(i=!0);else if(this._totalTime=this._time=t,this._easeType){var h=t/l,p=this._easeType,u=this._easePower;(1===p||3===p&&h>=.5)&&(h=1-h),3===p&&(h*=2),1===u?h*=h:2===u?h*=h*h:3===u?h*=h*h*h:4===u&&(h*=h*h*h*h),this.ratio=1===p?1-h:2===p?h:t/l<.5?h/2:1-h/2}else this.ratio=this._ease.getRatio(t/l);if(this._time!==s||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=s,this._rawPrevTime=c,G.push(this),void(this._lazy=[t,e]);this._time&&!n?this.ratio=this._ease.getRatio(this._time/l):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==s&&t>=0&&(this._active=!0),0===s&&(this._startAt&&(t>=0?this._startAt.render(t,e,i):o||(o="_dummyGS")),this.vars.onStart&&(0===this._time&&0!==l||e||this._callback("onStart"))),r=this._firstPT;r;)r.f?r.t[r.p](r.c*this.ratio+r.s):r.t[r.p]=r.c*this.ratio+r.s,r=r._next;this._onUpdate&&(t<0&&this._startAt&&-1e-4!==t&&this._startAt.render(t,e,i),e||(this._time!==s||n||i)&&this._callback("onUpdate")),o&&(this._gc&&!i||(t<0&&this._startAt&&!this._onUpdate&&-1e-4!==t&&this._startAt.render(t,e,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[o]&&this._callback(o),0===l&&1e-10===this._rawPrevTime&&1e-10!==a&&(this._rawPrevTime=0)))}},s._kill=function(t,e,i){if("all"===t&&(t=null),null==t&&(null==e||e===this.target))return this._lazy=!1,this._enabled(!1,!1);e="string"!=typeof e?e||this._targets||this.target:O.selector(e)||e;var n,o,r,a,s,l,c,h,p,u=i&&this._time&&i._startTime===this._startTime&&this._timeline===i._timeline;if((f(e)||R(e))&&"number"!=typeof e[0])for(n=e.length;--n>-1;)this._kill(t,e[n],i)&&(l=!0);else{if(this._targets){for(n=this._targets.length;--n>-1;)if(e===this._targets[n]){s=this._propLookup[n]||{},this._overwrittenProps=this._overwrittenProps||[],o=this._overwrittenProps[n]=t?this._overwrittenProps[n]||{}:"all";break}}else{if(e!==this.target)return!1;s=this._propLookup,o=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(s){if(c=t||s,h=t!==o&&"all"!==o&&t!==s&&("object"!=typeof t||!t._tempKill),i&&(O.onOverwrite||this.vars.onOverwrite)){for(r in c)s[r]&&(p||(p=[]),p.push(r));if((p||!t)&&!Z(this,i,e,p))return!1}for(r in c)(a=s[r])&&(u&&(a.f?a.t[a.p](a.s):a.t[a.p]=a.s,l=!0),a.pg&&a.t._kill(c)&&(l=!0),a.pg&&0!==a.t._overwriteProps.length||(a._prev?a._prev._next=a._next:a===this._firstPT&&(this._firstPT=a._next),a._next&&(a._next._prev=a._prev),a._next=a._prev=null),delete s[r]),h&&(o[r]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},s.invalidate=function(){return this._notifyPluginsOfEnabled&&O._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],k.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-1e-10,this.render(Math.min(0,-this._delay))),this},s._enabled=function(t,e){if(c||l.wake(),t&&this._gc){var i,n=this._targets;if(n)for(i=n.length;--i>-1;)this._siblings[i]=Q(n[i],this,!0);else this._siblings=Q(this.target,this,!0)}return k.prototype._enabled.call(this,t,e),!(!this._notifyPluginsOfEnabled||!this._firstPT)&&O._onPluginEvent(t?"_onEnable":"_onDisable",this)},O.to=function(t,e,i){return new O(t,e,i)},O.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new O(t,e,i)},O.fromTo=function(t,e,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new O(t,e,n)},O.delayedCall=function(t,e,i,n,o){return new O(e,0,{delay:t,onComplete:e,onCompleteParams:i,callbackScope:n,onReverseComplete:e,onReverseCompleteParams:i,immediateRender:!1,lazy:!1,useFrames:o,overwrite:0})},O.set=function(t,e){return new O(t,0,e)},O.getTweensOf=function(t,e){if(null==t)return[];t="string"!=typeof t?t:O.selector(t)||t;var i,n,o,r;if((f(t)||R(t))&&"number"!=typeof t[0]){for(i=t.length,n=[];--i>-1;)n=n.concat(O.getTweensOf(t[i],e));for(i=n.length;--i>-1;)for(r=n[i],o=i;--o>-1;)r===n[o]&&n.splice(i,1)}else for(i=(n=Q(t).concat()).length;--i>-1;)(n[i]._gc||e&&!n[i].isActive())&&n.splice(i,1);return n},O.killTweensOf=O.killDelayedCallsTo=function(t,e,i){"object"==typeof e&&(i=e,e=!1);for(var n=O.getTweensOf(t,e),o=n.length;--o>-1;)n[o]._kill(i,t)};var tt=v("plugins.TweenPlugin",function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=tt.prototype},!0);if(s=tt.prototype,tt.version="1.19.0",tt.API=2,s._firstPT=null,s._addTween=F,s.setRatio=L,s._kill=function(t){var e,i=this._overwriteProps,n=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=i.length;--e>-1;)null!=t[i[e]]&&i.splice(e,1);for(;n;)null!=t[n.n]&&(n._next&&(n._next._prev=n._prev),n._prev?(n._prev._next=n._next,n._prev=null):this._firstPT===n&&(this._firstPT=n._next)),n=n._next;return!1},s._mod=s._roundProps=function(t){for(var e,i=this._firstPT;i;)(e=t[this._propName]||null!=i.n&&t[i.n.split(this._propName+"_").join("")])&&"function"==typeof e&&(2===i.f?i.t._applyPT.m=e:i.m=e),i=i._next},O._onPluginEvent=function(t,e){var i,n,o,r,a,s=e._firstPT;if("_onInitAllProps"===t){for(;s;){for(a=s._next,n=o;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:o=s,(s._next=n)?n._prev=s:r=s,s=a}s=e._firstPT=o}for(;s;)s.pg&&"function"==typeof s.t[t]&&s.t[t]()&&(i=!0),s=s._next;return i},tt.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===tt.API&&(X[(new t[e])._propName]=t[e]);return!0},y.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";var e,i=t.propName,n=t.priority||0,o=t.overwriteProps,r={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},a=v("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){tt.call(this,i,n),this._overwriteProps=o||[]},!0===t.global),s=a.prototype=new tt(i);s.constructor=a,a.API=t.API;for(e in r)"function"==typeof t[e]&&(s[r[e]]=t[e]);return a.version=t.version,tt.activate([a]),a},r=t._gsQueue){for(a=0;a<r.length;a++)r[a]();for(s in m)m[s].func||t.console.log("GSAP encountered missing dependency: "+s)}c=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window);var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pixi_spine;!function(t){!function(t){var e=function(){function t(t,e,i){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=i}return t.prototype.apply=function(t,e,i,n,o,r,a,s){if(null==t)throw new Error("skeleton cannot be null.");n&&0!=this.duration&&(i%=this.duration,e>0&&(e%=this.duration));for(var l=this.timelines,c=0,h=l.length;c<h;c++)l[c].apply(t,e,i,o,r,a,s)},t.binarySearch=function(t,e,i){void 0===i&&(i=1);var n=0,o=t.length/i-2;if(0==o)return i;for(var r=o>>>1;;){if(t[(r+1)*i]<=e?n=r+1:o=r,n==o)return(n+1)*i;r=n+o>>>1}},t.linearSearch=function(t,e,i){for(var n=0,o=t.length-i;n<=o;n+=i)if(t[n]>e)return n;return-1},t}();t.Animation=e;var i;!function(t){t[t.setup=0]="setup",t[t.current=1]="current",t[t.currentLayered=2]="currentLayered"}(i=t.MixPose||(t.MixPose={}));var n;!function(t){t[t.in=0]="in",t[t.out=1]="out"}(n=t.MixDirection||(t.MixDirection={}));var o;!function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"}(o=t.TimelineType||(t.TimelineType={}));var r=function(){function e(i){if(i<=0)throw new Error("frameCount must be > 0: "+i);this.curves=t.Utils.newFloatArray((i-1)*e.BEZIER_SIZE)}return e.prototype.getFrameCount=function(){return this.curves.length/e.BEZIER_SIZE+1},e.prototype.setLinear=function(t){this.curves[t*e.BEZIER_SIZE]=e.LINEAR},e.prototype.setStepped=function(t){this.curves[t*e.BEZIER_SIZE]=e.STEPPED},e.prototype.getCurveType=function(t){var i=t*e.BEZIER_SIZE;if(i==this.curves.length)return e.LINEAR;var n=this.curves[i];return n==e.LINEAR?e.LINEAR:n==e.STEPPED?e.STEPPED:e.BEZIER},e.prototype.setCurve=function(t,i,n,o,r){var a=.03*(2*-i+o),s=.03*(2*-n+r),l=.006*(3*(i-o)+1),c=.006*(3*(n-r)+1),h=2*a+l,p=2*s+c,u=.3*i+a+.16666667*l,d=.3*n+s+.16666667*c,f=t*e.BEZIER_SIZE,m=this.curves;m[f++]=e.BEZIER;for(var g=u,y=d,v=f+e.BEZIER_SIZE-1;f<v;f+=2)m[f]=g,m[f+1]=y,u+=h,d+=p,h+=l,p+=c,g+=u,y+=d},e.prototype.getCurvePercent=function(i,n){n=t.MathUtils.clamp(n,0,1);var o=this.curves,r=i*e.BEZIER_SIZE,a=o[r];if(a==e.LINEAR)return n;if(a==e.STEPPED)return 0;for(var s=0,l=++r,c=r+e.BEZIER_SIZE-1;r<c;r+=2)if((s=o[r])>=n){var h=void 0,p=void 0;return r==l?(h=0,p=0):(h=o[r-2],p=o[r-1]),p+(o[r+1]-p)*(n-h)/(s-h)}var u=o[r-1];return u+(1-u)*(n-s)/(1-s)},e.LINEAR=0,e.STEPPED=1,e.BEZIER=2,e.BEZIER_SIZE=19,e}();t.CurveTimeline=r;var a=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e<<1),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.rotate<<24)+this.boneIndex},r.prototype.setFrame=function(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+r.ROTATION]=i},r.prototype.apply=function(t,n,o,a,s,l,c){var h=this.frames,p=t.bones[this.boneIndex];if(o<h[0])switch(l){case i.setup:return void(p.rotation=p.data.rotation);case i.current:var u=p.data.rotation-p.rotation;u-=360*(16384-(16384.499999999996-u/360|0)),p.rotation+=u*s}else if(o>=h[h.length-r.ENTRIES])if(l==i.setup)p.rotation=p.data.rotation+h[h.length+r.PREV_ROTATION]*s;else{var d=p.data.rotation+h[h.length+r.PREV_ROTATION]-p.rotation;d-=360*(16384-(16384.499999999996-d/360|0)),p.rotation+=d*s}else{var f=e.binarySearch(h,o,r.ENTRIES),m=h[f+r.PREV_ROTATION],g=h[f],y=this.getCurvePercent((f>>1)-1,1-(o-g)/(h[f+r.PREV_TIME]-g)),v=h[f+r.ROTATION]-m;v=m+(v-=360*(16384-(16384.499999999996-v/360|0)))*y,l==i.setup?(v-=360*(16384-(16384.499999999996-v/360|0)),p.rotation=p.data.rotation+v*s):(v=p.data.rotation+v-p.rotation,v-=360*(16384-(16384.499999999996-v/360|0)),p.rotation+=v*s)}},r.ENTRIES=2,r.PREV_TIME=-2,r.PREV_ROTATION=-1,r.ROTATION=1,r}(r);t.RotateTimeline=a;var s=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*r.ENTRIES),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.translate<<24)+this.boneIndex},r.prototype.setFrame=function(t,e,i,n){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.X]=i,this.frames[t+r.Y]=n},r.prototype.apply=function(t,n,o,a,s,l,c){var h=this.frames,p=t.bones[this.boneIndex];if(o<h[0])switch(l){case i.setup:return p.x=p.data.x,void(p.y=p.data.y);case i.current:p.x+=(p.data.x-p.x)*s,p.y+=(p.data.y-p.y)*s}else{var u=0,d=0;if(o>=h[h.length-r.ENTRIES])u=h[h.length+r.PREV_X],d=h[h.length+r.PREV_Y];else{var f=e.binarySearch(h,o,r.ENTRIES);u=h[f+r.PREV_X],d=h[f+r.PREV_Y];var m=h[f],g=this.getCurvePercent(f/r.ENTRIES-1,1-(o-m)/(h[f+r.PREV_TIME]-m));u+=(h[f+r.X]-u)*g,d+=(h[f+r.Y]-d)*g}l==i.setup?(p.x=p.data.x+u*s,p.y=p.data.y+d*s):(p.x+=(p.data.x+u-p.x)*s,p.y+=(p.data.y+d-p.y)*s)}},r.ENTRIES=3,r.PREV_TIME=-3,r.PREV_X=-2,r.PREV_Y=-1,r.X=1,r.Y=2,r}(r);t.TranslateTimeline=s;var l=function(r){function a(t){return r.call(this,t)||this}return __extends(a,r),a.prototype.getPropertyId=function(){return(o.scale<<24)+this.boneIndex},a.prototype.apply=function(o,r,s,l,c,h,p){var u=this.frames,d=o.bones[this.boneIndex];if(s<u[0])switch(h){case i.setup:return d.scaleX=d.data.scaleX,void(d.scaleY=d.data.scaleY);case i.current:d.scaleX+=(d.data.scaleX-d.scaleX)*c,d.scaleY+=(d.data.scaleY-d.scaleY)*c}else{var f=0,m=0;if(s>=u[u.length-a.ENTRIES])f=u[u.length+a.PREV_X]*d.data.scaleX,m=u[u.length+a.PREV_Y]*d.data.scaleY;else{var g=e.binarySearch(u,s,a.ENTRIES);f=u[g+a.PREV_X],m=u[g+a.PREV_Y];var y=u[g],v=this.getCurvePercent(g/a.ENTRIES-1,1-(s-y)/(u[g+a.PREV_TIME]-y));f=(f+(u[g+a.X]-f)*v)*d.data.scaleX,m=(m+(u[g+a.Y]-m)*v)*d.data.scaleY}if(1==c)d.scaleX=f,d.scaleY=m;else{var b=0,w=0;h==i.setup?(b=d.data.scaleX,w=d.data.scaleY):(b=d.scaleX,w=d.scaleY),p==n.out?(f=Math.abs(f)*t.MathUtils.signum(b),m=Math.abs(m)*t.MathUtils.signum(w)):(b=Math.abs(b)*t.MathUtils.signum(f),w=Math.abs(w)*t.MathUtils.signum(m)),d.scaleX=b+(f-b)*c,d.scaleY=w+(m-w)*c}}},a}(s);t.ScaleTimeline=l;var c=function(t){function n(e){return t.call(this,e)||this}return __extends(n,t),n.prototype.getPropertyId=function(){return(o.shear<<24)+this.boneIndex},n.prototype.apply=function(t,o,r,a,s,l,c){var h=this.frames,p=t.bones[this.boneIndex];if(r<h[0])switch(l){case i.setup:return p.shearX=p.data.shearX,void(p.shearY=p.data.shearY);case i.current:p.shearX+=(p.data.shearX-p.shearX)*s,p.shearY+=(p.data.shearY-p.shearY)*s}else{var u=0,d=0;if(r>=h[h.length-n.ENTRIES])u=h[h.length+n.PREV_X],d=h[h.length+n.PREV_Y];else{var f=e.binarySearch(h,r,n.ENTRIES);u=h[f+n.PREV_X],d=h[f+n.PREV_Y];var m=h[f],g=this.getCurvePercent(f/n.ENTRIES-1,1-(r-m)/(h[f+n.PREV_TIME]-m));u+=(h[f+n.X]-u)*g,d+=(h[f+n.Y]-d)*g}l==i.setup?(p.shearX=p.data.shearX+u*s,p.shearY=p.data.shearY+d*s):(p.shearX+=(p.data.shearX+u-p.shearX)*s,p.shearY+=(p.data.shearY+d-p.shearY)*s)}},n}(s);t.ShearTimeline=c;var h=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*r.ENTRIES),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.color<<24)+this.slotIndex},r.prototype.setFrame=function(t,e,i,n,o,a){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.R]=i,this.frames[t+r.G]=n,this.frames[t+r.B]=o,this.frames[t+r.A]=a},r.prototype.apply=function(t,n,o,a,s,l,c){var h=t.slots[this.slotIndex],p=this.frames;if(o<p[0])switch(l){case i.setup:return void h.color.setFromColor(h.data.color);case i.current:var u=h.color,d=h.data.color;u.add((d.r-u.r)*s,(d.g-u.g)*s,(d.b-u.b)*s,(d.a-u.a)*s)}else{var f=0,m=0,g=0,y=0;if(o>=p[p.length-r.ENTRIES]){var v=p.length;f=p[v+r.PREV_R],m=p[v+r.PREV_G],g=p[v+r.PREV_B],y=p[v+r.PREV_A]}else{var b=e.binarySearch(p,o,r.ENTRIES);f=p[b+r.PREV_R],m=p[b+r.PREV_G],g=p[b+r.PREV_B],y=p[b+r.PREV_A];var w=p[b],x=this.getCurvePercent(b/r.ENTRIES-1,1-(o-w)/(p[b+r.PREV_TIME]-w));f+=(p[b+r.R]-f)*x,m+=(p[b+r.G]-m)*x,g+=(p[b+r.B]-g)*x,y+=(p[b+r.A]-y)*x}if(1==s)h.color.set(f,m,g,y);else{u=h.color;l==i.setup&&u.setFromColor(h.data.color),u.add((f-u.r)*s,(m-u.g)*s,(g-u.b)*s,(y-u.a)*s)}}},r.ENTRIES=5,r.PREV_TIME=-5,r.PREV_R=-4,r.PREV_G=-3,r.PREV_B=-2,r.PREV_A=-1,r.R=1,r.G=2,r.B=3,r.A=4,r}(r);t.ColorTimeline=h;var p=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*r.ENTRIES),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.twoColor<<24)+this.slotIndex},r.prototype.setFrame=function(t,e,i,n,o,a,s,l,c){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.R]=i,this.frames[t+r.G]=n,this.frames[t+r.B]=o,this.frames[t+r.A]=a,this.frames[t+r.R2]=s,this.frames[t+r.G2]=l,this.frames[t+r.B2]=c},r.prototype.apply=function(t,n,o,a,s,l,c){var h=t.slots[this.slotIndex],p=this.frames;if(o<p[0])switch(l){case i.setup:return h.color.setFromColor(h.data.color),void h.darkColor.setFromColor(h.data.darkColor);case i.current:var u=h.color,d=h.darkColor,f=h.data.color,m=h.data.darkColor;u.add((f.r-u.r)*s,(f.g-u.g)*s,(f.b-u.b)*s,(f.a-u.a)*s),d.add((m.r-d.r)*s,(m.g-d.g)*s,(m.b-d.b)*s,0)}else{var g=0,y=0,v=0,b=0,w=0,x=0,_=0;if(o>=p[p.length-r.ENTRIES]){var S=p.length;g=p[S+r.PREV_R],y=p[S+r.PREV_G],v=p[S+r.PREV_B],b=p[S+r.PREV_A],w=p[S+r.PREV_R2],x=p[S+r.PREV_G2],_=p[S+r.PREV_B2]}else{var T=e.binarySearch(p,o,r.ENTRIES);g=p[T+r.PREV_R],y=p[T+r.PREV_G],v=p[T+r.PREV_B],b=p[T+r.PREV_A],w=p[T+r.PREV_R2],x=p[T+r.PREV_G2],_=p[T+r.PREV_B2];var P=p[T],C=this.getCurvePercent(T/r.ENTRIES-1,1-(o-P)/(p[T+r.PREV_TIME]-P));g+=(p[T+r.R]-g)*C,y+=(p[T+r.G]-y)*C,v+=(p[T+r.B]-v)*C,b+=(p[T+r.A]-b)*C,w+=(p[T+r.R2]-w)*C,x+=(p[T+r.G2]-x)*C,_+=(p[T+r.B2]-_)*C}if(1==s)h.color.set(g,y,v,b),h.darkColor.set(w,x,_,1);else{var u=h.color,d=h.darkColor;l==i.setup&&(u.setFromColor(h.data.color),d.setFromColor(h.data.darkColor)),u.add((g-u.r)*s,(y-u.g)*s,(v-u.b)*s,(b-u.a)*s),d.add((w-d.r)*s,(x-d.g)*s,(_-d.b)*s,0)}}},r.ENTRIES=8,r.PREV_TIME=-8,r.PREV_R=-7,r.PREV_G=-6,r.PREV_B=-5,r.PREV_A=-4,r.PREV_R2=-3,r.PREV_G2=-2,r.PREV_B2=-1,r.R=1,r.G=2,r.B=3,r.A=4,r.R2=5,r.G2=6,r.B2=7,r}(r);t.TwoColorTimeline=p;var u=function(){function r(e){this.frames=t.Utils.newFloatArray(e),this.attachmentNames=new Array(e)}return r.prototype.getPropertyId=function(){return(o.attachment<<24)+this.slotIndex},r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},r.prototype.apply=function(t,o,r,a,s,l,c){var h=t.slots[this.slotIndex];if(c!=n.out||l!=i.setup){var p=this.frames;if(r<p[0]){if(l==i.setup){var u=h.data.attachmentName;h.setAttachment(null==u?null:t.getAttachment(this.slotIndex,u))}}else{var d=0;d=r>=p[p.length-1]?p.length-1:e.binarySearch(p,r,1)-1;var f=this.attachmentNames[d];t.slots[this.slotIndex].setAttachment(null==f?null:t.getAttachment(this.slotIndex,f))}}else{var m=h.data.attachmentName;h.setAttachment(null==m?null:t.getAttachment(this.slotIndex,m))}},r}();t.AttachmentTimeline=u;var d=null,f=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e),i.frameVertices=new Array(e),null==d&&(d=t.Utils.newFloatArray(64)),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.deform<<27)+ +this.attachment.id+this.slotIndex},r.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.frameVertices[t]=i},r.prototype.apply=function(n,o,r,a,s,l,c){var h=n.slots[this.slotIndex],p=h.getAttachment();if(p instanceof t.VertexAttachment&&p.applyDeform(this.attachment)){var u=h.attachmentVertices,f=this.frameVertices,m=f[0].length,g=t.Utils.setArraySize(u,m),y=this.frames;if(r<y[0]){var v=p;switch(l){case i.setup:var b=void 0;return null==v.bones?b=v.vertices:(b=d).length<m&&(d=b=t.Utils.newFloatArray(m)),void t.Utils.arrayCopy(b,0,g,0,m);case i.current:if(1==s)break;if(null==v.bones)for(var w=v.vertices,x=0;x<m;x++)g[x]+=(w[x]-g[x])*s;else{s=1-s;for(var _=0;_<m;_++)g[_]*=s}}}else if(r>=y[y.length-1]){var S=f[y.length-1];if(1==s)t.Utils.arrayCopy(S,0,g,0,m);else if(l==i.setup)if(null==(v=p).bones)for(var w=v.vertices,T=0;T<m;T++){E=w[T];g[T]=E+(S[T]-E)*s}else for(var P=0;P<m;P++)g[P]=S[P]*s;else for(var C=0;C<m;C++)g[C]+=(S[C]-g[C])*s}else{var I=e.binarySearch(y,r),k=f[I-1],A=f[I],M=y[I],O=this.getCurvePercent(I-1,1-(r-M)/(y[I-1]-M));if(1==s)for(var R=0;R<m;R++){G=k[R];g[R]=G+(A[R]-G)*O}else if(l==i.setup)if(null==(v=p).bones)for(var w=v.vertices,B=0;B<m;B++){var G=k[B],E=w[B];g[B]=E+(G+(A[B]-G)*O-E)*s}else for(var D=0;D<m;D++){G=k[D];g[D]=(G+(A[D]-G)*O)*s}else for(var L=0;L<m;L++){G=k[L];g[L]+=(G+(A[L]-G)*O-g[L])*s}}}},r}(r);t.DeformTimeline=f;var m=function(){function i(e){this.frames=t.Utils.newFloatArray(e),this.events=new Array(e)}return i.prototype.getPropertyId=function(){return o.event<<24},i.prototype.getFrameCount=function(){return this.frames.length},i.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},i.prototype.apply=function(t,i,n,o,r,a,s){if(null!=o){var l=this.frames,c=this.frames.length;if(i>n)this.apply(t,i,Number.MAX_VALUE,o,r,a,s),i=-1;else if(i>=l[c-1])return;if(!(n<l[0])){var h=0;if(i<l[0])h=0;else for(var p=l[h=e.binarySearch(l,i)];h>0&&l[h-1]==p;)h--;for(;h<c&&n>=l[h];h++)o.push(this.events[h])}}},i}();t.EventTimeline=m;var g=function(){function r(e){this.frames=t.Utils.newFloatArray(e),this.drawOrders=new Array(e)}return r.prototype.getPropertyId=function(){return o.drawOrder<<24},r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.drawOrders[t]=i},r.prototype.apply=function(o,r,a,s,l,c,h){var p=o.drawOrder,u=o.slots;if(h!=n.out||c!=i.setup){var d=this.frames;if(a<d[0])c==i.setup&&t.Utils.arrayCopy(o.slots,0,o.drawOrder,0,o.slots.length);else{var f=0;f=a>=d[d.length-1]?d.length-1:e.binarySearch(d,a)-1;var m=this.drawOrders[f];if(null==m)t.Utils.arrayCopy(u,0,p,0,u.length);else for(var g=0,y=m.length;g<y;g++)p[g]=u[m[g]]}}else t.Utils.arrayCopy(o.slots,0,o.drawOrder,0,o.slots.length)},r}();t.DrawOrderTimeline=g;var y=function(r){function a(e){var i=r.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*a.ENTRIES),i}return __extends(a,r),a.prototype.getPropertyId=function(){return(o.ikConstraint<<24)+this.ikConstraintIndex},a.prototype.setFrame=function(t,e,i,n){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.MIX]=i,this.frames[t+a.BEND_DIRECTION]=n},a.prototype.apply=function(t,o,r,s,l,c,h){var p=this.frames,u=t.ikConstraints[this.ikConstraintIndex];if(r<p[0])switch(c){case i.setup:return u.mix=u.data.mix,void(u.bendDirection=u.data.bendDirection);case i.current:u.mix+=(u.data.mix-u.mix)*l,u.bendDirection=u.data.bendDirection}else if(r>=p[p.length-a.ENTRIES])c==i.setup?(u.mix=u.data.mix+(p[p.length+a.PREV_MIX]-u.data.mix)*l,u.bendDirection=h==n.out?u.data.bendDirection:p[p.length+a.PREV_BEND_DIRECTION]):(u.mix+=(p[p.length+a.PREV_MIX]-u.mix)*l,h==n.in&&(u.bendDirection=p[p.length+a.PREV_BEND_DIRECTION]));else{var d=e.binarySearch(p,r,a.ENTRIES),f=p[d+a.PREV_MIX],m=p[d],g=this.getCurvePercent(d/a.ENTRIES-1,1-(r-m)/(p[d+a.PREV_TIME]-m));c==i.setup?(u.mix=u.data.mix+(f+(p[d+a.MIX]-f)*g-u.data.mix)*l,u.bendDirection=h==n.out?u.data.bendDirection:p[d+a.PREV_BEND_DIRECTION]):(u.mix+=(f+(p[d+a.MIX]-f)*g-u.mix)*l,h==n.in&&(u.bendDirection=p[d+a.PREV_BEND_DIRECTION]))}},a.ENTRIES=3,a.PREV_TIME=-3,a.PREV_MIX=-2,a.PREV_BEND_DIRECTION=-1,a.MIX=1,a.BEND_DIRECTION=2,a}(r);t.IkConstraintTimeline=y;var v=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*r.ENTRIES),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.transformConstraint<<24)+this.transformConstraintIndex},r.prototype.setFrame=function(t,e,i,n,o,a){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.ROTATE]=i,this.frames[t+r.TRANSLATE]=n,this.frames[t+r.SCALE]=o,this.frames[t+r.SHEAR]=a},r.prototype.apply=function(t,n,o,a,s,l,c){var h=this.frames,p=t.transformConstraints[this.transformConstraintIndex];if(o<h[0]){w=p.data;switch(l){case i.setup:return p.rotateMix=w.rotateMix,p.translateMix=w.translateMix,p.scaleMix=w.scaleMix,void(p.shearMix=w.shearMix);case i.current:p.rotateMix+=(w.rotateMix-p.rotateMix)*s,p.translateMix+=(w.translateMix-p.translateMix)*s,p.scaleMix+=(w.scaleMix-p.scaleMix)*s,p.shearMix+=(w.shearMix-p.shearMix)*s}}else{var u=0,d=0,f=0,m=0;if(o>=h[h.length-r.ENTRIES]){var g=h.length;u=h[g+r.PREV_ROTATE],d=h[g+r.PREV_TRANSLATE],f=h[g+r.PREV_SCALE],m=h[g+r.PREV_SHEAR]}else{var y=e.binarySearch(h,o,r.ENTRIES);u=h[y+r.PREV_ROTATE],d=h[y+r.PREV_TRANSLATE],f=h[y+r.PREV_SCALE],m=h[y+r.PREV_SHEAR];var v=h[y],b=this.getCurvePercent(y/r.ENTRIES-1,1-(o-v)/(h[y+r.PREV_TIME]-v));u+=(h[y+r.ROTATE]-u)*b,d+=(h[y+r.TRANSLATE]-d)*b,f+=(h[y+r.SCALE]-f)*b,m+=(h[y+r.SHEAR]-m)*b}if(l==i.setup){var w=p.data;p.rotateMix=w.rotateMix+(u-w.rotateMix)*s,p.translateMix=w.translateMix+(d-w.translateMix)*s,p.scaleMix=w.scaleMix+(f-w.scaleMix)*s,p.shearMix=w.shearMix+(m-w.shearMix)*s}else p.rotateMix+=(u-p.rotateMix)*s,p.translateMix+=(d-p.translateMix)*s,p.scaleMix+=(f-p.scaleMix)*s,p.shearMix+=(m-p.shearMix)*s}},r.ENTRIES=5,r.PREV_TIME=-5,r.PREV_ROTATE=-4,r.PREV_TRANSLATE=-3,r.PREV_SCALE=-2,r.PREV_SHEAR=-1,r.ROTATE=1,r.TRANSLATE=2,r.SCALE=3,r.SHEAR=4,r}(r);t.TransformConstraintTimeline=v;var b=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*r.ENTRIES),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.pathConstraintPosition<<24)+this.pathConstraintIndex},r.prototype.setFrame=function(t,e,i){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.VALUE]=i},r.prototype.apply=function(t,n,o,a,s,l,c){var h=this.frames,p=t.pathConstraints[this.pathConstraintIndex];if(o<h[0])switch(l){case i.setup:return void(p.position=p.data.position);case i.current:p.position+=(p.data.position-p.position)*s}else{var u=0;if(o>=h[h.length-r.ENTRIES])u=h[h.length+r.PREV_VALUE];else{var d=e.binarySearch(h,o,r.ENTRIES);u=h[d+r.PREV_VALUE];var f=h[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(o-f)/(h[d+r.PREV_TIME]-f));u+=(h[d+r.VALUE]-u)*m}l==i.setup?p.position=p.data.position+(u-p.data.position)*s:p.position+=(u-p.position)*s}},r.ENTRIES=2,r.PREV_TIME=-2,r.PREV_VALUE=-1,r.VALUE=1,r}(r);t.PathConstraintPositionTimeline=b;var w=function(t){function n(e){return t.call(this,e)||this}return __extends(n,t),n.prototype.getPropertyId=function(){return(o.pathConstraintSpacing<<24)+this.pathConstraintIndex},n.prototype.apply=function(t,o,r,a,s,l,c){var h=this.frames,p=t.pathConstraints[this.pathConstraintIndex];if(r<h[0])switch(l){case i.setup:return void(p.spacing=p.data.spacing);case i.current:p.spacing+=(p.data.spacing-p.spacing)*s}else{var u=0;if(r>=h[h.length-n.ENTRIES])u=h[h.length+n.PREV_VALUE];else{var d=e.binarySearch(h,r,n.ENTRIES);u=h[d+n.PREV_VALUE];var f=h[d],m=this.getCurvePercent(d/n.ENTRIES-1,1-(r-f)/(h[d+n.PREV_TIME]-f));u+=(h[d+n.VALUE]-u)*m}l==i.setup?p.spacing=p.data.spacing+(u-p.data.spacing)*s:p.spacing+=(u-p.spacing)*s}},n}(b);t.PathConstraintSpacingTimeline=w;var x=function(n){function r(e){var i=n.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*r.ENTRIES),i}return __extends(r,n),r.prototype.getPropertyId=function(){return(o.pathConstraintMix<<24)+this.pathConstraintIndex},r.prototype.setFrame=function(t,e,i,n){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.ROTATE]=i,this.frames[t+r.TRANSLATE]=n},r.prototype.apply=function(t,n,o,a,s,l,c){var h=this.frames,p=t.pathConstraints[this.pathConstraintIndex];if(o<h[0])switch(l){case i.setup:return p.rotateMix=p.data.rotateMix,void(p.translateMix=p.data.translateMix);case i.current:p.rotateMix+=(p.data.rotateMix-p.rotateMix)*s,p.translateMix+=(p.data.translateMix-p.translateMix)*s}else{var u=0,d=0;if(o>=h[h.length-r.ENTRIES])u=h[h.length+r.PREV_ROTATE],d=h[h.length+r.PREV_TRANSLATE];else{var f=e.binarySearch(h,o,r.ENTRIES);u=h[f+r.PREV_ROTATE],d=h[f+r.PREV_TRANSLATE];var m=h[f],g=this.getCurvePercent(f/r.ENTRIES-1,1-(o-m)/(h[f+r.PREV_TIME]-m));u+=(h[f+r.ROTATE]-u)*g,d+=(h[f+r.TRANSLATE]-d)*g}l==i.setup?(p.rotateMix=p.data.rotateMix+(u-p.data.rotateMix)*s,p.translateMix=p.data.translateMix+(d-p.data.translateMix)*s):(p.rotateMix+=(u-p.rotateMix)*s,p.translateMix+=(d-p.translateMix)*s)}},r.ENTRIES=3,r.PREV_TIME=-3,r.PREV_ROTATE=-2,r.PREV_TRANSLATE=-1,r.ROTATE=1,r.TRANSLATE=2,r}(r);t.PathConstraintMixTimeline=x}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(e){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new n(this),this.propertyIDs=new t.IntSet,this.mixingTo=new Array,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new t.Pool(function(){return new i}),this.data=e}return e.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,i=0,n=e.length;i<n;i++){var o=e[i];if(null!=o){o.animationLast=o.nextAnimationLast,o.trackLast=o.nextTrackLast;var r=t*o.timeScale;if(o.delay>0){if(o.delay-=r,o.delay>0)continue;r=-o.delay,o.delay=0}var a=o.next;if(null!=a){var s=o.trackLast-a.delay;if(s>=0){for(a.delay=0,a.trackTime=s+t*a.timeScale,o.trackTime+=r,this.setCurrent(i,a,!0);null!=a.mixingFrom;)a.mixTime+=r,a=a.mixingFrom;continue}}else if(o.trackLast>=o.trackEnd&&null==o.mixingFrom){e[i]=null,this.queue.end(o),this.disposeNext(o);continue}if(null!=o.mixingFrom&&this.updateMixingFrom(o,t)){var l=o.mixingFrom;for(o.mixingFrom=null;null!=l;)this.queue.end(l),l=l.mixingFrom}o.trackTime+=r}}this.queue.drain()},e.prototype.updateMixingFrom=function(t,e){var i=t.mixingFrom;if(null==i)return!0;var n=this.updateMixingFrom(i,e);return t.mixTime>0&&(t.mixTime>=t.mixDuration||0==t.timeScale)?(0==i.totalAlpha&&(t.mixingFrom=i.mixingFrom,t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),n):(i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,i.trackTime+=e*i.timeScale,t.mixTime+=e*t.timeScale,!1)},e.prototype.apply=function(i){if(null==i)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var n=this.events,o=this.tracks,r=!1,a=0,s=o.length;a<s;a++){var l=o[a];if(!(null==l||l.delay>0)){r=!0;var c=0==a?t.MixPose.current:t.MixPose.currentLayered,h=l.alpha;null!=l.mixingFrom?h*=this.applyMixingFrom(l,i,c):l.trackTime>=l.trackEnd&&null==l.next&&(h=0);var p=l.animationLast,u=l.getAnimationTime(),d=l.animation.timelines.length,f=l.animation.timelines;if(1==h)for(v=0;v<d;v++)f[v].apply(i,p,u,n,1,t.MixPose.setup,t.MixDirection.in);else{var m=l.timelineData,g=0==l.timelinesRotation.length;g&&t.Utils.setArraySize(l.timelinesRotation,d<<1,null);for(var y=l.timelinesRotation,v=0;v<d;v++){var b=f[v],w=m[v]>=e.FIRST?t.MixPose.setup:c;b instanceof t.RotateTimeline?this.applyRotateTimeline(b,i,u,h,w,y,v<<1,g):b.apply(i,p,u,n,h,w,t.MixDirection.in)}}this.queueEvents(l,u),n.length=0,l.nextAnimationLast=u,l.nextTrackLast=l.trackTime}}return this.queue.drain(),r},e.prototype.applyMixingFrom=function(i,n,o){var r=i.mixingFrom;null!=r.mixingFrom&&this.applyMixingFrom(r,n,o);var a=0;0==i.mixDuration?a=1:(a=i.mixTime/i.mixDuration)>1&&(a=1);var s=a<r.eventThreshold?this.events:null,l=a<r.attachmentThreshold,c=a<r.drawOrderThreshold,h=r.animationLast,p=r.getAnimationTime(),u=r.animation.timelines.length,d=r.animation.timelines,f=r.timelineData,m=r.timelineDipMix,g=0==r.timelinesRotation.length;g&&t.Utils.setArraySize(r.timelinesRotation,u<<1,null);var y,v=r.timelinesRotation,b=r.alpha*i.interruptAlpha,w=b*(1-a),x=0;r.totalAlpha=0;for(var _=0;_<u;_++){var S=d[_];switch(f[_]){case e.SUBSEQUENT:if(!l&&S instanceof t.AttachmentTimeline)continue;if(!c&&S instanceof t.DrawOrderTimeline)continue;y=o,x=w;break;case e.FIRST:y=t.MixPose.setup,x=w;break;case e.DIP:y=t.MixPose.setup,x=b;break;default:y=t.MixPose.setup,x=b;var T=m[_];x*=Math.max(0,1-T.mixTime/T.mixDuration)}r.totalAlpha+=x,S instanceof t.RotateTimeline?this.applyRotateTimeline(S,n,p,x,y,v,_<<1,g):S.apply(n,h,p,s,x,y,t.MixDirection.out)}return i.mixDuration>0&&this.queueEvents(r,p),this.events.length=0,r.nextAnimationLast=p,r.nextTrackLast=r.trackTime,a},e.prototype.applyRotateTimeline=function(e,i,n,o,r,a,s,l){if(l&&(a[s]=0),1!=o){var c=e,h=c.frames,p=i.bones[c.boneIndex];if(n<h[0])r==t.MixPose.setup&&(p.rotation=p.data.rotation);else{var u=0;if(n>=h[h.length-t.RotateTimeline.ENTRIES])u=p.data.rotation+h[h.length+t.RotateTimeline.PREV_ROTATION];else{var d=t.Animation.binarySearch(h,n,t.RotateTimeline.ENTRIES),f=h[d+t.RotateTimeline.PREV_ROTATION],m=h[d],g=c.getCurvePercent((d>>1)-1,1-(n-m)/(h[d+t.RotateTimeline.PREV_TIME]-m));u=h[d+t.RotateTimeline.ROTATION]-f,u=f+(u-=360*(16384-(16384.499999999996-u/360|0)))*g+p.data.rotation,u-=360*(16384-(16384.499999999996-u/360|0))}var y=r==t.MixPose.setup?p.data.rotation:p.rotation,v=0,b=u-y;if(0==b)v=a[s];else{b-=360*(16384-(16384.499999999996-b/360|0));var w=0,x=0;l?(w=0,x=b):(w=a[s],x=a[s+1]);var _=b>0,S=w>=0;t.MathUtils.signum(x)!=t.MathUtils.signum(b)&&Math.abs(x)<=90&&(Math.abs(w)>180&&(w+=360*t.MathUtils.signum(w)),S=_),v=b+w-w%360,S!=_&&(v+=360*t.MathUtils.signum(w)),a[s]=v}a[s+1]=b,y+=v*o,p.rotation=y-360*(16384-(16384.499999999996-y/360|0))}}else e.apply(i,0,n,null,1,r,t.MixDirection.in)},e.prototype.queueEvents=function(t,e){for(var i=t.animationStart,n=t.animationEnd,o=n-i,r=t.trackLast%o,a=this.events,s=0,l=a.length;s<l;s++){var c=a[s];if(c.time<r)break;c.time>n||this.queue.event(t,c)}for((t.loop?r>t.trackTime%o:e>=n&&t.animationLast<n)&&this.queue.complete(t);s<l;s++)a[s].time<i||this.queue.event(t,a[s])},e.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},e.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var i=e;;){var n=i.mixingFrom;if(null==n)break;this.queue.end(n),i.mixingFrom=null,i=n}this.tracks[e.trackIndex]=null,this.queue.drain()}}},e.prototype.setCurrent=function(t,e,i){var n=this.expandToIndex(t);this.tracks[t]=e,null!=n&&(i&&this.queue.interrupt(n),e.mixingFrom=n,e.mixTime=0,null!=n.mixingFrom&&n.mixDuration>0&&(e.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(e)},e.prototype.setAnimation=function(t,e,i){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,n,i)},e.prototype.setAnimationWith=function(t,e,i){if(null==e)throw new Error("animation cannot be null.");var n=!0,o=this.expandToIndex(t);null!=o&&(-1==o.nextTrackLast?(this.tracks[t]=o.mixingFrom,this.queue.interrupt(o),this.queue.end(o),this.disposeNext(o),o=o.mixingFrom,n=!1):this.disposeNext(o));var r=this.trackEntry(t,e,i,o);return this.setCurrent(t,r,n),this.queue.drain(),r},e.prototype.addAnimation=function(t,e,i,n){var o=this.data.skeletonData.findAnimation(e);if(null==o)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,o,i,n)},e.prototype.addAnimationWith=function(t,e,i,n){if(null==e)throw new Error("animation cannot be null.");var o=this.expandToIndex(t);if(null!=o)for(;null!=o.next;)o=o.next;var r=this.trackEntry(t,e,i,o);if(null==o)this.setCurrent(t,r,!0),this.queue.drain();else if(o.next=r,n<=0){var a=o.animationEnd-o.animationStart;0!=a?n+=a*(1+(o.trackTime/a|0))-this.data.getMix(o.animation,e):n=0}return r.delay=n,r},e.prototype.setEmptyAnimation=function(t,i){var n=this.setAnimationWith(t,e.emptyAnimation,!1);return n.mixDuration=i,n.trackEnd=i,n},e.prototype.addEmptyAnimation=function(t,i,n){n<=0&&(n-=i);var o=this.addAnimationWith(t,e.emptyAnimation,!1,n);return o.mixDuration=i,o.trackEnd=i,o},e.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var i=0,n=this.tracks.length;i<n;i++){var o=this.tracks[i];null!=o&&this.setEmptyAnimation(o.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},e.prototype.expandToIndex=function(e){return e<this.tracks.length?this.tracks[e]:(t.Utils.ensureArrayCapacity(this.tracks,e-this.tracks.length+1,null),this.tracks.length=e+1,null)},e.prototype.trackEntry=function(t,e,i,n){var o=this.trackEntryPool.obtain();return o.trackIndex=t,o.animation=e,o.loop=i,o.eventThreshold=0,o.attachmentThreshold=0,o.drawOrderThreshold=0,o.animationStart=0,o.animationEnd=e.duration,o.animationLast=-1,o.nextAnimationLast=-1,o.delay=0,o.trackTime=0,o.trackLast=-1,o.nextTrackLast=-1,o.trackEnd=Number.MAX_VALUE,o.timeScale=1,o.alpha=1,o.interruptAlpha=1,o.mixTime=0,o.mixDuration=null==n?0:this.data.getMix(n.animation,e),o},e.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},e.prototype._animationsChanged=function(){this.animationsChanged=!1;var t=this.propertyIDs;t.clear();for(var e=this.mixingTo,i=0,n=this.tracks.length;i<n;i++){var o=this.tracks[i];null!=o&&o.setTimelineData(null,e,t)}},e.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},e.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},e.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},e.prototype.clearListeners=function(){this.listeners.length=0},e.prototype.clearListenerNotifications=function(){this.queue.clear()},e.prototype.setAnimationByName=function(t,i,n){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,i,n)},e.prototype.addAnimationByName=function(t,i,n,o){e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,i,n,o)},e.prototype.hasAnimation=function(t){return null!==this.data.skeletonData.findAnimation(t)},e.prototype.hasAnimationByName=function(t){return e.deprecatedWarning3||(e.deprecatedWarning3=!0,console.warn("Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)},e.emptyAnimation=new t.Animation("<empty>",[],0),e.SUBSEQUENT=0,e.FIRST=1,e.DIP=2,e.DIP_MIX=3,e.deprecatedWarning1=!1,e.deprecatedWarning2=!1,e.deprecatedWarning3=!1,e}();t.AnimationState=e;var i=function(){function i(){this.timelineData=new Array,this.timelineDipMix=new Array,this.timelinesRotation=new Array}return i.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.animation=null,this.listener=null,this.timelineData.length=0,this.timelineDipMix.length=0,this.timelinesRotation.length=0},i.prototype.setTimelineData=function(i,n,o){null!=i&&n.push(i);var r=null!=this.mixingFrom?this.mixingFrom.setTimelineData(this,n,o):this;null!=i&&n.pop();var a=n,s=n.length-1,l=this.animation.timelines,c=this.animation.timelines.length,h=t.Utils.setArraySize(this.timelineData,c);this.timelineDipMix.length=0;var p=t.Utils.setArraySize(this.timelineDipMix,c);t:for(var u=0;u<c;u++){var d=l[u].getPropertyId();if(o.add(d))if(null!=i&&i.hasTimeline(d)){for(var f=s;f>=0;f--){var m=a[f];if(!m.hasTimeline(d)&&m.mixDuration>0){h[u]=e.DIP_MIX,p[u]=m;continue t}}h[u]=e.DIP}else h[u]=e.FIRST;else h[u]=e.SUBSEQUENT}return r},i.prototype.hasTimeline=function(t){for(var e=this.animation.timelines,i=0,n=e.length;i<n;i++)if(e[i].getPropertyId()==t)return!0;return!1},i.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},i.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},i.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},i.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},Object.defineProperty(i.prototype,"time",{get:function(){return i.deprecatedWarning1||(i.deprecatedWarning1=!0,console.warn("Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(t){i.deprecatedWarning1||(i.deprecatedWarning1=!0,console.warn("Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"endTime",{get:function(){return i.deprecatedWarning2||(i.deprecatedWarning2=!0,console.warn("Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(t){i.deprecatedWarning2||(i.deprecatedWarning2=!0,console.warn("Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t},enumerable:!0,configurable:!0}),i.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},i.deprecatedWarning1=!1,i.deprecatedWarning2=!1,i}();t.TrackEntry=i;var n=function(){function e(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return e.prototype.start=function(t){this.objects.push(o.start),this.objects.push(t),this.animState.animationsChanged=!0},e.prototype.interrupt=function(t){this.objects.push(o.interrupt),this.objects.push(t)},e.prototype.end=function(t){this.objects.push(o.end),this.objects.push(t),this.animState.animationsChanged=!0},e.prototype.dispose=function(t){this.objects.push(o.dispose),this.objects.push(t)},e.prototype.complete=function(t){this.objects.push(o.complete),this.objects.push(t)},e.prototype.event=function(t,e){this.objects.push(o.event),this.objects.push(t),this.objects.push(e)},e.prototype.deprecateStuff=function(){return e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0},e.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var e=this.objects,i=this.animState.listeners,n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];switch(r){case o.start:null!=a.listener&&a.listener.start&&a.listener.start(a);for(c=0;c<i.length;c++)i[c].start&&i[c].start(a);a.onStart&&this.deprecateStuff()&&a.onStart(a.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(a.trackIndex);break;case o.interrupt:null!=a.listener&&a.listener.interrupt&&a.listener.interrupt(a);for(c=0;c<i.length;c++)i[c].interrupt&&i[c].interrupt(a);break;case o.end:null!=a.listener&&a.listener.end&&a.listener.end(a);for(c=0;c<i.length;c++)i[c].end&&i[c].end(a);a.onEnd&&this.deprecateStuff()&&a.onEnd(a.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(a.trackIndex);case o.dispose:null!=a.listener&&a.listener.dispose&&a.listener.dispose(a);for(c=0;c<i.length;c++)i[c].dispose&&i[c].dispose(a);this.animState.trackEntryPool.free(a);break;case o.complete:null!=a.listener&&a.listener.complete&&a.listener.complete(a);for(c=0;c<i.length;c++)i[c].complete&&i[c].complete(a);var s=t.MathUtils.toInt(a.loopsCount());a.onComplete&&this.deprecateStuff()&&a.onComplete(a.trackIndex,s),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(a.trackIndex,s);break;case o.event:var l=e[2+n++];null!=a.listener&&a.listener.event&&a.listener.event(a,l);for(var c=0;c<i.length;c++)i[c].event&&i[c].event(a,l);a.onEvent&&this.deprecateStuff()&&a.onEvent(a.trackIndex,l),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(a.trackIndex,l)}}this.clear(),this.drainDisabled=!1}},e.prototype.clear=function(){this.objects.length=0},e.deprecatedWarning1=!1,e}();t.EventQueue=n;var o;!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(o=t.EventType||(t.EventType={}));var r=function(){function t(){}return t.prototype.start=function(t){},t.prototype.interrupt=function(t){},t.prototype.end=function(t){},t.prototype.dispose=function(t){},t.prototype.complete=function(t){},t.prototype.event=function(t,e){},t}();t.AnimationStateAdapter2=r}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function t(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return t.prototype.setMix=function(t,e,i){var n=this.skeletonData.findAnimation(t);if(null==n)throw new Error("Animation not found: "+t);var o=this.skeletonData.findAnimation(e);if(null==o)throw new Error("Animation not found: "+e);this.setMixWith(n,o,i)},t.prototype.setMixByName=function(e,i,n){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(e,i,n)},t.prototype.setMixWith=function(t,e,i){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var n=t.name+e.name;this.animationToMixTime[n]=i},t.prototype.getMix=function(t,e){var i=t.name+e.name,n=this.animationToMixTime[i];return void 0===n?this.defaultMix:n},t.deprecatedWarning1=!1,t}();t.AnimationStateData=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t){this.atlas=t}return e.prototype.newRegionAttachment=function(e,i,n){var o=this.atlas.findRegion(n);if(null==o)throw new Error("Region not found in atlas: "+n+" (region attachment: "+i+")");var r=new t.RegionAttachment(i);return r.region=o,r},e.prototype.newMeshAttachment=function(e,i,n){var o=this.atlas.findRegion(n);if(null==o)throw new Error("Region not found in atlas: "+n+" (mesh attachment: "+i+")");var r=new t.MeshAttachment(i);return r.region=o,r},e.prototype.newBoundingBoxAttachment=function(e,i){return new t.BoundingBoxAttachment(i)},e.prototype.newPathAttachment=function(e,i){return new t.PathAttachment(i)},e.prototype.newPointAttachment=function(e,i){return new t.PointAttachment(i)},e.prototype.newClippingAttachment=function(e,i){return new t.ClippingAttachment(i)},e}();t.AtlasAttachmentLoader=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){!function(t){t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"}(t.BlendMode||(t.BlendMode={}))}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t,e,i){if(this.matrix=new PIXI.Matrix,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}return Object.defineProperty(e.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!0,configurable:!0}),e.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransformWith=function(i,n,o,r,a,s,l){this.ax=i,this.ay=n,this.arotation=o,this.ascaleX=r,this.ascaleY=a,this.ashearX=s,this.ashearY=l,this.appliedValid=!0;var c=this.parent,h=this.matrix;if(null==c){var p=o+90+l,u=t.MathUtils.cosDeg(o+s)*r,d=t.MathUtils.cosDeg(p)*a,f=t.MathUtils.sinDeg(o+s)*r,m=t.MathUtils.sinDeg(p)*a,g=this.skeleton;return g.flipX&&(i=-i,u=-u,d=-d),g.flipY!==e.yDown&&(n=-n,f=-f,m=-m),h.a=u,h.c=d,h.b=f,h.d=m,h.tx=i+g.x,void(h.ty=n+g.y)}var y=c.matrix.a,v=c.matrix.c,b=c.matrix.b,w=c.matrix.d;switch(h.tx=y*i+v*n+c.matrix.tx,h.ty=b*i+w*n+c.matrix.ty,this.data.transformMode){case t.TransformMode.Normal:var p=o+90+l,u=t.MathUtils.cosDeg(o+s)*r,d=t.MathUtils.cosDeg(p)*a,f=t.MathUtils.sinDeg(o+s)*r,m=t.MathUtils.sinDeg(p)*a;return h.a=y*u+v*f,h.c=y*d+v*m,h.b=b*u+w*f,void(h.d=b*d+w*m);case t.TransformMode.OnlyTranslation:p=o+90+l;h.a=t.MathUtils.cosDeg(o+s)*r,h.c=t.MathUtils.cosDeg(p)*a,h.b=t.MathUtils.sinDeg(o+s)*r,h.d=t.MathUtils.sinDeg(p)*a;break;case t.TransformMode.NoRotationOrReflection:var x=0;(k=y*y+b*b)>1e-4?(v=b*(k=Math.abs(y*w-v*b)/k),w=y*k,x=Math.atan2(b,y)*t.MathUtils.radDeg):(y=0,b=0,x=90-Math.atan2(w,v)*t.MathUtils.radDeg);var _=o+s-x,S=o+l-x+90,u=t.MathUtils.cosDeg(_)*r,d=t.MathUtils.cosDeg(S)*a,f=t.MathUtils.sinDeg(_)*r,m=t.MathUtils.sinDeg(S)*a;h.a=y*u-v*f,h.c=y*d-v*m,h.b=b*u+w*f,h.d=b*d+w*m;break;case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:var T=t.MathUtils.cosDeg(o),P=t.MathUtils.sinDeg(o),C=y*T+v*P,I=b*T+w*P,k=Math.sqrt(C*C+I*I);k>1e-5&&(k=1/k),C*=k,I*=k,k=Math.sqrt(C*C+I*I);var A=Math.PI/2+Math.atan2(I,C),M=Math.cos(A)*k,O=Math.sin(A)*k,u=t.MathUtils.cosDeg(s)*r,d=t.MathUtils.cosDeg(90+l)*a,f=t.MathUtils.sinDeg(s)*r,m=t.MathUtils.sinDeg(90+l)*a;return h.a=C*u+M*f,h.c=C*d+M*m,h.b=I*u+O*f,h.d=I*d+O*m,void((this.data.transformMode!=t.TransformMode.NoScaleOrReflection?y*w-v*b<0:this.skeleton.flipX!=this.skeleton.flipY!=e.yDown)&&(h.c=-h.c,h.d=-h.d))}this.skeleton.flipX&&(h.a=-h.a,h.c=-h.c),this.skeleton.flipY!=e.yDown&&(h.b=-h.b,h.d=-h.d)},e.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},e.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*t.MathUtils.radDeg},e.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*t.MathUtils.radDeg},e.prototype.getWorldScaleX=function(){var t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)},e.prototype.getWorldScaleY=function(){var t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)},e.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var e=this.parent,i=this.matrix;if(null==e)return this.ax=i.tx,this.ay=i.ty,this.arotation=Math.atan2(i.b,i.a)*t.MathUtils.radDeg,this.ascaleX=Math.sqrt(i.a*i.a+i.b*i.b),this.ascaleY=Math.sqrt(i.c*i.c+i.d*i.d),this.ashearX=0,void(this.ashearY=Math.atan2(i.a*i.c+i.b*i.d,i.a*i.d-i.b*i.c)*t.MathUtils.radDeg);var n=e.matrix,o=1/(n.a*n.d-n.b*n.c),r=i.tx-n.tx,a=i.ty-n.ty;this.ax=r*n.d*o-a*n.c*o,this.ay=a*n.a*o-r*n.b*o;var s=o*n.d,l=o*n.a,c=o*n.c,h=o*n.b,p=s*i.a-c*i.b,u=s*i.c-c*i.d,d=l*i.b-h*i.a,f=l*i.d-h*i.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(p*p+d*d),this.ascaleX>1e-4){var m=p*f-u*d;this.ascaleY=m/this.ascaleX,this.ashearY=Math.atan2(p*u+d*f,m)*t.MathUtils.radDeg,this.arotation=Math.atan2(d,p)*t.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+f*f),this.ashearY=0,this.arotation=90-Math.atan2(f,u)*t.MathUtils.radDeg},e.prototype.worldToLocal=function(t){var e=this.matrix,i=e.a,n=e.c,o=e.b,r=e.d,a=1/(i*r-n*o),s=t.x-e.tx,l=t.y-e.ty;return t.x=s*r*a-l*n*a,t.y=l*i*a-s*o*a,t},e.prototype.localToWorld=function(t){var e=this.matrix,i=t.x,n=t.y;return t.x=i*e.a+n*e.c+e.tx,t.y=i*e.b+n*e.d+e.ty,t},e.prototype.worldToLocalRotation=function(e){var i=t.MathUtils.sinDeg(e),n=t.MathUtils.cosDeg(e),o=this.matrix;return Math.atan2(o.a*i-o.b*n,o.d*n-o.c*i)*t.MathUtils.radDeg},e.prototype.localToWorldRotation=function(e){var i=t.MathUtils.sinDeg(e),n=t.MathUtils.cosDeg(e),o=this.matrix;return Math.atan2(n*o.b+i*o.d,n*o.a+i*o.c)*t.MathUtils.radDeg},e.prototype.rotateWorld=function(e){var i=this.matrix,n=i.a,o=i.c,r=i.b,a=i.d,s=t.MathUtils.cosDeg(e),l=t.MathUtils.sinDeg(e);i.a=s*n-l*r,i.c=s*o-l*a,i.b=l*n+s*r,i.d=l*o+s*a,this.appliedValid=!1},e.yDown=!1,e}();t.Bone=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=i.Normal,t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}}();t.BoneData=e;var i;!function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"}(i=t.TransformMode||(t.TransformMode={}))}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e}}();t.Event=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(t){this.name=t}}();t.EventData=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t,e){if(this.mix=1,this.bendDirection=0,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.bones=new Array;for(var i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}return e.prototype.getOrder=function(){return this.data.order},e.prototype.apply=function(){this.update()},e.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.mix)}},e.prototype.apply1=function(e,i,n,o){e.appliedValid||e.updateAppliedTransform();var r=e.parent.matrix,a=1/(r.a*r.d-r.b*r.c),s=i-r.tx,l=n-r.ty,c=(s*r.d-l*r.c)*a-e.ax,h=(l*r.a-s*r.b)*a-e.ay,p=Math.atan2(h,c)*t.MathUtils.radDeg-e.ashearX-e.arotation;e.ascaleX<0&&(p+=180),p>180?p-=360:p<-180&&(p+=360),e.updateWorldTransformWith(e.ax,e.ay,e.arotation+p*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)},e.prototype.apply2=function(e,i,n,o,r,a){if(0!=a){e.appliedValid||e.updateAppliedTransform(),i.appliedValid||i.updateAppliedTransform();var s=e.ax,l=e.ay,c=e.ascaleX,h=e.ascaleY,p=i.ascaleX,u=e.matrix,d=0,f=0,m=0;c<0?(c=-c,d=180,m=-1):(d=0,m=1),h<0&&(h=-h,m=-m),p<0?(p=-p,f=180):f=0;var g=i.ax,y=0,v=0,b=0,w=u.a,x=u.c,_=u.b,S=u.d,T=Math.abs(c-h)<=1e-4;T?(v=w*g+x*(y=i.ay)+u.tx,b=_*g+S*y+u.ty):(y=0,v=w*g+u.tx,b=_*g+u.ty);var P=e.parent.matrix;w=P.a,x=P.c,_=P.b;var C=1/(w*(S=P.d)-x*_),I=n-P.tx,k=o-P.ty,A=(I*S-k*x)*C-s,M=(k*w-I*_)*C-l,O=((I=v-P.tx)*S-(k=b-P.ty)*x)*C-s,R=(k*w-I*_)*C-l,B=Math.sqrt(O*O+R*R),G=i.data.length*p,E=0,D=0;t:if(T){var L=(A*A+M*M-B*B-(G*=c)*G)/(2*B*G);L<-1?L=-1:L>1&&(L=1),D=Math.acos(L)*r,w=B+G*L,x=G*Math.sin(D),E=Math.atan2(M*w-A*x,A*w+M*x)}else{var j=(w=c*G)*w,F=(x=h*G)*x,N=A*A+M*M,X=Math.atan2(M,A),U=-2*F*B,V=F-j;if((S=U*U-4*V*(_=F*B*B+j*N-j*F))>=0){var H=Math.sqrt(S);U<0&&(H=-H);var q=(H=-(U+H)/2)/V,z=_/H,W=Math.abs(q)<Math.abs(z)?q:z;if(W*W<=N){k=Math.sqrt(N-W*W)*r,E=X-Math.atan2(k,W),D=Math.atan2(k/h,(W-B)/c);break t}}var Y=t.MathUtils.PI,K=B-w,Q=K*K,Z=0,J=0,$=B+w,tt=$*$,et=0;(_=-w*B/(j-F))>=-1&&_<=1&&(_=Math.acos(_),(S=(I=w*Math.cos(_)+B)*I+(k=x*Math.sin(_))*k)<Q&&(Y=_,Q=S,K=I,Z=k),S>tt&&(J=_,tt=S,$=I,et=k)),N<=(Q+tt)/2?(E=X-Math.atan2(Z*r,K),D=Y*r):(E=X-Math.atan2(et*r,$),D=J*r)}var it=Math.atan2(y,g)*m,nt=e.arotation;(E=(E-it)*t.MathUtils.radDeg+d-nt)>180?E-=360:E<-180&&(E+=360),e.updateWorldTransformWith(s,l,nt+E*a,e.ascaleX,e.ascaleY,0,0),nt=i.arotation,(D=((D+it)*t.MathUtils.radDeg-i.ashearX)*m+f-nt)>180?D-=360:D<-180&&(D+=360),i.updateWorldTransformWith(g,y,nt+D*a,i.ascaleX,i.ascaleY,i.ashearX,i.ashearY)}else i.updateWorldTransform()},e}();t.IkConstraint=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.mix=1,this.name=t}}();t.IkConstraintData=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var i=0,n=t.bones.length;i<n;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return e.prototype.apply=function(){this.update()},e.prototype.update=function(){var e=this.target.getAttachment();if(e instanceof t.PathAttachment){var i=this.rotateMix,n=this.translateMix,o=i>0;if(n>0||o){var r=this.data,a=r.spacingMode,s=a==t.SpacingMode.Length,l=r.rotateMode,c=l==t.RotateMode.Tangent,h=l==t.RotateMode.ChainScale,p=this.bones.length,u=c?p:p+1,d=this.bones,f=t.Utils.setArraySize(this.spaces,u),m=null,g=this.spacing;if(h||s){h&&(m=t.Utils.setArraySize(this.lengths,p));for(var y=0,v=u-1;y<v;){var b=(A=d[y]).data.length,w=b*A.matrix.a,x=b*A.matrix.b,_=Math.sqrt(w*w+x*x);h&&(m[y]=_),f[++y]=(s?b+g:g)*_/b}}else for(y=1;y<u;y++)f[y]=g;var S=this.computeWorldPositions(e,u,c,r.positionMode==t.PositionMode.Percent,a==t.SpacingMode.Percent),T=S[0],P=S[1],C=r.offsetRotation,I=!1;0==C?I=l==t.RotateMode.Chain:(I=!1,C*=(k=this.target.bone.matrix).a*k.d-k.b*k.c>0?t.MathUtils.degRad:-t.MathUtils.degRad);for(var y=0,k=3;y<p;y++,k+=3){var A=d[y],M=A.matrix;M.tx+=(T-M.tx)*n,M.ty+=(P-M.ty)*n;var O=(w=S[k])-T,R=(x=S[k+1])-P;if(h){var B=m[y];if(0!=B){var G=(Math.sqrt(O*O+R*R)/B-1)*i+1;M.a*=G,M.b*=G}}if(T=w,P=x,o){var E=M.a,D=M.c,L=M.b,j=M.d,F=0,N=0,X=0;if(F=c?S[k-1]:0==f[y+1]?S[k+2]:Math.atan2(R,O),F-=Math.atan2(L,E),I){N=Math.cos(F),X=Math.sin(F);var U=A.data.length;T+=(U*(N*E-X*L)-O)*i,P+=(U*(X*E+N*L)-R)*i}else F+=C;F>t.MathUtils.PI?F-=t.MathUtils.PI2:F<-t.MathUtils.PI&&(F+=t.MathUtils.PI2),F*=i,N=Math.cos(F),X=Math.sin(F),M.a=N*E-X*L,M.c=N*D-X*j,M.b=X*E+N*L,M.d=X*D+N*j}A.appliedValid=!1}}}},e.prototype.computeWorldPositions=function(i,n,o,r,a){var s=this.target,l=this.position,c=this.spaces,h=t.Utils.setArraySize(this.positions,3*n+2),p=null,u=i.closed,d=i.worldVerticesLength,f=d/6,m=e.NONE;if(!i.constantSpeed){var g=i.lengths,y=g[f-=u?1:2];if(r&&(l*=y),a)for(v=0;v<n;v++)c[v]*=y;p=t.Utils.setArraySize(this.world,8);for(var v=0,b=0,w=0;v<n;v++,b+=3){q=l+=H=c[v];if(u)(q%=y)<0&&(q+=y),w=0;else{if(q<0){m!=e.BEFORE&&(m=e.BEFORE,i.computeWorldVertices(s,2,4,p,0,2)),this.addBeforePosition(q,p,0,h,b);continue}if(q>y){m!=e.AFTER&&(m=e.AFTER,i.computeWorldVertices(s,d-6,4,p,0,2)),this.addAfterPosition(q-y,p,0,h,b);continue}}for(;;w++){var x=g[w];if(!(q>x)){0==w?q/=x:q=(q-(K=g[w-1]))/(x-K);break}}w!=m&&(m=w,u&&w==f?(i.computeWorldVertices(s,d-4,4,p,0,2),i.computeWorldVertices(s,0,4,p,4,2)):i.computeWorldVertices(s,6*w+2,8,p,0,2)),this.addCurvePosition(q,p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],h,b,o||v>0&&0==H)}return h}u?(d+=2,p=t.Utils.setArraySize(this.world,d),i.computeWorldVertices(s,2,d-4,p,0,2),i.computeWorldVertices(s,0,2,p,d-4,2),p[d-2]=p[0],p[d-1]=p[1]):(f--,d-=4,p=t.Utils.setArraySize(this.world,d),i.computeWorldVertices(s,2,d,p,0,2));for(var _=t.Utils.setArraySize(this.curves,f),S=0,T=p[0],P=p[1],C=0,I=0,k=0,A=0,M=0,O=0,R=0,B=0,G=0,E=0,D=0,L=0,j=0,F=0,v=0,N=2;v<f;v++,N+=6)C=p[N],I=p[N+1],k=p[N+2],A=p[N+3],D=2*(R=.1875*(T-2*C+k))+(G=.09375*(3*(C-k)-T+(M=p[N+4]))),L=2*(B=.1875*(P-2*I+A))+(E=.09375*(3*(I-A)-P+(O=p[N+5]))),j=.75*(C-T)+R+.16666667*G,F=.75*(I-P)+B+.16666667*E,S+=Math.sqrt(j*j+F*F),j+=D,F+=L,D+=G,L+=E,S+=Math.sqrt(j*j+F*F),j+=D,F+=L,S+=Math.sqrt(j*j+F*F),j+=D+G,F+=L+E,S+=Math.sqrt(j*j+F*F),_[v]=S,T=M,P=O;if(r&&(l*=S),a)for(v=0;v<n;v++)c[v]*=S;for(var X=this.segments,U=0,v=0,b=0,w=0,V=0;v<n;v++,b+=3){var H=c[v],q=l+=H;if(u)(q%=S)<0&&(q+=S),w=0;else{if(q<0){this.addBeforePosition(q,p,0,h,b);continue}if(q>S){this.addAfterPosition(q-S,p,d-4,h,b);continue}}for(;;w++){var z=_[w];if(!(q>z)){0==w?q/=z:q=(q-(K=_[w-1]))/(z-K);break}}if(w!=m){m=w;var W=6*w;for(T=p[W],P=p[W+1],C=p[W+2],I=p[W+3],k=p[W+4],A=p[W+5],D=2*(R=.03*(T-2*C+k))+(G=.006*(3*(C-k)-T+(M=p[W+6]))),L=2*(B=.03*(P-2*I+A))+(E=.006*(3*(I-A)-P+(O=p[W+7]))),j=.3*(C-T)+R+.16666667*G,F=.3*(I-P)+B+.16666667*E,U=Math.sqrt(j*j+F*F),X[0]=U,W=1;W<8;W++)j+=D,F+=L,D+=G,L+=E,U+=Math.sqrt(j*j+F*F),X[W]=U;j+=D,F+=L,U+=Math.sqrt(j*j+F*F),X[8]=U,j+=D+G,F+=L+E,U+=Math.sqrt(j*j+F*F),X[9]=U,V=0}for(q*=U;;V++){var Y=X[V];if(!(q>Y)){if(0==V)q/=Y;else{var K=X[V-1];q=V+(q-K)/(Y-K)}break}}this.addCurvePosition(.1*q,T,P,C,I,k,A,M,O,h,b,o||v>0&&0==H)}return h},e.prototype.addBeforePosition=function(t,e,i,n,o){var r=e[i],a=e[i+1],s=e[i+2]-r,l=e[i+3]-a,c=Math.atan2(l,s);n[o]=r+t*Math.cos(c),n[o+1]=a+t*Math.sin(c),n[o+2]=c},e.prototype.addAfterPosition=function(t,e,i,n,o){var r=e[i+2],a=e[i+3],s=r-e[i],l=a-e[i+1],c=Math.atan2(l,s);n[o]=r+t*Math.cos(c),n[o+1]=a+t*Math.sin(c),n[o+2]=c},e.prototype.addCurvePosition=function(t,e,i,n,o,r,a,s,l,c,h,p){(0==t||isNaN(t))&&(t=1e-4);var u=t*t,d=u*t,f=1-t,m=f*f,g=m*f,y=f*t,v=3*y,b=f*v,w=v*t,x=e*g+n*b+r*w+s*d,_=i*g+o*b+a*w+l*d;c[h]=x,c[h+1]=_,p&&(c[h+2]=Math.atan2(_-(i*m+o*y*2+a*u),x-(e*m+n*y*2+r*u)))},e.prototype.getOrder=function(){return this.data.order},e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,e}();t.PathConstraint=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(t){this.order=0,this.bones=new Array,this.name=t}}();t.PathConstraintData=e;!function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"}(t.PositionMode||(t.PositionMode={}));!function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"}(t.SpacingMode||(t.SpacingMode={}));!function(t){t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"}(t.RotateMode||(t.RotateMode={}))}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(e){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.flipX=!1,this.flipY=!1,this.x=0,this.y=0,null==e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(c=0;c<e.bones.length;c++){var i=e.bones[c],n=void 0;if(null==i.parent)n=new t.Bone(i,this,null);else{var o=this.bones[i.parent.index];n=new t.Bone(i,this,o),o.children.push(n)}this.bones.push(n)}this.slots=new Array,this.drawOrder=new Array;for(c=0;c<e.slots.length;c++){var r=e.slots[c],n=this.bones[r.boneData.index],a=new t.Slot(r,n);this.slots.push(a),this.drawOrder.push(a)}this.ikConstraints=new Array;for(c=0;c<e.ikConstraints.length;c++){var s=e.ikConstraints[c];this.ikConstraints.push(new t.IkConstraint(s,this))}this.transformConstraints=new Array;for(c=0;c<e.transformConstraints.length;c++){var l=e.transformConstraints[c];this.transformConstraints.push(new t.TransformConstraint(l,this))}this.pathConstraints=new Array;for(var c=0;c<e.pathConstraints.length;c++){var h=e.pathConstraints[c];this.pathConstraints.push(new t.PathConstraint(h,this))}this.color=new t.Color(1,1,1,1),this.updateCache()}return e.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,i=t.length;e<i;e++)t[e].sorted=!1;var n=this.ikConstraints,o=this.transformConstraints,r=this.pathConstraints,a=n.length,s=o.length,l=r.length,c=a+s+l;t:for(e=0;e<c;e++){for(h=0;h<a;h++)if((p=n[h]).data.order==e){this.sortIkConstraint(p);continue t}for(h=0;h<s;h++)if((p=o[h]).data.order==e){this.sortTransformConstraint(p);continue t}for(var h=0;h<l;h++){var p=r[h];if(p.data.order==e){this.sortPathConstraint(p);continue t}}}for(var e=0,i=t.length;e<i;e++)this.sortBone(t[e])},e.prototype.sortIkConstraint=function(t){var e=t.target;this.sortBone(e);var i=t.bones,n=i[0];if(this.sortBone(n),i.length>1){var o=i[i.length-1];this._updateCache.indexOf(o)>-1||this.updateCacheReset.push(o)}this._updateCache.push(t),this.sortReset(n.children),i[i.length-1].sorted=!0},e.prototype.sortPathConstraint=function(e){var i=e.target,n=i.data.index,o=i.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,o),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,o);for(var r=0,a=this.data.skins.length;r<a;r++)this.sortPathConstraintAttachment(this.data.skins[r],n,o);var s=i.getAttachment();s instanceof t.PathAttachment&&this.sortPathConstraintAttachmentWith(s,o);for(var l=e.bones,c=l.length,r=0;r<c;r++)this.sortBone(l[r]);this._updateCache.push(e);for(r=0;r<c;r++)this.sortReset(l[r].children);for(r=0;r<c;r++)l[r].sorted=!0},e.prototype.sortTransformConstraint=function(t){this.sortBone(t.target);var e=t.bones,i=e.length;if(t.data.local)for(o=0;o<i;o++){var n=e[o];this.sortBone(n.parent),this._updateCache.indexOf(n)>-1||this.updateCacheReset.push(n)}else for(var o=0;o<i;o++)this.sortBone(e[o]);this._updateCache.push(t);for(r=0;r<i;r++)this.sortReset(e[r].children);for(var r=0;r<i;r++)e[r].sorted=!0},e.prototype.sortPathConstraintAttachment=function(t,e,i){var n=t.attachments[e];if(n)for(var o in n)this.sortPathConstraintAttachmentWith(n[o],i)},e.prototype.sortPathConstraintAttachmentWith=function(e,i){if(e instanceof t.PathAttachment){var n=e.bones;if(null==n)this.sortBone(i);else for(var o=this.bones,r=0;r<n.length;)for(var a=n[r++],s=r+a;r<s;r++){var l=n[r];this.sortBone(o[l])}}},e.prototype.sortBone=function(t){if(!t.sorted){var e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},e.prototype.sortReset=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n.sorted&&this.sortReset(n.children),n.sorted=!1}},e.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,i=t.length;e<i;e++){var n=t[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY,n.appliedValid=!0}for(var o=this._updateCache,e=0,i=o.length;e<i;e++)o[e].update()},e.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},e.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,i=t.length;e<i;e++)t[e].setToSetupPose();for(var n=this.ikConstraints,e=0,i=n.length;e<i;e++)(a=n[e]).bendDirection=a.data.bendDirection,a.mix=a.data.mix;for(var o=this.transformConstraints,e=0,i=o.length;e<i;e++){s=(a=o[e]).data;a.rotateMix=s.rotateMix,a.translateMix=s.translateMix,a.scaleMix=s.scaleMix,a.shearMix=s.shearMix}for(var r=this.pathConstraints,e=0,i=r.length;e<i;e++){var a=r[e],s=a.data;a.position=s.position,a.spacing=s.spacing,a.rotateMix=s.rotateMix,a.translateMix=s.translateMix}},e.prototype.setSlotsToSetupPose=function(){var e=this.slots;t.Utils.arrayCopy(e,0,this.drawOrder,0,e.length);for(var i=0,n=e.length;i<n;i++)e[i].setToSetupPose()},e.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},e.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++){var o=e[i];if(o.data.name==t)return o}return null},e.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},e.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++){var o=e[i];if(o.data.name==t)return o}return null},e.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},e.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},e.prototype.setSkin=function(t){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,i=0,n=e.length;i<n;i++){var o=e[i],r=o.data.attachmentName;if(null!=r){var a=t.getAttachment(i,r);null!=a&&o.setAttachment(a)}}this.skin=t},e.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},e.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var i=this.skin.getAttachment(t,e);if(null!=i)return i}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},e.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var i=this.slots,n=0,o=i.length;n<o;n++){var r=i[n];if(r.data.name==t){var a=null;if(null!=e&&null==(a=this.getAttachment(n,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void r.setAttachment(a)}}throw new Error("Slot not found: "+t)},e.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++){var o=e[i];if(o.data.name==t)return o}return null},e.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,i=0,n=e.length;i<n;i++){var o=e[i];if(o.data.name==t)return o}return null},e.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++){var o=e[i];if(o.data.name==t)return o}return null},e.prototype.getBounds=function(e,i,n){if(null==e)throw new Error("offset cannot be null.");if(null==i)throw new Error("size cannot be null.");for(var o=this.drawOrder,r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=0,h=o.length;c<h;c++){var p=o[c],u=0,d=null,f=p.getAttachment();if(f instanceof t.RegionAttachment)u=8,d=t.Utils.setArraySize(n,u,0),f.computeWorldVertices(p.bone,d,0,2);else if(f instanceof t.MeshAttachment){var m=f;u=m.worldVerticesLength,d=t.Utils.setArraySize(n,u,0),m.computeWorldVertices(p,0,u,d,0,2)}if(null!=d)for(var g=0,y=d.length;g<y;g+=2){var v=d[g],b=d[g+1];r=Math.min(r,v),a=Math.min(a,b),s=Math.max(s,v),l=Math.max(l,b)}}e.set(r,a),i.set(s-r,l-a)},e.prototype.update=function(t){this.time+=t},e}();t.Skeleton=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new t.Pool(function(){return t.Utils.newFloatArray(16)})}return e.prototype.update=function(e,i){if(null==e)throw new Error("skeleton cannot be null.");var n=this.boundingBoxes,o=this.polygons,r=this.polygonPool,a=e.slots,s=a.length;n.length=0,r.freeAll(o),o.length=0;for(var l=0;l<s;l++){var c=a[l],h=c.getAttachment();if(h instanceof t.BoundingBoxAttachment){var p=h;n.push(p);var u=r.obtain();u.length!=p.worldVerticesLength&&(u=t.Utils.newFloatArray(p.worldVerticesLength)),o.push(u),p.computeWorldVertices(c,0,p.worldVerticesLength,u,0,2)}}i?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},e.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY,o=this.polygons,r=0,a=o.length;r<a;r++)for(var s=o[r],l=s,c=0,h=s.length;c<h;c+=2){var p=l[c],u=l[c+1];t=Math.min(t,p),e=Math.min(e,u),i=Math.max(i,p),n=Math.max(n,u)}this.minX=t,this.minY=e,this.maxX=i,this.maxY=n},e.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},e.prototype.aabbIntersectsSegment=function(t,e,i,n){var o=this.minX,r=this.minY,a=this.maxX,s=this.maxY;if(t<=o&&i<=o||e<=r&&n<=r||t>=a&&i>=a||e>=s&&n>=s)return!1;var l=(n-e)/(i-t),c=l*(o-t)+e;if(c>r&&c<s)return!0;if((c=l*(a-t)+e)>r&&c<s)return!0;var h=(r-e)/l+t;return h>o&&h<a||(h=(s-e)/l+t)>o&&h<a},e.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},e.prototype.containsPoint=function(t,e){for(var i=this.polygons,n=0,o=i.length;n<o;n++)if(this.containsPointPolygon(i[n],t,e))return this.boundingBoxes[n];return null},e.prototype.containsPointPolygon=function(t,e,i){for(var n=t,o=t.length,r=o-2,a=!1,s=0;s<o;s+=2){var l=n[s+1],c=n[r+1];if(l<i&&c>=i||c<i&&l>=i){var h=n[s];h+(i-l)/(c-l)*(n[r]-h)<e&&(a=!a)}r=s}return a},e.prototype.intersectsSegment=function(t,e,i,n){for(var o=this.polygons,r=0,a=o.length;r<a;r++)if(this.intersectsSegmentPolygon(o[r],t,e,i,n))return this.boundingBoxes[r];return null},e.prototype.intersectsSegmentPolygon=function(t,e,i,n,o){for(var r=t,a=t.length,s=e-n,l=i-o,c=e*o-i*n,h=r[a-2],p=r[a-1],u=0;u<a;u+=2){var d=r[u],f=r[u+1],m=h*f-p*d,g=h-d,y=p-f,v=s*y-l*g,b=(c*g-s*m)/v;if((b>=h&&b<=d||b>=d&&b<=h)&&(b>=e&&b<=n||b>=n&&b<=e)){var w=(c*y-l*m)/v;if((w>=p&&w<=f||w>=f&&w<=p)&&(w>=i&&w<=o||w>=o&&w<=i))return!0}h=d,p=f}return!1},e.prototype.getPolygon=function(t){if(null==t)throw new Error("boundingBox cannot be null.");var e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]},e.prototype.getWidth=function(){return this.maxX-this.minX},e.prototype.getHeight=function(){return this.maxY-this.minY},e}();t.SkeletonBounds=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(){this.triangulator=new t.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}return e.prototype.clipStart=function(i,n){if(null!=this.clipAttachment)return 0;this.clipAttachment=n;var o=n.worldVerticesLength,r=t.Utils.setArraySize(this.clippingPolygon,o);n.computeWorldVertices(i,0,o,r,0,2);var a=this.clippingPolygon;e.makeClockwise(a);for(var s=this.clippingPolygons=this.triangulator.decompose(a,this.triangulator.triangulate(a)),l=0,c=s.length;l<c;l++){var h=s[l];e.makeClockwise(h),h.push(h[0]),h.push(h[1])}return s.length},e.prototype.clipEndWithSlot=function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()},e.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},e.prototype.isClipping=function(){return null!=this.clipAttachment},e.prototype.clipTriangles=function(e,i,n,o,r,a,s,l){var c=this.clipOutput,h=this.clippedVertices,p=this.clippedTriangles,u=this.clippingPolygons,d=this.clippingPolygons.length,f=l?12:8,m=0;h.length=0,p.length=0;t:for(var g=0;g<o;g+=3)for(var y=n[g]<<1,v=e[y],b=e[y+1],w=r[y],x=r[y+1],_=e[y=n[g+1]<<1],S=e[y+1],T=r[y],P=r[y+1],C=e[y=n[g+2]<<1],I=e[y+1],k=r[y],A=r[y+1],M=0;M<d;M++){var O=h.length;if(!this.clip(v,b,_,S,C,I,u[M],c)){(N=t.Utils.setArraySize(h,O+3*f))[O]=v,N[O+1]=b,N[O+2]=a.r,N[O+3]=a.g,N[O+4]=a.b,N[O+5]=a.a,l?(N[O+6]=w,N[O+7]=x,N[O+8]=s.r,N[O+9]=s.g,N[O+10]=s.b,N[O+11]=s.a,N[O+12]=_,N[O+13]=S,N[O+14]=a.r,N[O+15]=a.g,N[O+16]=a.b,N[O+17]=a.a,N[O+18]=T,N[O+19]=P,N[O+20]=s.r,N[O+21]=s.g,N[O+22]=s.b,N[O+23]=s.a,N[O+24]=C,N[O+25]=I,N[O+26]=a.r,N[O+27]=a.g,N[O+28]=a.b,N[O+29]=a.a,N[O+30]=k,N[O+31]=A,N[O+32]=s.r,N[O+33]=s.g,N[O+34]=s.b,N[O+35]=s.a):(N[O+6]=w,N[O+7]=x,N[O+8]=_,N[O+9]=S,N[O+10]=a.r,N[O+11]=a.g,N[O+12]=a.b,N[O+13]=a.a,N[O+14]=T,N[O+15]=P,N[O+16]=C,N[O+17]=I,N[O+18]=a.r,N[O+19]=a.g,N[O+20]=a.b,N[O+21]=a.a,N[O+22]=k,N[O+23]=A),O=p.length,(K=t.Utils.setArraySize(p,O+3))[O]=m,K[O+1]=m+1,K[O+2]=m+2,m+=3;continue t}var R=c.length;if(0!=R){for(var B=S-I,G=C-_,E=v-C,D=I-b,L=1/(B*E+G*(b-I)),j=R>>1,F=this.clipOutput,N=t.Utils.setArraySize(h,O+j*f),X=0;X<R;X+=2){var U=F[X],V=F[X+1];N[O]=U,N[O+1]=V,N[O+2]=a.r,N[O+3]=a.g,N[O+4]=a.b,N[O+5]=a.a;var H=U-C,q=V-I,z=(B*H+G*q)*L,W=(D*H+E*q)*L,Y=1-z-W;N[O+6]=w*z+T*W+k*Y,N[O+7]=x*z+P*W+A*Y,l&&(N[O+8]=s.r,N[O+9]=s.g,N[O+10]=s.b,N[O+11]=s.a),O+=f}O=p.length;var K=t.Utils.setArraySize(p,O+3*(j-2));j--;for(X=1;X<j;X++)K[O]=m,K[O+1]=m+X,K[O+2]=m+X+1,O+=3;m+=j+1}}},e.prototype.clip=function(t,e,i,n,o,r,a,s){var l=s,c=!1,h=null;a.length%4>=2?(h=s,s=this.scratch):h=this.scratch,h.length=0,h.push(t),h.push(e),h.push(i),h.push(n),h.push(o),h.push(r),h.push(t),h.push(e),s.length=0;for(var p=a,u=a.length-4,d=0;;d+=2){for(var f=p[d],m=p[d+1],g=p[d+2],y=p[d+3],v=f-g,b=m-y,w=h,x=h.length-2,_=s.length,S=0;S<x;S+=2){var T=w[S],P=w[S+1],C=w[S+2],I=w[S+3],k=v*(I-y)-b*(C-g)>0;if(v*(P-y)-b*(T-g)>0){if(k){s.push(C),s.push(I);continue}O=((M=C-T)*(m-P)-(A=I-P)*(f-T))/(A*(g-f)-M*(y-m));s.push(f+(g-f)*O),s.push(m+(y-m)*O)}else if(k){var A=I-P,M=C-T,O=(M*(m-P)-A*(f-T))/(A*(g-f)-M*(y-m));s.push(f+(g-f)*O),s.push(m+(y-m)*O),s.push(C),s.push(I)}c=!0}if(_==s.length)return l.length=0,!0;if(s.push(s[0]),s.push(s[1]),d==u)break;var R=s;(s=h).length=0,h=R}if(l!=s){l.length=0;for(var d=0,B=s.length-2;d<B;d++)l[d]=s[d]}else l.length=l.length-2;return c},e.makeClockwise=function(t){for(var e=t,i=t.length,n=e[i-2]*e[1]-e[0]*e[i-1],o=0,r=0,a=0,s=0,l=i-3;s<l;s+=2)o=e[s],r=e[s+1],a=e[s+2],n+=o*e[s+3]-a*r;if(!(n<0))for(var s=0,c=i-2,l=i>>1;s<l;s+=2){var h=e[s],p=e[s+1],u=c-s;e[s]=e[u],e[s+1]=e[u+1],e[u]=h,e[u+1]=p}},e}();t.SkeletonClipping=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function t(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return t.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},t.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},t.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++){var o=e[i];if(o.name==t)return o}return null},t.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},t}();t.SkeletonData=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(i){var n=this.scale,o=new t.SkeletonData,r="string"==typeof i?JSON.parse(i):i,a=r.skeleton;if(null!=a&&(o.hash=a.hash,o.version=a.spine,o.width=a.width,o.height=a.height,o.fps=a.fps,o.imagesPath=a.images),r.bones)for(I=0;I<r.bones.length;I++){var s=r.bones[I],l=null,c=this.getValue(s,"parent",null);if(null!=c&&null==(l=o.findBone(c)))throw new Error("Parent bone not found: "+c);(d=new t.BoneData(o.bones.length,s.name,l)).length=this.getValue(s,"length",0)*n,d.x=this.getValue(s,"x",0)*n,d.y=this.getValue(s,"y",0)*n,d.rotation=this.getValue(s,"rotation",0),d.scaleX=this.getValue(s,"scaleX",1),d.scaleY=this.getValue(s,"scaleY",1),d.shearX=this.getValue(s,"shearX",0),d.shearY=this.getValue(s,"shearY",0),d.transformMode=e.transformModeFromString(this.getValue(s,"transform","normal")),o.bones.push(d)}if(r.slots)for(I=0;I<r.slots.length;I++){var h=(T=r.slots[I]).name,p=T.bone,u=o.findBone(p);if(null==u)throw new Error("Slot bone not found: "+p);var d=new t.SlotData(o.slots.length,h,u),f=this.getValue(T,"color",null);null!=f&&d.color.setFromString(f);var m=this.getValue(T,"dark",null);null!=m&&(d.darkColor=new t.Color(1,1,1,1),d.darkColor.setFromString(m)),d.attachmentName=this.getValue(T,"attachment",null),d.blendMode=e.blendModeFromString(this.getValue(T,"blend","normal")),o.slots.push(d)}if(r.ik)for(I=0;I<r.ik.length;I++){g=r.ik[I];(d=new t.IkConstraintData(g.name)).order=this.getValue(g,"order",0);for(y=0;y<g.bones.length;y++){p=g.bones[y];if(null==(v=o.findBone(p)))throw new Error("IK bone not found: "+p);d.bones.push(v)}b=g.target;if(d.target=o.findBone(b),null==d.target)throw new Error("IK target bone not found: "+b);d.bendDirection=this.getValue(g,"bendPositive",!0)?1:-1,d.mix=this.getValue(g,"mix",1),o.ikConstraints.push(d)}if(r.transform)for(I=0;I<r.transform.length;I++){g=r.transform[I];(d=new t.TransformConstraintData(g.name)).order=this.getValue(g,"order",0);for(y=0;y<g.bones.length;y++){p=g.bones[y];if(null==(v=o.findBone(p)))throw new Error("Transform constraint bone not found: "+p);d.bones.push(v)}b=g.target;if(d.target=o.findBone(b),null==d.target)throw new Error("Transform constraint target bone not found: "+b);d.local=this.getValue(g,"local",!1),d.relative=this.getValue(g,"relative",!1),d.offsetRotation=this.getValue(g,"rotation",0),d.offsetX=this.getValue(g,"x",0)*n,d.offsetY=this.getValue(g,"y",0)*n,d.offsetScaleX=this.getValue(g,"scaleX",0),d.offsetScaleY=this.getValue(g,"scaleY",0),d.offsetShearY=this.getValue(g,"shearY",0),d.rotateMix=this.getValue(g,"rotateMix",1),d.translateMix=this.getValue(g,"translateMix",1),d.scaleMix=this.getValue(g,"scaleMix",1),d.shearMix=this.getValue(g,"shearMix",1),o.transformConstraints.push(d)}if(r.path)for(I=0;I<r.path.length;I++){var g=r.path[I];(d=new t.PathConstraintData(g.name)).order=this.getValue(g,"order",0);for(var y=0;y<g.bones.length;y++){var p=g.bones[y],v=o.findBone(p);if(null==v)throw new Error("Transform constraint bone not found: "+p);d.bones.push(v)}var b=g.target;if(d.target=o.findSlot(b),null==d.target)throw new Error("Path target slot not found: "+b);d.positionMode=e.positionModeFromString(this.getValue(g,"positionMode","percent")),d.spacingMode=e.spacingModeFromString(this.getValue(g,"spacingMode","length")),d.rotateMode=e.rotateModeFromString(this.getValue(g,"rotateMode","tangent")),d.offsetRotation=this.getValue(g,"rotation",0),d.position=this.getValue(g,"position",0),d.positionMode==t.PositionMode.Fixed&&(d.position*=n),d.spacing=this.getValue(g,"spacing",0),d.spacingMode!=t.SpacingMode.Length&&d.spacingMode!=t.SpacingMode.Fixed||(d.spacing*=n),d.rotateMix=this.getValue(g,"rotateMix",1),d.translateMix=this.getValue(g,"translateMix",1),o.pathConstraints.push(d)}if(r.skins)for(var w in r.skins){var x=r.skins[w],_=new t.Skin(w);for(var h in x){var S=o.findSlotIndex(h);if(-1==S)throw new Error("Slot not found: "+h);var T=x[h];for(var P in T){var C=this.readAttachment(T[P],_,S,P,o);null!=C&&_.addAttachment(S,P,C)}}o.skins.push(_),"default"==_.name&&(o.defaultSkin=_)}for(var I=0,k=this.linkedMeshes.length;I<k;I++){var A=this.linkedMeshes[I];if(null==(_=null==A.skin?o.defaultSkin:o.findSkin(A.skin)))throw new Error("Skin not found: "+A.skin);var M=_.getAttachment(A.slotIndex,A.parent);if(null==M)throw new Error("Parent mesh not found: "+A.parent);A.mesh.setParentMesh(M)}if(this.linkedMeshes.length=0,r.events)for(var O in r.events){var R=r.events[O];(d=new t.EventData(O)).intValue=this.getValue(R,"int",0),d.floatValue=this.getValue(R,"float",0),d.stringValue=this.getValue(R,"string",""),o.events.push(d)}if(r.animations)for(var B in r.animations){var G=r.animations[B];this.readAnimation(G,B,o)}return o},e.prototype.readAttachment=function(e,n,o,r,a){var s=this.scale;switch(r=this.getValue(e,"name",r),this.getValue(e,"type","region")){case"region":var l=this.getValue(e,"path",r),c=this.attachmentLoader.newRegionAttachment(n,r,l);return null==c?null:(c.path=l,c.x=this.getValue(e,"x",0)*s,c.y=this.getValue(e,"y",0)*s,c.scaleX=this.getValue(e,"scaleX",1),c.scaleY=this.getValue(e,"scaleY",1),c.rotation=this.getValue(e,"rotation",0),c.width=e.width*s,c.height=e.height*s,null!=(x=this.getValue(e,"color",null))&&c.color.setFromString(x),c);case"boundingbox":var h=this.attachmentLoader.newBoundingBoxAttachment(n,r);return null==h?null:(this.readVertices(e,h,e.vertexCount<<1),null!=(x=this.getValue(e,"color",null))&&h.color.setFromString(x),h);case"mesh":case"linkedmesh":var l=this.getValue(e,"path",r),p=this.attachmentLoader.newMeshAttachment(n,r,l);if(null==p)return null;p.path=l,null!=(x=this.getValue(e,"color",null))&&p.color.setFromString(x);var u=this.getValue(e,"parent",null);if(null!=u)return p.inheritDeform=this.getValue(e,"deform",!0),this.linkedMeshes.push(new i(p,this.getValue(e,"skin",null),o,u)),p;var d=e.uvs;return this.readVertices(e,p,d.length),p.triangles=e.triangles,p.regionUVs=d,p.hullLength=2*this.getValue(e,"hull",0),p;case"path":if(null==(l=this.attachmentLoader.newPathAttachment(n,r)))return null;l.closed=this.getValue(e,"closed",!1),l.constantSpeed=this.getValue(e,"constantSpeed",!0);w=e.vertexCount;this.readVertices(e,l,w<<1);for(var f=t.Utils.newArray(w/3,0),m=0;m<e.lengths.length;m++)f[m]=e.lengths[m]*s;return l.lengths=f,null!=(x=this.getValue(e,"color",null))&&l.color.setFromString(x),l;case"point":var g=this.attachmentLoader.newPointAttachment(n,r);return null==g?null:(g.x=this.getValue(e,"x",0)*s,g.y=this.getValue(e,"y",0)*s,g.rotation=this.getValue(e,"rotation",0),null!=(x=this.getValue(e,"color",null))&&g.color.setFromString(x),g);case"clipping":var y=this.attachmentLoader.newClippingAttachment(n,r);if(null==y)return null;var v=this.getValue(e,"end",null);if(null!=v){var b=a.findSlot(v);if(null==b)throw new Error("Clipping end slot not found: "+v);y.endSlot=b}var w=e.vertexCount;this.readVertices(e,y,w<<1);var x=this.getValue(e,"color",null);return null!=x&&y.color.setFromString(x),y}return null},e.prototype.readVertices=function(e,i,n){var o=this.scale;i.worldVerticesLength=n;var r=e.vertices;if(n!=r.length){for(var a=new Array,s=new Array,l=0,c=r.length;l<c;){var h=r[l++];s.push(h);for(var p=l+4*h;l<p;l+=4)s.push(r[l]),a.push(r[l+1]*o),a.push(r[l+2]*o),a.push(r[l+3])}i.bones=s,i.vertices=t.Utils.toFloatArray(a)}else{var u=t.Utils.toFloatArray(r);if(1!=o)for(var l=0,c=r.length;l<c;l++)u[l]*=o;i.vertices=u}},e.prototype.readAnimation=function(e,i,n){var o=this.scale,r=new Array,a=0;if(e.slots)for(var s in e.slots){M=e.slots[s];if(-1==(Q=n.findSlotIndex(s)))throw new Error("Slot not found: "+s);for(var l in M){O=M[l];if("attachment"==l){(v=new t.AttachmentTimeline(O.length)).slotIndex=Q;for(var c=0,h=0;h<O.length;h++){p=O[h];v.setFrame(c++,p.time,p.name)}r.push(v),a=Math.max(a,v.frames[v.getFrameCount()-1])}else if("color"==l){(v=new t.ColorTimeline(O.length)).slotIndex=Q;for(var c=0,h=0;h<O.length;h++){var p=O[h],u=new t.Color;u.setFromString(p.color),v.setFrame(c,p.time,u.r,u.g,u.b,u.a),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.ColorTimeline.ENTRIES])}else{if("twoColor"!=l)throw new Error("Invalid timeline type for a slot: "+l+" ("+s+")");(v=new t.TwoColorTimeline(O.length)).slotIndex=Q;for(var c=0,h=0;h<O.length;h++){var p=O[h],d=new t.Color,f=new t.Color;d.setFromString(p.light),f.setFromString(p.dark),v.setFrame(c,p.time,d.r,d.g,d.b,d.a,f.r,f.g,f.b),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.TwoColorTimeline.ENTRIES])}}}if(e.bones)for(var m in e.bones){var g=e.bones[m],y=n.findBoneIndex(m);if(-1==y)throw new Error("Bone not found: "+m);for(var l in g){O=g[l];if("rotate"===l){(v=new t.RotateTimeline(O.length)).boneIndex=y;for(var c=0,h=0;h<O.length;h++){p=O[h];v.setFrame(c,p.time,p.angle),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.RotateTimeline.ENTRIES])}else{if("translate"!==l&&"scale"!==l&&"shear"!==l)throw new Error("Invalid timeline type for a bone: "+l+" ("+m+")");var v=null,b=1;"scale"===l?v=new t.ScaleTimeline(O.length):"shear"===l?v=new t.ShearTimeline(O.length):(v=new t.TranslateTimeline(O.length),b=o),v.boneIndex=y;for(var c=0,h=0;h<O.length;h++){var p=O[h],w=this.getValue(p,"x",0),x=this.getValue(p,"y",0);v.setFrame(c,p.time,w*b,x*b),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.TranslateTimeline.ENTRIES])}}}if(e.ik)for(var _ in e.ik){var S=e.ik[_],T=n.findIkConstraint(_);(v=new t.IkConstraintTimeline(S.length)).ikConstraintIndex=n.ikConstraints.indexOf(T);for(var c=0,h=0;h<S.length;h++){p=S[h];v.setFrame(c,p.time,this.getValue(p,"mix",1),this.getValue(p,"bendPositive",!0)?1:-1),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.IkConstraintTimeline.ENTRIES])}if(e.transform)for(var _ in e.transform){var S=e.transform[_],T=n.findTransformConstraint(_);(v=new t.TransformConstraintTimeline(S.length)).transformConstraintIndex=n.transformConstraints.indexOf(T);for(var c=0,h=0;h<S.length;h++){p=S[h];v.setFrame(c,p.time,this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1),this.getValue(p,"scaleMix",1),this.getValue(p,"shearMix",1)),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.TransformConstraintTimeline.ENTRIES])}if(e.paths)for(var _ in e.paths){var S=e.paths[_],P=n.findPathConstraintIndex(_);if(-1==P)throw new Error("Path constraint not found: "+_);var C=n.pathConstraints[P];for(var l in S){O=S[l];if("position"===l||"spacing"===l){var v=null,b=1;"spacing"===l?(v=new t.PathConstraintSpacingTimeline(O.length),C.spacingMode!=t.SpacingMode.Length&&C.spacingMode!=t.SpacingMode.Fixed||(b=o)):(v=new t.PathConstraintPositionTimeline(O.length),C.positionMode==t.PositionMode.Fixed&&(b=o)),v.pathConstraintIndex=P;for(var c=0,h=0;h<O.length;h++){p=O[h];v.setFrame(c,p.time,this.getValue(p,l,0)*b),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===l){(v=new t.PathConstraintMixTimeline(O.length)).pathConstraintIndex=P;for(var c=0,h=0;h<O.length;h++){p=O[h];v.setFrame(c,p.time,this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1)),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[(v.getFrameCount()-1)*t.PathConstraintMixTimeline.ENTRIES])}}}if(e.deform)for(var I in e.deform){var k=e.deform[I],A=n.findSkin(I);if(null==A)throw new Error("Skin not found: "+I);for(var s in k){var M=k[s];if(-1==(Q=n.findSlotIndex(s)))throw new Error("Slot not found: "+M.name);for(var l in M){var O=M[l],R=A.getAttachment(Q,l);if(null==R)throw new Error("Deform attachment not found: "+O.name);var B=null!=R.bones,G=R.vertices,E=B?G.length/3*2:G.length;(v=new t.DeformTimeline(O.length)).slotIndex=Q,v.attachment=R;for(var c=0,D=0;D<O.length;D++){var p=O[D],L=void 0,j=this.getValue(p,"vertices",null);if(null==j)L=B?t.Utils.newFloatArray(E):G;else{L=t.Utils.newFloatArray(E);var F=this.getValue(p,"offset",0);if(t.Utils.arrayCopy(j,0,L,F,j.length),1!=o)for(var N=(h=F)+j.length;h<N;h++)L[h]*=o;if(!B)for(h=0;h<E;h++)L[h]+=G[h]}v.setFrame(c,p.time,L),this.readCurve(p,v,c),c++}r.push(v),a=Math.max(a,v.frames[v.getFrameCount()-1])}}}var X=e.drawOrder;if(null==X&&(X=e.draworder),null!=X){for(var v=new t.DrawOrderTimeline(X.length),U=n.slots.length,c=0,D=0;D<X.length;D++){var V=X[D],H=null,q=this.getValue(V,"offsets",null);if(null!=q){H=t.Utils.newArray(U,-1);for(var z=t.Utils.newArray(U-q.length,0),W=0,Y=0,h=0;h<q.length;h++){var K=q[h],Q=n.findSlotIndex(K.slot);if(-1==Q)throw new Error("Slot not found: "+K.slot);for(;W!=Q;)z[Y++]=W++;H[W+K.offset]=W++}for(;W<U;)z[Y++]=W++;for(h=U-1;h>=0;h--)-1==H[h]&&(H[h]=z[--Y])}v.setFrame(c++,V.time,H)}r.push(v),a=Math.max(a,v.frames[v.getFrameCount()-1])}if(e.events){for(var v=new t.EventTimeline(e.events.length),c=0,h=0;h<e.events.length;h++){var Z=e.events[h],J=n.findEvent(Z.name);if(null==J)throw new Error("Event not found: "+Z.name);var $=new t.Event(t.Utils.toSinglePrecision(Z.time),J);$.intValue=this.getValue(Z,"int",J.intValue),$.floatValue=this.getValue(Z,"float",J.floatValue),$.stringValue=this.getValue(Z,"string",J.stringValue),v.setFrame(c++,$)}r.push(v),a=Math.max(a,v.frames[v.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new t.Animation(i,r,a))},e.prototype.readCurve=function(t,e,i){if(t.curve)if("stepped"===t.curve)e.setStepped(i);else if("[object Array]"===Object.prototype.toString.call(t.curve)){var n=t.curve;e.setCurve(i,n[0],n[1],n[2],n[3])}},e.prototype.getValue=function(t,e,i){return void 0!==t[e]?t[e]:i},e.blendModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.BlendMode.Normal;if("additive"==e)return t.BlendMode.Additive;if("multiply"==e)return t.BlendMode.Multiply;if("screen"==e)return t.BlendMode.Screen;throw new Error("Unknown blend mode: "+e)},e.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},e.spacingModeFromString=function(e){if("length"==(e=e.toLowerCase()))return t.SpacingMode.Length;if("fixed"==e)return t.SpacingMode.Fixed;if("percent"==e)return t.SpacingMode.Percent;throw new Error("Unknown position mode: "+e)},e.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},e.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},e}();t.SkeletonJson=e;var i=function(){return function(t,e,i,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n}}()}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function t(t){if(this.attachments=new Array,null==t)throw new Error("name cannot be null.");this.name=t}return t.prototype.addAttachment=function(t,e,i){if(null==i)throw new Error("attachment cannot be null.");var n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=i},t.prototype.getAttachment=function(t,e){var i=this.attachments[t];return i?i[e]:null},t.prototype.attachAll=function(t,e){for(var i=0,n=0;n<t.slots.length;n++){var o=t.slots[n],r=o.getAttachment();if(r&&i<e.attachments.length){var a=e.attachments[i];for(var s in a)if(r==a[s]){var l=this.getAttachment(i,name);null!=l&&o.setAttachment(l);break}}i++}},t}();t.Skin=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(e,i){if(this.attachmentVertices=new Array,null==e)throw new Error("data cannot be null.");if(null==i)throw new Error("bone cannot be null.");this.data=e,this.bone=i,this.color=new t.Color,this.darkColor=null==e.darkColor?null:new t.Color,this.setToSetupPose(),this.blendMode=this.data.blendMode}return e.prototype.getAttachment=function(){return this.attachment},e.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},e.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},e.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},e.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},e}();t.Slot=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(e,i,n){if(this.color=new t.Color(1,1,1,1),e<0)throw new Error("index must be >= 0.");if(null==i)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=e,this.name=i,this.boneData=n}}();t.SlotData=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function t(t){this._image=t}return t.prototype.getImage=function(){return this._image},t.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return i.Nearest;case"linear":return i.Linear;case"mipmap":return i.MipMap;case"mipmapnearestnearest":return i.MipMapNearestNearest;case"mipmaplinearnearest":return i.MipMapLinearNearest;case"mipmapnearestlinear":return i.MipMapNearestLinear;case"mipmaplinearlinear":return i.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+t)}},t.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return n.MirroredRepeat;case"clamptoedge":return n.ClampToEdge;case"repeat":return n.Repeat;default:throw new Error("Unknown texture wrap "+t)}},t}();t.Texture=e;var i;!function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(i=t.TextureFilter||(t.TextureFilter={}));var n;!function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(n=t.TextureWrap||(t.TextureWrap={}));var o=function(){function t(){this.size=null}return Object.defineProperty(t.prototype,"width",{get:function(){var t=this.texture;return"3"==PIXI.VERSION[0]?t.crop.width:t.trim?t.trim.width:t.orig.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var t=this.texture;return"3"==PIXI.VERSION[0]?t.crop.height:t.trim?t.trim.height:t.orig.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"u",{get:function(){return this.texture._uvs.x0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"v",{get:function(){return this.texture._uvs.y0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"u2",{get:function(){return this.texture._uvs.x2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"v2",{get:function(){return this.texture._uvs.y2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){var t=this.texture;return t.trim?t.trim.x:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return console.warn("Deprecation Warning: @Hackerham: I guess, if you are using PIXI-SPINE ATLAS region.offsetY, you want a texture, right? Use region.texture from now on."),this.spineOffsetY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixiOffsetY",{get:function(){var t=this.texture;return t.trim?t.trim.y:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spineOffsetY",{get:function(){var t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalWidth",{get:function(){var t=this.texture;return"3"==PIXI.VERSION[0]?t.trim?t.trim.width:t.crop.width:t.orig.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalHeight",{get:function(){var t=this.texture;return"3"==PIXI.VERSION[0]?t.trim?t.trim.height:t.crop.height:t.orig.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.texture.frame.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.texture.frame.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return 0!==this.texture.rotate},enumerable:!0,configurable:!0}),t}();t.TextureRegion=o}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t,e,i){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,i)}return e.prototype.addTexture=function(e,i){for(var r=this.pages,a=null,s=0;s<r.length;s++)if(r[s].baseTexture===i.baseTexture){a=r[s];break}if(null===a){(a=new n).name="texturePage";var l=i.baseTexture;a.width=l.realWidth,a.height=l.realHeight,a.baseTexture=l,a.minFilter=a.magFilter=t.TextureFilter.Nearest,a.uWrap=t.TextureWrap.ClampToEdge,a.vWrap=t.TextureWrap.ClampToEdge,r.push(a)}var c=new o;return c.name=e,c.page=a,c.texture=i,c.index=-1,this.regions.push(c),c},e.prototype.addTextureHash=function(t,e){for(var i in t)t.hasOwnProperty(i)&&this.addTexture(e&&-1!==i.indexOf(".")?i.substr(0,i.lastIndexOf(".")):i,t[i])},e.prototype.addSpineAtlas=function(t,e,i){return this.load(t,e,i)},e.prototype.load=function(e,r,a){var s=this;if(null==r)throw new Error("textureLoader cannot be null.");var l=new i(e),c=new Array(4),h=null,p=function(){for(;;){var e=l.readLine();if(null==e)return a&&a(s);if(0==(e=e.trim()).length)h=null;else{if(!h){(h=new n).name=e,2==l.readTuple(c)&&(h.width=parseInt(c[0]),h.height=parseInt(c[1]),l.readTuple(c)),l.readTuple(c),h.minFilter=t.Texture.filterFromString(c[0]),h.magFilter=t.Texture.filterFromString(c[1]);var i=l.readValue();h.uWrap=t.TextureWrap.ClampToEdge,h.vWrap=t.TextureWrap.ClampToEdge,"x"==i?h.uWrap=t.TextureWrap.Repeat:"y"==i?h.vWrap=t.TextureWrap.Repeat:"xy"==i&&(h.uWrap=h.vWrap=t.TextureWrap.Repeat),r(e,function(t){h.baseTexture=t,t.hasLoaded||(t.width=h.width,t.height=h.height),s.pages.push(h),h.setFilters(),h.width&&h.height||(h.width=t.realWidth,h.height=t.realHeight,h.width&&h.height||console.log("ERROR spine atlas page "+h.name+": meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)")),p()}),s.pages.push(h);break}var u=new o;u.name=e,u.page=h;var d="true"==l.readValue()?6:0;l.readTuple(c);var f=parseInt(c[0]),m=parseInt(c[1]);l.readTuple(c);var g=parseInt(c[0]),y=parseInt(c[1]),v=h.baseTexture.resolution;f/=v,m/=v,g/=v,y/=v;var b=new PIXI.Rectangle(f,m,d?y:g,d?g:y);4==l.readTuple(c)&&4==l.readTuple(c)&&l.readTuple(c);var w=parseInt(c[0])/v,x=parseInt(c[1])/v;l.readTuple(c);var _=parseInt(c[0])/v,S=parseInt(c[1])/v,T=new PIXI.Rectangle(0,0,w,x),P=new PIXI.Rectangle(_,x-y-S,g,y);if("3"!=PIXI.VERSION[0])u.texture=new PIXI.Texture(u.page.baseTexture,b,T,P,d);else{var C=new PIXI.Rectangle(f,m,g,y),I=C.clone();P.width=w,P.height=x,u.texture=new PIXI.Texture(u.page.baseTexture,C,I,P,d)}u.index=parseInt(l.readValue()),u.texture._updateUvs(),s.regions.push(u)}}};p()},e.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},e.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()},e}();t.TextureAtlas=e;var i=function(){function t(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}return t.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},t.prototype.readValue=function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw new Error("Invalid line: "+t);return t.substring(e+1).trim()},t.prototype.readTuple=function(t){var e=this.readLine(),i=e.indexOf(":");if(-1==i)throw new Error("Invalid line: "+e);for(var n=0,o=i+1;n<3;n++){var r=e.indexOf(",",o);if(-1==r)break;t[n]=e.substr(o,r-o).trim(),o=r+1}return t[n]=e.substring(o).trim(),n+1},t}(),n=function(){function e(){}return e.prototype.setFilters=function(){var e=this.baseTexture,i=this.minFilter;i==t.TextureFilter.Linear?e.scaleMode=PIXI.SCALE_MODES.LINEAR:this.minFilter==t.TextureFilter.Nearest?e.scaleMode=PIXI.SCALE_MODES.NEAREST:(e.mipmap=!0,i==t.TextureFilter.MipMapNearestNearest?e.scaleMode=PIXI.SCALE_MODES.NEAREST:e.scaleMode=PIXI.SCALE_MODES.LINEAR)},e}();t.TextureAtlasPage=n;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TextureRegion);t.TextureAtlasRegion=o}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(e,i){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new t.Vector2,null==e)throw new Error("data cannot be null.");if(null==i)throw new Error("skeleton cannot be null.");this.data=e,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix,this.bones=new Array;for(var n=0;n<e.bones.length;n++)this.bones.push(i.findBone(e.bones[n].name));this.target=i.findBone(e.target.name)}return e.prototype.apply=function(){this.update()},e.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},e.prototype.applyAbsoluteWorld=function(){for(var e=this.rotateMix,i=this.translateMix,n=this.scaleMix,o=this.shearMix,r=this.target,a=r.matrix,s=a.a,l=a.c,c=a.b,h=a.d,p=s*h-l*c>0?t.MathUtils.degRad:-t.MathUtils.degRad,u=this.data.offsetRotation*p,d=this.data.offsetShearY*p,f=this.bones,m=0,g=f.length;m<g;m++){var y=f[m],v=!1,b=y.matrix;if(0!=e){var w=b.a,x=b.c,_=b.b,S=b.d;(M=Math.atan2(c,s)-Math.atan2(_,w)+u)>t.MathUtils.PI?M-=t.MathUtils.PI2:M<-t.MathUtils.PI&&(M+=t.MathUtils.PI2),M*=e;var T=Math.cos(M),P=Math.sin(M);b.a=T*w-P*_,b.c=T*x-P*S,b.b=P*w+T*_,b.d=P*x+T*S,v=!0}if(0!=i){var C=this.temp;r.localToWorld(C.set(this.data.offsetX,this.data.offsetY)),b.tx+=(C.x-b.tx)*i,b.ty+=(C.y-b.ty)*i,v=!0}if(n>0){var I=Math.sqrt(b.a*b.a+b.b*b.b),k=Math.sqrt(s*s+c*c);I>1e-5&&(I=(I+(k-I+this.data.offsetScaleX)*n)/I),b.a*=I,b.b*=I,I=Math.sqrt(b.c*b.c+b.d*b.d),k=Math.sqrt(l*l+h*h),I>1e-5&&(I=(I+(k-I+this.data.offsetScaleY)*n)/I),b.c*=I,b.d*=I,v=!0}if(o>0){var x=b.c,S=b.d,A=Math.atan2(S,x),M=Math.atan2(h,l)-Math.atan2(c,s)-(A-Math.atan2(b.b,b.a));M>t.MathUtils.PI?M-=t.MathUtils.PI2:M<-t.MathUtils.PI&&(M+=t.MathUtils.PI2),M=A+(M+d)*o;I=Math.sqrt(x*x+S*S);b.c=Math.cos(M)*I,b.d=Math.sin(M)*I,v=!0}v&&(y.appliedValid=!1)}},e.prototype.applyRelativeWorld=function(){for(var e=this.rotateMix,i=this.translateMix,n=this.scaleMix,o=this.shearMix,r=this.target,a=r.matrix,s=a.a,l=a.c,c=a.b,h=a.d,p=s*h-l*c>0?t.MathUtils.degRad:-t.MathUtils.degRad,u=this.data.offsetRotation*p,d=this.data.offsetShearY*p,f=this.bones,m=0,g=f.length;m<g;m++){var y=f[m],v=!1,b=y.matrix;if(0!=e){var w=b.a,x=b.c,_=b.b,S=b.d;(I=Math.atan2(c,s)+u)>t.MathUtils.PI?I-=t.MathUtils.PI2:I<-t.MathUtils.PI&&(I+=t.MathUtils.PI2),I*=e;var T=Math.cos(I),P=Math.sin(I);b.a=T*w-P*_,b.c=T*x-P*S,b.b=P*w+T*_,b.d=P*x+T*S,v=!0}if(0!=i){var C=this.temp;r.localToWorld(C.set(this.data.offsetX,this.data.offsetY)),b.tx+=C.x*i,b.ty+=C.y*i,v=!0}if(n>0){k=(Math.sqrt(s*s+c*c)-1+this.data.offsetScaleX)*n+1;b.a*=k,b.b*=k,k=(Math.sqrt(l*l+h*h)-1+this.data.offsetScaleY)*n+1,b.c*=k,b.d*=k,v=!0}if(o>0){var I=Math.atan2(h,l)-Math.atan2(c,s);I>t.MathUtils.PI?I-=t.MathUtils.PI2:I<-t.MathUtils.PI&&(I+=t.MathUtils.PI2);var x=b.c,S=b.d;I=Math.atan2(S,x)+(I-t.MathUtils.PI/2+d)*o;var k=Math.sqrt(x*x+S*S);b.c=Math.cos(I)*k,b.d=Math.sin(I)*k,v=!0}v&&(y.appliedValid=!1)}},e.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,o=this.target;o.appliedValid||o.updateAppliedTransform();for(var r=this.bones,a=0,s=r.length;a<s;a++){var l=r[a];l.appliedValid||l.updateAppliedTransform();var c=l.arotation;if(0!=t){m=o.arotation-c+this.data.offsetRotation;c+=(m-=360*(16384-(16384.499999999996-m/360|0)))*t}var h=l.ax,p=l.ay;0!=e&&(h+=(o.ax-h+this.data.offsetX)*e,p+=(o.ay-p+this.data.offsetY)*e);var u=l.ascaleX,d=l.ascaleY;i>0&&(u>1e-5&&(u=(u+(o.ascaleX-u+this.data.offsetScaleX)*i)/u),d>1e-5&&(d=(d+(o.ascaleY-d+this.data.offsetScaleY)*i)/d));var f=l.ashearY;if(n>0){var m=o.ashearY-f+this.data.offsetShearY;m-=360*(16384-(16384.499999999996-m/360|0)),l.shearY+=m*n}l.updateWorldTransformWith(h,p,c,u,d,l.ashearX,f)}},e.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,o=this.target;o.appliedValid||o.updateAppliedTransform();for(var r=this.bones,a=0,s=r.length;a<s;a++){var l=r[a];l.appliedValid||l.updateAppliedTransform();var c=l.arotation;0!=t&&(c+=(o.arotation+this.data.offsetRotation)*t);var h=l.ax,p=l.ay;0!=e&&(h+=(o.ax+this.data.offsetX)*e,p+=(o.ay+this.data.offsetY)*e);var u=l.ascaleX,d=l.ascaleY;i>0&&(u>1e-5&&(u*=(o.ascaleX-1+this.data.offsetScaleX)*i+1),d>1e-5&&(d*=(o.ascaleY-1+this.data.offsetScaleY)*i+1));var f=l.ashearY;n>0&&(f+=(o.ashearY+this.data.offsetShearY)*n),l.updateWorldTransformWith(h,p,c,u,d,l.ashearX,f)}},e.prototype.getOrder=function(){return this.data.order},e}();t.TransformConstraint=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==t)throw new Error("name cannot be null.");this.name=t}}();t.TransformConstraintData=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new t.Pool(function(){return new Array}),this.polygonIndicesPool=new t.Pool(function(){return new Array})}return e.prototype.triangulate=function(t){var i=t,n=t.length>>1,o=this.indicesArray;o.length=0;for(a=0;a<n;a++)o[a]=a;var r=this.isConcaveArray;r.length=0;for(var a=0,s=n;a<s;++a)r[a]=e.isConcave(a,n,i,o);var l=this.triangles;for(l.length=0;n>3;){for(var c=n-1,a=0,h=1;;){t:if(!r[a]){for(var p=o[c]<<1,u=o[a]<<1,d=o[h]<<1,f=i[p],m=i[p+1],g=i[u],y=i[u+1],v=i[d],b=i[d+1],w=(h+1)%n;w!=c;w=(w+1)%n)if(r[w]){var x=o[w]<<1,_=i[x],S=i[x+1];if(e.positiveArea(v,b,f,m,_,S)&&e.positiveArea(f,m,g,y,_,S)&&e.positiveArea(g,y,v,b,_,S))break t}break}if(0==h){do{if(!r[a])break;a--}while(a>0);break}c=a,a=h,h=(h+1)%n}l.push(o[(n+a-1)%n]),l.push(o[a]),l.push(o[(a+1)%n]),o.splice(a,1),r.splice(a,1);var T=(--n+a-1)%n,P=a==n?0:a;r[T]=e.isConcave(T,n,i,o),r[P]=e.isConcave(P,n,i,o)}return 3==n&&(l.push(o[2]),l.push(o[0]),l.push(o[1])),l},e.prototype.decompose=function(t,i){var n=t,o=this.convexPolygons;this.polygonPool.freeAll(o),o.length=0;var r=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(r),r.length=0;var a=this.polygonIndicesPool.obtain();a.length=0;var s=this.polygonPool.obtain();s.length=0;for(var l=-1,c=0,h=0,p=i.length;h<p;h+=3){var u=i[h]<<1,d=i[h+1]<<1,f=i[h+2]<<1,m=n[u],g=n[u+1],y=n[d],v=n[d+1],b=n[f],w=n[f+1],x=!1;if(l==u){var _=s.length-4,S=e.winding(s[_],s[_+1],s[_+2],s[_+3],b,w),T=e.winding(b,w,s[0],s[1],s[2],s[3]);S==c&&T==c&&(s.push(b),s.push(w),a.push(f),x=!0)}x||(s.length>0?(o.push(s),r.push(a)):(this.polygonPool.free(s),this.polygonIndicesPool.free(a)),(s=this.polygonPool.obtain()).length=0,s.push(m),s.push(g),s.push(y),s.push(v),s.push(b),s.push(w),(a=this.polygonIndicesPool.obtain()).length=0,a.push(u),a.push(d),a.push(f),c=e.winding(m,g,y,v,b,w),l=u)}s.length>0&&(o.push(s),r.push(a));for(var h=0,p=o.length;h<p;h++)if(0!=(a=r[h]).length)for(var P=a[0],C=a[a.length-1],I=(s=o[h])[_=s.length-4],k=s[_+1],A=s[_+2],M=s[_+3],O=s[0],R=s[1],B=s[2],G=s[3],E=e.winding(I,k,A,M,O,R),D=0;D<p;D++)if(D!=h){var L=r[D];if(3==L.length){var j=L[0],F=L[1],N=L[2],X=o[D],b=X[X.length-2],w=X[X.length-1];if(j==P&&F==C){var S=e.winding(I,k,A,M,b,w),T=e.winding(b,w,O,R,B,G);S==E&&T==E&&(X.length=0,L.length=0,s.push(b),s.push(w),a.push(N),I=A,k=M,A=b,M=w,D=0)}}}for(h=o.length-1;h>=0;h--)0==(s=o[h]).length&&(o.splice(h,1),this.polygonPool.free(s),a=r[h],r.splice(h,1),this.polygonIndicesPool.free(a));return o},e.isConcave=function(t,e,i,n){var o=n[(e+t-1)%e]<<1,r=n[t]<<1,a=n[(t+1)%e]<<1;return!this.positiveArea(i[o],i[o+1],i[r],i[r+1],i[a],i[a+1])},e.positiveArea=function(t,e,i,n,o,r){return t*(r-n)+i*(e-r)+o*(n-e)>=0},e.winding=function(t,e,i,n,o,r){var a=i-t,s=n-e;return o*s-r*a+a*e-t*s>=0?1:-1},e}();t.Triangulator=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function t(){this.array=new Array}return t.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},t.prototype.contains=function(t){return void 0!=this.array[0|t]},t.prototype.remove=function(t){this.array[0|t]=void 0},t.prototype.clear=function(){this.array.length=0},t}();t.IntSet=e;var i=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.r=t,this.g=e,this.b=i,this.a=n}return t.prototype.set=function(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this.clamp(),this},t.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this},t.prototype.add=function(t,e,i,n){return this.r+=t,this.g+=e,this.b+=i,this.a+=n,this.clamp(),this},t.prototype.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},t.WHITE=new t(1,1,1,1),t.RED=new t(1,0,0,1),t.GREEN=new t(0,1,0,1),t.BLUE=new t(0,0,1,1),t.MAGENTA=new t(1,0,1,1),t}();t.Color=i;var n=function(){function t(){}return t.clamp=function(t,e,i){return t<e?e:t>i?i:t},t.cosDeg=function(e){return Math.cos(e*t.degRad)},t.sinDeg=function(e){return Math.sin(e*t.degRad)},t.signum=function(t){return t>0?1:t<0?-1:0},t.toInt=function(t){return t>0?Math.floor(t):Math.ceil(t)},t.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},t.randomTriangular=function(e,i){return t.randomTriangularWith(e,i,.5*(e+i))},t.randomTriangularWith=function(t,e,i){var n=Math.random(),o=e-t;return n<=(i-t)/o?t+Math.sqrt(n*o*(i-t)):e-Math.sqrt((1-n)*o*(e-i))},t.PI=3.1415927,t.PI2=2*t.PI,t.radiansToDegrees=180/t.PI,t.radDeg=t.radiansToDegrees,t.degreesToRadians=t.PI/180,t.degRad=t.degreesToRadians,t}();t.MathUtils=n;var o=function(){function t(){}return t.prototype.apply=function(t,e,i){return t+(e-t)*this.applyInternal(i)},t}();t.Interpolation=o;var r=function(t){function e(e){var i=t.call(this)||this;return i.power=2,i.power=e,i}return __extends(e,t),e.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1},e}(o);t.Pow=r;var a=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1},e}(r);t.PowOut=a;var s=function(){function t(){}return t.arrayCopy=function(t,e,i,n,o){for(var r=e,a=n;r<e+o;r++,a++)i[a]=t[r]},t.setArraySize=function(t,e,i){void 0===i&&(i=0);var n=t.length;if(n==e)return t;if(t.length=e,n<e)for(var o=n;o<e;o++)t[o]=i;return t},t.ensureArrayCapacity=function(e,i,n){return void 0===n&&(n=0),e.length>=i?e:t.setArraySize(e,i,n)},t.newArray=function(t,e){for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i},t.newFloatArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i},t.newShortArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i},t.toFloatArray=function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e},t.toSinglePrecision=function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e},t.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,t}();t.Utils=s;var l=function(){function t(){}return t.logBones=function(t){for(var e=0;e<t.bones.length;e++){var i=t.bones[e],n=i.matrix;console.log(i.data.name+", "+n.a+", "+n.b+", "+n.c+", "+n.d+", "+n.tx+", "+n.ty)}},t}();t.DebugUtils=l;var c=function(){function t(t){this.items=new Array,this.instantiator=t}return t.prototype.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},t.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},t.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)t[e].reset&&t[e].reset(),this.items[e]=t[e]},t.prototype.clear=function(){this.items.length=0},t}();t.Pool=c;var h=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},t.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},t}();t.Vector2=h;var p=function(){function t(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return t.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},t}();t.TimeKeeper=p;var u=function(){function t(t){void 0===t&&(t=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}return t.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},t.prototype.addValue=function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},t.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0},t}();t.WindowedMean=u}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){return function(t){if(null==t)throw new Error("name cannot be null.");this.name=t}}();t.Attachment=e;var i=function(t){function e(i){var n=t.call(this,i)||this;return n.id=(65535&e.nextID++)<<11,n.worldVerticesLength=0,n}return __extends(e,t),e.prototype.computeWorldVerticesOld=function(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)},e.prototype.computeWorldVertices=function(t,e,i,n,o,r){i=o+(i>>1)*r;var a=t.bone.skeleton,s=t.attachmentVertices,l=this.vertices,c=this.bones;if(null!=c){for(var h=0,p=0,u=0;u<e;u+=2)h+=(v=c[h])+1,p+=v;var d=a.bones;if(0==s.length)for(var f=o,m=3*p;f<i;f+=r){var g=0,y=0,v=c[h++];for(v+=h;h<v;h++,m+=3){var b=d[c[h]].matrix,w=l[m],x=l[m+1],_=l[m+2];g+=(w*b.a+x*b.c+b.tx)*_,y+=(w*b.b+x*b.d+b.ty)*_}n[f]=g,n[f+1]=y}else for(var S=s,f=o,m=3*p,T=p<<1;f<i;f+=r){var g=0,y=0,v=c[h++];for(v+=h;h<v;h++,m+=3,T+=2){var b=d[c[h]].matrix,w=l[m]+S[T],x=l[m+1]+S[T+1],_=l[m+2];g+=(w*b.a+x*b.c+b.tx)*_,y+=(w*b.b+x*b.d+b.ty)*_}n[f]=g,n[f+1]=y}}else{s.length>0&&(l=s);for(var P=(b=t.bone.matrix).tx,C=b.ty,I=b.a,m=b.c,k=b.b,A=b.d,M=e,f=o;f<i;M+=2,f+=r){var w=l[M],x=l[M+1];n[f]=w*I+x*m+P,n[f+1]=w*k+x*A+C}}},e.prototype.applyDeform=function(t){return this==t},e.nextID=0,e}(e);t.VertexAttachment=i}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){!function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point"}(t.AttachmentType||(t.AttachmentType={}))}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(1,1,1,1),n}return __extends(i,e),i}(t.VertexAttachment);t.BoundingBoxAttachment=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(.2275,.2275,.8078,1),n}return __extends(i,e),i}(t.VertexAttachment);t.ClippingAttachment=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(1,1,1,1),n.inheritDeform=!1,n.tempColor=new t.Color(0,0,0,0),n}return __extends(i,e),i.prototype.updateUVs=function(e,i){var n=this.regionUVs.length;if(i&&i.length==n||(i=t.Utils.newFloatArray(n)),null!=e){for(var o=e.texture._uvs,r=e.width,a=e.height,s=e.originalWidth,l=e.originalHeight,c=e.offsetX,h=e.pixiOffsetY,p=0;p<n;p+=2){var u=this.regionUVs[p],d=this.regionUVs[p+1];u=(u*s-c)/r,d=(d*l-h)/a,i[p]=(o.x0*(1-u)+o.x1*u)*(1-d)+(o.x3*(1-u)+o.x2*u)*d,i[p+1]=(o.y0*(1-u)+o.y1*u)*(1-d)+(o.y3*(1-u)+o.y2*u)*d}return i}},i.prototype.applyDeform=function(t){return this==t||this.inheritDeform&&this.parentMesh==t},i.prototype.getParentMesh=function(){return this.parentMesh},i.prototype.setParentMesh=function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},i}(t.VertexAttachment);t.MeshAttachment=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.closed=!1,n.constantSpeed=!1,n.color=new t.Color(1,1,1,1),n}return __extends(i,e),i}(t.VertexAttachment);t.PathAttachment=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(.38,.94,0,1),n}return __extends(i,e),i.prototype.computeWorldPosition=function(t,e){var i=t.matrix;return e.x=this.x*i.a+this.y*i.c+t.worldX,e.y=this.x*i.b+this.y*i.d+t.worldY,e},i.prototype.computeWorldRotation=function(e){var i=e.matrix,n=t.MathUtils.cosDeg(this.rotation),o=t.MathUtils.sinDeg(this.rotation),r=n*i.a+o*i.c,a=n*i.b+o*i.d;return Math.atan2(a,r)*t.MathUtils.radDeg},i}(t.VertexAttachment);t.PointAttachment=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.x=0,n.y=0,n.scaleX=1,n.scaleY=1,n.rotation=0,n.width=0,n.height=0,n.color=new t.Color(1,1,1,1),n.offset=t.Utils.newFloatArray(8),n.uvs=t.Utils.newFloatArray(8),n.tempColor=new t.Color(1,1,1,1),n}return __extends(i,e),i.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,o=-this.height/2*this.scaleY+this.region.offsetY*e,r=n+this.region.width*t,a=o+this.region.height*e,s=this.rotation*Math.PI/180,l=Math.cos(s),c=Math.sin(s),h=n*l+this.x,p=n*c,u=o*l+this.y,d=o*c,f=r*l+this.x,m=r*c,g=a*l+this.y,y=a*c,v=this.offset;v[i.OX1]=h-d,v[i.OY1]=u+p,v[i.OX2]=h-y,v[i.OY2]=g+p,v[i.OX3]=f-y,v[i.OY3]=g+m,v[i.OX4]=f-d,v[i.OY4]=u+m},i.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},i.prototype.computeWorldVertices=function(t,e,n,o){var r=this.offset,a=t.matrix,s=a.tx,l=a.ty,c=a.a,h=a.c,p=a.b,u=a.d,d=0,f=0;d=r[i.OX1],f=r[i.OY1],e[n]=d*c+f*h+s,e[n+1]=d*p+f*u+l,n+=o,d=r[i.OX2],f=r[i.OY2],e[n]=d*c+f*h+s,e[n+1]=d*p+f*u+l,n+=o,d=r[i.OX3],f=r[i.OY3],e[n]=d*c+f*h+s,e[n+1]=d*p+f*u+l,n+=o,d=r[i.OX4],f=r[i.OY4],e[n]=d*c+f*h+s,e[n+1]=d*p+f*u+l},i.OX1=0,i.OY1=1,i.OX2=2,i.OY2=3,i.OX3=4,i.OY3=5,i.OX4=6,i.OY4=7,i.X1=0,i.Y1=1,i.C1R=2,i.C1G=3,i.C1B=4,i.C1A=5,i.U1=6,i.V1=7,i.X2=8,i.Y2=9,i.C2R=10,i.C2G=11,i.C2B=12,i.C2A=13,i.U2=14,i.V2=15,i.X3=16,i.Y3=17,i.C3R=18,i.C3G=19,i.C3B=20,i.C3A=21,i.U3=22,i.V3=23,i.X4=24,i.Y4=25,i.C4R=26,i.C4G=27,i.C4B=28,i.C4A=29,i.U4=30,i.V4=31,i}(t.Attachment);t.RegionAttachment=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}return e.prototype.begin=function(t){},e.prototype.transform=function(e,i,n,o){e.x+=t.MathUtils.randomTriangular(-this.jitterX,this.jitterY),e.y+=t.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},e.prototype.end=function(){},e}();t.JitterEffect=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){!function(t){var e=function(){function e(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}return e.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},e.prototype.transform=function(i,n,o,r){var a=this.angle*t.MathUtils.degreesToRadians,s=i.x-this.worldX,l=i.y-this.worldY,c=Math.sqrt(s*s+l*l);if(c<this.radius){var h=e.interpolation.apply(0,a,(this.radius-c)/this.radius),p=Math.cos(h),u=Math.sin(h);i.x=p*s-u*l+this.worldX,i.y=u*s+p*l+this.worldY}},e.prototype.end=function(){},e.interpolation=new t.PowOut(2),e}();t.SwirlEffect=e}(t.core||(t.core={}))}(pixi_spine||(pixi_spine={}));var pixi_spine;!function(t){function e(t){return t.type===PIXI.loaders.Resource.TYPE.JSON}function i(){return function(i,r){if(!i.data||!e(i)||!i.data.bones)return r();var a=i.metadata||{},s=a?i.metadata.spineSkeletonScale:null,l=a?i.metadata.spineAtlas:null;if(!1===l)return r();if(l&&l.pages){var c=new t.core.SkeletonJson(new t.core.AtlasAttachmentLoader(l)).readSkeletonData(i.data);return i.spineData=c,i.spineAtlas=l,r()}var h=a.spineAtlasSuffix||".atlas",p=i.url.substr(0,i.url.lastIndexOf("."))+h;p=p.replace(this.baseUrl,"");var u={crossOrigin:i.crossOrigin,xhrType:PIXI.loaders.Resource.XHR_RESPONSE_TYPE.TEXT,metadata:a.spineMetadata||null,parentResource:i},d={crossOrigin:i.crossOrigin,metadata:a.imageMetadata||null,parentResource:i},f=i.url.substr(0,i.url.lastIndexOf("/")+1);f=f.replace(this.baseUrl,"");var m=a.images?o(a.images):a.image?o({default:a.image}):a.imageLoader?a.imageLoader(this,i.name+"_atlas_page_",f,d):n(this,i.name+"_atlas_page_",f,d);this.add(i.name+"_atlas",p,u,function(e){new t.core.TextureAtlas(e.xhr.responseText,m,function(e){var n=new t.core.SkeletonJson(new t.core.AtlasAttachmentLoader(e));s&&(n.scale=s),i.spineData=n.readSkeletonData(i.data),i.spineAtlas=e,r()})})}}function n(t,e,i,n){return i&&i.lastIndexOf("/")!==i.length-1&&(i+="/"),function(o,r){var a=e+o,s=i+o;t.add(a,s,n,function(t){r(t.texture.baseTexture)})}}function o(t){return function(e,i){var n=t[e]||t.default;i(n&&n.baseTexture?n.baseTexture:n)}}t.atlasParser=i,t.imageLoaderAdapter=n,t.syncImageLoaderAdapter=function(t,e){return t&&t.lastIndexOf("/")!==t.length-1&&(t+="/"),function(t,i){i(PIXI.BaseTexture.fromImage(t,e))}},t.staticImageLoader=o,PIXI.loaders.Loader.addPixiMiddleware(i),PIXI.loader.use(i())}(pixi_spine||(pixi_spine={})),Math.fround||(Math.fround=Math.fround=function(t){return function(e){return t[0]=e,t[0]}}(new Float32Array(1)));var pixi_spine;!function(t){function e(){var t=this.parent.worldTransform,e=this.worldTransform,i=this.localTransform;e.a=i.a*t.a+i.b*t.c,e.b=i.a*t.b+i.b*t.d,e.c=i.c*t.a+i.d*t.c,e.d=i.c*t.b+i.d*t.d,e.tx=i.tx*t.a+i.ty*t.c+t.tx,e.ty=i.tx*t.b+i.ty*t.d+t.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null}t.core.Bone.yDown=!0;var i=[0,0,0],n=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(PIXI.Sprite);t.SpineSprite=n;var o=function(t){function e(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(e,t),e}(PIXI.mesh.Mesh);t.SpineMesh=o;var r=function(r){function a(e){var i=r.call(this)||this;if(i.hackTextureBySlotName=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=this.skeleton.findSlotIndex(t);return-1!=n&&this.hackTextureBySlotIndex(n,e,i)},!e)throw new Error("The spineData param is required.");if("string"==typeof e)throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');i.spineData=e,i.skeleton=new t.core.Skeleton(e),i.skeleton.updateWorldTransform(),i.stateData=new t.core.AnimationStateData(e),i.state=new t.core.AnimationState(i.stateData),i.slotContainers=[],i.tempClipContainers=[];for(var n=0,o=i.skeleton.slots.length;n<o;n++){var a=i.skeleton.slots[n],s=a.attachment,l=new PIXI.Container;if(i.slotContainers.push(l),i.addChild(l),i.tempClipContainers.push(null),s instanceof t.core.RegionAttachment){var c=s.region.name,h=i.createSprite(a,s,c);a.currentSprite=h,a.currentSpriteName=c,l.addChild(h)}else if(s instanceof t.core.MeshAttachment){var p=i.createMesh(a,s);a.currentMesh=p,a.currentMeshName=s.name,l.addChild(p)}else{if(!(s instanceof t.core.ClippingAttachment))continue;i.createGraphics(a,s),l.addChild(a.clippingContainer),l.addChild(a.currentGraphics)}}return i.autoUpdate=!0,i.tintRgb=new Float32Array([1,1,1]),i}return __extends(a,r),Object.defineProperty(a.prototype,"autoUpdate",{get:function(){return this.updateTransform===a.prototype.autoUpdateTransform},set:function(t){this.updateTransform=t?a.prototype.autoUpdateTransform:PIXI.Container.prototype.updateTransform},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tint",{get:function(){return PIXI.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=PIXI.utils.hex2rgb(t,this.tintRgb)},enumerable:!0,configurable:!0}),a.prototype.update=function(n){this.state.update(n),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var o=this.skeleton.slots,r=this.tintRgb[0],a=this.tintRgb[1],s=this.tintRgb[2],l=0,c=o.length;l<c;l++){var h=(C=o[l]).attachment,p=this.slotContainers[l];if(h){var u=h.color;if(h instanceof t.core.RegionAttachment){var d=h.region;if(d){C.currentMesh&&(C.currentMesh.visible=!1,C.currentMesh=null,C.currentMeshName=void 0);var f=d;if(!C.currentSpriteName||C.currentSpriteName!==f.name){var m=f.name;if(C.currentSprite&&(C.currentSprite.visible=!1),C.sprites=C.sprites||{},void 0!==C.sprites[m])C.sprites[m].visible=!0;else{var g=this.createSprite(C,h,m);p.addChild(g)}C.currentSprite=C.sprites[m],C.currentSpriteName=m}}if(p.transform){var y=p.transform,v=y,b=null;v.matrix2d?(b=v.matrix2d,v._dirtyVersion++,v.version=v._dirtyVersion,v.isStatic=!0,v.operMode=0):PIXI.TransformBase?(v.position&&(y=new PIXI.TransformBase,p.transform=y),b=y.localTransform):v.setFromMatrix(C.bone.matrix),b&&C.bone.matrix.copy(b)}else{b=p.localTransform||new PIXI.Matrix;C.bone.matrix.copy(b),p.localTransform=b,p.displayObjectUpdateTransform=e}i[0]=r*C.color.r*u.r,i[1]=a*C.color.g*u.g,i[2]=s*C.color.b*u.b,C.currentSprite.tint=PIXI.utils.rgb2hex(i),C.currentSprite.blendMode=C.blendMode}else if(h instanceof t.core.MeshAttachment){if(C.currentSprite&&(C.currentSprite.visible=!1,C.currentSprite=null,C.currentSpriteName=void 0,p.transform?p.transform=new PIXI.TransformStatic:(p.localTransform=new PIXI.Matrix,p.displayObjectUpdateTransform=PIXI.DisplayObject.prototype.updateTransform)),!C.currentMeshName||C.currentMeshName!==h.name){var w=h.name;if(C.currentMesh&&(C.currentMesh.visible=!1),C.meshes=C.meshes||{},void 0!==C.meshes[w])C.meshes[w].visible=!0;else{var x=this.createMesh(C,h);p.addChild(x)}C.currentMesh=C.meshes[w],C.currentMeshName=w}if(h.computeWorldVerticesOld(C,C.currentMesh.vertices),"3"!==PIXI.VERSION[0]){var _=C.currentMesh.tintRgb;_[0]=r*C.color.r*u.r,_[1]=a*C.color.g*u.g,_[2]=s*C.color.b*u.b}C.currentMesh.blendMode=C.blendMode}else{if(!(h instanceof t.core.ClippingAttachment)){p.visible=!1;continue}C.currentGraphics||(this.createGraphics(C,h),p.addChild(C.clippingContainer),p.addChild(C.currentGraphics)),this.updateGraphics(C,h)}p.visible=!0,p.alpha=C.color.a}else p.visible=!1}for(var S=this.skeleton.drawOrder,T=null,P=null,l=0,c=S.length;l<c;l++){var C=o[S[l].data.index],p=this.slotContainers[S[l].data.index];if(P||p.parent!==this&&(p.parent.removeChild(p),p.parent=this),C.currentGraphics&&C.attachment)P=C.clippingContainer,T=C.attachment,P.children.length=0,this.children[l]=p,T.endSlot==C.data&&(P.renderable=!1,P=null,T=null);else if(P){var I=this.tempClipContainers[l];I||((I=this.tempClipContainers[l]=new PIXI.Container).visible=!1),this.children[l]=I,p.parent=null,P.addChild(p),T.endSlot==C.data&&(P.renderable=!0,P=null,T=null)}else this.children[l]=p}},a.prototype.setSpriteRegion=function(t,e,i){e.region=i,e.texture=i.texture,i.size?(e.scale.x=i.size.width/i.originalWidth,e.scale.y=-i.size.height/i.originalHeight):(e.scale.x=t.scaleX*t.width/i.originalWidth,e.scale.y=-t.scaleY*t.height/i.originalHeight)},a.prototype.setMeshRegion=function(t,e,i){e.region=i,e.texture=i.texture,t.updateUVs(i,e.uvs),e.dirty++},a.prototype.autoUpdateTransform=function(){if(a.globalAutoUpdate){this.lastTime=this.lastTime||Date.now();var t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(t)}else this.lastTime=0;PIXI.Container.prototype.updateTransform.call(this)},a.prototype.createSprite=function(e,i,o){var r=i.region;e.tempAttachment===i&&(r=e.tempRegion,e.tempAttachment=null,e.tempRegion=null);var a=r.texture,s=new n(a);return s.rotation=i.rotation*t.core.MathUtils.degRad,s.anchor.x=.5,s.anchor.y=.5,s.position.x=i.x,s.position.y=i.y,s.alpha=i.color.a,s.region=i.region,this.setSpriteRegion(i,s,i.region),e.sprites=e.sprites||{},e.sprites[o]=s,s},a.prototype.createMesh=function(t,e){var i=e.region;t.tempAttachment===e&&(i=t.tempRegion,t.tempAttachment=null,t.tempRegion=null);var n=new o(i.texture,new Float32Array(e.regionUVs.length),new Float32Array(e.regionUVs.length),new Uint16Array(e.triangles),PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES);return n.canvasPadding=1.5,n.alpha=e.color.a,n.region=e.region,this.setMeshRegion(e,n,i),t.meshes=t.meshes||{},t.meshes[e.name]=n,n},a.prototype.createGraphics=function(t,e){var i=new PIXI.Graphics,n=new PIXI.Polygon([]);return i.clear(),i.beginFill(16777215,1),i.drawPolygon(n),i.renderable=!1,t.currentGraphics=i,t.clippingContainer=new PIXI.Container,t.clippingContainer.mask=t.currentGraphics,i},a.prototype.updateGraphics=function(t,e){var i=t.currentGraphics.graphicsData[0].shape.points,n=e.worldVerticesLength;i.length=n,e.computeWorldVertices(t,0,n,i,0,2),t.currentGraphics.dirty++,t.currentGraphics.clearDirty++},a.prototype.hackTextureBySlotIndex=function(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var o=this.skeleton.slots[e];if(!o)return!1;var r=o.attachment,a=r.region;return i&&((a=new t.core.TextureRegion).texture=i,a.size=n),o.currentSprite&&o.currentSprite.region!=a?(this.setSpriteRegion(r,o.currentSprite,a),o.currentSprite.region=a):o.currentMesh&&o.currentMesh.region!=a?this.setMeshRegion(r,o.currentMesh,a):(o.tempRegion=a,o.tempAttachment=r),!0},a.globalAutoUpdate=!0,a.clippingPolygon=[],a}(PIXI.Container);t.Spine=r}(pixi_spine||(pixi_spine={})),PIXI.spine=pixi_spine;var pixi_projection;!function(t){!function(t){t.createIndicesForQuads=function(t){for(var e=6*t,i=new Uint16Array(e),n=0,o=0;n<e;n+=6,o+=4)i[n+0]=o+0,i[n+1]=o+1,i[n+2]=o+2,i[n+3]=o+0,i[n+4]=o+2,i[n+5]=o+3;return i},t.isPow2=function(t){return!(t&t-1||!t)},t.nextPow2=function(t){return t+=+(0===t),--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},t.log2=function(t){var e,i;return e=+(t>65535)<<4,t>>>=e,i=+(t>255)<<3,t>>>=i,e|=i,i=+(t>15)<<2,t>>>=i,e|=i,i=+(t>3)<<1,t>>>=i,(e|=i)|t>>1},t.getIntersectionFactor=function(t,e,i,n,o){var r=e.x-t.x,a=i.x-n.x,s=i.x-t.x,l=e.y-t.y,c=i.y-n.y,h=i.y-t.y,p=r*c-l*a;if(Math.abs(p)<1e-7)return o.x=r,o.y=l,0;var u=(s*c-h*a)/p,d=(r*h-l*s)/p;return d<1e-6||d-1>-1e-6?-1:(o.x=t.x+u*(e.x-t.x),o.y=t.y+u*(e.y-t.y),1)},t.getPositionFromQuad=function(t,e,i){i=i||new PIXI.Point;var n=1-e.x,o=1-n,r=1-e.y,a=1-r;return i.x=(t[0].x*n+t[1].x*o)*r+(t[3].x*n+t[2].x*o)*a,i.y=(t[0].y*n+t[1].y*o)*r+(t[3].y*n+t[2].y*o)*a,i}}(t.utils||(t.utils={}))}(pixi_projection||(pixi_projection={})),PIXI.projection=pixi_projection;var pixi_projection;!function(t){var e=function(){function t(t,e){void 0===e&&(e=!0),this._enabled=!1,this.legacy=t,e&&(this.enabled=!0),this.legacy.proj=this}return Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t},enumerable:!0,configurable:!0}),t.prototype.clear=function(){},t}();t.AbstractProjection=e;!function(t){t[t.NONE=0]="NONE",t[t.BEFORE_PROJ=4]="BEFORE_PROJ",t[t.PROJ=5]="PROJ",t[t.ALL=9]="ALL"}(t.TRANSFORM_STEP||(t.TRANSFORM_STEP={}))}(pixi_projection||(pixi_projection={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pixi_projection;!function(t){function e(t){var e=this.proj,i=this,n=t._worldID,o=i.localTransform;i._localID!==i._currentLocalID&&(o.a=i._cx*i.scale._x,o.b=i._sx*i.scale._x,o.c=i._cy*i.scale._y,o.d=i._sy*i.scale._y,o.tx=i.position._x-(i.pivot._x*o.a+i.pivot._y*o.c),o.ty=i.position._y-(i.pivot._x*o.b+i.pivot._y*o.d),i._currentLocalID=i._localID,e._currentProjID=-1);var r=e._projID;if(e._currentProjID!==r&&(e._currentProjID=r,e.updateLocalTransform(o),i._parentID=-1),i._parentID!==n){var a=t.proj;a&&!a._affine?e.world.setToMult(a.world,e.local):e.world.setToMultLegacy(t.worldTransform,e.local),e.world.copy(i.worldTransform,e._affine),i._parentID=n,i._worldID++}}var i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._projID=0,e._currentProjID=-1,e._affine=t.AFFINE.NONE,e}return __extends(n,i),n.prototype.updateLocalTransform=function(t){},Object.defineProperty(n.prototype,"affine",{get:function(){return this._affine},set:function(t){this._affine!=t&&(this._affine=t,this._currentProjID=-1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=e,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.TransformStatic.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),n.prototype.clear=function(){this._currentProjID=-1,this._projID=0},n}(t.AbstractProjection);t.LinearProjection=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){!function(t){var e=function(){function t(t){this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null},t}();t.BatchBuffer=e}(t.webgl||(t.webgl={}))}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){!function(e){var i=PIXI.ObjectRenderer,n=PIXI.settings,o=PIXI.glCore.GLBuffer,r=PIXI.utils.premultiplyTint,a=PIXI.utils.premultiplyBlendMode,s=0,l=function(){return function(){this.textures=[],this.textureCount=0,this.ids=[],this.size=0,this.start=0,this.blend=PIXI.BLEND_MODES.NORMAL,this.uniforms=null}}();e.BatchGroup=l;var c=function(i){function c(e){var o=i.call(this,e)||this;o.shaderVert="",o.shaderFrag="",o.MAX_TEXTURES_LOCAL=32,o.vertSize=5,o.vertByteSize=4*o.vertSize,o.size=n.SPRITE_BATCH_SIZE,o.currentIndex=0,o.sprites=[],o.vertexBuffers=[],o.vaos=[],o.vaoMax=2,o.vertexCount=0,o.MAX_TEXTURES=1,o.indices=t.utils.createIndicesForQuads(o.size),o.groups=[];for(var r=0;r<o.size;r++)o.groups[r]=new l;return o.vaoMax=2,o.vertexCount=0,o.renderer.on("prerender",o.onPrerender,o),o}return __extends(c,i),c.prototype.getUniforms=function(t){return null},c.prototype.syncUniforms=function(t){if(t){var e=this.shader;for(var i in t)e.uniforms[i]=t[i]}},c.prototype.onContextChange=function(){var i=this.renderer.gl;this.MAX_TEXTURES=Math.min(this.MAX_TEXTURES_LOCAL,this.renderer.plugins.sprite.MAX_TEXTURES),this.shader=e.generateMultiTextureShader(this.shaderVert,this.shaderFrag,i,this.MAX_TEXTURES),this.indexBuffer=o.createIndexBuffer(i,this.indices,i.STATIC_DRAW),this.renderer.bindVao(null);this.shader.attributes;for(r=0;r<this.vaoMax;r++){var n=this.vertexBuffers[r]=o.createVertexBuffer(i,null,i.STREAM_DRAW);this.vaos[r]=this.createVao(n)}if(!this.buffers){this.buffers=[];for(var r=1;r<=t.utils.nextPow2(this.size);r*=2)this.buffers.push(new e.BatchBuffer(4*r*this.vertByteSize))}this.vao=this.vaos[0]},c.prototype.onPrerender=function(){this.vertexCount=0},c.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&t._texture.baseTexture&&(this.sprites[this.currentIndex++]=t)},c.prototype.flush=function(){if(0!==this.currentIndex){var e,i,l=this.renderer.gl,c=this.MAX_TEXTURES,h=t.utils.nextPow2(this.currentIndex),p=t.utils.log2(h),u=this.buffers[p],d=this.sprites,f=this.groups,m=u.float32View,g=u.uint32View,y=0,v=null,b=1,w=0,x=f[0],_=a[d[0]._texture.baseTexture.premultipliedAlpha?1:0][d[0].blendMode];x.textureCount=0,x.start=0,x.blend=_,s++;var S;for(S=0;S<this.currentIndex;++S){var T=d[S];e=T._texture.baseTexture;var P=a[Number(e.premultipliedAlpha)][T.blendMode];_!==P&&(_=P,i=null,w=c,s++);var C=this.getUniforms(T);v!==C&&(v=C,i=null,w=c,s++),i!==e&&(i=e,e._enabled!==s&&(w===c&&(s++,w=0,x.size=S-x.start,(x=f[b++]).textureCount=0,x.blend=_,x.start=S,x.uniforms=v),e._enabled=s,e._virtalBoundId=w,x.textures[x.textureCount++]=e,w++));var I=Math.min(T.worldAlpha,1),k=I<1&&e.premultipliedAlpha?r(T._tintRGB,I):T._tintRGB+(255*I<<24);this.fillVertices(m,g,y,T,k,e._virtalBoundId),y+=4*this.vertSize}if(x.size=S-x.start,n.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(u.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;this.shader.attributes;var A=this.vertexBuffers[this.vertexCount]=o.createVertexBuffer(l,null,l.STREAM_DRAW);this.vaos[this.vertexCount]=this.createVao(A)}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(u.vertices,0,!1),this.vertexCount++}for(v=null,S=0;S<b;S++){var M=f[S],O=M.textureCount;M.uniforms!==v&&this.syncUniforms(M.uniforms);for(var R=0;R<O;R++){this.renderer.bindTexture(M.textures[R],R,!0),M.textures[R]._virtalBoundId=-1;var B=this.shader.uniforms.samplerSize;B&&(B[0]=M.textures[R].realWidth,B[1]=M.textures[R].realHeight,this.shader.uniforms.samplerSize=B)}this.renderer.state.setBlendMode(M.blend),l.drawElements(l.TRIANGLES,6*M.size,l.UNSIGNED_SHORT,6*M.start*2)}this.currentIndex=0}},c.prototype.start=function(){this.renderer.bindShader(this.shader),n.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},c.prototype.stop=function(){this.flush()},c.prototype.destroy=function(){for(t=0;t<this.vaoMax;t++)this.vertexBuffers[t]&&this.vertexBuffers[t].destroy(),this.vaos[t]&&this.vaos[t].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),i.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var t=0;t<this.buffers.length;++t)this.buffers[t].destroy()},c}(i);e.MultiTextureSpriteRenderer=c}(t.webgl||(t.webgl={}))}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){!function(t){function e(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(textureId == "+i+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], textureCoord);",e+="\n}";return e+="\n",e+="\n"}t.generateMultiTextureShader=function(t,i,n,o){i=(i=i.replace(/%count%/gi,o+"")).replace(/%forloop%/gi,e(o));for(var r=new PIXI.Shader(n,t,i),a=new Int32Array(o),s=0;s<o;s++)a[s]=s;return r.bind(),r.uniforms.uSamplers=a,r}}(t.webgl||(t.webgl={}))}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],i=[0,0,0,0],n=function(){function t(){this.surfaceID="default",this._updateID=0,this.vertexSrc="",this.fragmentSrc=""}return t.prototype.fillUniforms=function(t){},t.prototype.clear=function(){},t.prototype.boundsQuad=function(t,n,o){for(var r=n[0],a=n[1],s=n[0],l=n[1],c=2;c<8;c+=2)r>n[c]&&(r=n[c]),s<n[c]&&(s=n[c]),a>n[c+1]&&(a=n[c+1]),l<n[c+1]&&(l=n[c+1]);if(e[0].set(r,a),this.apply(e[0],e[0]),e[1].set(s,a),this.apply(e[1],e[1]),e[2].set(s,l),this.apply(e[2],e[2]),e[3].set(r,l),this.apply(e[3],e[3]),o)o.apply(e[0],e[0]),o.apply(e[1],e[1]),o.apply(e[2],e[2]),o.apply(e[3],e[3]),n[0]=e[0].x,n[1]=e[0].y,n[2]=e[1].x,n[3]=e[1].y,n[4]=e[2].x,n[5]=e[2].y,n[6]=e[3].x,n[7]=e[3].y;else{for(c=1;c<=3;c++)if(e[c].y<e[0].y||e[c].y==e[0].y&&e[c].x<e[0].x){p=e[0];e[0]=e[c],e[c]=p}for(c=1;c<=3;c++)i[c]=Math.atan2(e[c].y-e[0].y,e[c].x-e[0].x);for(c=1;c<=3;c++)for(var h=c+1;h<=3;h++)if(i[c]>i[h]){var p=e[c];e[c]=e[h],e[h]=p;var u=i[c];i[c]=i[h],i[h]=u}if(n[0]=e[0].x,n[1]=e[0].y,n[2]=e[1].x,n[3]=e[1].y,n[4]=e[2].x,n[5]=e[2].y,n[6]=e[3].x,n[7]=e[3].y,(e[3].x-e[2].x)*(e[1].y-e[2].y)-(e[1].x-e[2].x)*(e[3].y-e[2].y)<0)return n[4]=e[3].x,void(n[5]=e[3].y)}},t}();t.Surface=n}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.Matrix,i=new PIXI.Rectangle,n=new PIXI.Point,o=function(t){function o(){var e=t.call(this)||this;return e.distortion=new PIXI.Point,e}return __extends(o,t),o.prototype.clear=function(){this.distortion.set(0,0)},o.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.distortion,n=t.x*t.y;return e.x=t.x+i.x*n,e.y=t.y+i.y*n,e},o.prototype.applyInverse=function(t,e){e=e||new PIXI.Point;var i=t.x,n=t.y,o=this.distortion.x,r=this.distortion.y;if(0==o)e.x=i,e.y=n/(1+r*i);else if(0==r)e.y=n,e.x=i/(1+o*n);else{var a=.5*(n*o-i*r+1)/r,s=a*a+i/r;if(s<=1e-5)return void e.set(NaN,NaN);e.x=r>0?-a+Math.sqrt(s):-a-Math.sqrt(s),e.y=(i/e.x-1)/o}return e},o.prototype.mapSprite=function(t,e,n){var o=t.texture;return i.x=-t.anchor.x*o.orig.width,i.y=-t.anchor.y*o.orig.height,i.width=o.orig.width,i.height=o.orig.height,this.mapQuad(i,e,n||t.transform)},o.prototype.mapQuad=function(t,i,o){var r=-t.x/t.width,a=-t.y/t.height,s=(1-t.x)/t.width,l=(1-t.y)/t.height,c=i[0].x*(1-r)+i[1].x*r,h=i[0].y*(1-r)+i[1].y*r,p=i[0].x*(1-s)+i[1].x*s,u=i[0].y*(1-s)+i[1].y*s,d=i[3].x*(1-r)+i[2].x*r,f=i[3].y*(1-r)+i[2].y*r,m=i[3].x*(1-s)+i[2].x*s,g=i[3].y*(1-s)+i[2].y*s,y=c*(1-a)+d*a,v=h*(1-a)+f*a,b=p*(1-a)+m*a,w=u*(1-a)+g*a,x=c*(1-l)+d*l,_=h*(1-l)+f*l,S=p*(1-l)+m*l,T=u*(1-l)+g*l,P=e;return P.tx=y,P.ty=v,P.a=b-y,P.b=w-v,P.c=x-y,P.d=_-v,n.set(S,T),P.applyInverse(n,n),this.distortion.set(n.x-1,n.y-1),o.setFromMatrix(P),this},o.prototype.fillUniforms=function(t){t.distortion=t.distortion||new Float32Array([0,0,0,0]);var e=Math.abs(this.distortion.x),i=Math.abs(this.distortion.y);t.distortion[0]=1e4*e<=i?0:this.distortion.x,t.distortion[1]=1e4*i<=e?0:this.distortion.y,t.distortion[2]=1/t.distortion[0],t.distortion[3]=1/t.distortion[1]},o}(t.Surface);t.BilinearSurface=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.proj=new t.ProjectionSurface(i.transform),i}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),i}(PIXI.Container);t.Container2s=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(t){var e=this.proj,n=t.proj,o=this;return n?n._surface?(e._activeProjection=n,this.updateLocalTransform(),this.localTransform.copy(this.worldTransform),void(o._parentID<0&&++o._worldID)):(i.call(this,t),void(e._activeProjection=n._activeProjection)):(i.call(this,t),void(e._activeProjection=null))}var i=PIXI.TransformStatic.prototype.updateTransform,n=function(i){function n(t,e){var n=i.call(this,t,e)||this;return n._surface=null,n._activeProjection=null,n._currentSurfaceID=-1,n._currentLegacyID=-1,n._lastUniforms=null,n}return __extends(n,i),Object.defineProperty(n.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=e,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.TransformStatic.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"surface",{get:function(){return this._surface},set:function(t){this._surface!=t&&(this._surface=t||null,this.legacy._parentID=-1)},enumerable:!0,configurable:!0}),n.prototype.applyPartial=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e)):null!==this._surface?this.surface.apply(t,e):this.legacy.worldTransform.apply(t,e)},n.prototype.apply=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e),this._activeProjection.legacy.worldTransform.apply(e,e)):null!==this._surface?(e=this.surface.apply(t,e),this.legacy.worldTransform.apply(e,e)):this.legacy.worldTransform.apply(t,e)},n.prototype.applyInverse=function(t,e){return null!==this._activeProjection?(e=this._activeProjection.legacy.worldTransform.applyInverse(t,e),this._activeProjection._surface.applyInverse(e,e),this.legacy.worldTransform.applyInverse(e,e)):null!==this._surface?(e=this.legacy.worldTransform.applyInverse(t,e),this._surface.applyInverse(e,e)):this.legacy.worldTransform.applyInverse(t,e)},n.prototype.mapBilinearSprite=function(e,i){this._surface instanceof t.BilinearSurface||(this.surface=new t.BilinearSurface),this.surface.mapSprite(e,i,this.legacy)},n.prototype.clear=function(){this.surface&&this.surface.clear()},Object.defineProperty(n.prototype,"uniforms",{get:function(){return this._currentLegacyID===this.legacy._worldID&&this._currentSurfaceID===this.surface._updateID?this._lastUniforms:(this._lastUniforms=this._lastUniforms||{},this._lastUniforms.worldTransform=this.legacy.worldTransform.toArray(!0),this._surface.fillUniforms(this._lastUniforms),this._lastUniforms)},enumerable:!0,configurable:!0}),n}(t.AbstractProjection);t.ProjectionSurface=n}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=100,e.MAX_TEXTURES_LOCAL=1,e.shaderVert="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec3 aTrans1;\nattribute vec3 aTrans2;\nattribute vec4 aFrame;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 worldTransform;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * worldTransform * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aVertexPosition;\n    vTrans1 = aTrans1;\n    vTrans2 = aTrans2;\n    vTextureId = aTextureId;\n    vColor = aColor;\n    vFrame = aFrame;\n}\n",e.shaderFrag="precision highp float;\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\nuniform vec2 samplerSize[%count%]; \nuniform vec4 distortion;\n\nvoid main(void){\nvec2 surface;\nvec2 surface2;\n\nfloat vx = vTextureCoord.x;\nfloat vy = vTextureCoord.y;\nfloat dx = distortion.x;\nfloat dy = distortion.y;\nfloat revx = distortion.z;\nfloat revy = distortion.w;\n\nif (distortion.x == 0.0) {\n    surface.x = vx;\n    surface.y = vy / (1.0 + dy * vx);\n    surface2 = surface;\n} else\nif (distortion.y == 0.0) {\n    surface.y = vy;\n    surface.x = vx/ (1.0 + dx * vy);\n    surface2 = surface;\n} else {\n    float c = vy * dx - vx * dy;\n    float b = (c + 1.0) * 0.5;\n    float b2 = (-c + 1.0) * 0.5;\n    float d = b * b + vx * dy;\n    if (d < -0.00001) {\n        discard;\n    }\n    d = sqrt(max(d, 0.0));\n    surface.x = (- b + d) * revy;\n    surface2.x = (- b - d) * revy;\n    surface.y = (- b2 + d) * revx;\n    surface2.y = (- b2 - d) * revx;\n}\n\nvec2 uv;\nuv.x = vTrans1.x * surface.x + vTrans1.y * surface.y + vTrans1.z;\nuv.y = vTrans2.x * surface.x + vTrans2.y * surface.y + vTrans2.z;\n\nvec2 pixels = uv * samplerSize[0];\n\nif (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n    pixels.y < vFrame.y || pixels.y > vFrame.w) {\n    uv.x = vTrans1.x * surface2.x + vTrans1.y * surface2.y + vTrans1.z;\n    uv.y = vTrans2.x * surface2.x + vTrans2.y * surface2.y + vTrans2.z;\n    pixels = uv * samplerSize[0];\n    \n    if (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n        pixels.y < vFrame.y || pixels.y > vFrame.w) {\n        discard;\n    }\n}\n\nvec4 edge;\nedge.xy = clamp(pixels - vFrame.xy + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\nedge.zw = clamp(vFrame.zw - pixels + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\n\nfloat alpha = 1.0; //edge.x * edge.y * edge.z * edge.w;\nvec4 rColor = vColor * alpha;\n\nfloat textureId = floor(vTextureId+0.5);\nvec4 color;\nvec2 textureCoord = uv;\n%forloop%\ngl_FragColor = color * rColor;\n}",e.defUniforms={worldTransform:new Float32Array([1,0,0,0,1,0,0,0,1]),distortion:new Float32Array([0,0])},e}return __extends(e,t),e.prototype.getUniforms=function(t){var e=t.proj;this.shader;return null!==e.surface?e.uniforms:null!==e._activeProjection?e._activeProjection.uniforms:this.defUniforms},e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=14,this.vertByteSize=4*this.vertSize;var i=this.renderer.gl,n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,i.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTrans1,i.FLOAT,!1,this.vertByteSize,8).addAttribute(t,e.aTrans2,i.FLOAT,!1,this.vertByteSize,20).addAttribute(t,e.aFrame,i.FLOAT,!1,this.vertByteSize,32).addAttribute(t,e.aColor,i.UNSIGNED_BYTE,!0,this.vertByteSize,48);return e.aTextureId&&n.addAttribute(t,e.aTextureId,i.FLOAT,!1,this.vertByteSize,52),n},e.prototype.fillVertices=function(t,e,i,n,o,r){for(var a=n.vertexData,s=n._texture,l=(s.orig.width,s.orig.height,n._anchor._x,n._anchor._y,s._frame),c=n.aTrans,h=0;h<4;h++)t[i]=a[2*h],t[i+1]=a[2*h+1],t[i+2]=c.a,t[i+3]=c.c,t[i+4]=c.tx,t[i+5]=c.b,t[i+6]=c.d,t[i+7]=c.ty,t[i+8]=l.x,t[i+9]=l.y,t[i+10]=l.x+l.width,t[i+11]=l.y+l.height,e[i+12]=o,t[i+13]=r,i+=14},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite_bilinear",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=100,e.MAX_TEXTURES_LOCAL=1,e.shaderVert="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec3 aTrans1;\nattribute vec3 aTrans2;\nattribute vec4 aFrame;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 worldTransform;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * worldTransform * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aVertexPosition;\n    vTrans1 = aTrans1;\n    vTrans2 = aTrans2;\n    vTextureId = aTextureId;\n    vColor = aColor;\n    vFrame = aFrame;\n}\n",e.shaderFrag="precision highp float;\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\nuniform vec2 samplerSize[%count%]; \nuniform vec4 params;\n\nvoid main(void){\nvec2 surface;\n\nfloat vx = vTextureCoord.x;\nfloat vy = vTextureCoord.y;\nfloat aleph = params.x;\nfloat bet = params.y;\nfloat A = params.z;\nfloat B = params.w;\n\nif (aleph == 0.0) {\n\tsurface.y = vy / (1.0 + vx * bet);\n\tsurface.x = vx;\n}\nelse if (bet == 0.0) {\n\tsurface.x = vx / (1.0 + vy * aleph);\n\tsurface.y = vy;\n} else {\n\tsurface.x = vx * (bet + 1.0) / (bet + 1.0 + vy * aleph);\n\tsurface.y = vy * (aleph + 1.0) / (aleph + 1.0 + vx * bet);\n}\n\nvec2 uv;\nuv.x = vTrans1.x * surface.x + vTrans1.y * surface.y + vTrans1.z;\nuv.y = vTrans2.x * surface.x + vTrans2.y * surface.y + vTrans2.z;\n\nvec2 pixels = uv * samplerSize[0];\n\nvec4 edge;\nedge.xy = clamp(pixels - vFrame.xy + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\nedge.zw = clamp(vFrame.zw - pixels + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\n\nfloat alpha = edge.x * edge.y * edge.z * edge.w;\nvec4 rColor = vColor * alpha;\n\nfloat textureId = floor(vTextureId+0.5);\nvec4 color;\nvec2 textureCoord = uv;\n%forloop%\ngl_FragColor = color * rColor;\n}",e.defUniforms={worldTransform:new Float32Array([1,0,0,0,1,0,0,0,1]),distortion:new Float32Array([0,0])},e}return __extends(e,t),e.prototype.getUniforms=function(t){var e=t.proj;this.shader;return null!==e.surface?e.uniforms:null!==e._activeProjection?e._activeProjection.uniforms:this.defUniforms},e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=14,this.vertByteSize=4*this.vertSize;var i=this.renderer.gl,n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,i.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTrans1,i.FLOAT,!1,this.vertByteSize,8).addAttribute(t,e.aTrans2,i.FLOAT,!1,this.vertByteSize,20).addAttribute(t,e.aFrame,i.FLOAT,!1,this.vertByteSize,32).addAttribute(t,e.aColor,i.UNSIGNED_BYTE,!0,this.vertByteSize,48);return e.aTextureId&&n.addAttribute(t,e.aTextureId,i.FLOAT,!1,this.vertByteSize,52),n},e.prototype.fillVertices=function(t,e,i,n,o,r){for(var a=n.vertexData,s=n._texture,l=(s.orig.width,s.orig.height,n._anchor._x,n._anchor._y,s._frame),c=n.aTrans,h=0;h<4;h++)t[i]=a[2*h],t[i+1]=a[2*h+1],t[i+2]=c.a,t[i+3]=c.c,t[i+4]=c.tx,t[i+5]=c.b,t[i+6]=c.d,t[i+7]=c.ty,t[i+8]=l.x,t[i+9]=l.y,t[i+10]=l.x+l.width,t[i+11]=l.y+l.height,e[i+12]=o,t[i+13]=r,i+=14},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite_strange",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.Matrix,i=new PIXI.Rectangle,n=new PIXI.Point,o=function(t){function o(){var e=t.call(this)||this;return e.params=[0,0,NaN,NaN],e}return __extends(o,t),o.prototype.clear=function(){var t=this.params;t[0]=0,t[1]=0,t[2]=NaN,t[3]=NaN},o.prototype.setAxisX=function(t,e,i){var n=t.x,o=t.y,r=Math.sqrt(n*n+o*o),a=i.rotation;0!==a&&(i.skew._x-=a,i.skew._y+=a,i.rotation=0),i.skew.y=Math.atan2(o,n);var s=this.params;s[2]=0!==e?-r*e:NaN,this._calc01()},o.prototype.setAxisY=function(t,e,i){var n=t.x,o=t.y,r=Math.sqrt(n*n+o*o),a=i.rotation;0!==a&&(i.skew._x-=a,i.skew._y+=a,i.rotation=0),i.skew.x=-Math.atan2(o,n)+Math.PI/2;var s=this.params;s[3]=0!==e?-r*e:NaN,this._calc01()},o.prototype._calc01=function(){var t=this.params;if(isNaN(t[2]))t[1]=0,isNaN(t[3])?t[0]=0:t[0]=1/t[3];else if(isNaN(t[3]))t[0]=0,t[1]=1/t[2];else{var e=1-t[2]*t[3];t[0]=(1-t[2])/e,t[1]=(1-t[3])/e}},o.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.params[0],n=this.params[1],o=this.params[2],r=this.params[3],a=t.x,s=t.y;if(0===i)e.y=s*(1+a*n),e.x=a;else if(0===n)e.x=a*(1+s*i),e.y=s;else{var l=o*r-s*a;e.x=o*a*(r+s)/l,e.y=r*s*(o+a)/l}return e},o.prototype.applyInverse=function(t,e){e=e||new PIXI.Point;var i=this.params[0],n=this.params[1],o=(this.params[2],this.params[3],t.x),r=t.y;return 0===i?(e.y=r/(1+o*n),e.x=o):0===n?(e.x=o*(1+r*i),e.y=r):(e.x=o*(n+1)/(n+1+r*i),e.y=r*(i+1)/(i+1+o*n)),e},o.prototype.mapSprite=function(t,e,n){var o=t.texture;return i.x=-t.anchor.x*o.orig.width,i.y=-t.anchor.y*o.orig.height,i.width=o.orig.width,i.height=o.orig.height,this.mapQuad(i,e,n||t.transform)},o.prototype.mapQuad=function(t,i,o){var r=-t.x/t.width,a=-t.y/t.height,s=(1-t.x)/t.width,l=(1-t.y)/t.height,c=i[0].x*(1-r)+i[1].x*r,h=i[0].y*(1-r)+i[1].y*r,p=i[0].x*(1-s)+i[1].x*s,u=i[0].y*(1-s)+i[1].y*s,d=i[3].x*(1-r)+i[2].x*r,f=i[3].y*(1-r)+i[2].y*r,m=i[3].x*(1-s)+i[2].x*s,g=i[3].y*(1-s)+i[2].y*s,y=c*(1-a)+d*a,v=h*(1-a)+f*a,b=p*(1-a)+m*a,w=u*(1-a)+g*a,x=c*(1-l)+d*l,_=h*(1-l)+f*l,S=p*(1-l)+m*l,T=u*(1-l)+g*l,P=e;return P.tx=y,P.ty=v,P.a=b-y,P.b=w-v,P.c=x-y,P.d=_-v,n.set(S,T),P.applyInverse(n,n),o.setFromMatrix(P),this},o.prototype.fillUniforms=function(t){var e=this.params,i=t.params||new Float32Array([0,0,0,0]);t.params=i,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]},o}(t.Surface);t.StrangeSurface=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.aTrans=new PIXI.Matrix,n.proj=new t.ProjectionSurface(n.transform),n.pluginName="sprite_bilinear",n}return __extends(i,e),i.prototype._calculateBounds=function(){this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)},i.prototype.calculateVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this._transformID!==t||this._textureID!==e){this._transformID=t,this._textureID=e;var i=this._texture,n=this.vertexData,o=i.trim,r=i.orig,a=this._anchor,s=0,l=0,c=0,h=0;if(o?(s=(l=o.x-a._x*r.width)+o.width,c=(h=o.y-a._y*r.height)+o.height):(s=(l=-a._x*r.width)+r.width,c=(h=-a._y*r.height)+r.height),this.proj._surface)n[0]=l,n[1]=h,n[2]=s,n[3]=h,n[4]=s,n[5]=c,n[6]=l,n[7]=c,this.proj._surface.boundsQuad(n,n);else{var p=this.transform.worldTransform,u=p.a,d=p.b,f=p.c,m=p.d,g=p.tx,y=p.ty;n[0]=u*l+f*h+g,n[1]=m*h+d*l+y,n[2]=u*s+f*h+g,n[3]=m*h+d*s+y,n[4]=u*s+f*c+g,n[5]=m*c+d*s+y,n[6]=u*l+f*c+g,n[7]=m*c+d*l+y,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(n,n)}i.transform||(i.transform=new PIXI.TextureMatrix(i)),i.transform.update();var v=this.aTrans;v.set(r.width,0,0,r.height,l,h),null===this.proj._surface&&v.prepend(this.transform.worldTransform),v.invert(),v.prepend(i.transform.mapCoord)}},i.prototype.calculateTrimmedVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===e)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=e;var i=this._texture,n=this.vertexTrimmedData,o=i.orig,r=this._anchor,a=-r._x*o.width,s=a+o.width,l=-r._y*o.height,c=l+o.height;if(this.proj._surface)n[0]=a,n[1]=l,n[2]=s,n[3]=l,n[4]=s,n[5]=c,n[6]=a,n[7]=c,this.proj._surface.boundsQuad(n,n,this.transform.worldTransform);else{var h=this.transform.worldTransform,p=h.a,u=h.b,d=h.c,f=h.d,m=h.tx,g=h.ty;n[0]=p*a+d*l+m,n[1]=f*l+u*a+g,n[2]=p*s+d*l+m,n[3]=f*l+u*s+g,n[4]=p*s+d*c+m,n[5]=f*c+u*s+g,n[6]=p*a+d*c+m,n[7]=f*c+u*a+g,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(n,n,this.proj._activeProjection.legacy.worldTransform)}},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),i}(PIXI.Sprite);t.Sprite2s=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o){var r=e.call(this,i,n,o)||this;return r.aTrans=new PIXI.Matrix,r.proj=new t.ProjectionSurface(r.transform),r.pluginName="sprite_bilinear",r}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),i}(PIXI.Text);t.Text2s=e,e.prototype.calculateVertices=t.Sprite2s.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite2s.prototype._calculateBounds}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){PIXI.Sprite.prototype.convertTo2s=function(){this.proj||(this.pluginName="sprite_bilinear",this.aTrans=new PIXI.Matrix,this.calculateVertices=t.Sprite2s.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite2s.prototype._calculateBounds,PIXI.Container.prototype.convertTo2s.call(this))},PIXI.Container.prototype.convertTo2s=function(){this.proj||(this.proj=new t.Projection2d(this.transform),Object.defineProperty(this,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}))},PIXI.Container.prototype.convertSubtreeTo2s=function(){this.convertTo2s();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2s()}}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){t.container2dWorldTransform=function(){return this.proj.affine?this.transform.worldTransform:this.proj.world};var e=function(e){function i(){var i=e.call(this)||this;return i.proj=new t.Projection2d(i.transform),i}return __extends(i,e),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),i&&(e=i.toGlobal(e,n,o)),o||this._recursivePostUpdateTransform(),r>=t.TRANSFORM_STEP.PROJ?(o||this.displayObjectUpdateTransform(),this.proj.affine?this.transform.worldTransform.applyInverse(n,n):this.proj.world.applyInverse(n,n)):(this.parent?n=this.parent.worldTransform.applyInverse(e,n):n.copy(e),r===t.TRANSFORM_STEP.NONE?n:this.transform.localTransform.applyInverse(n,n))},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.Container);t.Container2d=e,t.container2dToLocal=e.prototype.toLocal}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e,i=PIXI.Point,n=[1,0,0,0,1,0,0,0,1];!function(t){t[t.NONE=0]="NONE",t[t.FREE=1]="FREE",t[t.AXIS_X=2]="AXIS_X",t[t.AXIS_Y=3]="AXIS_Y",t[t.POINT=4]="POINT"}(e=t.AFFINE||(t.AFFINE={}));var o=function(){function t(t){this.floatArray=null,this.mat3=new Float64Array(t||n)}return Object.defineProperty(t.prototype,"a",{get:function(){return this.mat3[0]/this.mat3[8]},set:function(t){this.mat3[0]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.mat3[1]/this.mat3[8]},set:function(t){this.mat3[1]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"c",{get:function(){return this.mat3[3]/this.mat3[8]},set:function(t){this.mat3[3]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"d",{get:function(){return this.mat3[4]/this.mat3[8]},set:function(t){this.mat3[4]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tx",{get:function(){return this.mat3[6]/this.mat3[8]},set:function(t){this.mat3[6]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ty",{get:function(){return this.mat3[7]/this.mat3[8]},set:function(t){this.mat3[7]=t*this.mat3[8]},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,i,n,o,r){var a=this.mat3;return a[0]=t,a[1]=e,a[2]=0,a[3]=i,a[4]=n,a[5]=0,a[6]=o,a[7]=r,a[8]=1,this},t.prototype.toArray=function(t,e){this.floatArray||(this.floatArray=new Float32Array(9));var i=e||this.floatArray,n=this.mat3;return t?(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8]):(i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8]),i},t.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.mat3,n=t.x,o=t.y,r=1/(i[2]*n+i[5]*o+i[8]);return e.x=r*(i[0]*n+i[3]*o+i[6]),e.y=r*(i[1]*n+i[4]*o+i[7]),e},t.prototype.translate=function(t,e){var i=this.mat3;return i[0]+=t*i[2],i[1]+=e*i[2],i[3]+=t*i[5],i[4]+=e*i[5],i[6]+=t*i[8],i[7]+=e*i[8],this},t.prototype.scale=function(t,e){var i=this.mat3;return i[0]*=t,i[1]*=e,i[3]*=t,i[4]*=e,i[6]*=t,i[7]*=e,this},t.prototype.scaleAndTranslate=function(t,e,i,n){var o=this.mat3;o[0]=t*o[0]+i*o[2],o[1]=e*o[1]+n*o[2],o[3]=t*o[3]+i*o[5],o[4]=e*o[4]+n*o[5],o[6]=t*o[6]+i*o[8],o[7]=e*o[7]+n*o[8]},t.prototype.applyInverse=function(t,e){e=e||new i;var n=this.mat3,o=t.x,r=t.y,a=n[0],s=n[3],l=n[6],c=n[1],h=n[4],p=n[7],u=n[2],d=n[5],f=n[8],m=(f*h-p*d)*o+(-f*s+l*d)*r+(p*s-l*h),g=(-f*c+p*u)*o+(f*a-l*u)*r+(-p*a+l*c),y=(d*c-h*u)*o+(-d*a+s*u)*r+(h*a-s*c);return e.x=m/y,e.y=g/y,e},t.prototype.invert=function(){var t=this.mat3,e=t[0],i=t[1],n=t[2],o=t[3],r=t[4],a=t[5],s=t[6],l=t[7],c=t[8],h=c*r-a*l,p=-c*o+a*s,u=l*o-r*s,d=e*h+i*p+n*u;return d?(d=1/d,t[0]=h*d,t[1]=(-c*i+n*l)*d,t[2]=(a*i-n*r)*d,t[3]=p*d,t[4]=(c*e-n*s)*d,t[5]=(-a*e+n*o)*d,t[6]=u*d,t[7]=(-l*e+i*s)*d,t[8]=(r*e-i*o)*d,this):this},t.prototype.identity=function(){var t=this.mat3;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},t.prototype.clone=function(){return new t(this.mat3)},t.prototype.copyTo=function(t){var e=this.mat3,i=t.mat3;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],t},t.prototype.copy=function(t,i){var n=this.mat3,o=1/n[8],r=n[6]*o,a=n[7]*o;t.a=(n[0]-n[2]*r)*o,t.b=(n[1]-n[2]*a)*o,t.c=(n[3]-n[5]*r)*o,t.d=(n[4]-n[5]*a)*o,t.tx=r,t.ty=a,i>=2&&(i===e.POINT?(t.a=1,t.b=0,t.c=0,t.d=1):i===e.AXIS_X?(t.c=-t.b,t.d=t.a):i===e.AXIS_Y&&(t.a=t.d,t.c=-t.b))},t.prototype.copyFrom=function(t){var e=this.mat3;return e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=t.c,e[4]=t.d,e[5]=0,e[6]=t.tx,e[7]=t.ty,e[8]=1,this},t.prototype.setToMultLegacy=function(t,e){var i=this.mat3,n=e.mat3,o=t.a,r=t.b,a=t.c,s=t.d,l=t.tx,c=t.ty,h=n[0],p=n[1],u=n[2],d=n[3],f=n[4],m=n[5],g=n[6],y=n[7],v=n[8];return i[0]=h*o+p*a+u*l,i[1]=h*r+p*s+u*c,i[2]=u,i[3]=d*o+f*a+m*l,i[4]=d*r+f*s+m*c,i[5]=m,i[6]=g*o+y*a+v*l,i[7]=g*r+y*s+v*c,i[8]=v,this},t.prototype.setToMultLegacy2=function(t,e){var i=this.mat3,n=t.mat3,o=n[0],r=n[1],a=n[2],s=n[3],l=n[4],c=n[5],h=n[6],p=n[7],u=n[8],d=e.a,f=e.b,m=e.c,g=e.d,y=e.tx,v=e.ty;return i[0]=d*o+f*s,i[1]=d*r+f*l,i[2]=d*a+f*c,i[3]=m*o+g*s,i[4]=m*r+g*l,i[5]=m*a+g*c,i[6]=y*o+v*s+h,i[7]=y*r+v*l+p,i[8]=y*a+v*c+u,this},t.prototype.setToMult=function(t,e){var i=this.mat3,n=t.mat3,o=e.mat3,r=n[0],a=n[1],s=n[2],l=n[3],c=n[4],h=n[5],p=n[6],u=n[7],d=n[8],f=o[0],m=o[1],g=o[2],y=o[3],v=o[4],b=o[5],w=o[6],x=o[7],_=o[8];return i[0]=f*r+m*l+g*p,i[1]=f*a+m*c+g*u,i[2]=f*s+m*h+g*d,i[3]=y*r+v*l+b*p,i[4]=y*a+v*c+b*u,i[5]=y*s+v*h+b*d,i[6]=w*r+x*l+_*p,i[7]=w*a+x*c+_*u,i[8]=w*s+x*h+_*d,this},t.prototype.prepend=function(t){t.mat3?this.setToMult(t,this):this.setToMultLegacy(t,this)},t.IDENTITY=new t,t.TEMP_MATRIX=new t,t}();t.Matrix2d=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.Point,i=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],n=new PIXI.Rectangle,o=new t.Matrix2d,r=function(r){function a(e,i){var n=r.call(this,e,i)||this;return n.matrix=new t.Matrix2d,n.pivot=new PIXI.ObservablePoint(n.onChange,n,0,0),n.reverseLocalOrder=!1,n.local=new t.Matrix2d,n.world=new t.Matrix2d,n}return __extends(a,r),a.prototype.onChange=function(){var t=this.pivot,e=this.matrix.mat3;e[6]=-(t._x*e[0]+t._y*e[3]),e[7]=-(t._x*e[1]+t._y*e[4]),this._projID++},a.prototype.setAxisX=function(t,e){void 0===e&&(e=1);var i=t.x,n=t.y,o=Math.sqrt(i*i+n*n),r=this.matrix.mat3;r[0]=i/o,r[1]=n/o,r[2]=e/o,this.onChange()},a.prototype.setAxisY=function(t,e){void 0===e&&(e=1);var i=t.x,n=t.y,o=Math.sqrt(i*i+n*n),r=this.matrix.mat3;r[3]=i/o,r[4]=n/o,r[5]=e/o,this.onChange()},a.prototype.mapSprite=function(t,e){var i=t.texture;return n.x=-t.anchor.x*i.orig.width,n.y=-t.anchor.y*i.orig.height,n.width=i.orig.width,n.height=i.orig.height,this.mapQuad(n,e)},a.prototype.mapQuad=function(n,r){i[0].set(n.x,n.y),i[1].set(n.x+n.width,n.y),i[2].set(n.x+n.width,n.y+n.height),i[3].set(n.x,n.y+n.height);var a=1,s=2,l=3;if(0!==t.utils.getIntersectionFactor(r[0],r[2],r[1],r[3],e)){a=1,s=3,l=2;var c=Math.sqrt((r[0].x-e.x)*(r[0].x-e.x)+(r[0].y-e.y)*(r[0].y-e.y)),h=Math.sqrt((r[a].x-e.x)*(r[a].x-e.x)+(r[a].y-e.y)*(r[a].y-e.y)),p=Math.sqrt((r[s].x-e.x)*(r[s].x-e.x)+(r[s].y-e.y)*(r[s].y-e.y)),u=Math.sqrt((r[l].x-e.x)*(r[l].x-e.x)+(r[l].y-e.y)*(r[l].y-e.y)),d=(c+u)/u,f=(h+p)/p,m=(h+p)/h,g=this.matrix.mat3;g[0]=i[0].x*d,g[1]=i[0].y*d,g[2]=d,g[3]=i[a].x*f,g[4]=i[a].y*f,g[5]=f,g[6]=i[s].x*m,g[7]=i[s].y*m,g[8]=m,this.matrix.invert(),(g=o.mat3)[0]=r[0].x,g[1]=r[0].y,g[2]=1,g[3]=r[a].x,g[4]=r[a].y,g[5]=1,g[6]=r[s].x,g[7]=r[s].y,g[8]=1,this.matrix.setToMult(o,this.matrix),this._projID++}},a.prototype.updateLocalTransform=function(t){0!==this._projID?this.reverseLocalOrder?this.local.setToMultLegacy2(this.matrix,t):this.local.setToMultLegacy(t,this.matrix):this.local.copyFrom(t)},a.prototype.clear=function(){r.prototype.clear.call(this),this.matrix.identity(),this.pivot.set(0,0)},a}(t.LinearProjection);t.Projection2d=r}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o,r,a){var s=e.call(this,i,n,o,r,a)||this;return s.proj=new t.Projection2d(s.transform),s.pluginName="mesh2d",s}return __extends(i,e),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,i,n,o,r)},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.mesh.Mesh);t.Mesh2d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new PIXI.Shader(t,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position.xyw = projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","\nvarying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}")},e}(PIXI.mesh.MeshRenderer);t.Mesh2dRenderer=e,PIXI.WebGLRenderer.registerPlugin("mesh2d",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.proj=new t.Projection2d(n.transform),n.pluginName="sprite2d",n.vertexData=new Float32Array(12),n}return __extends(i,e),i.prototype._calculateBounds=function(){this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)},i.prototype.calculateVertices=function(){if(this.proj._affine)return 8!=this.vertexData.length&&(this.vertexData=new Float32Array(8)),void e.prototype.calculateVertices.call(this);12!=this.vertexData.length&&(this.vertexData=new Float32Array(12));var t=this.transform._worldID,i=this._texture._updateID;if(this._transformID!==t||this._textureID!==i){this._transformID=t,this._textureID=i;var n=this._texture,o=this.proj.world.mat3,r=this.vertexData,a=n.trim,s=n.orig,l=this._anchor,c=0,h=0,p=0,u=0;a?(c=(h=a.x-l._x*s.width)+a.width,p=(u=a.y-l._y*s.height)+a.height):(c=(h=-l._x*s.width)+s.width,p=(u=-l._y*s.height)+s.height),r[0]=o[0]*h+o[3]*u+o[6],r[1]=o[1]*h+o[4]*u+o[7],r[2]=o[2]*h+o[5]*u+o[8],r[3]=o[0]*c+o[3]*u+o[6],r[4]=o[1]*c+o[4]*u+o[7],r[5]=o[2]*c+o[5]*u+o[8],r[6]=o[0]*c+o[3]*p+o[6],r[7]=o[1]*c+o[4]*p+o[7],r[8]=o[2]*c+o[5]*p+o[8],r[9]=o[0]*h+o[3]*p+o[6],r[10]=o[1]*h+o[4]*p+o[7],r[11]=o[2]*h+o[5]*p+o[8]}},i.prototype.calculateTrimmedVertices=function(){if(this.proj._affine)e.prototype.calculateTrimmedVertices.call(this);else{var t=this.transform._worldID,i=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===i)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=i;var n=this._texture,o=this.vertexTrimmedData,r=n.orig,a=this._anchor,s=this.proj.world.mat3,l=-a._x*r.width,c=l+r.width,h=-a._y*r.height,p=h+r.height,u=1/(s[2]*l+s[5]*h+s[8]);o[0]=u*(s[0]*l+s[3]*h+s[6]),o[1]=u*(s[1]*l+s[4]*h+s[7]),u=1/(s[2]*c+s[5]*h+s[8]),o[2]=u*(s[0]*c+s[3]*h+s[6]),o[3]=u*(s[1]*c+s[4]*h+s[7]),u=1/(s[2]*c+s[5]*p+s[8]),o[4]=u*(s[0]*c+s[3]*p+s[6]),o[5]=u*(s[1]*c+s[4]*p+s[7]),u=1/(s[2]*l+s[5]*p+s[8]),o[6]=u*(s[0]*l+s[3]*p+s[6]),o[7]=u*(s[1]*l+s[4]*p+s[7])}},i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,i,n,o,r)},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.Sprite);t.Sprite2d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shaderVert="precision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * aVertexPosition;\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",e.shaderFrag="\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\nvec4 color;\nvec2 textureCoord = vTextureCoord;\nfloat textureId = floor(vTextureId+0.5);\n%forloop%\ngl_FragColor = color * vColor;\n}",e}return __extends(e,t),e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=6,this.vertByteSize=4*this.vertSize;var i=this.renderer.gl,n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,i.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTextureCoord,i.UNSIGNED_SHORT,!0,this.vertByteSize,12).addAttribute(t,e.aColor,i.UNSIGNED_BYTE,!0,this.vertByteSize,16);return e.aTextureId&&n.addAttribute(t,e.aTextureId,i.FLOAT,!1,this.vertByteSize,20),n},e.prototype.fillVertices=function(t,e,i,n,o,r){var a=n.vertexData,s=n._texture._uvs.uvsUint32;if(8===a.length)if(this.renderer.roundPixels){var l=this.renderer.resolution;t[i]=(a[0]*l|0)/l,t[i+1]=(a[1]*l|0)/l,t[i+2]=1,t[i+6]=(a[2]*l|0)/l,t[i+7]=(a[3]*l|0)/l,t[i+8]=1,t[i+12]=(a[4]*l|0)/l,t[i+13]=(a[5]*l|0)/l,t[i+14]=1,t[i+18]=(a[6]*l|0)/l,t[i+19]=(a[7]*l|0)/l,t[i+20]=1}else t[i]=a[0],t[i+1]=a[1],t[i+2]=1,t[i+6]=a[2],t[i+7]=a[3],t[i+8]=1,t[i+12]=a[4],t[i+13]=a[5],t[i+14]=1,t[i+18]=a[6],t[i+19]=a[7],t[i+20]=1;else t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+6]=a[3],t[i+7]=a[4],t[i+8]=a[5],t[i+12]=a[6],t[i+13]=a[7],t[i+14]=a[8],t[i+18]=a[9],t[i+19]=a[10],t[i+20]=a[11];e[i+3]=s[0],e[i+9]=s[1],e[i+15]=s[2],e[i+21]=s[3],e[i+4]=e[i+10]=e[i+16]=e[i+22]=o,t[i+5]=t[i+11]=t[i+17]=t[i+23]=r},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite2d",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o){var r=e.call(this,i,n,o)||this;return r.proj=new t.Projection2d(r.transform),r.pluginName="sprite2d",r.vertexData=new Float32Array(12),r}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.Text);t.Text2d=e,e.prototype.calculateVertices=t.Sprite2d.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite2d.prototype._calculateBounds}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(){this.proj||(this.proj=new t.Projection2d(this.transform),this.toLocal=t.Container2d.prototype.toLocal,Object.defineProperty(this,"worldTransform",{get:t.container2dWorldTransform,enumerable:!0,configurable:!0}))}PIXI.Container.prototype.convertTo2d=e,PIXI.Sprite.prototype.convertTo2d=function(){this.proj||(this.calculateVertices=t.Sprite2d.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite2d.prototype._calculateBounds,this.pluginName="sprite2d",this.vertexData=new Float32Array(12),e.call(this))},PIXI.mesh.Mesh.prototype.convertTo2d=function(){this.proj||(this.pluginName="mesh2d",e.call(this))},PIXI.Container.prototype.convertSubtreeTo2d=function(){this.convertTo2d();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2d()}}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.TransformStatic,i=function(i){function n(e,n,o){var r=i.call(this,e,n,o)||this;return r.tileProj=new t.Projection2d(r.tileTransform),r.tileProj.reverseLocalOrder=!0,r.proj=new t.Projection2d(r.transform),r.pluginName="tilingSprite2d",r.uvRespectAnchor=!0,r}return __extends(n,i),Object.defineProperty(n.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),n.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,i,n,o,r)},n.prototype._renderWebGL=function(t){var i=this._texture;i&&i.valid&&(this.tileTransform.updateTransform(e),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},n}(PIXI.extras.TilingSprite);t.TilingSprite2d=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec3 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position.xyw = projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0);\n\n    vTextureCoord = uTransform * vec3(aTextureCoord, 1.0);\n}\n",i=new t.Matrix2d,n=PIXI.WRAP_MODES,o=PIXI.utils,r=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new PIXI.Shader(t,e,"\nvarying vec3 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord.xy / vTextureCoord.z - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new PIXI.Shader(t,e,"\n\tvarying vec3 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord.xy / vTextureCoord.z);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new PIXI.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},r.prototype.render=function(t){var e=this.renderer,r=this.quad;e.bindVao(r.vao);var a=r.vertices;a[0]=a[6]=t._width*-t.anchor.x,a[1]=a[3]=t._height*-t.anchor.y,a[2]=a[4]=t._width*(1-t.anchor.x),a[5]=a[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((a=r.uvs)[0]=a[6]=-t.anchor.x,a[1]=a[3]=-t.anchor.y,a[2]=a[4]=1-t.anchor.x,a[5]=a[7]=1-t.anchor.y),r.upload();var s=t._texture,l=s.baseTexture,c=t.tileProj.world,h=t.uvTransform,p=l.isPowerOfTwo&&s.frame.width===l.width&&s.frame.height===l.height;p&&(l._glTextures[e.CONTEXT_UID]?p=l.wrapMode!==n.CLAMP:l.wrapMode===n.CLAMP&&(l.wrapMode=n.REPEAT));var u=p?this.simpleShader:this.shader;e.bindShader(u),i.identity(),i.scale(s.width,s.height),i.prepend(c),i.scale(1/t._width,1/t._height),i.invert(),p?i.prepend(h.mapCoord):(u.uniforms.uMapCoord=h.mapCoord.toArray(!0),u.uniforms.uClampFrame=h.uClampFrame,u.uniforms.uClampOffset=h.uClampOffset),u.uniforms.uTransform=i.toArray(!0),u.uniforms.uColor=o.premultiplyTintToRgba(t.tint,t.worldAlpha,u.uniforms.uColor,l.premultipliedAlpha),u.uniforms.translationMatrix=t.proj.world.toArray(!0),u.uniforms.uSampler=e.bindTexture(s),e.setBlendMode(o.correctBlendMode(t.blendMode,l.premultipliedAlpha)),r.vao.draw(this.renderer.gl.TRIANGLES,6,0)},r}(PIXI.extras.TilingSpriteRenderer);t.TilingSprite2dRenderer=r,PIXI.WebGLRenderer.registerPlugin("tilingSprite2d",r)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(e,i){var n=this.alphaMaskPool[this.alphaMaskIndex];n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new t.SpriteMaskFilter2d(i)]),n[0].resolution=this.renderer.resolution,n[0].maskSprite=i,e.filterArea=i.getBounds(!0),this.renderer.filterManager.pushFilter(e,n),this.alphaMaskIndex++}var i=function(){function t(t){var i=this;this.onContextChange=function(t){i.gl=t,i.renderer.maskManager.pushSpriteMask=e},this.renderer=t,t.on("context",this.onContextChange)}return t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange)},t}();t.ProjectionsManager=i,PIXI.WebGLRenderer.registerPlugin("projections",i)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec3 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n\tgl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n\tvTextureCoord = aTextureCoord;\n\tvMaskCoord = otherMatrix * vec3( aTextureCoord, 1.0);\n}\n",i="\nvarying vec3 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    vec2 uv = vMaskCoord.xy / vMaskCoord.z;\n    \n    vec2 text = abs( uv - 0.5 );\n    text = step(0.5, text);\n\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, uv);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n",n=new t.Matrix2d,o=function(o){function r(n){var r=o.call(this,e,i)||this;return r.maskMatrix=new t.Matrix2d,n.renderable=!1,r.maskSprite=n,r}return __extends(r,o),r.prototype.apply=function(t,e,i,n,o){var a=this.maskSprite;this.uniforms.mask=a.texture,this.uniforms.otherMatrix=r.calculateSpriteMatrix(o,this.maskMatrix,a),this.uniforms.alpha=a.worldAlpha,t.applyFilter(this,e,i)},r.calculateSpriteMatrix=function(t,e,i){var o=i.proj,r=t.sourceFrame,a=t.renderTarget.size,s=o&&!o._affine?o.world.copyTo(n):n.copyFrom(i.transform.worldTransform),l=i.texture.orig;return e.set(a.width,0,0,a.height,r.x,r.y),s.invert(),e.setToMult(s,e),e.scaleAndTranslate(1/l.width,1/l.height,i.anchor.x,i.anchor.y),e},r}(PIXI.Filter);t.SpriteMaskFilter2d=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){t.container3dWorldTransform=function(){return this.proj.affine?this.transform.worldTransform:this.proj.world};var e=function(e){function i(){var i=e.call(this)||this;return i.proj=new t.Projection3d(i.transform),i}return __extends(i,e),i.prototype.isFrontFace=function(t){void 0===t&&(t=!1),t&&(this._recursivePostUpdateTransform(),this.displayObjectUpdateTransform());var e=this.proj.world.mat4,i=e[0]*e[15]-e[3]*e[12],n=e[1]*e[15]-e[3]*e[13],o=e[4]*e[15]-e[7]*e[12];return i*(e[5]*e[15]-e[7]*e[13])-o*n>0},i.prototype.getDepth=function(t){void 0===t&&(t=!1),t&&(this._recursivePostUpdateTransform(),this.displayObjectUpdateTransform());var e=this.proj.world.mat4;return e[14]/e[15]},i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),i&&(e=i.toGlobal(e,n,o)),o||this._recursivePostUpdateTransform(),r===t.TRANSFORM_STEP.ALL?(o||this.displayObjectUpdateTransform(),this.proj.affine?this.transform.worldTransform.applyInverse(n,n):this.proj.world.applyInverse(n,n)):(this.parent?n=this.parent.worldTransform.applyInverse(e,n):n.copy(e),r===t.TRANSFORM_STEP.NONE?n:(n=this.transform.localTransform.applyInverse(n,n),r===t.TRANSFORM_STEP.PROJ&&this.proj.cameraMode&&(n=this.proj.cameraMatrix.applyInverse(n,n)),n))},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.Container);t.Container3d=e,t.container3dToLocal=e.prototype.toLocal,t.container3dGetDepth=e.prototype.getDepth,t.container3dIsFrontFace=e.prototype.isFrontFace}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._far=0,e._near=0,e._focus=0,e._orthographic=!1,e.proj.cameraMode=!0,e.setPlanes(400,10,1e4,!1),e}return __extends(e,t),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focus",{get:function(){return this._focus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ortographic",{get:function(){return this._orthographic},enumerable:!0,configurable:!0}),e.prototype.setPlanes=function(t,e,i,n){void 0===e&&(e=10),void 0===i&&(i=1e4),void 0===n&&(n=!1),this._focus=t,this._near=e,this._far=i,this._orthographic=n;var o=this.proj,r=o.cameraMatrix.mat4;o._projID++,r[10]=1/(i-e),r[14]=(t-e)/(i-e),this._orthographic?r[11]=0:r[11]=1/t},e}(t.Container3d);t.Camera3d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(){function t(t,e,i){this._quatUpdateId=-1,this._quatDirtyId=0,this._sign=1,this._x=t||0,this._y=e||0,this._z=i||0,this.quaternion=new Float64Array(4),this.quaternion[3]=1,this.update()}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yaw",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roll",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,i){var n=t||0,o=e||0,r=i||0;this._x===n&&this._y===o&&this._z===r||(this._x=n,this._y=o,this._z=r,this._quatDirtyId++)},t.prototype.copy=function(t){var e=t.x,i=t.y,n=t.z;this._x===e&&this._y===i&&this._z===n||(this._x=e,this._y=i,this._z=n,this._quatDirtyId++)},t.prototype.clone=function(){return new t(this._x,this._y,this._z)},t.prototype.update=function(){if(this._quatUpdateId===this._quatDirtyId)return!1;this._quatUpdateId=this._quatDirtyId;var t=Math.cos(this._x/2),e=Math.cos(this._y/2),i=Math.cos(this._z/2),n=this._sign,o=n*Math.sin(this._x/2),r=n*Math.sin(this._y/2),a=n*Math.sin(this._z/2),s=this.quaternion;return s[0]=o*e*i+t*r*a,s[1]=t*r*i-o*e*a,s[2]=t*e*a+o*r*i,s[3]=t*e*i-o*r*a,!0},t}();t.Euler=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=function(){function i(t){this.floatArray=null,this._dirtyId=0,this._updateId=-1,this._mat4inv=null,this.cacheInverse=!1,this.mat4=new Float64Array(t||e)}return Object.defineProperty(i.prototype,"a",{get:function(){return this.mat4[0]/this.mat4[15]},set:function(t){this.mat4[0]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"b",{get:function(){return this.mat4[1]/this.mat4[15]},set:function(t){this.mat4[1]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"c",{get:function(){return this.mat4[4]/this.mat4[15]},set:function(t){this.mat4[4]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"d",{get:function(){return this.mat4[5]/this.mat4[15]},set:function(t){this.mat4[5]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tx",{get:function(){return this.mat4[12]/this.mat4[15]},set:function(t){this.mat4[12]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ty",{get:function(){return this.mat4[13]/this.mat4[15]},set:function(t){this.mat4[13]=t*this.mat4[15]},enumerable:!0,configurable:!0}),i.prototype.set=function(t,e,i,n,o,r){var a=this.mat4;return a[0]=t,a[1]=e,a[2]=0,a[3]=0,a[4]=i,a[5]=n,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=o,a[13]=r,a[14]=0,a[15]=1,this},i.prototype.toArray=function(t,e){this.floatArray||(this.floatArray=new Float32Array(9));var i=e||this.floatArray,n=this.mat4;return t?(i[0]=n[0],i[1]=n[1],i[2]=n[3],i[3]=n[4],i[4]=n[5],i[5]=n[7],i[6]=n[12],i[7]=n[13],i[8]=n[15]):(i[0]=n[0],i[1]=n[4],i[2]=n[12],i[3]=n[2],i[4]=n[6],i[5]=n[13],i[6]=n[3],i[7]=n[7],i[8]=n[15]),i},i.prototype.setToTranslation=function(t,e,i){var n=this.mat4;n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t,n[13]=e,n[14]=i,n[15]=1},i.prototype.setToRotationTranslationScale=function(t,e,i,n,o,r,a){var s=this.mat4,l=t[0],c=t[1],h=t[2],p=t[3],u=l+l,d=c+c,f=h+h,m=l*u,g=l*d,y=l*f,v=c*d,b=c*f,w=h*f,x=p*u,_=p*d,S=p*f;return s[0]=(1-(v+w))*o,s[1]=(g+S)*o,s[2]=(y-_)*o,s[3]=0,s[4]=(g-S)*r,s[5]=(1-(m+w))*r,s[6]=(b+x)*r,s[7]=0,s[8]=(y+_)*a,s[9]=(b-x)*a,s[10]=(1-(m+v))*a,s[11]=0,s[12]=e,s[13]=i,s[14]=n,s[15]=1,s},i.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.mat4,n=t.x,o=t.y,r=t.z,a=1/(i[3]*n+i[7]*o+i[11]*r+i[15]);return e.x=a*(i[0]*n+i[4]*o+i[8]*r+i[12]),e.y=a*(i[1]*n+i[5]*o+i[9]*r+i[13]),e.z=a*(i[2]*n+i[6]*o+i[10]*r+i[14]),e},i.prototype.translate=function(t,e,i){var n=this.mat4;return n[12]=n[0]*t+n[4]*e+n[8]*i+n[12],n[13]=n[1]*t+n[5]*e+n[9]*i+n[13],n[14]=n[2]*t+n[6]*e+n[10]*i+n[14],n[15]=n[3]*t+n[7]*e+n[11]*i+n[15],this},i.prototype.scale=function(t,e,i){var n=this.mat4;return n[0]*=t,n[1]*=t,n[2]*=t,n[3]*=t,n[4]*=e,n[5]*=e,n[6]*=e,n[7]*=e,void 0!==i&&(n[8]*=i,n[9]*=i,n[10]*=i,n[11]*=i),this},i.prototype.scaleAndTranslate=function(t,e,i,n,o,r){var a=this.mat4;a[0]=t*a[0]+n*a[3],a[1]=e*a[1]+o*a[3],a[2]=i*a[2]+r*a[3],a[4]=t*a[4]+n*a[7],a[5]=e*a[5]+o*a[7],a[6]=i*a[6]+r*a[7],a[8]=t*a[8]+n*a[11],a[9]=e*a[9]+o*a[11],a[10]=i*a[10]+r*a[11],a[12]=t*a[12]+n*a[15],a[13]=e*a[13]+o*a[15],a[14]=i*a[14]+r*a[15]},i.prototype.applyInverse=function(e,n){n=n||new t.Point3d,this._mat4inv||(this._mat4inv=new Float64Array(16));var o=this._mat4inv,r=this.mat4,a=e.x,s=e.y,l=e.z;this.cacheInverse&&this._updateId===this._dirtyId||(this._updateId=this._dirtyId,i.glMatrixMat4Invert(o,r));var c=1/(o[3]*a+o[7]*s+o[11]*l+o[15]),h=c*(o[0]*a+o[4]*s+o[8]*l+o[12]),p=c*(o[1]*a+o[5]*s+o[9]*l+o[13]),u=c*(o[2]*a+o[6]*s+o[10]*l+o[14]);l+=1;var d=1/(o[3]*a+o[7]*s+o[11]*l+o[15]),f=d*(o[0]*a+o[4]*s+o[8]*l+o[12]),m=d*(o[1]*a+o[5]*s+o[9]*l+o[13]),g=d*(o[2]*a+o[6]*s+o[10]*l+o[14]);Math.abs(u-g)<1e-10&&n.set(NaN,NaN,0);var y=(0-u)/(g-u);return n.set((f-h)*y+h,(m-p)*y+p,0),n},i.prototype.invert=function(){return i.glMatrixMat4Invert(this.mat4,this.mat4),this},i.prototype.invertCopyTo=function(t){this._mat4inv||(this._mat4inv=new Float64Array(16));var e=this._mat4inv,n=this.mat4;this.cacheInverse&&this._updateId===this._dirtyId||(this._updateId=this._dirtyId,i.glMatrixMat4Invert(e,n)),t.mat4.set(e)},i.prototype.identity=function(){var t=this.mat4;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},i.prototype.clone=function(){return new i(this.mat4)},i.prototype.copyTo=function(t){var e=this.mat4,i=t.mat4;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],t},i.prototype.copy=function(e,i){var n=this.mat4,o=1/n[15],r=n[12]*o,a=n[13]*o;e.a=(n[0]-n[3]*r)*o,e.b=(n[1]-n[3]*a)*o,e.c=(n[4]-n[7]*r)*o,e.d=(n[5]-n[7]*a)*o,e.tx=r,e.ty=a,i>=2&&(i===t.AFFINE.POINT?(e.a=1,e.b=0,e.c=0,e.d=1):i===t.AFFINE.AXIS_X?(e.c=-e.b,e.d=e.a):i===t.AFFINE.AXIS_Y&&(e.a=e.d,e.c=-e.b))},i.prototype.copyFrom=function(t){var e=this.mat4;return e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=0,e[4]=t.c,e[5]=t.d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t.tx,e[13]=t.ty,e[14]=0,e[15]=1,this._dirtyId++,this},i.prototype.setToMultLegacy=function(t,e){var i=this.mat4,n=e.mat4,o=t.a,r=t.b,a=t.c,s=t.d,l=t.tx,c=t.ty,h=n[0],p=n[1],u=n[2],d=n[3];return i[0]=h*o+p*a+d*l,i[1]=h*r+p*s+d*c,i[2]=u,i[3]=d,h=n[4],p=n[5],u=n[6],d=n[7],i[4]=h*o+p*a+d*l,i[5]=h*r+p*s+d*c,i[6]=u,i[7]=d,h=n[8],p=n[9],u=n[10],d=n[11],i[8]=h*o+p*a+d*l,i[9]=h*r+p*s+d*c,i[10]=u,i[11]=d,h=n[12],p=n[13],u=n[14],d=n[15],i[12]=h*o+p*a+d*l,i[13]=h*r+p*s+d*c,i[14]=u,i[15]=d,this._dirtyId++,this},i.prototype.setToMultLegacy2=function(t,e){var i=this.mat4,n=t.mat4,o=n[0],r=n[1],a=n[2],s=n[3],l=n[4],c=n[5],h=n[6],p=n[7],u=e.a,d=e.b,f=e.c,m=e.d,g=e.tx,y=e.ty;return i[0]=u*o+d*l,i[1]=u*r+d*c,i[2]=u*a+d*h,i[3]=u*s+d*p,i[4]=f*o+m*l,i[5]=f*r+m*c,i[6]=f*a+m*h,i[7]=f*s+m*p,i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=g*o+y*l+n[12],i[13]=g*r+y*c+n[13],i[14]=g*a+y*h+n[14],i[15]=g*s+y*p+n[15],this._dirtyId++,this},i.prototype.setToMult=function(t,e){return i.glMatrixMat4Multiply(this.mat4,t.mat4,e.mat4),this._dirtyId++,this},i.prototype.prepend=function(t){t.mat4?this.setToMult(t,this):this.setToMultLegacy(t,this)},i.glMatrixMat4Invert=function(t,e){var i=e[0],n=e[1],o=e[2],r=e[3],a=e[4],s=e[5],l=e[6],c=e[7],h=e[8],p=e[9],u=e[10],d=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=i*s-n*a,b=i*l-o*a,w=i*c-r*a,x=n*l-o*s,_=n*c-r*s,S=o*c-r*l,T=h*m-p*f,P=h*g-u*f,C=h*y-d*f,I=p*g-u*m,k=p*y-d*m,A=u*y-d*g,M=v*A-b*k+w*I+x*C-_*P+S*T;return M?(M=1/M,t[0]=(s*A-l*k+c*I)*M,t[1]=(o*k-n*A-r*I)*M,t[2]=(m*S-g*_+y*x)*M,t[3]=(u*_-p*S-d*x)*M,t[4]=(l*C-a*A-c*P)*M,t[5]=(i*A-o*C+r*P)*M,t[6]=(g*w-f*S-y*b)*M,t[7]=(h*S-u*w+d*b)*M,t[8]=(a*k-s*C+c*T)*M,t[9]=(n*C-i*k-r*T)*M,t[10]=(f*_-m*w+y*v)*M,t[11]=(p*w-h*_-d*v)*M,t[12]=(s*P-a*I-l*T)*M,t[13]=(i*I-n*P+o*T)*M,t[14]=(m*b-f*x-g*v)*M,t[15]=(h*x-p*b+u*v)*M,t):null},i.glMatrixMat4Multiply=function(t,e,i){var n=e[0],o=e[1],r=e[2],a=e[3],s=e[4],l=e[5],c=e[6],h=e[7],p=e[8],u=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],b=i[0],w=i[1],x=i[2],_=i[3];return t[0]=b*n+w*s+x*p+_*m,t[1]=b*o+w*l+x*u+_*g,t[2]=b*r+w*c+x*d+_*y,t[3]=b*a+w*h+x*f+_*v,b=i[4],w=i[5],x=i[6],_=i[7],t[4]=b*n+w*s+x*p+_*m,t[5]=b*o+w*l+x*u+_*g,t[6]=b*r+w*c+x*d+_*y,t[7]=b*a+w*h+x*f+_*v,b=i[8],w=i[9],x=i[10],_=i[11],t[8]=b*n+w*s+x*p+_*m,t[9]=b*o+w*l+x*u+_*g,t[10]=b*r+w*c+x*d+_*y,t[11]=b*a+w*h+x*f+_*v,b=i[12],w=i[13],x=i[14],_=i[15],t[12]=b*n+w*s+x*p+_*m,t[13]=b*o+w*l+x*u+_*g,t[14]=b*r+w*c+x*d+_*y,t[15]=b*a+w*h+x*f+_*v,t},i.IDENTITY=new i,i.TEMP_MATRIX=new i,i}();t.Matrix3d=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(){function e(t,e,i,n,o){this.cb=t,this.scope=e,this._quatUpdateId=-1,this._quatDirtyId=0,this._sign=1,this._x=i||0,this._y=n||0,this._z=o||0,this.quaternion=new Float64Array(4),this.quaternion[3]=1,this.update()}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pitch",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yaw",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roll",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,i){var n=t||0,o=e||0,r=i||0;this._x===n&&this._y===o&&this._z===r||(this._x=n,this._y=o,this._z=r,this._quatDirtyId++,this.cb.call(this.scope))},e.prototype.copy=function(t){var e=t.x,i=t.y,n=t.z;this._x===e&&this._y===i&&this._z===n||(this._x=e,this._y=i,this._z=n,this._quatDirtyId++,this.cb.call(this.scope))},e.prototype.clone=function(){return new t.Euler(this._x,this._y,this._z)},e.prototype.update=function(){if(this._quatUpdateId===this._quatDirtyId)return!1;this._quatUpdateId=this._quatDirtyId;var t=Math.cos(this._x/2),e=Math.cos(this._y/2),i=Math.cos(this._z/2),n=this._sign,o=n*Math.sin(this._x/2),r=n*Math.sin(this._y/2),a=n*Math.sin(this._z/2),s=this.quaternion;return s[0]=o*e*i+t*r*a,s[1]=t*r*i-o*e*a,s[2]=t*e*a+o*r*i,s[3]=t*e*i-o*r*a,!0},e}();t.ObservableEuler=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){PIXI.Point.prototype.z=0,PIXI.Point.prototype.set=function(t,e,i){this.x=t||0,this.y=void 0===e?this.x:e||0,this.z=void 0===e?this.x:i||0},PIXI.Point.prototype.copy=function(t){this.set(t.x,t.y,t.z)},PIXI.ObservablePoint.prototype._z=0,PIXI.ObservablePoint.prototype.set=function(t,e,i){var n=t||0,o=void 0===e?n:e||0,r=void 0===e?n:i||0;this._x===n&&this._y===o&&this._z===r||(this._x=n,this._y=o,this._z=r,this.cb.call(this.scope))},Object.defineProperty(PIXI.ObservablePoint.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),PIXI.ObservablePoint.prototype.copy=function(t){this._x===t.x&&this._y===t.y&&this._z===t.z||(this._x=t.x,this._y=t.y,this._z=t.z,this.cb.call(this.scope))};var e=function(t){function e(e,i,n){var o=t.call(this,e,i)||this;return o.z=n,o}return __extends(e,t),e}(PIXI.Point);t.Point3d=e,PIXI.Point=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new t.Matrix3d,i=function(i){function n(e,n){var o=i.call(this,e,n)||this;return o.cameraMatrix=null,o._cameraMode=!1,o.position=new PIXI.ObservablePoint(o.onChange,o,0,0),o.scale=new PIXI.ObservablePoint(o.onChange,o,1,1),o.euler=new t.ObservableEuler(o.onChange,o,0,0,0),o.pivot=new PIXI.ObservablePoint(o.onChange,o,0,0),o.local=new t.Matrix3d,o.world=new t.Matrix3d,o.local.cacheInverse=!0,o.world.cacheInverse=!0,o.position._z=0,o.scale._z=1,o.pivot._z=0,o}return __extends(n,i),Object.defineProperty(n.prototype,"cameraMode",{get:function(){return this._cameraMode},set:function(e){this._cameraMode!==e&&(this._cameraMode=e,this.euler._sign=this._cameraMode?-1:1,this.euler._quatDirtyId++,e&&(this.cameraMatrix=new t.Matrix3d))},enumerable:!0,configurable:!0}),n.prototype.onChange=function(){this._projID++},n.prototype.clear=function(){this.cameraMatrix&&this.cameraMatrix.identity(),this.position.set(0,0,0),this.scale.set(1,1,1),this.euler.set(0,0,0),this.pivot.set(0,0,0),i.prototype.clear.call(this)},n.prototype.updateLocalTransform=function(t){if(0!==this._projID){var i=this.local,n=this.euler,o=this.position,r=this.scale,a=this.pivot;if(n.update(),!this.cameraMode)return i.setToRotationTranslationScale(n.quaternion,o._x,o._y,o._z,r._x,r._y,r._z),i.translate(-a._x,-a._y,-a._z),void i.setToMultLegacy(t,i);i.setToMultLegacy(t,this.cameraMatrix),i.translate(a._x,a._y,a._z),i.scale(1/r._x,1/r._y,1/r._z),e.setToRotationTranslationScale(n.quaternion,0,0,0,1,1,1),i.setToMult(i,e),i.translate(-o._x,-o._y,-o._z),this.local._dirtyId++}else this.local.copyFrom(t)},n}(t.LinearProjection);t.Projection3d=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o,r,a){var s=e.call(this,i,n,o,r,a)||this;return s.proj=new t.Projection3d(s.transform),s.pluginName="mesh2d",s}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,i,n,o,r)},i.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},i.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.mesh.Mesh);t.Mesh3d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.culledByFrustrum=!1,n.trimmedCulledByFrustrum=!1,n.proj=new t.Projection3d(n.transform),n.pluginName="sprite2d",n.vertexData=new Float32Array(12),n}return __extends(i,e),i.prototype._calculateBounds=function(){this.calculateVertices(),this.culledByFrustrum||(this.calculateTrimmedVertices(),this.trimmedCulledByFrustrum||this._bounds.addQuad(this.vertexTrimmedData))},i.prototype.calculateVertices=function(){if(this.proj._affine)return 8!=this.vertexData.length&&(this.vertexData=new Float32Array(8)),void e.prototype.calculateVertices.call(this);12!=this.vertexData.length&&(this.vertexData=new Float32Array(12));var t=this.transform._worldID,i=this._texture._updateID;if(this._transformID!==t||this._textureID!==i){this._transformID=t,this._textureID=i;var n=this._texture,o=this.proj.world.mat4,r=this.vertexData,a=n.trim,s=n.orig,l=this._anchor,c=0,h=0,p=0,u=0;a?(c=(h=a.x-l._x*s.width)+a.width,p=(u=a.y-l._y*s.height)+a.height):(c=(h=-l._x*s.width)+s.width,p=(u=-l._y*s.height)+s.height);var d,f=!1;r[0]=o[0]*h+o[4]*u+o[12],r[1]=o[1]*h+o[5]*u+o[13],d=o[2]*h+o[6]*u+o[14],r[2]=o[3]*h+o[7]*u+o[15],f=f||d<0,r[3]=o[0]*c+o[4]*u+o[12],r[4]=o[1]*c+o[5]*u+o[13],d=o[2]*c+o[6]*u+o[14],r[5]=o[3]*c+o[7]*u+o[15],f=f||d<0,r[6]=o[0]*c+o[4]*p+o[12],r[7]=o[1]*c+o[5]*p+o[13],d=o[2]*c+o[6]*p+o[14],r[8]=o[3]*c+o[7]*p+o[15],f=f||d<0,r[9]=o[0]*h+o[4]*p+o[12],r[10]=o[1]*h+o[5]*p+o[13],d=o[2]*h+o[6]*p+o[14],r[11]=o[3]*h+o[7]*p+o[15],f=f||d<0,this.culledByFrustrum=f}},i.prototype.calculateTrimmedVertices=function(){if(this.proj._affine)e.prototype.calculateTrimmedVertices.call(this);else{var t=this.transform._worldID,i=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===i)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=i;var n=this._texture,o=this.vertexTrimmedData,r=n.orig,a=this._anchor,s=this.proj.world.mat4,l=-a._x*r.width,c=l+r.width,h=-a._y*r.height,p=h+r.height,u=!1,d=1/(s[3]*l+s[7]*h+s[15]);o[0]=d*(s[0]*l+s[4]*h+s[12]),o[1]=d*(s[1]*l+s[5]*h+s[13]);var f=s[2]*l+s[6]*h+s[14];u=u||f<0,d=1/(s[3]*c+s[7]*h+s[15]),o[2]=d*(s[0]*c+s[4]*h+s[12]),o[3]=d*(s[1]*c+s[5]*h+s[13]),f=s[2]*c+s[6]*h+s[14],u=u||f<0,d=1/(s[3]*c+s[7]*p+s[15]),o[4]=d*(s[0]*c+s[4]*p+s[12]),o[5]=d*(s[1]*c+s[5]*p+s[13]),f=s[2]*c+s[6]*p+s[14],u=u||f<0,d=1/(s[3]*l+s[7]*p+s[15]),o[6]=d*(s[0]*l+s[4]*p+s[12]),o[7]=d*(s[1]*l+s[5]*p+s[13]),f=s[2]*l+s[6]*p+s[14],u=u||f<0,this.trimmedCulledByFrustrum=u}},i.prototype._renderWebGL=function(t){this.calculateVertices(),this.culledByFrustrum||(t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},i.prototype.containsPoint=function(t){return!this.culledByFrustrum&&e.prototype.containsPoint.call(this,t)},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,i,n,o,r)},i.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},i.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.Sprite);t.Sprite3d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o){var r=e.call(this,i,n,o)||this;return r.proj=new t.Projection3d(r.transform),r.pluginName="sprite2d",r.vertexData=new Float32Array(12),r}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,i,n,o,r)},i.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},i.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.Text);t.Text3d=e,e.prototype.calculateVertices=t.Sprite3d.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite3d.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite3d.prototype._calculateBounds,e.prototype.containsPoint=t.Sprite3d.prototype.containsPoint,e.prototype._renderWebGL=t.Sprite3d.prototype._renderWebGL}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(){this.proj||(this.proj=new t.Projection3d(this.transform),this.toLocal=t.Container3d.prototype.toLocal,this.isFrontFace=t.Container3d.prototype.isFrontFace,this.getDepth=t.Container3d.prototype.getDepth,Object.defineProperties(this,i))}var i={worldTransform:{get:t.container3dWorldTransform,enumerable:!0,configurable:!0},position3d:{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)}},scale3d:{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)}},pivot3d:{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)}},euler:{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)}}};PIXI.Container.prototype.convertTo3d=e,PIXI.Sprite.prototype.convertTo3d=function(){this.proj||(this.calculateVertices=t.Sprite3d.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite3d.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite3d.prototype._calculateBounds,this.containsPoint=t.Sprite3d.prototype.containsPoint,this.pluginName="sprite2d",this.vertexData=new Float32Array(12),e.call(this))},PIXI.mesh.Mesh.prototype.convertTo3d=function(){this.proj||(this.pluginName="mesh2d",e.call(this))},PIXI.Container.prototype.convertSubtreeTo3d=function(){this.convertTo3d();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo3d()}}(pixi_projection||(pixi_projection={}));var pixi_display;pixi_display||(pixi_display={}),Object.assign(PIXI.Container.prototype,{renderWebGL:function(t){this._activeParentLayer&&this._activeParentLayer!=t._activeLayer||(this.visible?(this.displayOrder=t.incDisplayOrder(),this.worldAlpha<=0||!this.renderable||this.containerRenderWebGL(t)):this.displayOrder=0)},renderCanvas:function(t){this._activeParentLayer&&this._activeParentLayer!=t._activeLayer||(this.visible?(this.displayOrder=t.incDisplayOrder(),this.worldAlpha<=0||!this.renderable||this.containerRenderCanvas(t)):this.displayOrder=0)},containerRenderWebGL:PIXI.Container.prototype.renderWebGL,containerRenderCanvas:PIXI.Container.prototype.renderCanvas}),Object.assign(PIXI.DisplayObject.prototype,{parentLayer:null,_activeParentLayer:null,parentGroup:null,zOrder:0,zIndex:0,updateOrder:0,displayOrder:0,layerableChildren:!0}),PIXI.particles&&PIXI.particles.ParticleContainer?PIXI.particles.ParticleContainer.prototype.layerableChildren=!1:PIXI.ParticleContainer&&(PIXI.ParticleContainer.prototype.layerableChildren=!1);var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pixi_display;!function(t){var e=function(t){function e(e,i){var n=t.call(this)||this;return n._activeLayer=null,n._activeStage=null,n._activeChildren=[],n._lastUpdateId=-1,n.useRenderTexture=!1,n.useDoubleBuffer=!1,n.sortPriority=0,n.clearColor=new Float32Array([0,0,0,0]),n.canDrawWithoutLayer=!1,n.canDrawInParentStage=!0,n.zIndex=0,n.enableSort=!1,n._tempResult=[],n._tempZero=[],n.useZeroOptimization=!1,n.zIndex=e,n.enableSort=!!i,"function"==typeof i&&n.on("sort",i),n}return __extends(e,t),e.prototype.doSort=function(t,i){if(this.listeners("sort",!0))for(var n=0;n<i.length;n++)this.emit("sort",i[n]);this.useZeroOptimization?this.doSortWithZeroOptimization(t,i):i.sort(e.compareZIndex)},e.compareZIndex=function(t,e){return t.zIndex!==e.zIndex?t.zIndex-e.zIndex:t.zOrder>e.zOrder?-1:t.zOrder<e.zOrder?1:t.updateOrder-e.updateOrder},e.prototype.doSortWithZeroOptimization=function(t,e){throw new Error("not implemented yet")},e.prototype.clear=function(){this._activeLayer=null,this._activeStage=null,this._activeChildren.length=0},e.prototype.addDisplayObject=function(t,e){this.check(t),e._activeParentLayer=this._activeLayer,this._activeLayer?this._activeLayer._activeChildren.push(e):this._activeChildren.push(e)},e.prototype.foundLayer=function(t,i){this.check(t),null!=this._activeLayer&&e.conflict(),this._activeLayer=i,this._activeStage=t},e.prototype.foundStage=function(t){this._activeLayer||this.canDrawInParentStage||this.clear()},e.prototype.check=function(t){if(this._lastUpdateId<e._layerUpdateId)this._lastUpdateId=e._layerUpdateId,this.clear(),this._activeStage=t;else if(this.canDrawInParentStage){for(var i=this._activeStage;i&&i!=t;)i=i._activeParentStage;if(this._activeStage=i,null==i)return void this.clear()}},e.conflict=function(){e._lastLayerConflict+5e3<Date.now()&&(e._lastLayerConflict=Date.now(),console.log("PIXI-display plugin found two layers with the same group in one stage - that's not healthy. Please place a breakpoint here and debug it"))},e._layerUpdateId=0,e._lastLayerConflict=0,e}(PIXI.utils.EventEmitter);t.Group=e}(pixi_display||(pixi_display={}));var pixi_display;!function(t){var e=PIXI.interaction.InteractionManager;Object.assign(e.prototype,{_queue:[[],[]],_displayProcessInteractive:function(t,e,i,n,o){if(!e||!e.visible)return 0;var r=0,a=n=e.interactive||n;e.hitArea&&(a=!1),e._activeParentLayer&&(o=!1);var s=e._mask;i<1/0&&s&&(s.containsPoint(t)||(o=!0)),i<1/0&&e.filterArea&&(e.filterArea.contains(t.x,t.y)||(o=!0));var l=e.children;if(e.interactiveChildren&&l)for(var c=l.length-1;c>=0;c--){var h=l[c],p=this._displayProcessInteractive(t,h,i,a,o);if(p){if(!h.parent)continue;r=p,i=p}}return n&&(o?e.interactive&&this._queueAdd(e,0):(i<e.displayOrder&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(r=e.displayOrder)):e.containsPoint&&e.containsPoint(t)&&(r=e.displayOrder)),e.interactive&&this._queueAdd(e,r===1/0?0:r))),r},processInteractive:function(t,e,i,n,o){var r=null,a=null;a=t.data&&t.data.global?(r=t).data.global:t,this._startInteractionProcess(),this._displayProcessInteractive(a,e,n?0:1/0,!1),this._finishInteractionProcess(r,i)},_startInteractionProcess:function(){this._eventDisplayOrder=1,this._queue||(this._queue=[[],[]]),this._queue[0].length=0,this._queue[1].length=0},_queueAdd:function(t,e){var i=this._queue;if(e<this._eventDisplayOrder)i[0].push(t);else{if(e>this._eventDisplayOrder){this._eventDisplayOrder=e;for(var n=i[1],o=0;o<n.length;o++)i[0].push(n[o]);i[1].length=0}i[1].push(t)}},_finishInteractionProcess:function(t,e){for(var i=this._queue,n=i[0],o=0;o<n.length;o++)t?e&&e(t,n[o],!1):e(n[o],!1);for(n=i[1],o=0;o<n.length;o++)t?(t.target||(t.target=n[o]),e&&e(t,n[o],!0)):e(n[o],!0)}})}(pixi_display||(pixi_display={}));var pixi_display;!function(t){var e=function(){function t(t){this.layer=t,this.renderTexture=null,this.doubleBuffer=null,this.currentBufferIndex=0,this._tempRenderTarget=null}return t.prototype.initRenderTexture=function(t){var e=t?t.screen.width:100,i=t?t.screen.height:100,n=t?t.resolution:PIXI.settings.RESOLUTION;this.renderTexture=PIXI.RenderTexture.create(e,i,n),this.layer.group.useDoubleBuffer&&(this.doubleBuffer=[PIXI.RenderTexture.create(e,i,n),PIXI.RenderTexture.create(e,i,n)])},t.prototype.getRenderTexture=function(){return this.renderTexture||this.initRenderTexture(),this.renderTexture},t.prototype.pushTexture=function(t){var e=t.screen;this.renderTexture||this.initRenderTexture(t);var i=this.renderTexture,n=this.layer.group,o=this.doubleBuffer;if(i.width===e.width&&i.height===e.height&&i.baseTexture.resolution===t.resolution||(i.baseTexture.resolution=t.resolution,i.resize(e.width,e.height),o&&(o[0].baseTexture.resolution=t.resolution,o[0].resize(e.width,e.height),o[1].baseTexture.resolution=t.resolution,o[1].resize(e.width,e.height))),this._tempRenderTarget=t._activeRenderTarget,t.currentRenderer.flush(),n.useDoubleBuffer){var r=o[this.currentBufferIndex];r.baseTexture._glTextures[t.CONTEXT_UID]||(t.bindRenderTexture(r,null),n.clearColor&&t.clear(n.clearColor)),t.unbindTexture(i),i.baseTexture._glTextures=r.baseTexture._glTextures,i.baseTexture._glRenderTargets=r.baseTexture._glRenderTargets,this.currentBufferIndex=1-this.currentBufferIndex,r=o[this.currentBufferIndex],t.bindRenderTexture(r,null)}else t.bindRenderTexture(i,void 0);n.clearColor&&t.clear(n.clearColor)},t.prototype.popTexture=function(t){t.currentRenderer.flush(),t.bindRenderTarget(this._tempRenderTarget),this._tempRenderTarget=null},t.prototype.destroy=function(){this.renderTexture&&(this.renderTexture.destroy(),this.doubleBuffer&&(this.doubleBuffer[0].destroy(!0),this.doubleBuffer[1].destroy(!0)))},t}();t.LayerTextureCache=e;var i=function(i){function n(e){void 0===e&&(e=null);var n=i.call(this)||this;return n.isLayer=!0,n.group=null,n._activeChildren=[],n._tempChildren=null,n._activeStageParent=null,n._sortedChildren=[],n._tempLayerParent=null,n.insertChildrenBeforeActive=!0,n.insertChildrenAfterActive=!0,null!=e?(n.group=e,n.zIndex=e.zIndex):n.group=new t.Group(0,!1),n._tempChildren=n.children,n}return __extends(n,i),n.prototype.beginWork=function(t){var e=this._activeChildren;this._activeStageParent=t,this.group.foundLayer(t,this);var i=this.group._activeChildren;e.length=0;for(var n=0;n<i.length;n++)i[n]._activeParentLayer=this,e.push(i[n]);i.length=0},n.prototype.endWork=function(){for(var t=this.children,e=this._activeChildren,i=this._sortedChildren,n=0;n<e.length;n++)this.emit("display",e[n]);if(i.length=0,this.insertChildrenBeforeActive)for(n=0;n<t.length;n++)i.push(t[n]);for(n=0;n<e.length;n++)i.push(e[n]);if(!this.insertChildrenBeforeActive&&this.insertChildrenAfterActive)for(n=0;n<t.length;n++)i.push(t[n]);this.group.enableSort&&this.doSort()},Object.defineProperty(n.prototype,"useRenderTexture",{get:function(){return this.group.useRenderTexture},set:function(t){this.group.useRenderTexture=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"useDoubleBuffer",{get:function(){return this.group.useDoubleBuffer},set:function(t){this.group.useDoubleBuffer=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clearColor",{get:function(){return this.group.clearColor},set:function(t){this.group.clearColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sortPriority",{get:function(){return this.group.sortPriority},set:function(t){this.group.sortPriority=t},enumerable:!0,configurable:!0}),n.prototype.getRenderTexture=function(){return this.textureCache||(this.textureCache=new e(this)),this.textureCache.getRenderTexture()},n.prototype.updateDisplayLayers=function(){},n.prototype.doSort=function(){this.group.doSort(this,this._sortedChildren)},n.prototype._preRender=function(t){return(!this._activeParentLayer||this._activeParentLayer==t._activeLayer)&&(this.visible?(this.displayOrder=t.incDisplayOrder(),!(this.worldAlpha<=0||!this.renderable)&&(this.children!==this._sortedChildren&&this._tempChildren!=this.children&&(this._tempChildren=this.children),this._boundsID++,this.children=this._sortedChildren,this._tempLayerParent=t._activeLayer,t._activeLayer=this,!0)):(this.displayOrder=0,!1))},n.prototype._postRender=function(t){this.children=this._tempChildren,t._activeLayer=this._tempLayerParent,this._tempLayerParent=null},n.prototype.renderWebGL=function(t){this._preRender(t)&&(this.group.useRenderTexture&&(this.textureCache||(this.textureCache=new e(this)),this.textureCache.pushTexture(t)),this.containerRenderWebGL(t),this._postRender(t),this.group.useRenderTexture&&this.textureCache.popTexture(t))},n.prototype.renderCanvas=function(t){this._preRender(t)&&(this.containerRenderCanvas(t),this._postRender(t))},n.prototype.destroy=function(t){this.textureCache&&(this.textureCache.destroy(),this.textureCache=null),i.prototype.destroy.call(this,t)},n}(PIXI.Container);t.Layer=i}(pixi_display||(pixi_display={}));var pixi_display;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.isStage=!0,t._tempGroups=[],t._activeLayers=[],t._activeParentStage=null,t}return __extends(i,e),i.prototype.clear=function(){this._activeLayers.length=0,this._tempGroups.length=0},i.prototype.destroy=function(t){this.clear(),e.prototype.destroy.call(this,t)},i.prototype._addRecursive=function(t){if(t.visible){if(t.isLayer){var e=t;this._activeLayers.push(e),e.beginWork(this)}if(t!=this&&t.isStage)t.updateAsChildStage(this);else{var n=t.parentGroup;null!==n&&n.addDisplayObject(this,t);var o=t.parentLayer;if(null!==o&&(n=o.group).addDisplayObject(this,t),t.updateOrder=++i._updateOrderCounter,!(t.alpha<=0||!t.renderable||!t.layerableChildren||n&&n.sortPriority)){var r=t.children;if(r&&r.length)for(var a=0;a<r.length;a++)this._addRecursive(r[a])}}}},i.prototype._addRecursiveChildren=function(t){if(!(t.alpha<=0)&&t.renderable&&t.layerableChildren){var e=t.children;if(e&&e.length)for(var i=0;i<e.length;i++)this._addRecursive(e[i])}},i.prototype._updateStageInner=function(){this.clear(),this._addRecursive(this);for(var t=this._activeLayers,e=0;e<t.length;e++)if((o=t[e]).group.sortPriority){o.endWork();for(var i=o._sortedChildren,n=0;n<i.length;n++)this._addRecursiveChildren(i[n])}for(e=0;e<t.length;e++){var o=t[e];o.group.sortPriority||o.endWork()}},i.prototype.updateAsChildStage=function(t){this._activeParentStage=t,i._updateOrderCounter=0,this._updateStageInner()},i.prototype.updateStage=function(){this._activeParentStage=null,t.Group._layerUpdateId++,this._updateStageInner()},i._updateOrderCounter=0,i}(t.Layer);t.Stage=e}(pixi_display||(pixi_display={}));var pixi_display;pixi_display||(pixi_display={}),Object.assign(PIXI.WebGLRenderer.prototype,{_lastDisplayOrder:0,_activeLayer:null,incDisplayOrder:function(){return++this._lastDisplayOrder},_oldRender:PIXI.WebGLRenderer.prototype.render,render:function(t,e,i,n,o){e||(this._lastDisplayOrder=0),this._activeLayer=null,t.isStage&&t.updateStage(),this._oldRender(t,e,i,n,o)}}),Object.assign(PIXI.CanvasRenderer.prototype,{_lastDisplayOrder:0,_activeLayer:null,incDisplayOrder:function(){return++this._lastDisplayOrder},_oldRender:PIXI.CanvasRenderer.prototype.render,render:function(t,e,i,n,o){e||(this._lastDisplayOrder=0),this._activeLayer=null,t.isStage&&t.updateStage(),this._oldRender(t,e,i,n,o)}});var pixi_display;!function(t){PIXI.display=t}(pixi_display||(pixi_display={}));var MinAjax=function(){function t(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}return{minAjax:function(e){if(e.url)if(e.type){e.method||(e.method=!0),e.debugLog||(e.debugLog=!1);var i=t();i.onreadystatechange=function(){4==i.readyState&&200==i.status?(e.success&&e.success(i.responseText,i.readyState),1==e.debugLog&&console.log("SuccessResponse"),1==e.debugLog&&console.log("Response Data:"+i.responseText)):1==e.debugLog&&console.log("FailureResponse --\x3e State:"+i.readyState+"Status:"+i.status)};var n=[],o=e.data;if("string"==typeof o)for(var r=String.prototype.split.call(o,"&"),a=0,s=r.length;a<s;a++){c=r[a].split("=");n.push(encodeURIComponent(c[0])+"="+encodeURIComponent(c[1]))}else if("object"==typeof o&&!(o instanceof String||FormData&&o instanceof FormData))for(var l in o){var c=o[l];if("[object Array]"==Object.prototype.toString.call(c))for(var a=0,s=c.length;a<s;a++)n.push(encodeURIComponent(l)+"[]="+encodeURIComponent(c[a]));else n.push(encodeURIComponent(l)+"="+encodeURIComponent(c))}n=n.join("&"),"GET"==e.type&&(i.open("GET",e.url+"?"+n,e.method),i.send(),1==e.debugLog&&console.log("GET fired at:"+e.url+"?"+n)),"POST"==e.type&&(i.open("POST",e.url,e.method),i.setRequestHeader(e.requestType,e.requestValue),i.send(n),1==e.debugLog&&console.log("POST fired at:"+e.url+" || Data:"+n))}else 1==e.debugLog&&console.log("No Default type (GET/POST) given!");else 1==e.debugLog&&console.log("No Url!")}}};!function(t){if("object"==typeof exports)module.exports=t();else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.p2=t()}}(function(){return function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return o(i||t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){function n(){}var o=t("./Scalar");e.exports=n,n.lineInt=function(t,e,i){i=i||0;var n,r,a,s,l,c,h,p=[0,0];return n=t[1][1]-t[0][1],r=t[0][0]-t[1][0],a=n*t[0][0]+r*t[0][1],s=e[1][1]-e[0][1],l=e[0][0]-e[1][0],c=s*e[0][0]+l*e[0][1],h=n*l-s*r,o.eq(h,0,i)||(p[0]=(l*a-r*c)/h,p[1]=(n*c-s*a)/h),p},n.segmentsIntersect=function(t,e,i,n){var o=e[0]-t[0],r=e[1]-t[1],a=n[0]-i[0],s=n[1]-i[1];if(a*r-s*o==0)return!1;var l=(o*(i[1]-t[1])+r*(t[0]-i[0]))/(a*r-s*o),c=(a*(t[1]-i[1])+s*(i[0]-t[0]))/(s*o-a*r);return l>=0&&l<=1&&c>=0&&c<=1}},{"./Scalar":4}],2:[function(t,e,i){function n(){}e.exports=n,n.area=function(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])},n.left=function(t,e,i){return n.area(t,e,i)>0},n.leftOn=function(t,e,i){return n.area(t,e,i)>=0},n.right=function(t,e,i){return n.area(t,e,i)<0},n.rightOn=function(t,e,i){return n.area(t,e,i)<=0};var o=[],r=[];n.collinear=function(t,e,i,a){if(a){var s=o,l=r;s[0]=e[0]-t[0],s[1]=e[1]-t[1],l[0]=i[0]-e[0],l[1]=i[1]-e[1];var c=s[0]*l[0]+s[1]*l[1],h=Math.sqrt(s[0]*s[0]+s[1]*s[1]),p=Math.sqrt(l[0]*l[0]+l[1]*l[1]);return Math.acos(c/(h*p))<a}return 0==n.area(t,e,i)},n.sqdist=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n}},{}],3:[function(t,e,i){function n(){this.vertices=[]}function o(t,e,i,n,o){o=o||0;var r=e[1]-t[1],a=t[0]-e[0],l=r*t[0]+a*t[1],c=n[1]-i[1],h=i[0]-n[0],p=c*i[0]+h*i[1],u=r*h-c*a;return s.eq(u,0,o)?[0,0]:[(h*l-a*p)/u,(r*p-c*l)/u]}var r=t("./Line"),a=t("./Point"),s=t("./Scalar");e.exports=n,n.prototype.at=function(t){var e=this.vertices,i=e.length;return e[t<0?t%i+i:t%i]},n.prototype.first=function(){return this.vertices[0]},n.prototype.last=function(){return this.vertices[this.vertices.length-1]},n.prototype.clear=function(){this.vertices.length=0},n.prototype.append=function(t,e,i){if(void 0===e)throw new Error("From is not given!");if(void 0===i)throw new Error("To is not given!");if(i-1<e)throw new Error("lol1");if(i>t.vertices.length)throw new Error("lol2");if(e<0)throw new Error("lol3");for(var n=e;n<i;n++)this.vertices.push(t.vertices[n])},n.prototype.makeCCW=function(){for(var t=0,e=this.vertices,i=1;i<this.vertices.length;++i)(e[i][1]<e[t][1]||e[i][1]==e[t][1]&&e[i][0]>e[t][0])&&(t=i);a.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},n.prototype.reverse=function(){for(var t=[],e=0,i=this.vertices.length;e!==i;e++)t.push(this.vertices.pop());this.vertices=t},n.prototype.isReflex=function(t){return a.right(this.at(t-1),this.at(t),this.at(t+1))};var l=[],c=[];n.prototype.canSee=function(t,e){var i,n,o=l,s=c;if(a.leftOn(this.at(t+1),this.at(t),this.at(e))&&a.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;n=a.sqdist(this.at(t),this.at(e));for(var h=0;h!==this.vertices.length;++h)if((h+1)%this.vertices.length!==t&&h!==t&&a.leftOn(this.at(t),this.at(e),this.at(h+1))&&a.rightOn(this.at(t),this.at(e),this.at(h))&&(o[0]=this.at(t),o[1]=this.at(e),s[0]=this.at(h),s[1]=this.at(h+1),i=r.lineInt(o,s),a.sqdist(this.at(t),i)<n))return!1;return!0},n.prototype.copy=function(t,e,i){var o=i||new n;if(o.clear(),t<e)for(r=t;r<=e;r++)o.vertices.push(this.vertices[r]);else{for(r=0;r<=e;r++)o.vertices.push(this.vertices[r]);for(var r=t;r<this.vertices.length;r++)o.vertices.push(this.vertices[r])}return o},n.prototype.getCutEdges=function(){for(var t=[],e=[],i=[],o=new n,r=Number.MAX_VALUE,a=0;a<this.vertices.length;++a)if(this.isReflex(a))for(var s=0;s<this.vertices.length;++s)if(this.canSee(a,s)){e=this.copy(a,s,o).getCutEdges(),i=this.copy(s,a,o).getCutEdges();for(var l=0;l<i.length;l++)e.push(i[l]);e.length<r&&(t=e,r=e.length,t.push([this.at(a),this.at(s)]))}return t},n.prototype.decomp=function(){var t=this.getCutEdges();return t.length>0?this.slice(t):[this]},n.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],i=0;i<t.length;i++)for(var n=t[i],o=0;o<e.length;o++){var r=e[o].slice(n);if(r){e.splice(o,1),e.push(r[0],r[1]);break}}return e}var n=t,i=this.vertices.indexOf(n[0]),o=this.vertices.indexOf(n[1]);return-1!=i&&-1!=o&&[this.copy(i,o),this.copy(o,i)]},n.prototype.isSimple=function(){for(var t=this.vertices,e=0;e<t.length-1;e++)for(var i=0;i<e-1;i++)if(r.segmentsIntersect(t[e],t[e+1],t[i],t[i+1]))return!1;for(e=1;e<t.length-2;e++)if(r.segmentsIntersect(t[0],t[t.length-1],t[e],t[e+1]))return!1;return!0},n.prototype.quickDecomp=function(t,e,i,r,s,l){s=s||100,l=l||0,r=r||25,t=void 0!==t?t:[],e=e||[],i=i||[];var c=[0,0],h=[0,0],p=[0,0],u=0,d=0,f=0,m=0,g=0,y=0,v=0,b=new n,w=new n,x=this,_=this.vertices;if(_.length<3)return t;if(++l>s)return console.warn("quickDecomp: max level ("+s+") reached."),t;for(var S=0;S<this.vertices.length;++S)if(x.isReflex(S)){e.push(x.vertices[S]),u=d=Number.MAX_VALUE;for(T=0;T<this.vertices.length;++T)a.left(x.at(S-1),x.at(S),x.at(T))&&a.rightOn(x.at(S-1),x.at(S),x.at(T-1))&&(p=o(x.at(S-1),x.at(S),x.at(T),x.at(T-1)),a.right(x.at(S+1),x.at(S),p)&&(f=a.sqdist(x.vertices[S],p))<d&&(d=f,h=p,y=T)),a.left(x.at(S+1),x.at(S),x.at(T+1))&&a.rightOn(x.at(S+1),x.at(S),x.at(T))&&(p=o(x.at(S+1),x.at(S),x.at(T),x.at(T+1)),a.left(x.at(S-1),x.at(S),p)&&(f=a.sqdist(x.vertices[S],p))<u&&(u=f,c=p,g=T));if(y==(g+1)%this.vertices.length)p[0]=(h[0]+c[0])/2,p[1]=(h[1]+c[1])/2,i.push(p),S<g?(b.append(x,S,g+1),b.vertices.push(p),w.vertices.push(p),0!=y&&w.append(x,y,x.vertices.length),w.append(x,0,S+1)):(0!=S&&b.append(x,S,x.vertices.length),b.append(x,0,g+1),b.vertices.push(p),w.vertices.push(p),w.append(x,y,S+1));else{if(y>g&&(g+=this.vertices.length),m=Number.MAX_VALUE,g<y)return t;for(var T=y;T<=g;++T)a.leftOn(x.at(S-1),x.at(S),x.at(T))&&a.rightOn(x.at(S+1),x.at(S),x.at(T))&&(f=a.sqdist(x.at(S),x.at(T)))<m&&(m=f,v=T%this.vertices.length);S<v?(b.append(x,S,v+1),0!=v&&w.append(x,v,_.length),w.append(x,0,S+1)):(0!=S&&b.append(x,S,_.length),b.append(x,0,v+1),w.append(x,v,S+1))}return b.vertices.length<w.vertices.length?(b.quickDecomp(t,e,i,r,s,l),w.quickDecomp(t,e,i,r,s,l)):(w.quickDecomp(t,e,i,r,s,l),b.quickDecomp(t,e,i,r,s,l)),t}return t.push(this),t},n.prototype.removeCollinearPoints=function(t){for(var e=0,i=this.vertices.length-1;this.vertices.length>3&&i>=0;--i)a.collinear(this.at(i-1),this.at(i),this.at(i+1),t)&&(this.vertices.splice(i%this.vertices.length,1),i--,e++);return e}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(t,e,i){function n(){}e.exports=n,n.eq=function(t,e,i){return i=i||0,Math.abs(t-e)<i}},{}],5:[function(t,e,i){e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(t,e,i){e.exports={name:"p2",version:"0.7.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],7:[function(t,e,i){function n(t){this.lowerBound=o.create(),t&&t.lowerBound&&o.copy(this.lowerBound,t.lowerBound),this.upperBound=o.create(),t&&t.upperBound&&o.copy(this.upperBound,t.upperBound)}var o=t("../math/vec2");t("../utils/Utils");e.exports=n;var r=o.create();n.prototype.setFromPoints=function(t,e,i,n){var a=this.lowerBound,s=this.upperBound;"number"!=typeof i&&(i=0),0!==i?o.rotate(a,t[0],i):o.copy(a,t[0]),o.copy(s,a);for(var l=Math.cos(i),c=Math.sin(i),h=1;h<t.length;h++){var p=t[h];if(0!==i){var u=p[0],d=p[1];r[0]=l*u-c*d,r[1]=c*u+l*d,p=r}for(var f=0;f<2;f++)p[f]>s[f]&&(s[f]=p[f]),p[f]<a[f]&&(a[f]=p[f])}e&&(o.add(this.lowerBound,this.lowerBound,e),o.add(this.upperBound,this.upperBound,e)),n&&(this.lowerBound[0]-=n,this.lowerBound[1]-=n,this.upperBound[0]+=n,this.upperBound[1]+=n)},n.prototype.copy=function(t){o.copy(this.lowerBound,t.lowerBound),o.copy(this.upperBound,t.upperBound)},n.prototype.extend=function(t){for(var e=2;e--;){var i=t.lowerBound[e];this.lowerBound[e]>i&&(this.lowerBound[e]=i);var n=t.upperBound[e];this.upperBound[e]<n&&(this.upperBound[e]=n)}},n.prototype.overlaps=function(t){var e=this.lowerBound,i=this.upperBound,n=t.lowerBound,o=t.upperBound;return(n[0]<=i[0]&&i[0]<=o[0]||e[0]<=o[0]&&o[0]<=i[0])&&(n[1]<=i[1]&&i[1]<=o[1]||e[1]<=o[1]&&o[1]<=i[1])},n.prototype.containsPoint=function(t){var e=this.lowerBound,i=this.upperBound;return e[0]<=t[0]&&t[0]<=i[0]&&e[1]<=t[1]&&t[1]<=i[1]},n.prototype.overlapsRay=function(t){var e=1/t.direction[0],i=1/t.direction[1],n=(this.lowerBound[0]-t.from[0])*e,o=(this.upperBound[0]-t.from[0])*e,r=(this.lowerBound[1]-t.from[1])*i,a=(this.upperBound[1]-t.from[1])*i,s=Math.max(Math.max(Math.min(n,o),Math.min(r,a))),l=Math.min(Math.min(Math.max(n,o),Math.max(r,a)));return l<0?-1:s>l?-1:s}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(t,e,i){function n(t){this.type=t,this.result=[],this.world=null,this.boundingVolumeType=n.AABB}var o=t("../math/vec2"),r=t("../objects/Body");e.exports=n,n.AABB=1,n.BOUNDING_CIRCLE=2,n.prototype.setWorld=function(t){this.world=t},n.prototype.getCollisionPairs=function(t){};var a=o.create();n.boundingRadiusCheck=function(t,e){o.sub(a,t.position,e.position);var i=o.squaredLength(a),n=t.boundingRadius+e.boundingRadius;return i<=n*n},n.aabbCheck=function(t,e){return t.getAABB().overlaps(e.getAABB())},n.prototype.boundingVolumeCheck=function(t,e){var i;switch(this.boundingVolumeType){case n.BOUNDING_CIRCLE:i=n.boundingRadiusCheck(t,e);break;case n.AABB:i=n.aabbCheck(t,e);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return i},n.canCollide=function(t,e){var i=r.KINEMATIC,n=r.STATIC;return(t.type!==n||e.type!==n)&&(!(t.type===i&&e.type===n||t.type===n&&e.type===i)&&((t.type!==i||e.type!==i)&&((t.sleepState!==r.SLEEPING||e.sleepState!==r.SLEEPING)&&!(t.sleepState===r.SLEEPING&&e.type===n||e.sleepState===r.SLEEPING&&t.type===n))))},n.NAIVE=1,n.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(t,e,i){function n(){o.call(this,o.NAIVE)}t("../shapes/Circle"),t("../shapes/Plane"),t("../shapes/Shape"),t("../shapes/Particle");var o=t("../collision/Broadphase");t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.getCollisionPairs=function(t){var e=t.bodies,i=this.result;i.length=0;for(var n=0,r=e.length;n!==r;n++)for(var a=e[n],s=0;s<n;s++){var l=e[s];o.canCollide(a,l)&&this.boundingVolumeCheck(a,l)&&i.push(a,l)}return i},n.prototype.aabbQuery=function(t,e,i){i=i||[];for(var n=t.bodies,o=0;o<n.length;o++){var r=n[o];r.aabbNeedsUpdate&&r.updateAABB(),r.aabb.overlaps(e)&&i.push(r)}return i}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(t,e,i){function n(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new h({size:32}),this.frictionEquationPool=new p({size:64}),this.restitution=0,this.stiffness=d.DEFAULT_STIFFNESS,this.relaxation=d.DEFAULT_RELAXATION,this.frictionStiffness=d.DEFAULT_STIFFNESS,this.frictionRelaxation=d.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new u,this.contactSkinSize=.01}function o(t,e){a.set(t.vertices[0],.5*-e.length,-e.radius),a.set(t.vertices[1],.5*e.length,-e.radius),a.set(t.vertices[2],.5*e.length,e.radius),a.set(t.vertices[3],.5*-e.length,e.radius)}function r(t,e,i,n){for(var o=q,r=z,c=W,h=Y,p=t,u=e.vertices,d=null,f=0;f!==u.length+1;f++){var m=u[f%u.length],g=u[(f+1)%u.length];a.rotate(o,m,n),a.rotate(r,g,n),l(o,o,i),l(r,r,i),s(c,o,p),s(h,r,p);var y=a.crossLength(c,h);if(null===d&&(d=y),y*d<0)return!1;d=y}return!0}var a=t("../math/vec2"),s=a.sub,l=a.add,c=a.dot,h=(t("../utils/Utils"),t("../utils/ContactEquationPool")),p=t("../utils/FrictionEquationPool"),u=t("../utils/TupleDictionary"),d=t("../equations/Equation"),f=(t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("../shapes/Circle")),m=t("../shapes/Convex"),g=t("../shapes/Shape"),y=(t("../objects/Body"),t("../shapes/Box"));e.exports=n;var v=a.fromValues(0,1),b=a.fromValues(0,0),w=a.fromValues(0,0),x=a.fromValues(0,0),_=a.fromValues(0,0),S=a.fromValues(0,0),T=a.fromValues(0,0),P=a.fromValues(0,0),C=a.fromValues(0,0),I=a.fromValues(0,0),k=a.fromValues(0,0),A=a.fromValues(0,0),M=a.fromValues(0,0),O=a.fromValues(0,0),R=a.fromValues(0,0),B=a.fromValues(0,0),G=a.fromValues(0,0),E=a.fromValues(0,0),D=a.fromValues(0,0),L=[],j=a.create(),F=a.create();n.prototype.bodiesOverlap=function(t,e){for(var i=j,n=F,o=0,r=t.shapes.length;o!==r;o++){var a=t.shapes[o];t.toWorldFrame(i,a.position);for(var s=0,l=e.shapes.length;s!==l;s++){var c=e.shapes[s];if(e.toWorldFrame(n,c.position),this[a.type|c.type](t,a,i,a.angle+t.angle,e,c,n,c.angle+e.angle,!0))return!0}}return!1},n.prototype.collidedLastStep=function(t,e){var i=0|t.id,n=0|e.id;return!!this.collidingBodiesLastStep.get(i,n)},n.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,e=t.length;e--;){var i=t[e],n=i.bodyA.id,o=i.bodyB.id;this.collidingBodiesLastStep.set(n,o,!0)}for(var r=this.contactEquations,a=this.frictionEquations,s=0;s<r.length;s++)this.contactEquationPool.release(r[s]);for(s=0;s<a.length;s++)this.frictionEquationPool.release(a[s]);this.contactEquations.length=this.frictionEquations.length=0},n.prototype.createContactEquation=function(t,e,i,n){var o=this.contactEquationPool.get();return o.bodyA=t,o.bodyB=e,o.shapeA=i,o.shapeB=n,o.restitution=this.restitution,o.firstImpact=!this.collidedLastStep(t,e),o.stiffness=this.stiffness,o.relaxation=this.relaxation,o.needsUpdate=!0,o.enabled=this.enabledEquations,o.offset=this.contactSkinSize,o},n.prototype.createFrictionEquation=function(t,e,i,n){var o=this.frictionEquationPool.get();return o.bodyA=t,o.bodyB=e,o.shapeA=i,o.shapeB=n,o.setSlipForce(this.slipForce),o.frictionCoefficient=this.frictionCoefficient,o.relativeVelocity=this.surfaceVelocity,o.enabled=this.enabledEquations,o.needsUpdate=!0,o.stiffness=this.frictionStiffness,o.relaxation=this.frictionRelaxation,o.contactEquations.length=0,o},n.prototype.createFrictionFromContact=function(t){var e=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);return a.copy(e.contactPointA,t.contactPointA),a.copy(e.contactPointB,t.contactPointB),a.rotate90cw(e.t,t.normalA),e.contactEquations.push(t),e},n.prototype.createFrictionFromAverage=function(t){var e=this.contactEquations[this.contactEquations.length-1],i=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB),n=e.bodyA;e.bodyB;a.set(i.contactPointA,0,0),a.set(i.contactPointB,0,0),a.set(i.t,0,0);for(var o=0;o!==t;o++)(e=this.contactEquations[this.contactEquations.length-1-o]).bodyA===n?(a.add(i.t,i.t,e.normalA),a.add(i.contactPointA,i.contactPointA,e.contactPointA),a.add(i.contactPointB,i.contactPointB,e.contactPointB)):(a.sub(i.t,i.t,e.normalA),a.add(i.contactPointA,i.contactPointA,e.contactPointB),a.add(i.contactPointB,i.contactPointB,e.contactPointA)),i.contactEquations.push(e);var r=1/t;return a.scale(i.contactPointA,i.contactPointA,r),a.scale(i.contactPointB,i.contactPointB,r),a.normalize(i.t,i.t),a.rotate90cw(i.t,i.t),i},n.prototype[g.LINE|g.CONVEX]=n.prototype.convexLine=function(t,e,i,n,o,r,a,s,l){return!l&&0},n.prototype[g.LINE|g.BOX]=n.prototype.lineBox=function(t,e,i,n,o,r,a,s,l){return!l&&0};var N=new y({width:1,height:1}),X=a.create();n.prototype[g.CAPSULE|g.CONVEX]=n.prototype[g.CAPSULE|g.BOX]=n.prototype.convexCapsule=function(t,e,i,n,r,s,l,c,h){var p=X;a.set(p,s.length/2,0),a.rotate(p,p,c),a.add(p,p,l);var u=this.circleConvex(r,s,p,c,t,e,i,n,h,s.radius);a.set(p,-s.length/2,0),a.rotate(p,p,c),a.add(p,p,l);var d=this.circleConvex(r,s,p,c,t,e,i,n,h,s.radius);if(h&&(u||d))return!0;var f=N;return o(f,s),this.convexConvex(t,e,i,n,r,f,l,c,h)+u+d},n.prototype[g.CAPSULE|g.LINE]=n.prototype.lineCapsule=function(t,e,i,n,o,r,a,s,l){return!l&&0};var U=a.create(),V=a.create(),H=new y({width:1,height:1});n.prototype[g.CAPSULE|g.CAPSULE]=n.prototype.capsuleCapsule=function(t,e,i,n,r,s,l,c,h){for(var p=U,u=V,d=0,f=0;f<2;f++){a.set(p,(0===f?-1:1)*e.length/2,0),a.rotate(p,p,n),a.add(p,p,i);for(var m=0;m<2;m++){a.set(u,(0===m?-1:1)*s.length/2,0),a.rotate(u,u,c),a.add(u,u,l),this.enableFrictionReduction&&(b=this.enableFriction,this.enableFriction=!1);var g=this.circleCircle(t,e,p,n,r,s,u,c,h,e.radius,s.radius);if(this.enableFrictionReduction&&(this.enableFriction=b),h&&g)return!0;d+=g}}this.enableFrictionReduction&&(b=this.enableFriction,this.enableFriction=!1);var y=H;o(y,e);var v=this.convexCapsule(t,y,i,n,r,s,l,c,h);if(this.enableFrictionReduction&&(this.enableFriction=b),h&&v)return!0;if(d+=v,this.enableFrictionReduction){var b=this.enableFriction;this.enableFriction=!1}o(y,s);var w=this.convexCapsule(r,y,l,c,t,e,i,n,h);return this.enableFrictionReduction&&(this.enableFriction=b),!(!h||!w)||(d+=w,this.enableFrictionReduction&&d&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(d)),d)},n.prototype[g.LINE|g.LINE]=n.prototype.lineLine=function(t,e,i,n,o,r,a,s,l){return!l&&0},n.prototype[g.PLANE|g.LINE]=n.prototype.planeLine=function(t,e,i,n,o,r,h,p,u){var d=b,f=w,m=x,g=_,y=S,k=T,A=P,M=C,O=I,R=L,B=0;a.set(d,-r.length/2,0),a.set(f,r.length/2,0),a.rotate(m,d,p),a.rotate(g,f,p),l(m,m,h),l(g,g,h),a.copy(d,m),a.copy(f,g),s(y,f,d),a.normalize(k,y),a.rotate90cw(O,k),a.rotate(M,v,n),R[0]=d,R[1]=f;for(var G=0;G<R.length;G++){var E=R[G];s(A,E,i);var D=c(A,M);if(D<0){if(u)return!0;var j=this.createContactEquation(t,o,e,r);B++,a.copy(j.normalA,M),a.normalize(j.normalA,j.normalA),a.scale(A,M,D),s(j.contactPointA,E,A),s(j.contactPointA,j.contactPointA,t.position),s(j.contactPointB,E,h),l(j.contactPointB,j.contactPointB,h),s(j.contactPointB,j.contactPointB,o.position),this.contactEquations.push(j),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(j))}}return!u&&(this.enableFrictionReduction||B&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(B)),B)},n.prototype[g.PARTICLE|g.CAPSULE]=n.prototype.particleCapsule=function(t,e,i,n,o,r,a,s,l){return this.circleLine(t,e,i,n,o,r,a,s,l,r.radius,0)},n.prototype[g.CIRCLE|g.LINE]=n.prototype.circleLine=function(t,e,i,n,o,r,h,p,u,d,f){var d=d||0,f=void 0!==f?f:e.radius,m=b,g=w,y=x,v=_,B=S,G=T,E=P,D=C,j=I,F=k,N=A,X=M,U=O,V=R,H=L;a.set(D,-r.length/2,0),a.set(j,r.length/2,0),a.rotate(F,D,p),a.rotate(N,j,p),l(F,F,h),l(N,N,h),a.copy(D,F),a.copy(j,N),s(G,j,D),a.normalize(E,G),a.rotate90cw(B,E),s(X,i,D);var q=c(X,B);s(v,D,h),s(U,i,h);var z=f+d;if(Math.abs(q)<z){a.scale(m,B,q),s(y,i,m),a.scale(g,B,c(B,U)),a.normalize(g,g),a.scale(g,g,d),l(y,y,g);var W=c(E,y),Y=c(E,D),K=c(E,j);if(W>Y&&W<K){if(u)return!0;J=this.createContactEquation(t,o,e,r);return a.scale(J.normalA,m,-1),a.normalize(J.normalA,J.normalA),a.scale(J.contactPointA,J.normalA,f),l(J.contactPointA,J.contactPointA,i),s(J.contactPointA,J.contactPointA,t.position),s(J.contactPointB,y,h),l(J.contactPointB,J.contactPointB,h),s(J.contactPointB,J.contactPointB,o.position),this.contactEquations.push(J),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(J)),1}}H[0]=D,H[1]=j;for(var Q=0;Q<H.length;Q++){var Z=H[Q];if(s(X,Z,i),a.squaredLength(X)<Math.pow(z,2)){if(u)return!0;var J=this.createContactEquation(t,o,e,r);return a.copy(J.normalA,X),a.normalize(J.normalA,J.normalA),a.scale(J.contactPointA,J.normalA,f),l(J.contactPointA,J.contactPointA,i),s(J.contactPointA,J.contactPointA,t.position),s(J.contactPointB,Z,h),a.scale(V,J.normalA,-d),l(J.contactPointB,J.contactPointB,V),l(J.contactPointB,J.contactPointB,h),s(J.contactPointB,J.contactPointB,o.position),this.contactEquations.push(J),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(J)),1}}return 0},n.prototype[g.CIRCLE|g.CAPSULE]=n.prototype.circleCapsule=function(t,e,i,n,o,r,a,s,l){return this.circleLine(t,e,i,n,o,r,a,s,l,r.radius)},n.prototype[g.CIRCLE|g.CONVEX]=n.prototype[g.CIRCLE|g.BOX]=n.prototype.circleConvex=function(t,e,i,n,o,c,h,p,u,d){for(var d="number"==typeof d?d:e.radius,f=b,m=w,g=x,y=_,v=S,T=k,P=A,C=O,I=R,M=B,E=G,D=!1,L=Number.MAX_VALUE,j=c.vertices,F=0;F!==j.length+1;F++){var N=j[F%j.length],X=j[(F+1)%j.length];if(a.rotate(f,N,p),a.rotate(m,X,p),l(f,f,h),l(m,m,h),s(g,m,f),a.normalize(y,g),a.rotate90cw(v,y),a.scale(I,v,-e.radius),l(I,I,i),r(I,c,h,p)){a.sub(M,f,I);var U=Math.abs(a.dot(M,v));U<L&&(a.copy(E,I),L=U,a.scale(C,v,U),a.add(C,C,I),D=!0)}}if(D){if(u)return!0;H=this.createContactEquation(t,o,e,c);return a.sub(H.normalA,E,i),a.normalize(H.normalA,H.normalA),a.scale(H.contactPointA,H.normalA,d),l(H.contactPointA,H.contactPointA,i),s(H.contactPointA,H.contactPointA,t.position),s(H.contactPointB,C,h),l(H.contactPointB,H.contactPointB,h),s(H.contactPointB,H.contactPointB,o.position),this.contactEquations.push(H),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(H)),1}if(d>0)for(F=0;F<j.length;F++){var V=j[F];if(a.rotate(P,V,p),l(P,P,h),s(T,P,i),a.squaredLength(T)<Math.pow(d,2)){if(u)return!0;var H=this.createContactEquation(t,o,e,c);return a.copy(H.normalA,T),a.normalize(H.normalA,H.normalA),a.scale(H.contactPointA,H.normalA,d),l(H.contactPointA,H.contactPointA,i),s(H.contactPointA,H.contactPointA,t.position),s(H.contactPointB,P,h),l(H.contactPointB,H.contactPointB,h),s(H.contactPointB,H.contactPointB,o.position),this.contactEquations.push(H),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(H)),1}}return 0};var q=a.create(),z=a.create(),W=a.create(),Y=a.create();n.prototype[g.PARTICLE|g.CONVEX]=n.prototype[g.PARTICLE|g.BOX]=n.prototype.particleConvex=function(t,e,i,n,o,h,p,u,d){var f=b,m=w,g=x,y=_,v=S,C=T,I=P,A=k,M=O,R=E,B=D,G=Number.MAX_VALUE,L=!1,j=h.vertices;if(!r(i,h,p,u))return!d&&0;if(d)return!0;for(var F=0;F!==j.length+1;F++){var N=j[F%j.length],X=j[(F+1)%j.length];a.rotate(f,N,u),a.rotate(m,X,u),l(f,f,p),l(m,m,p),s(g,m,f),a.normalize(y,g),a.rotate90cw(v,y),s(A,i,f);c(A,v);s(C,f,p),s(I,i,p),a.sub(R,f,i);var U=Math.abs(a.dot(R,v));U<G&&(G=U,a.scale(M,v,U),a.add(M,M,i),a.copy(B,v),L=!0)}if(L){var V=this.createContactEquation(t,o,e,h);return a.scale(V.normalA,B,-1),a.normalize(V.normalA,V.normalA),a.set(V.contactPointA,0,0),l(V.contactPointA,V.contactPointA,i),s(V.contactPointA,V.contactPointA,t.position),s(V.contactPointB,M,p),l(V.contactPointB,V.contactPointB,p),s(V.contactPointB,V.contactPointB,o.position),this.contactEquations.push(V),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(V)),1}return 0},n.prototype[g.CIRCLE]=n.prototype.circleCircle=function(t,e,i,n,o,r,c,h,p,u,d){var f=b,u=u||e.radius,d=d||r.radius;s(f,i,c);var m=u+d;if(a.squaredLength(f)>Math.pow(m,2))return 0;if(p)return!0;var g=this.createContactEquation(t,o,e,r);return s(g.normalA,c,i),a.normalize(g.normalA,g.normalA),a.scale(g.contactPointA,g.normalA,u),a.scale(g.contactPointB,g.normalA,-d),l(g.contactPointA,g.contactPointA,i),s(g.contactPointA,g.contactPointA,t.position),l(g.contactPointB,g.contactPointB,c),s(g.contactPointB,g.contactPointB,o.position),this.contactEquations.push(g),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(g)),1},n.prototype[g.PLANE|g.CONVEX]=n.prototype[g.PLANE|g.BOX]=n.prototype.planeConvex=function(t,e,i,n,o,r,h,p,u){var d=b,f=w,m=x,g=0;a.rotate(f,v,n);for(var y=0;y!==r.vertices.length;y++){var _=r.vertices[y];if(a.rotate(d,_,p),l(d,d,h),s(m,d,i),c(m,f)<=0){if(u)return!0;g++;var S=this.createContactEquation(t,o,e,r);s(m,d,i),a.copy(S.normalA,f);var T=c(m,S.normalA);a.scale(m,S.normalA,T),s(S.contactPointB,d,o.position),s(S.contactPointA,d,m),s(S.contactPointA,S.contactPointA,t.position),this.contactEquations.push(S),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(S))}}return this.enableFrictionReduction&&this.enableFriction&&g&&this.frictionEquations.push(this.createFrictionFromAverage(g)),g},n.prototype[g.PARTICLE|g.PLANE]=n.prototype.particlePlane=function(t,e,i,n,o,r,l,h,p){var u=b,d=w;h=h||0,s(u,i,l),a.rotate(d,v,h);var f=c(u,d);if(f>0)return 0;if(p)return!0;var m=this.createContactEquation(o,t,r,e);return a.copy(m.normalA,d),a.scale(u,m.normalA,f),s(m.contactPointA,i,u),s(m.contactPointA,m.contactPointA,o.position),s(m.contactPointB,i,t.position),this.contactEquations.push(m),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(m)),1},n.prototype[g.CIRCLE|g.PARTICLE]=n.prototype.circleParticle=function(t,e,i,n,o,r,c,h,p){var u=b;if(s(u,c,i),a.squaredLength(u)>Math.pow(e.radius,2))return 0;if(p)return!0;var d=this.createContactEquation(t,o,e,r);return a.copy(d.normalA,u),a.normalize(d.normalA,d.normalA),a.scale(d.contactPointA,d.normalA,e.radius),l(d.contactPointA,d.contactPointA,i),s(d.contactPointA,d.contactPointA,t.position),s(d.contactPointB,c,o.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1};var K=new f({radius:1}),Q=a.create(),Z=a.create();a.create();n.prototype[g.PLANE|g.CAPSULE]=n.prototype.planeCapsule=function(t,e,i,n,o,r,s,c,h){var p=Q,u=Z,d=K;a.set(p,-r.length/2,0),a.rotate(p,p,c),l(p,p,s),a.set(u,r.length/2,0),a.rotate(u,u,c),l(u,u,s),d.radius=r.radius;var f;this.enableFrictionReduction&&(f=this.enableFriction,this.enableFriction=!1);var m=this.circlePlane(o,d,p,0,t,e,i,n,h),g=this.circlePlane(o,d,u,0,t,e,i,n,h);if(this.enableFrictionReduction&&(this.enableFriction=f),h)return m||g;var y=m+g;return this.enableFrictionReduction&&y&&this.frictionEquations.push(this.createFrictionFromAverage(y)),y},n.prototype[g.CIRCLE|g.PLANE]=n.prototype.circlePlane=function(t,e,i,n,o,r,h,p,u){var d=t,f=e,m=i,g=o,y=h,_=p;_=_||0;var S=b,T=w,P=x;s(S,m,y),a.rotate(T,v,_);var C=c(T,S);if(C>f.radius)return 0;if(u)return!0;var I=this.createContactEquation(g,d,r,e);return a.copy(I.normalA,T),a.scale(I.contactPointB,I.normalA,-f.radius),l(I.contactPointB,I.contactPointB,m),s(I.contactPointB,I.contactPointB,d.position),a.scale(P,I.normalA,C),s(I.contactPointA,S,P),l(I.contactPointA,I.contactPointA,y),s(I.contactPointA,I.contactPointA,g.position),this.contactEquations.push(I),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(I)),1},n.prototype[g.CONVEX]=n.prototype[g.CONVEX|g.BOX]=n.prototype[g.BOX]=n.prototype.convexConvex=function(t,e,i,o,r,h,p,u,d,f){var m=b,g=w,y=x,v=_,T=S,k=P,A=C,M=I,O=0,f="number"==typeof f?f:0;if(!n.findSeparatingAxis(e,i,o,h,p,u,m))return 0;s(A,p,i),c(m,A)>0&&a.scale(m,m,-1);var R=n.getClosestEdge(e,o,m,!0),B=n.getClosestEdge(h,u,m);if(-1===R||-1===B)return 0;for(var G=0;G<2;G++){var E=R,D=B,L=e,j=h,F=i,N=p,X=o,U=u,V=t,H=r;if(0===G){var q;q=E,E=D,D=q,q=L,L=j,j=q,q=F,F=N,N=q,q=X,X=U,U=q,q=V,V=H,H=q}for(var z=D;z<D+2;z++){var W=j.vertices[(z+j.vertices.length)%j.vertices.length];a.rotate(g,W,U),l(g,g,N);for(var Y=0,K=E-1;K<E+2;K++){var Q=L.vertices[(K+L.vertices.length)%L.vertices.length],Z=L.vertices[(K+1+L.vertices.length)%L.vertices.length];a.rotate(y,Q,X),a.rotate(v,Z,X),l(y,y,F),l(v,v,F),s(T,v,y),a.rotate90cw(M,T),a.normalize(M,M),s(A,g,y);$=c(M,A);(K===E&&$<=f||K!==E&&$<=0)&&Y++}if(Y>=3){if(d)return!0;var J=this.createContactEquation(V,H,L,j);O++;var Q=L.vertices[E%L.vertices.length],Z=L.vertices[(E+1)%L.vertices.length];a.rotate(y,Q,X),a.rotate(v,Z,X),l(y,y,F),l(v,v,F),s(T,v,y),a.rotate90cw(J.normalA,T),a.normalize(J.normalA,J.normalA),s(A,g,y);var $=c(J.normalA,A);a.scale(k,J.normalA,$),s(J.contactPointA,g,F),s(J.contactPointA,J.contactPointA,k),l(J.contactPointA,J.contactPointA,F),s(J.contactPointA,J.contactPointA,V.position),s(J.contactPointB,g,N),l(J.contactPointB,J.contactPointB,N),s(J.contactPointB,J.contactPointB,H.position),this.contactEquations.push(J),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(J))}}}return this.enableFrictionReduction&&this.enableFriction&&O&&this.frictionEquations.push(this.createFrictionFromAverage(O)),O};var J=a.fromValues(0,0);n.projectConvexOntoAxis=function(t,e,i,n,o){var r,s,l=null,h=null,p=J;a.rotate(p,n,-i);for(var u=0;u<t.vertices.length;u++)r=t.vertices[u],s=c(r,p),(null===l||s>l)&&(l=s),(null===h||s<h)&&(h=s);if(h>l){var d=h;h=l,l=d}var f=c(e,n);a.set(o,h+f,l+f)};var $=a.fromValues(0,0),tt=a.fromValues(0,0),et=a.fromValues(0,0),it=a.fromValues(0,0),nt=a.fromValues(0,0),ot=a.fromValues(0,0);n.findSeparatingAxis=function(t,e,i,o,r,l,c){var h=null,p=!1,u=!1,d=$,f=tt,m=et,g=it,v=nt,b=ot;if(t instanceof y&&o instanceof y)for(T=0;2!==T;T++){var w=t,x=i;1===T&&(w=o,x=l);for(P=0;2!==P;P++){0===P?a.set(g,0,1):1===P&&a.set(g,1,0),0!==x&&a.rotate(g,g,x),n.projectConvexOntoAxis(t,e,i,g,v),n.projectConvexOntoAxis(o,r,l,g,b);var _=v,S=b;v[0]>b[0]&&(S=v,_=b,!0),p=(C=S[0]-_[1])<=0,(null===h||C>h)&&(a.copy(c,g),h=C,u=p)}}else for(var T=0;2!==T;T++){var w=t,x=i;1===T&&(w=o,x=l);for(var P=0;P!==w.vertices.length;P++){a.rotate(f,w.vertices[P],x),a.rotate(m,w.vertices[(P+1)%w.vertices.length],x),s(d,m,f),a.rotate90cw(g,d),a.normalize(g,g),n.projectConvexOntoAxis(t,e,i,g,v),n.projectConvexOntoAxis(o,r,l,g,b);var _=v,S=b;v[0]>b[0]&&(S=v,_=b,!0);var C=S[0]-_[1];p=C<=0,(null===h||C>h)&&(a.copy(c,g),h=C,u=p)}}return u};var rt=a.fromValues(0,0),at=a.fromValues(0,0),st=a.fromValues(0,0);n.getClosestEdge=function(t,e,i,n){var o=rt,r=at,l=st;a.rotate(o,i,-e),n&&a.scale(o,o,-1);for(var h=-1,p=t.vertices.length,u=-1,d=0;d!==p;d++){s(r,t.vertices[(d+1)%p],t.vertices[d%p]),a.rotate90cw(l,r),a.normalize(l,l);var f=c(l,o);(-1===h||f>u)&&(h=d%p,u=f)}return h};var lt=a.create(),ct=a.create(),ht=a.create(),pt=a.create(),ut=a.create(),dt=a.create(),ft=a.create();n.prototype[g.CIRCLE|g.HEIGHTFIELD]=n.prototype.circleHeightfield=function(t,e,i,n,o,r,c,h,p,u){var d=r.heights,u=u||e.radius,f=r.elementWidth,m=ct,g=lt,y=ut,v=ft,b=dt,w=ht,x=pt,_=Math.floor((i[0]-u-c[0])/f),S=Math.ceil((i[0]+u-c[0])/f);_<0&&(_=0),S>=d.length&&(S=d.length-1);for(var T=d[_],P=d[S],C=_;C<S;C++)d[C]<P&&(P=d[C]),d[C]>T&&(T=d[C]);if(i[1]-u>T)return!p&&0;for(var I=!1,C=_;C<S;C++){a.set(w,C*f,d[C]),a.set(x,(C+1)*f,d[C+1]),a.add(w,w,c),a.add(x,x,c),a.sub(b,x,w),a.rotate(b,b,Math.PI/2),a.normalize(b,b),a.scale(g,b,-u),a.add(g,g,i),a.sub(m,g,w);var k=a.dot(m,b);if(g[0]>=w[0]&&g[0]<x[0]&&k<=0){if(p)return!0;I=!0,a.scale(m,b,-k),a.add(y,g,m),a.copy(v,b);A=this.createContactEquation(o,t,r,e);a.copy(A.normalA,v),a.scale(A.contactPointB,A.normalA,-u),l(A.contactPointB,A.contactPointB,i),s(A.contactPointB,A.contactPointB,t.position),a.copy(A.contactPointA,y),a.sub(A.contactPointA,A.contactPointA,o.position),this.contactEquations.push(A),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A))}}if(I=!1,u>0)for(C=_;C<=S;C++)if(a.set(w,C*f,d[C]),a.add(w,w,c),a.sub(m,i,w),a.squaredLength(m)<Math.pow(u,2)){if(p)return!0;I=!0;var A=this.createContactEquation(o,t,r,e);a.copy(A.normalA,m),a.normalize(A.normalA,A.normalA),a.scale(A.contactPointB,A.normalA,-u),l(A.contactPointB,A.contactPointB,i),s(A.contactPointB,A.contactPointB,t.position),s(A.contactPointA,w,c),l(A.contactPointA,A.contactPointA,c),s(A.contactPointA,A.contactPointA,o.position),this.contactEquations.push(A),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A))}return I?1:0};var mt=a.create(),gt=a.create(),yt=a.create(),vt=new m({vertices:[a.create(),a.create(),a.create(),a.create()]});n.prototype[g.BOX|g.HEIGHTFIELD]=n.prototype[g.CONVEX|g.HEIGHTFIELD]=n.prototype.convexHeightfield=function(t,e,i,n,o,r,s,l,c){var h=r.heights,p=r.elementWidth,u=mt,d=gt,f=yt,m=vt,g=Math.floor((t.aabb.lowerBound[0]-s[0])/p),y=Math.ceil((t.aabb.upperBound[0]-s[0])/p);g<0&&(g=0),y>=h.length&&(y=h.length-1);for(var v=h[g],b=h[y],w=g;w<y;w++)h[w]<b&&(b=h[w]),h[w]>v&&(v=h[w]);if(t.aabb.lowerBound[1]>v)return!c&&0;for(var x=0,w=g;w<y;w++){a.set(u,w*p,h[w]),a.set(d,(w+1)*p,h[w+1]),a.add(u,u,s),a.add(d,d,s);a.set(f,.5*(d[0]+u[0]),.5*(d[1]+u[1]-100)),a.sub(m.vertices[0],d,f),a.sub(m.vertices[1],u,f),a.copy(m.vertices[2],m.vertices[1]),a.copy(m.vertices[3],m.vertices[0]),m.vertices[2][1]-=100,m.vertices[3][1]-=100,x+=this.convexConvex(t,e,i,n,o,m,f,0,c)}return x}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(t,e,i){function n(t){t=t||{},this.from=t.from?r.fromValues(t.from[0],t.from[1]):r.create(),this.to=t.to?r.fromValues(t.to[0],t.to[1]):r.create(),this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,this.skipBackfaces=!!t.skipBackfaces,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:-1,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:-1,this.mode=void 0!==t.mode?t.mode:n.ANY,this.callback=t.callback||function(t){},this.direction=r.create(),this.length=1,this.update()}function o(t,e,i){r.sub(s,i,t);var n=r.dot(s,e);return r.scale(l,e,n),r.add(l,l,t),r.squaredDistance(i,l)}e.exports=n;var r=t("../math/vec2");t("../collision/RaycastResult"),t("../shapes/Shape"),t("../collision/AABB");n.prototype.constructor=n,n.CLOSEST=1,n.ANY=2,n.ALL=4,n.prototype.update=function(){var t=this.direction;r.sub(t,this.to,this.from),this.length=r.length(t),r.normalize(t,t)},n.prototype.intersectBodies=function(t,e){for(var i=0,n=e.length;!t.shouldStop(this)&&i<n;i++){var o=e[i],r=o.getAABB();(r.overlapsRay(this)>=0||r.containsPoint(this.from))&&this.intersectBody(t,o)}};var a=r.create();n.prototype.intersectBody=function(t,e){var i=this.checkCollisionResponse;if(!i||e.collisionResponse)for(var n=a,o=0,s=e.shapes.length;o<s;o++){var l=e.shapes[o];if((!i||l.collisionResponse)&&(0!=(this.collisionGroup&l.collisionMask)&&0!=(l.collisionGroup&this.collisionMask))){r.rotate(n,l.position,e.angle),r.add(n,n,e.position);var c=l.angle+e.angle;if(this.intersectShape(t,l,c,n,e),t.shouldStop(this))break}}},n.prototype.intersectShape=function(t,e,i,n,r){o(this.from,this.direction,n)>e.boundingRadius*e.boundingRadius||(this._currentBody=r,this._currentShape=e,e.raycast(t,this,n,i),this._currentBody=this._currentShape=null)},n.prototype.getAABB=function(t){var e=this.to,i=this.from;r.set(t.lowerBound,Math.min(e[0],i[0]),Math.min(e[1],i[1])),r.set(t.upperBound,Math.max(e[0],i[0]),Math.max(e[1],i[1]))};r.create();n.prototype.reportIntersection=function(t,e,i,o){this.from,this.to;var a=this._currentShape,s=this._currentBody;if(!(this.skipBackfaces&&r.dot(i,this.direction)>0))switch(this.mode){case n.ALL:t.set(i,a,s,e,o),this.callback(t);break;case n.CLOSEST:(e<t.fraction||!t.hasHit())&&t.set(i,a,s,e,o);break;case n.ANY:t.set(i,a,s,e,o)}};var s=r.create(),l=r.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(t,e,i){function n(){this.normal=o.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}var o=t("../math/vec2"),r=t("../collision/Ray");e.exports=n,n.prototype.reset=function(){o.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},n.prototype.getHitDistance=function(t){return o.distance(t.from,t.to)*this.fraction},n.prototype.hasHit=function(){return-1!==this.fraction},n.prototype.getHitPoint=function(t,e){o.lerp(t,e.from,e.to,this.fraction)},n.prototype.stop=function(){this.isStopped=!0},n.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===r.ANY},n.prototype.set=function(t,e,i,n,r){o.copy(this.normal,t),this.shape=e,this.body=i,this.fraction=n,this.faceIndex=r}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(t,e,i){function n(){r.call(this,r.SAP),this.axisList=[],this.axisIndex=0;var t=this;this._addBodyHandler=function(e){t.axisList.push(e.body)},this._removeBodyHandler=function(e){var i=t.axisList.indexOf(e.body);-1!==i&&t.axisList.splice(i,1)}}var o=t("../utils/Utils"),r=t("../collision/Broadphase");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.setWorld=function(t){this.axisList.length=0,o.appendArray(this.axisList,t.bodies),t.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),t.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=t},n.sortAxisList=function(t,e){e|=0;for(var i=1,n=t.length;i<n;i++){for(var o=t[i],r=i-1;r>=0&&!(t[r].aabb.lowerBound[e]<=o.aabb.lowerBound[e]);r--)t[r+1]=t[r];t[r+1]=o}return t},n.prototype.sortList=function(){var t=this.axisList,e=this.axisIndex;n.sortAxisList(t,e)},n.prototype.getCollisionPairs=function(t){var e=this.axisList,i=this.result,n=this.axisIndex;i.length=0;for(var o=e.length;o--;){var a=e[o];a.aabbNeedsUpdate&&a.updateAABB()}this.sortList();for(var s=0,l=0|e.length;s!==l;s++)for(var c=e[s],h=s+1;h<l;h++){var p=e[h];if(!(p.aabb.lowerBound[n]<=c.aabb.upperBound[n]))break;r.canCollide(c,p)&&this.boundingVolumeCheck(c,p)&&i.push(c,p)}return i},n.prototype.aabbQuery=function(t,e,i){i=i||[],this.sortList();var n=this.axisIndex,o="x";1===n&&(o="y"),2===n&&(o="z");for(var r=this.axisList,a=(e.lowerBound[o],e.upperBound[o],0);a<r.length;a++){var s=r[a];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(e)&&i.push(s)}return i}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(t,e,i){function n(t,e,i,n){this.type=i,n=o.defaults(n,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.collideConnected=n.collideConnected,n.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}e.exports=n;var o=t("../utils/Utils");n.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},n.DISTANCE=1,n.GEAR=2,n.LOCK=3,n.PRISMATIC=4,n.REVOLUTE=5,n.prototype.setStiffness=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.stiffness=t,n.needsUpdate=!0}},n.prototype.setRelaxation=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.relaxation=t,n.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(t,e,i){function n(t,e,i){i=s.defaults(i,{localAnchorA:[0,0],localAnchorB:[0,0]}),o.call(this,t,e,o.DISTANCE,i),this.localAnchorA=a.fromValues(i.localAnchorA[0],i.localAnchorA[1]),this.localAnchorB=a.fromValues(i.localAnchorB[0],i.localAnchorB[1]);var n=this.localAnchorA,l=this.localAnchorB;if(this.distance=0,"number"==typeof i.distance)this.distance=i.distance;else{var c=a.create(),h=a.create(),p=a.create();a.rotate(c,n,t.angle),a.rotate(h,l,e.angle),a.add(p,e.position,h),a.sub(p,p,c),a.sub(p,p,t.position),this.distance=a.length(p)}var u;u=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce;var d=new r(t,e,-u,u);this.equations=[d],this.maxForce=u;var p=a.create(),f=a.create(),m=a.create(),g=this;d.computeGq=function(){var t=this.bodyA,e=this.bodyB,i=t.position,o=e.position;return a.rotate(f,n,t.angle),a.rotate(m,l,e.angle),a.add(p,o,m),a.sub(p,p,f),a.sub(p,p,i),a.length(p)-g.distance},this.setMaxForce(u),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}var o=t("./Constraint"),r=t("../equations/Equation"),a=t("../math/vec2"),s=t("../utils/Utils");e.exports=n,(n.prototype=new o).constructor=n;var l=a.create(),c=a.create(),h=a.create();n.prototype.update=function(){var t=this.equations[0],e=this.bodyA,i=this.bodyB,n=(this.distance,e.position),o=i.position,r=this.equations[0],s=t.G;a.rotate(c,this.localAnchorA,e.angle),a.rotate(h,this.localAnchorB,i.angle),a.add(l,o,h),a.sub(l,l,c),a.sub(l,l,n),this.position=a.length(l);var p=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(r.maxForce=0,r.minForce=-this.maxForce,this.distance=this.upperLimit,p=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(r.maxForce=this.maxForce,r.minForce=0,this.distance=this.lowerLimit,p=!0),!this.lowerLimitEnabled&&!this.upperLimitEnabled||p){r.enabled=!0,a.normalize(l,l);var u=a.crossLength(c,l),d=a.crossLength(h,l);s[0]=-l[0],s[1]=-l[1],s[2]=-u,s[3]=l[0],s[4]=l[1],s[5]=d}else r.enabled=!1},n.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(t,e,i){function n(t,e,i){i=i||{},o.call(this,t,e,o.GEAR,i),this.ratio=void 0!==i.ratio?i.ratio:1,this.angle=void 0!==i.angle?i.angle:e.angle-this.ratio*t.angle,i.angle=this.angle,i.ratio=this.ratio,this.equations=[new r(t,e,i)],void 0!==i.maxTorque&&this.setMaxTorque(i.maxTorque)}var o=t("./Constraint"),r=(t("../equations/Equation"),t("../equations/AngleLockEquation"));t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},n.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},n.prototype.getMaxTorque=function(t){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(t,e,i){function n(t,e,i){i=i||{},o.call(this,t,e,o.LOCK,i);var n=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,s=(i.localAngleB,new a(t,e,-n,n)),l=new a(t,e,-n,n),c=new a(t,e,-n,n),h=r.create(),p=r.create(),u=this;s.computeGq=function(){return r.rotate(h,u.localOffsetB,t.angle),r.sub(p,e.position,t.position),r.sub(p,p,h),p[0]},l.computeGq=function(){return r.rotate(h,u.localOffsetB,t.angle),r.sub(p,e.position,t.position),r.sub(p,p,h),p[1]};var d=r.create(),f=r.create();c.computeGq=function(){return r.rotate(d,u.localOffsetB,e.angle-u.localAngleB),r.scale(d,d,-1),r.sub(p,t.position,e.position),r.add(p,p,d),r.rotate(f,d,-Math.PI/2),r.normalize(f,f),r.dot(p,f)},this.localOffsetB=r.create(),i.localOffsetB?r.copy(this.localOffsetB,i.localOffsetB):(r.sub(this.localOffsetB,e.position,t.position),r.rotate(this.localOffsetB,this.localOffsetB,-t.angle)),this.localAngleB=0,"number"==typeof i.localAngleB?this.localAngleB=i.localAngleB:this.localAngleB=e.angle-t.angle,this.equations.push(s,l,c),this.setMaxForce(n)}var o=t("./Constraint"),r=t("../math/vec2"),a=t("../equations/Equation");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.setMaxForce=function(t){for(var e=this.equations,i=0;i<this.equations.length;i++)e[i].maxForce=t,e[i].minForce=-t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce};var s=r.create(),l=r.create(),c=r.create(),h=r.fromValues(1,0),p=r.fromValues(0,1);n.prototype.update=function(){var t=this.equations[0],e=this.equations[1],i=this.equations[2],n=this.bodyA,o=this.bodyB;r.rotate(s,this.localOffsetB,n.angle),r.rotate(l,this.localOffsetB,o.angle-this.localAngleB),r.scale(l,l,-1),r.rotate(c,l,Math.PI/2),r.normalize(c,c),t.G[0]=-1,t.G[1]=0,t.G[2]=-r.crossLength(s,h),t.G[3]=1,e.G[0]=0,e.G[1]=-1,e.G[2]=-r.crossLength(s,p),e.G[4]=1,i.G[0]=-c[0],i.G[1]=-c[1],i.G[3]=c[0],i.G[4]=c[1],i.G[5]=r.crossLength(l,c)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(t,e,i){function n(t,e,i){i=i||{},o.call(this,t,e,o.PRISMATIC,i);var n=s.fromValues(0,0),c=s.fromValues(1,0),h=s.fromValues(0,0);i.localAnchorA&&s.copy(n,i.localAnchorA),i.localAxisA&&s.copy(c,i.localAxisA),i.localAnchorB&&s.copy(h,i.localAnchorB),this.localAnchorA=n,this.localAnchorB=h,this.localAxisA=c;var p=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE,u=new a(t,e,-p,p),d=new s.create,f=new s.create,m=new s.create,g=new s.create;if(u.computeGq=function(){return s.dot(m,g)},u.updateJacobian=function(){var i=this.G,o=t.position,r=e.position;s.rotate(d,n,t.angle),s.rotate(f,h,e.angle),s.add(m,r,f),s.sub(m,m,o),s.sub(m,m,d),s.rotate(g,c,t.angle+Math.PI/2),i[0]=-g[0],i[1]=-g[1],i[2]=-s.crossLength(d,g)+s.crossLength(g,m),i[3]=g[0],i[4]=g[1],i[5]=s.crossLength(f,g)},this.equations.push(u),!i.disableRotationalLock){var y=new l(t,e,-p,p);this.equations.push(y)}this.position=0,this.velocity=0,this.lowerLimitEnabled=void 0!==i.lowerLimit,this.upperLimitEnabled=void 0!==i.upperLimit,this.lowerLimit=void 0!==i.lowerLimit?i.lowerLimit:0,this.upperLimit=void 0!==i.upperLimit?i.upperLimit:1,this.upperLimitEquation=new r(t,e),this.lowerLimitEquation=new r(t,e),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=p,this.motorEquation=new a(t,e),this.motorEnabled=!1,this.motorSpeed=0;var v=this,b=this.motorEquation;b.computeGW;b.computeGq=function(){return 0},b.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,o=i.velocity,r=e.angularVelocity,a=i.angularVelocity;return this.gmult(t,n,r,o,a)+v.motorSpeed}}var o=t("./Constraint"),r=t("../equations/ContactEquation"),a=t("../equations/Equation"),s=t("../math/vec2"),l=t("../equations/RotationalLockEquation");e.exports=n,(n.prototype=new o).constructor=n;var c=s.create(),h=s.create(),p=s.create(),u=s.create(),d=s.create(),f=s.create();n.prototype.update=function(){var t=this.equations,e=t[0],i=this.upperLimit,n=this.lowerLimit,o=this.upperLimitEquation,r=this.lowerLimitEquation,a=this.bodyA,l=this.bodyB,m=this.localAxisA,g=this.localAnchorA,y=this.localAnchorB;e.updateJacobian(),s.rotate(c,m,a.angle),s.rotate(u,g,a.angle),s.add(h,u,a.position),s.rotate(d,y,l.angle),s.add(p,d,l.position);var v=this.position=s.dot(p,c)-s.dot(h,c);if(this.motorEnabled){var b=this.motorEquation.G;b[0]=c[0],b[1]=c[1],b[2]=s.crossLength(c,d),b[3]=-c[0],b[4]=-c[1],b[5]=-s.crossLength(c,u)}if(this.upperLimitEnabled&&v>i?(s.scale(o.normalA,c,-1),s.sub(o.contactPointA,h,a.position),s.sub(o.contactPointB,p,l.position),s.scale(f,c,i),s.add(o.contactPointA,o.contactPointA,f),-1===t.indexOf(o)&&t.push(o)):-1!==(w=t.indexOf(o))&&t.splice(w,1),this.lowerLimitEnabled&&v<n)s.scale(r.normalA,c,1),s.sub(r.contactPointA,h,a.position),s.sub(r.contactPointB,p,l.position),s.scale(f,c,n),s.sub(r.contactPointB,r.contactPointB,f),-1===t.indexOf(r)&&t.push(r);else{var w=t.indexOf(r);-1!==w&&t.splice(w,1)}},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},n.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(t,e,i){function n(t,e,i){i=i||{},o.call(this,t,e,o.REVOLUTE,i);var n=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE;this.pivotA=l.create(),this.pivotB=l.create(),i.worldPivot?(l.sub(this.pivotA,i.worldPivot,t.position),l.sub(this.pivotB,i.worldPivot,e.position),l.rotate(this.pivotA,this.pivotA,-t.angle),l.rotate(this.pivotB,this.pivotB,-e.angle)):(l.copy(this.pivotA,i.localPivotA),l.copy(this.pivotB,i.localPivotB));var f=this.equations=[new r(t,e,-n,n),new r(t,e,-n,n)],m=f[0],g=f[1],y=this;m.computeGq=function(){return l.rotate(c,y.pivotA,t.angle),l.rotate(h,y.pivotB,e.angle),l.add(d,e.position,h),l.sub(d,d,t.position),l.sub(d,d,c),l.dot(d,p)},g.computeGq=function(){return l.rotate(c,y.pivotA,t.angle),l.rotate(h,y.pivotB,e.angle),l.add(d,e.position,h),l.sub(d,d,t.position),l.sub(d,d,c),l.dot(d,u)},g.minForce=m.minForce=-n,g.maxForce=m.maxForce=n,this.motorEquation=new a(t,e),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new s(t,e),this.lowerLimitEquation=new s(t,e),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}var o=t("./Constraint"),r=t("../equations/Equation"),a=t("../equations/RotationalVelocityEquation"),s=t("../equations/RotationalLockEquation"),l=t("../math/vec2");e.exports=n;var c=l.create(),h=l.create(),p=l.fromValues(1,0),u=l.fromValues(0,1),d=l.create();(n.prototype=new o).constructor=n,n.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)},n.prototype.update=function(){var t=this.bodyA,e=this.bodyB,i=this.pivotA,n=this.pivotB,o=this.equations,r=(o[0],o[1],o[0]),a=o[1],s=this.upperLimit,d=this.lowerLimit,f=this.upperLimitEquation,m=this.lowerLimitEquation,g=this.angle=e.angle-t.angle;if(this.upperLimitEnabled&&g>s?(f.angle=s,-1===o.indexOf(f)&&o.push(f)):-1!==(y=o.indexOf(f))&&o.splice(y,1),this.lowerLimitEnabled&&g<d)m.angle=d,-1===o.indexOf(m)&&o.push(m);else{var y=o.indexOf(m);-1!==y&&o.splice(y,1)}l.rotate(c,i,t.angle),l.rotate(h,n,e.angle),r.G[0]=-1,r.G[1]=0,r.G[2]=-l.crossLength(c,p),r.G[3]=1,r.G[4]=0,r.G[5]=l.crossLength(h,p),a.G[0]=0,a.G[1]=-1,a.G[2]=-l.crossLength(c,u),a.G[3]=0,a.G[4]=1,a.G[5]=l.crossLength(h,u)},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},n.prototype.motorIsEnabled=function(){return!!this.motorEnabled},n.prototype.setMotorSpeed=function(t){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations[e].relativeVelocity=t}},n.prototype.getMotorSpeed=function(){return!!this.motorEnabled&&this.motorEquation.relativeVelocity}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(t,e,i){function n(t,e,i){i=i||{},o.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0,this.ratio="number"==typeof i.ratio?i.ratio:1,this.setRatio(this.ratio)}var o=t("./Equation");t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},n.prototype.setRatio=function(t){var e=this.G;e[2]=t,e[5]=-1,this.ratio=t},n.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t}},{"../math/vec2":30,"./Equation":22}],21:[function(t,e,i){function n(t,e){o.call(this,t,e,0,Number.MAX_VALUE),this.contactPointA=r.create(),this.penetrationVec=r.create(),this.contactPointB=r.create(),this.normalA=r.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}var o=t("./Equation"),r=t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeB=function(t,e,i){var n=this.bodyA,o=this.bodyB,a=this.contactPointA,s=this.contactPointB,l=n.position,c=o.position,h=this.penetrationVec,p=this.normalA,u=this.G,d=r.crossLength(a,p),f=r.crossLength(s,p);u[0]=-p[0],u[1]=-p[1],u[2]=-d,u[3]=p[0],u[4]=p[1],u[5]=f,r.add(h,c,s),r.sub(h,h,l),r.sub(h,h,a);var m,g;return this.firstImpact&&0!==this.restitution?(g=0,m=1/e*(1+this.restitution)*this.computeGW()):(g=r.dot(p,h)+this.offset,m=this.computeGW()),-g*t-m*e-i*this.computeGiMf()}},{"../math/vec2":30,"./Equation":22}],22:[function(t,e,i){function n(t,e,i,o){this.minForce=void 0===i?-Number.MAX_VALUE:i,this.maxForce=void 0===o?Number.MAX_VALUE:o,this.bodyA=t,this.bodyB=e,this.stiffness=n.DEFAULT_STIFFNESS,this.relaxation=n.DEFAULT_RELAXATION,this.G=new r.ARRAY_TYPE(6);for(var a=0;a<6;a++)this.G[a]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}e.exports=n;var o=t("../math/vec2"),r=t("../utils/Utils");t("../objects/Body");n.prototype.constructor=n,n.DEFAULT_STIFFNESS=1e6,n.DEFAULT_RELAXATION=4,n.prototype.update=function(){var t=this.stiffness,e=this.relaxation,i=this.timeStep;this.a=4/(i*(1+4*e)),this.b=4*e/(1+4*e),this.epsilon=4/(i*i*t*(1+4*e)),this.needsUpdate=!1},n.prototype.gmult=function(t,e,i,n,o){return t[0]*e[0]+t[1]*e[1]+t[2]*i+t[3]*n[0]+t[4]*n[1]+t[5]*o},n.prototype.computeB=function(t,e,i){var n=this.computeGW();return-this.computeGq()*t-n*e-this.computeGiMf()*i};var a=o.create(),s=o.create();n.prototype.computeGq=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=(e.position,i.position,e.angle),o=i.angle;return this.gmult(t,a,n,s,o)+this.offset},n.prototype.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,o=i.velocity,r=e.angularVelocity,a=i.angularVelocity;return this.gmult(t,n,r,o,a)+this.relativeVelocity},n.prototype.computeGWlambda=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.vlambda,o=i.vlambda,r=e.wlambda,a=i.wlambda;return this.gmult(t,n,r,o,a)};var l=o.create(),c=o.create();n.prototype.computeGiMf=function(){var t=this.bodyA,e=this.bodyB,i=t.force,n=t.angularForce,r=e.force,a=e.angularForce,s=t.invMassSolve,h=e.invMassSolve,p=t.invInertiaSolve,u=e.invInertiaSolve,d=this.G;return o.scale(l,i,s),o.multiply(l,t.massMultiplier,l),o.scale(c,r,h),o.multiply(c,e.massMultiplier,c),this.gmult(d,l,n*p,c,a*u)},n.prototype.computeGiMGt=function(){var t=this.bodyA,e=this.bodyB,i=t.invMassSolve,n=e.invMassSolve,o=t.invInertiaSolve,r=e.invInertiaSolve,a=this.G;return a[0]*a[0]*i*t.massMultiplier[0]+a[1]*a[1]*i*t.massMultiplier[1]+a[2]*a[2]*o+a[3]*a[3]*n*e.massMultiplier[0]+a[4]*a[4]*n*e.massMultiplier[1]+a[5]*a[5]*r};var h=o.create(),p=o.create(),u=o.create();o.create(),o.create(),o.create();n.prototype.addToWlambda=function(t){var e=this.bodyA,i=this.bodyB,n=h,r=p,a=u,s=e.invMassSolve,l=i.invMassSolve,c=e.invInertiaSolve,d=i.invInertiaSolve,f=this.G;r[0]=f[0],r[1]=f[1],a[0]=f[3],a[1]=f[4],o.scale(n,r,s*t),o.multiply(n,n,e.massMultiplier),o.add(e.vlambda,e.vlambda,n),e.wlambda+=c*f[2]*t,o.scale(n,a,l*t),o.multiply(n,n,i.massMultiplier),o.add(i.vlambda,i.vlambda,n),i.wlambda+=d*f[5]*t},n.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(t,e,i){function n(t,e,i){r.call(this,t,e,-i,i),this.contactPointA=o.create(),this.contactPointB=o.create(),this.t=o.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}var o=t("../math/vec2"),r=t("./Equation");t("../utils/Utils");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},n.prototype.getSlipForce=function(){return this.maxForce},n.prototype.computeB=function(t,e,i){this.bodyA,this.bodyB;var n=this.contactPointA,r=this.contactPointB,a=this.t,s=this.G;return s[0]=-a[0],s[1]=-a[1],s[2]=-o.crossLength(n,a),s[3]=a[0],s[4]=a[1],s[5]=o.crossLength(r,a),-this.computeGW()*e-i*this.computeGiMf()}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(t,e,i){function n(t,e,i){i=i||{},o.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0;var n=this.G;n[2]=1,n[5]=-1}var o=t("./Equation"),r=t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n;var a=r.create(),s=r.create(),l=r.fromValues(1,0),c=r.fromValues(0,1);n.prototype.computeGq=function(){return r.rotate(a,l,this.bodyA.angle+this.angle),r.rotate(s,c,this.bodyB.angle),r.dot(a,s)}},{"../math/vec2":30,"./Equation":22}],25:[function(t,e,i){function n(t,e){o.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}var o=t("./Equation");t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeB=function(t,e,i){var n=this.G;n[2]=-1,n[5]=this.ratio;var o=this.computeGiMf();return-this.computeGW()*e-i*o}},{"../math/vec2":30,"./Equation":22}],26:[function(t,e,i){var n=function(){};e.exports=n,n.prototype={constructor:n,on:function(t,e,i){e.context=i||this,void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e),this},has:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;if(e){if(void 0!==i[t]&&-1!==i[t].indexOf(e))return!0}else if(void 0!==i[t])return!0;return!1},off:function(t,e){if(void 0===this._listeners)return this;var i=this._listeners,n=i[t].indexOf(e);return-1!==n&&i[t].splice(n,1),this},emit:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=0,n=e.length;i<n;i++){var o=e[i];o.call(o.context,t)}}return this}}},{}],27:[function(t,e,i){function n(t,e,i){if(i=i||{},!(t instanceof o&&e instanceof o))throw new Error("First two arguments must be Material instances.");this.id=n.idCounter++,this.materialA=t,this.materialB=e,this.friction=void 0!==i.friction?Number(i.friction):.3,this.restitution=void 0!==i.restitution?Number(i.restitution):0,this.stiffness=void 0!==i.stiffness?Number(i.stiffness):r.DEFAULT_STIFFNESS,this.relaxation=void 0!==i.relaxation?Number(i.relaxation):r.DEFAULT_RELAXATION,this.frictionStiffness=void 0!==i.frictionStiffness?Number(i.frictionStiffness):r.DEFAULT_STIFFNESS,this.frictionRelaxation=void 0!==i.frictionRelaxation?Number(i.frictionRelaxation):r.DEFAULT_RELAXATION,this.surfaceVelocity=void 0!==i.surfaceVelocity?Number(i.surfaceVelocity):0,this.contactSkinSize=.005}var o=t("./Material"),r=t("../equations/Equation");e.exports=n,n.idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(t,e,i){function n(t){this.id=t||n.idCounter++}e.exports=n,n.idCounter=0},{}],29:[function(t,e,i){var n={};n.GetArea=function(t){if(t.length<6)return 0;for(var e=t.length-2,i=0,n=0;n<e;n+=2)i+=(t[n+2]-t[n])*(t[n+1]+t[n+3]);return.5*-(i+=(t[0]-t[e])*(t[e+1]+t[1]))},n.Triangulate=function(t){var e=t.length>>1;if(e<3)return[];for(var i=[],o=[],r=0;r<e;r++)o.push(r);for(var r=0,a=e;a>3;){var s=o[(r+0)%a],l=o[(r+1)%a],c=o[(r+2)%a],h=t[2*s],p=t[2*s+1],u=t[2*l],d=t[2*l+1],f=t[2*c],m=t[2*c+1],g=!1;if(n._convex(h,p,u,d,f,m)){g=!0;for(var y=0;y<a;y++){var v=o[y];if(v!=s&&v!=l&&v!=c&&n._PointInTriangle(t[2*v],t[2*v+1],h,p,u,d,f,m)){g=!1;break}}}if(g)i.push(s,l,c),o.splice((r+1)%a,1),a--,r=0;else if(r++>3*a)break}return i.push(o[0],o[1],o[2]),i},n._PointInTriangle=function(t,e,i,n,o,r,a,s){var l=a-i,c=s-n,h=o-i,p=r-n,u=t-i,d=e-n,f=l*l+c*c,m=l*h+c*p,g=l*u+c*d,y=h*h+p*p,v=h*u+p*d,b=1/(f*y-m*m),w=(y*g-m*v)*b,x=(f*v-m*g)*b;return w>=0&&x>=0&&w+x<1},n._convex=function(t,e,i,n,o,r){return(e-n)*(o-i)+(i-t)*(r-n)>=0},e.exports=n},{}],30:[function(t,e,i){var n=e.exports={},o=t("../utils/Utils");n.crossLength=function(t,e){return t[0]*e[1]-t[1]*e[0]},n.crossVZ=function(t,e,i){return n.rotate(t,e,-Math.PI/2),n.scale(t,t,i),t},n.crossZV=function(t,e,i){return n.rotate(t,i,Math.PI/2),n.scale(t,t,e),t},n.rotate=function(t,e,i){if(0!==i){var n=Math.cos(i),o=Math.sin(i),r=e[0],a=e[1];t[0]=n*r-o*a,t[1]=o*r+n*a}else t[0]=e[0],t[1]=e[1]},n.rotate90cw=function(t,e){var i=e[0],n=e[1];t[0]=n,t[1]=-i},n.toLocalFrame=function(t,e,i,o){n.copy(t,e),n.sub(t,t,i),n.rotate(t,t,-o)},n.toGlobalFrame=function(t,e,i,o){n.copy(t,e),n.rotate(t,t,o),n.add(t,t,i)},n.vectorToLocalFrame=function(t,e,i){n.rotate(t,e,-i)},n.vectorToGlobalFrame=function(t,e,i){n.rotate(t,e,i)},n.centroid=function(t,e,i,o){return n.add(t,e,i),n.add(t,t,o),n.scale(t,t,1/3),t},n.create=function(){var t=new o.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},n.clone=function(t){var e=new o.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},n.fromValues=function(t,e){var i=new o.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},n.set=function(t,e,i){return t[0]=e,t[1]=i,t},n.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},n.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},n.sub=n.subtract,n.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},n.mul=n.multiply,n.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},n.div=n.divide,n.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},n.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},n.dist=n.distance,n.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},n.len=n.length,n.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},n.normalize=function(t,e){var i=e[0],n=e[1],o=i*i+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},n.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},n.lerp=function(t,e,i,n){var o=e[0],r=e[1];return t[0]=o+n*(i[0]-o),t[1]=r+n*(i[1]-r),t},n.reflect=function(t,e,i){var n=e[0]*i[0]+e[1]*i[1];t[0]=e[0]-2*i[0]*n,t[1]=e[1]-2*i[1]*n},n.getLineSegmentsIntersection=function(t,e,i,o,r){var a=n.getLineSegmentsIntersectionFraction(e,i,o,r);return!(a<0)&&(t[0]=e[0]+a*(i[0]-e[0]),t[1]=e[1]+a*(i[1]-e[1]),!0)},n.getLineSegmentsIntersectionFraction=function(t,e,i,n){var o,r,a=e[0]-t[0],s=e[1]-t[1],l=n[0]-i[0],c=n[1]-i[1];return o=(-s*(t[0]-i[0])+a*(t[1]-i[1]))/(-l*s+a*c),r=(l*(t[1]-i[1])-c*(t[0]-i[0]))/(-l*s+a*c),o>=0&&o<=1&&r>=0&&r<=1?r:-1}},{"../utils/Utils":57}],31:[function(t,e,i){function n(t){t=t||{},h.call(this),this.id=t.id||++n._idCounter,this.world=null,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=o.create(),this.position=o.fromValues(0,0),t.position&&o.copy(this.position,t.position),this.interpolatedPosition=o.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=o.fromValues(0,0),this.previousAngle=0,this.velocity=o.fromValues(0,0),t.velocity&&o.copy(this.velocity,t.velocity),this.vlambda=o.fromValues(0,0),this.wlambda=0,this.angle=t.angle||0,this.angularVelocity=t.angularVelocity||0,this.force=o.create(),t.force&&o.copy(this.force,t.force),this.angularForce=t.angularForce||0,this.damping="number"==typeof t.damping?t.damping:.1,this.angularDamping="number"==typeof t.angularDamping?t.angularDamping:.1,this.type=n.STATIC,void 0!==t.type?this.type=t.type:t.mass?this.type=n.DYNAMIC:this.type=n.STATIC,this.boundingRadius=0,this.aabb=new c,this.aabbNeedsUpdate=!0,this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.wantsToSleep=!1,this.sleepState=n.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.gravityScale=void 0!==t.gravityScale?t.gravityScale:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==t.ccdSpeedThreshold?t.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==t.ccdIterations?t.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}var o=t("../math/vec2"),r=t("poly-decomp"),a=t("../shapes/Convex"),s=t("../collision/RaycastResult"),l=t("../collision/Ray"),c=t("../collision/AABB"),h=t("../events/EventEmitter");e.exports=n,n.prototype=new h,n.prototype.constructor=n,n._idCounter=0,n.prototype.updateSolveMassProperties=function(){this.sleepState===n.SLEEPING||this.type===n.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},n.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},n.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},n.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var p=new c,u=o.create();n.prototype.updateAABB=function(){for(var t=this.shapes,e=t.length,i=u,n=this.angle,r=0;r!==e;r++){var a=t[r],s=a.angle+n;o.rotate(i,a.position,n),o.add(i,i,this.position),a.computeAABB(p,i,s),0===r?this.aabb.copy(p):this.aabb.extend(p)}this.aabbNeedsUpdate=!1},n.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=t.length,i=0,n=0;n!==e;n++){var r=t[n],a=o.length(r.position),s=r.boundingRadius;a+s>i&&(i=a+s)}this.boundingRadius=i},n.prototype.addShape=function(t,e,i){if(t.body)throw new Error("A shape can only be added to one body.");t.body=this,e?o.copy(t.position,e):o.set(t.position,0,0),t.angle=i||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},n.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e&&(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,t.body=null,!0)},n.prototype.updateMassProperties=function(){if(this.type===n.STATIC||this.type===n.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var t=this.shapes,e=t.length,i=this.mass/e,r=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var a=0;a<e;a++){var s=t[a],l=o.squaredLength(s.position);r+=s.computeMomentOfInertia(i)+i*l}this.inertia=r,this.invInertia=r>0?1/r:0}this.invMass=1/this.mass,o.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}};o.create();n.prototype.applyForce=function(t,e){if(o.add(this.force,this.force,t),e){var i=o.crossLength(e,t);this.angularForce+=i}};var d=o.create(),f=o.create(),m=o.create();n.prototype.applyForceLocal=function(t,e){e=e||m;var i=d,n=f;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyForce(i,n)};var g=o.create();n.prototype.applyImpulse=function(t,e){if(this.type===n.DYNAMIC){var i=g;if(o.scale(i,t,this.invMass),o.multiply(i,this.massMultiplier,i),o.add(this.velocity,i,this.velocity),e){var r=o.crossLength(e,t);r*=this.invInertia,this.angularVelocity+=r}}};var y=o.create(),v=o.create(),b=o.create();n.prototype.applyImpulseLocal=function(t,e){e=e||b;var i=y,n=v;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyImpulse(i,n)},n.prototype.toLocalFrame=function(t,e){o.toLocalFrame(t,e,this.position,this.angle)},n.prototype.toWorldFrame=function(t,e){o.toGlobalFrame(t,e,this.position,this.angle)},n.prototype.vectorToLocalFrame=function(t,e){o.vectorToLocalFrame(t,e,this.angle)},n.prototype.vectorToWorldFrame=function(t,e){o.vectorToGlobalFrame(t,e,this.angle)},n.prototype.fromPolygon=function(t,e){e=e||{};for(var i=!1,n=this.shapes.length;n>=0;--n)this.removeShape(this.shapes[n]);var s=new r.Polygon;if(s.vertices=t,s.makeCCW(),"number"==typeof e.removeCollinearPoints&&s.removeCollinearPoints(e.removeCollinearPoints),void 0===e.skipSimpleCheck&&!s.isSimple())return!1;this.concavePath=s.vertices.slice(0);for(n=0;n<this.concavePath.length;n++){u=[0,0];o.copy(u,this.concavePath[n]),this.concavePath[n]=u}var l;l=e.optimalDecomp?s.decomp():s.quickDecomp();for(var c=o.create(),n=0;n!==l.length;n++){for(var h=new a({vertices:l[n].vertices}),p=0;p!==h.vertices.length;p++){var u=h.vertices[p];o.sub(u,u,h.centerOfMass)}o.scale(c,h.centerOfMass,1),h.updateTriangles(),h.updateCenterOfMass(),h.updateBoundingRadius(),this.addShape(h,c)}return"boolean"==typeof e.skipAdjustCenterOfMass&&(i=e.skipAdjustCenterOfMass),0==i&&this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0};o.fromValues(0,0);var w=o.fromValues(0,0),x=o.fromValues(0,0),_=o.fromValues(0,0);n.prototype.adjustCenterOfMass=function(){var t=w,e=x,i=_,n=0;o.set(e,0,0);for(a=0;a!==this.shapes.length;a++){r=this.shapes[a];o.scale(t,r.position,r.area),o.add(e,e,t),n+=r.area}o.scale(i,e,1/n);for(a=0;a!==this.shapes.length;a++){var r=this.shapes[a];o.sub(r.position,r.position,i)}o.add(this.position,this.position,i);for(var a=0;this.concavePath&&a<this.concavePath.length;a++)o.sub(this.concavePath[a],this.concavePath[a],i);this.updateMassProperties(),this.updateBoundingRadius()},n.prototype.setZeroForce=function(){o.set(this.force,0,0),this.angularForce=0},n.prototype.resetConstraintVelocity=function(){var t=this,e=t.vlambda;o.set(e,0,0),t.wlambda=0},n.prototype.addConstraintVelocity=function(){var t=this,e=t.velocity;o.add(e,e,t.vlambda),t.angularVelocity+=t.wlambda},n.prototype.applyDamping=function(t){if(this.type===n.DYNAMIC){var e=this.velocity;o.scale(e,e,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t)}},n.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=n.AWAKE,this.idleTime=0,t!==n.AWAKE&&this.emit(n.wakeUpEvent)},n.prototype.sleep=function(){this.sleepState=n.SLEEPING,this.angularVelocity=0,this.angularForce=0,o.set(this.velocity,0,0),o.set(this.force,0,0),this.emit(n.sleepEvent)},n.prototype.sleepTick=function(t,e,i){if(this.allowSleep&&this.type!==n.SLEEPING){this.wantsToSleep=!1;this.sleepState;o.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2)>=Math.pow(this.sleepSpeedLimit,2)?(this.idleTime=0,this.sleepState=n.AWAKE):(this.idleTime+=i,this.sleepState=n.SLEEPY),this.idleTime>this.sleepTimeLimit&&(e?this.wantsToSleep=!0:this.sleep())}},n.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var S=o.create(),T=o.create();n.prototype.integrate=function(t){var e=this.invMass,i=this.force,n=this.position,r=this.velocity;o.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),o.scale(S,i,t*e),o.multiply(S,this.massMultiplier,S),o.add(r,S,r),this.integrateToTimeOfImpact(t)||(o.scale(T,r,t),o.add(n,n,T),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0};var P=new s,C=new l({mode:l.CLOSEST,skipBackfaces:!0}),I=o.create(),k=o.create(),A=o.create();o.create();n.prototype.integrateToTimeOfImpact=function(t){if(this.ccdSpeedThreshold<0||o.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;o.normalize(I,this.velocity),o.scale(k,this.velocity,t),o.add(k,k,this.position),o.sub(A,k,this.position);this.angularVelocity,o.length(A);return o.copy(C.from,this.position),o.copy(C.to,k),C.update(),this.world.raycast(P,C),hitBody=P.body,hitBody===this&&(hitBody=null),!1},n.prototype.getVelocityAtPoint=function(t,e){return o.crossVZ(t,e,this.angularVelocity),o.subtract(t,this.velocity,t),t},n.sleepyEvent={type:"sleepy"},n.sleepEvent={type:"sleep"},n.wakeUpEvent={type:"wakeup"},n.DYNAMIC=1,n.STATIC=2,n.KINEMATIC=4,n.AWAKE=0,n.SLEEPY=1,n.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(t,e,i){function n(t,e,i){i=i||{},r.call(this,t,e,i),this.localAnchorA=o.fromValues(0,0),this.localAnchorB=o.fromValues(0,0),i.localAnchorA&&o.copy(this.localAnchorA,i.localAnchorA),i.localAnchorB&&o.copy(this.localAnchorB,i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB);var n=o.create(),a=o.create();this.getWorldAnchorA(n),this.getWorldAnchorB(a);var s=o.distance(n,a);this.restLength="number"==typeof i.restLength?i.restLength:s}var o=t("../math/vec2"),r=t("./Spring");t("../utils/Utils");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.setWorldAnchorA=function(t){this.bodyA.toLocalFrame(this.localAnchorA,t)},n.prototype.setWorldAnchorB=function(t){this.bodyB.toLocalFrame(this.localAnchorB,t)},n.prototype.getWorldAnchorA=function(t){this.bodyA.toWorldFrame(t,this.localAnchorA)},n.prototype.getWorldAnchorB=function(t){this.bodyB.toWorldFrame(t,this.localAnchorB)};var a=o.create(),s=o.create(),l=o.create(),c=o.create(),h=o.create(),p=o.create(),u=o.create(),d=o.create(),f=o.create();n.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restLength,n=this.bodyA,r=this.bodyB,m=a,g=s,y=l,v=c,b=f,w=h,x=p,_=u,S=d;this.getWorldAnchorA(w),this.getWorldAnchorB(x),o.sub(_,w,n.position),o.sub(S,x,r.position),o.sub(m,x,w);var T=o.len(m);o.normalize(g,m),o.sub(y,r.velocity,n.velocity),o.crossZV(b,r.angularVelocity,S),o.add(y,y,b),o.crossZV(b,n.angularVelocity,_),o.sub(y,y,b),o.scale(v,g,-t*(T-i)-e*o.dot(y,g)),o.sub(n.force,n.force,v),o.add(r.force,r.force,v);var P=o.crossLength(_,v),C=o.crossLength(S,v);n.angularForce-=P,r.angularForce+=C}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(t,e,i){function n(t,e,i){i=i||{},o.call(this,t,e,i),this.restAngle="number"==typeof i.restAngle?i.restAngle:e.angle-t.angle}t("../math/vec2");var o=t("./Spring");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restAngle,n=this.bodyA,o=this.bodyB,r=-t*(o.angle-n.angle-i)-e*(o.angularVelocity-n.angularVelocity)*0;n.angularForce-=r,o.angularForce+=r}},{"../math/vec2":30,"./Spring":34}],34:[function(t,e,i){function n(t,e,i){i=o.defaults(i,{stiffness:100,damping:1}),this.stiffness=i.stiffness,this.damping=i.damping,this.bodyA=t,this.bodyB=e}t("../math/vec2");var o=t("../utils/Utils");e.exports=n,n.prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(t,e,i){function n(t,e){e=e||{},this.chassisBody=t,this.wheels=[],this.groundBody=new l({mass:0}),this.world=null;var i=this;this.preStepCallback=function(){i.update()}}function o(t,e){e=e||{},this.vehicle=t,this.forwardEquation=new s(t.chassisBody,t.groundBody),this.sideEquation=new s(t.chassisBody,t.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==e.sideFriction?e.sideFriction:5),this.localForwardVector=r.fromValues(0,1),e.localForwardVector&&r.copy(this.localForwardVector,e.localForwardVector),this.localPosition=r.fromValues(0,0),e.localPosition&&r.copy(this.localPosition,e.localPosition),a.apply(this,t.chassisBody,t.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}var r=t("../math/vec2"),a=(t("../utils/Utils"),t("../constraints/Constraint")),s=t("../equations/FrictionEquation"),l=t("../objects/Body");e.exports=n,n.prototype.addToWorld=function(t){this.world=t,t.addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.addConstraint(i)}},n.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.removeConstraint(i)}this.world=null},n.prototype.addWheel=function(t){var e=new o(this,t);return this.wheels.push(e),e},n.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},(o.prototype=new a).setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},o.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var c=r.create(),h=r.create();o.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(h,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(c,h),r.dot(c,h)};var p=r.create();o.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),r.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),r.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),r.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),r.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),r.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),r.normalize(p,this.forwardEquation.t),r.scale(p,p,this.engineForce),this.vehicle.chassisBody.applyForce(p,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(t,e,i){var n=e.exports={AABB:t("./collision/AABB"),AngleLockEquation:t("./equations/AngleLockEquation"),Body:t("./objects/Body"),Broadphase:t("./collision/Broadphase"),Capsule:t("./shapes/Capsule"),Circle:t("./shapes/Circle"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),ContactEquationPool:t("./utils/ContactEquationPool"),ContactMaterial:t("./material/ContactMaterial"),Convex:t("./shapes/Convex"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventEmitter:t("./events/EventEmitter"),FrictionEquation:t("./equations/FrictionEquation"),FrictionEquationPool:t("./utils/FrictionEquationPool"),GearConstraint:t("./constraints/GearConstraint"),GSSolver:t("./solver/GSSolver"),Heightfield:t("./shapes/Heightfield"),Line:t("./shapes/Line"),LockConstraint:t("./constraints/LockConstraint"),Material:t("./material/Material"),Narrowphase:t("./collision/Narrowphase"),NaiveBroadphase:t("./collision/NaiveBroadphase"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),Pool:t("./utils/Pool"),RevoluteConstraint:t("./constraints/RevoluteConstraint"),PrismaticConstraint:t("./constraints/PrismaticConstraint"),Ray:t("./collision/Ray"),RaycastResult:t("./collision/RaycastResult"),Box:t("./shapes/Box"),RotationalVelocityEquation:t("./equations/RotationalVelocityEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Spring:t("./objects/Spring"),TopDownVehicle:t("./objects/TopDownVehicle"),LinearSpring:t("./objects/LinearSpring"),RotationalSpring:t("./objects/RotationalSpring"),Utils:t("./utils/Utils"),World:t("./world/World"),vec2:t("./math/vec2"),version:t("../package.json").version};Object.defineProperty(n,"Rectangle",{get:function(){return console.warn("The Rectangle class has been renamed to Box."),this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={width:arguments[0],height:arguments[1]},console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")),t=t||{};var e=this.width=t.width||1,i=this.height=t.height||1,n=[o.fromValues(-e/2,-i/2),o.fromValues(e/2,-i/2),o.fromValues(e/2,i/2),o.fromValues(-e/2,i/2)],s=[o.fromValues(1,0),o.fromValues(0,1)];t.vertices=n,t.axes=s,t.type=r.BOX,a.call(this,t)}var o=t("../math/vec2"),r=t("./Shape"),a=t("./Convex");e.exports=n,(n.prototype=new a).constructor=n,n.prototype.computeMomentOfInertia=function(t){var e=this.width,i=this.height;return t*(i*i+e*e)/12},n.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2};o.create(),o.create(),o.create(),o.create();n.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)},n.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={length:arguments[0],radius:arguments[1]},console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")),t=t||{},this.length=t.length||1,this.radius=t.radius||1,t.type=o.CAPSULE,o.call(this,t)}var o=t("./Shape"),r=t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeMomentOfInertia=function(t){var e=this.radius,i=this.length+e,n=2*e;return t*(n*n+i*i)/12},n.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},n.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var a=r.create();n.prototype.computeAABB=function(t,e,i){var n=this.radius;r.set(a,this.length/2,0),0!==i&&r.rotate(a,a,i),r.set(t.upperBound,Math.max(a[0]+n,-a[0]+n),Math.max(a[1]+n,-a[1]+n)),r.set(t.lowerBound,Math.min(a[0]-n,-a[0]-n),Math.min(a[1]-n,-a[1]-n)),r.add(t.lowerBound,t.lowerBound,e),r.add(t.upperBound,t.upperBound,e)};var s=r.create(),l=r.create(),c=r.create(),h=r.create(),p=r.fromValues(0,1);n.prototype.raycast=function(t,e,i,n){for(var o=e.from,a=e.to,u=(e.direction,s),d=l,f=c,m=h,g=this.length/2,y=0;y<2;y++){var v=this.radius*(2*y-1);if(r.set(f,-g,v),r.set(m,g,v),r.toGlobalFrame(f,f,i,n),r.toGlobalFrame(m,m,i,n),(S=r.getLineSegmentsIntersectionFraction(o,a,f,m))>=0&&(r.rotate(d,p,n),r.scale(d,d,2*y-1),e.reportIntersection(t,S,d,-1),t.shouldStop(e)))return}for(var b=Math.pow(this.radius,2)+Math.pow(g,2),y=0;y<2;y++){r.set(f,g*(2*y-1),0),r.toGlobalFrame(f,f,i,n);var w=Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2),x=2*((a[0]-o[0])*(o[0]-f[0])+(a[1]-o[1])*(o[1]-f[1])),_=Math.pow(o[0]-f[0],2)+Math.pow(o[1]-f[1],2)-Math.pow(this.radius,2),S=Math.pow(x,2)-4*w*_;if(!(S<0))if(0===S){if(r.lerp(u,o,a,S),r.squaredDistance(u,i)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,S,d,-1),t.shouldStop(e)))return}else{var T=Math.sqrt(S),P=1/(2*w),C=(-x-T)*P,I=(-x+T)*P;if(C>=0&&C<=1&&(r.lerp(u,o,a,C),r.squaredDistance(u,i)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,C,d,-1),t.shouldStop(e))))return;if(I>=0&&I<=1&&(r.lerp(u,o,a,I),r.squaredDistance(u,i)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,I,d,-1),t.shouldStop(e))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&(t={radius:arguments[0]},console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")),t=t||{},this.radius=t.radius||1,t.type=o.CIRCLE,o.call(this,t)}var o=t("./Shape"),r=t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeMomentOfInertia=function(t){var e=this.radius;return t*e*e/2},n.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},n.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},n.prototype.computeAABB=function(t,e,i){var n=this.radius;r.set(t.upperBound,n,n),r.set(t.lowerBound,-n,-n),e&&(r.add(t.lowerBound,t.lowerBound,e),r.add(t.upperBound,t.upperBound,e))};var a=r.create(),s=r.create();n.prototype.raycast=function(t,e,i,n){var o=e.from,l=e.to,c=this.radius,h=Math.pow(l[0]-o[0],2)+Math.pow(l[1]-o[1],2),p=2*((l[0]-o[0])*(o[0]-i[0])+(l[1]-o[1])*(o[1]-i[1])),u=Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)-Math.pow(c,2),d=Math.pow(p,2)-4*h*u,f=a,m=s;if(!(d<0))if(0===d)r.lerp(f,o,l,d),r.sub(m,f,i),r.normalize(m,m),e.reportIntersection(t,d,m,-1);else{var g=Math.sqrt(d),y=1/(2*h),v=(-p-g)*y,b=(-p+g)*y;if(v>=0&&v<=1&&(r.lerp(f,o,l,v),r.sub(m,f,i),r.normalize(m,m),e.reportIntersection(t,v,m,-1),t.shouldStop(e)))return;b>=0&&b<=1&&(r.lerp(f,o,l,b),r.sub(m,f,i),r.normalize(m,m),e.reportIntersection(t,b,m,-1))}}},{"../math/vec2":30,"./Shape":45}],40:[function(t,e,i){function n(t){Array.isArray(arguments[0])&&(t={vertices:arguments[0],axes:arguments[1]},console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")),t=t||{},this.vertices=[];for(var e=void 0!==t.vertices?t.vertices:[],i=0;i<e.length;i++){var n=r.create();r.copy(n,e[i]),this.vertices.push(n)}if(this.axes=[],t.axes)for(i=0;i<t.axes.length;i++){var a=r.create();r.copy(a,t.axes[i]),this.axes.push(a)}else for(i=0;i<this.vertices.length;i++){var s=this.vertices[i],l=this.vertices[(i+1)%this.vertices.length],c=r.create();r.sub(c,l,s),r.rotate90cw(c,c),r.normalize(c,c),this.axes.push(c)}if(this.centerOfMass=r.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,t.type=o.CONVEX,o.call(this,t),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}var o=t("./Shape"),r=t("../math/vec2"),a=t("../math/polyk");t("poly-decomp");e.exports=n,(n.prototype=new o).constructor=n;var s=r.create(),l=r.create();n.prototype.projectOntoLocalAxis=function(t,e){for(var i,n,o=null,a=null,t=s,l=0;l<this.vertices.length;l++)i=this.vertices[l],n=r.dot(i,t),(null===o||n>o)&&(o=n),(null===a||n<a)&&(a=n);if(a>o){var c=a;a=o,o=c}r.set(e,a,o)},n.prototype.projectOntoWorldAxis=function(t,e,i,n){var o=l;this.projectOntoLocalAxis(t,n),0!==i?r.rotate(o,t,i):o=t;var a=r.dot(e,o);r.set(n,n[0]+a,n[1]+a)},n.prototype.updateTriangles=function(){this.triangles.length=0;for(var t=[],e=0;e<this.vertices.length;e++){var i=this.vertices[e];t.push(i[0],i[1])}for(var n=a.Triangulate(t),e=0;e<n.length;e+=3){var o=n[e],r=n[e+1],s=n[e+2];this.triangles.push([o,r,s])}};var c=r.create(),h=r.create(),p=r.create(),u=r.create(),d=r.create();r.create(),r.create(),r.create(),r.create();n.prototype.updateCenterOfMass=function(){var t=this.triangles,e=this.vertices,i=this.centerOfMass,o=c,a=p,s=u,l=d,f=h;r.set(i,0,0);for(var m=0,g=0;g!==t.length;g++){var y=t[g],a=e[y[0]],s=e[y[1]],l=e[y[2]];r.centroid(o,a,s,l);var v=n.triangleArea(a,s,l);m+=v,r.scale(f,o,v),r.add(i,i,f)}r.scale(i,i,1/m)},n.prototype.computeMomentOfInertia=function(t){for(var e=0,i=0,n=this.vertices.length,o=n-1,a=0;a<n;o=a,a++){var s=this.vertices[o],l=this.vertices[a],c=Math.abs(r.crossLength(s,l));e+=c*(r.dot(l,l)+r.dot(l,s)+r.dot(s,s)),i+=c}return t/6*(e/i)},n.prototype.updateBoundingRadius=function(){for(var t=this.vertices,e=0,i=0;i!==t.length;i++){var n=r.squaredLength(t[i]);n>e&&(e=n)}this.boundingRadius=Math.sqrt(e)},n.triangleArea=function(t,e,i){return.5*((e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1]))},n.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var t=this.triangles,e=this.vertices,i=0;i!==t.length;i++){var o=t[i],r=e[o[0]],a=e[o[1]],s=e[o[2]],l=n.triangleArea(r,a,s);this.area+=l}},n.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)};var f=r.create(),m=r.create(),g=r.create();n.prototype.raycast=function(t,e,i,n){var o=f,a=m,s=g,l=this.vertices;r.toLocalFrame(o,e.from,i,n),r.toLocalFrame(a,e.to,i,n);for(var c=l.length,h=0;h<c&&!t.shouldStop(e);h++){var p=l[h],u=l[(h+1)%c],d=r.getLineSegmentsIntersectionFraction(o,a,p,u);d>=0&&(r.sub(s,u,p),r.rotate(s,s,-Math.PI/2+n),r.normalize(s,s),e.reportIntersection(t,d,s,h))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(t,e,i){function n(t){if(Array.isArray(arguments[0])){if(t={heights:arguments[0]},"object"==typeof arguments[1])for(var e in arguments[1])t[e]=arguments[1][e];console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")}t=t||{},this.heights=t.heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,void 0!==t.maxValue&&void 0!==t.minValue||this.updateMaxMinValues(),t.type=o.HEIGHTFIELD,o.call(this,t)}var o=t("./Shape"),r=t("../math/vec2");t("../utils/Utils");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.updateMaxMinValues=function(){for(var t=this.heights,e=t[0],i=t[0],n=0;n!==t.length;n++){var o=t[n];o>e&&(e=o),o<i&&(i=o)}this.maxValue=e,this.minValue=i},n.prototype.computeMomentOfInertia=function(t){return Number.MAX_VALUE},n.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},n.prototype.updateArea=function(){for(var t=this.heights,e=0,i=0;i<t.length-1;i++)e+=(t[i]+t[i+1])/2*this.elementWidth;this.area=e};var a=[r.create(),r.create(),r.create(),r.create()];n.prototype.computeAABB=function(t,e,i){r.set(a[0],0,this.maxValue),r.set(a[1],this.elementWidth*this.heights.length,this.maxValue),r.set(a[2],this.elementWidth*this.heights.length,this.minValue),r.set(a[3],0,this.minValue),t.setFromPoints(a,e,i)},n.prototype.getLineSegment=function(t,e,i){var n=this.heights,o=this.elementWidth;r.set(t,i*o,n[i]),r.set(e,(i+1)*o,n[i+1])},n.prototype.getSegmentIndex=function(t){return Math.floor(t[0]/this.elementWidth)},n.prototype.getClampedSegmentIndex=function(t){var e=this.getSegmentIndex(t);return e=Math.min(this.heights.length,Math.max(e,0))};r.create();var s=r.create(),l=r.create(),c=r.create(),h=r.create(),p=r.create();r.fromValues(0,1);n.prototype.raycast=function(t,e,i,n){var o=e.from,a=e.to,u=(e.direction,s),d=l,f=c,m=h,g=p;r.toLocalFrame(m,o,i,n),r.toLocalFrame(g,a,i,n);var y=this.getClampedSegmentIndex(m),v=this.getClampedSegmentIndex(g);if(y>v){var b=y;y=v,v=b}for(var w=0;w<this.heights.length-1;w++){this.getLineSegment(d,f,w);var x=r.getLineSegmentsIntersectionFraction(m,g,d,f);if(x>=0&&(r.sub(u,f,d),r.rotate(u,u,n+Math.PI/2),r.normalize(u,u),e.reportIntersection(t,x,u,-1),t.shouldStop(e)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&(t={length:arguments[0]},console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")),t=t||{},this.length=t.length||1,t.type=o.LINE,o.call(this,t)}var o=t("./Shape"),r=t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},n.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var a=[r.create(),r.create()];n.prototype.computeAABB=function(t,e,i){var n=this.length/2;r.set(a[0],-n,0),r.set(a[1],n,0),t.setFromPoints(a,e,i,0)};r.create();var s=r.create(),l=r.create(),c=r.create(),h=r.fromValues(0,1);n.prototype.raycast=function(t,e,i,n){var o=e.from,a=e.to,p=l,u=c,d=this.length/2;r.set(p,-d,0),r.set(u,d,0),r.toGlobalFrame(p,p,i,n),r.toGlobalFrame(u,u,i,n);var f=r.getLineSegmentsIntersectionFraction(p,u,o,a);if(f>=0){var m=s;r.rotate(m,h,n),e.reportIntersection(t,f,m,-1)}}},{"../math/vec2":30,"./Shape":45}],43:[function(t,e,i){function n(t){(t=t||{}).type=o.PARTICLE,o.call(this,t)}var o=t("./Shape"),r=t("../math/vec2");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeMomentOfInertia=function(t){return 0},n.prototype.updateBoundingRadius=function(){this.boundingRadius=0},n.prototype.computeAABB=function(t,e,i){r.copy(t.lowerBound,e),r.copy(t.upperBound,e)}},{"../math/vec2":30,"./Shape":45}],44:[function(t,e,i){function n(t){(t=t||{}).type=o.PLANE,o.call(this,t)}var o=t("./Shape"),r=t("../math/vec2");t("../utils/Utils");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.computeMomentOfInertia=function(t){return 0},n.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},n.prototype.computeAABB=function(t,e,i){var n=i%(2*Math.PI),o=r.set,a=Number.MAX_VALUE,s=t.lowerBound,l=t.upperBound;0===n?(o(s,-a,-a),o(l,a,0)):n===Math.PI/2?(o(s,0,-a),o(l,a,a)):n===Math.PI?(o(s,-a,0),o(l,a,a)):n===3*Math.PI/2?(o(s,-a,-a),o(l,0,a)):(o(s,-a,-a),o(l,a,a)),r.add(s,s,e),r.add(l,l,e)},n.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var a=r.create(),s=(r.create(),r.create(),r.create()),l=r.create();n.prototype.raycast=function(t,e,i,n){var o=e.from,c=e.to,h=e.direction,p=a,u=s,d=l;r.set(u,0,1),r.rotate(u,u,n),r.sub(d,o,i);var f=r.dot(d,u);if(r.sub(d,c,i),!(f*r.dot(d,u)>0||r.squaredDistance(o,c)<f*f)){var m=r.dot(u,h);r.sub(p,o,i);var g=-r.dot(u,p)/m/e.length;e.reportIntersection(t,g,u,-1)}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(t,e,i){function n(t){t=t||{},this.body=null,this.position=o.fromValues(0,0),t.position&&o.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=n.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor&&t.sensor,this.type&&this.updateBoundingRadius(),this.updateArea()}e.exports=n;var o=t("../math/vec2");n.idCounter=0,n.CIRCLE=1,n.PARTICLE=2,n.PLANE=4,n.CONVEX=8,n.LINE=16,n.BOX=32,Object.defineProperty(n,"RECTANGLE",{get:function(){return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."),n.BOX}}),n.CAPSULE=64,n.HEIGHTFIELD=128,n.prototype.computeMomentOfInertia=function(t){},n.prototype.updateBoundingRadius=function(){},n.prototype.updateArea=function(){},n.prototype.computeAABB=function(t,e,i){},n.prototype.raycast=function(t,e,i,n){}},{"../math/vec2":30}],46:[function(t,e,i){function n(t){a.call(this,t,a.GS),t=t||{},this.iterations=t.iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new s.ARRAY_TYPE(this.arrayStep),this.Bs=new s.ARRAY_TYPE(this.arrayStep),this.invCs=new s.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=0,this.usedIterations=0}function o(t){for(var e=t.length;e--;)t[e]=0}var r=t("../math/vec2"),a=t("./Solver"),s=t("../utils/Utils"),l=t("../equations/FrictionEquation");e.exports=n,(n.prototype=new a).constructor=n,n.prototype.solve=function(t,e){this.sortEquations();var i=0,a=this.iterations,c=this.frictionIterations,h=this.equations,p=h.length,u=Math.pow(this.tolerance*p,2),d=e.bodies,f=e.bodies.length,m=(r.add,r.set,this.useZeroRHS),g=this.lambda;if(this.usedIterations=0,p)for(b=0;b!==f;b++)(S=d[b]).updateSolveMassProperties();g.length<p&&(g=this.lambda=new s.ARRAY_TYPE(p+this.arrayStep),this.Bs=new s.ARRAY_TYPE(p+this.arrayStep),this.invCs=new s.ARRAY_TYPE(p+this.arrayStep)),o(g);for(var y=this.invCs,v=this.Bs,g=this.lambda,b=0;b!==h.length;b++)((w=h[b]).timeStep!==t||w.needsUpdate)&&(w.timeStep=t,w.update()),v[b]=w.computeB(w.a,w.b,t),y[b]=w.computeInvC(w.epsilon);var w,x,_;if(0!==p){for(b=0;b!==f;b++){var S=d[b];S.resetConstraintVelocity()}if(c){for(i=0;i!==c;i++){for(x=0,_=0;_!==p;_++){w=h[_];I=n.iterateEquation(_,w,w.epsilon,v,y,g,m,t,i);x+=Math.abs(I)}if(this.usedIterations++,x*x<=u)break}for(n.updateMultipliers(h,g,1/t),_=0;_!==p;_++){var T=h[_];if(T instanceof l){for(var P=0,C=0;C!==T.contactEquations.length;C++)P+=T.contactEquations[C].multiplier;P*=T.frictionCoefficient/T.contactEquations.length,T.maxForce=P,T.minForce=-P}}}for(i=0;i!==a;i++){for(x=0,_=0;_!==p;_++){w=h[_];var I=n.iterateEquation(_,w,w.epsilon,v,y,g,m,t,i);x+=Math.abs(I)}if(this.usedIterations++,x*x<=u)break}for(b=0;b!==f;b++)d[b].addConstraintVelocity();n.updateMultipliers(h,g,1/t)}},n.updateMultipliers=function(t,e,i){for(var n=t.length;n--;)t[n].multiplier=e[n]*i},n.iterateEquation=function(t,e,i,n,o,r,a,s,l){var c=n[t],h=o[t],p=r[t],u=e.computeGWlambda(),d=e.maxForce,f=e.minForce;a&&(c=0);var m=h*(c-u-i*p),g=p+m;return g<f*s?m=f*s-p:g>d*s&&(m=d*s-p),r[t]+=m,e.addToWlambda(m),m}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(t,e,i){function n(t,e){t=t||{},o.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}t("../utils/Utils");var o=t("../events/EventEmitter");e.exports=n,(n.prototype=new o).constructor=n,n.prototype.solve=function(t,e){throw new Error("Solver.solve should be implemented by subclasses!")};var r={bodies:[]};n.prototype.solveIsland=function(t,e){this.removeAllEquations(),e.equations.length&&(this.addEquations(e.equations),r.bodies.length=0,e.getBodies(r.bodies),r.bodies.length&&this.solve(t,r))},n.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},n.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},n.prototype.addEquations=function(t){for(var e=0,i=t.length;e!==i;e++){var n=t[e];n.enabled&&this.equations.push(n)}},n.prototype.removeEquation=function(t){var e=this.equations.indexOf(t);-1!==e&&this.equations.splice(e,1)},n.prototype.removeAllEquations=function(){this.equations.length=0},n.GS=1,n.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(t,e,i){function n(){r.apply(this,arguments)}var o=t("../equations/ContactEquation"),r=t("./Pool");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.create=function(){return new o},n.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(t,e,i){function n(){r.apply(this,arguments)}var o=t("../equations/FrictionEquation"),r=t("./Pool");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.create=function(){return new o},n.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(t,e,i){function n(){r.apply(this,arguments)}var o=t("../world/IslandNode"),r=t("./Pool");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.create=function(){return new o},n.prototype.destroy=function(t){return t.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(t,e,i){function n(){r.apply(this,arguments)}var o=t("../world/Island"),r=t("./Pool");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.create=function(){return new o},n.prototype.destroy=function(t){return t.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(t,e,i){function n(){this.overlappingShapesLastState=new o,this.overlappingShapesCurrentState=new o,this.recordPool=new r({size:16}),this.tmpDict=new o,this.tmpArray1=[]}var o=t("./TupleDictionary"),r=(t("./OverlapKeeperRecord"),t("./OverlapKeeperRecordPool"));t("./Utils");e.exports=n,n.prototype.tick=function(){for(var t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState,i=t.keys.length;i--;){var n=t.keys[i],o=t.getByKey(n);e.getByKey(n);o&&this.recordPool.release(o)}t.reset(),t.copy(e),e.reset()},n.prototype.setOverlapping=function(t,e,i,n){this.overlappingShapesLastState;var o=this.overlappingShapesCurrentState;if(!o.get(e.id,n.id)){var r=this.recordPool.get();r.set(t,e,i,n),o.set(e.id,n.id,r)}},n.prototype.getNewOverlaps=function(t){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,t)},n.prototype.getEndOverlaps=function(t){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,t)},n.prototype.bodiesAreOverlapping=function(t,e){for(var i=this.overlappingShapesCurrentState,n=i.keys.length;n--;){var o=i.keys[n],r=i.data[o];if(r.bodyA===t&&r.bodyB===e||r.bodyA===e&&r.bodyB===t)return!0}return!1},n.prototype.getDiff=function(t,e,i){var n=t,o=e;(i=i||[]).length=0;for(var r=o.keys.length;r--;){var a=o.keys[r],s=o.data[a];if(!s)throw new Error("Key "+a+" had no data!");n.data[a]||i.push(s)}return i},n.prototype.isNewOverlap=function(t,e){var i=0|t.id,n=0|e.id,o=this.overlappingShapesLastState,r=this.overlappingShapesCurrentState;return!o.get(i,n)&&!!r.get(i,n)},n.prototype.getNewBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},n.prototype.getEndBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},n.prototype.getBodyDiff=function(t,e){e=e||[];for(var i=this.tmpDict,n=t.length;n--;){var o=t[n];i.set(0|o.bodyA.id,0|o.bodyB.id,o)}for(n=i.keys.length;n--;)(o=i.getByKey(i.keys[n]))&&e.push(o.bodyA,o.bodyB);return i.reset(),e}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(t,e,i){function n(t,e,i,n){this.shapeA=e,this.shapeB=n,this.bodyA=t,this.bodyB=i}e.exports=n,n.prototype.set=function(t,e,i,o){n.call(this,t,e,i,o)}},{}],54:[function(t,e,i){function n(){r.apply(this,arguments)}var o=t("./OverlapKeeperRecord"),r=t("./Pool");e.exports=n,(n.prototype=new r).constructor=n,n.prototype.create=function(){return new o},n.prototype.destroy=function(t){return t.bodyA=t.bodyB=t.shapeA=t.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(t,e,i){function n(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}e.exports=n,n.prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},n.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},n.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this}},{}],56:[function(t,e,i){function n(){this.data={},this.keys=[]}var o=t("./Utils");e.exports=n,n.prototype.getKey=function(t,e){return t|=0,e|=0,(0|t)==(0|e)?-1:0|((0|t)>(0|e)?t<<16|65535&e:e<<16|65535&t)},n.prototype.getByKey=function(t){return t|=0,this.data[t]},n.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},n.prototype.set=function(t,e,i){if(!i)throw new Error("No data!");var n=this.getKey(t,e);return this.data[n]||this.keys.push(n),this.data[n]=i,n},n.prototype.reset=function(){for(var t=this.data,e=this.keys,i=e.length;i--;)delete t[e[i]];e.length=0},n.prototype.copy=function(t){this.reset(),o.appendArray(this.keys,t.keys);for(var e=t.keys.length;e--;){var i=t.keys[e];this.data[i]=t.data[i]}}},{"./Utils":57}],57:[function(t,e,i){function n(){}e.exports=n,n.appendArray=function(t,e){if(e.length<15e4)t.push.apply(t,e);else for(var i=0,n=e.length;i!==n;++i)t.push(e[i])},n.splice=function(t,e,i){i=i||1;for(var n=e,o=t.length-i;n<o;n++)t[n]=t[n+i];t.length=o},n.ARRAY_TYPE="undefined"!=typeof P2_ARRAY_TYPE?P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?Float32Array:Array,n.extend=function(t,e){for(var i in e)t[i]=e[i]},n.defaults=function(t,e){t=t||{};for(var i in e)i in t||(t[i]=e[i]);return t}},{}],58:[function(t,e,i){function n(){this.equations=[],this.bodies=[]}var o=t("../objects/Body");e.exports=n,n.prototype.reset=function(){this.equations.length=this.bodies.length=0};var r=[];n.prototype.getBodies=function(t){var e=t||[],i=this.equations;r.length=0;for(var n=0;n!==i.length;n++){var o=i[n];-1===r.indexOf(o.bodyA.id)&&(e.push(o.bodyA),r.push(o.bodyA.id)),-1===r.indexOf(o.bodyB.id)&&(e.push(o.bodyB),r.push(o.bodyB.id))}return e},n.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];if(e.type===o.DYNAMIC&&!e.wantsToSleep)return!1}return!0},n.prototype.sleep=function(){for(var t=0;t<this.bodies.length;t++)this.bodies[t].sleep();return!0}},{"../objects/Body":31}],59:[function(t,e,i){function n(t){this.nodePool=new o({size:16}),this.islandPool=new r({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}t("../math/vec2"),t("./Island"),t("./IslandNode");var o=t("./../utils/IslandNodePool"),r=t("./../utils/IslandPool"),a=t("../objects/Body");e.exports=n,n.getUnvisitedNode=function(t){for(var e=t.length,i=0;i!==e;i++){var n=t[i];if(!n.visited&&n.body.type===a.DYNAMIC)return n}return!1},n.prototype.visit=function(t,e,i){e.push(t.body);for(var n=t.equations.length,o=0;o!==n;o++){var r=t.equations[o];-1===i.indexOf(r)&&i.push(r)}},n.prototype.bfs=function(t,e,i){var o=this.queue;for(o.length=0,o.push(t),t.visited=!0,this.visit(t,e,i);o.length;)for(var r,s=o.pop();r=n.getUnvisitedNode(s.neighbors);)r.visited=!0,this.visit(r,e,i),r.body.type===a.DYNAMIC&&o.push(r)},n.prototype.split=function(t){for(var e=t.bodies,i=this.nodes,o=this.equations;i.length;)this.nodePool.release(i.pop());for(l=0;l!==e.length;l++){var r=this.nodePool.get();r.body=e[l],i.push(r)}for(var a=0;a!==o.length;a++){var s=o[a],l=e.indexOf(s.bodyA),c=e.indexOf(s.bodyB),h=i[l],p=i[c];h.neighbors.push(p),p.neighbors.push(h),h.equations.push(s),p.equations.push(s)}for(var u=this.islands,l=0;l<u.length;l++)this.islandPool.release(u[l]);u.length=0;for(var d;d=n.getUnvisitedNode(i);){var f=this.islandPool.get();this.bfs(d,f.bodies,f.equations),u.push(f)}return u}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(t,e,i){function n(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}e.exports=n,n.prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(t,e,i){function n(t){p.apply(this),t=t||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=t.solver||new o,this.narrowphase=new y(this),this.islandManager=new w,this.gravity=r.fromValues(0,-9.78),t.gravity&&r.copy(this.gravity,t.gravity),this.frictionGravity=r.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=t.broadphase||new g,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new d,this.defaultContactMaterial=new f(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit=void 0===t.islandSplit||!!t.islandSplit,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=n.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new b}var o=t("../solver/GSSolver"),r=(t("../solver/Solver"),t("../collision/Ray"),t("../math/vec2")),a=t("../shapes/Circle"),s=t("../shapes/Convex"),l=(t("../shapes/Line"),t("../shapes/Plane")),c=t("../shapes/Capsule"),h=t("../shapes/Particle"),p=t("../events/EventEmitter"),u=t("../objects/Body"),d=(t("../shapes/Shape"),t("../objects/LinearSpring"),t("../material/Material")),f=t("../material/ContactMaterial"),m=(t("../constraints/DistanceConstraint"),t("../constraints/Constraint"),t("../constraints/LockConstraint"),t("../constraints/RevoluteConstraint"),t("../constraints/PrismaticConstraint"),t("../constraints/GearConstraint"),t("../../package.json"),t("../collision/Broadphase"),t("../collision/AABB")),g=t("../collision/SAPBroadphase"),y=t("../collision/Narrowphase"),v=t("../utils/Utils"),b=t("../utils/OverlapKeeper"),w=t("./IslandManager");t("../objects/RotationalSpring");e.exports=n,n.prototype=new Object(p.prototype),n.prototype.constructor=n,n.NO_SLEEPING=1,n.BODY_SLEEPING=2,n.ISLAND_SLEEPING=4,n.prototype.addConstraint=function(t){this.constraints.push(t)},n.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},n.prototype.removeContactMaterial=function(t){var e=this.contactMaterials.indexOf(t);-1!==e&&v.splice(this.contactMaterials,e,1)},n.prototype.getContactMaterial=function(t,e){for(var i=this.contactMaterials,n=0,o=i.length;n!==o;n++){var r=i[n];if(r.materialA.id===t.id&&r.materialB.id===e.id||r.materialA.id===e.id&&r.materialB.id===t.id)return r}return!1},n.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&v.splice(this.constraints,e,1)};r.create(),r.create(),r.create(),r.create(),r.create(),r.create();var x=r.create(),_=r.fromValues(0,0),S=r.fromValues(0,0);r.fromValues(0,0),r.fromValues(0,0);n.prototype.step=function(t,e,i){if(i=i||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var n=0;this.accumulator>=t&&n<i;)this.internalStep(t),this.time+=t,this.accumulator-=t,n++;for(var o=this.accumulator%t/t,a=0;a!==this.bodies.length;a++){var s=this.bodies[a];r.lerp(s.interpolatedPosition,s.previousPosition,s.position,o),s.interpolatedAngle=s.previousAngle+o*(s.angle-s.previousAngle)}}};var T=[];n.prototype.internalStep=function(t){this.stepping=!0;var e=this.springs.length,i=this.springs,o=this.bodies,a=this.gravity,s=this.solver,l=this.bodies.length,c=this.broadphase,h=this.narrowphase,p=this.constraints,d=x,f=(r.scale,r.add),m=(r.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity){var g=r.length(this.gravity);0===g&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=g)}if(this.applyGravity)for(S=0;S!==l;S++){var y=(b=o[S]).force;b.type===u.DYNAMIC&&b.sleepState!==u.SLEEPING&&(r.scale(d,a,b.mass*b.gravityScale),f(y,y,d))}if(this.applySpringForces)for(S=0;S!==e;S++)i[S].applyForce();if(this.applyDamping)for(S=0;S!==l;S++){var b=o[S];b.type===u.DYNAMIC&&b.applyDamping(t)}for(var w=c.getCollisionPairs(this),_=this.disabledBodyCollisionPairs,S=_.length-2;S>=0;S-=2)for(C=w.length-2;C>=0;C-=2)(_[S]===w[C]&&_[S+1]===w[C+1]||_[S+1]===w[C]&&_[S]===w[C+1])&&w.splice(C,2);q=p.length;for(S=0;S!==q;S++){var P=p[S];if(!P.collideConnected)for(var C=w.length-2;C>=0;C-=2)(P.bodyA===w[C]&&P.bodyB===w[C+1]||P.bodyB===w[C]&&P.bodyA===w[C+1])&&w.splice(C,2)}this.postBroadphaseEvent.pairs=w,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,h.reset(this);for(var S=0,I=w.length;S!==I;S+=2)for(var k=w[S],A=w[S+1],M=0,O=k.shapes.length;M!==O;M++)for(var R=k.shapes[M],B=R.position,G=R.angle,E=0,D=A.shapes.length;E!==D;E++){var L=A.shapes[E],j=L.position,F=L.angle,N=this.defaultContactMaterial;if(R.material&&L.material){var X=this.getContactMaterial(R.material,L.material);X&&(N=X)}this.runNarrowphase(h,k,R,B,G,A,L,j,F,N,this.frictionGravity)}for(S=0;S!==l;S++)(z=o[S])._wakeUpAfterNarrowphase&&(z.wakeUp(),z._wakeUpAfterNarrowphase=!1);if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(T);for(var U=this.endContactEvent,E=T.length;E--;){var V=T[E];U.shapeA=V.shapeA,U.shapeB=V.shapeB,U.bodyA=V.bodyA,U.bodyB=V.bodyB,this.emit(U)}T.length=0}var H=this.preSolveEvent;H.contactEquations=h.contactEquations,H.frictionEquations=h.frictionEquations,this.emit(H),H.contactEquations=H.frictionEquations=null;var q=p.length;for(S=0;S!==q;S++)p[S].update();if(h.contactEquations.length||h.frictionEquations.length||q)if(this.islandSplit){for(m.equations.length=0,v.appendArray(m.equations,h.contactEquations),v.appendArray(m.equations,h.frictionEquations),S=0;S!==q;S++)v.appendArray(m.equations,p[S].equations);m.split(this);for(S=0;S!==m.islands.length;S++)(K=m.islands[S]).equations.length&&s.solveIsland(t,K)}else{for(s.addEquations(h.contactEquations),s.addEquations(h.frictionEquations),S=0;S!==q;S++)s.addEquations(p[S].equations);this.solveConstraints&&s.solve(t,this),s.removeAllEquations()}for(S=0;S!==l;S++){var z=o[S];z.integrate(t)}for(S=0;S!==l;S++)o[S].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(var W=this.impactEvent,S=0;S!==h.contactEquations.length;S++){var Y=h.contactEquations[S];Y.firstImpact&&(W.bodyA=Y.bodyA,W.bodyB=Y.bodyB,W.shapeA=Y.shapeA,W.shapeB=Y.shapeB,W.contactEquation=Y,this.emit(W))}if(this.sleepMode===n.BODY_SLEEPING)for(S=0;S!==l;S++)o[S].sleepTick(this.time,!1,t);else if(this.sleepMode===n.ISLAND_SLEEPING&&this.islandSplit){for(S=0;S!==l;S++)o[S].sleepTick(this.time,!0,t);for(S=0;S<this.islandManager.islands.length;S++){var K=this.islandManager.islands[S];K.wantsToSleep()&&K.sleep()}}this.stepping=!1;for(var Q=this.bodiesToBeRemoved,S=0;S!==Q.length;S++)this.removeBody(Q[S]);Q.length=0,this.emit(this.postStepEvent)},n.prototype.runNarrowphase=function(t,e,i,n,o,a,s,l,c,h,p){if(0!=(i.collisionGroup&s.collisionMask)&&0!=(s.collisionGroup&i.collisionMask)){r.rotate(_,n,e.angle),r.rotate(S,l,a.angle),r.add(_,_,e.position),r.add(S,S,a.position);var d=o+e.angle,f=c+a.angle;t.enableFriction=h.friction>0,t.frictionCoefficient=h.friction;var m;m=e.type===u.STATIC||e.type===u.KINEMATIC?a.mass:a.type===u.STATIC||a.type===u.KINEMATIC?e.mass:e.mass*a.mass/(e.mass+a.mass),t.slipForce=h.friction*p*m,t.restitution=h.restitution,t.surfaceVelocity=h.surfaceVelocity,t.frictionStiffness=h.frictionStiffness,t.frictionRelaxation=h.frictionRelaxation,t.stiffness=h.stiffness,t.relaxation=h.relaxation,t.contactSkinSize=h.contactSkinSize,t.enabledEquations=e.collisionResponse&&a.collisionResponse&&i.collisionResponse&&s.collisionResponse;var g=t[i.type|s.type],y=0;if(g){var v=i.sensor||s.sensor,b=t.frictionEquations.length;y=i.type<s.type?g.call(t,e,i,_,d,a,s,S,f,v):g.call(t,a,s,S,f,e,i,_,d,v);var w=t.frictionEquations.length-b;if(y){if(e.allowSleep&&e.type===u.DYNAMIC&&e.sleepState===u.SLEEPING&&a.sleepState===u.AWAKE&&a.type!==u.STATIC&&r.squaredLength(a.velocity)+Math.pow(a.angularVelocity,2)>=2*Math.pow(a.sleepSpeedLimit,2)&&(e._wakeUpAfterNarrowphase=!0),a.allowSleep&&a.type===u.DYNAMIC&&a.sleepState===u.SLEEPING&&e.sleepState===u.AWAKE&&e.type!==u.STATIC&&r.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2)>=2*Math.pow(e.sleepSpeedLimit,2)&&(a._wakeUpAfterNarrowphase=!0),this.overlapKeeper.setOverlapping(e,i,a,s),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(i,s)){var x=this.beginContactEvent;if(x.shapeA=i,x.shapeB=s,x.bodyA=e,x.bodyB=a,x.contactEquations.length=0,"number"==typeof y)for(T=t.contactEquations.length-y;T<t.contactEquations.length;T++)x.contactEquations.push(t.contactEquations[T]);this.emit(x)}if("number"==typeof y&&w>1)for(var T=t.frictionEquations.length-w;T<t.frictionEquations.length;T++){var P=t.frictionEquations[T];P.setSlipForce(P.getSlipForce()/w)}}}}},n.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},n.prototype.removeSpring=function(t){var e=this.springs.indexOf(t);-1!==e&&v.splice(this.springs,e,1)},n.prototype.addBody=function(t){if(-1===this.bodies.indexOf(t)){this.bodies.push(t),t.world=this;var e=this.addBodyEvent;e.body=t,this.emit(e),e.body=null}},n.prototype.removeBody=function(t){if(this.stepping)this.bodiesToBeRemoved.push(t);else{t.world=null;var e=this.bodies.indexOf(t);-1!==e&&(v.splice(this.bodies,e,1),this.removeBodyEvent.body=t,t.resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},n.prototype.getBodyById=function(t){for(var e=this.bodies,i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return!1},n.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},n.prototype.enableBodyCollision=function(t,e){for(var i=this.disabledBodyCollisionPairs,n=0;n<i.length;n+=2)if(i[n]===t&&i[n+1]===e||i[n+1]===t&&i[n]===e)return void i.splice(n,2)},n.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;e>=0;e--)this.removeConstraint(t[e]);for(var i=this.bodies,e=i.length-1;e>=0;e--)this.removeBody(i[e]);for(var o=this.springs,e=o.length-1;e>=0;e--)this.removeSpring(o[e]);for(var r=this.contactMaterials,e=r.length-1;e>=0;e--)this.removeContactMaterial(r[e]);n.apply(this)};var P=r.create(),C=(r.fromValues(0,0),r.fromValues(0,0));n.prototype.hitTest=function(t,e,i){i=i||0;var n=new u({position:t}),o=new h,p=t,d=P,f=C;n.addShape(o);for(var m=this.narrowphase,g=[],y=0,v=e.length;y!==v;y++)for(var b=e[y],w=0,x=b.shapes.length;w!==x;w++){var _=b.shapes[w];r.rotate(d,_.position,b.angle),r.add(d,d,b.position);var S=_.angle+b.angle;(_ instanceof a&&m.circleParticle(b,_,d,S,n,o,p,0,!0)||_ instanceof s&&m.particleConvex(n,o,p,0,b,_,d,S,!0)||_ instanceof l&&m.particlePlane(n,o,p,0,b,_,d,S,!0)||_ instanceof c&&m.particleCapsule(n,o,p,0,b,_,d,S,!0)||_ instanceof h&&r.squaredLength(r.sub(f,d,t))<i*i)&&g.push(b)}return g},n.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,i=0;i!==e.length;i++)for(var n=e[i],o=0;o!==n.equations.length;o++){var r=n.equations[o];r.stiffness=t,r.needsUpdate=!0}for(var a=this.contactMaterials,i=0;i!==a.length;i++)(n=a[i]).stiffness=n.frictionStiffness=t;(n=this.defaultContactMaterial).stiffness=n.frictionStiffness=t},n.prototype.setGlobalRelaxation=function(t){for(o=0;o!==this.constraints.length;o++)for(var e=this.constraints[o],i=0;i!==e.equations.length;i++){var n=e.equations[i];n.relaxation=t,n.needsUpdate=!0}for(var o=0;o!==this.contactMaterials.length;o++)(e=this.contactMaterials[o]).relaxation=e.frictionRelaxation=t;(e=this.defaultContactMaterial).relaxation=e.frictionRelaxation=t};var I=new m,k=[];n.prototype.raycast=function(t,e){return e.getAABB(I),this.broadphase.aabbQuery(this,I,k),e.intersectBodies(t,k),k.length=0,t.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)});var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),DisplayObjectContainer=function(t){function e(){var e=t.call(this)||this;return e.items={},e.neverFlush=!1,e.origX=0,e.origY=0,e.origPivot={x:0,y:0,compensate:!1},e.defaultPivot=!0,e.pooled=!1,e.pooledActive=!1,e}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),this.addItem(e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.addChildAt=function(e,i){t.prototype.addChildAt.call(this,e,i),this.addItem(e)},e.prototype.addItem=function(t){this.items[t.id]=t},e.prototype.removeFromItems=function(t){delete this.items[t.id]},e.prototype.getSpriteAt=function(t){var e=this.getChildAt(t);return this.resetItem(e)},e.prototype.showOnlyChild=function(t){Game.displayStore.showOnlyChild(this,t)},e.prototype.getSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSpine=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getAnimatedSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.resetItem=function(t){return Game.displayStore.resetRetrievedItem(t)},e.prototype.getItemAt=function(t){return this.getChildAt(t)},e.prototype.disposeAssets=function(){Game.displayStore.disposeContainerAssets(this)},e.prototype.removeAllChildren=function(){Game.displayStore.removeContainerChildren(this)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPointContainer(this,t,e,i)},e.prototype.setRegPointPixels=function(t,e,i){Game.displayStore.setRegPointContainerPixels(this,t,e,i)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0)},e}(PIXI.Container),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),DisplayObjectContainer2s=function(t){function e(){var e=t.call(this)||this;return e.items={},e.neverFlush=!1,e.origX=0,e.origY=0,e.origPivot={x:0,y:0,compensate:!1},e.defaultPivot=!0,e.pooled=!1,e.pooledActive=!1,e}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),this.addItem(e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.addChildAt=function(e,i){t.prototype.addChildAt.call(this,e,i),this.addItem(e)},e.prototype.addItem=function(t){this.items[t.id]=t},e.prototype.removeFromItems=function(t){delete this.items[t.id]},e.prototype.getSpriteAt=function(t){var e=this.getChildAt(t);return this.resetItem(e)},e.prototype.showOnlyChild=function(t){Game.displayStore.showOnlyChild(this,t)},e.prototype.getSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSpine=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getAnimatedSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.resetItem=function(t){return Game.displayStore.resetRetrievedItem(t)},e.prototype.getItemAt=function(t){return this.getChildAt(t)},e.prototype.disposeAssets=function(){Game.displayStore.disposeContainerAssets(this)},e.prototype.removeAllChildren=function(){Game.displayStore.removeContainerChildren(this)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPointContainer(this,t,e,i)},e.prototype.setRegPointPixels=function(t,e,i){Game.displayStore.setRegPointContainerPixels(this,t,e,i)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0)},e}(PIXI.projection.Container2s),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),DisplayObjectContainer2d=function(t){function e(){var e=t.call(this)||this;return e.items={},e.neverFlush=!1,e.origX=0,e.origY=0,e.origPivot={x:0,y:0,compensate:!1},e.defaultPivot=!0,e.pooled=!1,e.pooledActive=!1,e}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),this.addItem(e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.addChildAt=function(e,i){t.prototype.addChildAt.call(this,e,i),this.addItem(e)},e.prototype.addItem=function(t){this.items[t.id]=t},e.prototype.removeFromItems=function(t){delete this.items[t.id]},e.prototype.getSpriteAt=function(t){var e=this.getChildAt(t);return this.resetItem(e)},e.prototype.showOnlyChild=function(t){Game.displayStore.showOnlyChild(this,t)},e.prototype.getSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSpine=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getAnimatedSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.resetItem=function(t){return Game.displayStore.resetRetrievedItem(t)},e.prototype.getItemAt=function(t){return this.getChildAt(t)},e.prototype.disposeAssets=function(){Game.displayStore.disposeContainerAssets(this)},e.prototype.removeAllChildren=function(){Game.displayStore.removeContainerChildren(this)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPointContainer(this,t,e,i)},e.prototype.setRegPointPixels=function(t,e,i){Game.displayStore.setRegPointContainerPixels(this,t,e,i)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0)},e}(PIXI.projection.Container2d),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),DisplayObjectContainer3d=function(t){function e(){var e=t.call(this)||this;return e.items={},e.neverFlush=!1,e.origX=0,e.origY=0,e.origPivot={x:0,y:0,compensate:!1},e.defaultPivot=!0,e.pooled=!1,e.pooledActive=!1,e}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),this.addItem(e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.addChildAt=function(e,i){t.prototype.addChildAt.call(this,e,i),this.addItem(e)},e.prototype.addItem=function(t){this.items[t.id]=t},e.prototype.removeFromItems=function(t){delete this.items[t.id]},e.prototype.getSpriteAt=function(t){var e=this.getChildAt(t);return this.resetItem(e)},e.prototype.showOnlyChild=function(t){Game.displayStore.showOnlyChild(this,t)},e.prototype.getSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSprite3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer2s=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getContainer3d=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getSpine=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.getAnimatedSprite=function(t){var e=this.items[t];return this.resetItem(e)},e.prototype.resetItem=function(t){return Game.displayStore.resetRetrievedItem(t)},e.prototype.getItemAt=function(t){return this.getChildAt(t)},e.prototype.disposeAssets=function(){Game.displayStore.disposeContainerAssets(this)},e.prototype.removeAllChildren=function(){Game.displayStore.removeContainerChildren(this)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPointContainer(this,t,e,i)},e.prototype.setRegPointPixels=function(t,e,i){Game.displayStore.setRegPointContainerPixels(this,t,e,i)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0)},e}(PIXI.projection.Container3d);((_gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window)._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";var t=Math.PI/180,e=function(t,e,i,n,o){this.p=e,this.f="function"==typeof t[e],this.start=this.value=this.f?t[e.indexOf("set")||"function"!=typeof t["get"+e.substr(3)]?e:"get"+e.substr(3)]():parseFloat(t[e]),this.velocity=i||0,this.v=this.velocity/o,n||0===n?(this.acceleration=n,this.a=this.acceleration/(o*o)):this.acceleration=this.a=0},i=Math.random(),n=_gsScope._gsDefine.globals,o=n.com.greensock.core.Animation._rootFramesTimeline,r=_gsScope._gsDefine.plugin({propName:"physics2D",version:"0.2.0",API:2,init:function(i,n,r,a){"function"==typeof n&&(n=n(a,i)),this._target=i,this._tween=r,this._runBackwards=!0===r.vars.runBackwards,this._step=0;for(var s,l=r._timeline,c=Number(n.angle)||0,h=Number(n.velocity)||0,p=Number(n.acceleration)||0,u=n.xProp||"x",d=n.yProp||"y",f=n.accelerationAngle||0===n.accelerationAngle?Number(n.accelerationAngle):c;l._timeline;)l=l._timeline;return this._stepsPerTimeUnit=s=l===o?1:30,n.gravity&&(p=Number(n.gravity),f=90),c*=t,f*=t,this._friction=1-Number(n.friction||0),this._overwriteProps.push(u),this._overwriteProps.push(d),this._x=new e(i,u,Math.cos(c)*h,Math.cos(f)*p,s),this._y=new e(i,d,Math.sin(c)*h,Math.sin(f)*p,s),this._skipX=this._skipY=!1,!0},set:function(t){var e,i,n,o,r,a,s=this._tween._time,l=this._x,c=this._y;if(!0===this._runBackwards&&(s=this._tween._duration-s),1===this._friction)n=s*s*.5,e=l.start+(l.velocity*s+l.acceleration*n),i=c.start+(c.velocity*s+c.acceleration*n);else{if(s*=this._stepsPerTimeUnit,o=a=(0|s)-this._step,r=s%1,a>=0)for(;--a>-1;)l.v+=l.a,c.v+=c.a,l.v*=this._friction,c.v*=this._friction,l.value+=l.v,c.value+=c.v;else for(a=-a;--a>-1;)l.value-=l.v,c.value-=c.v,l.v/=this._friction,c.v/=this._friction,l.v-=l.a,c.v-=c.a;e=l.value+l.v*r,i=c.value+c.v*r,this._step+=o}this._skipX||(l.m&&(e=l.m(e,this._target)),l.f?this._target[l.p](e):this._target[l.p]=e),this._skipY||(c.m&&(i=c.m(i,this._target)),c.f?this._target[c.p](i):this._target[c.p]=i)}}),a=r.prototype;a._kill=function(t){return null!=t[this._x.p]&&(this._skipX=!0),null!=t[this._y.p]&&(this._skipY=!0),this._super._kill.call(this,t)},a._mod=function(t){var e=t[this._x.p]||t.physics2D;e&&"function"==typeof e&&(this._x.m=e),(e=t[this._y.p]||t.physics2D)&&"function"==typeof e&&(this._y.m=e)},r._autoCSS=!0,r._cssRegister=function(){var t=n.CSSPlugin;if(t){var e=t._internals,o=e._parseToProxy,a=e._setPluginRatio,s=e.CSSPropTween;e._registerComplexSpecialProp("physics2D",{parser:function(t,e,n,l,c,h){h=new r;var p,u=e.xProp||"x",d=e.yProp||"y",f={};return f[u]=f[d]=i++,p=o(t,f,l,c,h),c=new s(t,"physics2D",0,0,p.pt,2),c.data=p,c.plugin=h,c.setRatio=a,h._onInitTween(p.proxy,e,l._tween),c}})}}}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t){"use strict";var e=function(){return(_gsScope.GreenSockGlobals||_gsScope).Physics2DPlugin};"function"==typeof define&&define.amd?define(["TweenLite"],e):"undefined"!=typeof module&&module.exports&&(require("../TweenLite.js"),module.exports=e())}();var visualAssets={"initial-loading-assets":[{id:"preloader/loading-font",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",pool:3,alphabet:"latin"},{id:"preloader/loading-font",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"preloader-bar",anchor:[.5,.5],children:[{id:"bar-fill",url:"ui/preloader-bar.png",x:22,y:22}]},{id:"preloader/background",url:"preloader/background.png",anchor:[0,0]},{id:"preloader/background-bottom",url:"preloader/background-bottom.png",anchor:[0,1]},{id:"preloader/pattern",url:"preloader/pattern.png",anchor:[1,1]},{id:"preloader/pattern-front",url:"preloader/pattern-front.png",anchor:[1,1]},{id:"preloader/logo",url:"preloader/logo.png",anchor:[.5,.5]},{id:"preloader/tom-arm",url:"preloader/tom-arm.png",anchor:[.5,0]},{id:"preloader/jerry-arm",url:"preloader/jerry-arm.png",anchor:[.5,0]},{id:"preloader/scooby-arm",url:"preloader/scooby-arm.png",anchor:[.5,0]},{id:"preloader/shaggy-arm",url:"preloader/shaggy-arm.png",anchor:[.5,0]},{id:"preloader/duck-arm",url:"preloader/duck-arm.png",anchor:[.5,0]},{id:"preloader/bugs-arm",url:"preloader/bugs-arm.png",anchor:[.5,0]},{url:"preloader/preloader-gradient-element.png",anchor:[.5,.5],retina:!1},{url:"preloader/preloader-pattern.png",pool:2}],global:[{neverFlush:!0},{id:"global/tracker",url:"global/magenta.png",anchor:[.5,.5],projection:"3d",retina:!1},{url:"global/magenta.png",anchor:[0,0],retina:!1},{url:"global/pixel.png",anchor:[.5,.5],retina:!1,pool:100},{id:"global/prompt",children:[{id:"global/prompt-panel-bg",children:[{url:"global/prompt-bg.png",anchor:[.5,.5]},{url:"global/prompt-bg-tall.png",anchor:[.5,.5]}]},{url:"global/swap-arrows.png",anchor:[.5,.5],y:30}]},{id:"global/particles-container",children:[]},{id:"global/prompt-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"global/prompt-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"global/prompt-coins-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"global/prompt-coins-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"global/prompt-coins-icon",url:"craft-scene/player-coin-icon.png",anchor:[.5,.5]},{id:"global/achievements-panel-container",children:[{id:"global/achievements-character-container",children:[{id:"global/team-tom",url:"global/team-tom.png",anchor:[.5,1]},{id:"global/team-scooby",url:"global/team-scooby.png",anchor:[.5,1]},{id:"global/team-bugs",url:"global/team-bugs.png",anchor:[.5,1]},{id:"global/team-tweety",url:"global/team-tweety.png",anchor:[.5,1]},{id:"global/team-wile",url:"global/team-wile.png",anchor:[.5,1]}]},{id:"global/achievements-panel-icon-shadow",url:"global/achievements-icon.png",anchor:[.5,.4],x:81,y:-61},{id:"global/achievements-panel-icon",url:"global/achievements-icon.png",anchor:[.5,.4],x:80,y:-64}]},{id:"global/achievements-panel-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"global/achievements-panel-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"blank-element",url:"global/blank.png",retina:!1},{id:"pause-screen-overlay-container",children:[{url:"global/pause-bg.png",anchor:[.5,.5],x:510,y:313}]},{id:"pause-overlay",url:"ui/paused-overlay.png",retina:!1},{url:"global/black-square.png",retina:!1},{id:"global/unlocked-achievement-bg",children:[{url:"global/unlocked-achievement-bg.png"},{id:"global/unlocked-achievement-icon-holder",children:[]}]},{id:"global/unlocked-achievement-title",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"global/unlocked-achievement-body",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:15},{id:"global/unlocked-achievement-title",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"global/unlocked-achievement-body",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic",pool:15},{id:"global/lock-icon-container",children:[{id:"global/lock-icon",url:"craft-scene/lock-icon.png",anchor:[.5,.5]},{id:"global/lock-icon-unlocked",url:"craft-scene/lock-icon-unlocked.png",anchor:[.5,.5]}]},{id:"global/achievements-icon",children:[{id:"global/achievements-icon-shadow",url:"global/achievements-icon.png",x:1,y:3,anchor:[.5,.4]},{id:"global/achievements-icon-inner",url:"global/achievements-icon.png",anchor:[.5,.4]}]}],"title-assets":[{id:"title-scene/blank-input",url:"title-scene/blank-input.png"},{id:"title-scene/main-container",children:[]},{id:"title-scene/foreground-container",children:[]},{id:"title-scene/background-container",children:[{id:"title-scene/shaggy-container",children:[{id:"title-scene/shaggy",url:"title-scene/shaggy.png",anchor:[.5,1]},{id:"title-scene/shaggy-blink",url:"title-scene/shaggy-blink.png",anchor:[.5,1]}]},{id:"title-scene/scooby-container",children:[{id:"title-scene/scooby",url:"title-scene/scooby.png",anchor:[.5,1]},{id:"title-scene/scooby-blink",url:"title-scene/scooby-blink.png",anchor:[.5,1]}]},{id:"title-scene/silvestre-container",children:[{id:"title-scene/silvestre",url:"title-scene/silvestre.png",anchor:[.5,1]},{id:"title-scene/silvestre-blink",url:"title-scene/silvestre-blink.png",anchor:[.5,1]}]},{id:"title-scene/road-runner-container",children:[{id:"title-scene/road-runner",url:"title-scene/road-runner-blink.png",anchor:[.5,1]},{id:"title-scene/road-runner-blink",url:"title-scene/road-runner.png",anchor:[.5,1]}]},{id:"title-scene/bugs-container",children:[{id:"title-scene/bugs",url:"title-scene/bugs.png",anchor:[.5,1]},{id:"title-scene/bugs-blink",url:"title-scene/bugs-blink.png",anchor:[.5,1]}]},{id:"title-scene/wile-container",children:[{id:"title-scene/wile",url:"title-scene/wile.png",anchor:[.5,1]},{id:"title-scene/wile-blink",url:"title-scene/wile-blink.png",anchor:[.5,1]}]},{id:"title-scene/duck-container",children:[{id:"title-scene/duck",url:"title-scene/duck.png",anchor:[.5,1]},{id:"title-scene/duck-blink",url:"title-scene/duck-blink.png",anchor:[.5,1]}]},{id:"title-scene/tom-and-jerry-container",children:[{id:"title-scene/tom-container",children:[{id:"title-scene/tom",url:"title-scene/tom.png",anchor:[.5,1]},{id:"title-scene/tom-blink",url:"title-scene/tom-blink.png",anchor:[.5,1]}]},{id:"title-scene/jerry-container",children:[{id:"title-scene/jerry",url:"title-scene/jerry.png",anchor:[.5,1]},{id:"title-scene/jerry-blink",url:"title-scene/jerry-blink.png",anchor:[.5,1]}]}]}]},{id:"title-scene/tweety-container",children:[{id:"title-scene/tweety-body-1",url:"title-scene/tweety-body-1.png",x:0,y:0},{id:"title-scene/tweety-body-2",url:"title-scene/tweety-body-2.png",x:0,y:0},{id:"title-scene/tweety-body-3",url:"title-scene/tweety-body-3.png",x:0,y:0},{id:"title-scene/tweety-head-container",children:[{id:"title-scene/tweety-head",url:"title-scene/tweety-head.png",x:0,y:0,anchor:[.1,.9]},{id:"title-scene/tweety-head-blink",url:"title-scene/tweety-head-blink.png",x:0,y:0,anchor:[.1,.9]}]}],anchor:[.6,.1]},{id:"title-scene/car-container",children:[],pool:5},{id:"title-scene/coin-container",children:[],pool:5},{id:"title-scene/bomb-container",children:[],pool:5},{id:"title-scene/bomb-frames",anchor:[.5,1],type:"spritesheet",dir:"race-scene/bomb",atlas:"bomb.json",pool:3,frames:[]},{id:"title-scene/coin",url:"title-scene/coin.png",anchor:[.5,.5],pool:5},{id:"title-scene/bomb",url:"title-scene/bomb.png",pool:5,anchor:[.4,.5]},{id:"title-scene/shine",url:"title-scene/shine.png",pool:5,anchor:[.5,.5]},{id:"title-scene/shadow",url:"title-scene/coin-shadow.png",anchor:[.5,.5],pool:10},{id:"title-scene/ramp",url:"title-scene/ramp.png",anchor:[.5,1]},{id:"title-scene/logo",url:"title-scene/fg-logo.png",anchor:[.5,1]},{id:"title-scene/play-button",url:"title-scene/play-button.png",x:0,y:0,anchor:[.5,.5]},{id:"title-scene/car-1",url:"title-scene/car-1.png",x:0,y:0},{id:"title-scene/car-2",url:"title-scene/car-2.png",x:0,y:0},{id:"title-scene/car-3",url:"title-scene/car-3.png",x:0,y:0},{id:"title-scene/car-4",url:"title-scene/car-2.png",x:0,y:0},{id:"title-scene/car-5",url:"title-scene/car-1.png",x:0,y:0},{id:"title-scene/wheel-1",url:"title-scene/wheel-1.png",x:0,y:0,pool:10,anchor:[.5,.5]},{id:"title-scene/wheel-2",url:"title-scene/wheel-2.png",x:0,y:0,pool:10,anchor:[.5,.5]},{id:"title-scene/wheel-3",url:"title-scene/wheel-3.png",x:0,y:0,pool:10,anchor:[.5,.5]},{id:"title-scene/wheel-4",url:"title-scene/wheel-2.png",x:0,y:0,pool:10,anchor:[.5,.5]},{id:"title-scene/wheel-5",url:"title-scene/wheel-1.png",x:0,y:0,pool:10,anchor:[.5,.5]},{id:"title-scene/background",url:"title-scene/background-2.png",x:0,y:0},{id:"title-scene/background-shine",url:"title-scene/background-shine.png",x:0,y:0,anchor:[.5,.6]},{id:"title-scene/front-wall",url:"title-scene/front-wall.png",x:0,y:0,anchor:[.5,1]},{id:"title-scene/back-wall",url:"title-scene/back-wall.png",x:0,y:0,anchor:[.5,1]},{id:"title-scene/road",url:"title-scene/road.png",x:0,y:0,anchor:[.5,1]},{id:"title-scene/cactus-1",url:"title-scene/cactus-1.png",x:0,y:0,anchor:[.5,1],pool:10},{id:"title-scene/cactus-2",url:"title-scene/cactus-2.png",x:0,y:0,anchor:[.5,1],pool:10},{id:"title-scene/bush-1",url:"title-scene/bush-1.png",x:0,y:0,anchor:[.5,1],pool:10},{id:"title-scene/bush-2",url:"title-scene/bush-2.png",x:0,y:0,anchor:[.5,1],pool:10},{id:"title-scene/bush-3",url:"title-scene/bush-3.png",x:0,y:0,anchor:[.5,1],pool:10},{id:"title-scene/bush-4",url:"title-scene/bush-4.png",x:0,y:0,anchor:[.5,1],pool:10},{id:"title-scene/bush-4",url:"title-scene/bush-4.png",x:0,y:0,anchor:[.5,1],pool:10},{id:"title-scene/logo-holder",children:[{id:"title-scene/paper-background-1",url:"title-scene/paper-background.png",x:0,y:0},{id:"title-scene/paper-background-2",url:"title-scene/paper-background.png",x:0,y:0},{id:"title-scene/paint-background",url:"title-scene/paint-background.png",x:0,y:0},{id:"title-scene/paper-text",url:"title-scene/paper.png",x:0,y:0},{id:"title-scene/scissors",url:"title-scene/scissors.png",x:0,y:0},{id:"title-scene/wheel",url:"title-scene/wheel.png",x:0,y:0},{id:"title-scene/spanner",url:"title-scene/spanner.png",x:0,y:0,anchor:[.15,.9]},{id:"title-scene/wheel-smoke",url:"title-scene/wheel-smoke.png",x:0,y:0},{id:"title-scene/logo-racers-container",children:[{id:"title-scene/racers-r",url:"title-scene/racers-r.png",x:0,y:0},{id:"title-scene/racers-a",url:"title-scene/racers-a.png",x:0,y:0},{id:"title-scene/racers-c",url:"title-scene/racers-c.png",x:0,y:0},{id:"title-scene/racers-e",url:"title-scene/racers-e.png",x:0,y:0},{id:"title-scene/racers-r",url:"title-scene/racers-r2.png",x:0,y:0},{id:"title-scene/racers-s",url:"title-scene/racers-s.png",x:0,y:0}]}]}],"start-assets":[{id:"start-scene/stripe-container",children:[]},{id:"start-scene/stripe",url:"start-scene/stripe.png",anchor:[.1,.5]},{id:"start-scene/circle",url:"start-scene/circle.png",anchor:[.5,.5]},{id:"start-scene/coin",url:"craft-scene/player-coin-icon.png",anchor:[.5,.5],pool:4},{id:"start-scene/new-game-container",children:[{id:"start-scene/shadow",url:"start-scene/new-game-panel.png",anchor:[.5,.5],y:4},{id:"start-scene/new-game-panel",url:"start-scene/new-game-panel.png",anchor:[.5,.5]}]},{id:"start-scene/continue-container",children:[{id:"start-scene/shadow",url:"start-scene/continue-panel.png",anchor:[.5,.5],y:4},{id:"start-scene/continue-panel",url:"start-scene/continue-panel.png",anchor:[.5,.5]}]},{id:"start-scene/bg-container",children:[{id:"start-scene/bg-left",url:"craft-scene/bg.png"},{id:"start-scene/bg-right",url:"garage-scene/bg.png"}]},{id:"start-scene/or-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"start-scene/new-game-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"start-scene/continue-game-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"start-scene/new-game-coin-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"start-scene/new-game-coin-text-shadow",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"start-scene/continue-coin-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"start-scene/continue-coin-text-shadow",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"start-scene/or-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"start-scene/new-game-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"start-scene/continue-game-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"start-scene/new-game-coin-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"start-scene/new-game-coin-text-shadow",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"start-scene/continue-coin-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"start-scene/continue-coin-text-shadow",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"}],"carousel-menu-assets":[{id:"carousel-menu/tile-container",children:[],pool:10},{id:"carousel-menu/tile-inner-container",children:[],pool:10},{id:"carousel-menu/tile-strip",children:[]},{id:"carousel-menu/title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"carousel-menu/title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"carousel-menu/rope-container",children:[],pool:10},{url:"carousel-menu/rope-front.png",anchor:[.7,1],pool:10},{url:"carousel-menu/rope-back.png",anchor:[.1,1],pool:10},{id:"carousel-menu/highlight-corner-container",children:[]},{url:"carousel-menu/highlight-corner.png",pool:4},{id:"carousel-menu/point",url:"carousel-menu/point.png",retina:!1,anchor:[.5,.5],pool:10},{id:"carousel-menu/paperclip-back",url:"carousel-menu/paperclip-back.png",anchor:[.5,.5],pool:10},{id:"carousel-menu/paperclip-front",url:"carousel-menu/paperclip-front.png",anchor:[.5,.5],pool:10}],"select-team-assets":[{url:"select-team-scene/bg.png"},{id:"select-team-scene/tile-tom",url:"select-team-scene/tile-tom.png"},{id:"select-team-scene/tile-scooby",url:"select-team-scene/tile-scooby.png"},{id:"select-team-scene/tile-bugs",url:"select-team-scene/tile-bugs.png"},{id:"select-team-scene/tile-tweety",url:"select-team-scene/tile-tweety.png"},{id:"select-team-scene/tile-wile",url:"select-team-scene/tile-wile.png"},{id:"select-team-scene/achievements-panel",children:[],pool:5},{id:"select-team-scene/achievements-panel-bg",url:"select-team-scene/achievements-panel.png",anchor:[.1,.1],pool:5},{id:"select-team-scene/paperclip",url:"select-team-scene/paperclip.png",anchor:[.4,0],pool:5},{id:"select-team-scene/paperclip-back",url:"select-team-scene/paperclip-back.png",anchor:[.4,0],pool:5},{id:"select-team-scene/achievements-icon",url:"global/achievements-icon.png",pool:5,anchor:[.5,.4]},{id:"select-team-scene/achievements-icon-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:5},{id:"select-team-scene/achievements-icon-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic",pool:5}],"select-car-assets":[{url:"select-car-scene/bg.png"},{id:"select-car-scene/tile-pickup",url:"craft-scene/pickup.png",pool:2},{id:"select-car-scene/tile-beetle",url:"craft-scene/beetle.png",pool:2},{id:"select-car-scene/tile-van",url:"craft-scene/van.png",pool:2},{id:"select-car-scene/tile-bubble",url:"craft-scene/bubble.png",pool:2},{id:"select-car-scene/tile-gangster",url:"craft-scene/gangster.png",pool:2},{id:"select-car-scene/tile-truck",url:"craft-scene/truck.png",pool:2},{id:"select-car-scene/tile-cadillac",url:"craft-scene/cadillac.png",pool:2}],"select-track-assets":[{id:"select-track-scene/bg",url:"craft-scene/bg.png"},{id:"select-track-scene/title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"select-track-scene/title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"carousel-menu/highlight-corner-container",children:[]},{url:"carousel-menu/highlight-corner.png",pool:4},{id:"select-track-scene/bottom-panel",children:[{url:"select-track-scene/bottom-panel.png",anchor:[.5,1]},{id:"select-track-scene/rev-gauge",x:-166,y:-140,children:[{url:"select-track-scene/rev-gauge-green-1.png"},{url:"select-track-scene/rev-gauge-yellow-1.png",x:59,y:2},{url:"select-track-scene/rev-gauge-red-1.png",x:84.5,y:26}]},{id:"select-track-scene/rev-gauge-glows",x:-166,y:-140,children:[{url:"select-track-scene/rev-gauge-green-2.png"},{url:"select-track-scene/rev-gauge-yellow-2.png",x:59,y:2},{url:"select-track-scene/rev-gauge-red-2.png",x:84.5,y:26}]},{url:"select-track-scene/rev-needle.png",x:-120,y:-88,anchor:[.2,.5]}]},{id:"select-track-scene/coin-holder",children:[],pool:3},{url:"select-track-scene/coin-space.png",anchor:[.5,.5],pool:3},{id:"select-track-scene/coin",url:"craft-scene/player-coin-icon.png",anchor:[.5,.5],pool:3},{id:"select-track-scene/tile-strip",children:[{id:"select-track-scene/track-1",url:"select-track-scene/living-room.png",anchor:[.5,.5]},{id:"select-track-scene/track-2",url:"select-track-scene/bathroom.png",anchor:[.5,.5]},{id:"select-track-scene/track-3",url:"select-track-scene/garage.png",anchor:[.5,.5]}]},{id:"select-track-scene/tile-holder",children:[],pool:3},{id:"select-track-scene/panel-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:3},{id:"select-track-scene/panel-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic",pool:3}],"garage-assets":[{url:"garage-scene/bg.png"},{id:"garage-scene/tile-empty",url:"craft-scene/empty.png",pool:10},{url:"garage-scene/scissors.png",anchor:[.5,.5]},{url:"garage-scene/flag.png",anchor:[.5,.5]}],"achievements-assets":[{id:"achievements-scene/bg",url:"paint-scene/bg.png"},{id:"achievements-scene/title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"achievements-scene/title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"achievements-scene/panel",children:[],pool:15},{id:"achievements-scene/list-container",children:[]},{id:"achievements-scene/panel-bg",url:"achievements-scene/panel-bg.png",pool:15},{id:"achievements-scene/icon-container",children:[],pool:15},{id:"achievements-scene/icon-bg",url:"achievements-scene/icon-bg.png",pool:15,anchor:[.5,.5]},{id:"achievements-scene/icon-dark",url:"achievements-scene/icon-dark.png",pool:15,anchor:[.5,.5]},{id:"achievements-scene/achievements-icon",url:"global/achievements-icon.png",pool:15,anchor:[.5,.4],x:455,y:55},{id:"achievements-scene/achievement-title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:15},{id:"achievements-scene/achievement-title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic",pool:15},{id:"achievements-scene/achievement-description-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:15},{id:"achievements-scene/achievement-description-text",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic",pool:15},{id:"achievements-scene/lock-icon-container",children:[],pool:15},{id:"achievements-scene/lock-icon",url:"craft-scene/lock-icon.png",anchor:[.5,.5],pool:15},{id:"achievements-scene/lock-icon-unlocked",url:"craft-scene/lock-icon-unlocked.png",anchor:[.5,.5],pool:15},{id:"achievements-scene/blank-input",url:"craft-scene/blank-input.png",retina:!1}],"craft-assets":[{url:"craft-scene/blank-input.png",retina:!1},{id:"craft-scene/main-holder",children:[]},{url:"paint-scene/bg.png"},{id:"craft-scene/drag-layer",children:[]},{id:"craft-scene/car-container",children:[{id:"craft-scene/car-inner-container",children:[]}]},{url:"craft-scene/highlight-corner.png",pool:4},{url:"craft-scene/meter-bg.png",anchor:[.5,0],pool:6},{url:"craft-scene/meter-fg.png",anchor:[.5,0],pool:6},{id:"craft-scene/meter-container",children:[],pool:3},{id:"craft-scene/meters-container",children:[]},{id:"craft-scene/meter-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:3},{id:"craft-scene/coins-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:3},{id:"craft-scene/coins-text-shadow",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:3},{id:"craft-scene/meter-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic",pool:3},{id:"craft-scene/coins-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"arabic",pool:3},{id:"craft-scene/coins-text-shadow",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"arabic",pool:3},{id:"craft-scene/player-coins",x:170,y:42,children:[{url:"craft-scene/player-coins-bg.png"},{id:"craft-scene/player-coin-icon",x:52,y:42,children:[{id:"craft-scene/player-coin-icon-shadow",url:"craft-scene/player-coin-icon.png",anchor:[.5,.5]},{url:"craft-scene/player-coin-icon.png",anchor:[.5,.5]}]}]},{id:"craft-scene/price-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:20},{id:"craft-scene/price-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic",pool:20},{id:"craft-scene/price-icon",url:"craft-scene/player-coin-icon.png",anchor:[.5,.5],pool:20},{id:"craft-scene/undo-container",children:[]},{id:"craft-scene/output-container",children:[]},{id:"craft-scene/inner-output-container",children:[]},{id:"craft-scene/page-indicator-holder",children:[]},{id:"craft-scene/page-indicator",children:[],pool:10},{id:"craft-scene/page-indicator-empty",url:"craft-scene/page-indicator-empty.png",anchor:[.5,.5],pool:10},{id:"craft-scene/page-indicator-full",url:"craft-scene/page-indicator-full.png",anchor:[.5,.5],pool:10},{id:"craft-scene/page-indicator-highlight",url:"craft-scene/page-indicator-highlight.png",anchor:[.5,.5]},{id:"craft-scene/draggable-item-holder",pool:500,children:[]},{id:"craft-scene/attach-point",url:"craft-scene/attach-point.png",pool:5,anchor:[.5,.5]},{id:"craft-scene/attach-point-container",pool:5,children:[]},{id:"craft-scene/lock-icon",children:[],pool:50},{url:"craft-scene/lock-icon.png",anchor:[.5,.5],pool:50},{url:"craft-scene/lock-icon-unlocked.png",anchor:[.5,.5],pool:50},{id:"craft-scene/beetle",url:"craft-scene/beetle.png",pool:2},{id:"craft-scene/beetle-shadow",url:"craft-scene/beetle.png"},{id:"craft-scene/beetle-mask",url:"craft-scene/beetle-paint-mask.png",pool:2},{id:"craft-scene/beetle-mask-inverse",url:"craft-scene/beetle-inverse-mask.png"},{id:"craft-scene/van",url:"craft-scene/van.png",pool:2},{id:"craft-scene/van-shadow",url:"craft-scene/van.png"},{id:"craft-scene/van-mask",url:"craft-scene/van-paint-mask.png",pool:2},{id:"craft-scene/van-mask-inverse",url:"craft-scene/van-inverse-mask.png"},{id:"craft-scene/cadillac",url:"craft-scene/cadillac.png",pool:2},{id:"craft-scene/cadillac-shadow",url:"craft-scene/cadillac.png"},{id:"craft-scene/cadillac-mask",url:"craft-scene/cadillac-paint-mask.png",pool:2},{id:"craft-scene/cadillac-mask-inverse",url:"craft-scene/cadillac-inverse-mask.png"},{id:"craft-scene/bubble",url:"craft-scene/bubble.png",pool:2},{id:"craft-scene/bubble-shadow",url:"craft-scene/bubble.png"},{id:"craft-scene/bubble-mask",url:"craft-scene/bubble-paint-mask.png",pool:2},{id:"craft-scene/bubble-mask-inverse",url:"craft-scene/bubble-inverse-mask.png"},{id:"craft-scene/pickup",url:"craft-scene/pickup.png",pool:2},{id:"craft-scene/pickup-shadow",url:"craft-scene/pickup.png"},{id:"craft-scene/pickup-mask",url:"craft-scene/pickup-paint-mask.png",pool:2},{id:"craft-scene/pickup-mask-inverse",url:"craft-scene/pickup-inverse-mask.png"},{id:"craft-scene/truck",url:"craft-scene/truck.png",pool:2},{id:"craft-scene/truck-shadow",url:"craft-scene/truck.png"},{id:"craft-scene/truck-mask",url:"craft-scene/truck-paint-mask.png",y:10,pool:2},{id:"craft-scene/truck-mask-inverse",url:"craft-scene/truck-inverse-mask.png",y:-10},{id:"craft-scene/gangster",url:"craft-scene/gangster.png",pool:2},{id:"craft-scene/gangster-shadow",url:"craft-scene/gangster.png"},{id:"craft-scene/gangster-mask",url:"craft-scene/gangster-paint-mask.png",pool:2},{id:"craft-scene/gangster-mask-inverse",url:"craft-scene/gangster-inverse-mask.png"},{id:"craft-scene/car-mask-square",url:"craft-scene/black-square.png",retina:!1,pool:4},{id:"craft-scene/car-mask-square-holder",children:[]},{id:"craft-scene/tile-holder",children:[],pool:50},{id:"craft-scene/tile",url:"craft-scene/tile.png",anchor:[.5,.5],pool:50},{id:"craft-scene/tile-green-border",url:"craft-scene/tile-green-border.png",anchor:[.5,.5],pool:50},{id:"craft-scene/tile-touch-sprite",url:"craft-scene/blank-input.png",anchor:[.5,.5],retina:!1,pool:50},{id:"craft-scene/tiles-holder",children:[]}],"paint-assets":[{id:"paint-scene/title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"paint-scene/title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"paint-scene/panel-left-holder",x:34,y:148,children:[{id:"paint-scene/panel-left-backing-holder",children:[{id:"paint-scene/panel-left-shadow",url:"paint-scene/panel-left.png",y:6},{url:"paint-scene/panel-left.png"}]}]},{id:"paint-scene/panel-bottom-holder",x:395,y:488,children:[{id:"paint-scene/panel-bottom-shadow",url:"paint-scene/panel-bottom.png",y:6},{url:"paint-scene/panel-bottom.png"},{id:"paint-scene/panel-bottom-highlight-triangles-holder",y:10,children:[{id:"paint-scene/panel-bottom-highlight-triangle-top",url:"paint-scene/highlight-triangle.png",anchor:[.5,1]},{id:"paint-scene/panel-bottom-highlight-triangle-bottom",url:"paint-scene/highlight-triangle.png",anchor:[.5,1]}]}]},{id:"paint-scene/panel-right-holder",x:944,y:166,children:[{id:"paint-scene/panel-right-shadow",url:"paint-scene/panel-right.png",y:6},{url:"paint-scene/panel-right.png"},{id:"paint-scene/panel-right-highlight-triangle-holder",x:-30,children:[{id:"paint-scene/panel-right-highlight-triangle",url:"paint-scene/highlight-triangle.png",anchor:[.5,1]}]}]},{id:"paint-scene/swatch-container",children:[],pool:20},{id:"paint-scene/swatch-outer",url:"paint-scene/swatch-outer.png",anchor:[.5,.5],pool:16},{id:"paint-scene/swatch-outer-shadow",url:"paint-scene/swatch-outer.png",anchor:[.5,.5],pool:16},{id:"paint-scene/swatch",url:"paint-scene/swatch.png",anchor:[.5,.5],pool:16},{url:"paint-scene/brush-thick.png",anchor:[1,.5],pool:2},{url:"paint-scene/brush-medium.png",anchor:[1,.5],pool:2},{url:"paint-scene/brush-fine.png",anchor:[1,.5],pool:2},{id:"paint-scene/brush-container",children:[],pool:3},{id:"paint-scene/trail-holder",children:[]},{url:"paint-scene/snake-0.png",retina:!1,anchor:[.2,.5]},{url:"paint-scene/snake-1.png",retina:!1,anchor:[.2,.5]},{url:"paint-scene/snake-2.png",retina:!1,anchor:[.2,.5]},{id:"paint-scene/painting-layer",children:[{id:"paint-scene/brush-tip-holder",children:[{url:"paint-scene/brush-tip-0.png",retina:!1,anchor:[.5,.5]},{url:"paint-scene/brush-tip-1.png",retina:!1,anchor:[.5,.5]},{url:"paint-scene/brush-tip-2.png",retina:!1,anchor:[.5,.5]}]}]}],"stickers-assets":[{id:"stickers-scene/title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"stickers-scene/title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"stickers-scene/stickers-panel",x:740,y:100,children:[{url:"craft-scene/panel-right.png"}]},{id:"stickers-scene/scooby/tile-scooby",url:"stickers-scene/scooby/tile-scooby.png",pool:2},{id:"stickers-scene/scooby/tile-shaggy",url:"stickers-scene/scooby/tile-shaggy.png",pool:2},{id:"stickers-scene/scooby/tile-thelma",url:"stickers-scene/scooby/tile-thelma.png",pool:2},{id:"stickers-scene/scooby/tile-fred",url:"stickers-scene/scooby/tile-fred.png",pool:2},{id:"stickers-scene/scooby/tile-daphne",url:"stickers-scene/scooby/tile-daphne.png",pool:2},{id:"stickers-scene/scooby/tile-van-logo",url:"stickers-scene/scooby/tile-van-logo.png",pool:2},{id:"stickers-scene/scooby/tile-wolf",url:"stickers-scene/scooby/tile-wolf.png",pool:2},{id:"stickers-scene/scooby/tile-duo",url:"stickers-scene/scooby/tile-duo.png",pool:2},{id:"stickers-scene/scooby/tile-van",url:"stickers-scene/scooby/tile-van.png",pool:2},{id:"stickers-scene/scooby/tile-zombie",url:"stickers-scene/scooby/tile-zombie.png",pool:2},{id:"stickers-scene/scooby/draggable-scooby",url:"stickers-scene/scooby/sticker-scooby.png",pool:20},{id:"stickers-scene/scooby/draggable-shaggy",url:"stickers-scene/scooby/sticker-shaggy.png",pool:20},{id:"stickers-scene/scooby/draggable-thelma",url:"stickers-scene/scooby/sticker-thelma.png",pool:20},{id:"stickers-scene/scooby/draggable-fred",url:"stickers-scene/scooby/sticker-fred.png",pool:20},{id:"stickers-scene/scooby/draggable-daphne",url:"stickers-scene/scooby/sticker-daphne.png",pool:20},{id:"stickers-scene/scooby/draggable-van-logo",url:"stickers-scene/scooby/sticker-van-logo.png",pool:20},{id:"stickers-scene/scooby/draggable-wolf",url:"stickers-scene/scooby/sticker-wolf.png",pool:20},{id:"stickers-scene/scooby/draggable-duo",url:"stickers-scene/scooby/sticker-duo.png",pool:20},{id:"stickers-scene/scooby/draggable-van",url:"stickers-scene/scooby/sticker-van.png",pool:20},{id:"stickers-scene/scooby/draggable-zombie",url:"stickers-scene/scooby/sticker-zombie.png",pool:20},{id:"stickers-scene/tom/tile-logo",url:"stickers-scene/tom/tile-logo.png",pool:2},{id:"stickers-scene/tom/tile-jerry",url:"stickers-scene/tom/tile-jerry.png",pool:2},{id:"stickers-scene/tom/tile-jerry-chicken",url:"stickers-scene/tom/tile-jerry-chicken.png",pool:2},{id:"stickers-scene/tom/tile-jerry-book",url:"stickers-scene/tom/tile-jerry-book.png",pool:2},{id:"stickers-scene/tom/tile-jerry-cymbals",url:"stickers-scene/tom/tile-jerry-cymbals.png",pool:2},{id:"stickers-scene/tom/tile-jerry-trap",url:"stickers-scene/tom/tile-jerry-trap.png",pool:2},{id:"stickers-scene/tom/tile-tom-run",url:"stickers-scene/tom/tile-tom-run.png",pool:2},{id:"stickers-scene/tom/tile-tom-face",url:"stickers-scene/tom/tile-tom-face.png",pool:2},{id:"stickers-scene/tom/tile-tom-prone",url:"stickers-scene/tom/tile-tom-prone.png",pool:2},{id:"stickers-scene/tom/tile-tom-head",url:"stickers-scene/tom/tile-tom-head.png",pool:2},{id:"stickers-scene/tom/draggable-logo",url:"stickers-scene/tom/sticker-logo.png",pool:20},{id:"stickers-scene/tom/draggable-jerry",url:"stickers-scene/tom/sticker-jerry.png",pool:20},{id:"stickers-scene/tom/draggable-jerry-chicken",url:"stickers-scene/tom/sticker-jerry-chicken.png",pool:20},{id:"stickers-scene/tom/draggable-jerry-book",url:"stickers-scene/tom/sticker-jerry-book.png",pool:20},{id:"stickers-scene/tom/draggable-jerry-cymbals",url:"stickers-scene/tom/sticker-jerry-cymbals.png",pool:20},{id:"stickers-scene/tom/draggable-jerry-trap",url:"stickers-scene/tom/sticker-jerry-trap.png",pool:20},{id:"stickers-scene/tom/draggable-tom-run",url:"stickers-scene/tom/sticker-tom-run.png",pool:20},{id:"stickers-scene/tom/draggable-tom-face",url:"stickers-scene/tom/sticker-tom-face.png",pool:20},{id:"stickers-scene/tom/draggable-tom-prone",url:"stickers-scene/tom/sticker-tom-prone.png",pool:20},{id:"stickers-scene/tom/draggable-tom-head",url:"stickers-scene/tom/sticker-tom-head.png",pool:20},{id:"stickers-scene/bugs/tile-bugs-carrot",url:"stickers-scene/bugs/tile-bugs-carrot.png",pool:2},{id:"stickers-scene/bugs/tile-bugs-chuckle",url:"stickers-scene/bugs/tile-bugs-chuckle.png",pool:2},{id:"stickers-scene/bugs/tile-bugs-relax",url:"stickers-scene/bugs/tile-bugs-relax.png",pool:2},{id:"stickers-scene/bugs/tile-bugs-handrest",url:"stickers-scene/bugs/tile-bugs-handrest.png",pool:2},{id:"stickers-scene/bugs/tile-bugs-run",url:"stickers-scene/bugs/tile-bugs-run.png",pool:2},{id:"stickers-scene/bugs/tile-daffy-evil",url:"stickers-scene/bugs/tile-daffy-evil.png",pool:2},{id:"stickers-scene/bugs/tile-daffy-face",url:"stickers-scene/bugs/tile-daffy-face.png",pool:2},{id:"stickers-scene/bugs/tile-daffy-hunch",url:"stickers-scene/bugs/tile-daffy-hunch.png",pool:2},{id:"stickers-scene/bugs/tile-daffy-shrug",url:"stickers-scene/bugs/tile-daffy-shrug.png",pool:2},{id:"stickers-scene/bugs/tile-daffy-tongue",url:"stickers-scene/bugs/tile-daffy-tongue.png",pool:2},{id:"stickers-scene/bugs/draggable-bugs-carrot",url:"stickers-scene/bugs/sticker-bugs-carrot.png",pool:20},{id:"stickers-scene/bugs/draggable-bugs-chuckle",url:"stickers-scene/bugs/sticker-bugs-chuckle.png",pool:20},{id:"stickers-scene/bugs/draggable-bugs-relax",url:"stickers-scene/bugs/sticker-bugs-relax.png",pool:20},{id:"stickers-scene/bugs/draggable-bugs-handrest",url:"stickers-scene/bugs/sticker-bugs-handrest.png",pool:20},{id:"stickers-scene/bugs/draggable-bugs-run",url:"stickers-scene/bugs/sticker-bugs-run.png",pool:20},{id:"stickers-scene/bugs/draggable-daffy-evil",url:"stickers-scene/bugs/sticker-daffy-evil.png",pool:20},{id:"stickers-scene/bugs/draggable-daffy-face",url:"stickers-scene/bugs/sticker-daffy-face.png",pool:20},{id:"stickers-scene/bugs/draggable-daffy-hunch",url:"stickers-scene/bugs/sticker-daffy-hunch.png",pool:20},{id:"stickers-scene/bugs/draggable-daffy-shrug",url:"stickers-scene/bugs/sticker-daffy-shrug.png",pool:20},{id:"stickers-scene/bugs/draggable-daffy-tongue",url:"stickers-scene/bugs/sticker-daffy-tongue.png",pool:20},{id:"stickers-scene/tweety/tile-slyvester-laugh",url:"stickers-scene/tweety/tile-slyvester-laugh.png",pool:2},{id:"stickers-scene/tweety/tile-slyvester-point",url:"stickers-scene/tweety/tile-slyvester-point.png",pool:2},{id:"stickers-scene/tweety/tile-slyvester-run",url:"stickers-scene/tweety/tile-slyvester-run.png",pool:2},{id:"stickers-scene/tweety/tile-slyvester-scream",url:"stickers-scene/tweety/tile-slyvester-scream.png",pool:2},{id:"stickers-scene/tweety/tile-slyvester-stars",url:"stickers-scene/tweety/tile-slyvester-stars.png",pool:2},{id:"stickers-scene/tweety/tile-tweety-halo",url:"stickers-scene/tweety/tile-tweety-halo.png",pool:2},{id:"stickers-scene/tweety/tile-tweety-hammer",url:"stickers-scene/tweety/tile-tweety-hammer.png",pool:2},{id:"stickers-scene/tweety/tile-tweety-prone",url:"stickers-scene/tweety/tile-tweety-prone.png",pool:2},{id:"stickers-scene/tweety/tile-tweety-shrug",url:"stickers-scene/tweety/tile-tweety-shrug.png",pool:2},{id:"stickers-scene/tweety/tile-tweety-wink",url:"stickers-scene/tweety/tile-tweety-wink.png",pool:2},{id:"stickers-scene/tweety/draggable-slyvester-laugh",url:"stickers-scene/tweety/sticker-slyvester-laugh.png",pool:20},{id:"stickers-scene/tweety/draggable-slyvester-point",url:"stickers-scene/tweety/sticker-slyvester-point.png",pool:20},{id:"stickers-scene/tweety/draggable-slyvester-run",url:"stickers-scene/tweety/sticker-slyvester-run.png",pool:20},{id:"stickers-scene/tweety/draggable-slyvester-scream",url:"stickers-scene/tweety/sticker-slyvester-scream.png",pool:20},{id:"stickers-scene/tweety/draggable-slyvester-stars",url:"stickers-scene/tweety/sticker-slyvester-stars.png",pool:20},{id:"stickers-scene/tweety/draggable-tweety-halo",url:"stickers-scene/tweety/sticker-tweety-halo.png",pool:20},{id:"stickers-scene/tweety/draggable-tweety-hammer",url:"stickers-scene/tweety/sticker-tweety-hammer.png",pool:20},{id:"stickers-scene/tweety/draggable-tweety-prone",url:"stickers-scene/tweety/sticker-tweety-prone.png",pool:20},{id:"stickers-scene/tweety/draggable-tweety-shrug",url:"stickers-scene/tweety/sticker-tweety-shrug.png",pool:20},{id:"stickers-scene/tweety/draggable-tweety-wink",url:"stickers-scene/tweety/sticker-tweety-wink.png",pool:20},{id:"stickers-scene/wile/tile-road-head",url:"stickers-scene/wile/tile-road-head.png",pool:2},{id:"stickers-scene/wile/tile-road-jump",url:"stickers-scene/wile/tile-road-jump.png",pool:2},{id:"stickers-scene/wile/tile-road-legs",url:"stickers-scene/wile/tile-road-legs.png",pool:2},{id:"stickers-scene/wile/tile-road-run",url:"stickers-scene/wile/tile-road-run.png",pool:2},{id:"stickers-scene/wile/tile-road-taunt",url:"stickers-scene/wile/tile-road-taunt.png",pool:2},{id:"stickers-scene/wile/tile-wile-crazy",url:"stickers-scene/wile/tile-wile-crazy.png",pool:2},{id:"stickers-scene/wile/tile-wile-drop",url:"stickers-scene/wile/tile-wile-drop.png",pool:2},{id:"stickers-scene/wile/tile-wile-dynamite",url:"stickers-scene/wile/tile-wile-dynamite.png",pool:2},{id:"stickers-scene/wile/tile-wile-hungry",url:"stickers-scene/wile/tile-wile-hungry.png",pool:2},{id:"stickers-scene/wile/tile-wile-menace",url:"stickers-scene/wile/tile-wile-menace.png",pool:2},{id:"stickers-scene/wile/draggable-road-head",url:"stickers-scene/wile/sticker-road-head.png",pool:20},{id:"stickers-scene/wile/draggable-road-jump",url:"stickers-scene/wile/sticker-road-jump.png",pool:20},{id:"stickers-scene/wile/draggable-road-legs",url:"stickers-scene/wile/sticker-road-legs.png",pool:20},{id:"stickers-scene/wile/draggable-road-run",url:"stickers-scene/wile/sticker-road-run.png",pool:20},{id:"stickers-scene/wile/draggable-road-taunt",url:"stickers-scene/wile/sticker-road-taunt.png",pool:20},{id:"stickers-scene/wile/draggable-wile-crazy",url:"stickers-scene/wile/sticker-wile-crazy.png",pool:20},{id:"stickers-scene/wile/draggable-wile-drop",url:"stickers-scene/wile/sticker-wile-drop.png",pool:20},{id:"stickers-scene/wile/draggable-wile-dynamite",url:"stickers-scene/wile/sticker-wile-dynamite.png",pool:20},{id:"stickers-scene/wile/draggable-wile-hungry",url:"stickers-scene/wile/sticker-wile-hungry.png",pool:20},{id:"stickers-scene/wile/draggable-wile-menace",url:"stickers-scene/wile/sticker-wile-menace.png",pool:20},{id:"sticker-scene/cross-button",url:"craft-scene/cross-button.png",anchor:[.5,.5],pool:500}],"wheels-assets":[{id:"wheels-scene/title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"wheels-scene/title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"wheels-scene/wheels-panel",x:740,y:100,children:[{url:"craft-scene/panel-right.png"}]},{id:"wheels-scene/tile-silver-speeders",url:"wheels-scene/tile-wheel-style-1.png"},{id:"wheels-scene/tile-green-mini",url:"wheels-scene/tile-wheel-style-2.png"},{id:"wheels-scene/tile-purple-stock",url:"wheels-scene/tile-wheel-style-3.png"},{id:"wheels-scene/tile-micro",url:"wheels-scene/tile-wheel-style-4.png"},{id:"wheels-scene/tile-offroad",url:"wheels-scene/tile-wheel-style-5.png"},{id:"wheels-scene/tile-blue-superspeed",url:"wheels-scene/tile-wheel-style-6.png"},{id:"wheels-scene/tile-monster",url:"wheels-scene/tile-wheel-style-7.png"},{id:"wheels-scene/tile-whitewall",url:"wheels-scene/tile-wheel-style-8.png"},{id:"wheels-scene/draggable-silver-speeders",url:"wheels-scene/wheel-style-1.png",pool:40},{id:"wheels-scene/draggable-green-mini",url:"wheels-scene/wheel-style-2.png",pool:40},{id:"wheels-scene/draggable-purple-stock",url:"wheels-scene/wheel-style-3.png",pool:40},{id:"wheels-scene/draggable-micro",url:"wheels-scene/wheel-style-4.png",pool:40},{id:"wheels-scene/draggable-offroad",url:"wheels-scene/wheel-style-5.png",pool:40},{id:"wheels-scene/draggable-blue-superspeed",url:"wheels-scene/wheel-style-6.png",pool:40},{id:"wheels-scene/draggable-monster",url:"wheels-scene/wheel-style-7.png",pool:40},{id:"wheels-scene/draggable-whitewall",url:"wheels-scene/wheel-style-8.png",pool:40}],"accessories-assets":[{id:"accessories-scene/title-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"accessories-scene/title-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"accessories-scene/accessories-panel",x:740,y:100,children:[{url:"craft-scene/panel-right.png"}]},{id:"accessories-scene/cross-button",url:"craft-scene/cross-button.png",anchor:[.5,.5],pool:200},{id:"accessories-scene/draggable-bugs-bomb",url:"accessories-scene/bugs/bomb.png",pool:21},{id:"accessories-scene/draggable-bugs-ears",url:"accessories-scene/bugs/bugs-ears.png",pool:21},{id:"accessories-scene/draggable-bugs-tail",url:"accessories-scene/bugs/bugs-tail.png",pool:21},{id:"accessories-scene/draggable-bugs-carrot",url:"accessories-scene/bugs/carrot.png",pool:21},{id:"accessories-scene/draggable-bugs-cowboy-hat",url:"accessories-scene/bugs/cowboy-hat.png",pool:21},{id:"accessories-scene/tile-bugs-bomb",url:"accessories-scene/bugs/bomb-tile.png"},{id:"accessories-scene/tile-bugs-ears",url:"accessories-scene/bugs/bugs-ears-tile.png"},{id:"accessories-scene/tile-bugs-tail",url:"accessories-scene/bugs/bugs-tail-tile.png"},{id:"accessories-scene/tile-bugs-carrot",url:"accessories-scene/bugs/carrot-tile.png"},{id:"accessories-scene/tile-bugs-cowboy-hat",url:"accessories-scene/bugs/cowboy-hat-tile.png"},{id:"accessories-scene/draggable-scooby-tail",url:"accessories-scene/scooby/scooby-tail.png",pool:21},{id:"accessories-scene/draggable-scooby-tag",url:"accessories-scene/scooby/scooby-tag.png",pool:21},{id:"accessories-scene/draggable-scooby-ghost",url:"accessories-scene/scooby/scooby-ghost.png",pool:21},{id:"accessories-scene/draggable-scooby-magnifying-glass",url:"accessories-scene/scooby/scooby-magnifying-glass.png",pool:21},{id:"accessories-scene/draggable-scooby-button",url:"accessories-scene/scooby/scooby-button.png",pool:21},{id:"accessories-scene/draggable-scooby-snacks",url:"accessories-scene/scooby/scooby-snacks.png",pool:21},{id:"accessories-scene/tile-scooby-tail",url:"accessories-scene/scooby/scooby-tail-tile.png"},{id:"accessories-scene/tile-scooby-tag",url:"accessories-scene/scooby/scooby-tag-tile.png"},{id:"accessories-scene/tile-scooby-ghost",url:"accessories-scene/scooby/scooby-ghost-tile.png"},{id:"accessories-scene/tile-scooby-magnifying-glass",url:"accessories-scene/scooby/scooby-magnifying-glass-tile.png"},{id:"accessories-scene/tile-scooby-button",url:"accessories-scene/scooby/scooby-button-tile.png"},{id:"accessories-scene/tile-scooby-snacks",url:"accessories-scene/scooby/scooby-snacks-tile.png"},{id:"accessories-scene/draggable-tweety-ears",url:"accessories-scene/tweety/tweety-ears.png",pool:21},{id:"accessories-scene/draggable-tweety-halo",url:"accessories-scene/tweety/tweety-halo.png",pool:21},{id:"accessories-scene/draggable-tweety-hammer",url:"accessories-scene/tweety/tweety-hammer.png",pool:21},{id:"accessories-scene/draggable-tweety-nose",url:"accessories-scene/tweety/tweety-nose.png",pool:21},{id:"accessories-scene/draggable-tweety-tail",url:"accessories-scene/tweety/tweety-tail.png",pool:21},{id:"accessories-scene/draggable-tweety-wings",url:"accessories-scene/tweety/tweety-wings.png",pool:21},{id:"accessories-scene/tile-tweety-ears",url:"accessories-scene/tweety/tweety-ears-tile.png"},{id:"accessories-scene/tile-tweety-halo",url:"accessories-scene/tweety/tweety-halo-tile.png"},{id:"accessories-scene/tile-tweety-hammer",url:"accessories-scene/tweety/tweety-hammer-tile.png"},{id:"accessories-scene/tile-tweety-nose",url:"accessories-scene/tweety/tweety-nose-tile.png"},{id:"accessories-scene/tile-tweety-tail",url:"accessories-scene/tweety/tweety-tail-tile.png"},{id:"accessories-scene/tile-tweety-wings",url:"accessories-scene/tweety/tweety-wings-tile.png"},{id:"accessories-scene/draggable-wile-boxing",url:"accessories-scene/wile/wile-boxing.png",pool:21},{id:"accessories-scene/draggable-wile-cactus",url:"accessories-scene/wile/wile-cactus.png",pool:21},{id:"accessories-scene/draggable-wile-rocket",url:"accessories-scene/wile/wile-rocket.png",pool:21},{id:"accessories-scene/draggable-wile-tail",url:"accessories-scene/wile/wile-tail.png",pool:21},{id:"accessories-scene/draggable-wile-tnt",url:"accessories-scene/wile/wile-tnt.png",pool:21},{id:"accessories-scene/tile-wile-boxing",url:"accessories-scene/wile/wile-boxing-tile.png"},{id:"accessories-scene/tile-wile-cactus",url:"accessories-scene/wile/wile-cactus-tile.png"},{id:"accessories-scene/tile-wile-rocket",url:"accessories-scene/wile/wile-rocket-tile.png"},{id:"accessories-scene/tile-wile-tail",url:"accessories-scene/wile/wile-tail-tile.png"},{id:"accessories-scene/tile-wile-tnt",url:"accessories-scene/wile/wile-tnt-tile.png"},{id:"accessories-scene/draggable-tom-tail",url:"accessories-scene/tom/tom-tail.png",pool:21},{id:"accessories-scene/draggable-tom-cheese",url:"accessories-scene/tom/tom-cheese.png",pool:21},{id:"accessories-scene/draggable-tom-chefs-hat",url:"accessories-scene/tom/tom-chefs-hat.png",pool:21},{id:"accessories-scene/draggable-tom-jerry-ear",url:"accessories-scene/tom/tom-jerry-ear.png",pool:21},{id:"accessories-scene/draggable-tom-trap",url:"accessories-scene/tom/tom-trap.png",pool:21},{id:"accessories-scene/tile-tom-tail",url:"accessories-scene/tom/tom-tail-tile.png"},{id:"accessories-scene/tile-tom-cheese",url:"accessories-scene/tom/tom-cheese-tile.png"},{id:"accessories-scene/tile-tom-chefs-hat",url:"accessories-scene/tom/tom-chefs-hat-tile.png"},{id:"accessories-scene/tile-tom-jerry-ear",url:"accessories-scene/tom/tom-jerry-ear-tile.png"},{id:"accessories-scene/tile-tom-trap",url:"accessories-scene/tom/tom-trap-tile.png"}],"race-assets":[{id:"race-scene/results-panel-container",children:[{url:"race-scene/black-overlay.png",retina:!1},{id:"race-scene/results-panel",children:[{url:"race-scene/results-panel.png"}]}]},{url:"race-scene/enemy-target.png",anchor:[.5,.5],projection:"3d"},{id:"race-scene/results-position-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:5},{id:"race-scene/results-position-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"arabic",pool:5},{id:"race-scene/results-time-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:5},{id:"race-scene/results-time-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"arabic",pool:5},{id:"race-scene/results-coin-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin",pool:5},{id:"race-scene/results-coin-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"arabic",pool:5},{url:"race-scene/results-player-bar.png",anchor:[0,.5],pool:5},{id:"race-scene/results-square-holder",children:[],pool:5},{url:"race-scene/results-square-rival.png",anchor:[.5,.5],pool:5},{url:"race-scene/results-square-player.png",anchor:[.5,.5],pool:5},{id:"race-scene/results-square-container",children:[],pool:5},{id:"race-scene/results-line-container",children:[],pool:5},{id:"race-scene/results-coin",url:"race-scene/collect-coin.png",anchor:[.5,.5],pool:5},{id:"race-scene/powerup-button-container",children:[{url:"race-scene/powerup-meter.png",anchor:[.5,.5]},{url:"race-scene/powerup-meter-full.png",x:-2,y:-2,anchor:[.5,.5]}]},{id:"race-scene/powerup-button-touch",url:"race-scene/blank-input.png",retina:!1},{id:"race-scene/powerup-button-shadow",url:"ui/ui-button-bg-shadow.png",y:5,anchor:[.5,.5]},{id:"race-scene/boost-indicator",url:"race-scene/boost-indicate.png",anchor:[.5,.5],projection:"3d"},{id:"race-scene/powerup-indicator",url:"race-scene/powerup-indicator.png",pool:30,anchor:[0,.5],projection:"3d"},{id:"race-scene/powerup-indicator-holder",children:[],projection:"3d"},{id:"race-scene/energy-burst-frames",type:"spritesheet",dir:"race-scene/energy-burst",atlas:"energy-burst.json",frames:[],anchor:[.5,.5]},{id:"race-scene/gem-frames",type:"spritesheet",dir:"race-scene/gem",atlas:"gem.json",frames:[],anchor:[.5,1],pool:20},{id:"race-scene/smash-frames",type:"spritesheet",dir:"race-scene/smash",atlas:"smash.json",frames:[],anchor:[.5,.5]},{id:"race-scene/dust-trail-frames",type:"spritesheet",dir:"race-scene/dust-trail",atlas:"dust-trail.json",frames:[],anchor:[1,1],pool:5},{id:"race-scene/ramp-frames",anchor:[0,.5],type:"spritesheet",dir:"race-scene/ramp",atlas:"ramp.json",pool:70,frames:[]},{id:"race-scene/ramp-boost-frames",type:"spritesheet",dir:"race-scene/ramp-boost",atlas:"ramp-boost.json",pool:70,frames:[],anchor:[.5,1]},{id:"race-scene/explode-frames",anchor:[.5,.5],type:"spritesheet",dir:"race-scene/explode",atlas:"explode.json",pool:70,frames:[]},{id:"race-scene/gum-goop-frames",type:"spritesheet",dir:"race-scene/gum-goop",atlas:"gum-goop.json",pool:70,frames:[],anchor:[.5,1]},{id:"race-scene/bomb-frames",anchor:[.5,1],type:"spritesheet",dir:"race-scene/bomb",atlas:"bomb.json",pool:70,frames:[]},{id:"race-scene/collide-sparks-frames",anchor:[.5,1],type:"spritesheet",dir:"race-scene/collide-sparks",atlas:"collide-sparks.json",pool:10,frames:[]},{id:"race-scene/physics-debug-layer",projection:"3d",children:[]},{id:"race-scene/coincount-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"race-scene/coincount-text-shadow",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"race-scene/coincount-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"arabic"},{id:"race-scene/coincount-text-shadow",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"arabic"},{id:"race-scene/countdown-text",dir:"title-font-latin",fontname:"title",fontdata:"title-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"race-scene/countdown-text",dir:"title-font-arabic",fontname:"HS Alhandasi",fontdata:"title-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"race-scene/countdown-text-holder",children:[]},{id:"race-scene/progress-meter-holder",x:175,y:22,children:[{url:"race-scene/progress-meter.png",x:10},{id:"race-scene/race-position-holder",x:-84,y:35,children:[{url:"race-scene/position-bg.png",anchor:[.5,.5]},{id:"race-scene/race-position-text-holder",x:-83,y:35,children:[{id:"race-scene/race-position-1",url:"race-scene/race-position-1.png",anchor:[.5,.5]},{id:"race-scene/race-position-2",url:"race-scene/race-position-2.png",anchor:[.5,.5]},{id:"race-scene/race-position-3",url:"race-scene/race-position-3.png",anchor:[.5,.5]},{id:"race-scene/race-position-4",url:"race-scene/race-position-4.png",anchor:[.5,.5]},{id:"race-scene/race-position-5",url:"race-scene/race-position-5.png",anchor:[.5,.5]}]}]}]},{id:"race-scene/progress-marker-holder",children:[],pool:5},{url:"race-scene/progress-marker-rival.png",anchor:[.5,0],pool:4},{url:"race-scene/progress-marker-player.png",anchor:[.5,0],pool:4},{id:"race-scene/coin-container",x:90,y:125,children:[{url:"race-scene/collect-bg.png",anchor:[.5,.5]}]},{url:"race-scene/results-scooby.png",anchor:[.5,1],pool:2},{url:"race-scene/results-tweety.png",anchor:[.5,1],pool:2},{url:"race-scene/results-tom.png",anchor:[.45,1.02],pool:2},{url:"race-scene/results-bugs.png",anchor:[.7,.95],pool:2},{url:"race-scene/results-wile.png",anchor:[.35,.9],pool:2},{id:"race-scene/player-container",projection:"3d",children:[{id:"race-scene/car-container",projection:"3d",children:[{id:"race-scene/car",projection:"3d",children:[{id:"race-scene/car-body",projection:"3d",children:[{id:"race-scene/car-body-inner",projection:"3d",children:[]}]},{id:"race-scene/front-wheels",projection:"3d",children:[]},{id:"race-scene/back-wheels",projection:"3d",children:[]}]}]}]},{id:"race-scene/hud-container",children:[]},{id:"race-scene/vehicle-texture-container",children:[],pool:5},{id:"race-scene/vehicle-texture-container-inner",children:[],pool:5},{id:"race-scene/vehicle-container",projection:"3d",children:[],pool:5},{id:"race-scene/car-container",projection:"3d",children:[],pool:5},{id:"race-scene/car",projection:"3d",children:[],pool:5},{id:"race-scene/car-body",projection:"3d",children:[],pool:5},{id:"race-scene/car-body-inner",projection:"3d",children:[],pool:5},{id:"race-scene/front-wheels",projection:"3d",children:[],pool:5},{id:"race-scene/back-wheels",projection:"3d",children:[],pool:5},{id:"race-scene/silver-speeders",url:"wheels-scene/wheel-style-1.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/green-mini",url:"wheels-scene/wheel-style-2.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/purple-stock",url:"wheels-scene/wheel-style-3.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/micro",url:"wheels-scene/wheel-style-4.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/offroad",url:"wheels-scene/wheel-style-5.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/blue-superspeed",url:"wheels-scene/wheel-style-6.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/monster",url:"wheels-scene/wheel-style-7.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/whitewall",url:"wheels-scene/wheel-style-8.png",projection:"3d",anchor:[.5,.5],pool:20},{id:"race-scene/pickup",url:"craft-scene/pickup.png",anchor:[.5,1],pool:5},{id:"race-scene/beetle",url:"craft-scene/beetle.png",anchor:[.5,1],pool:5},{id:"race-scene/van",url:"craft-scene/van.png",anchor:[.5,1],pool:5},{id:"race-scene/bubble",url:"craft-scene/bubble.png",anchor:[.5,1],pool:5},{id:"race-scene/gangster",url:"craft-scene/gangster.png",anchor:[.5,1],pool:5},{id:"race-scene/truck",url:"craft-scene/truck.png",anchor:[.5,1],pool:5},{id:"race-scene/cadillac",url:"craft-scene/cadillac.png",anchor:[.5,1],pool:5},{id:"race-scene/pickup-mask",url:"craft-scene/pickup-paint-mask.png",retina:!1,pool:5},{id:"race-scene/beetle-mask",url:"craft-scene/beetle-paint-mask.png",retina:!1,pool:5},{id:"race-scene/van-mask",url:"craft-scene/van-paint-mask.png",retina:!1,pool:5},{id:"race-scene/bubble-mask",url:"craft-scene/bubble-paint-mask.png",retina:!1,pool:5},{id:"race-scene/gangster-mask",url:"craft-scene/gangster-paint-mask.png",retina:!1,pool:5},{id:"race-scene/truck-mask",url:"craft-scene/truck-paint-mask.png",retina:!1,pool:5},{id:"race-scene/cadillac-mask",url:"craft-scene/cadillac-paint-mask.png",retina:!1,pool:5},{id:"race-scene/preload-paint/cadillac-base-1",url:"race-scene/preload-paint/cadillac-base-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/cadillac-base-2",url:"race-scene/preload-paint/cadillac-base-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/cadillac-top-1",url:"race-scene/preload-paint/cadillac-top-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/cadillac-top-2",url:"race-scene/preload-paint/cadillac-top-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/cadillac-top-3",url:"race-scene/preload-paint/cadillac-top-3.png",retina:!1,pool:20},{id:"race-scene/preload-paint/truck-base-1",url:"race-scene/preload-paint/truck-base-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/truck-base-2",url:"race-scene/preload-paint/truck-base-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/truck-top-1",url:"race-scene/preload-paint/truck-top-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/truck-top-2",url:"race-scene/preload-paint/truck-top-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/truck-top-3",url:"race-scene/preload-paint/truck-top-3.png",retina:!1,pool:20},{id:"race-scene/preload-paint/gangster-base-1",url:"race-scene/preload-paint/gangster-base-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/gangster-base-2",url:"race-scene/preload-paint/gangster-base-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/gangster-top-1",url:"race-scene/preload-paint/gangster-top-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/gangster-top-2",url:"race-scene/preload-paint/gangster-top-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/gangster-top-3",url:"race-scene/preload-paint/gangster-top-3.png",retina:!1,pool:20},{id:"race-scene/preload-paint/bubble-base-1",url:"race-scene/preload-paint/bubble-base-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/bubble-base-2",url:"race-scene/preload-paint/bubble-base-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/bubble-top-1",url:"race-scene/preload-paint/bubble-top-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/bubble-top-2",url:"race-scene/preload-paint/bubble-top-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/bubble-top-3",url:"race-scene/preload-paint/bubble-top-3.png",retina:!1,pool:20},{id:"race-scene/preload-paint/van-top-1",url:"race-scene/preload-paint/van-top-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/van-top-2",url:"race-scene/preload-paint/van-top-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/van-top-3",url:"race-scene/preload-paint/van-top-3.png",retina:!1,pool:20},{id:"race-scene/preload-paint/van-base-1",url:"race-scene/preload-paint/van-base-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/van-base-2",url:"race-scene/preload-paint/van-base-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/beetle-top-1",url:"race-scene/preload-paint/beetle-top-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/beetle-top-2",url:"race-scene/preload-paint/beetle-top-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/beetle-top-3",url:"race-scene/preload-paint/beetle-top-3.png",retina:!1,pool:20},{id:"race-scene/preload-paint/beetle-base-1",url:"race-scene/preload-paint/beetle-base-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/beetle-base-2",url:"race-scene/preload-paint/beetle-base-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/pickup-top-1",url:"race-scene/preload-paint/pickup-top-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/pickup-top-2",url:"race-scene/preload-paint/pickup-top-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/pickup-top-3",url:"race-scene/preload-paint/pickup-top-3.png",retina:!1,pool:20},{id:"race-scene/preload-paint/pickup-base-1",url:"race-scene/preload-paint/pickup-base-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/pickup-base-2",url:"race-scene/preload-paint/pickup-base-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/base-layer-1",url:"race-scene/preload-paint/base-layer-1.png",retina:!1,pool:20},{id:"race-scene/preload-paint/base-layer-2",url:"race-scene/preload-paint/base-layer-2.png",retina:!1,pool:20},{id:"race-scene/preload-paint/base-layer-3",url:"race-scene/preload-paint/base-layer-3.png",retina:!1,pool:20},{url:"race-scene/gem-shadow.png",projection:"3d",anchor:[.5,.5],retina:!1,pool:20},{url:"race-scene/shadow.png",projection:"3d",anchor:[.5,.5],retina:!1,pool:400},{url:"race-scene/white-tab.png",projection:"3d",retina:!1,anchor:[.5,1],pool:400},{url:"race-scene/collect-coin.png",projection:"3d",anchor:[.5,1],pool:130},{url:"race-scene/shine.png",projection:"3d",retina:!1,anchor:[.5,.5],pool:130},{url:"race-scene/collect-powerup.png",projection:"3d",anchor:[.5,1],pool:20},{url:"race-scene/mine.png",projection:"3d",anchor:[.5,1],pool:7},{url:"race-scene/gum.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/gum-front.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/ramp-side.png",projection:"3d",anchor:[0,1],pool:140},{url:"race-scene/ramp-top-glow.png",projection:"3d",anchor:[0,.5],pool:70},{id:"race-scene/ramp-top",projection:"3d",children:[],pool:70},{id:"race-scene/object-holder",projection:"3d",children:[],pool:800},{id:"race-scene/surface-layer",projection:"3d",children:[]},{id:"race-scene/track-holder",projection:"3d",children:[]},{id:"race-scene/layers-holder",children:[]},{id:"race-scene/main-holder",children:[]},{id:"race-scene/scale-holder",children:[]},{id:"race-scene/interaction-holder",children:[]},{id:"race-scene/touch-current",url:"race-scene/touch-element-start.png",anchor:[.5,.5]},{id:"race-scene/move-indicate",url:"race-scene/move-indicate.png",projection:"3d",anchor:[.5,.5],pool:5},{url:"race-scene/snake.png",anchor:[.5,.5],retina:!1},{id:"race-scene/blank-input",url:"global/magenta.png",retina:!1},{url:"race-scene/blank-input-purple.png",retina:!1},{id:"race-scene/tile-container",children:[],projection:"3d",pool:100},{id:"race-scene/background-holder",projection:"3d",children:[]},{id:"race-scene/finish-line-tower",url:"race-scene/finish-line-tower.png",projection:"3d",pool:2,anchor:[.5,1]},{url:"race-scene/finish-line.png",projection:"3d",anchor:[.5,.5],pool:3},{id:"race-scene/powerup-container",projection:"3d",children:[]}],"powerup-tom":[{id:"race-scene/tom-container",projection:"3d",children:[{url:"race-scene/powerup-tom/tom-body.png",x:1,y:17},{url:"race-scene/powerup-tom/tom-arm.png",projection:"3d",x:550,y:280,anchor:[.1,.7]},{id:"race-scene/powerup-tom/tom-head",x:530,y:280,children:[{url:"race-scene/powerup-tom/tom-head.png",x:-100,y:-290},{url:"race-scene/powerup-tom/tom-eyelids.png",x:28,y:-66}]}]}],"powerup-tweety":[{id:"race-scene/tweety-container",projection:"3d",children:[{id:"race-scene/tweety-inner",children:[{url:"race-scene/powerup-tweety/body.png",x:-20,y:77},{id:"race-scene/powerup-tweety/wing",x:-20,children:[{url:"race-scene/powerup-tweety/wing-up.png",x:15,y:73},{url:"race-scene/powerup-tweety/wing-down.png",x:19,y:93}]},{id:"race-scene/powerup-tweety/head",x:-2,y:0,children:[{url:"race-scene/powerup-tweety/head.png",x:0,y:0},{url:"race-scene/powerup-tweety/eyelids.png",x:50,y:49}]},{url:"race-scene/powerup-tweety/anvil.png",y:145,anchor:[.5,0]},{url:"race-scene/powerup-tweety/front.png",x:-20,y:128}]}]},{url:"race-scene/powerup-tweety/anvil-shadow.png",anchor:[.5,.5],projection:"3d"},{id:"race-scene/powerup-tweety/anvil",url:"race-scene/powerup-tweety/anvil.png",projection:"3d",anchor:[.5,0]}],"powerup-scooby":[{id:"race-scene/powerup-scooby/scooby-container",projection:"3d",children:[{url:"race-scene/powerup-scooby/scooby-arm.png",projection:"3d",x:375,y:270,anchor:[.1,.3]},{url:"race-scene/powerup-scooby/scooby-body.png",y:85},{id:"race-scene/powerup-scooby/scooby-head",x:355,y:10,projection:"3d",children:[{url:"race-scene/powerup-scooby/scooby-head.png",projection:"3d"},{url:"race-scene/powerup-scooby/scooby-eyelids.png",x:99,y:84,projection:"3d"}]}]},{id:"race-scene/powerup-scooby/scooby-snack",projection:"3d",children:[{url:"race-scene/powerup-scooby/snack-0.png",projection:"3d"},{url:"race-scene/powerup-scooby/snack-1.png",projection:"3d",x:-19,y:-12},{url:"race-scene/powerup-scooby/snack-2.png",projection:"3d",x:2,y:-13},{url:"race-scene/powerup-scooby/snack-3.png",projection:"3d",x:-6,y:-34},{url:"race-scene/powerup-scooby/snack-4.png",projection:"3d",x:10,y:-56},{url:"race-scene/powerup-scooby/snack-5.png",projection:"3d",x:-9,y:-52},{url:"race-scene/powerup-scooby/snack-6.png",projection:"3d",x:9,y:-102}]}],"powerup-wile":[{id:"race-scene/powerup-wile/wile-container",projection:"3d",children:[{id:"race-scene/powerup-wile/arm",projection:"3d",x:330,y:289,children:[{url:"race-scene/powerup-wile/arm-throwing.png",projection:"3d",anchor:[0,.1]},{url:"race-scene/powerup-wile/arm-empty.png",projection:"3d",anchor:[.1,.1]}]},{url:"race-scene/powerup-wile/body.png",x:11,y:252},{id:"race-scene/powerup-wile/head",x:194,y:2,projection:"3d",children:[{url:"race-scene/powerup-wile/head.png",projection:"3d"},{url:"race-scene/powerup-wile/eyelids.png",x:113,y:226,projection:"3d"}]},{url:"race-scene/powerup-wile/front.png",projection:"3d",x:190,y:263}]},{id:"race-scene/powerup-wile/dynamite",projection:"3d",children:[{url:"race-scene/powerup-wile/dynamite.png",projection:"3d",anchor:[.3,1]}]},{url:"race-scene/powerup-wile/scorch-mark.png",projection:"3d",anchor:[.5,.5]},{id:"race-scene/flame-frames",type:"spritesheet",dir:"race-scene/flame",atlas:"flame.json",frames:[],anchor:[.5,.95]},{id:"race-scene/dynamite-blast-frames",type:"spritesheet",dir:"race-scene/dynamite-blast",atlas:"dynamite-blast.json",frames:[],anchor:[.5,1]}],"powerup-bugs":[{id:"race-scene/powerup-bugs/daffy-container",projection:"3d",children:[{id:"race-scene/powerup-bugs/arm",x:240,y:185,children:[{url:"race-scene/powerup-bugs/shoulder.png",x:-40,y:-80},{url:"race-scene/powerup-bugs/forearm.png",x:108,y:-260}]},{url:"race-scene/powerup-bugs/body.png",y:124},{id:"race-scene/powerup-bugs/head",x:155,y:-50,projection:"3d",children:[{url:"race-scene/powerup-bugs/head.png",projection:"3d"},{url:"race-scene/powerup-bugs/eyelids.png",x:74,y:101,projection:"3d"}]}]},{id:"race-scene/powerup-bugs/basketball-container",projection:"3d",children:[{id:"race-scene/basketball-frames",type:"spritesheet",dir:"race-scene/basketball",atlas:"basketball.json",frames:[],anchor:[.5,1]}]}],"track-living-room":[{url:"race-scene/living-room/floor-tile.png",projection:"3d",anchor:[0,0],pool:100},{url:"race-scene/living-room/wall-tile.png",projection:"3d",anchor:[0,1],pool:200},{url:"race-scene/living-room/table-tile.png",projection:"3d",anchor:[0,0],pool:200},{url:"race-scene/living-room/bg-1.png",projection:"3d",pool:3},{url:"race-scene/living-room/bg-2.png",projection:"3d",pool:3},{url:"race-scene/living-room/cactus-1.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/living-room/cactus-2.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/living-room/bush-1.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/living-room/bush-2.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/living-room/bush-3.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/living-room/bush-4.png",projection:"3d",anchor:[.5,1],pool:70}],"track-bathroom":[{url:"race-scene/bathroom/floor-tile.png",projection:"3d",anchor:[0,0],pool:100},{url:"race-scene/bathroom/wall-tile.png",projection:"3d",anchor:[0,1],pool:200},{url:"race-scene/bathroom/table-tile.png",projection:"3d",anchor:[0,0],pool:200},{url:"race-scene/bathroom/bg-1.png",projection:"3d",pool:3},{url:"race-scene/bathroom/bg-2.png",projection:"3d",pool:3},{url:"race-scene/bathroom/tree-1.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/bathroom/tree-2.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/bathroom/iceberg-1.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/bathroom/iceberg-2.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/bathroom/igloo.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/bathroom/snowman.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/bathroom/ice-patch.png",projection:"3d",anchor:[.2,.5],pool:70}],"track-garage":[{url:"race-scene/garage/floor-tile.png",projection:"3d",anchor:[0,0],pool:100},{url:"race-scene/garage/wall-tile.png",projection:"3d",anchor:[0,1],pool:200},{url:"race-scene/garage/table-tile.png",projection:"3d",anchor:[0,0],pool:200},{url:"race-scene/garage/tree.png",projection:"3d",anchor:[.5,1],pool:200},{url:"race-scene/garage/bg-1.png",projection:"3d",pool:3},{url:"race-scene/garage/bg-2.png",projection:"3d",pool:3},{url:"race-scene/garage/hedge.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/garage/lamp-post.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/garage/traffic-light.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/garage/warning-sign.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/garage/cone.png",projection:"3d",anchor:[.5,1],pool:70},{url:"race-scene/garage/oil-slick.png",projection:"3d",anchor:[.3,.5],pool:70}],"test-physics-tutorial-assets":[{id:"tutorial-panel-bg",url:"ui/helpscreen-bg.png",anchor:[.5,.5],pool:3},{id:"tutorial-panel-bg-border",url:"ui/helpscreen-bg-border.png",anchor:[.5,.5],pool:3},{id:"tutorial-frame-controls",children:[]},{id:"tutorial-frame-howtoplay",children:[]},{id:"tutorial-frame-powerups",children:[]}],"test-physics-assets":[{url:"test-physics/circle.png",anchor:[.5,.5]},{url:"test-physics/square.png",anchor:[.5,.5]},{url:"test-physics/plane.png",anchor:[0,.5]},{id:"test-physics/main-holder",children:[]},{url:"test-physics/blank-input.png",retina:!1}],"game-over-assets":[],"ui-assets":[{neverFlush:!0},{id:"ui-main-container",children:[]},{id:"ui-slime-meter-container",children:[]},{id:"ui/tutorial-overlay-main-holder",children:[]},{id:"spacebar-hint-frames",type:"spritesheet",dir:"ui/spacebar-hint",atlas:"spacebar.json",frames:[]},{id:"wrong-orientation-bg",url:"global/wrong-orientation-bg.png",retina:!1},{id:"scroll-bg",url:"global/iphone-scroll-overlay.png",retina:!1},{id:"white-square",url:"global/white-square.png",pool:3,retina:!1},{id:"brush-transition-holder",children:[{id:"brush-transition-frames",type:"spritesheet",dir:"brush-transition",atlas:"brush-transition.json",frames:[]}]},{id:"transition-holder",children:[{id:"black-area-top",url:"global/black-square.png",retina:!1},{id:"black-area-bottom",url:"global/black-square.png",retina:!1},{id:"black-area-left",url:"global/black-square.png",retina:!1},{id:"black-area-right",url:"global/black-square.png",retina:!1},{id:"transition-mask",children:[{id:"black-corner-top-left",url:"global/transition-mask-corner.png",retina:!1},{id:"black-corner-top-right",url:"global/transition-mask-corner.png",retina:!1},{id:"black-corner-bottom-right",url:"global/transition-mask-corner.png",retina:!1},{id:"black-corner-bottom-left",url:"global/transition-mask-corner.png",retina:!1}]}]},{id:"close-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-close.png"}]}]},{id:"close-button-red",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-red.png"},{id:"icon",url:"ui/ui-button-icon-close-white.png"}]}]},{id:"back-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-back.png"}]}]},{id:"powerup-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-powerup.png"}]}]},{id:"undo-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-red.png"},{id:"icon",url:"ui/ui-button-icon-undo.png"}]}]},{id:"delete-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-red.png"},{id:"icon",url:"ui/ui-button-icon-delete.png"}]}]},{id:"tick-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-tick.png"}]}]},{id:"tick-button-green",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-green.png"},{id:"icon",url:"ui/ui-button-icon-tick-white.png"}]}]},{id:"panel-button-up",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg-small.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-small.png"},{id:"icon",url:"ui/ui-button-icon-up.png"}]}]},{id:"panel-button-down",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg-small.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-small.png"},{id:"icon",url:"ui/ui-button-icon-down.png"}]}]},{id:"soundoffbutton",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg-big.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-big.png"},{id:"icon",url:"ui/ui-button-icon-sound-off.png"}]}]},{id:"soundonbutton",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg-big.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-big.png"},{id:"icon",url:"ui/ui-button-icon-sound-on.png"}]}]},{id:"pause-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-pause.png"}]}]},{id:"play-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-play.png"}]}]},{id:"help-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-help.png"}]}]},{id:"achievements-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-achievements.png"}]}]},{id:"skip-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg.png"},{id:"icon",url:"ui/ui-button-icon-skip.png"}]}]},{id:"home-button",type:"button",children:[{id:"shadow",url:"ui/ui-button-bg-big.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-bg-big.png"},{id:"icon",url:"ui/ui-button-icon-home-big.png"}]}]},{id:"menu-button-left",type:"button",children:[{id:"shadow",url:"ui/ui-button-left.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-left.png"}]}]},{id:"menu-button-right",type:"button",children:[{id:"shadow",url:"ui/ui-button-right.png"},{id:"button-container",children:[{id:"bg",url:"ui/ui-button-right.png"}]}]},{id:"next-race-button",type:"button",children:[{id:"shadow-container",children:[{id:"shadow-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"shadow-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"shadow-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]},{id:"button-container",children:[{id:"bg-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"bg-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"bg-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]}]},{id:"next-race-button-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"next-race-button-text",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"garage-button",type:"button",children:[{id:"shadow-container",children:[{id:"shadow-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"shadow-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"shadow-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]},{id:"button-container",children:[{id:"bg-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"bg-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"bg-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]}]},{id:"garage-button-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"garage-button-text",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"select-button",type:"button",children:[{id:"shadow-container",children:[{id:"shadow-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"shadow-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"shadow-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]},{id:"button-container",children:[{id:"bg-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"bg-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"bg-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]}]},{id:"select-button-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"select-button-text",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"race-button",type:"button",children:[{id:"shadow-container",children:[{id:"shadow-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"shadow-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"shadow-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]},{id:"button-container",children:[{id:"bg-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"bg-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"bg-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]}]},{id:"race-button-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"race-button-text",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"edit-button",type:"button",children:[{id:"shadow-container",children:[{id:"shadow-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"shadow-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"shadow-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]},{id:"button-container",children:[{id:"bg-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"bg-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"bg-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]}]},{id:"edit-button-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"edit-button-text",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"},{id:"craft-button",type:"button",children:[{id:"shadow-container",children:[{id:"shadow-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"shadow-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"shadow-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]},{id:"button-container",children:[{id:"bg-left",url:"ui/ui-button-bg-wide-left.png",anchor:[1,.5]},{id:"bg-centre",url:"ui/ui-button-bg-wide-centre.png",anchor:[.5,.5]},{id:"bg-right",url:"ui/ui-button-bg-wide-right.png",anchor:[0,.5]}]}]},{id:"craft-button-text",dir:"button-font-latin",fontname:"Swis721 BdRnd BT",fontdata:"button-font-latin.xml",type:"bitmaptext",alphabet:"latin"},{id:"craft-button-text",dir:"button-font-arabic",fontname:"Noto Kufi Arabic",fontdata:"button-font-arabic.xml",type:"bitmaptext",alphabet:"arabic"}]},audioAssets={"global-audio":[{url:"button-click-ui.mp3"},{url:"achievement.mp3"},{url:"unlock.mp3"},{url:"swipe-1.mp3"},{url:"swipe-3.mp3"},{url:"transition-out.mp3"},{url:"transition-in.mp3"},{url:"button-click-2.mp3"},{url:"bugs-carrot.mp3"},{url:"road-runner-beep-beep.mp3"},{url:"unlock.mp3"},{url:"spend-coins.mp3"},{url:"find-item.mp3"}],"craft-audio":[{url:"paint-pot-1.mp3"},{url:"paint-pot-2.mp3"},{url:"change-lane-up.mp3"},{url:"spooge-1.mp3",loop:!0},{url:"spooge-2.mp3",loop:!0},{url:"spooge-3.mp3"},{url:"swipe-1.mp3"},{url:"swipe-2.mp3"},{url:"small-pop.mp3"},{url:"boing-1.mp3"},{url:"boing-2.mp3"},{url:"boing-3.mp3"},{url:"sticker-1.mp3"},{url:"sticker-2.mp3"},{url:"sticker-3.mp3"},{url:"bolt-cut.mp3"},{url:"fit-wheels-1.mp3"},{url:"fit-wheels-2.mp3"},{url:"select-track.mp3"},{url:"music-craft.mp3",loop:!0},{url:"music-start.mp3",loop:!0},{url:"select-track-living-room.mp3",loop:!0},{url:"select-track-bathroom.mp3",loop:!0},{url:"select-track-garage.mp3",loop:!0}],"race-audio":[{url:"wb-impact.mp3"},{url:"lazer-zap.mp3"},{url:"bomb-1.mp3"},{url:"bomb-2.mp3"},{url:"bomb-3.mp3"},{url:"coin-collect.mp3"},{url:"whizz.mp3"},{url:"winner.mp3"},{url:"land.mp3"},{url:"level-up.mp3"},{url:"countdown.mp3"},{url:"swish-long-1.mp3"},{url:"swish-long-2.mp3"},{url:"swish-long-3.mp3"},{url:"thud-1.mp3"},{url:"thud-2.mp3"},{url:"car-impact-1.mp3"},{url:"car-impact-2.mp3"},{url:"car-impact-3.mp3"},{url:"car-accelerate.wav"},{url:"car-idle.wav",loop:!0},{url:"car-idle-high.wav",loop:!0},{url:"car-slow-down.mp3"},{url:"car-rev.wav"},{url:"brake.mp3"},{url:"change-lane-up.mp3"},{url:"change-lane-down.mp3"},{url:"oil-slick.mp3"},{url:"ice-skid-1.mp3"},{url:"ice-skid-2.mp3"},{url:"splat-1.mp3"},{url:"splat-2.mp3"},{url:"splat-3.mp3"},{url:"spooge-1.mp3"},{url:"spooge-2.mp3"},{url:"slap.mp3"},{url:"crash-1.mp3"},{url:"crash-2.mp3"},{url:"dynamite.mp3"},{url:"anvil-drop.mp3"},{url:"basketball-1.mp3"},{url:"basketball-2.mp3"},{url:"tom-slap.mp3"},{url:"tom-evil-laugh.mp3"},{url:"sandwich-impact.mp3"},{url:"thud.mp3"},{url:"wings-flap.wav",loop:!0},{url:"spinning.wav",loop:!0},{url:"fuse.wav",loop:!0},{url:"music-bathroom.mp3",loop:!0},{url:"music-living-room.mp3",loop:!0},{url:"music-garage.mp3",loop:!0},{url:"swipe-1.mp3"},{url:"swipe-2.mp3"}]},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Scene=function(t){function e(i,n){var o=t.call(this)||this;return o.game=i,o.interactive=!0,e.SORT_GROUP_BACK=new PIXI.display.Group(1,!1),o.container=new DisplayObjectContainer,o.addChild(o.container),o.container.interactive=!0,o.paused=!1,o.interactionLocked=!0,o.keyDownIDs=[],o.makeScenePluginScene(!1),n&&1==n&&o.makeScenePluginScene(!0),o}return __extends(e,t),e.prototype.rotatePause=function(){this.pausedRotated=!0},e.prototype.pause=function(t){0!=this.game.initLoaded&&(this.game.ui.pause(),1!=this.transitioning&&1!=this.interactionLocked&&1!=this.paused&&(this.paused=!0,this.game.ui.setUI("pause"),Game.playSound("beam-in.mp3"),this.transitioning=!1,this.interactionLocked=!0,this.pauseContainer=Game.displayStore.getContainer("pause-screen-overlay-container"),this.pauseOverlayBG=Game.displayStore.getSprite("pause-overlay"),this.pauseOverlayBG.alpha=.7,this.pauseOverlayBG.width=Game.stageWidth,this.pauseOverlayBG.height=Game.stageHeight,this.pauseOverlayBG.position.x=0,this.pauseOverlayBG.position.y=0,this.container.addChild(this.pauseOverlayBG),this.container.addChild(this.pauseContainer),this.pauseBG=this.pauseContainer.getSprite("global/pause-bg.png"),this.pauseBG.scale.set(0,0),this.pauseResumeTween(this.transitionTween,"pause"),this.pauseContainer.alpha=0,this.pauseTimeline=this.killTween(this.pauseTimeline),this.pauseTimeline=new TimelineMax,this.pauseTimeline.add(TweenMax.to(this.pauseContainer,.2,{alpha:1,ease:Expo.easeOut}),0),this.pauseTimeline.add(TweenMax.to(this.pauseBG.scale,.7,{x:1,y:1,ease:Elastic.easeOut}),0),this.interactionLocked=!1))},e.prototype.unlockInput=function(t){t.interactionLocked=!1},e.prototype.resume=function(){0!=this.game.initLoaded&&(this.game.ui.resume(),this.removePauseElements())},e.prototype.removePauseElements=function(){this.pauseContainer&&(this.container.removeChild(this.pauseContainer),this.container.removeChild(this.pauseOverlayBG)),this.pauseTimeline=this.killTween(this.pauseTimeline),1==Game.useFilters&&(this.pauseContainer.filters=null),this.pauseOverlayBG=null,this.pausedRotated=!1,this.paused=!1,this.pauseResumeTween(this.transitionTween,"resume")},e.prototype.restore=function(){this.interactionLocked=!1},e.prototype.destroy=function(){this.interactionLocked=!0;for(var t=this.container.children.length-1;t>=0;t--)this.container.removeChild(this.container.getChildAt(t));this.uiContainerRef=null,this.game.ui.sceneDestroy(),this.pauseTimeline=this.killTween(this.pauseTimeline)},e.prototype.init=function(t){this.paused=!1,this.setBackgroundColor(16777215)},e.prototype.setBackgroundColor=function(t){Game.renderer.backgroundColor=t},e.prototype.addUI=function(t){t&&(0==this.pluginScene?this.addChild(t):this.renderRootContainer.addChild(t),this.uiContainerRef=t)},e.prototype.uiClicked=function(t){if("soundonbutton"!=t.id&&"soundoffbutton"!=t.id||this.game.ui.soundToggled(),"help-button"==t.id){if(1==this.interactionLocked)return;this.interactionLocked=!0,this.game.setScene("helpScene",!1)}if("home-button"==t.id){if(1==this.interactionLocked)return;this.interactionLocked=!0,this.paused=!1;var e=this;this.game.loadAssets(Game.assetChunkManager.generateLoadChunk("home"),!0,function(){e.removePauseElements(),e.game.setScene(Game.assetChunkManager.getTargetScene(),!0)})}},e.prototype.tutorialOverlayClosed=function(){},e.prototype.secondChanceUse=function(){},e.prototype.uiRolledOver=function(t){},e.prototype.uiRolledOut=function(t){},e.prototype.downOnUI=function(t){},e.prototype.upOnUI=function(t){},e.prototype.keyDown=function(t){for(var e=0;e<this.keyDownIDs.length;e++)if(this.keyDownIDs[e]==t)return;this.keyDownIDs.push(t)},e.prototype.keyUp=function(t){for(var e=0;e<this.keyDownIDs.length;e++)this.keyDownIDs[e]==t&&this.keyDownIDs.splice(this.keyDownIDs.indexOf(t),1)},e.prototype.activatePowerUpEffect=function(){},e.prototype.deactivatePowerUpEffect=function(){},e.prototype.rolloutCustomButtonKeyboard=function(t){},e.prototype.rolloverCustomButtonKeyboard=function(t){},e.prototype.selectCustomButtonKeyboard=function(t){},e.prototype.tick=function(t){0!=this.game.initLoaded&&0==this.interactive&&(this.interactive=!0)},e.prototype.resize=function(t){this.container.scale.x=t,this.container.scale.y=t},e.prototype.initTransitionOut=function(t,e){var i=this;if(0==this.game.initLoaded)return this.interactionLocked=!1,void(this.transitioning=!1);t>0&&(this.transitioning=!0,this.interactionLocked=!0,Game.playSound("transition-out.mp3",.5),this.setUpTransition(),this.brushTransition.tint=e||16777215,this.brushTransition.animationSpeed=.7,this.brushTransition.onComplete=function(){i.brushTransition.visible=!1},this.brushTransition.gotoAndPlay(0))},e.prototype.initTransitionIn=function(t,e){var i=this;if(0==this.game.initLoaded)return this.interactionLocked=!1,void(this.transitioning=!1);t>0?(this.transitioning=!0,this.interactionLocked=!0,Game.playSound("transition-in.mp3",.5),this.setUpTransition(),this.brushTransition.tint=e||16777215,this.brushTransition.animationSpeed=-.7,this.brushTransition.onComplete=function(){i.brushTransition.visible=!1,i.killTransitionAssets(i)},this.brushTransition.gotoAndPlay(24)):this.killTransitionAssets(this)},e.prototype.updateTransition=function(t){},e.prototype.setUpTransition=function(){this.transitionHolder=Game.displayStore.getContainer("brush-transition-holder"),1==this.game.initLoaded&&(this.brushTransition=this.transitionHolder.getAnimatedSprite("brush-transition-frames"),this.brushTransition.width=Game.stageWidth,this.brushTransition.height=Game.stageHeight,this.brushTransition.loop=!1,this.brushTransition.gotoAndStop(0),this.brushTransition.visible=!0,this.transitionHolder.setRegPointPixels(Game.stageWidth/2,Game.stageHeight/2,!0),this.transitionHolder.scale.x=2*Game.getRandom(0,1,!0)-1,this.transitionHolder.scale.y=2*Game.getRandom(0,1,!0)-1),this.uiContainerRef&&this.uiContainerRef.addChild(this.transitionHolder)},e.prototype.killTransitionAssets=function(t){t.transitionHolder&&t.transitionHolder.parent&&t.uiContainerRef&&t.uiContainerRef.removeChild(t.transitionHolder),t.transitioning=!1,t.interactionLocked=!1,t.transitionTween&&t.transitionTween.kill()},e.prototype.pauseResumeTween=function(t,e,i){t&&("pause"==e?(t.totalProgress()>0&&t.totalProgress()<1||0*t.totalProgress()!=0)&&t.pause():"resume"==e&&(t.totalProgress()>0&&t.totalProgress()<1||0*t.totalProgress()!=0)&&t.paused&&t.resume())},e.prototype.killTween=function(t){return t&&(t.kill(),t=null),t},e.prototype.shuffleArray=function(t){for(var e,i,n=t.length;n>0;)i=Math.floor(Math.random()*n),e=t[--n],t[n]=t[i],t[i]=e;return t},e.prototype.simpleEase=function(t,e,i){return t+=(e-t)/i,t=Math.round(1e3*t)/1e3},e.prototype.makeScenePluginScene=function(t){this.pluginScene=t,0==t?this.renderRootContainer=this:1==t&&(this.renderRootContainer=new PIXI.display.Stage,this.renderRootContainer.addChild(this.container))},e.prototype.getRenderRootContainer=function(){return this.renderRootContainer},e.prototype.onLoadUpdate=function(t,e){},e.prototype.getPreloaderAssetList=function(){return[]},e}(PIXI.Container),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sprite=function(t){function e(e){var i=t.call(this,e)||this;return i.neverFlush=!1,i.origX=0,i.origY=0,i.origAnchor={x:0,y:0,compensate:!1},i.defaultAnchor=!0,i.pooled=!1,i.pooledActive=!1,i.disposeAssetsOnDestroy=!1,i}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.destroy=function(){1!=this.disposeAssetsOnDestroy?t.prototype.destroy.call(this):t.prototype.destroy.call(this,!0)},e.prototype.disposeAssets=function(){Game.displayStore.disposeAssets(this)},e.prototype.destroyRenderTexture=function(){this.texture.destroy(!0)},e.prototype.setTextureResolution=function(t){Game.displayStore.setTextureResolution(this,t)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPoint(this,t,e,i)},e}(PIXI.Sprite),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sprite2s=function(t){function e(e){var i=t.call(this,e)||this;return i.neverFlush=!1,i.origX=0,i.origY=0,i.origAnchor={x:0,y:0,compensate:!1},i.defaultAnchor=!0,i.pooled=!1,i.pooledActive=!1,i.disposeAssetsOnDestroy=!1,i}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.destroy=function(){1!=this.disposeAssetsOnDestroy?t.prototype.destroy.call(this):t.prototype.destroy.call(this,!0)},e.prototype.disposeAssets=function(){Game.displayStore.disposeAssets(this)},e.prototype.destroyRenderTexture=function(){this.texture.destroy(!0)},e.prototype.setTextureResolution=function(t){Game.displayStore.setTextureResolution(this,t)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPoint(this,t,e,i)},e}(PIXI.projection.Sprite2s),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sprite2d=function(t){function e(e){var i=t.call(this,e)||this;return i.neverFlush=!1,i.origX=0,i.origY=0,i.origAnchor={x:0,y:0,compensate:!1},i.defaultAnchor=!0,i.pooled=!1,i.pooledActive=!1,i.disposeAssetsOnDestroy=!1,i}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.destroy=function(){1!=this.disposeAssetsOnDestroy?t.prototype.destroy.call(this):t.prototype.destroy.call(this,!0)},e.prototype.disposeAssets=function(){Game.displayStore.disposeAssets(this)},e.prototype.destroyRenderTexture=function(){this.texture.destroy(!0)},e.prototype.setTextureResolution=function(t){Game.displayStore.setTextureResolution(this,t)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPoint(this,t,e,i)},e}(PIXI.projection.Sprite2d),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sprite3d=function(t){function e(e){var i=t.call(this,e)||this;return i.neverFlush=!1,i.origX=0,i.origY=0,i.origAnchor={x:0,y:0,compensate:!1},i.defaultAnchor=!0,i.pooled=!1,i.pooledActive=!1,i.disposeAssetsOnDestroy=!1,i}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.destroy=function(){1!=this.disposeAssetsOnDestroy?t.prototype.destroy.call(this):t.prototype.destroy.call(this,!0)},e.prototype.disposeAssets=function(){Game.displayStore.disposeAssets(this)},e.prototype.destroyRenderTexture=function(){this.texture.destroy(!0)},e.prototype.setTextureResolution=function(t){Game.displayStore.setTextureResolution(this,t)},e.prototype.setRegPoint=function(t,e,i){Game.displayStore.setRegPoint(this,t,e,i)},e}(PIXI.projection.Sprite3d),pixi_projection;!function(t){!function(t){t.createIndicesForQuads=function(t){for(var e=6*t,i=new Uint16Array(e),n=0,o=0;n<e;n+=6,o+=4)i[n+0]=o+0,i[n+1]=o+1,i[n+2]=o+2,i[n+3]=o+0,i[n+4]=o+2,i[n+5]=o+3;return i},t.isPow2=function(t){return!(t&t-1||!t)},t.nextPow2=function(t){return t+=+(0===t),--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},t.log2=function(t){var e,i;return e=+(t>65535)<<4,t>>>=e,i=+(t>255)<<3,t>>>=i,e|=i,i=+(t>15)<<2,t>>>=i,e|=i,i=+(t>3)<<1,t>>>=i,(e|=i)|t>>1},t.getIntersectionFactor=function(t,e,i,n,o){var r=e.x-t.x,a=i.x-n.x,s=i.x-t.x,l=e.y-t.y,c=i.y-n.y,h=i.y-t.y,p=r*c-l*a;if(Math.abs(p)<1e-7)return o.x=r,o.y=l,0;var u=(s*c-h*a)/p,d=(r*h-l*s)/p;return d<1e-6||d-1>-1e-6?-1:(o.x=t.x+u*(e.x-t.x),o.y=t.y+u*(e.y-t.y),1)},t.getPositionFromQuad=function(t,e,i){i=i||new PIXI.Point;var n=1-e.x,o=1-n,r=1-e.y,a=1-r;return i.x=(t[0].x*n+t[1].x*o)*r+(t[3].x*n+t[2].x*o)*a,i.y=(t[0].y*n+t[1].y*o)*r+(t[3].y*n+t[2].y*o)*a,i}}(t.utils||(t.utils={}))}(pixi_projection||(pixi_projection={})),PIXI.projection=pixi_projection;var pixi_projection;!function(t){var e=function(){function t(t,e){void 0===e&&(e=!0),this._enabled=!1,this.legacy=t,e&&(this.enabled=!0),this.legacy.proj=this}return Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t},enumerable:!0,configurable:!0}),t.prototype.clear=function(){},t}();t.AbstractProjection=e;!function(t){t[t.NONE=0]="NONE",t[t.BEFORE_PROJ=4]="BEFORE_PROJ",t[t.PROJ=5]="PROJ",t[t.ALL=9]="ALL"}(t.TRANSFORM_STEP||(t.TRANSFORM_STEP={}))}(pixi_projection||(pixi_projection={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pixi_projection;!function(t){function e(t){var e=this.proj,i=this,n=t._worldID,o=i.localTransform;i._localID!==i._currentLocalID&&(o.a=i._cx*i.scale._x,o.b=i._sx*i.scale._x,o.c=i._cy*i.scale._y,o.d=i._sy*i.scale._y,o.tx=i.position._x-(i.pivot._x*o.a+i.pivot._y*o.c),o.ty=i.position._y-(i.pivot._x*o.b+i.pivot._y*o.d),i._currentLocalID=i._localID,e._currentProjID=-1);var r=e._projID;if(e._currentProjID!==r&&(e._currentProjID=r,e.updateLocalTransform(o),i._parentID=-1),i._parentID!==n){var a=t.proj;a&&!a._affine?e.world.setToMult(a.world,e.local):e.world.setToMultLegacy(t.worldTransform,e.local),e.world.copy(i.worldTransform,e._affine),i._parentID=n,i._worldID++}}var i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._projID=0,e._currentProjID=-1,e._affine=t.AFFINE.NONE,e}return __extends(n,i),n.prototype.updateLocalTransform=function(t){},Object.defineProperty(n.prototype,"affine",{get:function(){return this._affine},set:function(t){this._affine!=t&&(this._affine=t,this._currentProjID=-1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=e,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.TransformStatic.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),n.prototype.clear=function(){this._currentProjID=-1,this._projID=0},n}(t.AbstractProjection);t.LinearProjection=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){!function(t){var e=function(){function t(t){this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null},t}();t.BatchBuffer=e}(t.webgl||(t.webgl={}))}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){!function(e){var i=PIXI.ObjectRenderer,n=PIXI.settings,o=PIXI.glCore.GLBuffer,r=PIXI.utils.premultiplyTint,a=PIXI.utils.premultiplyBlendMode,s=0,l=function(){return function(){this.textures=[],this.textureCount=0,this.ids=[],this.size=0,this.start=0,this.blend=PIXI.BLEND_MODES.NORMAL,this.uniforms=null}}();e.BatchGroup=l;var c=function(i){function c(e){var o=i.call(this,e)||this;o.shaderVert="",o.shaderFrag="",o.MAX_TEXTURES_LOCAL=32,o.vertSize=5,o.vertByteSize=4*o.vertSize,o.size=n.SPRITE_BATCH_SIZE,o.currentIndex=0,o.sprites=[],o.vertexBuffers=[],o.vaos=[],o.vaoMax=2,o.vertexCount=0,o.MAX_TEXTURES=1,o.indices=t.utils.createIndicesForQuads(o.size),o.groups=[];for(var r=0;r<o.size;r++)o.groups[r]=new l;return o.vaoMax=2,o.vertexCount=0,o.renderer.on("prerender",o.onPrerender,o),o}return __extends(c,i),c.prototype.getUniforms=function(t){return null},c.prototype.syncUniforms=function(t){if(t){var e=this.shader;for(var i in t)e.uniforms[i]=t[i]}},c.prototype.onContextChange=function(){var i=this.renderer.gl;this.MAX_TEXTURES=Math.min(this.MAX_TEXTURES_LOCAL,this.renderer.plugins.sprite.MAX_TEXTURES),this.shader=e.generateMultiTextureShader(this.shaderVert,this.shaderFrag,i,this.MAX_TEXTURES),this.indexBuffer=o.createIndexBuffer(i,this.indices,i.STATIC_DRAW),this.renderer.bindVao(null);this.shader.attributes;for(r=0;r<this.vaoMax;r++){var n=this.vertexBuffers[r]=o.createVertexBuffer(i,null,i.STREAM_DRAW);this.vaos[r]=this.createVao(n)}if(!this.buffers){this.buffers=[];for(var r=1;r<=t.utils.nextPow2(this.size);r*=2)this.buffers.push(new e.BatchBuffer(4*r*this.vertByteSize))}this.vao=this.vaos[0]},c.prototype.onPrerender=function(){this.vertexCount=0},c.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&t._texture.baseTexture&&(this.sprites[this.currentIndex++]=t)},c.prototype.flush=function(){if(0!==this.currentIndex){var e,i,l=this.renderer.gl,c=this.MAX_TEXTURES,h=t.utils.nextPow2(this.currentIndex),p=t.utils.log2(h),u=this.buffers[p],d=this.sprites,f=this.groups,m=u.float32View,g=u.uint32View,y=0,v=null,b=1,w=0,x=f[0],_=a[d[0]._texture.baseTexture.premultipliedAlpha?1:0][d[0].blendMode];x.textureCount=0,x.start=0,x.blend=_,s++;var S;for(S=0;S<this.currentIndex;++S){var T=d[S];e=T._texture.baseTexture;var P=a[Number(e.premultipliedAlpha)][T.blendMode];_!==P&&(_=P,i=null,w=c,s++);var C=this.getUniforms(T);v!==C&&(v=C,i=null,w=c,s++),i!==e&&(i=e,e._enabled!==s&&(w===c&&(s++,w=0,x.size=S-x.start,(x=f[b++]).textureCount=0,x.blend=_,x.start=S,x.uniforms=v),e._enabled=s,e._virtalBoundId=w,x.textures[x.textureCount++]=e,w++));var I=Math.min(T.worldAlpha,1),k=I<1&&e.premultipliedAlpha?r(T._tintRGB,I):T._tintRGB+(255*I<<24);this.fillVertices(m,g,y,T,k,e._virtalBoundId),y+=4*this.vertSize}if(x.size=S-x.start,n.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(u.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;this.shader.attributes;var A=this.vertexBuffers[this.vertexCount]=o.createVertexBuffer(l,null,l.STREAM_DRAW);this.vaos[this.vertexCount]=this.createVao(A)}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(u.vertices,0,!1),this.vertexCount++}for(v=null,S=0;S<b;S++){var M=f[S],O=M.textureCount;M.uniforms!==v&&this.syncUniforms(M.uniforms);for(var R=0;R<O;R++){this.renderer.bindTexture(M.textures[R],R,!0),M.textures[R]._virtalBoundId=-1;var B=this.shader.uniforms.samplerSize;B&&(B[0]=M.textures[R].realWidth,B[1]=M.textures[R].realHeight,this.shader.uniforms.samplerSize=B)}this.renderer.state.setBlendMode(M.blend),l.drawElements(l.TRIANGLES,6*M.size,l.UNSIGNED_SHORT,6*M.start*2)}this.currentIndex=0}},c.prototype.start=function(){this.renderer.bindShader(this.shader),n.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},c.prototype.stop=function(){this.flush()},c.prototype.destroy=function(){for(t=0;t<this.vaoMax;t++)this.vertexBuffers[t]&&this.vertexBuffers[t].destroy(),this.vaos[t]&&this.vaos[t].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),i.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var t=0;t<this.buffers.length;++t)this.buffers[t].destroy()},c}(i);e.MultiTextureSpriteRenderer=c}(t.webgl||(t.webgl={}))}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){!function(t){function e(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(textureId == "+i+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], textureCoord);",e+="\n}";return e+="\n",e+="\n"}t.generateMultiTextureShader=function(t,i,n,o){i=(i=i.replace(/%count%/gi,o+"")).replace(/%forloop%/gi,e(o));for(var r=new PIXI.Shader(n,t,i),a=new Int32Array(o),s=0;s<o;s++)a[s]=s;return r.bind(),r.uniforms.uSamplers=a,r}}(t.webgl||(t.webgl={}))}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],i=[0,0,0,0],n=function(){function t(){this.surfaceID="default",this._updateID=0,this.vertexSrc="",this.fragmentSrc=""}return t.prototype.fillUniforms=function(t){},t.prototype.clear=function(){},t.prototype.boundsQuad=function(t,n,o){for(var r=n[0],a=n[1],s=n[0],l=n[1],c=2;c<8;c+=2)r>n[c]&&(r=n[c]),s<n[c]&&(s=n[c]),a>n[c+1]&&(a=n[c+1]),l<n[c+1]&&(l=n[c+1]);if(e[0].set(r,a),this.apply(e[0],e[0]),e[1].set(s,a),this.apply(e[1],e[1]),e[2].set(s,l),this.apply(e[2],e[2]),e[3].set(r,l),this.apply(e[3],e[3]),o)o.apply(e[0],e[0]),o.apply(e[1],e[1]),o.apply(e[2],e[2]),o.apply(e[3],e[3]),n[0]=e[0].x,n[1]=e[0].y,n[2]=e[1].x,n[3]=e[1].y,n[4]=e[2].x,n[5]=e[2].y,n[6]=e[3].x,n[7]=e[3].y;else{for(c=1;c<=3;c++)if(e[c].y<e[0].y||e[c].y==e[0].y&&e[c].x<e[0].x){p=e[0];e[0]=e[c],e[c]=p}for(c=1;c<=3;c++)i[c]=Math.atan2(e[c].y-e[0].y,e[c].x-e[0].x);for(c=1;c<=3;c++)for(var h=c+1;h<=3;h++)if(i[c]>i[h]){var p=e[c];e[c]=e[h],e[h]=p;var u=i[c];i[c]=i[h],i[h]=u}if(n[0]=e[0].x,n[1]=e[0].y,n[2]=e[1].x,n[3]=e[1].y,n[4]=e[2].x,n[5]=e[2].y,n[6]=e[3].x,n[7]=e[3].y,(e[3].x-e[2].x)*(e[1].y-e[2].y)-(e[1].x-e[2].x)*(e[3].y-e[2].y)<0)return n[4]=e[3].x,void(n[5]=e[3].y)}},t}();t.Surface=n}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.Matrix,i=new PIXI.Rectangle,n=new PIXI.Point,o=function(t){function o(){var e=t.call(this)||this;return e.distortion=new PIXI.Point,e}return __extends(o,t),o.prototype.clear=function(){this.distortion.set(0,0)},o.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.distortion,n=t.x*t.y;return e.x=t.x+i.x*n,e.y=t.y+i.y*n,e},o.prototype.applyInverse=function(t,e){e=e||new PIXI.Point;var i=t.x,n=t.y,o=this.distortion.x,r=this.distortion.y;if(0==o)e.x=i,e.y=n/(1+r*i);else if(0==r)e.y=n,e.x=i/(1+o*n);else{var a=.5*(n*o-i*r+1)/r,s=a*a+i/r;if(s<=1e-5)return void e.set(NaN,NaN);e.x=r>0?-a+Math.sqrt(s):-a-Math.sqrt(s),e.y=(i/e.x-1)/o}return e},o.prototype.mapSprite=function(t,e,n){var o=t.texture;return i.x=-t.anchor.x*o.orig.width,i.y=-t.anchor.y*o.orig.height,i.width=o.orig.width,i.height=o.orig.height,this.mapQuad(i,e,n||t.transform)},o.prototype.mapQuad=function(t,i,o){var r=-t.x/t.width,a=-t.y/t.height,s=(1-t.x)/t.width,l=(1-t.y)/t.height,c=i[0].x*(1-r)+i[1].x*r,h=i[0].y*(1-r)+i[1].y*r,p=i[0].x*(1-s)+i[1].x*s,u=i[0].y*(1-s)+i[1].y*s,d=i[3].x*(1-r)+i[2].x*r,f=i[3].y*(1-r)+i[2].y*r,m=i[3].x*(1-s)+i[2].x*s,g=i[3].y*(1-s)+i[2].y*s,y=c*(1-a)+d*a,v=h*(1-a)+f*a,b=p*(1-a)+m*a,w=u*(1-a)+g*a,x=c*(1-l)+d*l,_=h*(1-l)+f*l,S=p*(1-l)+m*l,T=u*(1-l)+g*l,P=e;return P.tx=y,P.ty=v,P.a=b-y,P.b=w-v,P.c=x-y,P.d=_-v,n.set(S,T),P.applyInverse(n,n),this.distortion.set(n.x-1,n.y-1),o.setFromMatrix(P),this},o.prototype.fillUniforms=function(t){t.distortion=t.distortion||new Float32Array([0,0,0,0]);var e=Math.abs(this.distortion.x),i=Math.abs(this.distortion.y);t.distortion[0]=1e4*e<=i?0:this.distortion.x,t.distortion[1]=1e4*i<=e?0:this.distortion.y,t.distortion[2]=1/t.distortion[0],t.distortion[3]=1/t.distortion[1]},o}(t.Surface);t.BilinearSurface=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.proj=new t.ProjectionSurface(i.transform),i}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),i}(PIXI.Container);t.Container2s=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(t){var e=this.proj,n=t.proj,o=this;return n?n._surface?(e._activeProjection=n,this.updateLocalTransform(),this.localTransform.copy(this.worldTransform),void(o._parentID<0&&++o._worldID)):(i.call(this,t),void(e._activeProjection=n._activeProjection)):(i.call(this,t),void(e._activeProjection=null))}var i=PIXI.TransformStatic.prototype.updateTransform,n=function(i){function n(t,e){var n=i.call(this,t,e)||this;return n._surface=null,n._activeProjection=null,n._currentSurfaceID=-1,n._currentLegacyID=-1,n._lastUniforms=null,n}return __extends(n,i),Object.defineProperty(n.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=e,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.TransformStatic.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"surface",{get:function(){return this._surface},set:function(t){this._surface!=t&&(this._surface=t||null,this.legacy._parentID=-1)},enumerable:!0,configurable:!0}),n.prototype.applyPartial=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e)):null!==this._surface?this.surface.apply(t,e):this.legacy.worldTransform.apply(t,e)},n.prototype.apply=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e),this._activeProjection.legacy.worldTransform.apply(e,e)):null!==this._surface?(e=this.surface.apply(t,e),this.legacy.worldTransform.apply(e,e)):this.legacy.worldTransform.apply(t,e)},n.prototype.applyInverse=function(t,e){return null!==this._activeProjection?(e=this._activeProjection.legacy.worldTransform.applyInverse(t,e),this._activeProjection._surface.applyInverse(e,e),this.legacy.worldTransform.applyInverse(e,e)):null!==this._surface?(e=this.legacy.worldTransform.applyInverse(t,e),this._surface.applyInverse(e,e)):this.legacy.worldTransform.applyInverse(t,e)},n.prototype.mapBilinearSprite=function(e,i){this._surface instanceof t.BilinearSurface||(this.surface=new t.BilinearSurface),this.surface.mapSprite(e,i,this.legacy)},n.prototype.clear=function(){this.surface&&this.surface.clear()},Object.defineProperty(n.prototype,"uniforms",{get:function(){return this._currentLegacyID===this.legacy._worldID&&this._currentSurfaceID===this.surface._updateID?this._lastUniforms:(this._lastUniforms=this._lastUniforms||{},this._lastUniforms.worldTransform=this.legacy.worldTransform.toArray(!0),this._surface.fillUniforms(this._lastUniforms),this._lastUniforms)},enumerable:!0,configurable:!0}),n}(t.AbstractProjection);t.ProjectionSurface=n}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=100,e.MAX_TEXTURES_LOCAL=1,e.shaderVert="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec3 aTrans1;\nattribute vec3 aTrans2;\nattribute vec4 aFrame;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 worldTransform;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * worldTransform * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aVertexPosition;\n    vTrans1 = aTrans1;\n    vTrans2 = aTrans2;\n    vTextureId = aTextureId;\n    vColor = aColor;\n    vFrame = aFrame;\n}\n",e.shaderFrag="precision highp float;\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\nuniform vec2 samplerSize[%count%]; \nuniform vec4 distortion;\n\nvoid main(void){\nvec2 surface;\nvec2 surface2;\n\nfloat vx = vTextureCoord.x;\nfloat vy = vTextureCoord.y;\nfloat dx = distortion.x;\nfloat dy = distortion.y;\nfloat revx = distortion.z;\nfloat revy = distortion.w;\n\nif (distortion.x == 0.0) {\n    surface.x = vx;\n    surface.y = vy / (1.0 + dy * vx);\n    surface2 = surface;\n} else\nif (distortion.y == 0.0) {\n    surface.y = vy;\n    surface.x = vx/ (1.0 + dx * vy);\n    surface2 = surface;\n} else {\n    float c = vy * dx - vx * dy;\n    float b = (c + 1.0) * 0.5;\n    float b2 = (-c + 1.0) * 0.5;\n    float d = b * b + vx * dy;\n    if (d < -0.00001) {\n        discard;\n    }\n    d = sqrt(max(d, 0.0));\n    surface.x = (- b + d) * revy;\n    surface2.x = (- b - d) * revy;\n    surface.y = (- b2 + d) * revx;\n    surface2.y = (- b2 - d) * revx;\n}\n\nvec2 uv;\nuv.x = vTrans1.x * surface.x + vTrans1.y * surface.y + vTrans1.z;\nuv.y = vTrans2.x * surface.x + vTrans2.y * surface.y + vTrans2.z;\n\nvec2 pixels = uv * samplerSize[0];\n\nif (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n    pixels.y < vFrame.y || pixels.y > vFrame.w) {\n    uv.x = vTrans1.x * surface2.x + vTrans1.y * surface2.y + vTrans1.z;\n    uv.y = vTrans2.x * surface2.x + vTrans2.y * surface2.y + vTrans2.z;\n    pixels = uv * samplerSize[0];\n    \n    if (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n        pixels.y < vFrame.y || pixels.y > vFrame.w) {\n        discard;\n    }\n}\n\nvec4 edge;\nedge.xy = clamp(pixels - vFrame.xy + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\nedge.zw = clamp(vFrame.zw - pixels + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\n\nfloat alpha = 1.0; //edge.x * edge.y * edge.z * edge.w;\nvec4 rColor = vColor * alpha;\n\nfloat textureId = floor(vTextureId+0.5);\nvec4 color;\nvec2 textureCoord = uv;\n%forloop%\ngl_FragColor = color * rColor;\n}",e.defUniforms={worldTransform:new Float32Array([1,0,0,0,1,0,0,0,1]),distortion:new Float32Array([0,0])},e}return __extends(e,t),e.prototype.getUniforms=function(t){var e=t.proj;this.shader;return null!==e.surface?e.uniforms:null!==e._activeProjection?e._activeProjection.uniforms:this.defUniforms},e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=14,this.vertByteSize=4*this.vertSize;var i=this.renderer.gl,n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,i.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTrans1,i.FLOAT,!1,this.vertByteSize,8).addAttribute(t,e.aTrans2,i.FLOAT,!1,this.vertByteSize,20).addAttribute(t,e.aFrame,i.FLOAT,!1,this.vertByteSize,32).addAttribute(t,e.aColor,i.UNSIGNED_BYTE,!0,this.vertByteSize,48);return e.aTextureId&&n.addAttribute(t,e.aTextureId,i.FLOAT,!1,this.vertByteSize,52),n},e.prototype.fillVertices=function(t,e,i,n,o,r){for(var a=n.vertexData,s=n._texture,l=(s.orig.width,s.orig.height,n._anchor._x,n._anchor._y,s._frame),c=n.aTrans,h=0;h<4;h++)t[i]=a[2*h],t[i+1]=a[2*h+1],t[i+2]=c.a,t[i+3]=c.c,t[i+4]=c.tx,t[i+5]=c.b,t[i+6]=c.d,t[i+7]=c.ty,t[i+8]=l.x,t[i+9]=l.y,t[i+10]=l.x+l.width,t[i+11]=l.y+l.height,e[i+12]=o,t[i+13]=r,i+=14},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite_bilinear",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=100,e.MAX_TEXTURES_LOCAL=1,e.shaderVert="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec3 aTrans1;\nattribute vec3 aTrans2;\nattribute vec4 aFrame;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 worldTransform;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * worldTransform * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aVertexPosition;\n    vTrans1 = aTrans1;\n    vTrans2 = aTrans2;\n    vTextureId = aTextureId;\n    vColor = aColor;\n    vFrame = aFrame;\n}\n",e.shaderFrag="precision highp float;\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\nuniform vec2 samplerSize[%count%]; \nuniform vec4 params;\n\nvoid main(void){\nvec2 surface;\n\nfloat vx = vTextureCoord.x;\nfloat vy = vTextureCoord.y;\nfloat aleph = params.x;\nfloat bet = params.y;\nfloat A = params.z;\nfloat B = params.w;\n\nif (aleph == 0.0) {\n\tsurface.y = vy / (1.0 + vx * bet);\n\tsurface.x = vx;\n}\nelse if (bet == 0.0) {\n\tsurface.x = vx / (1.0 + vy * aleph);\n\tsurface.y = vy;\n} else {\n\tsurface.x = vx * (bet + 1.0) / (bet + 1.0 + vy * aleph);\n\tsurface.y = vy * (aleph + 1.0) / (aleph + 1.0 + vx * bet);\n}\n\nvec2 uv;\nuv.x = vTrans1.x * surface.x + vTrans1.y * surface.y + vTrans1.z;\nuv.y = vTrans2.x * surface.x + vTrans2.y * surface.y + vTrans2.z;\n\nvec2 pixels = uv * samplerSize[0];\n\nvec4 edge;\nedge.xy = clamp(pixels - vFrame.xy + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\nedge.zw = clamp(vFrame.zw - pixels + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\n\nfloat alpha = edge.x * edge.y * edge.z * edge.w;\nvec4 rColor = vColor * alpha;\n\nfloat textureId = floor(vTextureId+0.5);\nvec4 color;\nvec2 textureCoord = uv;\n%forloop%\ngl_FragColor = color * rColor;\n}",e.defUniforms={worldTransform:new Float32Array([1,0,0,0,1,0,0,0,1]),distortion:new Float32Array([0,0])},e}return __extends(e,t),e.prototype.getUniforms=function(t){var e=t.proj;this.shader;return null!==e.surface?e.uniforms:null!==e._activeProjection?e._activeProjection.uniforms:this.defUniforms},e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=14,this.vertByteSize=4*this.vertSize;var i=this.renderer.gl,n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,i.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTrans1,i.FLOAT,!1,this.vertByteSize,8).addAttribute(t,e.aTrans2,i.FLOAT,!1,this.vertByteSize,20).addAttribute(t,e.aFrame,i.FLOAT,!1,this.vertByteSize,32).addAttribute(t,e.aColor,i.UNSIGNED_BYTE,!0,this.vertByteSize,48);return e.aTextureId&&n.addAttribute(t,e.aTextureId,i.FLOAT,!1,this.vertByteSize,52),n},e.prototype.fillVertices=function(t,e,i,n,o,r){for(var a=n.vertexData,s=n._texture,l=(s.orig.width,s.orig.height,n._anchor._x,n._anchor._y,s._frame),c=n.aTrans,h=0;h<4;h++)t[i]=a[2*h],t[i+1]=a[2*h+1],t[i+2]=c.a,t[i+3]=c.c,t[i+4]=c.tx,t[i+5]=c.b,t[i+6]=c.d,t[i+7]=c.ty,t[i+8]=l.x,t[i+9]=l.y,t[i+10]=l.x+l.width,t[i+11]=l.y+l.height,e[i+12]=o,t[i+13]=r,i+=14},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite_strange",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.Matrix,i=new PIXI.Rectangle,n=new PIXI.Point,o=function(t){function o(){var e=t.call(this)||this;return e.params=[0,0,NaN,NaN],e}return __extends(o,t),o.prototype.clear=function(){var t=this.params;t[0]=0,t[1]=0,t[2]=NaN,t[3]=NaN},o.prototype.setAxisX=function(t,e,i){var n=t.x,o=t.y,r=Math.sqrt(n*n+o*o),a=i.rotation;0!==a&&(i.skew._x-=a,i.skew._y+=a,i.rotation=0),i.skew.y=Math.atan2(o,n);var s=this.params;s[2]=0!==e?-r*e:NaN,this._calc01()},o.prototype.setAxisY=function(t,e,i){var n=t.x,o=t.y,r=Math.sqrt(n*n+o*o),a=i.rotation;0!==a&&(i.skew._x-=a,i.skew._y+=a,i.rotation=0),i.skew.x=-Math.atan2(o,n)+Math.PI/2;var s=this.params;s[3]=0!==e?-r*e:NaN,this._calc01()},o.prototype._calc01=function(){var t=this.params;if(isNaN(t[2]))t[1]=0,isNaN(t[3])?t[0]=0:t[0]=1/t[3];else if(isNaN(t[3]))t[0]=0,t[1]=1/t[2];else{var e=1-t[2]*t[3];t[0]=(1-t[2])/e,t[1]=(1-t[3])/e}},o.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.params[0],n=this.params[1],o=this.params[2],r=this.params[3],a=t.x,s=t.y;if(0===i)e.y=s*(1+a*n),e.x=a;else if(0===n)e.x=a*(1+s*i),e.y=s;else{var l=o*r-s*a;e.x=o*a*(r+s)/l,e.y=r*s*(o+a)/l}return e},o.prototype.applyInverse=function(t,e){e=e||new PIXI.Point;var i=this.params[0],n=this.params[1],o=(this.params[2],this.params[3],t.x),r=t.y;return 0===i?(e.y=r/(1+o*n),e.x=o):0===n?(e.x=o*(1+r*i),e.y=r):(e.x=o*(n+1)/(n+1+r*i),e.y=r*(i+1)/(i+1+o*n)),e},o.prototype.mapSprite=function(t,e,n){var o=t.texture;return i.x=-t.anchor.x*o.orig.width,i.y=-t.anchor.y*o.orig.height,i.width=o.orig.width,i.height=o.orig.height,this.mapQuad(i,e,n||t.transform)},o.prototype.mapQuad=function(t,i,o){var r=-t.x/t.width,a=-t.y/t.height,s=(1-t.x)/t.width,l=(1-t.y)/t.height,c=i[0].x*(1-r)+i[1].x*r,h=i[0].y*(1-r)+i[1].y*r,p=i[0].x*(1-s)+i[1].x*s,u=i[0].y*(1-s)+i[1].y*s,d=i[3].x*(1-r)+i[2].x*r,f=i[3].y*(1-r)+i[2].y*r,m=i[3].x*(1-s)+i[2].x*s,g=i[3].y*(1-s)+i[2].y*s,y=c*(1-a)+d*a,v=h*(1-a)+f*a,b=p*(1-a)+m*a,w=u*(1-a)+g*a,x=c*(1-l)+d*l,_=h*(1-l)+f*l,S=p*(1-l)+m*l,T=u*(1-l)+g*l,P=e;return P.tx=y,P.ty=v,P.a=b-y,P.b=w-v,P.c=x-y,P.d=_-v,n.set(S,T),P.applyInverse(n,n),o.setFromMatrix(P),this},o.prototype.fillUniforms=function(t){var e=this.params,i=t.params||new Float32Array([0,0,0,0]);t.params=i,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]},o}(t.Surface);t.StrangeSurface=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.aTrans=new PIXI.Matrix,n.proj=new t.ProjectionSurface(n.transform),n.pluginName="sprite_bilinear",n}return __extends(i,e),i.prototype._calculateBounds=function(){this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)},i.prototype.calculateVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this._transformID!==t||this._textureID!==e){this._transformID=t,this._textureID=e;var i=this._texture,n=this.vertexData,o=i.trim,r=i.orig,a=this._anchor,s=0,l=0,c=0,h=0;if(o?(s=(l=o.x-a._x*r.width)+o.width,c=(h=o.y-a._y*r.height)+o.height):(s=(l=-a._x*r.width)+r.width,c=(h=-a._y*r.height)+r.height),this.proj._surface)n[0]=l,n[1]=h,n[2]=s,n[3]=h,n[4]=s,n[5]=c,n[6]=l,n[7]=c,this.proj._surface.boundsQuad(n,n);else{var p=this.transform.worldTransform,u=p.a,d=p.b,f=p.c,m=p.d,g=p.tx,y=p.ty;n[0]=u*l+f*h+g,n[1]=m*h+d*l+y,n[2]=u*s+f*h+g,n[3]=m*h+d*s+y,n[4]=u*s+f*c+g,n[5]=m*c+d*s+y,n[6]=u*l+f*c+g,n[7]=m*c+d*l+y,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(n,n)}i.transform||(i.transform=new PIXI.TextureMatrix(i)),i.transform.update();var v=this.aTrans;v.set(r.width,0,0,r.height,l,h),null===this.proj._surface&&v.prepend(this.transform.worldTransform),v.invert(),v.prepend(i.transform.mapCoord)}},i.prototype.calculateTrimmedVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===e)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=e;var i=this._texture,n=this.vertexTrimmedData,o=i.orig,r=this._anchor,a=-r._x*o.width,s=a+o.width,l=-r._y*o.height,c=l+o.height;if(this.proj._surface)n[0]=a,n[1]=l,n[2]=s,n[3]=l,n[4]=s,n[5]=c,n[6]=a,n[7]=c,this.proj._surface.boundsQuad(n,n,this.transform.worldTransform);else{var h=this.transform.worldTransform,p=h.a,u=h.b,d=h.c,f=h.d,m=h.tx,g=h.ty;n[0]=p*a+d*l+m,n[1]=f*l+u*a+g,n[2]=p*s+d*l+m,n[3]=f*l+u*s+g,n[4]=p*s+d*c+m,n[5]=f*c+u*s+g,n[6]=p*a+d*c+m,n[7]=f*c+u*a+g,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(n,n,this.proj._activeProjection.legacy.worldTransform)}},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),i}(PIXI.Sprite);t.Sprite2s=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o){var r=e.call(this,i,n,o)||this;return r.aTrans=new PIXI.Matrix,r.proj=new t.ProjectionSurface(r.transform),r.pluginName="sprite_bilinear",r}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),i}(PIXI.Text);t.Text2s=e,e.prototype.calculateVertices=t.Sprite2s.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite2s.prototype._calculateBounds}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){PIXI.Sprite.prototype.convertTo2s=function(){this.proj||(this.pluginName="sprite_bilinear",this.aTrans=new PIXI.Matrix,this.calculateVertices=t.Sprite2s.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite2s.prototype._calculateBounds,PIXI.Container.prototype.convertTo2s.call(this))},PIXI.Container.prototype.convertTo2s=function(){this.proj||(this.proj=new t.Projection2d(this.transform),Object.defineProperty(this,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}))},PIXI.Container.prototype.convertSubtreeTo2s=function(){this.convertTo2s();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2s()}}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){t.container2dWorldTransform=function(){return this.proj.affine?this.transform.worldTransform:this.proj.world};var e=function(e){function i(){var i=e.call(this)||this;return i.proj=new t.Projection2d(i.transform),i}return __extends(i,e),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),i&&(e=i.toGlobal(e,n,o)),o||this._recursivePostUpdateTransform(),r>=t.TRANSFORM_STEP.PROJ?(o||this.displayObjectUpdateTransform(),this.proj.affine?this.transform.worldTransform.applyInverse(n,n):this.proj.world.applyInverse(n,n)):(this.parent?n=this.parent.worldTransform.applyInverse(e,n):n.copy(e),r===t.TRANSFORM_STEP.NONE?n:this.transform.localTransform.applyInverse(n,n))},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.Container);t.Container2d=e,t.container2dToLocal=e.prototype.toLocal}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e,i=PIXI.Point,n=[1,0,0,0,1,0,0,0,1];!function(t){t[t.NONE=0]="NONE",t[t.FREE=1]="FREE",t[t.AXIS_X=2]="AXIS_X",t[t.AXIS_Y=3]="AXIS_Y",t[t.POINT=4]="POINT"}(e=t.AFFINE||(t.AFFINE={}));var o=function(){function t(t){this.floatArray=null,this.mat3=new Float64Array(t||n)}return Object.defineProperty(t.prototype,"a",{get:function(){return this.mat3[0]/this.mat3[8]},set:function(t){this.mat3[0]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.mat3[1]/this.mat3[8]},set:function(t){this.mat3[1]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"c",{get:function(){return this.mat3[3]/this.mat3[8]},set:function(t){this.mat3[3]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"d",{get:function(){return this.mat3[4]/this.mat3[8]},set:function(t){this.mat3[4]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tx",{get:function(){return this.mat3[6]/this.mat3[8]},set:function(t){this.mat3[6]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ty",{get:function(){return this.mat3[7]/this.mat3[8]},set:function(t){this.mat3[7]=t*this.mat3[8]},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,i,n,o,r){var a=this.mat3;return a[0]=t,a[1]=e,a[2]=0,a[3]=i,a[4]=n,a[5]=0,a[6]=o,a[7]=r,a[8]=1,this},t.prototype.toArray=function(t,e){this.floatArray||(this.floatArray=new Float32Array(9));var i=e||this.floatArray,n=this.mat3;return t?(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8]):(i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8]),i},t.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.mat3,n=t.x,o=t.y,r=1/(i[2]*n+i[5]*o+i[8]);return e.x=r*(i[0]*n+i[3]*o+i[6]),e.y=r*(i[1]*n+i[4]*o+i[7]),e},t.prototype.translate=function(t,e){var i=this.mat3;return i[0]+=t*i[2],i[1]+=e*i[2],i[3]+=t*i[5],i[4]+=e*i[5],i[6]+=t*i[8],i[7]+=e*i[8],this},t.prototype.scale=function(t,e){var i=this.mat3;return i[0]*=t,i[1]*=e,i[3]*=t,i[4]*=e,i[6]*=t,i[7]*=e,this},t.prototype.scaleAndTranslate=function(t,e,i,n){var o=this.mat3;o[0]=t*o[0]+i*o[2],o[1]=e*o[1]+n*o[2],o[3]=t*o[3]+i*o[5],o[4]=e*o[4]+n*o[5],o[6]=t*o[6]+i*o[8],o[7]=e*o[7]+n*o[8]},t.prototype.applyInverse=function(t,e){e=e||new i;var n=this.mat3,o=t.x,r=t.y,a=n[0],s=n[3],l=n[6],c=n[1],h=n[4],p=n[7],u=n[2],d=n[5],f=n[8],m=(f*h-p*d)*o+(-f*s+l*d)*r+(p*s-l*h),g=(-f*c+p*u)*o+(f*a-l*u)*r+(-p*a+l*c),y=(d*c-h*u)*o+(-d*a+s*u)*r+(h*a-s*c);return e.x=m/y,e.y=g/y,e},t.prototype.invert=function(){var t=this.mat3,e=t[0],i=t[1],n=t[2],o=t[3],r=t[4],a=t[5],s=t[6],l=t[7],c=t[8],h=c*r-a*l,p=-c*o+a*s,u=l*o-r*s,d=e*h+i*p+n*u;return d?(d=1/d,t[0]=h*d,t[1]=(-c*i+n*l)*d,t[2]=(a*i-n*r)*d,t[3]=p*d,t[4]=(c*e-n*s)*d,t[5]=(-a*e+n*o)*d,t[6]=u*d,t[7]=(-l*e+i*s)*d,t[8]=(r*e-i*o)*d,this):this},t.prototype.identity=function(){var t=this.mat3;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},t.prototype.clone=function(){return new t(this.mat3)},t.prototype.copyTo=function(t){var e=this.mat3,i=t.mat3;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],t},t.prototype.copy=function(t,i){var n=this.mat3,o=1/n[8],r=n[6]*o,a=n[7]*o;t.a=(n[0]-n[2]*r)*o,t.b=(n[1]-n[2]*a)*o,t.c=(n[3]-n[5]*r)*o,t.d=(n[4]-n[5]*a)*o,t.tx=r,t.ty=a,i>=2&&(i===e.POINT?(t.a=1,t.b=0,t.c=0,t.d=1):i===e.AXIS_X?(t.c=-t.b,t.d=t.a):i===e.AXIS_Y&&(t.a=t.d,t.c=-t.b))},t.prototype.copyFrom=function(t){var e=this.mat3;return e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=t.c,e[4]=t.d,e[5]=0,e[6]=t.tx,e[7]=t.ty,e[8]=1,this},t.prototype.setToMultLegacy=function(t,e){var i=this.mat3,n=e.mat3,o=t.a,r=t.b,a=t.c,s=t.d,l=t.tx,c=t.ty,h=n[0],p=n[1],u=n[2],d=n[3],f=n[4],m=n[5],g=n[6],y=n[7],v=n[8];return i[0]=h*o+p*a+u*l,i[1]=h*r+p*s+u*c,i[2]=u,i[3]=d*o+f*a+m*l,i[4]=d*r+f*s+m*c,i[5]=m,i[6]=g*o+y*a+v*l,i[7]=g*r+y*s+v*c,i[8]=v,this},t.prototype.setToMultLegacy2=function(t,e){var i=this.mat3,n=t.mat3,o=n[0],r=n[1],a=n[2],s=n[3],l=n[4],c=n[5],h=n[6],p=n[7],u=n[8],d=e.a,f=e.b,m=e.c,g=e.d,y=e.tx,v=e.ty;return i[0]=d*o+f*s,i[1]=d*r+f*l,i[2]=d*a+f*c,i[3]=m*o+g*s,i[4]=m*r+g*l,i[5]=m*a+g*c,i[6]=y*o+v*s+h,i[7]=y*r+v*l+p,i[8]=y*a+v*c+u,this},t.prototype.setToMult=function(t,e){var i=this.mat3,n=t.mat3,o=e.mat3,r=n[0],a=n[1],s=n[2],l=n[3],c=n[4],h=n[5],p=n[6],u=n[7],d=n[8],f=o[0],m=o[1],g=o[2],y=o[3],v=o[4],b=o[5],w=o[6],x=o[7],_=o[8];return i[0]=f*r+m*l+g*p,i[1]=f*a+m*c+g*u,i[2]=f*s+m*h+g*d,i[3]=y*r+v*l+b*p,i[4]=y*a+v*c+b*u,i[5]=y*s+v*h+b*d,i[6]=w*r+x*l+_*p,i[7]=w*a+x*c+_*u,i[8]=w*s+x*h+_*d,this},t.prototype.prepend=function(t){t.mat3?this.setToMult(t,this):this.setToMultLegacy(t,this)},t.IDENTITY=new t,t.TEMP_MATRIX=new t,t}();t.Matrix2d=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.Point,i=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],n=new PIXI.Rectangle,o=new t.Matrix2d,r=function(r){function a(e,i){var n=r.call(this,e,i)||this;return n.matrix=new t.Matrix2d,n.pivot=new PIXI.ObservablePoint(n.onChange,n,0,0),n.reverseLocalOrder=!1,n.local=new t.Matrix2d,n.world=new t.Matrix2d,n}return __extends(a,r),a.prototype.onChange=function(){var t=this.pivot,e=this.matrix.mat3;e[6]=-(t._x*e[0]+t._y*e[3]),e[7]=-(t._x*e[1]+t._y*e[4]),this._projID++},a.prototype.setAxisX=function(t,e){void 0===e&&(e=1);var i=t.x,n=t.y,o=Math.sqrt(i*i+n*n),r=this.matrix.mat3;r[0]=i/o,r[1]=n/o,r[2]=e/o,this.onChange()},a.prototype.setAxisY=function(t,e){void 0===e&&(e=1);var i=t.x,n=t.y,o=Math.sqrt(i*i+n*n),r=this.matrix.mat3;r[3]=i/o,r[4]=n/o,r[5]=e/o,this.onChange()},a.prototype.mapSprite=function(t,e){var i=t.texture;return n.x=-t.anchor.x*i.orig.width,n.y=-t.anchor.y*i.orig.height,n.width=i.orig.width,n.height=i.orig.height,this.mapQuad(n,e)},a.prototype.mapQuad=function(n,r){i[0].set(n.x,n.y),i[1].set(n.x+n.width,n.y),i[2].set(n.x+n.width,n.y+n.height),i[3].set(n.x,n.y+n.height);var a=1,s=2,l=3;if(0!==t.utils.getIntersectionFactor(r[0],r[2],r[1],r[3],e)){a=1,s=3,l=2;var c=Math.sqrt((r[0].x-e.x)*(r[0].x-e.x)+(r[0].y-e.y)*(r[0].y-e.y)),h=Math.sqrt((r[a].x-e.x)*(r[a].x-e.x)+(r[a].y-e.y)*(r[a].y-e.y)),p=Math.sqrt((r[s].x-e.x)*(r[s].x-e.x)+(r[s].y-e.y)*(r[s].y-e.y)),u=Math.sqrt((r[l].x-e.x)*(r[l].x-e.x)+(r[l].y-e.y)*(r[l].y-e.y)),d=(c+u)/u,f=(h+p)/p,m=(h+p)/h,g=this.matrix.mat3;g[0]=i[0].x*d,g[1]=i[0].y*d,g[2]=d,g[3]=i[a].x*f,g[4]=i[a].y*f,g[5]=f,g[6]=i[s].x*m,g[7]=i[s].y*m,g[8]=m,this.matrix.invert(),(g=o.mat3)[0]=r[0].x,g[1]=r[0].y,g[2]=1,g[3]=r[a].x,g[4]=r[a].y,g[5]=1,g[6]=r[s].x,g[7]=r[s].y,g[8]=1,this.matrix.setToMult(o,this.matrix),this._projID++}},a.prototype.updateLocalTransform=function(t){0!==this._projID?this.reverseLocalOrder?this.local.setToMultLegacy2(this.matrix,t):this.local.setToMultLegacy(t,this.matrix):this.local.copyFrom(t)},a.prototype.clear=function(){r.prototype.clear.call(this),this.matrix.identity(),this.pivot.set(0,0)},a}(t.LinearProjection);t.Projection2d=r}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o,r,a){var s=e.call(this,i,n,o,r,a)||this;return s.proj=new t.Projection2d(s.transform),s.pluginName="mesh2d",s}return __extends(i,e),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,i,n,o,r)},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.mesh.Mesh);t.Mesh2d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new PIXI.Shader(t,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position.xyw = projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","\nvarying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}")},e}(PIXI.mesh.MeshRenderer);t.Mesh2dRenderer=e,PIXI.WebGLRenderer.registerPlugin("mesh2d",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.proj=new t.Projection2d(n.transform),n.pluginName="sprite2d",n.vertexData=new Float32Array(12),n}return __extends(i,e),i.prototype._calculateBounds=function(){this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)},i.prototype.calculateVertices=function(){if(this.proj._affine)return 8!=this.vertexData.length&&(this.vertexData=new Float32Array(8)),void e.prototype.calculateVertices.call(this);12!=this.vertexData.length&&(this.vertexData=new Float32Array(12));var t=this.transform._worldID,i=this._texture._updateID;if(this._transformID!==t||this._textureID!==i){this._transformID=t,this._textureID=i;var n=this._texture,o=this.proj.world.mat3,r=this.vertexData,a=n.trim,s=n.orig,l=this._anchor,c=0,h=0,p=0,u=0;a?(c=(h=a.x-l._x*s.width)+a.width,p=(u=a.y-l._y*s.height)+a.height):(c=(h=-l._x*s.width)+s.width,p=(u=-l._y*s.height)+s.height),r[0]=o[0]*h+o[3]*u+o[6],r[1]=o[1]*h+o[4]*u+o[7],r[2]=o[2]*h+o[5]*u+o[8],r[3]=o[0]*c+o[3]*u+o[6],r[4]=o[1]*c+o[4]*u+o[7],r[5]=o[2]*c+o[5]*u+o[8],r[6]=o[0]*c+o[3]*p+o[6],r[7]=o[1]*c+o[4]*p+o[7],r[8]=o[2]*c+o[5]*p+o[8],r[9]=o[0]*h+o[3]*p+o[6],r[10]=o[1]*h+o[4]*p+o[7],r[11]=o[2]*h+o[5]*p+o[8]}},i.prototype.calculateTrimmedVertices=function(){if(this.proj._affine)e.prototype.calculateTrimmedVertices.call(this);else{var t=this.transform._worldID,i=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===i)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=i;var n=this._texture,o=this.vertexTrimmedData,r=n.orig,a=this._anchor,s=this.proj.world.mat3,l=-a._x*r.width,c=l+r.width,h=-a._y*r.height,p=h+r.height,u=1/(s[2]*l+s[5]*h+s[8]);o[0]=u*(s[0]*l+s[3]*h+s[6]),o[1]=u*(s[1]*l+s[4]*h+s[7]),u=1/(s[2]*c+s[5]*h+s[8]),o[2]=u*(s[0]*c+s[3]*h+s[6]),o[3]=u*(s[1]*c+s[4]*h+s[7]),u=1/(s[2]*c+s[5]*p+s[8]),o[4]=u*(s[0]*c+s[3]*p+s[6]),o[5]=u*(s[1]*c+s[4]*p+s[7]),u=1/(s[2]*l+s[5]*p+s[8]),o[6]=u*(s[0]*l+s[3]*p+s[6]),o[7]=u*(s[1]*l+s[4]*p+s[7])}},i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,i,n,o,r)},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.Sprite);t.Sprite2d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shaderVert="precision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * aVertexPosition;\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",e.shaderFrag="\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\nvec4 color;\nvec2 textureCoord = vTextureCoord;\nfloat textureId = floor(vTextureId+0.5);\n%forloop%\ngl_FragColor = color * vColor;\n}",e}return __extends(e,t),e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=6,this.vertByteSize=4*this.vertSize;var i=this.renderer.gl,n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,i.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTextureCoord,i.UNSIGNED_SHORT,!0,this.vertByteSize,12).addAttribute(t,e.aColor,i.UNSIGNED_BYTE,!0,this.vertByteSize,16);return e.aTextureId&&n.addAttribute(t,e.aTextureId,i.FLOAT,!1,this.vertByteSize,20),n},e.prototype.fillVertices=function(t,e,i,n,o,r){var a=n.vertexData,s=n._texture._uvs.uvsUint32;if(8===a.length)if(this.renderer.roundPixels){var l=this.renderer.resolution;t[i]=(a[0]*l|0)/l,t[i+1]=(a[1]*l|0)/l,t[i+2]=1,t[i+6]=(a[2]*l|0)/l,t[i+7]=(a[3]*l|0)/l,t[i+8]=1,t[i+12]=(a[4]*l|0)/l,t[i+13]=(a[5]*l|0)/l,t[i+14]=1,t[i+18]=(a[6]*l|0)/l,t[i+19]=(a[7]*l|0)/l,t[i+20]=1}else t[i]=a[0],t[i+1]=a[1],t[i+2]=1,t[i+6]=a[2],t[i+7]=a[3],t[i+8]=1,t[i+12]=a[4],t[i+13]=a[5],t[i+14]=1,t[i+18]=a[6],t[i+19]=a[7],t[i+20]=1;else t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+6]=a[3],t[i+7]=a[4],t[i+8]=a[5],t[i+12]=a[6],t[i+13]=a[7],t[i+14]=a[8],t[i+18]=a[9],t[i+19]=a[10],t[i+20]=a[11];e[i+3]=s[0],e[i+9]=s[1],e[i+15]=s[2],e[i+21]=s[3],e[i+4]=e[i+10]=e[i+16]=e[i+22]=o,t[i+5]=t[i+11]=t[i+17]=t[i+23]=r},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite2d",e)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o){var r=e.call(this,i,n,o)||this;return r.proj=new t.Projection2d(r.transform),r.pluginName="sprite2d",r.vertexData=new Float32Array(12),r}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i}(PIXI.Text);t.Text2d=e,e.prototype.calculateVertices=t.Sprite2d.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite2d.prototype._calculateBounds}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(){this.proj||(this.proj=new t.Projection2d(this.transform),this.toLocal=t.Container2d.prototype.toLocal,Object.defineProperty(this,"worldTransform",{get:t.container2dWorldTransform,enumerable:!0,configurable:!0}))}PIXI.Container.prototype.convertTo2d=e,PIXI.Sprite.prototype.convertTo2d=function(){this.proj||(this.calculateVertices=t.Sprite2d.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite2d.prototype._calculateBounds,this.pluginName="sprite2d",this.vertexData=new Float32Array(12),e.call(this))},PIXI.mesh.Mesh.prototype.convertTo2d=function(){this.proj||(this.pluginName="mesh2d",e.call(this))},PIXI.Container.prototype.convertSubtreeTo2d=function(){this.convertTo2d();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2d()}}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new PIXI.TransformStatic,i=function(i){function n(e,n,o){var r=i.call(this,e,n,o)||this;return r.tileProj=new t.Projection2d(r.tileTransform),r.tileProj.reverseLocalOrder=!0,r.proj=new t.Projection2d(r.transform),r.pluginName="tilingSprite2d",r.uvRespectAnchor=!0,r}return __extends(n,i),Object.defineProperty(n.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),n.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,i,n,o,r)},n.prototype._renderWebGL=function(t){var i=this._texture;i&&i.valid&&(this.tileTransform.updateTransform(e),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},n}(PIXI.extras.TilingSprite);t.TilingSprite2d=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec3 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position.xyw = projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0);\n\n    vTextureCoord = uTransform * vec3(aTextureCoord, 1.0);\n}\n",i=new t.Matrix2d,n=PIXI.WRAP_MODES,o=PIXI.utils,r=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new PIXI.Shader(t,e,"\nvarying vec3 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord.xy / vTextureCoord.z - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new PIXI.Shader(t,e,"\n\tvarying vec3 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord.xy / vTextureCoord.z);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new PIXI.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},r.prototype.render=function(t){var e=this.renderer,r=this.quad;e.bindVao(r.vao);var a=r.vertices;a[0]=a[6]=t._width*-t.anchor.x,a[1]=a[3]=t._height*-t.anchor.y,a[2]=a[4]=t._width*(1-t.anchor.x),a[5]=a[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((a=r.uvs)[0]=a[6]=-t.anchor.x,a[1]=a[3]=-t.anchor.y,a[2]=a[4]=1-t.anchor.x,a[5]=a[7]=1-t.anchor.y),r.upload();var s=t._texture,l=s.baseTexture,c=t.tileProj.world,h=t.uvTransform,p=l.isPowerOfTwo&&s.frame.width===l.width&&s.frame.height===l.height;p&&(l._glTextures[e.CONTEXT_UID]?p=l.wrapMode!==n.CLAMP:l.wrapMode===n.CLAMP&&(l.wrapMode=n.REPEAT));var u=p?this.simpleShader:this.shader;e.bindShader(u),i.identity(),i.scale(s.width,s.height),i.prepend(c),i.scale(1/t._width,1/t._height),i.invert(),p?i.prepend(h.mapCoord):(u.uniforms.uMapCoord=h.mapCoord.toArray(!0),u.uniforms.uClampFrame=h.uClampFrame,u.uniforms.uClampOffset=h.uClampOffset),u.uniforms.uTransform=i.toArray(!0),u.uniforms.uColor=o.premultiplyTintToRgba(t.tint,t.worldAlpha,u.uniforms.uColor,l.premultipliedAlpha),u.uniforms.translationMatrix=t.proj.world.toArray(!0),u.uniforms.uSampler=e.bindTexture(s),e.setBlendMode(o.correctBlendMode(t.blendMode,l.premultipliedAlpha)),r.vao.draw(this.renderer.gl.TRIANGLES,6,0)},r}(PIXI.extras.TilingSpriteRenderer);t.TilingSprite2dRenderer=r,PIXI.WebGLRenderer.registerPlugin("tilingSprite2d",r)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(e,i){var n=this.alphaMaskPool[this.alphaMaskIndex];n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new t.SpriteMaskFilter2d(i)]),n[0].resolution=this.renderer.resolution,n[0].maskSprite=i,e.filterArea=i.getBounds(!0),this.renderer.filterManager.pushFilter(e,n),this.alphaMaskIndex++}var i=function(){function t(t){var i=this;this.onContextChange=function(t){i.gl=t,i.renderer.maskManager.pushSpriteMask=e},this.renderer=t,t.on("context",this.onContextChange)}return t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange)},t}();t.ProjectionsManager=i,PIXI.WebGLRenderer.registerPlugin("projections",i)}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec3 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n\tgl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n\tvTextureCoord = aTextureCoord;\n\tvMaskCoord = otherMatrix * vec3( aTextureCoord, 1.0);\n}\n",i="\nvarying vec3 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    vec2 uv = vMaskCoord.xy / vMaskCoord.z;\n    \n    vec2 text = abs( uv - 0.5 );\n    text = step(0.5, text);\n\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, uv);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n",n=new t.Matrix2d,o=function(o){function r(n){var r=o.call(this,e,i)||this;return r.maskMatrix=new t.Matrix2d,n.renderable=!1,r.maskSprite=n,r}return __extends(r,o),r.prototype.apply=function(t,e,i,n,o){var a=this.maskSprite;this.uniforms.mask=a.texture,this.uniforms.otherMatrix=r.calculateSpriteMatrix(o,this.maskMatrix,a),this.uniforms.alpha=a.worldAlpha,t.applyFilter(this,e,i)},r.calculateSpriteMatrix=function(t,e,i){var o=i.proj,r=t.sourceFrame,a=t.renderTarget.size,s=o&&!o._affine?o.world.copyTo(n):n.copyFrom(i.transform.worldTransform),l=i.texture.orig;return e.set(a.width,0,0,a.height,r.x,r.y),s.invert(),e.setToMult(s,e),e.scaleAndTranslate(1/l.width,1/l.height,i.anchor.x,i.anchor.y),e},r}(PIXI.Filter);t.SpriteMaskFilter2d=o}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){t.container3dWorldTransform=function(){return this.proj.affine?this.transform.worldTransform:this.proj.world};var e=function(e){function i(){var i=e.call(this)||this;return i.proj=new t.Projection3d(i.transform),i}return __extends(i,e),i.prototype.isFrontFace=function(t){void 0===t&&(t=!1),t&&(this._recursivePostUpdateTransform(),this.displayObjectUpdateTransform());var e=this.proj.world.mat4,i=e[0]*e[15]-e[3]*e[12],n=e[1]*e[15]-e[3]*e[13],o=e[4]*e[15]-e[7]*e[12];return i*(e[5]*e[15]-e[7]*e[13])-o*n>0},i.prototype.getDepth=function(t){void 0===t&&(t=!1),t&&(this._recursivePostUpdateTransform(),this.displayObjectUpdateTransform());var e=this.proj.world.mat4;return e[14]/e[15]},i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),i&&(e=i.toGlobal(e,n,o)),o||this._recursivePostUpdateTransform(),r===t.TRANSFORM_STEP.ALL?(o||this.displayObjectUpdateTransform(),this.proj.affine?this.transform.worldTransform.applyInverse(n,n):this.proj.world.applyInverse(n,n)):(this.parent?n=this.parent.worldTransform.applyInverse(e,n):n.copy(e),r===t.TRANSFORM_STEP.NONE?n:(n=this.transform.localTransform.applyInverse(n,n),r===t.TRANSFORM_STEP.PROJ&&this.proj.cameraMode&&(n=this.proj.cameraMatrix.applyInverse(n,n)),n))},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.Container);t.Container3d=e,t.container3dToLocal=e.prototype.toLocal,t.container3dGetDepth=e.prototype.getDepth,t.container3dIsFrontFace=e.prototype.isFrontFace}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._far=0,e._near=0,e._focus=0,e._orthographic=!1,e.proj.cameraMode=!0,e.setPlanes(400,10,1e4,!1),e}return __extends(e,t),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focus",{get:function(){return this._focus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ortographic",{get:function(){return this._orthographic},enumerable:!0,configurable:!0}),e.prototype.setPlanes=function(t,e,i,n){void 0===e&&(e=10),void 0===i&&(i=1e4),void 0===n&&(n=!1),this._focus=t,this._near=e,this._far=i,this._orthographic=n;var o=this.proj,r=o.cameraMatrix.mat4;o._projID++,r[10]=1/(i-e),r[14]=(t-e)/(i-e),this._orthographic?r[11]=0:r[11]=1/t},e}(t.Container3d);t.Camera3d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(){function t(t,e,i){this._quatUpdateId=-1,this._quatDirtyId=0,this._sign=1,this._x=t||0,this._y=e||0,this._z=i||0,this.quaternion=new Float64Array(4),this.quaternion[3]=1,this.update()}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yaw",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roll",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,i){var n=t||0,o=e||0,r=i||0;this._x===n&&this._y===o&&this._z===r||(this._x=n,this._y=o,this._z=r,this._quatDirtyId++)},t.prototype.copy=function(t){var e=t.x,i=t.y,n=t.z;this._x===e&&this._y===i&&this._z===n||(this._x=e,this._y=i,this._z=n,this._quatDirtyId++)},t.prototype.clone=function(){return new t(this._x,this._y,this._z)},t.prototype.update=function(){if(this._quatUpdateId===this._quatDirtyId)return!1;this._quatUpdateId=this._quatDirtyId;var t=Math.cos(this._x/2),e=Math.cos(this._y/2),i=Math.cos(this._z/2),n=this._sign,o=n*Math.sin(this._x/2),r=n*Math.sin(this._y/2),a=n*Math.sin(this._z/2),s=this.quaternion;return s[0]=o*e*i+t*r*a,s[1]=t*r*i-o*e*a,s[2]=t*e*a+o*r*i,s[3]=t*e*i-o*r*a,!0},t}();t.Euler=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=function(){function i(t){this.floatArray=null,this._dirtyId=0,this._updateId=-1,this._mat4inv=null,this.cacheInverse=!1,this.mat4=new Float64Array(t||e)}return Object.defineProperty(i.prototype,"a",{get:function(){return this.mat4[0]/this.mat4[15]},set:function(t){this.mat4[0]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"b",{get:function(){return this.mat4[1]/this.mat4[15]},set:function(t){this.mat4[1]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"c",{get:function(){return this.mat4[4]/this.mat4[15]},set:function(t){this.mat4[4]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"d",{get:function(){return this.mat4[5]/this.mat4[15]},set:function(t){this.mat4[5]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tx",{get:function(){return this.mat4[12]/this.mat4[15]},set:function(t){this.mat4[12]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ty",{get:function(){return this.mat4[13]/this.mat4[15]},set:function(t){this.mat4[13]=t*this.mat4[15]},enumerable:!0,configurable:!0}),i.prototype.set=function(t,e,i,n,o,r){var a=this.mat4;return a[0]=t,a[1]=e,a[2]=0,a[3]=0,a[4]=i,a[5]=n,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=o,a[13]=r,a[14]=0,a[15]=1,this},i.prototype.toArray=function(t,e){this.floatArray||(this.floatArray=new Float32Array(9));var i=e||this.floatArray,n=this.mat4;return t?(i[0]=n[0],i[1]=n[1],i[2]=n[3],i[3]=n[4],i[4]=n[5],i[5]=n[7],i[6]=n[12],i[7]=n[13],i[8]=n[15]):(i[0]=n[0],i[1]=n[4],i[2]=n[12],i[3]=n[2],i[4]=n[6],i[5]=n[13],i[6]=n[3],i[7]=n[7],i[8]=n[15]),i},i.prototype.setToTranslation=function(t,e,i){var n=this.mat4;n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t,n[13]=e,n[14]=i,n[15]=1},i.prototype.setToRotationTranslationScale=function(t,e,i,n,o,r,a){var s=this.mat4,l=t[0],c=t[1],h=t[2],p=t[3],u=l+l,d=c+c,f=h+h,m=l*u,g=l*d,y=l*f,v=c*d,b=c*f,w=h*f,x=p*u,_=p*d,S=p*f;return s[0]=(1-(v+w))*o,s[1]=(g+S)*o,s[2]=(y-_)*o,s[3]=0,s[4]=(g-S)*r,s[5]=(1-(m+w))*r,s[6]=(b+x)*r,s[7]=0,s[8]=(y+_)*a,s[9]=(b-x)*a,s[10]=(1-(m+v))*a,s[11]=0,s[12]=e,s[13]=i,s[14]=n,s[15]=1,s},i.prototype.apply=function(t,e){e=e||new PIXI.Point;var i=this.mat4,n=t.x,o=t.y,r=t.z,a=1/(i[3]*n+i[7]*o+i[11]*r+i[15]);return e.x=a*(i[0]*n+i[4]*o+i[8]*r+i[12]),e.y=a*(i[1]*n+i[5]*o+i[9]*r+i[13]),e.z=a*(i[2]*n+i[6]*o+i[10]*r+i[14]),e},i.prototype.translate=function(t,e,i){var n=this.mat4;return n[12]=n[0]*t+n[4]*e+n[8]*i+n[12],n[13]=n[1]*t+n[5]*e+n[9]*i+n[13],n[14]=n[2]*t+n[6]*e+n[10]*i+n[14],n[15]=n[3]*t+n[7]*e+n[11]*i+n[15],this},i.prototype.scale=function(t,e,i){var n=this.mat4;return n[0]*=t,n[1]*=t,n[2]*=t,n[3]*=t,n[4]*=e,n[5]*=e,n[6]*=e,n[7]*=e,void 0!==i&&(n[8]*=i,n[9]*=i,n[10]*=i,n[11]*=i),this},i.prototype.scaleAndTranslate=function(t,e,i,n,o,r){var a=this.mat4;a[0]=t*a[0]+n*a[3],a[1]=e*a[1]+o*a[3],a[2]=i*a[2]+r*a[3],a[4]=t*a[4]+n*a[7],a[5]=e*a[5]+o*a[7],a[6]=i*a[6]+r*a[7],a[8]=t*a[8]+n*a[11],a[9]=e*a[9]+o*a[11],a[10]=i*a[10]+r*a[11],a[12]=t*a[12]+n*a[15],a[13]=e*a[13]+o*a[15],a[14]=i*a[14]+r*a[15]},i.prototype.applyInverse=function(e,n){n=n||new t.Point3d,this._mat4inv||(this._mat4inv=new Float64Array(16));var o=this._mat4inv,r=this.mat4,a=e.x,s=e.y,l=e.z;this.cacheInverse&&this._updateId===this._dirtyId||(this._updateId=this._dirtyId,i.glMatrixMat4Invert(o,r));var c=1/(o[3]*a+o[7]*s+o[11]*l+o[15]),h=c*(o[0]*a+o[4]*s+o[8]*l+o[12]),p=c*(o[1]*a+o[5]*s+o[9]*l+o[13]),u=c*(o[2]*a+o[6]*s+o[10]*l+o[14]);l+=1;var d=1/(o[3]*a+o[7]*s+o[11]*l+o[15]),f=d*(o[0]*a+o[4]*s+o[8]*l+o[12]),m=d*(o[1]*a+o[5]*s+o[9]*l+o[13]),g=d*(o[2]*a+o[6]*s+o[10]*l+o[14]);Math.abs(u-g)<1e-10&&n.set(NaN,NaN,0);var y=(0-u)/(g-u);return n.set((f-h)*y+h,(m-p)*y+p,0),n},i.prototype.invert=function(){return i.glMatrixMat4Invert(this.mat4,this.mat4),this},i.prototype.invertCopyTo=function(t){this._mat4inv||(this._mat4inv=new Float64Array(16));var e=this._mat4inv,n=this.mat4;this.cacheInverse&&this._updateId===this._dirtyId||(this._updateId=this._dirtyId,i.glMatrixMat4Invert(e,n)),t.mat4.set(e)},i.prototype.identity=function(){var t=this.mat4;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},i.prototype.clone=function(){return new i(this.mat4)},i.prototype.copyTo=function(t){var e=this.mat4,i=t.mat4;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],t},i.prototype.copy=function(e,i){var n=this.mat4,o=1/n[15],r=n[12]*o,a=n[13]*o;e.a=(n[0]-n[3]*r)*o,e.b=(n[1]-n[3]*a)*o,e.c=(n[4]-n[7]*r)*o,e.d=(n[5]-n[7]*a)*o,e.tx=r,e.ty=a,i>=2&&(i===t.AFFINE.POINT?(e.a=1,e.b=0,e.c=0,e.d=1):i===t.AFFINE.AXIS_X?(e.c=-e.b,e.d=e.a):i===t.AFFINE.AXIS_Y&&(e.a=e.d,e.c=-e.b))},i.prototype.copyFrom=function(t){var e=this.mat4;return e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=0,e[4]=t.c,e[5]=t.d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t.tx,e[13]=t.ty,e[14]=0,e[15]=1,this._dirtyId++,this},i.prototype.setToMultLegacy=function(t,e){var i=this.mat4,n=e.mat4,o=t.a,r=t.b,a=t.c,s=t.d,l=t.tx,c=t.ty,h=n[0],p=n[1],u=n[2],d=n[3];return i[0]=h*o+p*a+d*l,i[1]=h*r+p*s+d*c,i[2]=u,i[3]=d,h=n[4],p=n[5],u=n[6],d=n[7],i[4]=h*o+p*a+d*l,i[5]=h*r+p*s+d*c,i[6]=u,i[7]=d,h=n[8],p=n[9],u=n[10],d=n[11],i[8]=h*o+p*a+d*l,i[9]=h*r+p*s+d*c,i[10]=u,i[11]=d,h=n[12],p=n[13],u=n[14],d=n[15],i[12]=h*o+p*a+d*l,i[13]=h*r+p*s+d*c,i[14]=u,i[15]=d,this._dirtyId++,this},i.prototype.setToMultLegacy2=function(t,e){var i=this.mat4,n=t.mat4,o=n[0],r=n[1],a=n[2],s=n[3],l=n[4],c=n[5],h=n[6],p=n[7],u=e.a,d=e.b,f=e.c,m=e.d,g=e.tx,y=e.ty;return i[0]=u*o+d*l,i[1]=u*r+d*c,i[2]=u*a+d*h,i[3]=u*s+d*p,i[4]=f*o+m*l,i[5]=f*r+m*c,i[6]=f*a+m*h,i[7]=f*s+m*p,i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=g*o+y*l+n[12],i[13]=g*r+y*c+n[13],i[14]=g*a+y*h+n[14],i[15]=g*s+y*p+n[15],this._dirtyId++,this},i.prototype.setToMult=function(t,e){return i.glMatrixMat4Multiply(this.mat4,t.mat4,e.mat4),this._dirtyId++,this},i.prototype.prepend=function(t){t.mat4?this.setToMult(t,this):this.setToMultLegacy(t,this)},i.glMatrixMat4Invert=function(t,e){var i=e[0],n=e[1],o=e[2],r=e[3],a=e[4],s=e[5],l=e[6],c=e[7],h=e[8],p=e[9],u=e[10],d=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=i*s-n*a,b=i*l-o*a,w=i*c-r*a,x=n*l-o*s,_=n*c-r*s,S=o*c-r*l,T=h*m-p*f,P=h*g-u*f,C=h*y-d*f,I=p*g-u*m,k=p*y-d*m,A=u*y-d*g,M=v*A-b*k+w*I+x*C-_*P+S*T;return M?(M=1/M,t[0]=(s*A-l*k+c*I)*M,t[1]=(o*k-n*A-r*I)*M,t[2]=(m*S-g*_+y*x)*M,t[3]=(u*_-p*S-d*x)*M,t[4]=(l*C-a*A-c*P)*M,t[5]=(i*A-o*C+r*P)*M,t[6]=(g*w-f*S-y*b)*M,t[7]=(h*S-u*w+d*b)*M,t[8]=(a*k-s*C+c*T)*M,t[9]=(n*C-i*k-r*T)*M,t[10]=(f*_-m*w+y*v)*M,t[11]=(p*w-h*_-d*v)*M,t[12]=(s*P-a*I-l*T)*M,t[13]=(i*I-n*P+o*T)*M,t[14]=(m*b-f*x-g*v)*M,t[15]=(h*x-p*b+u*v)*M,t):null},i.glMatrixMat4Multiply=function(t,e,i){var n=e[0],o=e[1],r=e[2],a=e[3],s=e[4],l=e[5],c=e[6],h=e[7],p=e[8],u=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],b=i[0],w=i[1],x=i[2],_=i[3];return t[0]=b*n+w*s+x*p+_*m,t[1]=b*o+w*l+x*u+_*g,t[2]=b*r+w*c+x*d+_*y,t[3]=b*a+w*h+x*f+_*v,b=i[4],w=i[5],x=i[6],_=i[7],t[4]=b*n+w*s+x*p+_*m,t[5]=b*o+w*l+x*u+_*g,t[6]=b*r+w*c+x*d+_*y,t[7]=b*a+w*h+x*f+_*v,b=i[8],w=i[9],x=i[10],_=i[11],t[8]=b*n+w*s+x*p+_*m,t[9]=b*o+w*l+x*u+_*g,t[10]=b*r+w*c+x*d+_*y,t[11]=b*a+w*h+x*f+_*v,b=i[12],w=i[13],x=i[14],_=i[15],t[12]=b*n+w*s+x*p+_*m,t[13]=b*o+w*l+x*u+_*g,t[14]=b*r+w*c+x*d+_*y,t[15]=b*a+w*h+x*f+_*v,t},i.IDENTITY=new i,i.TEMP_MATRIX=new i,i}();t.Matrix3d=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(){function e(t,e,i,n,o){this.cb=t,this.scope=e,this._quatUpdateId=-1,this._quatDirtyId=0,this._sign=1,this._x=i||0,this._y=n||0,this._z=o||0,this.quaternion=new Float64Array(4),this.quaternion[3]=1,this.update()}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pitch",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yaw",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roll",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,i){var n=t||0,o=e||0,r=i||0;this._x===n&&this._y===o&&this._z===r||(this._x=n,this._y=o,this._z=r,this._quatDirtyId++,this.cb.call(this.scope))},e.prototype.copy=function(t){var e=t.x,i=t.y,n=t.z;this._x===e&&this._y===i&&this._z===n||(this._x=e,this._y=i,this._z=n,this._quatDirtyId++,this.cb.call(this.scope))},e.prototype.clone=function(){return new t.Euler(this._x,this._y,this._z)},e.prototype.update=function(){if(this._quatUpdateId===this._quatDirtyId)return!1;this._quatUpdateId=this._quatDirtyId;var t=Math.cos(this._x/2),e=Math.cos(this._y/2),i=Math.cos(this._z/2),n=this._sign,o=n*Math.sin(this._x/2),r=n*Math.sin(this._y/2),a=n*Math.sin(this._z/2),s=this.quaternion;return s[0]=o*e*i+t*r*a,s[1]=t*r*i-o*e*a,s[2]=t*e*a+o*r*i,s[3]=t*e*i-o*r*a,!0},e}();t.ObservableEuler=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){PIXI.Point.prototype.z=0,PIXI.Point.prototype.set=function(t,e,i){this.x=t||0,this.y=void 0===e?this.x:e||0,this.z=void 0===e?this.x:i||0},PIXI.Point.prototype.copy=function(t){this.set(t.x,t.y,t.z)},PIXI.ObservablePoint.prototype._z=0,PIXI.ObservablePoint.prototype.set=function(t,e,i){var n=t||0,o=void 0===e?n:e||0,r=void 0===e?n:i||0;this._x===n&&this._y===o&&this._z===r||(this._x=n,this._y=o,this._z=r,this.cb.call(this.scope))},Object.defineProperty(PIXI.ObservablePoint.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),PIXI.ObservablePoint.prototype.copy=function(t){this._x===t.x&&this._y===t.y&&this._z===t.z||(this._x=t.x,this._y=t.y,this._z=t.z,this.cb.call(this.scope))};var e=function(t){function e(e,i,n){var o=t.call(this,e,i)||this;return o.z=n,o}return __extends(e,t),e}(PIXI.Point);t.Point3d=e,PIXI.Point=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=new t.Matrix3d,i=function(i){function n(e,n){var o=i.call(this,e,n)||this;return o.cameraMatrix=null,o._cameraMode=!1,o.position=new PIXI.ObservablePoint(o.onChange,o,0,0),o.scale=new PIXI.ObservablePoint(o.onChange,o,1,1),o.euler=new t.ObservableEuler(o.onChange,o,0,0,0),o.pivot=new PIXI.ObservablePoint(o.onChange,o,0,0),o.local=new t.Matrix3d,o.world=new t.Matrix3d,o.local.cacheInverse=!0,o.world.cacheInverse=!0,o.position._z=0,o.scale._z=1,o.pivot._z=0,o}return __extends(n,i),Object.defineProperty(n.prototype,"cameraMode",{get:function(){return this._cameraMode},set:function(e){this._cameraMode!==e&&(this._cameraMode=e,this.euler._sign=this._cameraMode?-1:1,this.euler._quatDirtyId++,e&&(this.cameraMatrix=new t.Matrix3d))},enumerable:!0,configurable:!0}),n.prototype.onChange=function(){this._projID++},n.prototype.clear=function(){this.cameraMatrix&&this.cameraMatrix.identity(),this.position.set(0,0,0),this.scale.set(1,1,1),this.euler.set(0,0,0),this.pivot.set(0,0,0),i.prototype.clear.call(this)},n.prototype.updateLocalTransform=function(t){if(0!==this._projID){var i=this.local,n=this.euler,o=this.position,r=this.scale,a=this.pivot;if(n.update(),!this.cameraMode)return i.setToRotationTranslationScale(n.quaternion,o._x,o._y,o._z,r._x,r._y,r._z),i.translate(-a._x,-a._y,-a._z),void i.setToMultLegacy(t,i);i.setToMultLegacy(t,this.cameraMatrix),i.translate(a._x,a._y,a._z),i.scale(1/r._x,1/r._y,1/r._z),e.setToRotationTranslationScale(n.quaternion,0,0,0,1,1,1),i.setToMult(i,e),i.translate(-o._x,-o._y,-o._z),this.local._dirtyId++}else this.local.copyFrom(t)},n}(t.LinearProjection);t.Projection3d=i}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o,r,a){var s=e.call(this,i,n,o,r,a)||this;return s.proj=new t.Projection3d(s.transform),s.pluginName="mesh2d",s}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,i,n,o,r)},i.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},i.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.mesh.Mesh);t.Mesh3d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.culledByFrustrum=!1,n.trimmedCulledByFrustrum=!1,n.proj=new t.Projection3d(n.transform),n.pluginName="sprite2d",n.vertexData=new Float32Array(12),n}return __extends(i,e),i.prototype._calculateBounds=function(){this.calculateVertices(),this.culledByFrustrum||(this.calculateTrimmedVertices(),this.trimmedCulledByFrustrum||this._bounds.addQuad(this.vertexTrimmedData))},i.prototype.calculateVertices=function(){if(this.proj._affine)return 8!=this.vertexData.length&&(this.vertexData=new Float32Array(8)),void e.prototype.calculateVertices.call(this);12!=this.vertexData.length&&(this.vertexData=new Float32Array(12));var t=this.transform._worldID,i=this._texture._updateID;if(this._transformID!==t||this._textureID!==i){this._transformID=t,this._textureID=i;var n=this._texture,o=this.proj.world.mat4,r=this.vertexData,a=n.trim,s=n.orig,l=this._anchor,c=0,h=0,p=0,u=0;a?(c=(h=a.x-l._x*s.width)+a.width,p=(u=a.y-l._y*s.height)+a.height):(c=(h=-l._x*s.width)+s.width,p=(u=-l._y*s.height)+s.height);var d,f=!1;r[0]=o[0]*h+o[4]*u+o[12],r[1]=o[1]*h+o[5]*u+o[13],d=o[2]*h+o[6]*u+o[14],r[2]=o[3]*h+o[7]*u+o[15],f=f||d<0,r[3]=o[0]*c+o[4]*u+o[12],r[4]=o[1]*c+o[5]*u+o[13],d=o[2]*c+o[6]*u+o[14],r[5]=o[3]*c+o[7]*u+o[15],f=f||d<0,r[6]=o[0]*c+o[4]*p+o[12],r[7]=o[1]*c+o[5]*p+o[13],d=o[2]*c+o[6]*p+o[14],r[8]=o[3]*c+o[7]*p+o[15],f=f||d<0,r[9]=o[0]*h+o[4]*p+o[12],r[10]=o[1]*h+o[5]*p+o[13],d=o[2]*h+o[6]*p+o[14],r[11]=o[3]*h+o[7]*p+o[15],f=f||d<0,this.culledByFrustrum=f}},i.prototype.calculateTrimmedVertices=function(){if(this.proj._affine)e.prototype.calculateTrimmedVertices.call(this);else{var t=this.transform._worldID,i=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===i)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=i;var n=this._texture,o=this.vertexTrimmedData,r=n.orig,a=this._anchor,s=this.proj.world.mat4,l=-a._x*r.width,c=l+r.width,h=-a._y*r.height,p=h+r.height,u=!1,d=1/(s[3]*l+s[7]*h+s[15]);o[0]=d*(s[0]*l+s[4]*h+s[12]),o[1]=d*(s[1]*l+s[5]*h+s[13]);var f=s[2]*l+s[6]*h+s[14];u=u||f<0,d=1/(s[3]*c+s[7]*h+s[15]),o[2]=d*(s[0]*c+s[4]*h+s[12]),o[3]=d*(s[1]*c+s[5]*h+s[13]),f=s[2]*c+s[6]*h+s[14],u=u||f<0,d=1/(s[3]*c+s[7]*p+s[15]),o[4]=d*(s[0]*c+s[4]*p+s[12]),o[5]=d*(s[1]*c+s[5]*p+s[13]),f=s[2]*c+s[6]*p+s[14],u=u||f<0,d=1/(s[3]*l+s[7]*p+s[15]),o[6]=d*(s[0]*l+s[4]*p+s[12]),o[7]=d*(s[1]*l+s[5]*p+s[13]),f=s[2]*l+s[6]*p+s[14],u=u||f<0,this.trimmedCulledByFrustrum=u}},i.prototype._renderWebGL=function(t){this.calculateVertices(),this.culledByFrustrum||(t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},i.prototype.containsPoint=function(t){return!this.culledByFrustrum&&e.prototype.containsPoint.call(this,t)},Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,i,n,o,r)},i.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},i.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.Sprite);t.Sprite3d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(i,n,o){var r=e.call(this,i,n,o)||this;return r.proj=new t.Projection3d(r.transform),r.pluginName="sprite2d",r.vertexData=new Float32Array(12),r}return __extends(i,e),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i.prototype.toLocal=function(e,i,n,o,r){return void 0===r&&(r=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,i,n,o,r)},i.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},i.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(i.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)},enumerable:!0,configurable:!0}),i}(PIXI.Text);t.Text3d=e,e.prototype.calculateVertices=t.Sprite3d.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite3d.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite3d.prototype._calculateBounds,e.prototype.containsPoint=t.Sprite3d.prototype.containsPoint,e.prototype._renderWebGL=t.Sprite3d.prototype._renderWebGL}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){function e(){this.proj||(this.proj=new t.Projection3d(this.transform),this.toLocal=t.Container3d.prototype.toLocal,this.isFrontFace=t.Container3d.prototype.isFrontFace,this.getDepth=t.Container3d.prototype.getDepth,Object.defineProperties(this,i))}var i={worldTransform:{get:t.container3dWorldTransform,enumerable:!0,configurable:!0},position3d:{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)}},scale3d:{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)}},pivot3d:{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)}},euler:{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)}}};PIXI.Container.prototype.convertTo3d=e,PIXI.Sprite.prototype.convertTo3d=function(){this.proj||(this.calculateVertices=t.Sprite3d.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite3d.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite3d.prototype._calculateBounds,this.containsPoint=t.Sprite3d.prototype.containsPoint,this.pluginName="sprite2d",this.vertexData=new Float32Array(12),e.call(this))},PIXI.mesh.Mesh.prototype.convertTo3d=function(){this.proj||(this.pluginName="mesh2d",e.call(this))},PIXI.Container.prototype.convertSubtreeTo3d=function(){this.convertTo3d();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo3d()}}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(t){var i=e.call(this,t)||this;return i.convertTo2d(),i}return __extends(i,e),i.prototype.newContainer=function(){return new t.Container2d},i.prototype.newSprite=function(e){return new t.Sprite2d(e)},i.prototype.newGraphics=function(){return new PIXI.Graphics},i.prototype.newMesh=function(e,i,n,o,r){return new t.Mesh2d(e,i,n,o,r)},i.prototype.transformHack=function(){return 2},i}(PIXI.spine.Spine);t.Spine2d=e}(pixi_projection||(pixi_projection={}));var pixi_projection;!function(t){var e=function(e){function i(t){var i=e.call(this,t)||this;return i.convertTo3d(),i}return __extends(i,e),i.prototype.newContainer=function(){return new t.Container3d},i.prototype.newSprite=function(e){return new t.Sprite3d(e)},i.prototype.newGraphics=function(){return new PIXI.Graphics},i.prototype.newMesh=function(e,i,n,o,r){return new t.Mesh3d(e,i,n,o,r)},i.prototype.transformHack=function(){return 3},i}(PIXI.spine.Spine);t.Spine3d=e}(pixi_projection||(pixi_projection={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Spine=function(t){function e(e){var i=t.call(this,e)||this;return i.neverFlush=!1,i.origX=0,i.origY=0,i.pooled=!1,i.pooledActive=!1,i.disposeAssetsOnDestroy=!1,i}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.setTextureResolution=function(t){this.scale.x=1/t,this.scale.y=1/t},e.prototype.disposeAssets=function(){if(1==Game.displayStore.checkTextureDeletable(this)){this.disposeAssetsOnDestroy=!0;for(var t=0;t<this.children.length;t++){for(var e=this.children[t],i=0;i<e.children.length;i++){var n=e.children[i];n.texture.destroy(!0),n=null}e=null}PIXI.Texture.removeFromCache(this.textureURL),PIXI.BaseTexture.removeFromCache(this.textureURL),PIXI.Texture.removeFromCache(this.atlasTextureRefID),PIXI.BaseTexture.removeFromCache(this.atlasTextureRefID)}this.slotContainers=null,this.spineData=null,this.skeleton=null,this.data=null,this.state=null,this.storedState=null},e.prototype.destroy=function(){1!=this.disposeAssetsOnDestroy?t.prototype.destroy.call(this):t.prototype.destroy.call(this,!0)},e.prototype.setAtlasTextureRefID=function(t){this.atlasTextureRefID=t},e.prototype.changeBaseTexture=function(t){for(n=0;n<this.slotContainers.length;n++)for(var e=this.slotContainers[n],i=0;i<e.children.length;i++)e.children[i].texture.baseTexture=t;for(var n=0;n<this.skeleton.slots.length;n++){var o=this.skeleton.slots[n];o.attachment&&(o.attachment.rendererObject.page.rendererObject=t)}},e.prototype.setAnim=function(t,e){this.lastTime=Date.now(),this.currentAnim=t,this.loop=e,this.state.setAnimation(0,t,e)},e.prototype.setSkin=function(t){this.skeleton.setSkinByName(t),this.skeleton.setSlotsToSetupPose()},e.prototype.pause=function(){this.currentAnim&&(this.currentAnimTime=this.state.currentTime,this.storedState=this.state,this.state.tracks[0]&&(this.storedTime=this.state.tracks[0].trackTime),this.state.clearTracks())},e.prototype.resume=function(){this.currentAnim&&(this.state=this.storedState,this.state.setAnimation(0,this.currentAnim,this.loop),this.state.tracks[0].trackTime=this.storedTime)},e.prototype.rewindAndStop=function(){},e.prototype.resizeItem=function(){},e}(PIXI.spine.Spine),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),AnimatedSprite=function(t){function e(e){var i=t.call(this,e)||this;i.neverFlush=!1,i.origX=0,i.origY=0,i.origAnchor={x:0,y:0,compensate:!1},i.defaultAnchor=!0,i.pooled=!1,i.pooledActive=!1,i.disposeAssetsOnDestroy=!1,i.texturesStore=new Array;for(var n=0;n<e.length;n++)i.texturesStore.push(e[n]);return i}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.setJsonBaseTextureRef=function(t){this.jsonBaseTextureRefID=t},e.prototype.setTextureResolution=function(t){var e=PIXI.utils.TextureCache[this.textureURL];e.baseTexture.resolution=t,e.baseTexture.update()},e.prototype.disposeAssets=function(){if(1==Game.displayStore.checkTextureDeletable(this)){this.disposeAssetsOnDestroy=!0,PIXI.Texture.removeFromCache(this.texture),PIXI.BaseTexture.removeFromCache(this.texture.baseTexture);for(var t=0;t<this.texturesStore.length;t++)PIXI.Texture.removeFromCache(this.texturesStore[t]),PIXI.BaseTexture.removeFromCache(this.texturesStore[t].baseTexture);PIXI.Texture.removeFromCache(this.jsonBaseTextureRefID),PIXI.BaseTexture.removeFromCache(this.jsonBaseTextureRefID)}},e.prototype.destroy=function(){1!=this.disposeAssetsOnDestroy?t.prototype.destroy.call(this):t.prototype.destroy.call(this,!0)},e.prototype.resizeItem=function(){},e.prototype.setRegPoint=function(t,e,i){this.anchor.x=t,this.anchor.y=e,1==i&&(this.position.x=this.width*t+this.position.x,this.position.y=this.height*e+this.position.y)},e}(PIXI.extras.AnimatedSprite),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),BitmapText=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.neverFlush=!1,n.origX=0,n.origY=0,n.defaultAnchor=!0,n.pooled=!1,n.pooledActive=!1,n.disposeAssetsOnDestroy=!1,n}return __extends(e,t),e.prototype.addChild=function(e){t.prototype.addChild.call(this,e),1==this.pooled&&(this.pooledActive=!0)},e.prototype.setTextureResolution=function(t){Game.displayStore.setTextureResolutionBitmapText(this,t)},e.prototype.saveTexture=function(){this.pixiTex=PIXI.Texture.fromImage(this.textureURL)},e.prototype.disposeAssets=function(){Game.displayStore.disposeAssetsBitmapText(this)},e.prototype.setPosition=function(t,e){this.position.x=t+Game.stringsManager.getTextOffset(this.stringId).xOffset,this.position.y=e+Game.stringsManager.getTextOffset(this.stringId).yOffset},e.prototype.destroy=function(){1!=this.disposeAssetsOnDestroy?t.prototype.destroy.call(this):t.prototype.destroy.call(this,!0)},e}(PIXI.extras.BitmapText),Vehicle=function(){function t(e,i){this.checkLaneCounterLimit=1,this.craftToRaceScaleRatio=.25,this.COLLISION={NONE:5025616,COLLIDE:2201331},this.bashTimeout=0,this.bashTimeoutThreshold=2,this.attachments=[],this.scene=e,this.id=i.id,this.onScreen=!0,this.coins=0,this.targetLocked=!1,this.dustTrailObj={targetScale:0,targetAlpha:0,xOffset:10},this.braking=!1,this.powerupEnabled=!1,this.ticker=Game.getRandom(0,10,!0),this.powerupTime=0,this.powerupTimeLimit=10,this.powerupCooldown=10,this.powerupIsReady=!0,this.speedMultiplier=2,this.acceleration=0,this.targetAcceleration=0,this.rubberbandFactor=1,this.maxSpeed=7,this.bashing=!1,this.bashResetMargin=30,this.checkLaneCounter=0,this.currentCarSound="none",this.highlighted=!1,this.lanePositionMargin=30,this.brightnessFilter=new PIXI.filters.ColorMatrixFilter,this.brightnessFilter.brightness(1.2,!1),this.reachedTargetLane=!1,this.touchingAnotherVehicle=!1,this.raceProgress=0,this.trackLength=this.scene.trackManager.tiles.length*this.scene.trackManager.tileSize,this.validTrackLength=(this.scene.trackManager.tiles.length-3)*this.scene.trackManager.tileSize,this.currentStatus=t.STATUS_DEFAULT,this.startingPosition=[250,RaceScene.lanePositions[i.startingLane]],this.targetLaneY=this.startingPosition[1],this.currentLane=this.targetLane=this.lastLane=i.startingLane,this.speed=0,this.lastSpeed=0,this.changeInSpeed=0,this.container=Game.displayStore.getContainer3d("race-scene/vehicle-container"),this.carContainer=Game.displayStore.getContainer3d("race-scene/car-container"),this.car=Game.displayStore.getContainer3d("race-scene/car"),this.carBody=Game.displayStore.getContainer3d("race-scene/car-body"),this.carBodyInner=Game.displayStore.getContainer3d("race-scene/car-body-inner"),this.frontWheels=Game.displayStore.getContainer3d("race-scene/front-wheels"),this.backWheels=Game.displayStore.getContainer3d("race-scene/back-wheels"),this.carBody.addChild(this.carBodyInner),this.car.addChild(this.carBody),this.car.addChild(this.frontWheels),this.car.addChild(this.backWheels),this.carContainer.addChild(this.car),this.container.addChild(this.carContainer),this.car.euler.y=0,this.carBody.euler.z=0,this.car.euler.x=0,this.carContainer.euler.z=0,this.shadow=Game.displayStore.getSprite3d("race-scene/shadow.png"),this.shadow.blendMode=PIXI.BLEND_MODES.MULTIPLY,this.shadow.alpha=.5,this.shadow.visible=!0,this.shadow.parentGroup=RaceScene.SORT_GROUP_FLOOR,this.shadow.position.y=0,this.shadow.anchor.set(.5,.5),this.carContainer.addChildAt(this.shadow,0),this.scenePos=new PIXI.Point,this.lastPos=new PIXI.Point,this.scenePos.x=this.lastPos.x=this.container.x,this.scenePos.y=this.lastPos.y=this.carContainer.y}return t.prototype.startRace=function(){this.raceTime=(new Date).getTime()},t.prototype.generateVehicle=function(t){var e=this;this.carType=t.carType;var i=CoreData.carTypeData[this.carType],n=i.wheelAttachPoints,o=(n[1].pos[0]-n[0].pos[0])*this.craftToRaceScaleRatio;this.track=30,this.wheelType=t.wheelType,this.wheelTypeData=CoreData.wheelTypeData[this.wheelType],this.wheelbase=o,this.carBodyInnerOffset=new PIXI.Point(i.raceBodyOffset[0],i.raceBodyOffset[1]),this.deccelerationPower=(CoreData.wheelStatsMinMax.bashability.max-this.wheelTypeData.bashability)/100,this.accelerationPower=this.wheelTypeData.acceleration,this.bashability=this.wheelTypeData.bashability,this.agility=this.wheelTypeData.agility,this.carBody.position.x=this.wheelbase/2,this.carBody.proj.euler.x=Math.PI/2,this.carBody.position3d.z=-5,this.carBody.parentGroup=RaceScene.SORT_GROUP_PROP,this.carBodyInner.position3d.copy(this.carBodyInnerOffset),this.textureSprite=t.textureSprite,this.textureSprite.scale.set(this.craftToRaceScaleRatio,this.craftToRaceScaleRatio),this.carBodyInner.addChild(this.textureSprite),this.wheelFL=Game.displayStore.getSprite3d("race-scene/"+this.wheelType),this.wheelFR=Game.displayStore.getSprite3d("race-scene/"+this.wheelType),this.wheelFL.scale3d.set(this.craftToRaceScaleRatio,this.craftToRaceScaleRatio,this.craftToRaceScaleRatio),this.wheelFR.scale3d.set(this.craftToRaceScaleRatio,this.craftToRaceScaleRatio,this.craftToRaceScaleRatio),this.wheelSize=this.wheelFL.width*this.craftToRaceScaleRatio,this.wheelFL.proj.euler.x=Math.PI/2,this.wheelFR.proj.euler.x=Math.PI/2,this.wheelFL.position3d.y=-this.track/2,this.wheelFR.position3d.y=this.track/2,this.wheelFL.parentGroup=RaceScene.SORT_GROUP_PROP,this.wheelFR.parentGroup=RaceScene.SORT_GROUP_PROP,this.frontWheels.addChild(this.wheelFL),this.frontWheels.addChild(this.wheelFR),this.wheelBL=Game.displayStore.getSprite3d("race-scene/"+this.wheelType),this.wheelBR=Game.displayStore.getSprite3d("race-scene/"+this.wheelType),this.wheelBL.scale3d.set(this.craftToRaceScaleRatio,this.craftToRaceScaleRatio,this.craftToRaceScaleRatio),this.wheelBR.scale3d.set(this.craftToRaceScaleRatio,this.craftToRaceScaleRatio,this.craftToRaceScaleRatio),this.wheelBL.proj.euler.x=Math.PI/2,this.wheelBR.proj.euler.x=Math.PI/2,this.wheelBL.position3d.y=-this.track/2,this.wheelBR.position3d.y=this.track/2,this.wheelBL.parentGroup=RaceScene.SORT_GROUP_PROP,this.wheelBR.parentGroup=RaceScene.SORT_GROUP_PROP,this.backWheels.addChild(this.wheelBL),this.backWheels.addChild(this.wheelBR),this.backWheels.position3d.x=0,this.backWheels.position3d.z=-this.wheelSize/2,this.frontWheels.position3d.x=this.wheelbase,this.frontWheels.position3d.z=-this.wheelSize/2,this.p2Shape=new p2.Box({width:this.wheelbase+50,height:50}),this.p2Body=new p2.Body({mass:1,position:this.startingPosition}),this.p2Body.damping=.9999,this.p2Body.gravityScale=0,this.p2Body.allowSleep=!1,this.p2Body.fixedRotation=!0,this.p2Body.addShape(this.p2Shape,[0,0]),this.scene.physicsManager.addBodyToWorld(this.p2Body),this.container.x=this.p2Body.position[0],this.carContainer.y=Game.stageHeight-this.p2Body.position[1],this.shadow.position.x=0,this.shadowDefaultScale=1.4*this.wheelbase/this.shadow.width,this.shadow.scale.x=this.shadowDefaultScale,this.car.position3d.x=-this.wheelbase/2,this.scene.hud.addMarkerForVehicle(this),this.dustTrail=Game.displayStore.getAnimatedSprite("race-scene/dust-trail-frames"),this.dustTrail.gotoAndPlay(Game.getRandom(0,4,!0)),this.dustTrail.animationSpeed=.8,this.dustTrail.convertTo3d(),this.dustTrail.proj.euler.x=1.4,this.dustTrail.position3d.x=this.dustTrailObj.xOffset-this.wheelbase/2,this.dustTrail.scale3d.set(2,2,2),this.dustTrail.position3d.y=this.track/2,this.dustTrail.visible=!0,this.dustTrail.parentGroup=RaceScene.SORT_GROUP_PROP,this.carContainer.addChild(this.dustTrail),this.collideSparksTop=Game.displayStore.getAnimatedSprite("race-scene/collide-sparks-frames"),this.collideSparksTop.stop(),this.collideSparksTop.animationSpeed=.8,this.collideSparksTop.convertTo3d(),this.collideSparksTop.proj.euler.x=.4,this.collideSparksTop.position3d.x=0,this.collideSparksTop.scale3d.set(2.2,1.5,2),this.collideSparksTop.position3d.y=-this.track/3,this.collideSparksTop.position3d.z=-25,this.collideSparksTop.visible=!1,this.collideSparksTop.loop=!1,this.collideSparksTop.blendMode=PIXI.BLEND_MODES.ADD,this.collideSparksTop.onComplete=function(){e.collideSparksTop.gotoAndStop(0),e.collideSparksTop.visible=0},this.carContainer.addChild(this.collideSparksTop),this.collideSparksBottom=Game.displayStore.getAnimatedSprite("race-scene/collide-sparks-frames"),this.collideSparksBottom.gotoAndStop(0),this.collideSparksBottom.animationSpeed=.8,this.collideSparksBottom.convertTo3d(),this.collideSparksBottom.proj.euler.x=.4,this.collideSparksBottom.position3d.x=0,this.collideSparksBottom.scale3d.set(2.2,1.5,2),this.collideSparksBottom.position3d.y=this.track/2,this.collideSparksBottom.position3d.z=-25,this.collideSparksBottom.euler.z=Math.PI,this.collideSparksBottom.parentGroup=RaceScene.SORT_GROUP_PROP,this.collideSparksBottom.visible=!1,this.collideSparksBottom.loop=!1,this.collideSparksBottom.blendMode=PIXI.BLEND_MODES.ADD,this.collideSparksBottom.onComplete=function(){e.collideSparksBottom.gotoAndStop(0),e.collideSparksBottom.visible=!1},this.carContainer.addChild(this.collideSparksBottom),TweenMax.delayedCall(Game.getRandom(0,.5),function(){this.setCarSound("idle")},null,this)},t.prototype.showSparks=function(t){t>0?(this.collideSparksTop.gotoAndPlay(0),this.collideSparksTop.visible=!0):(this.collideSparksBottom.gotoAndPlay(0),this.collideSparksBottom.visible=!0),1==this.onScreen&&Game.playSound("car-impact-"+Game.getRandom(1,3,!0)+".mp3")},t.prototype.addRandomPaintAndStickers=function(){for(var t=Game.displayStore.getContainer("race-scene/vehicle-texture-container"),e=Game.displayStore.getContainer("race-scene/vehicle-texture-container-inner"),i=0;i<2;i++){var n=Game.getRandom(1,3,!0),o="top";i<=1&&(o="base",n=Game.getRandom(1,2,!0));var r;r=0==i?Game.displayStore.getSprite("race-scene/preload-paint/base-layer-"+n):Game.displayStore.getSprite("race-scene/preload-paint/"+this.carType+"-"+o+"-"+n);var a;0==i?(a=Game.getRandom(0,2,!0),r.tint=CoreData.pallettes[this.team][CoreData.colourGroupings[this.team][a].base]):r.tint=CoreData.pallettes[this.team][CoreData.colourGroupings[this.team][a].compliment[Game.getRandom(0,2,!0)]],r.y=-10,e.addChild(r)}for(var s=Game.coreData.getStickers(this.team),l=Game.getRandom(2,5,!0),i=0;i<l;i++){var c=s[Game.getRandom(0,s.length-1,!0)].id,h=Game.displayStore.getSprite("stickers-scene/"+this.team+"/draggable-"+c);h.position.x=10*Game.getRandom(0,45,!0),h.position.y=10*Game.getRandom(0,20,!0),e.addChild(h)}var p=Game.displayStore.getRenderTexture("vehicle-render-texture-"+this.id,2*e.width,2*e.height,"race-assets",!1),u=p.outputSprite,d=p.renderTexture,f=Game.displayStore.getSprite("race-scene/"+this.carType+"-mask"),m=new PIXI.Matrix;m.scale(2*this.craftToRaceScaleRatio,2*this.craftToRaceScaleRatio),t.addChild(e),t.addChild(f),e.mask=f,this.carBodyInner.addChild(t),Game.renderer.render(t,d,!0,m),u.blendMode=PIXI.BLEND_MODES.MULTIPLY,u.position.x=-this.textureSprite.width/2,u.position.y=-this.textureSprite.height,u.scale.set(.5,.5),this.carBodyInner.removeChild(t),this.carBodyInner.addChild(u)},t.prototype.addAttachments=function(t){CoreData.accessoryTypeData;for(var e=0;e<t.length;e++){var i=t[e].id;if(i){var n=Game.displayStore.getSprite3d("accessories-scene/draggable-"+i);n.convertTo3d(),n.scale.set(this.craftToRaceScaleRatio,this.craftToRaceScaleRatio);var o=t[e].attachPointIndex,r=CoreData.carTypeData[this.carType].accessoryAttachPoints[o].pos,a=CoreData.carTypeData[this.carType].accessoryAttachPoints[o].angle+CoreData.accessoryTypeData[i].defaultAngle,s=new PIXI.Point(r[0]*this.craftToRaceScaleRatio,r[1]*this.craftToRaceScaleRatio);n.position.x=s.x-this.textureSprite.width/2*1,n.position.y=s.y-1*this.textureSprite.height,n.rotation=a,n.setRegPoint(CoreData.accessoryTypeData[i].anchor[0],CoreData.accessoryTypeData[i].anchor[1]),this.carBodyInner.addChildAt(n,0),this.attachments.push({sprite:n,origRot:a})}}},t.prototype.target=function(){this.targetLocked=!0},t.prototype.releaseTarget=function(){this.targetLocked=!1},t.prototype.setCurrentStatus=function(t){this.currentStatus=t},t.prototype.getCurrentStatus=function(){return this.currentStatus},t.prototype.bashBackToLane=function(t){1!=this.bashing&&(this.bashing=!0,this.bashTimeout=0,t<0&&(t=0),t>RaceScene.lanePositions.length-1&&(t=RaceScene.lanePositions.length-1),this.targetLane=t,this.targetLane<0&&(this.targetLane=0),this.targetLane>RaceScene.lanePositions.length-1&&(this.targetLane=RaceScene.lanePositions.length-1),"player"==this.id&&(this.scene.interactionManager.targetLane=this.targetLane),this.targetLaneY=RaceScene.lanePositions[this.targetLane])},t.prototype.sortZ=function(t){var e=Math.abs(this.carContainer.euler.z);e<Math.PI/2||e>1.5*Math.PI?(t.wheelBL.zOrder=t.carBody.zOrder+.005,t.wheelFL.zOrder=t.carBody.zOrder+.005,t.wheelBR.zOrder=t.carBody.zOrder-.005,t.wheelFR.zOrder=t.carBody.zOrder-.005):(t.wheelBL.zOrder=t.carBody.zOrder-.005,t.wheelFL.zOrder=t.carBody.zOrder-.005,t.wheelBR.zOrder=t.carBody.zOrder+.005,t.wheelFR.zOrder=t.carBody.zOrder+.005)},t.prototype.changeLane=function(t){0!=this.scene.started&&1!=this.bashing&&(this.reachedTargetLane=!1,1==this.onScreen&&(t>this.targetLane?Game.playSound("change-lane-up.mp3",.7):Game.playSound("change-lane-down.mp3",.7)),this.targetLane=t,this.targetLane<0&&(this.targetLane=0),this.targetLane>RaceScene.lanePositions.length-1&&(this.targetLane=RaceScene.lanePositions.length-1),this.targetLaneY=RaceScene.lanePositions[this.targetLane])},t.prototype.setAnimationSpeed=function(){this.crashAnimation&&this.crashAnimation.timeScale(this.scene.gameSpeed),this.rampAnimation&&this.rampAnimation.timeScale(this.scene.gameSpeed),this.collectAnimation&&this.collectAnimation.timeScale(this.scene.gameSpeed)},t.prototype.endRace=function(){this.raceTime=(new Date).getTime()-this.raceTime,this.raceTime=10*Math.round(this.raceTime/10),"player"==this.id&&this.setCarSound("idle")},t.prototype.hitObstacle=function(e){if(this.currentStatus!=t.STATUS_HIT_RAMP)switch(this.currentStatus=t.STATUS_HIT_OBSTACLE,this.boostEndDelay=this.scene.killTween(this.boostEndDelay),this.rampAnimation=this.scene.killTween(this.rampAnimation),this.crashAnimation=this.scene.killTween(this.crashAnimation),this.crashAnimation=new TimelineMax,this.hitObstacleType=e,this.car.euler.y=0,this.carBody.euler.z=0,this.car.euler.x=0,this.carContainer.euler.z=0,this.car.position3d.z=0,e){case"bomb":if(this.scene.shuffleArray(this.attachments),this.attachments[0])var i=this.attachments[0].sprite;i&&(i.visible=!1),this.setCarSound("idle"),this.targetAcceleration=100;n=2*Game.getRandom(0,1,!0)-1;this.changeLane(Game.getRandom(0,4,!0)),this.crashAnimation.add([TweenMax.to(this.car.euler,.1,{y:-.4,ease:Power1.easeInOut}),TweenMax.to(this.backWheels.position3d,.1,{z:-this.wheelSize/6,ease:Power1.easeIn}),TweenMax.to(this.frontWheels.position3d,.1,{z:-this.wheelSize/3,ease:Power1.easeIn}),TweenMax.to(this.car.position3d,.1,{z:-100,ease:Power2.easeOut}),TweenMax.to(this.shadow.scale,.1,{x:this.shadowDefaultScale/2,y:.5,ease:Power2.easeOut}),TweenMax.to(this.shadow,.1,{alpha:.2,ease:Power2.easeOut})]),this.crashAnimation.add([TweenMax.to(this.car.position3d,.3,{z:0,ease:Power1.easeIn}),TweenMax.to(this.shadow.scale,.3,{x:this.shadowDefaultScale,y:1,ease:Power1.easeIn}),TweenMax.to(this.shadow,.1,{alpha:.5,ease:Power1.easeIn})]),this.crashAnimation.add([TweenMax.to(this.car.euler,.7,{y:0,ease:Elastic.easeOut}),TweenMax.to(this.carBody.euler,1,{z:0,ease:Elastic.easeOut}),TweenMax.to(this.frontWheels.position3d,.7,{z:-this.wheelSize/2,ease:Elastic.easeOut}),TweenMax.to(this.backWheels.position3d,.7,{z:-this.wheelSize/2,delay:.04,ease:Elastic.easeOut})]),this.crashAnimation.add(TweenMax.to(this.frontWheels.position3d,.1,{z:-this.wheelSize/1.5,ease:Power1.easeOut}),.25),this.crashAnimation.add(TweenMax.to(this.car.euler,.5,{x:2*Math.PI*n,ease:Power2.easeOut}),0),this.crashAnimation.call(function(){this.currentStatus=t.STATUS_DEFAULT},null,this,.4),this.crashAnimation.call(function(){this.accelerate()},null,this),this.crashAnimation.call(this.setCarSound,["rev"],this,"-=0.3"),1==this.onScreen&&this.crashAnimation.call(Game.playSound,["crash-1.mp3",.5],this,.45),this.crashAnimation.timeScale(this.scene.gameSpeed);break;case"gum":this.targetAcceleration=50,this.crashAnimation.call(function(){this.currentStatus=t.STATUS_DEFAULT},null,this,.6),this.crashAnimation.call(function(){this.accelerate()},null,this,.6),this.crashAnimation.call(this.setCarSound,["rev"],this,"-=0.3");break;case"ice":n=2*Game.getRandom(0,1,!0)-1;this.agility=this.wheelTypeData.agility/2,this.targetAcceleration=500,this.dustTrailObj.targetScale=0,this.dustTrailObj.targetAlpha=0;o=1-this.wheelTypeData.agility/CoreData.wheelStatsMinMax.agility.max;this.crashAnimation.add([TweenMax.to(this.carContainer.euler,.5,{z:Game.getRandom(.3,.8*o)*n,ease:Power1.easeInOut}),TweenMax.to(this.wheelFL.euler,.2,{y:-n/3,ease:Power1.easeInOut}),TweenMax.to(this.wheelFR.euler,.2,{y:-n/3,ease:Power1.easeInOut})],0),this.crashAnimation.call(function(){this.agility=this.wheelTypeData.agility,this.currentStatus=t.STATUS_DEFAULT},null,this,.8),this.crashAnimation.call(function(){this.accelerate()},null,this,.3+1*o),this.crashAnimation.call(this.setCarSound,["rev"],this,"-=0.3"),this.crashAnimation.add(TweenMax.to(this.carContainer.euler,.4,{z:0,ease:Power1.easeIn}),.5);break;case"oil":var n=2*Game.getRandom(0,1,!0)-1;if(this.agility=this.wheelTypeData.agility/2,this.targetAcceleration=250,this.dustTrailObj.targetScale=0,this.dustTrailObj.targetAlpha=0,this.speed>7){var o=1-this.wheelTypeData.agility/CoreData.wheelStatsMinMax.agility.max;this.crashAnimation.add([TweenMax.to(this.carContainer.euler,1,{z:2*Math.PI*n+n/3,ease:Power1.easeInOut}),TweenMax.to(this.wheelFL.euler,.2,{y:-n/3,ease:Power1.easeInOut}),TweenMax.to(this.wheelFR.euler,.2,{y:-n/3,ease:Power1.easeInOut})],0),this.crashAnimation.call(function(){this.changeLane(this.currentLane-n,.5)},null,this,.3),this.crashAnimation.call(function(){this.accelerate(),this.currentStatus=t.STATUS_DEFAULT},null,this,1.2),this.crashAnimation.call(this.setCarSound,["rev"],this,"-=0.3"),this.crashAnimation.add([TweenMax.to(this.carContainer.euler,.4,{z:2*Math.PI*n,ease:Power2.easeInOut}),TweenMax.to(this.wheelFL.euler,.2,{y:0,ease:Power1.easeInOut}),TweenMax.to(this.wheelFR.euler,.2,{y:0,ease:Power1.easeInOut})],1.2),this.crashAnimation.call(function(){this.agility=this.wheelTypeData.agility,this.carContainer.euler.z=0},null,this,1.6)}else this.crashAnimation.add([TweenMax.to(this.carContainer.euler,1,{z:n/2,ease:Power1.easeInOut}),TweenMax.to(this.wheelFL.euler,.2,{y:-n/3,ease:Power1.easeInOut}),TweenMax.to(this.wheelFR.euler,.2,{y:-n/3,ease:Power1.easeInOut})],0),this.crashAnimation.call(function(){this.accelerate(),this.currentStatus=t.STATUS_DEFAULT},null,this,1.2),this.crashAnimation.call(this.setCarSound,["rev"],this,"-=0.3"),this.crashAnimation.add([TweenMax.to(this.carContainer.euler,.4,{z:0,ease:Power2.easeInOut}),TweenMax.to(this.wheelFL.euler,.2,{y:0,ease:Power1.easeInOut}),TweenMax.to(this.wheelFR.euler,.2,{y:0,ease:Power1.easeInOut})],1.2),this.crashAnimation.call(function(){this.agility=this.wheelTypeData.agility,this.carContainer.euler.z=0},null,this,1.6)}},t.prototype.hitRamp=function(e){this.currentStatus!=t.STATUS_SMASHED&&(this.currentStatus=t.STATUS_HIT_RAMP,this.crashAnimation=this.scene.killTween(this.crashAnimation),this.boostEndDelay=this.scene.killTween(this.boostEndDelay),this.rampAnimation=this.scene.killTween(this.rampAnimation),this.boost(4,.35),this.car.euler.y=0,this.carBody.euler.z=0,this.car.euler.x=0,this.carContainer.euler.z=0,this.rampAnimation=new TimelineMax,this.rampAnimation.call(function(){this.dustTrailObj.targetScale=0,this.dustTrailObj.targetAlpha=0,this.dustTrailObj.xOffset=-100},null,this),this.rampAnimation.add([TweenMax.to(this.car.euler,.1,{y:.35,ease:Power1.easeInOut}),TweenMax.to(this.frontWheels.position3d,.1,{z:-this.wheelSize/1.6,ease:Power2.easeOut}),TweenMax.to(this.backWheels.position3d,.2,{z:-this.wheelSize/4,ease:Power2.easeIn}),TweenMax.to(this.frontWheels.position3d,.1,{z:-this.wheelSize/4,delay:.1,ease:Power1.easeOut}),TweenMax.to(this.car.position3d,.25,{z:-40,ease:Power2.easeInOut}),TweenMax.to(this.shadow.scale,.1,{x:this.shadowDefaultScale/2,y:.5,ease:Power2.easeOut}),TweenMax.to(this.shadow,.1,{alpha:.2,ease:Power2.easeOut})]),this.rampAnimation.call(function(){this.dustTrailObj.targetScale=2,this.dustTrailObj.targetAlpha=1,this.dustTrailObj.xOffset=10},null,this),this.rampAnimation.add([TweenMax.to(this.car.position3d,.3,{z:0,ease:Power1.easeIn}),TweenMax.to(this.car.euler,.2,{y:.05,ease:Power1.easeIn}),TweenMax.to(this.shadow.scale,.2,{x:this.shadowDefaultScale,y:1,ease:Power1.easeIn}),TweenMax.to(this.shadow,.1,{alpha:.5,ease:Power2.easeIn})]),this.rampAnimation.add([TweenMax.to(this.car.euler,.7,{y:0,ease:Elastic.easeOut}),TweenMax.to(this.carBody.euler,1,{z:0,ease:Elastic.easeOut}),TweenMax.to(this.frontWheels.position3d,.7,{z:-this.wheelSize/2,ease:Elastic.easeOut}),TweenMax.to(this.backWheels.position3d,.7,{z:-this.wheelSize/2,ease:Elastic.easeOut})]),this.rampAnimation.call(function(){this.currentStatus=t.STATUS_DEFAULT},null,this,.4),this.rampAnimation.call(function(){1==this.onScreen&&Game.playSound("land.mp3",.7)},null,this,.55),this.rampAnimation.call(function(){1==this.onScreen&&Game.playSound("swish-long-"+Game.getRandom(1,3,!0)+".mp3",.5)},null,this,.1),this.rampAnimation.timeScale(this.scene.gameSpeed),e&&this.rampAnimation.call(this.scene.shakeScreen,[1.5,2,10,.2,1],this.scene,.6))},t.prototype.hitCollectable=function(t){"coin"==t&&this.coins++,this.collectAnimation=this.scene.killTween(this.collectAnimation),this.collectAnimation=new TimelineMax,this.collectAnimation.add(TweenMax.to(this.carBody.euler,.1,{z:.05})),this.collectAnimation.add(TweenMax.to(this.carBody.euler,1,{z:-.1,ease:Elastic.easeOut})),this.collectAnimation.timeScale(this.scene.gameSpeed)},t.prototype.highlight=function(t){this.textureSprite.tint=t||16702494,this.textureSprite.filters=[this.brightnessFilter],this.highlighted=!0},t.prototype.removeHighlight=function(){this.textureSprite.tint=16777215,this.textureSprite.filters=null,this.highlighted=!1},t.prototype.setParentGroup=function(t){this.container.parentGroup=t},t.prototype.accelerate=function(e){1!=this.scene.endingRace&&this.currentStatus!=t.STATUS_SMASHED&&(TweenMax.to(this.carBody.euler,1,{z:-.1,ease:Elastic.easeOut}),this.targetAcceleration=e+5e3*this.accelerationPower,this.currentStatus!=t.STATUS_HIT_RAMP&&"player"==this.id&&this.setCarSound("accelerate"))},t.prototype.brake=function(){1!=this.braking&&(TweenMax.to(this.carBody.euler,1,{z:.1,ease:Power1.easeOut}),this.targetAcceleration=0,this.braking=!0,Game.playSound("brake.mp3"),"player"==this.id&&this.setCarSound("deccelerate"))},t.prototype.stopBraking=function(){this.currentStatus!=t.STATUS_HIT_OBSTACLE&&0!=this.scene.started&&(this.braking=!1,"player"==this.id&&this.accelerate(this.scene.levelSpeed))},t.prototype.setCarSound=function(t){if(this.currentCarSound!=t&&0!=this.onScreen&&!this.scene.paused&&"player"==this.id){switch(Game.stopSound("car-idle.wav"),Game.stopSound("car-jump.wav"),Game.stopSound("car-accelerate.wav"),Game.stopSound("car-slow-down.wav"),Game.stopSound("car-idle-high.wav"),console.log("playing car sound: "+t),t){case"idle":Game.playSound("car-idle.wav",.6);break;case"deccelerate":Game.playSound("car-slow-down.mp3",.7);break;case"accelerate":Game.playSound("car-idle-high.wav",.9);break;case"rev":Game.playSound("car-rev.wav",.5),TweenMax.delayedCall(.5,this.setCarSound,["accelerate"],this);break;case"jump":Game.playSound("car-slow-down.mp3",1),TweenMax.delayedCall(.6,this.setCarSound,["accelerate"],this)}this.currentCarSound=t}},t.prototype.boost=function(t,e){1!=this.scene.endingRace&&(this.targetAcceleration=this.scene.levelSpeed*t,"player"!=this.id?1==this.onScreen&&Game.playSound("car-slow-down.wav",1):this.setCarSound("jump"),this.boostEndDelay=this.scene.killTween(this.boostEndDelay),this.boostEndDelay=TweenMax.delayedCall(e,this.accelerate,null,this))},t.prototype.stopAccelerating=function(t){t&&(this.deccelerationPower=t),TweenMax.to(this.carBody.euler,.7,{z:0,ease:Bounce.easeOut}),this.targetAcceleration=0},t.prototype.pause=function(){this.scene.pauseResumeTween(this.rampAnimation,"pause"),this.scene.pauseResumeTween(this.crashAnimation,"pause"),this.scene.pauseResumeTween(this.collectAnimation,"pause"),this.dustTrail.stop(),Game.pauseSound("car-idle.wav"),Game.pauseSound("car-accelerate.wav"),Game.pauseSound("car-slow-down.wav"),Game.pauseSound("car-idle-high.wav")},t.prototype.resume=function(){this.scene.pauseResumeTween(this.rampAnimation,"resume"),this.scene.pauseResumeTween(this.crashAnimation,"resume"),this.scene.pauseResumeTween(this.collectAnimation,"resume"),this.dustTrail.play(),Game.resumeSound("car-idle.wav"),Game.resumeSound("car-accelerate.wav"),Game.resumeSound("car-slow-down.wav"),Game.resumeSound("car-idle-high.wav")},t.prototype.getSpeed=function(){return this.speed},t.prototype.setBodyCollisionMask=function(t,e){this.p2Shape.collisionMask=t,this.p2Shape.collisionGroup=e},t.prototype.setDetectCollisionMask=function(t,e){this.detectShape.collisionMask=t,this.detectShape.collisionGroup=e},t.prototype.addForce=function(t){t[0]*=this.speedMultiplier,t[1]*=this.speedMultiplier,this.p2Body.applyForce(t)},t.prototype.tick=function(){var e=this.container.getBounds(),i=Game.windowScaleFactor;if(e.y+e.height<0||e.y>Game.stageHeight*i||e.x>Game.stageWidth*i||e.x+e.width<0?1==this.onScreen&&this.hide():0==this.onScreen&&this.show(),this.currentStatus!=t.STATUS_SMASHED){this.targetAcceleration<this.acceleration?this.acceleration+=(this.targetAcceleration-this.acceleration)*this.deccelerationPower:this.acceleration+=(this.targetAcceleration-this.acceleration)*this.accelerationPower,this.targetLane!=this.currentLane&&(this.checkLaneCounter+=1/Game.fps),1==this.bashing&&(this.bashTimeout+=1/Game.fps),this.bashTimeout>this.bashTimeoutThreshold&&(this.bashing=!1,this.bashTimeout=0),this.checkLaneCounter>this.checkLaneCounterLimit&&(this.changeLane(this.lastLane),this.checkLaneCounter=0,"player"==this.id&&this.scene.interactionManager.hideIndicator(this.lastLane));var n=[this.acceleration,0];this.addForce(n),this.container.x=this.p2Body.position[0],this.carContainer.y=Game.stageHeight-this.p2Body.position[1],this.scenePos.x=this.container.x,this.scenePos.y=this.carContainer.y;var o=this.p2Body.force[0];this.currentStatus==t.STATUS_HIT_OBSTACLE&&"ice"==this.hitObstacleType&&(o=1e3),this.wheelFL.euler.z+=o/(5e3+this.wheelBR.width),this.wheelFR.euler.z+=o/(5e3+this.wheelBR.width),this.wheelBL.euler.z+=o/(5e3+this.wheelBR.width),this.wheelBR.euler.z+=o/(5e3+this.wheelBR.width);var r=[];p2.vec2.copy(r,this.p2Body.force),this.forceMagnitude=p2.vec2.length(r);var a=this.speed/this.maxSpeed;a>1&&(a=1);var s=(this.targetLaneY-this.p2Body.position[1])*this.agility*a;this.currentStatus==t.STATUS_DEFAULT&&(this.car.euler.z=-s/8e3,this.wheelFL.euler.y=-s/6e3,this.wheelFR.euler.y=-s/6e3),this.addForce([0,s]),this.p2Body.position[1]<this.targetLaneY+this.bashResetMargin&&this.p2Body.position[1]>this.targetLaneY-this.bashResetMargin&&(1==this.bashing&&(this.bashing=!1),0==this.reachedTargetLane&&(this.reachedTargetLane=!0,this.checkLaneCounter=0)),this.raceProgress=(this.container.x-this.scene.trackManager.tileSize/2)/this.validTrackLength,this.updateAnimation();for(var l=0;l<RaceScene.lanePositions.length;l++)this.scene.getDistance(new PIXI.Point(0,this.p2Body.position[1]),new PIXI.Point(0,RaceScene.lanePositions[l]))<this.lanePositionMargin&&(this.currentLane=l);this.currentLane==this.targetLane&&"player"==this.id&&this.scene.interactionManager.hideIndicator(this.currentLane),this.lastLane=this.currentLane,this.powerupTime+=1/Game.fps,this.changeInSpeed=this.speed-this.lastSpeed,this.lastPos.x=this.scenePos.x,this.lastPos.y=this.scenePos.y}},t.prototype.hide=function(){this.container.visible=!1,"player"!=this.id&&(Game.stopSound("car-idle.wav"),Game.stopSound("car-accelerate.wav"),Game.stopSound("car-slow-down.wav")),this.onScreen=!1},t.prototype.show=function(){this.currentStatus!=t.STATUS_SMASHED&&(this.container.visible=!0,this.onScreen=!0,this.id)},t.prototype.updateAnimation=function(){this.speed=this.scene.getDistance(this.scenePos,this.lastPos),this.speed<.1&&(this.speed=0),this.currentStatus!=t.STATUS_HIT_RAMP&&this.currentStatus!=t.STATUS_HIT_OBSTACLE&&(this.dustTrailObj.targetScale=this.speed/7,this.dustTrailObj.targetAlpha=this.speed/10),this.dustTrail.scale3d.x+=(this.dustTrailObj.targetScale-this.dustTrail.scale3d.x)/5,this.dustTrail.scale3d.y=this.dustTrail.scale3d.z=this.dustTrail.scale3d.x,this.dustTrail.alpha+=(this.dustTrailObj.targetAlpha-this.dustTrail.alpha)/5,this.dustTrail.position3d.x+=(this.dustTrailObj.xOffset-this.wheelbase/2-this.dustTrail.position3d.x)/5;Math.round(10-this.speed);var e=.01*Math.sin(this.ticker/2),i=.08*Math.sin((this.ticker+.5)/2),n=-1.5*(this.carBody.euler.z+this.car.euler.z+this.carBodyInner.euler.z)+i;if(this.currentStatus!=t.STATUS_SMASHED){this.carBodyInner.euler.z=e;for(var o=0;o<this.attachments.length;o++)this.attachments[o].sprite.rotation+=(this.attachments[o].origRot+n-this.attachments[o].sprite.rotation)/2}.036*this.speed<.15&&this.forceMagnitude,this.ticker++},t.prototype.destroy=function(){this.removeHighlight(),this.carContainer.removeChild(this.shadow),Game.displayStore.returnPooledItem(this.container),Game.displayStore.returnPooledItem(this.shadow),this.carBodyInner.removeAllChildren(),this.carBody.removeAllChildren(),this.car.removeAllChildren(),this.backWheels.removeAllChildren(),this.frontWheels.removeAllChildren(),Game.stopSound("car-idle.wav"),Game.stopSound("car-accelerate.wav"),Game.stopSound("car-slow-down.wav"),Game.stopSound("car-idle-high.wav"),this.crashAnimation=this.scene.killTween(this.crashAnimation),this.collectAnimation=this.scene.killTween(this.collectAnimation),this.rampAnimation=this.scene.killTween(this.rampAnimation)},t.STATUS_SMASHED="smashed",t.STATUS_HIT_RAMP="hit-ramp",t.STATUS_HIT_OBSTACLE="hit-obstacle",t.STATUS_DEFAULT="default",t}(),Powerup=function(){function t(t){this.scene=t,this.status=this.lastStatus="not-ready",this.ticker=0,this.container=Game.displayStore.getContainer3d("race-scene/powerup-container"),this.container.position3d.x=-2500,this.container.parentGroup=RaceScene.SORT_GROUP_PROP_FRONT,Game.displayStore.getSprite3d("global/magenta.png").height=800,this.scene.surfaceLayer.addChild(this.container)}return t.prototype.setStatus=function(t){t!=this.lastStatus&&(this.status=t,console.log("setting status",t),"not-ready"==this.lastStatus&&"aiming"==this.status&&(this.container.position3d.x=this.scene.player.scenePos.x-2500),this.lastStatus=this.status)},t.prototype.setStatusWhenFinished=function(t){this.statusWhenFinished=t},t.prototype.targetVehicle=function(t){this.target=t},t.prototype.activate=function(t){this.setStatus("activating"),this.targetLane=t?t.currentLane:this.scene.player.currentLane},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.tick=function(){this.ticker++;var t,e=0,i=40;"activating"==this.status?t=this.scene.player.scenePos.x+500:"aiming"==this.status?t=this.scene.player.scenePos.x:"not-ready"==this.status&&(t=this.scene.player.scenePos.x-2500),this.target&&(i=1,t=this.target.scenePos.x+10,e=this.target.scenePos.y),"activating"==this.status&&this.target||(this.container.position3d.x+=(t-this.container.position3d.x)/i,this.container.position3d.y+=(e-this.container.position3d.y)/i)},t.prototype.destroy=function(){this.container.removeAllChildren(),this.timeline=this.scene.killTween(this.timeline)},t}(),DraggableMenuItem=function(){function t(t,e,i,n){this.scene=t.scene,this.menuTile=t,this.inUse=!1,this.pos=new PIXI.Point,this.index=e,this.id=n,this.container=Game.displayStore.getContainer("craft-scene/draggable-item-holder"),this.spriteString=i,this.sprite=Game.displayStore.getSprite(i),this.sprite.setRegPoint(.5,.5),this.container.addChild(this.sprite),this.container.scale.set(1,1)}return t.prototype.startDrag=function(){this.container.visible=!0,TweenMax.to(this.container.scale,.1,{ease:Back.easeOut,x:1.1,y:1.1})},t.prototype.drop=function(){TweenMax.to(this.container.scale,.2,{ease:Bounce.easeOut,x:1,y:1})},t.prototype.moveItem=function(t){this.container.position.copy(t),this.pos.copy(t)},t.prototype.activate=function(){this.container.position.x=95,this.container.parent.addChild(this.container)},t.prototype.deactivate=function(){this.container.position.x=120},t.prototype.tick=function(){},t.prototype.destroy=function(){this.container.parent&&this.container.parent.removeChild(this.container),this.container.removeAllChildren(),Game.displayStore.returnPooledItem(this.sprite),Game.displayStore.returnPooledItem(this.tile)},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),CraftScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="craftScene",n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.setBackgroundColor(13369548),this.mousePos=new PIXI.Point,this.doingNextScene=!1,this.touchSprite=Game.displayStore.getSprite("craft-scene/blank-input.png"),this.touchSprite.width=Game.stageWidth,this.touchSprite.height=Game.stageHeight,this.touchSprite.alpha=0,this.menuTiles=[],this.titleText.align="center",this.titleText.tint=16771584,this.titleText.position.set(512-this.titleText.width/2,32),this.mainHolder=Game.displayStore.getContainer("craft-scene/main-holder");var i=Game.displayStore.getSprite("paint-scene/bg.png");this.mainHolder.addChild(i),this.mainHolder.setRegPointPixels(Game.stageWidth/2,Game.stageHeight/2,!0),this.dragLayer=Game.displayStore.getContainer("craft-scene/drag-layer"),this.car=new Car(this),this.container.addChild(this.mainHolder),this.animation=new TimelineMax;this.animation.add([TweenMax.to(this.mainHolder.scale,.5,{x:1,y:1,ease:Sine.easeInOut})],.5),this.mainHolder.addChild(this.car.container),this.mainHolder.addChild(this.titleText),this.mainHolder.addChild(this.dragLayer),this.mainHolder.addChild(this.touchSprite)},e.prototype.nextScene=function(){this.doingNextScene=!0},e.prototype.addCoinsPanel=function(){this.coinsPanel=new CoinsPanel(this),this.container.addChild(this.coinsPanel.container)},e.prototype.hidePrompt=function(){},e.prototype.promptIsHidden=function(){},e.prototype.coinsAreUpdated=function(){},e.prototype.createTilePanel=function(t){this.panelHolder=t.panel,this.tilesHolder=Game.displayStore.getContainer("craft-scene/tiles-holder"),this.mainHolder.addChild(this.panelHolder),this.mainHolder.addChild(this.dragLayer),this.pagesY=[];for(var e,i=t.items.length,n=0,o=Math.ceil(i/t.columns),r=0;r<o;r++)for(var a=0;a<t.columns&&n!=i;a++){var s=new MenuTile(this,n,[70+90*a,80+90*r],t.items[n],t.tileOffset,t.tileRegPoint,t.dragItemType,t.prepend);this.menuTiles.push(s),this.tilesHolder.addChild(s.container),e=s.bg.width,r%(t.tilesPerPage/t.columns)==0&&0==a&&this.pagesY.push(80-s.container.position.y),n++}this.tilesMask=new PIXI.Graphics;var l=t.tilesPerPage/t.columns,c=e*t.columns+90*(t.columns-1),h=e*l+(90-e)*(l-1);this.tilesMask.beginFill(16711680,1),this.tilesMask.drawRect(0,80-e/2-10,c,h+10),this.tilesMask.endFill(),this.tilesMask.cacheAsBitmap=!0,this.currentTilesPage=0,this.paginationDots=[];var p=Math.ceil(n/t.tilesPerPage),u=Game.displayStore.getContainer("craft-scene/page-indicator-holder");if(u.position.x=240,p>1){for(r=0;r<p;r++){var d=Game.displayStore.getContainer("craft-scene/page-indicator"),f=Game.displayStore.getSprite("craft-scene/page-indicator-empty"),m=Game.displayStore.getSprite("craft-scene/page-indicator-full");d.addChild(f),d.addChild(m),d.position.y=40*r,u.addChild(d),this.paginationDots.push(d)}this.paginationHighlight=Game.displayStore.getSprite("craft-scene/page-indicator-highlight"),u.addChild(this.paginationHighlight),u.position.y=t.panel.height/2-u.height/2+this.paginationDots[0].height/2,this.panelHolder.addChild(u),this.game.ui.addUIButton(this.game.ui.panelButtonDown,!0,!0)}this.panelHolder.addChild(this.tilesHolder),this.panelHolder.addChild(this.tilesMask),this.tilesMask.interactive=!1,this.tilesMask.interactiveChildren=!1,this.tilesHolder.mask=this.tilesMask,this.updatePaginationIndicator(),this.addTileDragInteraction()},e.prototype.addTileDragInteraction=function(){var t=this,e=this.touchSprite;this.touchSprite.interactive=!0,Game.onDesktop?(e.on("mouseup",function(e){t.touchEnd(t,e)}),e.on("mouseout",function(e){t.selectedMenuItem&&t.touchEnd(t,e)}),e.on("mousemove",function(e){t.touchMove(t,e)})):(e.on("touchend",function(e){t.touchEnd(t,e)}),e.on("touchmove",function(e){t.touchMove(t,e)}))},e.prototype.setSelectedMenuItem=function(t){this.selectedMenuItem=t,this.game.ui.disableAll()},e.prototype.touchEnd=function(t,e){t.mousePos.x=e.data.getLocalPosition(t.container).x,t.mousePos.y=e.data.getLocalPosition(t.container).y,t.panelHolder&&t.mainHolder.addChild(t.panelHolder),t.mainHolder.addChild(t.dragLayer),this.game.ui.enableAll(),t.selectedMenuItem=null},e.prototype.touchMove=function(t,e){t.mousePos.x=e.data.getLocalPosition(t.container).x,t.mousePos.y=e.data.getLocalPosition(t.container).y,t.selectedMenuItem&&t.selectedMenuItem.moveItem(t.mousePos)},e.prototype.updatePaginationIndicator=function(){for(var t=0;t<this.paginationDots.length;t++)t==this.currentTilesPage?(this.paginationDots[t].showOnlyChild(1),this.paginationHighlight.position.copy(this.paginationDots[t].position)):this.paginationDots[t].showOnlyChild(0)},e.prototype.downOnUI=function(e){if(t.prototype.downOnUI.call(this,e),1!=this.interactionLocked)switch(e.id){case"panel-button-down":this.scrollPanel("down");break;case"panel-button-up":this.scrollPanel("up")}},e.prototype.uiClicked=function(e){t.prototype.uiClicked.call(this,e),1!=this.interactionLocked&&e.id},e.prototype.scrollPanel=function(t){var e=this.currentTilesPage;"down"==t?(Game.playSound("swipe-1.mp3"),e++):(Game.playSound("swipe-2.mp3"),e--),e<0&&(e=0),e>this.paginationDots.length-1&&(e=this.paginationDots.length-1),TweenMax.to(this.tilesHolder.position,.5,{ease:Power4.easeOut,y:this.pagesY[e]}),e==this.paginationDots.length-1?this.game.ui.removeButton(this.game.ui.panelButtonDown):this.game.ui.addUIButton(this.game.ui.panelButtonDown,!0,!0),0==e?this.game.ui.removeButton(this.game.ui.panelButtonUp):this.game.ui.addUIButton(this.game.ui.panelButtonUp,!0,!0),this.currentTilesPage=e,this.updatePaginationIndicator()},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.getDistance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.animation=this.killTween(this.animation),this.car.destroy();for(var e=0;e<this.menuTiles.length;e++)this.menuTiles[e].destroy();this.panelHolder&&this.tilesMask&&this.panelHolder.removeChild(this.tilesMask),this.tilesMask&&this.tilesMask.clear(),this.touchSprite.removeAllListeners(),this.mainHolder.removeAllChildren(),this.container.removeAllChildren(),Game.displayStore.returnAllPooledItems("craft-assets")},e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),LoadingScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.endPreloadTriggered=!1,n.id="loadingScene",n}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.armNames=["tom","jerry","scooby","shaggy","duck","bugs"],this.setBackgroundColor(1229291),this.game.ui.setUI("none"),this.backgroundTop=Game.displayStore.getSprite("preloader/background"),this.patternTop=Game.displayStore.getSprite("preloader/pattern"),this.logo=Game.displayStore.getSprite("preloader/logo"),this.backgroundBottom=Game.displayStore.getSprite("preloader/background-bottom"),this.patternBottom=Game.displayStore.getSprite("preloader/pattern-front"),this.backgroundTop.width=2*Game.stageWidth,this.backgroundTop.height=2*Game.stageHeight,this.colours=new Array,this.colours.push({background:15533440,foreground:14161521}),this.colours.push({background:5028214,foreground:4109667}),this.colours.push({background:1808853,foreground:4176364});var e=Game.getRandom(0,this.colours.length-1,!0);this.patternTop.tint=this.colours[e].foreground,this.patternBottom.tint=this.colours[e].foreground,this.backgroundBottom.tint=this.colours[e].background,this.backgroundTop.tint=this.colours[e].background,this.logo.position.x=Game.stageWidth/2-9,this.logo.position.y=310,this.arm=Game.displayStore.getSprite("preloader/"+this.armNames[Game.getRandom(0,this.armNames.length-1,!0)]+"-arm"),this.backgroundBottom.position.x=0,this.backgroundBottom.position.y=Game.stageHeight,this.patternBottom.position.x=Game.stageWidth,this.patternBottom.position.y=Game.stageHeight,this.patternTop.position.x=Game.stageWidth,this.patternTop.position.y=Game.stageHeight,this.arm.position.x=Game.stageWidth/2-10,this.arm.position.y=-420,this.container.addChild(this.backgroundTop),this.container.addChild(this.patternTop),this.container.addChild(this.logo),this.container.addChild(this.arm),this.container.addChild(this.backgroundBottom),this.container.addChild(this.patternBottom),this.loadedAnimation=new TimelineMax,this.loadingText=Game.displayStore.getBitmapText("preloader/loading-font","loading"),this.loadingText.setPosition(Game.stageWidth/2-this.loadingText.width/2,380),this.loadingText.tint=16777215,this.loadingText.position.y=475,this.preloaderBarContainerMain=Game.displayStore.getContainer("preloader-bar"),this.preloaderBarContainerMain.setRegPoint(.5,.5,!0),this.preloaderBarContainerMain.position.x=Game.stageWidth/2-20,this.preloaderBarContainerMain.position.y=420,this.preloaderBarFillMain=this.preloaderBarContainerMain.getSprite("bar-fill"),this.maskElement=new PIXI.Graphics,this.maskElement.moveTo(0,0),this.maskElement.beginFill(16777215),this.maskElement.lineTo(373,0),this.maskElement.lineTo(373,60),this.maskElement.lineTo(0,60),this.maskElement.lineTo(0,0),this.maskElement.endFill(),this.maskElement.position.x=22,this.maskElement.position.y=22,this.preloaderBarContainerMain.addChild(this.maskElement),this.preloaderBarFillMain.mask=this.maskElement,this.maskElement.scale.x=0,this.currentScale=0,this.gradientElement=Game.displayStore.getSprite("preloader/preloader-gradient-element.png"),this.gradientElement.width=Game.stageWidth,this.gradientElement.height=Game.stageHeight,this.gradientElement.position.x=Game.stageWidth/2,this.gradientElement.position.y=Game.stageHeight/2,this.topElement=Game.displayStore.getSprite("preloader/preloader-pattern.png"),this.bottomElement=Game.displayStore.getSprite("preloader/preloader-pattern.png"),this.bottomElement.scale.y=-1,this.bottomElement.position.y=Game.stageHeight,this.topElement.alpha=.7,this.bottomElement.alpha=.7,this.container.addChild(this.loadingText),this.container.addChild(this.preloaderBarContainerMain)},e.prototype.positionLoadingText=function(){this.loadingText.position.x=this.preloaderBarFillMain.width/2-this.loadingText.width/2},e.prototype.onLoadUpdate=function(t,e){this.currentScale=t/e,t==e&&(this.loadedAnimation.add([TweenMax.to(this.arm.position,.4,{y:"+=330",ease:Power1.easeInOut})]),this.loadedAnimation.add([TweenMax.to(this.arm.position,.2,{y:"+=40",ease:Power1.easeInOut}),TweenMax.to(this.logo.position,.2,{y:"+=30",ease:Power1.easeInOut})]),this.loadedAnimation.add([TweenMax.to(this.arm.position,.3,{y:"-=340",ease:Power1.easeInOut}),TweenMax.to(this.logo.position,.3,{y:"-=30",ease:Back.easeOut})],"+=0.2"),this.loadedAnimation.call(Game.playSound,["button-click-2.mp3"],this,.5))},e.prototype.tick=function(e){t.prototype.tick.call(this,e),this.maskElement.scale.x+=(this.currentScale-this.maskElement.scale.x)/9},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.container.removeChild(this.loadingText),this.container.removeChild(this.preloaderBarContainerMain),this.preloaderBarFillMain.mask=null,this.maskElement.clear(),this.preloaderBarContainerMain.removeChild(this.maskElement),this.currentScale=0,Game.displayStore.returnPooledItem(this.topElement),Game.displayStore.returnPooledItem(this.bottomElement),Game.displayStore.flush(this.getPreloaderAssetList())},e.prototype.getPreloaderAssetList=function(){return["initial-loading-assets"]},e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),CarouselMenuScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.tileSpacing=580,n.id="carouselMenuScene",n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.currentTile=1,this.doingNextScene=!1,this.tiles=[],this.menuData=e.menuData,this.prepend=e.prepend,this.generateShadows=e.generateShadows,this.titleText=Game.displayStore.getBitmapText("carousel-menu/title-text",e.titleString),this.titleText.position.set(512-this.titleText.width/2,32),this.titleText.tint=16771584,this.container.addChild(new PIXI.display.Layer(Scene.SORT_GROUP_BACK)),this.createTiles(),this.createCorners(),this.container.addChild(this.titleText)},e.prototype.createTiles=function(){this.tileStrip=Game.displayStore.getContainer("carousel-menu/tile-strip"),this.container.addChild(this.tileStrip);for(var t=0;t<this.menuData.length;t++){var e=new CarouselTile(this,t,[t*this.tileSpacing,170],this.menuData[t],this.prepend,this.generateShadows);this.tileStrip.addChild(e.container),this.tiles.push(e)}},e.prototype.createCorners=function(){this.corners=[],this.cornerContainer=Game.displayStore.getContainer("carousel-menu/highlight-corner-container"),this.cornerContainer.position.set(Game.stageWidth/2,Game.stageHeight/2);for(var t=[{scale:new PIXI.Point(1,1),pos:new PIXI.Point(-300,-180)},{scale:new PIXI.Point(-1,1),pos:new PIXI.Point(300,-180)},{scale:new PIXI.Point(1,-1),pos:new PIXI.Point(-300,200)},{scale:new PIXI.Point(-1,-1),pos:new PIXI.Point(300,200)}],e=0;e<4;e++){var i=Game.displayStore.getSprite("carousel-menu/highlight-corner.png");i.scale.x=t[e].scale.x,i.scale.y=t[e].scale.y,i.position=t[e].pos,this.corners.push(i),this.corners[e].visible=!1,this.cornerContainer.addChild(this.corners[e])}this.container.addChild(this.cornerContainer)},e.prototype.nextTile=function(){this.currentTile!=this.menuData.length-1&&(this.currentTile++,this.goToTile(this.currentTile))},e.prototype.prevTile=function(){0!=this.currentTile&&(this.currentTile--,this.goToTile(this.currentTile))},e.prototype.enableCorners=function(){for(var t=(this.corners[1].position.x-this.corners[0].position.x)/(this.corners[2].position.y-this.corners[0].position.y),e=0;e<this.corners.length;e++)this.corners[e].visible=!0;TweenMax.from(this.corners[0].position,.7,{x:"+="+String(100),y:"+="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[1].position,.7,{x:"-="+String(100),y:"+="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[2].position,.7,{x:"+="+String(100),y:"-="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[3].position,.7,{x:"-="+String(100),y:"-="+String(100*t),ease:Elastic.easeOut})},e.prototype.goToTile=function(t,e){if(e?this.tileStrip.position.x=-this.tileSpacing*t+Game.stageWidth/2:TweenMax.to(this.tileStrip.position,.5,{x:-this.tileSpacing*t+Game.stageWidth/2,ease:Expo.easeInOut}),this.currentTile=t,e)this.previousTile=this.currentTile;else{for(var i=0;i<this.tiles.length;i++)TweenMax.delayedCall(Game.getRandom(-.1,0),function(t){this.previousTile<this.currentTile?t.moveLeft():t.moveRight(),Game.playSound("swipe-"+Game.getRandom(1,3,!0)+".mp3",.3)},[this.tiles[i]],this);TweenMax.delayedCall(.1,function(){this.previousTile=this.currentTile},null,this)}},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"menu-button-left":this.prevTile();break;case"menu-button-right":this.nextTile()}},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.nextScene=function(){this.doingNextScene=!0},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.tiles.length;e++)this.tiles[e].destroy();Game.displayStore.returnAllPooledItems("carousel-menu-assets")},e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),TitleScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="titleScene",n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),Game.restoreProgress(),this.setBackgroundColor(2832201),this.game.ui.setUI("title"),this.mainContainer=Game.displayStore.getContainer("title-scene/main-container"),this.tweetyContainer=Game.displayStore.getContainer("title-scene/tweety-container"),this.tweetyHeadContainer=this.tweetyContainer.getContainer("title-scene/tweety-head-container"),this.logoContainer=Game.displayStore.getContainer("title-scene/logo-holder"),this.foregroundContainer=Game.displayStore.getContainer("title-scene/foreground-container"),this.backgroundContainer=Game.displayStore.getContainer("title-scene/background-container"),this.ramp=Game.displayStore.getSprite("title-scene/ramp"),this.logo=Game.displayStore.getSprite("title-scene/logo"),this.tweetybody1=Game.displayStore.getSprite("title-scene/tweety-body-1"),this.tweetybody2=Game.displayStore.getSprite("title-scene/tweety-body-2"),this.tweetybody3=Game.displayStore.getSprite("title-scene/tweety-body-3"),this.tweetybody1.visible=!0,this.tweetybody2.visible=!1,this.tweetybody3.visible=!1,this.background=Game.displayStore.getSprite("title-scene/background"),this.backgroundShine=Game.displayStore.getSprite("title-scene/background-shine"),this.frontWall=Game.displayStore.getSprite("title-scene/front-wall"),this.backWall=Game.displayStore.getSprite("title-scene/back-wall"),this.road=Game.displayStore.getSprite("title-scene/road"),this.playButton=Game.displayStore.getSprite("title-scene/play-button"),this.ticker1=0,this.ticker2=0,this.cars=new Array,this.coins=new Array,this.bombs=new Array,this.characters=new Array,this.cars.push({carContainer:Game.displayStore.getContainer("title-scene/car-container"),body:Game.displayStore.getSprite("title-scene/car-3"),wheelBack:Game.displayStore.getSprite("title-scene/wheel-3"),wheelFront:Game.displayStore.getSprite("title-scene/wheel-3"),yOffset:175,backWheelOffset:80,frontWheelOffset:140,lane:0,delay:0}),this.cars.push({carContainer:Game.displayStore.getContainer("title-scene/car-container"),body:Game.displayStore.getSprite("title-scene/car-2"),wheelBack:Game.displayStore.getSprite("title-scene/wheel-2"),wheelFront:Game.displayStore.getSprite("title-scene/wheel-2"),yOffset:120,backWheelOffset:90,frontWheelOffset:240,lane:2,delay:0}),this.cars.push({carContainer:Game.displayStore.getContainer("title-scene/car-container"),body:Game.displayStore.getSprite("title-scene/car-1"),wheelBack:Game.displayStore.getSprite("title-scene/wheel-1"),wheelFront:Game.displayStore.getSprite("title-scene/wheel-1"),yOffset:120,backWheelOffset:105,frontWheelOffset:260,lane:5,delay:0});for(d=0;d<this.cars.length;d++){var i=this.cars[d];i.carContainer.addChild(i.body),i.carContainer.addChild(i.wheelBack),i.carContainer.addChild(i.wheelFront),i.carContainer.setRegPoint(.5,1,!0),i.wheelBack.position.y=i.yOffset,i.wheelFront.position.y=i.yOffset,i.carContainer.scale.x=i.carContainer.scale.y=.4+.2*i.lane,i.carContainer.position.x=Game.getRandom(-300,Game.stageWidth),i.wheelBack.position.x=i.backWheelOffset,i.wheelFront.position.x=i.frontWheelOffset}this.cars[0].carContainer.position.y=Game.stageHeight-225,this.cars[1].carContainer.position.y=Game.stageHeight-175,this.cars[2].carContainer.position.y=Game.stageHeight-70,this.scoobyContainer=this.backgroundContainer.getContainer("title-scene/scooby-container"),this.shaggyContainer=this.backgroundContainer.getContainer("title-scene/shaggy-container"),this.bugsContainer=this.backgroundContainer.getContainer("title-scene/bugs-container"),this.silvestreContainer=this.backgroundContainer.getContainer("title-scene/silvestre-container"),this.roadRunnerContainer=this.backgroundContainer.getContainer("title-scene/road-runner-container"),this.wileContainer=this.backgroundContainer.getContainer("title-scene/wile-container"),this.tomJerryContainer=this.backgroundContainer.getContainer("title-scene/tom-and-jerry-container"),this.duckContainer=this.backgroundContainer.getContainer("title-scene/duck-container"),this.tomContainer=this.tomJerryContainer.getContainer("title-scene/tom-container"),this.jerryContainer=this.tomJerryContainer.getContainer("title-scene/jerry-container"),this.scoobyBlink=this.scoobyContainer.getSprite("title-scene/scooby-blink"),this.shaggyBlink=this.shaggyContainer.getSprite("title-scene/shaggy-blink"),this.bugsBlink=this.bugsContainer.getSprite("title-scene/bugs-blink"),this.tweetyBlink=this.tweetyHeadContainer.getSprite("title-scene/tweety-head-blink"),this.silvestreBlink=this.silvestreContainer.getSprite("title-scene/silvestre-blink"),this.wileBlink=this.wileContainer.getSprite("title-scene/wile-blink"),this.duckBlink=this.duckContainer.getSprite("title-scene/duck-blink"),this.tomBlink=this.tomContainer.getSprite("title-scene/tom-blink"),this.jerryBlink=this.jerryContainer.getSprite("title-scene/jerry-blink"),this.roadrunnerBlink=this.roadRunnerContainer.getSprite("title-scene/road-runner-blink"),this.logoPaper1=this.logoContainer.getSprite("title-scene/paper-background-1"),this.logoPaper2=this.logoContainer.getSprite("title-scene/paper-background-2"),this.logoPaintBackground=this.logoContainer.getSprite("title-scene/paint-background"),this.logoScissors=this.logoContainer.getSprite("title-scene/scissors"),this.logoPaperText=this.logoContainer.getSprite("title-scene/paper-text"),this.logoSmoke=this.logoContainer.getSprite("title-scene/wheel-smoke"),this.logoWheel=this.logoContainer.getSprite("title-scene/wheel"),this.logoSpanner=this.logoContainer.getSprite("title-scene/spanner"),this.logoRacersContainer=this.logoContainer.getContainer("title-scene/logo-racers-container"),this.logoRacersR=this.logoRacersContainer.getSprite("title-scene/racers-r"),this.logoRacersA=this.logoRacersContainer.getSprite("title-scene/racers-a"),this.logoRacersC=this.logoRacersContainer.getSprite("title-scene/racers-c"),this.logoRacersE=this.logoRacersContainer.getSprite("title-scene/racers-e"),this.logoRacersR2=this.logoRacersContainer.getSprite("title-scene/racers-r"),this.logoRacersS=this.logoRacersContainer.getSprite("title-scene/racers-s"),this.characters.push({container:this.tomJerryContainer}),this.characters.push({container:this.scoobyContainer}),this.characters.push({container:this.roadRunnerContainer}),this.characters.push({container:this.shaggyContainer}),this.characters.push({container:this.wileContainer}),this.characters.push({container:this.bugsContainer}),this.characters.push({container:this.duckContainer}),this.characters.push({container:this.silvestreContainer}),this.logoPaper1.position.y=-35,this.logoPaper1.position.x=-50,this.logoPaper1.rotation=-.3,this.logoPaper2.position.y=-80,this.logoPaper2.position.x=50,this.logoScissors.position.y=-120,this.logoPaintBackground.position.y=-50,this.logoSmoke.position.y=60,this.logoWheel.position.x=210,this.logoWheel.position.y=45,this.logoRacersContainer.position.y=75,this.logoRacersContainer.position.x=10,this.logoRacersContainer.scale.set(1.5,1.5),this.logoRacersContainer.setRegPoint(.6,.5,!0),this.logoPaperText.position.y=-50,this.logoPaperText.position.x=10,this.logoSpanner.position.x=283,this.logoSpanner.position.y=112,this.logoRacersR.position.x=0,this.logoRacersA.position.x=45,this.logoRacersC.position.x=90,this.logoRacersE.position.x=120,this.logoRacersR2.position.x=155,this.logoRacersS.position.x=200,Game.assetChunkManager.flushAssets("games"),this.mainContainer.setRegPointPixels(Game.stageWidth/2,Game.stageHeight/2-50,!0),this.mainContainer.scale.x=this.mainContainer.scale.y=2.5,this.mainContainer.position.x=Game.stageWidth/2,this.mainContainer.position.y=Game.stageHeight/2,this.foregroundContainer.setRegPointPixels(Game.stageWidth/2,Game.stageHeight/2,!0),this.foregroundContainer.scale.x=this.foregroundContainer.scale.y=3,this.foregroundContainer.position.x=Game.stageWidth/2,this.foregroundContainer.position.y=Game.stageHeight/2,this.backgroundContainer.setRegPointPixels(Game.stageWidth/2,Game.stageHeight/2,!0),this.backgroundContainer.scale.x=this.backgroundContainer.scale.y=1.3,this.backgroundContainer.position.x=Game.stageWidth/2,this.backgroundContainer.position.y=Game.stageHeight/2,this.backgroundCactus1=Game.displayStore.getSprite("title-scene/cactus-1"),this.backgroundCactus2=Game.displayStore.getSprite("title-scene/cactus-1"),this.backgroundCactus3=Game.displayStore.getSprite("title-scene/cactus-2"),this.backgroundCactus4=Game.displayStore.getSprite("title-scene/cactus-2"),this.backgroundbush1=Game.displayStore.getSprite("title-scene/bush-1"),this.backgroundbush2=Game.displayStore.getSprite("title-scene/bush-2"),this.backgroundbush3=Game.displayStore.getSprite("title-scene/bush-3"),this.backgroundbush4=Game.displayStore.getSprite("title-scene/bush-4"),this.backgroundbush5=Game.displayStore.getSprite("title-scene/bush-2"),this.backgroundbush6=Game.displayStore.getSprite("title-scene/bush-1"),this.backgroundContainer.addChild(this.backgroundCactus1),this.backgroundContainer.addChild(this.backgroundCactus2),this.backgroundContainer.addChild(this.backgroundCactus3),this.backgroundContainer.addChild(this.backgroundCactus4),this.backgroundContainer.addChild(this.backgroundbush1),this.backgroundContainer.addChild(this.backgroundbush2),this.backgroundContainer.addChild(this.backgroundbush3),this.backgroundContainer.addChild(this.backgroundbush4),this.backgroundContainer.addChild(this.backgroundbush5),this.backgroundContainer.addChild(this.backgroundbush6),this.backgroundCactus1.position.y=Game.stageHeight-230,this.backgroundCactus2.position.y=Game.stageHeight-230,this.backgroundCactus3.position.y=Game.stageHeight-230,this.backgroundCactus4.position.y=Game.stageHeight-230,this.backgroundCactus1.position.x=Game.stageWidth-100,this.backgroundCactus2.position.x=140,this.backgroundCactus3.position.x=350,this.backgroundCactus4.position.x=800,this.backgroundCactus1.scale.set(.3,.3),this.backgroundCactus2.scale.set(.3,.3),this.backgroundCactus3.scale.set(.3,.3),this.backgroundCactus4.scale.set(.3,.3),this.backgroundbush1.position.y=Game.stageHeight-235,this.backgroundbush2.position.y=Game.stageHeight-235,this.backgroundbush3.position.y=Game.stageHeight-235,this.backgroundbush4.position.y=Game.stageHeight-235,this.backgroundbush5.position.y=Game.stageHeight-235,this.backgroundbush6.position.y=Game.stageHeight-235,this.backgroundbush1.position.x=100,this.backgroundbush2.position.x=300,this.backgroundbush3.position.x=400,this.backgroundbush4.position.x=600,this.backgroundbush5.position.x=700,this.backgroundbush6.position.x=900,this.backgroundbush1.scale.set(.5,.5),this.backgroundbush2.scale.set(.5,.5),this.backgroundbush3.scale.set(.5,.5),this.backgroundbush4.scale.set(.5,.5),this.backgroundbush5.scale.set(.5,.5),this.backgroundbush6.scale.set(.5,.5),this.scoobyContainer.position.x=60,this.scoobyContainer.position.y=Game.stageHeight-80,this.shaggyContainer.position.x=70,this.shaggyContainer.position.y=Game.stageHeight-170,this.bugsContainer.position.x=150,this.bugsContainer.position.y=Game.stageHeight-90,this.silvestreContainer.position.x=270,this.silvestreContainer.position.y=Game.stageHeight-60,this.wileContainer.position.x=Game.stageWidth-270,this.wileContainer.position.y=Game.stageHeight-60,this.duckContainer.position.x=Game.stageWidth-180,this.duckContainer.position.y=Game.stageHeight-120,this.roadRunnerContainer.position.x=Game.stageWidth-80,this.roadRunnerContainer.position.y=Game.stageHeight-100,this.tomJerryContainer.position.x=Game.stageWidth-60,this.tomJerryContainer.position.y=Game.stageHeight-130,this.jerryContainer.position.y=-228,this.jerryContainer.position.x=-70,this.frontCactusLeft1=Game.displayStore.getSprite("title-scene/cactus-1"),this.frontCactusLeft2=Game.displayStore.getSprite("title-scene/cactus-2"),this.frontCactusRight1=Game.displayStore.getSprite("title-scene/cactus-1"),this.frontCactusRight2=Game.displayStore.getSprite("title-scene/cactus-1"),this.frontBush1=Game.displayStore.getSprite("title-scene/bush-1"),this.frontBush2=Game.displayStore.getSprite("title-scene/bush-2"),this.frontBush3=Game.displayStore.getSprite("title-scene/bush-3"),this.frontBush4=Game.displayStore.getSprite("title-scene/bush-4"),this.frontBush5=Game.displayStore.getSprite("title-scene/bush-1"),this.frontBush6=Game.displayStore.getSprite("title-scene/bush-2"),this.frontCactusRight1.position.x=Game.stageWidth-20,this.frontCactusRight1.scale.x=this.frontCactusRight1.scale.y=1.3,this.frontCactusRight1.rotation=.05,this.frontCactusRight1.position.y=Game.stageHeight+10,this.frontCactusRight2.position.x=Game.stageWidth-110,this.frontCactusRight2.rotation=-.15,this.frontCactusRight2.position.y=Game.stageHeight+10,this.frontBush5.position.x=Game.stageWidth-400,this.frontBush5.position.y=Game.stageHeight+10,this.frontBush6.position.x=Game.stageWidth-200,this.frontBush6.position.y=Game.stageHeight+15,this.frontBush4.position.x=Game.stageWidth-60,this.frontBush4.position.y=Game.stageHeight+10,this.frontBush3.position.x=230,this.frontBush3.position.y=Game.stageHeight+10,this.frontBush2.position.x=360,this.frontBush2.position.y=Game.stageHeight+20,this.frontBush1.position.x=60,this.frontBush1.position.y=Game.stageHeight+10,this.frontCactusLeft1.position.x=20,this.frontCactusLeft1.scale.x=this.frontCactusLeft1.scale.y=1.2,this.frontCactusLeft1.rotation=-.05,this.frontCactusLeft1.position.y=Game.stageHeight,this.frontCactusLeft2.position.x=120,this.frontCactusLeft2.rotation=.15,this.frontCactusLeft2.position.y=Game.stageHeight+30,this.foregroundContainer.addChild(this.frontCactusLeft1),this.foregroundContainer.addChild(this.frontCactusLeft2),this.foregroundContainer.addChild(this.frontCactusRight2),this.foregroundContainer.addChild(this.frontCactusRight1),this.foregroundContainer.addChild(this.frontBush1),this.foregroundContainer.addChild(this.frontBush2),this.foregroundContainer.addChild(this.frontBush3),this.foregroundContainer.addChild(this.frontBush4),this.foregroundContainer.addChild(this.frontBush5),this.foregroundContainer.addChild(this.frontBush6),this.logoContainer.setRegPoint(.4,.5,!0),this.logoContainer.position.x=Game.stageWidth/2,this.logoContainer.position.y=Game.stageHeight/2+30,this.logoContainer.scale.set(1.5,1.5),this.clickArea=Game.displayStore.getSprite("title-scene/blank-input");var n=new PIXI.Text("Title scene..",{fontFamily:"Arial",fontSize:24,fill:16777215,align:"left"});n.position.x=20,n.position.y=20,this.clickArea.width=Game.stageWidth,this.clickArea.height=Game.stageHeight,this.backgroundShine.position.x=Game.stageWidth/2,this.backgroundShine.position.y=Game.stageHeight/2,this.backgroundShine.scale.x=this.backgroundShine.scale.y=2.5,this.backgroundShine.blendMode=PIXI.BLEND_MODES.ADD,this.backgroundShine.alpha=.5,this.road.position.x=Game.stageWidth/2,this.road.position.y=Game.stageHeight+20,this.frontWall.position.x=Game.stageWidth/2,this.frontWall.position.y=Game.stageHeight+10,this.backWall.position.x=Game.stageWidth/2,this.backWall.position.y=this.road.position.y-this.road.height+5,this.playButton.position.x=Game.stageWidth/2,this.playButton.position.y=480,this.tweetyContainer.position.x=260,this.tweetyContainer.position.y=125,this.tweetyContainer.rotation=-.2,this.tweetyHeadContainer.rotation=-.3,this.tweetyHeadContainer.position.x=100,this.tweetyHeadContainer.position.y=60;for(d=0;d<this.cars.length;d++);this.mainContainer.addChild(this.backgroundContainer),this.mainContainer.addChild(this.logoContainer),this.mainContainer.addChild(this.tweetyContainer),this.mainContainer.addChild(this.backWall),this.mainContainer.addChild(this.road),this.mainContainer.addChild(this.cars[0].carContainer);for(d=0;d<3;d++)this.bombs.push({bombContainer:Game.displayStore.getContainer("title-scene/bomb-container"),bomb:Game.displayStore.getAnimatedSprite("title-scene/bomb-frames"),shadow:Game.displayStore.getSprite("title-scene/shadow")}),(u=this.bombs[d]).bombContainer.addChild(u.shadow),u.bombContainer.addChild(u.bomb),u.bomb.position.y=-30,u.bomb.animationSpeed=.2,u.bomb.loop=!0,u.bomb.play();for(d=0;d<3;d++)this.coins.push({coinContainer:Game.displayStore.getContainer("title-scene/coin-container"),coin:Game.displayStore.getSprite("title-scene/coin"),shine:Game.displayStore.getSprite("title-scene/shine"),shadow:Game.displayStore.getSprite("title-scene/shadow")}),(p=this.coins[d]).shine.blendMode=PIXI.BLEND_MODES.ADD,p.shine.position.x=-30,p.shine.position.y=-30,p.coinContainer.addChild(p.shadow),p.coinContainer.addChild(p.coin),p.coinContainer.addChild(p.shine),p.coin.position.y=-60;this.mainContainer.addChild(this.ramp),this.mainContainer.addChild(this.coins[1].coinContainer),this.mainContainer.addChild(this.coins[2].coinContainer),this.mainContainer.addChild(this.bombs[1].bombContainer),this.mainContainer.addChild(this.cars[1].carContainer),this.mainContainer.addChild(this.coins[0].coinContainer),this.mainContainer.addChild(this.bombs[0].bombContainer),this.mainContainer.addChild(this.cars[2].carContainer),this.coins[0].coinContainer.position.y=445,this.coins[0].coinContainer.scale.set(.8,.8),this.coins[0].coinContainer.position.x=Game.stageWidth/2+130,this.coins[1].coinContainer.position.y=375,this.coins[1].coinContainer.scale.set(.4,.4),this.coins[1].coinContainer.position.x=Game.stageWidth/2+320,this.coins[2].coinContainer.position.y=375,this.coins[2].coinContainer.scale.set(.4,.4),this.coins[2].coinContainer.position.x=Game.stageWidth/2-300,this.ramp.position.y=384,this.ramp.scale.set(1.2,1.2),this.ramp.position.x=Game.stageWidth/2-210,this.bombs[0].bombContainer.position.y=445,this.bombs[0].bombContainer.position.x=Game.stageWidth/2-130,this.bombs[1].bombContainer.position.y=375,this.bombs[1].bombContainer.scale.set(.5,.5),this.bombs[1].bombContainer.position.x=Game.stageWidth/2+250,this.logo.position.x=50,this.logo.position.y=Game.stageHeight-20,this.mainContainer.addChild(this.frontWall),this.mainContainer.addChild(this.foregroundContainer),this.container.addChild(this.background),this.container.addChild(this.backgroundShine),this.container.addChild(this.mainContainer),this.container.addChild(this.playButton),this.container.addChild(this.logo),this.container.addChild(this.clickArea),this.setUpHitArea(),this.animation=new TimelineMax,this.loopingAnimation=new TimelineMax,this.animationTimeScaleControl=new TimelineMax;var o=new TimelineMax,r=new TimelineMax,a=new TimelineMax,s=new TimelineMax,l=new TimelineMax,c=new TimelineMax,h=new TimelineMax;this.animation.add(o),this.animation.add(r),this.animation.add(a),this.animation.add(l),this.animation.add(c),this.animation.add(h),this.animation.add(s),s.add([TweenMax.from(this.logoSpanner,1,{rotation:1.5,ease:Elastic.easeOut}),TweenMax.from(this.logo.scale,1,{x:0,y:0,ease:Elastic.easeOut})],.4);for(d=0;d<this.coins.length;d++){var p=this.coins[d];l.add([TweenMax.to(p.coin.position,2,{y:"-=25",ease:Power1.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(p.shadow.scale,2,{x:.7,ease:Power1.easeInOut,yoyo:!0,repeat:-1})],0)}for(d=0;d<this.coins.length;d++){var u=this.bombs[d];c.add([TweenMax.to(u.bomb.position,1,{y:"-=30",ease:Power1.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(u.shadow.scale,1,{x:.7,ease:Power1.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(u.bomb,1,{rotation:-.2,ease:Power1.easeInOut,yoyo:!0,repeat:-1})],0)}this.animation.add([TweenMax.to(this.mainContainer.scale,.77,{x:1,y:1,ease:Power4.easeOut}),TweenMax.to(this.backgroundContainer.scale,.77,{x:1,y:1,ease:Power4.easeOut}),TweenMax.to(this.foregroundContainer.scale,.77,{x:1,y:1,ease:Power4.easeOut}),TweenMax.to(this.logoContainer.scale,1.54,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.logoRacersContainer.scale,1.54,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.mainContainer.position,.77,{x:512,y:250,ease:Power4.easeOut})],.2),a.add([TweenMax.to(this.jerryContainer.scale,1.5,{y:.9,ease:Power3.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.tomJerryContainer.scale,2,{y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.wileContainer.scale,2.5,{delay:.1,y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.roadRunnerContainer.scale,2,{delay:.2,y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.scoobyContainer.scale,3,{delay:.5,y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.shaggyContainer.scale,2,{delay:.2,y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.bugsContainer.scale,1.5,{delay:.5,y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.duckContainer.scale,1,{delay:.8,y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.silvestreContainer.scale,2,{delay:.4,y:.98,ease:Power2.easeInOut,yoyo:!0,repeat:-1})]),o.add([TweenMax.to(this.tweetyHeadContainer,.7,{rotation:-.2,ease:Power1.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.tweetyContainer.position,.8,{y:"+=20",ease:Power1.easeInOut,yoyo:!0,repeat:-1}),TweenMax.to(this.tweetyContainer,1,{rotation:.1,ease:Power1.easeInOut,yoyo:!0,repeat:-1})]);for(var d=0;d<this.characters.length;d++)h.add([TweenMax.from(this.characters[d].container,1,{y:"+=120",ease:Elastic.easeInOut,delay:.02*d})],.1);r.add([TweenMax.from(this.frontCactusLeft1,1.2,{rotation:-.5,ease:Elastic.easeOut}),TweenMax.from(this.frontCactusLeft2,1.4,{rotation:-.6,ease:Elastic.easeOut}),TweenMax.from(this.frontCactusRight1,1.2,{rotation:.7,ease:Elastic.easeOut}),TweenMax.from(this.frontCactusRight2,1.3,{rotation:.8,ease:Elastic.easeOut}),TweenMax.from(this.backgroundCactus1,1.3,{rotation:-.8,ease:Elastic.easeOut}),TweenMax.from(this.backgroundCactus2,1.5,{rotation:-.8,ease:Elastic.easeOut}),TweenMax.from(this.backgroundCactus3,1.2,{rotation:.8,ease:Elastic.easeOut}),TweenMax.from(this.backgroundCactus4,2,{rotation:.8,ease:Elastic.easeOut}),TweenMax.from(this.frontBush1,.9,{rotation:.3,ease:Elastic.easeOut}),TweenMax.from(this.frontBush2,1.5,{rotation:-.3,ease:Elastic.easeOut}),TweenMax.from(this.frontBush3,.8,{rotation:.3,ease:Elastic.easeOut}),TweenMax.from(this.frontBush4,1,{rotation:.3,ease:Elastic.easeOut}),TweenMax.from(this.frontBush5,.8,{rotation:-.5,ease:Elastic.easeOut}),TweenMax.from(this.frontBush6,1.2,{rotation:.4,ease:Elastic.easeOut}),TweenMax.from(this.frontBush1.scale,.9,{y:.3,ease:Elastic.easeOut}),TweenMax.from(this.frontBush2.scale,1.5,{y:.2,ease:Elastic.easeOut}),TweenMax.from(this.frontBush3.scale,.8,{y:.3,ease:Elastic.easeOut}),TweenMax.from(this.frontBush4.scale,1,{y:.3,ease:Elastic.easeOut}),TweenMax.from(this.frontBush5.scale,.8,{y:.5,ease:Elastic.easeOut}),TweenMax.from(this.frontBush6.scale,1.2,{y:.4,ease:Elastic.easeOut})],.4),this.animation.add([TweenMax.from(this.playButton.position,1,{y:Game.stageHeight,ease:Elastic.easeOut}),TweenMax.from(this.playButton.scale,1,{y:0,x:0,ease:Elastic.easeOut})],1.2),this.animation.timeScale(.9),this.animationTimeScaleControl.add([TweenMax.to(this.backgroundShine,50,{rotation:2*Math.PI,ease:Power0.easeInOut,repeat:-1})],0)},e.prototype.setUpHitArea=function(){this.clickArea.interactive=!0,this.clickArea.buttonMode=!0;var t=this;Game.onDesktop?this.clickArea.on("mouseup",function(e){t.nextScene(t)}):this.clickArea.on("touchend",function(e){t.nextScene(t)})},e.prototype.nextScene=function(t){t.game.trackingEventsManager.trackGameEvent("play","true"),Game.playSound("button-click-ui.mp3"),Game.coreData.getPlayerGarageData().length>0&&"empty"!=Game.coreData.getPlayerGarageData()[0].id?t.game.setScene("startScene",!0):t.game.setScene("selectTeamScene",!0)},e.prototype.activatePlayButton=function(t){},e.prototype.uiClicked=function(e){t.prototype.uiClicked.call(this,e)},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this);for(i=0;i<this.cars.length;i++){var e=this.cars[i];e.delay<0?(e.carContainer.position.x+=10+1*e.lane,e.wheelBack.rotation+=.1+.02*e.lane,e.wheelFront.rotation+=.1+.02*e.lane):e.delay--,e.carContainer.position.x>Game.stageWidth+300&&(e.carContainer.position.x=-200,e.delay=Game.getRandom(100,500))}this.ticker1%3==0&&(this.tweetybody1.visible=!0,this.tweetybody2.visible=!1,this.tweetybody3.visible=!1),this.ticker1%7==0&&(this.tweetybody1.visible=!1,this.tweetybody2.visible=!0,this.tweetybody3.visible=!1),this.ticker1%11==0&&(this.tweetybody1.visible=!1,this.tweetybody2.visible=!1,this.tweetybody3.visible=!0),this.blinking();for(var i=0;i<this.coins.length;i++){var n=this.coins[i];n.shine.position.x=n.coin.position.x-30,n.shine.position.y=n.coin.position.y-30,n.shine.rotation+=.03}},e.prototype.blinking=function(){if(this.ticker1++,this.ticker2++,this.ticker1%8==0&&(this.wileBlink.visible=!1,this.duckBlink.visible=!1,this.tomBlink.visible=!1,this.jerryBlink.visible=!1,this.roadrunnerBlink.visible=!1,Game.getRandom(0,1)>.8))switch(Game.getRandom(6,10,!0)){case 6:this.wileBlink.visible=!0;break;case 7:this.duckBlink.visible=!0;break;case 8:this.tomBlink.visible=!0;break;case 9:this.jerryBlink.visible=!0;break;case 10:this.roadrunnerBlink.visible=!0}if(this.ticker2%8==0&&(this.scoobyBlink.visible=!1,this.shaggyBlink.visible=!1,this.bugsBlink.visible=!1,this.tweetyBlink.visible=!1,this.silvestreBlink.visible=!1,Game.getRandom(0,1)>.8))switch(Game.getRandom(1,5,!0)){case 1:this.scoobyBlink.visible=!0;break;case 2:this.shaggyBlink.visible=!0;break;case 3:this.bugsBlink.visible=!0;break;case 4:this.tweetyBlink.visible=!0;break;case 5:this.silvestreBlink.visible=!0}},e.prototype.keyDown=function(t){},e.prototype.keyUp=function(t){},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.clickArea.removeAllListeners(),this.animation=this.killTween(this.animation),this.loopingAnimation=this.killTween(this.loopingAnimation),this.animationTimeScaleControl=this.killTween(this.animationTimeScaleControl)},e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),StartScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="startScene",n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.game.ui.setUI("none"),Game.coreData.editMode=!1,Game.assetChunkManager.flushAssets("race"),Game.assetChunkManager.flushAssets("track"),Game.assetChunkManager.flushAssets("powerup"),this.bgContainer=Game.displayStore.getContainer("start-scene/bg-container"),this.bgRight=this.bgContainer.getSprite("start-scene/bg-right"),this.stripe=Game.displayStore.getSprite("start-scene/stripe"),this.stripe.width=1.5*Game.stageWidth,this.stripe.rotation=5.55,this.stripe.position.x=180,this.stripe.position.y=Game.stageHeight,this.circle=Game.displayStore.getSprite("start-scene/circle"),this.circle.position.set(Game.stageWidth/2,Game.stageHeight/2),this.stripeContainer=Game.displayStore.getContainer("start-scene/stripe-container"),this.orText=Game.displayStore.getBitmapText("start-scene/or-text","start-scene-or-text"),this.orText.tint=16771584,this.orText.position.set(Game.stageWidth/2-2,Game.stageHeight/2-13),this.orText.position.x-=this.orText.width/2,this.orText.position.y-=this.orText.height/2,this.orText.alpha=1,this.stripeContainer.addChild(this.stripe),this.stripeContainer.addChild(this.circle),this.stripeContainer.addChild(this.orText),this.bgMask=new PIXI.Graphics,this.bgMask.beginFill(0,1),this.bgMask.lineStyle(0,0,1),this.bgMask.moveTo(Game.stageWidth-180,0),this.bgMask.lineTo(2*Game.stageWidth,0),this.bgMask.lineTo(2*Game.stageWidth,Game.stageHeight),this.bgMask.lineTo(180,Game.stageHeight),this.bgMask.lineTo(Game.stageWidth-180,0),this.bgMask.endFill(),this.bgRight.mask=this.bgMask,this.newGameContainer=Game.displayStore.getContainer("start-scene/new-game-container"),this.newGameContainer.position.set(360,-100),this.newText=Game.displayStore.getBitmapText("start-scene/new-game-text","start-scene-new-game"),this.newText.position.set(-260,-40),this.newGameContainer.addChild(this.newText);var i=this.newGameContainer.getSpriteAt(0);i.tint=0,i.alpha=.3;var n=Game.displayStore.getSprite("start-scene/coin"),o=Game.displayStore.getSprite("start-scene/coin");n.position.x=o.x=203,n.position.y=o.y=-40,o.position.y+=3,o.tint=0,o.alpha=.3,this.newGameContainer.addChild(o),this.newGameContainer.addChild(n);var r=Game.displayStore.getBitmapText("start-scene/new-game-coin-text-shadow","");r.text="0",r.tint=0,r.alpha=.3,r.position.x=236,r.position.y=-74,r.scale.set(.8,.8),this.newGameContainer.addChild(r);var a=Game.displayStore.getBitmapText("start-scene/new-game-coin-text","");a.text="0",a.position.x=236,a.position.y=-77,a.scale.set(.8,.8),this.newGameContainer.addChild(a),this.continueContainer=Game.displayStore.getContainer("start-scene/continue-container"),this.continueContainer.position.set(660,700),this.continueText=Game.displayStore.getBitmapText("start-scene/continue-game-text","start-scene-continue-game"),this.continueText.position.set(-260,-40),this.continueContainer.addChild(this.continueText);var s=this.continueContainer.getSpriteAt(0);s.tint=0,s.alpha=.3;var l=Game.displayStore.getSprite("start-scene/coin"),c=Game.displayStore.getSprite("start-scene/coin");l.position.x=c.x=193,l.position.y=c.y=-40,c.position.y+=3,c.tint=0,c.alpha=.3,this.continueContainer.addChild(c),this.continueContainer.addChild(l);var h=Game.displayStore.getBitmapText("start-scene/continue-coin-text-shadow","");h.text=String(Game.coreData.getCurrentCoins()),h.tint=0,h.alpha=.3,h.position.x=262-h.width,h.position.y=-74,h.scale.set(.8,.8),this.continueContainer.addChild(h);var p=Game.displayStore.getBitmapText("start-scene/continue-coin-text","");if(p.text=String(Game.coreData.getCurrentCoins()),p.position.x=h.position.x,p.position.y=-77,p.scale.set(.8,.8),this.continueContainer.addChild(p),l.position.x=c.position.x=p.position.x-33,this.playerCar=Game.coreData.getPlayerCarData().carGarageSprite,this.playerCar){this.playerCar.scale.set(.3,.3),this.continueContainer.addChildAt(this.playerCar,2);var u=Game.displayStore.getRenderTexture("start-screen-car-render-texture",this.playerCar.width/1,this.playerCar.height/1,"start-assets",!1),d=u.renderTexture;this.renderTextureSprite=u.outputSprite;var f=new PIXI.Matrix;f.scale(1,1),Game.renderer.render(this.playerCar,d,!0,f),this.renderTextureSprite.alpha=.3,this.renderTextureSprite.tint=0,this.renderTextureSprite.scale.set(1),this.continueContainer.addChildAt(this.renderTextureSprite,2),this.playerCar.position.x=40,this.playerCar.position.y=-3,this.renderTextureSprite.position.x=this.playerCar.position.x,this.renderTextureSprite.position.y=this.playerCar.position.y+3,this.renderTextureSprite.setRegPoint(.5,.5),this.playerCar.setRegPoint(.5,.5)}this.container.addChild(this.bgContainer),this.container.addChild(this.bgMask),this.container.addChild(this.stripeContainer),this.container.addChild(this.newGameContainer),this.container.addChild(this.continueContainer),this.bgContainer.setRegPointPixels(Game.stageWidth/2,Game.stageHeight/2,!0),this.animation=this.killTween(this.animation),this.animation=new TimelineMax;var m=new TimelineMax;m.add(TweenMax.to(this.newGameContainer.position,.2,{ease:Power2.easeIn,y:110})),m.add(TweenMax.to(this.newGameContainer.position,.5,{ease:Elastic.easeOut,y:150}));var g=new TimelineMax;g.add(TweenMax.to(this.continueContainer.position,.2,{ease:Power2.easeIn,y:490})),g.add(TweenMax.to(this.continueContainer.position,.5,{ease:Elastic.easeOut,y:450})),this.animation.add(TweenMax.from(this.bgMask.position,1.3,{ease:Expo.easeInOut,x:Game.stageWidth})),this.animation.add(TweenMax.from(this.stripe.scale,.5,{ease:Expo.easeInOut,y:0}),.8),this.animation.add(TweenMax.from(this.bgContainer.scale,1,{ease:Power3.easeInOut,x:1.2,y:1.2}),.3),this.animation.add(TweenMax.from(this.circle.scale,.5,{ease:Elastic.easeOut,x:0,y:0}),1.4),this.animation.add(TweenMax.from(this.orText,.2,{ease:Expo.easeOut,alpha:0}),1.4),this.animation.add(m,1),this.animation.add(g,1.7),this.animation.call(Game.playSound,["swipe-1.mp3",.4],this,1),this.animation.call(Game.playSound,["small-pop.mp3",.7],this,1.4),this.animation.call(Game.playSound,["swipe-3.mp3",.4],this,1.7),this.animation.call(function(){},null,this),this.addInteraction(this.continueContainer),this.addInteraction(this.newGameContainer);var y=new AchievementsTallyPanel(this);this.container.addChild(y.container),this.animation.call(y.show,null,y,2)},e.prototype.addInteraction=function(t){var e=this,i=t;i.interactive=!0,Game.onDesktop?(i.on("mousedown",function(t){e.touchStart(e,t)}),i.on("mouseup",function(t){e.touchEnd(e,t)}),i.on("mouseupoutside",function(t){e.touchEndOutside(e,t)})):(i.on("touchstart",function(t){e.touchStart(e,t)}),i.on("touchend",function(t){e.touchEnd(e,t)}),i.on("touchendoutside",function(t){e.touchEndOutside(e,t)}))},e.prototype.removeInteraction=function(){this.newGameContainer.removeAllListeners(),this.continueContainer.removeAllListeners()},e.prototype.touchStart=function(t,e){var i=e.currentTarget.getSprite("start-scene/shadow");this.animation=this.killTween(this.animation),this.animation=new TimelineMax,this.animation.add([TweenMax.to(e.currentTarget.scale,.2,{ease:Expo.easeOut,x:1.13,y:1.13}),TweenMax.to(i.scale,.2,{ease:Expo.easeOut,x:.95,y:.95}),TweenMax.to(i,.2,{ease:Expo.easeOut,alpha:.2})])},e.prototype.touchEnd=function(t,e){this.removeInteraction();var i=e.currentTarget.getSprite("start-scene/shadow");this.animation=this.killTween(this.animation),this.animation=new TimelineMax,this.animation.add(TweenMax.to(e.currentTarget.scale,.5,{ease:Elastic.easeOut,x:1,y:1})),e.currentTarget==this.newGameContainer?(this.animation.add(TweenMax.to(this.bgMask.position,1.3,{ease:Expo.easeInOut,x:Game.stageWidth})),this.animation.add([TweenMax.to(this.newGameContainer.position,1,{ease:Power3.easeInOut,x:Game.stageWidth/2,y:Game.stageHeight/2}),TweenMax.to(this.newGameContainer.scale,1,{ease:Power3.easeInOut,x:1.2,y:1.2}),TweenMax.to(this.continueContainer.position,.5,{ease:Expo.easeInOut,y:800})],.5),this.bgContainer.setRegPointPixels(0,0,!0)):(this.animation.add(TweenMax.to(this.bgMask.position,1.3,{ease:Expo.easeInOut,x:-Game.stageWidth})),this.animation.add([TweenMax.to(this.continueContainer.position,1,{ease:Power3.easeInOut,x:Game.stageWidth/2,y:Game.stageHeight/2}),TweenMax.to(this.continueContainer.scale,1,{ease:Power3.easeInOut,x:1.2,y:1.2}),TweenMax.to(this.newGameContainer.position,.5,{ease:Expo.easeInOut,y:-100})],.5),this.bgContainer.setRegPointPixels(Game.stageWidth,Game.stageHeight,!0)),this.animation.add(TweenMax.to(this.stripe.scale,.5,{ease:Expo.easeInOut,y:0}),.5),this.animation.add(TweenMax.to(this.bgContainer.scale,1,{ease:Power3.easeInOut,x:1.2,y:1.2}),.5),this.animation.add(TweenMax.to(this.circle.scale,.5,{ease:Expo.easeInOut,x:0,y:0}),.5),this.animation.add(TweenMax.to(this.orText,.5,{ease:Expo.easeInOut,alpha:0}),.5),Game.playSound("select-track.mp3"),Game.playSound("button-click-ui.mp3"),e.currentTarget==this.newGameContainer&&(Game.coreData.clearPlayerData(),this.animation.add(TweenMax.to(this.newGameContainer.scale,.1,{ease:Power2.easeOut,x:1,y:1})),this.animation.add(TweenMax.to(this.newGameContainer.scale,.8,{ease:Elastic.easeOut,x:1.2,y:1.2})),this.animation.call(this.game.setScene,["selectTeamScene",!0],this.game,"-=0.4")),e.currentTarget==this.continueContainer&&(this.animation.add([TweenMax.to(this.continueContainer.scale,.1,{ease:Power2.easeOut,x:1,y:1}),TweenMax.to(i.scale,.1,{ease:Power2.easeOut,x:1,y:1})],"-=0.3"),this.animation.add([TweenMax.to(this.continueContainer.scale,.8,{ease:Elastic.easeOut,x:1.2,y:1.2}),TweenMax.to(i.scale,.8,{ease:Elastic.easeOut,x:1,y:1})],"-=0.3"),this.animation.call(this.game.setScene,["garageScene",!0],this.game,"-=0.4")),this.animation.add([TweenMax.to(i.scale,.5,{ease:Elastic.easeOut,x:1,y:1}),TweenMax.to(i.position,.5,{ease:Elastic.easeOut,y:4}),TweenMax.to(i,.5,{ease:Elastic.easeOut,alpha:.3})],0)},e.prototype.touchEndOutside=function(t,e){var i=e.currentTarget.getSprite("start-scene/shadow");this.animation=this.killTween(this.animation),this.animation=new TimelineMax,this.animation.add([TweenMax.to(e.currentTarget.scale,.5,{ease:Elastic.easeOut,x:1,y:1}),TweenMax.to(i.scale,.5,{ease:Elastic.easeOut,x:1,y:1}),TweenMax.to(i.position,.5,{ease:Elastic.easeOut,y:4}),TweenMax.to(i,.5,{ease:Elastic.easeOut,alpha:.3})])},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){this.playerCar&&(this.playerCar.scale.set(1,1),this.playerCar.position.set(0,0),this.playerCar.setRegPoint(0,0),this.continueContainer.removeChild(this.playerCar),this.continueContainer.removeChild(this.renderTextureSprite)),this.renderTextureSprite=null,Game.displayStore.returnAllPooledItems("start-assets")},e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HelpScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="helpScene",n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.setBackgroundColor(2042428),this.loadedHelpAssets=!1,this.game.ui.setUI("none"),this.loadingCircle=Game.displayStore.getSprite("help-loading-circle"),this.loadingCircle.position.x=Game.stageWidth/2,this.loadingCircle.position.y=Game.stageHeight/2,this.loadingCircle.visible=!0,this.container.addChild(this.loadingCircle)},e.prototype.addTutorialOverlay=function(t){t.tutorialOverlay=new TutorialOverlay(t),t.tutorialOverlay.buildTutorial(t.gameId,!1),t.loadingCircle.visible=!1},e.prototype.uiClicked=function(e){t.prototype.uiClicked.call(this,e),this.tutorialOverlay.uiClicked(e)},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this),1!=this.loadedHelpAssets&&(this.loadingCircle.rotation+=.05)},e.prototype.keyDown=function(t){},e.prototype.keyUp=function(t){},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),RaceScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.cameraOffsetX=240,n.cameraOffsetY=300,n.standardCameraScale=3.4,n.standardCameraZ=-120,n.standardCameraEuler=1.1,n.rampsHit=0,n.rivalTimer=0,n.rivalTimerLimit=300,n.rivalHitActive=!1,n.tomSmashed=!1,n.tweetySmashed=!1,n.tntAttached=!1,n.rocketAttached=!1,n.rivalsSmashed=0,n.raceTimer=0,n.id="raceScene",n}return __extends(e,t),e.prototype.init=function(i){var n=this;t.prototype.init.call(this),this.rampsHit=0,Game.assetChunkManager.flushAssets("craft"),this.game.ui.setUI("race"),this.debugMode=!1,this.endingRace=!1,this.started=!1,this.gameSpeed=1,this.teams=[],this.trackSelected=Game.coreData.getCurrentTrack(),this.difficulty=CoreData.trackData[this.trackSelected].difficulty,this.levelSpeed=500+500*this.difficulty,"living-room"==this.trackSelected?this.setBackgroundColor(9727106):"bathroom"==this.trackSelected?this.setBackgroundColor(11188923):"garage"==this.trackSelected&&this.setBackgroundColor(9872548);for(h=0;h<5;h++)this.teams.push(CoreData.teams[h].id);this.rivals=[],this.vehicles=[],e.SORT_GROUP_BEHIND_TABLE=new PIXI.display.Group(1,!1),e.SORT_GROUP_FLOOR=new PIXI.display.Group(2,!1),e.SORT_GROUP_PROP_BACK=new PIXI.display.Group(3,function(t){n.sortPropZorder(t)}),e.SORT_GROUP_PROP=new PIXI.display.Group(4,function(t){n.sortPropZorder(t)}),e.SORT_GROUP_PROP_FRONT=new PIXI.display.Group(5,function(t){n.sortPropZorder(t)}),e.SORT_GROUP_FRONT=new PIXI.display.Group(6,!1),e.SORT_GROUP_DEBUG=new PIXI.display.Group(7,!1),this.tracker=Game.displayStore.getSprite("global/tracker"),this.tracker.parentGroup=e.SORT_GROUP_DEBUG,this.backgroundHolder=Game.displayStore.getContainer3d("race-scene/background-holder");for(h=0;h<6;h++){var o=h%2+1,r=Game.displayStore.getSprite3d("race-scene/"+this.trackSelected+"/bg-"+o+".png");r.setRegPoint(0,1),r.position3d.x=h*r.width,this.backgroundHolder.addChild(r)}this.backgroundHolder.euler.x=Math.PI/2,this.backgroundHolder.position3d.x=-5e3,this.backgroundHolder.position3d.z=3e3,this.backgroundHolder.position3d.y=-8e3,this.backgroundHolder.scale3d.set(30,30),this.physicsManager=new PhysicsManager(this),this.physicsManager.initPhysicsWorld(),this.physicsDebugLayer=Game.displayStore.getContainer3d("race-scene/physics-debug-layer"),this.physicsDebugLayer.parentGroup=e.SORT_GROUP_DEBUG,this.physicsDebugger=new PhysicsDebugger(this,this.physicsDebugLayer,this.physicsManager.world),this.followPlayer=!1,this.layersHolder=Game.displayStore.getContainer("race-scene/layers-holder"),this.surfaceLayer=Game.displayStore.getContainer3d("race-scene/surface-layer"),this.mainHolder=Game.displayStore.getContainer("race-scene/main-holder"),this.scaleHolder=Game.displayStore.getContainer("race-scene/scale-holder"),this.cameraSettings={scale:this.standardCameraScale,z:this.standardCameraZ,euler:this.standardCameraEuler,eulerZ:0,offsetX:this.cameraOffsetX,offsetY:this.cameraOffsetY,time:0,debug:this.debugMode},this.surfaceLayer.addChild(this.backgroundHolder),this.hud=new Hud(this),this.resultsPanel=new ResultsPanel(this),this.cameraPositionTarget=[],this.camera=new PIXI.projection.Camera3d,this.camera.position.set(Game.stageWidth/2,Game.stageHeight/2),this.camera.addChild(this.surfaceLayer),this.camera.addChild(this.physicsDebugLayer),this.trackManager=new TrackManager(this,this.trackSelected),this.player=new Player(this,{wheelType:Game.coreData.getPlayerCarData().wheelChoice,textureSprite:Game.coreData.getPlayerCarData().carRaceSprite,startingLane:2,id:"player"}),this.interactionManager=new InteractionManager(this),this.vehicles.push(this.player);var a=new Rival(this,{startingLane:1,id:"rival1",skillIndex:Game.getRandom(-.1,.1)+this.difficulty});this.rivals.push(a),this.vehicles.push(a);var s=new Rival(this,{startingLane:4,id:"rival2",skillIndex:Game.getRandom(-.1,.1)+this.difficulty});this.rivals.push(s),this.vehicles.push(s);var l=new Rival(this,{startingLane:0,id:"rival3",skillIndex:Game.getRandom(-.2,.2)+this.difficulty});this.rivals.push(l),this.vehicles.push(l);var c=new Rival(this,{startingLane:3,id:"rival4",skillIndex:Game.getRandom(-.2,.2)+this.difficulty});this.rivals.push(c),this.vehicles.push(c),this.surfaceLayer.addChild(this.trackManager.container),this.surfaceLayer.addChild(this.player.container);for(var h=0;h<this.rivals.length;h++)this.surfaceLayer.addChild(this.rivals[h].container);this.scaleHolder.setRegPointPixels(Game.stageWidth/2,Game.stageHeight/2,!0),this.scaleHolder.scale.set(this.standardCameraScale,this.standardCameraScale),this.scaleHolder.interactiveChildren=!1,this.scaleHolder.interactive=!1,this.layersHolder.interactiveChildren=!1,this.layersHolder.interactive=!1,this.camera.interactive=!1,this.camera.interactiveChildren=!1,this.hud.container.interactive=!1,this.hud.container.interactiveChildren=!1,this.mainHolder.addChild(this.camera),this.scaleHolder.addChild(this.mainHolder),this.container.addChild(this.scaleHolder),this.container.addChild(this.layersHolder),this.container.addChild(this.hud.container),this.container.addChild(this.interactionManager.container),this.layersHolder.addChild(new PIXI.display.Layer(e.SORT_GROUP_FLOOR)),this.layersHolder.addChild(new PIXI.display.Layer(e.SORT_GROUP_PROP_BACK)),this.layersHolder.addChild(new PIXI.display.Layer(e.SORT_GROUP_PROP)),this.layersHolder.addChild(new PIXI.display.Layer(e.SORT_GROUP_PROP_FRONT)),this.layersHolder.addChild(new PIXI.display.Layer(e.SORT_GROUP_FRONT)),this.layersHolder.addChild(new PIXI.display.Layer(e.SORT_GROUP_DEBUG)),this.setCameraStyle({followPlayer:!0,euler:this.standardCameraEuler,z:this.standardCameraZ,scale:this.standardCameraScale,offsetY:this.cameraOffsetY,offsetX:this.cameraOffsetX,debug:this.debugMode}),this.cameraPositionTarget[0]=this.player.scenePos.x+this.cameraSettings.offsetX,this.cameraPositionTarget[1]=this.player.scenePos.y+this.cameraSettings.offsetY,this.setupPowerup(),this.shakeStartingPos=this.scaleHolder.position.y},e.prototype.setupPowerup=function(){switch(Game.coreData.getCurrentTeam()||"scooby"){case"tom":this.powerup=new TomSmash(this);break;case"scooby":this.powerup=new ScoobySnack(this);break;case"tweety":this.powerup=new Anvil(this);break;case"bugs":this.powerup=new Basketball(this);break;case"wile":this.powerup=new Dynamite(this)}},e.prototype.startGameplay=function(){Game.playSound("music-"+this.trackSelected+".mp3",.9),this.started=!0;for(e=0;e<this.player.attachments.length;e++){var t=0;"accessories-scene/draggable-wile-cactus"==this.player.attachments[e].sprite.id&&t++,"accessories-scene/draggable-wile-rocket"==this.player.attachments[e].sprite.id&&(this.rocketAttached=!0),"accessories-scene/draggable-wile-tnt"==this.player.attachments[e].sprite.id&&(this.tntAttached=!0),3==t&&Game.coreData.unlockAchievement("attach-3-cacti")}this.followPlayer=!0,this.interactionManager.startRace(),this.player.accelerate();for(e=0;e<this.rivals.length;e++)TweenMax.delayedCall(Game.getRandom(-.1,.5),this.rivals[e].accelerate,null,this.rivals[e]);for(var e=0;e<this.vehicles.length;e++)this.vehicles[e].startRace();this.player.accelerate()},e.prototype.setCameraStyle=function(t){var e=null==t.followPlayer||t.followPlayer,i=null==t.euler?1:t.euler,n=null==t.eulerZ?0:t.eulerZ,o=null==t.z?this.standardCameraZ:t.z,r=null==t.fov?340:t.fov,a=null!=t.debug&&t.debug,s=null==t.scale?this.standardCameraScale:t.scale,l=(null==t.playerSpeed||t.playerSpeed,null==t.offsetX?this.cameraOffsetX:t.offsetX),c=null==t.offsetY?this.cameraOffsetY:t.offsetY;if(t.time){var h=t.time,p=new TimelineMax;p.add([TweenMax.to(this.camera.euler,h,{x:i,ease:Power2.easeInOut}),TweenMax.to(this.camera.euler,h,{z:n,ease:Power2.easeInOut}),TweenMax.to(this.camera.position3d,h,{z:o,ease:Power2.easeInOut}),TweenMax.to(this.scaleHolder.scale,h,{x:s,y:s,ease:Power2.easeInOut}),TweenMax.to(this.cameraSettings,h,{offsetX:l,ease:Power2.easeInOut}),TweenMax.to(this.cameraSettings,h,{offsetY:c,ease:Power2.easeInOut})]),p.call(function(){this.followPlayer=e},null,this)}else this.camera.euler.x=i,this.camera.position3d.z=o,this.camera.setPlanes(r,-1e6,1e6,!1),this.scaleHolder.scale.set(s,s),this.followPlayer=e,this.cameraSettings.offsetX=l,this.cameraSettings.offsetY=c;this.cameraSettings.debug=a,this.cameraSettings.euler=i,this.cameraSettings.eulerZ=n,this.cameraSettings.scale=s,this.cameraSettings.z=o,0==a&&this.physicsDebugger.manualClear()},e.prototype.getRandomTeam=function(t){var e=Game.getRandom(0,this.teams.length-1,!0);return t&&(e=this.teams.indexOf(t)),this.teams.splice(e,1)[0]},e.prototype.enterSlowMo=function(){this.physicsManager.setWorldSpeed(.25),this.gameSpeed=.25;for(var t=0;t<this.vehicles.length;t++)this.vehicles[t].setAnimationSpeed()},e.prototype.exitSlowMo=function(){this.physicsManager.setWorldSpeed(1),this.gameSpeed=1;for(var t=0;t<this.vehicles.length;t++)this.vehicles[t].setAnimationSpeed()},e.prototype.rivalHitRival=function(t,e){for(var i,n,o=0;o<this.rivals.length;o++)this.rivals[o].p2Body==t&&(i=this.rivals[o]).startTouchOtherVehicle(),this.rivals[o].p2Body==e&&(n=this.rivals[o]).startTouchOtherVehicle();this.decideBash(i,n)},e.prototype.playerHitRival=function(t,e){for(var i,n=0;n<this.rivals.length;n++)this.rivals[n].p2Body==e&&(i=this.rivals[n]).startTouchOtherVehicle();this.storedRival=i.id,this.rivalHitActive=!0,this.shakeScreen(1.5,2,8,.2,1),this.decideBash(this.player,i)},e.prototype.rivalHitPowerup=function(t){},e.prototype.playerCollectPowerup=function(){switch(1==Game.onDesktop&&this.game.ui.showSpaceBarHint(),this.powerup.status){case"aiming":break;case"activating":this.interactionManager.collectPowerup(),this.powerup.setStatusWhenFinished("aiming");break;case"not-ready":this.interactionManager.collectPowerup(),this.powerup.setStatus("aiming")}},e.prototype.activatePowerup=function(){this.game.ui.hideSpaceBarHint(),this.targetedRival=null;for(var t=0;t<this.rivals.length;t++){var e=this.rivals[t];e.highlighted&&(this.targetedRival=e,e.disableAI())}this.targetedRival&&(this.interactionManager.lockTarget(),this.targetedRival.target()),this.powerup.activate(this.targetedRival)},e.prototype.smashRival=function(t){"blast"==t?this.shakeScreen(1.5,10,50,.5,0):this.shakeScreen(1.5,8,30,.5,0),Game.playSound("wb-impact.mp3"),this.targetedRival&&(4==++this.rivalsSmashed&&Game.coreData.unlockAchievement("knock-out-all-opponents"),this.targetedRival.smash(t),this.interactionManager.stopTargetVehicle(),"tom"==this.targetedRival.team&&(this.tomSmashed=!0),"tweety"==this.targetedRival.team&&(this.tweetySmashed=!0),1==this.tomSmashed&&1==this.tweetySmashed&&Game.coreData.unlockAchievement("tom-and-sylvester"),this.player.raceProgress>.9&&Game.coreData.unlockAchievement("knock-out-opponent-before-finish-line"))},e.prototype.decideBash=function(t,e){var i;i=e.p2Body.position[1]>t.p2Body.position[1]?1:-1,t.showSparks(i),e.showSparks(-i),t.bashability>e.bashability?e.bashBackToLane(t.targetLane+i):t.bashability<e.bashability?t.bashBackToLane(e.targetLane-i):t.bashability==e.bashability?e.bashBackToLane(t.currentLane+i):t.bashBackToLane(e.targetLane+i)},e.prototype.vehicleStopHitVehicle=function(t,e){for(var i=0;i<this.rivals.length;i++)this.rivals[i].p2Body==t&&this.rivals[i].stopTouchOtherVehicle(),this.rivals[i].p2Body==e&&this.rivals[i].stopTouchOtherVehicle()},e.prototype.rivalStopHitPowerup=function(t){},e.prototype.playerHitSensor=function(t){if(t==this.trackManager.raceEndSensorBody&&0==this.endingRace){if(console.log("end race"),Game.fadeSound("music-"+this.trackSelected+".mp3",1,.5),this.endingRace=!0,this.powerup.setStatus("not-ready"),this.raceTimer<3600&&"garage"==this.trackSelected&&Game.coreData.unlockAchievement("finish-garage-under-60-seconds"),this.player.endRace(),this.resultsPanel.logVehicle(this.player),0==this.hud.playerPosition?(Game.playSound("winner.mp3"),0==this.player.obstacleHit&&Game.coreData.unlockAchievement("win-no-obstacle-hit"),3==this.player.bombsHit&&Game.coreData.unlockAchievement("hit-3-bombs-and-win"),this.player.numberobstaclesHit>=10&&"garage"==this.trackSelected&&Game.coreData.unlockAchievement("hit-10-obsticles-win-garage"),"tom"==this.player.team&&(Game.coreData.trackedAchievements["win-three-races"][0].value++,3==Game.coreData.trackedAchievements["win-three-races"][0].value&&Game.coreData.unlockAchievement("win-three-races-in-row"))):Game.coreData.trackedAchievements["win-three-races"].value=0,0==this.player.bombsHit&&"bugs"==this.player.team){switch(this.trackSelected){case"living-room":Game.coreData.trackedAchievements["complete-all-races-no-bomb-hit"][0].livingroom=!0;break;case"bathroom":Game.coreData.trackedAchievements["complete-all-races-no-bomb-hit"][0].bathroom=!0;break;case"garage":Game.coreData.trackedAchievements["complete-all-races-no-bomb-hit"][0].garage=!0}var e=Game.coreData.trackedAchievements["complete-all-races-no-bomb-hit"];1==e[0].garage&&1==e[0].bathroom&&1==e[0].livingroom&&Game.coreData.unlockAchievement("complete-all-races-no-bomb-hit")}this.setCameraStyle({offsetX:150,offsetY:400,scale:5,euler:1.4,time:2}),TweenMax.delayedCall(1,this.raceComplete,null,this)}},e.prototype.rivalHitSensor=function(t,e){if(t==this.trackManager.raceEndSensorBody){for(var i,n=0;n<this.rivals.length;n++)e==this.rivals[n].p2Body&&(i=this.rivals[n]);i.endRace(),this.resultsPanel.logVehicle(i)}},e.prototype.vehicleHitObstacle=function(t,e){var i=this.trackManager.getObstacleType(t);e==this.player.p2Body&&this.player.hitObstacle(i);for(var n=0;n<this.rivals.length;n++)e==this.rivals[n].p2Body&&(this.rivals[n].hitObstacle(i),this.rivals[n].id==this.storedRival&&1==this.rivalHitActive&&(Game.coreData.unlockAchievement("bash-opponent-into-obstacle"),"bomb"==i&&1==this.rocketAttached&&1==this.tntAttached&&Game.coreData.unlockAchievement("equip-tnt-and-rocket-and-bash-into-bomb")));this.trackManager.hitObstacle(t)},e.prototype.vehicleHitRamp=function(t,e){if(e==this.player.p2Body&&(this.player.hitRamp(),++this.rampsHit>=10&&Game.coreData.unlockAchievement("use-three-ramps"),this.rampsHit>=10))for(i=0;i<this.player.attachments.length;i++)"accessories-scene/draggable-tweety-wings"==this.player.attachments[i].sprite.id&&Game.coreData.unlockAchievement("wings-equiped-10-jumps");for(var i=0;i<this.rivals.length;i++)e==this.rivals[i].p2Body&&this.rivals[i].hitRamp();this.trackManager.hitRamp(t)},e.prototype.playerHitCollectable=function(t){var e=this.trackManager.getCollectableType(t);this.player.hitCollectable(e),this.trackManager.hitCollectable(t)},e.prototype.rivalHitCollectable=function(t,e){for(var i,n=this.trackManager.getCollectableType(t),o=0;o<this.rivals.length;o++)e==this.rivals[o].p2Body&&(i=this.rivals[o]);i.hitCollectable(n),this.trackManager.hitCollectable(t)},e.prototype.raceComplete=function(){this.hud.raceComplete(),this.interactionManager.raceComplete(),this.game.ui.setUI("race-complete"),this.container.addChild(this.resultsPanel.container),this.resultsPanel.show()},e.prototype.sortPropZorder=function(t){t.zOrder=-t.getDepth(),this.player.sortZ(this.player);for(var e=0;e<this.rivals.length;e++)this.rivals[e].sortZ(this.rivals[e])},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"pause-button":this.pause();break;case"close-button":this.resume();break;case"powerup-button":this.interactionManager.activatePowerup();break;case"next-race-button":i=this;this.game.loadAssets(Game.assetChunkManager.generateLoadChunk("garage"),!0,function(){i.game.setScene("selectTrackScene",!0)});break;case"garage-button":i=this;this.game.loadAssets(Game.assetChunkManager.generateLoadChunk("garage"),!0,function(){i.game.setScene(Game.assetChunkManager.getTargetScene(),!0)});break;case"achievements-button":var i=this;this.paused=!0,i.game.setScene("achievementsScene",!0,["raceScene"])}},e.prototype.restore=function(){t.prototype.restore.call(this),this.paused=!1,this.resultsPanel.restore(),this.game.ui.setUI("race-complete-instant")},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.keyDown=function(t){this.interactionManager.keyDown(t)},e.prototype.keyUp=function(t){this.interactionManager.keyUp(t)},e.prototype.shakeScreen=function(t,e,i,n,o){this.screenShakeTimeline=this.killTween(this.screenShakeTimeline),this.screenShakeTimeline=new TimelineMax;var r=this.shakeStartingPos+i;this.scaleHolder.position.y=r;var a=new RoughEase({strength:t,points:Math.round(e),randomize:!1,clamp:!0});this.screenShakeTimeline.add(TweenMax.to(this.scaleHolder.position,n,{y:this.shakeStartingPos,ease:a,yoyo:!0,repeat:o}))},e.prototype.tick=function(e){if(t.prototype.tick.call(this,e),1!=this.paused){1==this.rivalHitActive&&++this.rivalTimer>this.rivalTimerLimit&&(this.rivalTimer=0,this.rivalHitActive=!1),this.raceTimer++,this.trackManager.tick(),this.powerup.tick(),this.physicsManager.stepPhysics(),this.checkRivalsInRange(),this.player.tick();for(var i=0;i<this.rivals.length;i++)this.rivals[i].tick();this.hud.tick(),1==this.cameraSettings.debug&&this.physicsDebugger.updateDebugOverlay(),this.positionViewport(),this.interactionManager.tick(),this.ticker++}},e.prototype.checkRivalsInRange=function(){var t;if("aiming"==this.powerup.status)for(var e=0;e<this.rivals.length;e++)(t=this.rivals[e]).p2Body.overlaps(this.interactionManager.powerupBody)?0==t.highlighted&&0==this.interactionManager.targetingVehicle&&(t.highlight(),this.interactionManager.targetVehicle(t),this.powerup.targetVehicle(t)):1==t.highlighted&&(t.removeHighlight(),this.interactionManager.stopTargetVehicle(),this.powerup.targetVehicle(null))},e.prototype.positionViewport=function(){var t=720,i=this.player.getSpeed();1==this.followPlayer&&(this.cameraPositionTarget[0]=this.player.scenePos.x+this.cameraSettings.offsetX+20*i,this.cameraPositionTarget[1]=this.player.scenePos.y+this.cameraSettings.offsetY+10*i);var n,o,r,a,s,l=this.cameraSettings.scale-i/10,c=this.cameraSettings.scale-i/10;("aiming"==this.powerup.status||"activating"==this.powerup.status)&&this.hud.playerPosition>0?(t=800,a=this.cameraSettings.euler+.2-i/150,s=i/100,n=this.cameraPositionTarget[0]+200,o=700,r=-300,l=2,c=2):(a=this.cameraSettings.euler-i/55,s=i/100,n=this.cameraPositionTarget[0],o=this.cameraPositionTarget[1],r=this.cameraSettings.z-15*i,l=this.cameraSettings.scale-i/10,c=this.cameraSettings.scale-i/10),l<.9&&(l=c=.9),this.cameraPositionTarget[1]>t&&(o=t),this.camera.position3d.x+=(n-this.camera.position3d.x)/e.cameraEase,this.camera.position3d.y+=(o-this.camera.position3d.y)/e.cameraEase,this.camera.position3d.z+=(r-this.camera.position3d.z)/e.cameraEase,0==this.debugMode&&(this.camera.euler.x+=(a-this.camera.euler.x)/e.cameraEase,this.camera.euler.z+=(s-this.camera.euler.z)/e.cameraEase,this.scaleHolder.scale.x+=(l-this.scaleHolder.scale.x)/e.cameraEase,this.scaleHolder.scale.y+=(c-this.scaleHolder.scale.y)/e.cameraEase)},e.prototype.toggleDebugMode=function(){this.debugMode=!this.debugMode,1==this.debugMode?this.setCameraStyle({euler:0,z:-1500,fov:1e3,debug:!0,scale:1}):this.setCameraStyle({})},e.prototype.pause=function(){t.prototype.pause.call(this);for(var e=0;e<this.vehicles.length;e++)this.vehicles[e].pause();this.hud.pause(),this.trackManager.pause(),this.game.ui.setUI("race-paused"),this.powerup.pause(),Game.pauseSound("music-"+this.trackSelected+".mp3"),this.interactionManager.powerupButton.pause()},e.prototype.resume=function(){t.prototype.resume.call(this);for(var e=0;e<this.vehicles.length;e++)this.vehicles[e].resume();this.hud.resume(),this.trackManager.resume(),this.powerup.resume(),this.interactionManager.powerupButton.resume(),Game.resumeSound("music-"+this.trackSelected+".mp3"),this.game.ui.setUI("race")},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.stopSound("music-"+this.trackSelected+".mp3"),this.trackManager.destroy(),Game.displayStore.returnAllPooledItems("race-assets");for(var e=0;e<this.rivals.length;e++)this.rivals[e].destroy();this.interactionManager.destroy(),this.hud.destroy(),this.physicsManager.destroy(),this.player.destroy(),this.resultsPanel.destroy(),Game.saveProgress(),Game.displayStore.returnAllPooledItems("race-assets")},e.prototype.getDistance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},e.prototype.getAngle=function(t,e){if(t.x!=e.x||t.y!=e.y){var i=t.x-e.x,n=e.y-t.y;return Math.atan2(n,i)}},e.levelScale=2,e.cameraEase=15,e.lanePositions=[140,240,342,444,546],e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),PaintScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="paintScene",n}return __extends(e,t),e.prototype.init=function(e){this.titleText=Game.displayStore.getBitmapText("paint-scene/title-text","paint-scene-title"),this.titleText.position.set(512-this.titleText.width/2,32),t.prototype.init.call(this),Game.stopSound("music-start.mp3"),"stickersScene"!=this.game.lastSceneID&&(Game.stopSound("music-craft.mp3"),Game.playSound("music-craft.mp3",.5)),this.game.ui.setUI("paint"),this.game.ui.disableButton("undo-button");var i;Game.coreData.getPlayerCarData()&&Game.coreData.getPlayerCarData().carPaintSprite&&(i=Game.coreData.getPlayerCarData().carPaintSprite),i&&this.car.loadPaintState(i),this.car.enableMask(),this.touchSprite.interactive=!0,this.mouseIsDown=!1,this.panelLeft=Game.displayStore.getContainer("paint-scene/panel-left-holder"),this.panelRight=Game.displayStore.getContainer("paint-scene/panel-right-holder"),this.panelBottom=Game.displayStore.getContainer("paint-scene/panel-bottom-holder");var n=this.panelLeft.getContainer("paint-scene/panel-left-backing-holder");n.interactiveChildren=!1,this.panelLeft.interactive=!1,this.panelRight.interactive=!1,this.panelBottom.interactive=!1,this.panelLeftShadow=n.getSprite("paint-scene/panel-left-shadow"),this.panelRightShadow=this.panelRight.getSprite("paint-scene/panel-right-shadow"),this.panelBottomShadow=this.panelBottom.getSprite("paint-scene/panel-bottom-shadow"),this.panelLeftShadow.interactive=!1,this.panelRightShadow.interactive=!1,this.panelBottomShadow.interactive=!1,this.panelBottomHighlight=this.panelBottom.getContainer("paint-scene/panel-bottom-highlight-triangles-holder");var o=this.panelBottomHighlight.getSprite("paint-scene/panel-bottom-highlight-triangle-bottom");o.rotation=Math.PI,o.position.y=60,this.panelRightHighlight=this.panelRight.getContainer("paint-scene/panel-right-highlight-triangle-holder"),this.panelRightHighlight.getSprite("paint-scene/panel-right-highlight-triangle").rotation=-Math.PI/2,this.panelLeftShadow.tint=0,this.panelRightShadow.tint=0,this.panelBottomShadow.tint=0,this.panelLeftShadow.alpha=.3,this.panelRightShadow.alpha=.3,this.panelBottomShadow.alpha=.3,this.paintingLayer=Game.displayStore.getContainer("paint-scene/painting-layer"),this.brushTipHolder=this.paintingLayer.getContainer("paint-scene/brush-tip-holder"),this.brushTipHolder.interactive=!1,this.brushTipHolder.interactiveChildren=!1,this.brushTipHolder.visible=!1,this.paintingLayer.interactive=!1,this.paintingLayer.interactiveChildren=!1,this.swatches=[];for(var r=CoreData.pallettes[Game.coreData.getCurrentTeam()],a=0;a<9;a++){var s=[];a<5?(s[0]=43,s[1]=50+70*a):(s[0]=110,s[1]=70+70*(a-5));var l=new Swatch(this,a,r[a],s,"colour");this.swatches.push(l),this.panelLeft.addChild(l.container)}this.tints=[];for(a=0;a<3;a++){(s=[])[0]=42+72*a,s[1]=40;var c=new Swatch(this,a,16777215,s,"tint");this.tints.push(c),this.panelBottom.addChild(c.container)}var h=[[95,70],[95,148],[95,220]];this.brushes=[];for(a=0;a<3;a++){var p=new Brush(this,a,a+1,h[a]);this.brushes.push(p),this.panelRight.addChild(p.container)}this.trail=new Trail(this),this.trail.container.visible=!1,this.paintingLayer.addChild(this.trail.container);this.animation.add([TweenMax.to(this.mainHolder.scale,.5,{x:1,y:1,ease:Sine.easeInOut})],.5),"selectCarScene"==this.game.lastSceneID?this.animation.call(this.car.enableCorners,null,this.car,.3):this.car.enableCorners(),this.mainHolder.addChild(this.paintingLayer),this.mainHolder.addChild(this.touchSprite),this.mainHolder.addChild(this.panelLeft),this.mainHolder.addChild(this.panelRight),this.mainHolder.addChild(this.panelBottom),this.addInteraction(),this.activateSwatch(this.swatches[0]),this.activateBrush(this.brushes[1])},e.prototype.undoLastStroke=function(){this.car.undoStep(),this.game.ui.disableButton("undo-button")},e.prototype.activateSwatch=function(t){if("colour"==t.group){for(i=0;i<this.swatches.length;i++){var e=this.swatches[i];e!=t&&e.deactivate()}this.currentColour=t.colour,Game.playSound("paint-pot-1.mp3"),Game.playSound("spooge-3.mp3",.5),this.setTints(t.colour)}else if("tint"==t.group){for(var i=0;i<this.tints.length;i++){var n=this.tints[i];n!=t&&n.deactivate()}this.currentColour=t.colour,Game.playSound("paint-pot-2.mp3"),Game.playSound("spooge-3.mp3",.5),TweenMax.to(this.panelBottomHighlight.position,.2,{x:t.container.position.x,ease:Back.easeOut})}t.activate(),this.trail.setColour(t.colour),this.setTipColour(t.colour),this.panelBottom.addChild(this.panelBottomHighlight)},e.prototype.activateBrush=function(t){for(var e=0;e<this.brushes.length;e++){var i=this.brushes[e];t==i?i.activate():i.deactivate()}this.currentThickness=t.thickness,this.trail.setThickness(t.thickness),Game.playSound("change-lane-up.mp3"),TweenMax.to(this.panelRightHighlight.position,.2,{ease:Back.easeOut,y:t.container.position.y}),this.brushTipHolder.showOnlyChild(this.currentThickness-1),this.panelRight.addChild(this.panelRightHighlight)},e.prototype.setTints=function(t){for(var e=0;e<this.tints.length;e++){var i=this.tints[e];i.setColour(t),1==e?i.activate():i.deactivate()}this.panelBottomHighlight.position.x=this.tints[1].container.position.x},e.prototype.setTipColour=function(t){for(var e=0;e<3;e++)this.brushTipHolder.getSpriteAt(e).tint=t},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"tick-button":Game.coreData.storeCarPaintSprite(this.car.getPaintLayerTexture()),this.game.setScene("stickersScene");break;case"back-button":1==Game.coreData.editMode?this.backToGarage():(Game.coreData.clearPlayerCarCraftData(),Game.stopSound("music-craft.mp3"),this.game.setScene("selectCarScene",!0));break;case"undo-button":this.undoLastStroke()}},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.backToGarage=function(){Game.coreData.storeCarPaintSprite(this.car.getPaintLayerTexture()),this.car.destroy(),this.car=new Car(this);var t=Game.coreData.getPlayerCarData().carPaintSprite,e=Game.coreData.getPlayerCarData().carStickersSprite;t.setRegPoint(0,0),this.car.loadPaintState(t),e&&(e.setRegPoint(0,0),this.car.render(e)),this.car.enableMask(),this.car.loadWheels();var i=this.car.getGarageOutputTexture(!0),n=i.texture,o=i.offset;Game.coreData.storeCarGarageSprite(n,o),this.game.setScene("garageScene",!0)},e.prototype.generateCarSkin=function(){var t=Game.displayStore.getRenderTexture("car-render-texture",this.car.carContainer.width/2,this.car.carContainer.height/2,"paint-assets",!1),e=t.renderTexture,i=t.outputSprite,n=new PIXI.Matrix;n.scale(.5,.5),n.translate(-this.car.carContainer.position.x/2,-this.car.carContainer.position.y/2),Game.renderer.render(this.car.carContainer,e,!1,n),i.scale.set(2,2)},e.prototype.addInteraction=function(){var t=this,e=this.touchSprite;Game.onDesktop?(e.on("mousedown",function(e){t.touchStart(t,e)}),e.on("mouseup",function(e){t.touchEnd(t,e)}),e.on("mouseupoutside",function(e){t.touchEnd(t,e)}),e.on("mousemove",function(e){t.touchMove(t,e)})):(e.on("touchstart",function(e){t.touchStart(t,e)}),e.on("touchend",function(e){t.touchEnd(t,e)}),e.on("touchendoutside",function(e){t.touchEnd(t,e)}),e.on("touchmove",function(e){t.touchMove(t,e)}))},e.prototype.touchStart=function(t,e){t.mousePos.x=e.data.getLocalPosition(t.container).x,t.mousePos.y=e.data.getLocalPosition(t.container).y,t.mouseIsDown=!0,t.brushTipHolder.position.copy(t.mousePos),t.trail.clearHistory(t.mousePos),t.trail.doTrail(t.mousePos),t.trail.container.visible=!0,t.brushTipHolder.visible=!0,Game.coreData.unlockAchievement("paint-car"),Game.playSound("spooge-"+Game.getRandom(1,2,!0)+".mp3"),this.car.saveState(PIXI.BLEND_MODES.MULTIPLY),this.game.ui.enableButton("undo-button")},e.prototype.touchEnd=function(e,i){t.prototype.touchEnd.call(this,e,i),e.mouseIsDown=!1,Game.stopSound("spooge-1.mp3"),Game.stopSound("spooge-2.mp3"),e.trail.container.visible=!1,e.brushTipHolder.visible=!1},e.prototype.touchMove=function(e,i){0!=e.mouseIsDown&&(t.prototype.touchMove.call(this,e,i),this.brushTipHolder.position.copy(this.mousePos),this.trail.doTrail(this.mousePos))},e.prototype.tick=function(){t.prototype.tick.call(this),this.car.render(this.paintingLayer,!0)},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.animation=this.killTween(this.animation);for(i=0;i<this.swatches.length;i++)(e=this.swatches[i]).destroy();for(i=0;i<this.tints.length;i++){var e=this.tints[i];e.destroy()}for(var i=0;i<this.brushes.length;i++)this.brushes[i].destroy();this.trail.destroy(),Game.displayStore.returnAllPooledItems("paint-assets")},e}(CraftScene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),StickersScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.totalStickers=0,n.id="stickersScene",n}return __extends(e,t),e.prototype.init=function(e){this.titleText=Game.displayStore.getBitmapText("stickers-scene/title-text","stickers-scene-title"),this.titleText.position.set(512-this.titleText.width/2,32),this.deleteMode=!1,t.prototype.init.call(this),this.liveStickers=[],this.car.setPos([45,220]),this.car.enableMask(),this.car.loadPaintState(Game.coreData.getPlayerCarData().carPaintSprite),this.car.enableCorners(),this.game.ui.setUI("stickers"),this.game.ui.disableButton("undo-button"),this.stickers=Game.coreData.getStickers(Game.coreData.getCurrentTeam()),t.prototype.createTilePanel.call(this,{panel:Game.displayStore.getContainer("stickers-scene/stickers-panel"),items:this.stickers,columns:2,tilesPerPage:6,tileOffset:[0,37],tileRegPoint:[.5,1],dragItemType:"sticker",prepend:"stickers-scene/"+Game.coreData.getCurrentTeam()+"/"}),this.checkDeleteButtonStatus(),this.loadStickers()},e.prototype.setSelectedMenuItem=function(e){this.game.ui.enableButton("undo-button"),t.prototype.setSelectedMenuItem.call(this,e),this.mainHolder.addChild(this.touchSprite),Game.playSound("small-pop.mp3"),this.exitDeleteMode(),this.selectedMenuItem.draggableItem||this.selectedMenuItem.getNewDraggableItem(),this.car.showMask(!0,this.dragLayer)},e.prototype.touchEnd=function(e,i){this.car.showMask(!1),this.exitDeleteMode(),this.selectedMenuItem&&(i.data.getLocalPosition(e.container).x<700?(this.liveStickers.push(this.selectedMenuItem.draggableItem),this.selectedMenuItem.draggableItem.drop(),this.car.addSticker(this.selectedMenuItem.draggableItem,!0),++this.totalStickers>=4&&Game.coreData.unlockAchievement("attach-4-sylvester-stickers"),Game.playSound("sticker-"+Game.getRandom(1,3,!0)+".mp3"),this.selectedMenuItem.draggableItem=null):this.selectedMenuItem.draggableItem.container.visible=!1,this.checkDeleteButtonStatus()),this.mainHolder.addChildAt(this.panelHolder,0),t.prototype.touchEnd.call(this,e,i)},e.prototype.removeSticker=function(t){var e=this.liveStickers.splice(this.liveStickers.indexOf(t),1)[0];this.totalStickers--,e.destroy(),Game.playSound("sticker-"+Game.getRandom(1,3,!0)+".mp3"),this.exitDeleteMode()},e.prototype.undoLastSticker=function(){this.liveStickers.pop().destroy(),this.game.ui.disableButton("undo-button"),this.checkDeleteButtonStatus(),this.exitDeleteMode()},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"tick-button":this.nextScene();break;case"back-button":this.game.setScene("paintScene");break;case"undo-button":this.undoLastSticker();break;case"delete-button":this.enterDeleteMode();break;case"close-button-red":this.game.ui.hidePrompt("achievement")}},e.prototype.nextScene=function(){if(1!=this.doingNextScene){t.prototype.nextScene.call(this);var e=this.car.getStickersOutputTexture();new Sprite(e);Game.coreData.storeCarStickersSprite(e),this.game.setScene("wheelsScene")}},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.touchMove=function(e,i){t.prototype.touchMove.call(this,e,i)},e.prototype.checkDeleteButtonStatus=function(){0==this.liveStickers.length?this.game.ui.disableButton("delete-button"):this.game.ui.enableButton("delete-button")},e.prototype.enterDeleteMode=function(){if(1!=this.deleteMode){this.game.ui.disableButton("delete-button"),this.deleteMode=!0;for(var t=0;t<this.liveStickers.length;t++)this.liveStickers[t].enterDeleteMode(),this.liveStickers[t].container.position.copy(this.dragLayer.toLocal(new PIXI.Point,this.liveStickers[t].container)),this.dragLayer.addChild(this.liveStickers[t].container);this.car.showMask(!0,this.dragLayer)}},e.prototype.exitDeleteMode=function(){if(0!=this.deleteMode){this.deleteMode=!1,this.car.showMask(!1),this.checkDeleteButtonStatus();for(var t=0;t<this.liveStickers.length;t++)this.liveStickers[t].exitDeleteMode(),this.car.addSticker(this.liveStickers[t],!0)}},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.saveState=function(){for(var t=[],e=0;e<this.liveStickers.length;e++)t.push({menuTileIndex:this.liveStickers[e].menuTile.index,pos:[this.liveStickers[e].container.position.x,this.liveStickers[e].container.position.y]});Game.coreData.saveStickers(t)},e.prototype.loadStickers=function(){var t=Game.coreData.getPlayerCarData().stickerData;if(t){for(var e=0;e<t.length;e++){var i=this.menuTiles[t[e].menuTileIndex].getNewDraggableItem(!0);this.liveStickers.push(i),i.container.position.x=t[e].pos[0],i.container.position.y=t[e].pos[1],console.log(t[e],i),this.car.addSticker(i)}this.checkDeleteButtonStatus()}},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.displayStore.returnAllPooledItems("stickers-assets"),this.saveState();for(var e=0;e<this.menuTiles.length;e++)this.menuTiles[e].destroy();this.panelHolder.removeChild(this.tilesMask),this.tilesMask.clear()},e}(CraftScene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),SelectTeamScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="selectTeamScene",n}return __extends(e,t),e.prototype.init=function(e){this.container.addChild(Game.displayStore.getSprite("select-team-scene/bg.png")),t.prototype.init.call(this,{titleString:"select-team-scene-title",menuData:CoreData.teams,prepend:"select-team-scene"}),this.game.ui.setUI("select-team"),this.game.ui.disableButton("undo-button"),"selectCarScene"!=this.game.lastSceneID&&(Game.stopSound("music-start.mp3"),Game.playSound("music-start.mp3",.5));var i=Math.floor(this.tiles.length/2);void 0!=Game.coreData.getCurrentTeamIndex()&&(i=Game.coreData.getCurrentTeamIndex());for(var n=0;n<this.tiles.length;n++)this.tiles[n].addAchievementsPanel();this.goToTile(this.tiles.length-1,!0),this.goToTile(i)},e.prototype.goToTile=function(e,i){t.prototype.goToTile.call(this,e,i),0==this.currentTile&&this.game.ui.removeButton(this.game.ui.menuButtonLeft),0==this.previousTile&&this.game.ui.addUIButton(this.game.ui.menuButtonLeft,!0,!0),this.currentTile==this.tiles.length-1&&this.game.ui.removeButton(this.game.ui.menuButtonRight),this.previousTile==this.tiles.length-1&&this.game.ui.addUIButton(this.game.ui.menuButtonRight,!0,!0)},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"select-button":this.nextScene()}},e.prototype.nextScene=function(){1!=this.doingNextScene&&(t.prototype.nextScene.call(this),this.tiles[this.currentTile].select(),TweenMax.delayedCall(.5,function(){Game.coreData.setCurrentTeam(this.tiles[this.currentTile].id),this.game.setScene("selectCarScene",!0)},null,this))},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.displayStore.returnAllPooledItems("select-team-assets")},e}(CarouselMenuScene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),SelectCarScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="selectCarScene",n}return __extends(e,t),e.prototype.init=function(e){this.container.addChild(Game.displayStore.getSprite("select-car-scene/bg.png")),t.prototype.init.call(this,{titleString:"select-car-scene-title",menuData:CoreData.cars,prepend:"select-car-scene",generateShadows:!0}),this.currentTile=1,"paintScene"==this.game.lastSceneID&&Game.playSound("music-start.mp3",.5);for(var i=0;i<this.tiles.length;i++)this.tiles[i].innerContainer.scale.set(.8,.8),this.tiles[i].addPaperclip();this.game.ui.setUI("select-car");var n=Math.floor(this.tiles.length/2);void 0!=Game.coreData.getCurrentCarIndex()&&(n=Game.coreData.getCurrentCarIndex());var o=new AchievementsTallyPanel(this);this.container.addChild(o.container),o.show(),this.goToTile(this.tiles.length-1,!0),this.goToTile(n)},e.prototype.goToTile=function(e,i){t.prototype.goToTile.call(this,e,i),0==this.currentTile&&this.game.ui.removeButton(this.game.ui.menuButtonLeft),0==this.previousTile&&this.game.ui.addUIButton(this.game.ui.menuButtonLeft,!0,!0),this.currentTile==this.tiles.length-1&&this.game.ui.removeButton(this.game.ui.menuButtonRight),this.previousTile==this.tiles.length-1&&this.game.ui.addUIButton(this.game.ui.menuButtonRight,!0,!0)},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"select-button":this.nextScene();break;case"back-button":this.game.setScene("selectTeamScene",!0)}},e.prototype.nextScene=function(){1!=this.doingNextScene&&(t.prototype.nextScene.call(this),Game.fadeSound("music-start.mp3",1,0),this.tiles[this.currentTile].select(),TweenMax.delayedCall(.5,function(){Game.coreData.addCarToGarage(this.tiles[this.currentTile].id),this.game.setScene("paintScene",!0)},null,this))},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.displayStore.returnAllPooledItems("select-car-assets")},e}(CarouselMenuScene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),GarageScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="garageScene",n}return __extends(e,t),e.prototype.init=function(e){this.container.addChild(Game.displayStore.getSprite("garage-scene/bg.png")),Game.coreData.editMode=!1;for(var i=Game.coreData.getPlayerGarageData(),n=0,o=0;o<i.length;o++)"empty"!=i[o].id&&n++;Game.stopSound("music-craft.mp3"),"garageScene"!=this.game.lastSceneID&&Game.playSound("music-start.mp3",.5),Game.displayStore.flush(["race"]),Game.coreData.unlockAchievement("create-custom-car"),n<CoreData.maxCarsInGarage&&"empty"!=i[i.length-1].id&&Game.coreData.populateGarage("empty"),t.prototype.init.call(this,{titleString:"garage-title",menuData:Game.coreData.getPlayerGarageData(),prepend:"garage-scene",generateShadows:!0}),this.currentTile=1,this.scissors=Game.displayStore.getSprite("garage-scene/scissors.png"),this.flag=Game.displayStore.getSprite("garage-scene/flag.png");for(o=0;o<this.tiles.length;o++)this.tiles[o].innerContainer.scale.set(.8,.8),this.tiles[o].addPaperclip();this.game.ui.setUI("garage"),this.scissors.position.y=this.game.ui.editButton.position.y,this.scissors.position.x=this.game.ui.editButton.position.x+this.game.ui.editButton.width/2,this.container.addChild(this.scissors),this.flag.position.y=this.game.ui.raceButton.position.y,this.flag.position.x=this.game.ui.raceButton.position.x+this.game.ui.raceButton.width/2,this.container.addChild(this.flag),this.enableCorners(),this.achievementsPanel=new AchievementsTallyPanel(this),this.container.addChild(this.achievementsPanel.container),this.goToTile(this.tiles.length-1,!0),this.goToTile(Game.coreData.getCurrentGarageIndex())},e.prototype.goToTile=function(e,i){t.prototype.goToTile.call(this,e,i),0==this.currentTile&&this.game.ui.removeButton(this.game.ui.menuButtonLeft),0==this.previousTile&&this.game.ui.addUIButton(this.game.ui.menuButtonLeft,!0,!0),this.currentTile==this.tiles.length-1&&this.game.ui.removeButton(this.game.ui.menuButtonRight),this.previousTile==this.tiles.length-1&&this.game.ui.addUIButton(this.game.ui.menuButtonRight,!0,!0),"empty"==Game.coreData.getPlayerGarageData()[this.currentTile].id?(this.game.ui.removeButton(this.game.ui.deleteButton),this.game.ui.removeButton(this.game.ui.editButton),this.game.ui.removeButton(this.game.ui.raceButton),this.game.ui.addUIButton(this.game.ui.craftButton,!0,!0),1==Game.coreData.getPlayerGarageData().length&&(this.game.ui.removeButton(this.game.ui.menuButtonLeft),this.game.ui.removeButton(this.game.ui.menuButtonRight)),this.flag.scale.set(0,0),this.scissors.scale.set(0,0),this.flag.alpha=0,this.scissors.alpha=0,TweenMax.to(this.scissors.scale,1,{ease:Elastic.easeOut,x:1,y:1,delay:.1}),TweenMax.to(this.scissors,.5,{ease:Expo.easeOut,alpha:1}),this.scissors.position.y=this.game.ui.craftButton.position.y,this.scissors.position.x=this.game.ui.craftButton.position.x+this.game.ui.craftButton.width/2):(this.game.ui.removeButton(this.game.ui.craftButton),this.game.ui.addUIButton(this.game.ui.deleteButton,!0,!0),this.game.ui.addUIButton(this.game.ui.editButton,!0,!0),this.game.ui.addUIButton(this.game.ui.raceButton,!0,!0),this.flag.scale.set(0,0),this.scissors.scale.set(0,0),this.flag.alpha=0,this.scissors.alpha=0,TweenMax.to(this.flag.scale,1,{ease:Elastic.easeOut,x:1,y:1,delay:.1}),TweenMax.to(this.flag,.5,{ease:Expo.easeOut,alpha:1}),TweenMax.to(this.scissors.scale,1,{ease:Elastic.easeOut,x:1,y:1,delay:.1}),TweenMax.to(this.scissors,.5,{ease:Expo.easeOut,alpha:1}),this.scissors.position.y=this.game.ui.editButton.position.y,this.scissors.position.x=this.game.ui.editButton.position.x+50,Game.coreData.setCurrentTeam(Game.coreData.getPlayerGarageData()[this.currentTile].team),this.achievementsPanel.show())},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"edit-button":Game.coreData.editMode=!0,Game.coreData.setCurrentGarageIndex(this.currentTile),Game.coreData.setCurrentCarType(Game.coreData.getPlayerGarageData()[this.currentTile].id),Game.coreData.setCurrentTeam(Game.coreData.getPlayerGarageData()[this.currentTile].team),this.game.setScene("paintScene",!0);break;case"close-button-red":this.game.ui.hidePrompt();break;case"tick-button-green":Game.coreData.removeCarFromGarage(this.currentTile),Game.displayStore.flush(["car-render-texture-"+this.currentTile,"car-render-texture-2-"+this.currentTile,"car-render-texture-race-output-"+this.currentTile,"car-render-texture-craft-output-"+this.currentTile,"car-render-texture-garage-output-"+this.currentTile]);var i=Game.coreData.getCurrentGarageIndex()-1;i<0&&(i=0),Game.coreData.setCurrentGarageIndex(i),Game.coreData.setCurrentTeam(Game.coreData.getPlayerGarageData()[i].team),this.game.ui.hidePrompt(),this.game.setScene("garageScene",!0);break;case"race-button":this.goRace();break;case"craft-button":this.craftNew();break;case"back-button":Game.fadeSound("music-start.mp3",1,0),"empty"==Game.coreData.getPlayerGarageData()[0].id?this.game.setScene("selectTeamScene",!0):this.game.setScene("accessoriesScene",!0);break;case"delete-button":this.game.ui.showPrompt("delete-car")}},e.prototype.goRace=function(){Game.fadeSound("music-start.mp3",1,0),Game.coreData.setCurrentGarageIndex(this.currentTile),Game.coreData.setCurrentCarType(Game.coreData.getPlayerGarageData()[this.currentTile].id),Game.coreData.setCurrentTeam(Game.coreData.getPlayerGarageData()[this.currentTile].team),this.game.setScene("selectTrackScene",!0)},e.prototype.craftNew=function(){Game.coreData.setCurrentGarageIndex(this.currentTile);var t=this;this.game.loadAssets(Game.assetChunkManager.generateLoadChunk("craft"),!0,function(){t.game.setScene("selectTeamScene",!0)})},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.achievementsPanel.destroy(),Game.displayStore.returnAllPooledItems("garage-assets"),console.log(Game.coreData.getPlayerGarageData()),"empty"!=Game.coreData.getPlayerGarageData()[0].id&&Game.saveProgress()},e}(CarouselMenuScene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),AccessoriesScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="accessoriesScene",n}return __extends(e,t),e.prototype.init=function(e){this.titleText=Game.displayStore.getBitmapText("accessories-scene/title-text","accessories-scene-title"),this.titleText.position.set(512-this.titleText.width/2,32),t.prototype.init.call(this),"garageScene"==this.game.lastSceneID&&Game.playSound("music-craft.mp3",.5),Game.stopSound("music-start.mp3"),this.car.setScale(.8),this.car.setPos([100,230]),this.car.createAccessoryAttachPoints(),this.car.showAttachPoints(),this.car.enableCorners(),this.game.ui.setUI("accessories"),this.game.ui.disableButton("undo-button"),this.accessories=Game.coreData.getAccessories(),this.addCoinsPanel(),t.prototype.createTilePanel.call(this,{panel:Game.displayStore.getContainer("accessories-scene/accessories-panel"),items:this.accessories,columns:2,tilesPerPage:6,tileOffset:[0,0],tileRegPoint:[.5,.5],dragItemType:"accessory",prepend:"accessories-scene/"}),this.loadState()},e.prototype.setSelectedMenuItem=function(e){t.prototype.setSelectedMenuItem.call(this,e),this.mainHolder.addChild(this.touchSprite),this.game.ui.enableButton("undo-button"),this.exitDeleteMode(),this.car.showAttachPoints(),Game.playSound("small-pop.mp3"),this.selectedMenuItem.getNewDraggableItem()},e.prototype.touchEnd=function(e,i){this.selectedMenuItem&&(this.car.attachPointHighlighted()?this.addAccessory(this.selectedMenuItem):this.selectedMenuItem.draggableItem.container.visible=!1,this.checkDeleteButtonStatus()),this.mainHolder.addChildAt(this.panelHolder,0),t.prototype.touchEnd.call(this,e,i)},e.prototype.addAccessory=function(t){Game.playSound("sticker-"+Game.getRandom(1,3,!0)+".mp3");var e=t.draggableItem||t.getNewDraggableItem(!0);this.lastAccessory=e,this.car.addAccessory(e,this.car.attachPointHighlighted()),e.draggableItem=null,this.game.ui.enableButton("tick-button")},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"tick-button":this.exitDeleteMode(),this.nextScene();break;case"back-button":this.exitDeleteMode(),this.saveState(),this.game.setScene("wheelsScene");break;case"undo-button":this.exitDeleteMode(),this.undoLastAccessory();break;case"delete-button":this.enterDeleteMode();break;case"close-button-red":this.game.ui.hidePrompt();break;case"tick-button-green":Game.coreData.spendCoins(this.buyingAccessory.price),this.coinsPanel.updateCoins(),this.game.ui.hidePrompt("buy",this.buyingAccessory)}},e.prototype.nextScene=function(){if(1!=this.doingNextScene){t.prototype.nextScene.call(this);var e=this;Game.fadeSound("music-craft.mp3",1,0),e.game.setScene("garageScene",!0)}},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.touchMove=function(e,i){t.prototype.touchMove.call(this,e,i)},e.prototype.promptIsHidden=function(){t.prototype.promptIsHidden.call(this),this.buyingAccessory&&Game.coreData.unlockAccessory(this.buyingAccessory.id),this.buyingAccessory=null,this.container.addChild(this.coinsPanel.container)},e.prototype.buyItem=function(t){this.buyingAccessory=t,this.game.ui.showPrompt("buy-accessory","buy",t),this.uiContainerRef.addChild(this.coinsPanel.container)},e.prototype.checkDeleteButtonStatus=function(){for(var t=!1,e=0;e<this.car.attachPoints.length;e++)this.car.attachPoints[e].attachment&&(t=!0);t?this.game.ui.enableButton("delete-button"):this.game.ui.disableButton("delete-button")},e.prototype.enterDeleteMode=function(){if(1!=this.deleteMode){this.game.ui.disableButton("delete-button"),this.deleteMode=!0;for(var t=0;t<this.car.attachPoints.length;t++){var e=this.car.attachPoints[t].attachment;e&&(e.enterDeleteMode(),e.container.position.copy(this.dragLayer.toLocal(new PIXI.Point,e.container)),this.dragLayer.addChild(e.container))}}},e.prototype.exitDeleteMode=function(){if(0!=this.deleteMode){this.deleteMode=!1,this.car.showMask(!1),this.checkDeleteButtonStatus();for(var t=0;t<this.car.attachPoints.length;t++){var e=this.car.attachPoints[t].attachment;e&&(e.exitDeleteMode(),e.container.position.copy(this.car.innerOutputContainer.toLocal(new PIXI.Point,e.container)),this.car.outputContainer.addChildAt(e.container,0))}}},e.prototype.removeAccessory=function(t){for(var e=0;e<this.car.attachPoints.length;e++)this.car.attachPoints[e].attachment==t&&(this.car.attachPoints[e].attachment==this.lastAccessory&&(this.lastAccessory=null,this.game.ui.disableButton("undo-button")),this.car.attachPoints[e].attachment=null);Game.playSound("sticker-"+Game.getRandom(1,3,!0)+".mp3"),t.destroy(),this.exitDeleteMode()},e.prototype.undoLastAccessory=function(){this.removeAccessory(this.lastAccessory),this.game.ui.disableButton("undo-button"),this.checkDeleteButtonStatus()},e.prototype.tick=function(){t.prototype.tick.call(this),this.selectedMenuItem&&this.car.checkHighlightAttachPoints(this.selectedMenuItem,80)},e.prototype.saveState=function(){var t=this.car.getGarageOutputTexture(),e=t.texture,i=t.offset;Game.coreData.storeCarGarageSprite(e,i);for(var n=[],o=0;o<this.car.attachPoints.length;o++)n[o]={menuTileIndex:null,attachPointIndex:o,id:null},this.car.attachPoints[o].attachment&&(n[o].id=this.car.attachPoints[o].attachment.id,n[o].menuTileIndex=this.car.attachPoints[o].attachment.menuTile.index);Game.coreData.saveAccessories(n)},e.prototype.loadState=function(){var t=Game.coreData.getPlayerCarData().carPaintSprite,e=Game.coreData.getPlayerCarData().carStickersSprite;t.setRegPoint(0,0),e.setRegPoint(0,0),this.car.loadPaintState(t),this.car.render(e),this.car.enableMask();var i=Game.coreData.getPlayerCarData().accessoriesData;if(i)for(var n=0;n<this.car.attachPoints.length;n++)if(void 0!=i[n].menuTileIndex){var o=this.menuTiles[i[n].menuTileIndex].getNewDraggableItem(!0);this.car.addAccessory(o,this.car.attachPoints[n])}this.checkDeleteButtonStatus(),this.car.loadWheels()},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){this.saveState(),t.prototype.destroy.call(this),Game.displayStore.returnAllPooledItems("accessories-assets")},e}(CraftScene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),WheelsScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="wheelsScene",n}return __extends(e,t),e.prototype.init=function(e){this.titleText=Game.displayStore.getBitmapText("wheels-scene/title-text","wheels-scene-title"),this.titleText.position.set(512-this.titleText.width/2,32),t.prototype.init.call(this),this.car.setPos([45,140]),this.car.createWheelAttachPoints(),this.game.ui.setUI("wheels"),this.game.ui.disableButton("tick-button"),this.wheels=Game.coreData.getWheels(),this.addCoinsPanel(),t.prototype.createTilePanel.call(this,{panel:Game.displayStore.getContainer("wheels-scene/wheels-panel"),items:this.wheels,columns:2,tilesPerPage:6,tileOffset:[0,0],tileRegPoint:[.5,.5],dragItemType:"wheel",prepend:"wheels-scene/"}),this.metersContainer=Game.displayStore.getContainer("craft-scene/meters-container"),this.meters=[];for(var i=[{title:"meter-acceleration",type:"acceleration"},{title:"meter-agility",type:"agility"},{title:"meter-bashability",type:"bashability"}],n=0;n<3;n++){var o=new Meter(this,n,[170+220*n,490],i[n].title,i[n].type);this.metersContainer.addChild(o.container),this.meters.push(o)}this.container.addChild(this.metersContainer),this.loadState()},e.prototype.setSelectedMenuItem=function(e){t.prototype.setSelectedMenuItem.call(this,e),this.mainHolder.addChild(this.touchSprite),this.car.showAttachPoints(),Game.playSound("small-pop.mp3"),this.selectedMenuItem.getNewDraggableItem()},e.prototype.touchEnd=function(e,i){this.selectedMenuItem&&(this.car.attachPointHighlighted()?(this.car.clearAllAttachments(),this.addWheels(this.selectedMenuItem),this.currentWheelSelection=this.selectedMenuItem.id):this.selectedMenuItem.draggableItem.container.visible=!1),this.mainHolder.addChildAt(this.panelHolder,0),t.prototype.touchEnd.call(this,e,i)},e.prototype.addWheels=function(t){Game.playSound("fit-wheels-"+Game.getRandom(1,2,!0)+".mp3");for(var e=t.getNewDraggableItem(!0),i=t.draggableItem||t.getNewDraggableItem(!0),n=0;n<this.menuTiles.length;n++)this.menuTiles[n].hideSelected();t.showSelected(),this.dragLayer.addChild(e.container),this.car.addWheel(e,this.car.attachPoints[0]),this.car.addWheel(i,this.car.attachPoints[1]),i.draggableItem=null,"purple-stock"!=t.id&&Game.coreData.unlockAchievement("buy-new-wheels"),this.setMeters(t.id),this.game.ui.enableButton("tick-button")},e.prototype.setMeters=function(t,e){for(var i=0;i<this.meters.length;i++)this.meters[i].setValue(t,e)},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"tick-button":this.nextScene();break;case"back-button":this.saveState(),this.game.setScene("stickersScene");break;case"close-button-red":this.buyingWheels=null,this.game.ui.hidePrompt();break;case"tick-button-green":Game.coreData.spendCoins(this.buyingWheels.price),this.coinsPanel.updateCoins(),this.game.ui.hidePrompt("buy",this.buyingWheels)}},e.prototype.coinsAreUpdated=function(){t.prototype.coinsAreUpdated.call(this)},e.prototype.hidePrompt=function(){t.prototype.hidePrompt.call(this),null==this.buyingWheels&&this.setMeters(this.currentWheelSelection)},e.prototype.promptIsHidden=function(){t.prototype.promptIsHidden.call(this),this.buyingWheels&&(this.car.clearAllAttachments(),this.addWheels(this.buyingWheels),Game.coreData.unlockWheels(this.buyingWheels.id),this.currentWheelSelection=this.buyingWheels.id,this.buyingWheels=null),this.container.addChild(this.coinsPanel.container),this.container.addChild(this.metersContainer)},e.prototype.buyItem=function(t){this.buyingWheels=t,this.currentWheelSelection?this.setMeters(t.id,!0):this.setMeters(t.id),this.game.ui.showPrompt("buy-wheels","buy",t),this.uiContainerRef.addChild(this.coinsPanel.container),this.uiContainerRef.addChild(this.metersContainer)},e.prototype.nextScene=function(){if(1!=this.doingNextScene){t.prototype.nextScene.call(this);var e=this;e.saveState(),e.game.setScene("accessoriesScene")}},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.touchMove=function(e,i){t.prototype.touchMove.call(this,e,i)},e.prototype.tick=function(){t.prototype.tick.call(this),this.selectedMenuItem&&this.car.checkHighlightAttachPoints(this.selectedMenuItem,150)},e.prototype.saveState=function(){Game.coreData.storeWheelChoice(this.currentWheelSelection);var t=this.car.getRaceOutputTexture();Game.coreData.storeCarRaceSprite(t)},e.prototype.loadState=function(){var t=Game.coreData.getPlayerCarData().carPaintSprite,e=Game.coreData.getPlayerCarData().carStickersSprite;if(t.setRegPoint(0,0),e.setRegPoint(0,0),this.car.loadPaintState(t),this.car.render(e),this.car.enableMask(),this.currentWheelSelection=Game.coreData.getPlayerCarData().wheelChoice,this.currentWheelSelection){for(var i=0;i<this.menuTiles.length;i++)if(this.menuTiles[i].id==this.currentWheelSelection)var n=this.menuTiles[i];this.addWheels(n)}},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.displayStore.returnAllPooledItems("wheels-assets");for(var e=0;e<this.meters.length;e++)this.meters[e].destroy()},e}(CraftScene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),AchievementsScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="achievementsScene",n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.lastSceneID=e[0],this.targetPosition=0,this.smoothing=1,this.panels=[],this.container.addChild(Game.displayStore.getSprite("achievements-scene/bg")),this.game.ui.setUI("achievements"),this.titleText=Game.displayStore.getBitmapText("achievements-scene/title-text","achievements-scene-title"),this.titleText.position.set(512-this.titleText.width/2,32),this.titleText.align="center",this.titleText.tint=16771584,this.container.addChild(this.titleText),this.listContainer=Game.displayStore.getContainer("achievements-scene/list-container"),this.container.addChild(this.listContainer),this.startingPosition=this.listContainer.position.y,this.createAchievementsList(),this.listMask=new PIXI.Graphics,this.listMask.beginFill(1193046,1),this.listMask.drawRect(175,120,700,500),this.listMask.endFill(),this.listContainer.mask=this.listMask,this.container.addChild(this.listMask),this.achievementsPanel=new AchievementsTallyPanel(this),this.container.addChild(this.achievementsPanel.container),this.achievementsPanel.show(),this.touchSprite=Game.displayStore.getSprite("achievements-scene/blank-input"),this.touchSprite.width=Game.stageWidth,this.touchSprite.height=Game.stageHeight,this.touchSprite.alpha=0,this.touchSprite.interactive=!0,this.container.addChild(this.touchSprite),this.container.interactive=!0,this.listContainer.position.y=this.targetPosition=this.minY,this.tick(),TweenMax.delayedCall(.5,function(){this.smoothing=20,this.targetPosition=0,this.addInteraction()},null,this)},e.prototype.createAchievementsList=function(){this.maxY=0;var t=Game.coreData.getCurrentTeam();void 0==t&&(t="scooby");for(var e=Game.coreData.getAchievements(t),i=e.length,n=0;n<i;n++){var o=new AchievementPanel(this,e[n]);o.container.position.x=Game.stageWidth/2,o.container.position.y=210+140*n,this.listContainer.addChild(o.container),this.minY=500-o.container.position.y,this.panels.push(o)}},e.prototype.addInteraction=function(){var t=this,e=this.touchSprite;this.touching=!1,this.currentTouchPoint=new PIXI.Point,this.startTouchPoint=new PIXI.Point,Game.onDesktop?(e.on("mousedown",function(e){t.touchStart(t,e)}),e.on("mouseup",function(e){t.touchEnd(t,e)}),e.on("mouseupoutside",function(e){t.touchEndOutside(t,e)}),e.on("mousemove",function(e){t.touchMove(t,e)})):(e.on("touchstart",function(e){t.touchStart(t,e)}),e.on("touchend",function(e){t.touchEnd(t,e)}),e.on("touchendoutside",function(e){t.touchEndOutside(t,e)}),e.on("touchmove",function(e){t.touchMove(t,e)}))},e.prototype.touchStart=function(t,e){t.touching=!0,this.startingPosition=this.listContainer.position.y,t.currentTouchPoint.x=t.startTouchPoint.x=e.data.getLocalPosition(t.container).x,t.currentTouchPoint.y=t.startTouchPoint.y=e.data.getLocalPosition(t.container).y,console.log("touch start"),this.smoothing=3},e.prototype.touchMove=function(t,e){0!=this.touching&&(t.currentTouchPoint.x=e.data.getLocalPosition(t.container).x,t.currentTouchPoint.y=e.data.getLocalPosition(t.container).y,console.log("touch move"))},e.prototype.touchEnd=function(t,e){t.touching=!1,console.log("touch end"),this.listContainer.position.y<this.minY&&(this.targetPosition=this.minY),this.listContainer.position.y>this.maxY&&(this.targetPosition=this.maxY),this.smoothing=10},e.prototype.touchEndOutside=function(t,e){t.touching=!1,this.listContainer.position.y<this.minY&&(this.targetPosition=this.minY),this.listContainer.position.y>this.maxY&&(this.targetPosition=this.maxY),this.smoothing=10},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"back-button":console.log(this.lastSceneID),this.game.setScene(this.lastSceneID)}},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this),1==this.touching&&(this.targetPosition=this.startingPosition+(this.currentTouchPoint.y-this.startTouchPoint.y)),this.listContainer.position.y+=(this.targetPosition-this.listContainer.position.y)/this.smoothing},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.achievementsPanel.destroy();for(var e=0;e<this.panels.length;e++)this.panels[e].destroy();Game.displayStore.returnAllPooledItems("achievements-assets")},e}(Scene),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),SelectTrackScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="selectTrackScene",n}return __extends(e,t),e.prototype.init=function(t){this.game.ui.setUI("select-track"),this.tiles=[],this.coins=[],this.doingNextScene=!1,Game.stopSound("music-start.mp3"),e.trackData=[{angle:-2.1,coins:1},{angle:-.9,coins:2},{angle:-.25,coins:3}],this.container.addChild(Game.displayStore.getSprite("select-track-scene/bg")),this.titleText=Game.displayStore.getBitmapText("select-track-scene/title-text","select-track-scene-title"),this.titleText.position.set(512-this.titleText.width/2,24),this.titleText.align="center",this.titleText.tint=16771584,this.currentTile=0,this.previousTile=0,this.container.addChild(this.titleText),this.touchSprite=Game.displayStore.getSprite("global/pixel.png"),this.touchSprite.width=700,this.touchSprite.height=400,this.touchSprite.alpha=0,this.touchSprite.position.set(Game.stageWidth/2,Game.stageHeight/2),this.touchSprite.interactive=!0,this.tileStrip=Game.displayStore.getContainer("select-track-scene/tile-strip"),this.tileStrip.position.x=Game.stageWidth/2,this.tileStrip.position.y=Game.stageHeight/2+10,this.container.addChild(this.tileStrip);for(r=0;r<3;r++){var i=this.tileStrip.getSprite("select-track-scene/track-"+(r+1)),n=Game.displayStore.getBitmapText("select-track-scene/panel-text","track-title-"+(r+1));n.position.x=-n.width/2,n.position.y=108,n.tint=16771584;var o=Game.displayStore.getContainer("select-track-scene/tile-holder");o.addChild(i),o.addChild(n),o.position.x=r*e.tileSpacing,this.tiles.push(o),this.tileStrip.addChild(o)}this.createCorners(),this.bottomPanel=Game.displayStore.getContainer("select-track-scene/bottom-panel"),this.bottomPanel.position.set(Game.stageWidth/2-10,660),this.container.addChild(this.bottomPanel),this.gauge=this.bottomPanel.getContainer("select-track-scene/rev-gauge"),this.glows=this.bottomPanel.getContainer("select-track-scene/rev-gauge-glows"),this.needle=this.bottomPanel.getSprite("select-track-scene/rev-needle.png");for(var r=0;r<3;r++){var a=Game.displayStore.getContainer("select-track-scene/coin-holder"),s=Game.displayStore.getSprite("select-track-scene/coin"),l=Game.displayStore.getSprite("select-track-scene/coin-space.png");a.addChild(l),a.addChild(s),a.position.x=5+65*r,a.position.y=-105,this.coins.push(s),this.bottomPanel.addChild(a)}var c=new AchievementsTallyPanel(this);this.container.addChild(c.container),c.show(),this.goToTile(this.tiles.length-1,!0),this.goToTile(0),TweenMax.delayedCall(.4,this.enableCorners,null,this),this.container.addChild(this.touchSprite),this.addInteraction()},e.prototype.addInteraction=function(){var t=this,e=this.touchSprite;Game.onDesktop?e.on("mousedown",function(e){t.touchStart(t,e)}):e.on("touchstart",function(e){t.touchStart(t,e)})},e.prototype.touchStart=function(t,e){1!=this.doingNextScene&&this.nextScene()},e.prototype.goToTile=function(t,i){if(this.moveAnimation=this.killTween(this.moveAnimation),this.moveAnimation=new TimelineMax,i)this.tileStrip.position.x=-e.tileSpacing*t+Game.stageWidth/2;else{var n=-e.tileSpacing*t+Game.stageWidth/2;this.moveAnimation.add(TweenMax.to(this.tileStrip.position,.2,{x:.7*n,ease:Power1.easeIn})),this.moveAnimation.add(TweenMax.to(this.tileStrip.position,.6,{x:n,ease:Elastic.easeOut}),.2)}if(Game.stopSound("select-track-living-room.mp3"),Game.stopSound("select-track-bathroom.mp3"),Game.stopSound("select-track-garage.mp3"),Game.playSound("select-track-"+CoreData.tracks[t]+".mp3",.7),this.currentTile=t,i)this.previousTile=this.currentTile,this.needle.rotation=e.trackData[t].angle;else{Game.playSound("swipe-"+Game.getRandom(1,2)+".mp3"),this.moveAnimation.call(function(){this.previousTile=this.currentTile,this.glows.showOnlyChild(t)},null,this,.1),this.moveAnimation.add(TweenMax.to(this.needle,1,{rotation:e.trackData[t].angle,ease:Elastic.easeOut}),0);for(var o=0;o<this.coins.length;o++){var r=this.coins[o];r.scale.set(0,0),o<e.trackData[t].coins&&this.moveAnimation.add(TweenMax.to(r.scale,.5,{x:1,y:1,ease:Elastic.easeOut}),o/10)}this.popCorners()}0==this.currentTile&&this.game.ui.removeButton(this.game.ui.menuButtonLeft),0==this.previousTile&&this.game.ui.addUIButton(this.game.ui.menuButtonLeft,!0,!0),this.currentTile==this.tiles.length-1&&this.game.ui.removeButton(this.game.ui.menuButtonRight),this.previousTile==this.tiles.length-1&&this.game.ui.addUIButton(this.game.ui.menuButtonRight,!0,!0)},e.prototype.nextTile=function(){this.currentTile!=this.tiles.length-1&&(this.currentTile++,this.goToTile(this.currentTile))},e.prototype.prevTile=function(){0!=this.currentTile&&(this.currentTile--,this.goToTile(this.currentTile))},e.prototype.createCorners=function(){this.corners=[],this.cornerContainer=Game.displayStore.getContainer("carousel-menu/highlight-corner-container"),this.cornerContainer.position.set(Game.stageWidth/2,Game.stageHeight/2);for(var t=[{scale:new PIXI.Point(1,1),pos:new PIXI.Point(-305,-185)},{scale:new PIXI.Point(-1,1),pos:new PIXI.Point(305,-185)},{scale:new PIXI.Point(1,-1),pos:new PIXI.Point(-305,200)},{scale:new PIXI.Point(-1,-1),pos:new PIXI.Point(305,200)}],e=0;e<4;e++){var i=Game.displayStore.getSprite("carousel-menu/highlight-corner.png");i.scale.x=t[e].scale.x,i.scale.y=t[e].scale.y,i.position=t[e].pos,this.corners.push(i),this.corners[e].alpha=0,this.cornerContainer.addChild(this.corners[e])}this.container.addChild(this.cornerContainer)},e.prototype.enableCorners=function(){for(var t=(this.corners[1].position.x-this.corners[0].position.x)/(this.corners[2].position.y-this.corners[0].position.y),e=0;e<this.corners.length;e++)TweenMax.to(this.corners[e],.7,{alpha:1,ease:Power2.easeOut});TweenMax.from(this.corners[0].position,.7,{x:"+="+String(100),y:"+="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[1].position,.7,{x:"-="+String(100),y:"+="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[2].position,.7,{x:"+="+String(100),y:"-="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[3].position,.7,{x:"-="+String(100),y:"-="+String(100*t),ease:Elastic.easeOut})},e.prototype.popCorners=function(){var t=this.corners[1].position.x-this.corners[0].position.x,e=(this.corners[2].position.y-this.corners[0].position.y)/t;TweenMax.to(this.corners[0].position,.1,{x:"-="+String(20),y:"-="+String(20*e),ease:Power1.easeOut}),TweenMax.to(this.corners[1].position,.1,{x:"+="+String(20),y:"-="+String(20*e),ease:Power1.easeOut}),TweenMax.to(this.corners[2].position,.1,{x:"-="+String(20),y:"+="+String(20*e),ease:Power1.easeOut}),TweenMax.to(this.corners[3].position,.1,{x:"+="+String(20),y:"+="+String(20*e),ease:Power1.easeOut}),TweenMax.to(this.corners[0].position,.5,{x:"+="+String(20),y:"+="+String(20*e),ease:Elastic.easeOut,delay:.1}),TweenMax.to(this.corners[1].position,.5,{x:"-="+String(20),y:"+="+String(20*e),ease:Elastic.easeOut,delay:.1}),TweenMax.to(this.corners[2].position,.5,{x:"+="+String(20),y:"-="+String(20*e),ease:Elastic.easeOut,delay:.1}),TweenMax.to(this.corners[3].position,.5,{x:"-="+String(20),y:"-="+String(20*e),ease:Elastic.easeOut,delay:.1})},e.prototype.uiClicked=function(e){if(t.prototype.uiClicked.call(this,e),1!=this.interactionLocked)switch(e.id){case"back-button":this.game.setScene("garageScene",!0);break;case"menu-button-left":this.prevTile();break;case"menu-button-right":this.nextTile()}},e.prototype.nextScene=function(){Game.playSound("select-track.mp3"),Game.stopSound("select-track-living-room.mp3"),Game.stopSound("select-track-bathroom.mp3"),Game.stopSound("select-track-garage.mp3"),this.doingNextScene=!0,Game.playSound("button-click-ui.mp3"),this.popCorners(),TweenMax.to(this.tiles[this.currentTile].scale,.2,{x:.9,y:.9,ease:Power3.easeIn,repeat:1,yoyo:!0}),TweenMax.delayedCall(.4,function(){var t=this;Game.coreData.setCurrentTrack(this.currentTile),this.game.loadAssets(Game.assetChunkManager.generateLoadChunk("race"),!0,function(){t.game.setScene("raceScene",!0)})},null,this)},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this);for(var i=0;i<this.tiles.length;i++){var n=this.tiles[i],o=Math.abs(this.container.toLocal(new PIXI.Point,n).x-Game.stageWidth/2);0==this.doingNextScene&&(n.scale.x=n.scale.y=1-o/(e.tileSpacing*(this.tiles.length-1)*2))}},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.touchSprite.removeAllListeners(),Game.stopSound("select-track-living-room.mp3"),Game.stopSound("select-track-bathroom.mp3"),Game.stopSound("select-track-garage.mp3"),Game.displayStore.returnAllPooledItems("select-track-assets"),Game.displayStore.returnAllPooledItems("carousel-menu-assets"),Game.displayStore.returnPooledItem(this.touchSprite)},e.tileSpacing=600,e}(Scene),CoreData=function(){function t(t){this.trackAssets={"living-room":["race-scene/living-room/cactus-1.png","race-scene/living-room/cactus-2.png","race-scene/living-room/bush-1.png","race-scene/living-room/bush-2.png","race-scene/living-room/bush-3.png","race-scene/living-room/bush-4.png"],bathroom:["race-scene/bathroom/tree-1.png","race-scene/bathroom/tree-2.png","race-scene/bathroom/iceberg-1.png","race-scene/bathroom/iceberg-2.png","race-scene/bathroom/snowman.png","race-scene/bathroom/igloo.png"],garage:["race-scene/garage/hedge.png","race-scene/garage/cone.png","race-scene/garage/traffic-light.png","race-scene/garage/warning-sign.png","race-scene/garage/lamp-post.png","race-scene/garage/tree.png"]},this.currentTrack="garage",this.firstTime=!0,this.game=t,this.setDefaults(),this.trackedAchievements={"win-three-races":[{value:0}],"complete-all-races-no-bomb-hit":[{garage:!1,livingroom:!1,bathroom:!1}]}}return t.prototype.setDefaults=function(){this.playerGarage=[],this.currentCoins=0,console.log("setting defaults"),this.populateGarage("empty"),this.editMode=!1,this.currentGarageIndex=0,this.playerAchievements={tweety:[],tom:[],bugs:[],scooby:[],wile:[]},this.achievements={scooby:[{id:"paint-car",locked:!0,stickerID:"van-logo"},{id:"use-power-up",locked:!0,stickerID:"scooby"},{id:"use-three-ramps",locked:!0,stickerID:"fred"},{id:"create-custom-car",locked:!0,stickerID:"daphne"},{id:"win-no-obstacle-hit",locked:!0,stickerID:"thelma"},{id:"bash-opponent-into-obstacle",locked:!0,stickerID:"zombie"},{id:"unlock-scooby-snack-attachment",locked:!0,stickerID:"shaggy"},{id:"unlock-all-achievements",locked:!0,stickerID:"van"},{id:"knock-out-tom-and-sylvester",locked:!0,stickerID:"duo"},{id:"knock-out-opponent-before-finish-line",locked:!0,stickerID:"wolf"}],tweety:[{id:"paint-car",locked:!0,stickerID:"tweety-wink"},{id:"use-power-up",locked:!0,stickerID:"slyvester-laugh"},{id:"use-three-ramps",locked:!0,stickerID:"slyvester-point"},{id:"attach-4-sylvester-stickers",locked:!0,stickerID:"slyvester-stars"},{id:"win-no-obstacle-hit",locked:!0,stickerID:"tweety-prone"},{id:"bash-opponent-into-obstacle",locked:!0,stickerID:"tweety-hammer"},{id:"knock-out-tom",locked:!0,stickerID:"slyvester-scream"},{id:"unlock-all-achievements",locked:!0,stickerID:"tweety-halo"},{id:"hit-10-obsticles-win-garage",locked:!0,stickerID:"slyvester-run"},{id:"wings-equiped-10-jumps",locked:!0,stickerID:"tweety-shrug"}],tom:[{id:"paint-car",locked:!0,stickerID:"jerry-cymbals"},{id:"use-power-up",locked:!0,stickerID:"tom-run"},{id:"use-three-ramps",locked:!0,stickerID:"jerry-chicken"},{id:"win-no-obstacle-hit",locked:!0,stickerID:"jerry-book"},{id:"bash-opponent-into-obstacle",locked:!0,stickerID:"tom-head"},{id:"unlock-cheese-wedge",locked:!0,stickerID:"jerry"},{id:"knock-out-tweety",locked:!0,stickerID:"tom-prone"},{id:"unlock-all-achievements",locked:!0,stickerID:"logo"},{id:"win-three-races-in-row",locked:!0,stickerID:"tom-face"},{id:"hit-3-bombs-and-win",locked:!0,stickerID:"jerry-trap"}],bugs:[{id:"paint-car",locked:!0,stickerID:"daffy-face"},{id:"use-power-up",locked:!0,stickerID:"daffy-evil"},{id:"use-three-ramps",locked:!0,stickerID:"daffy-hunch"},{id:"win-no-obstacle-hit",locked:!0,stickerID:"bugs-relax"},{id:"bash-opponent-into-obstacle",locked:!0,stickerID:"daffy-shrug"},{id:"buy-new-wheels",locked:!0,stickerID:"bugs-handrest"},{id:"use-boost-to-overtake",locked:!0,stickerID:"bugs-run"},{id:"unlock-all-achievements",locked:!0,stickerID:"daffy-tongue"},{id:"knock-out-scooby",locked:!0,stickerID:"bugs-chuckle"},{id:"complete-all-races-no-bomb-hit",locked:!0,stickerID:"bugs-carrot"}],wile:[{id:"paint-car",locked:!0,stickerID:"wile-drop"},{id:"use-power-up",locked:!0,stickerID:"wile-crazy"},{id:"use-three-ramps",locked:!0,stickerID:"road-jump"},{id:"attach-3-cacti",locked:!0,stickerID:"road-taunt"},{id:"win-no-obstacle-hit",locked:!0,stickerID:"road-head"},{id:"bash-opponent-into-obstacle",locked:!0,stickerID:"road-legs"},{id:"equip-tnt-and-rocket-and-bash-into-bomb",locked:!0,stickerID:"wile-dynamite"},{id:"unlock-all-achievements",locked:!0,stickerID:"wile-hungry"},{id:"knock-out-all-opponents",locked:!0,stickerID:"wile-menace"},{id:"finish-garage-under-60-seconds",locked:!0,stickerID:"road-run"}]},this.accessories={scooby:[{id:"scooby-tail",locked:!1,price:10},{id:"scooby-tag",locked:!0,price:20},{id:"scooby-magnifying-glass",locked:!0,price:20},{id:"scooby-ghost",locked:!0,price:30},{id:"scooby-snacks",locked:!0,price:40}],tweety:[{id:"tweety-tail",locked:!1,price:10},{id:"tweety-ears",locked:!0,price:20},{id:"tweety-halo",locked:!0,price:30},{id:"tweety-hammer",locked:!0,price:30},{id:"tweety-wings",locked:!0,price:40}],bugs:[{id:"bugs-tail",locked:!1,price:10},{id:"bugs-ears",locked:!0,price:20},{id:"bugs-cowboy-hat",locked:!0,price:30},{id:"bugs-bomb",locked:!0,price:30},{id:"bugs-carrot",locked:!0,price:40}],tom:[{id:"tom-tail",locked:!1,price:10},{id:"tom-jerry-ear",locked:!0,price:20},{id:"tom-chefs-hat",locked:!0,price:30},{id:"tom-trap",locked:!0,price:30},{id:"tom-cheese",locked:!0,price:40}],wile:[{id:"wile-tail",locked:!1,price:10},{id:"wile-cactus",locked:!0,price:20},{id:"wile-tnt",locked:!0,price:30},{id:"wile-boxing",locked:!0,price:30},{id:"wile-rocket",locked:!0,price:40}]},this.trackWheels={"living-room":["purple-stock","green-mini","micro","offroad"],bathroom:["silver-speeders","micro","offroad","whitewall","monster"],garage:["silver-speeders","offroad","whitewall","blue-superspeed","monster"]},this.wheels=[{id:"purple-stock",locked:!1,price:10},{id:"green-mini",locked:!0,price:25},{id:"micro",locked:!0,price:40},{id:"silver-speeders",locked:!0,price:50},{id:"offroad",locked:!0,price:70},{id:"whitewall",locked:!0,price:80},{id:"monster",locked:!0,price:90},{id:"blue-superspeed",locked:!0,price:100}],this.stickers={scooby:[{id:"van-logo",locked:!0},{id:"scooby",locked:!0},{id:"fred",locked:!0},{id:"daphne",locked:!0},{id:"shaggy",locked:!0},{id:"thelma",locked:!0},{id:"zombie",locked:!0},{id:"duo",locked:!0},{id:"van",locked:!0},{id:"wolf",locked:!0}],tom:[{id:"jerry-cymbals",locked:!0},{id:"tom-run",locked:!0},{id:"jerry-chicken",locked:!0},{id:"jerry-book",locked:!0},{id:"tom-head",locked:!0},{id:"jerry",locked:!0},{id:"tom-prone",locked:!0},{id:"logo",locked:!0},{id:"tom-face",locked:!0},{id:"jerry-trap",locked:!0}],bugs:[{id:"daffy-face",locked:!0},{id:"daffy-evil",locked:!0},{id:"daffy-hunch",locked:!0},{id:"bugs-relax",locked:!0},{id:"bugs-handrest",locked:!0},{id:"bugs-run",locked:!0},{id:"daffy-shrug",locked:!0},{id:"daffy-tongue",locked:!0},{id:"bugs-chuckle",locked:!0},{id:"bugs-carrot",locked:!0}],tweety:[{id:"tweety-wink",locked:!0},{id:"slyvester-laugh",locked:!0},{id:"slyvester-point",locked:!0},{id:"slyvester-stars",locked:!0},{id:"tweety-prone",locked:!0},{id:"tweety-hammer",locked:!0},{id:"slyvester-scream",locked:!0},{id:"slyvester-run",locked:!0},{id:"tweety-halo",locked:!0},{id:"tweety-shrug",locked:!0}],wile:[{id:"wile-drop",locked:!0},{id:"wile-crazy",locked:!0},{id:"road-taunt",locked:!0},{id:"road-jump",locked:!0},{id:"road-head",locked:!0},{id:"road-legs",locked:!0},{id:"wile-dynamite",locked:!0},{id:"wile-hungry",locked:!0},{id:"road-run",locked:!0},{id:"wile-menace",locked:!0}]}},t.prototype.getTrackAssets=function(t){return this.trackAssets[t]},t.prototype.setCurrentTrack=function(e){this.currentTrack=t.tracks[e]},t.prototype.getCurrentTrack=function(){return this.currentTrack},t.prototype.getAchievements=function(t){var e=t||this.currentTeam;return this.achievements[e]},t.prototype.restorePlayerAchievements=function(t){this.playerAchievements=t},t.prototype.restoreAchievements=function(t){this.achievements=t},t.prototype.restoreWheels=function(t){this.wheels=t},t.prototype.restoreStickers=function(t){this.stickers=t},t.prototype.restoreAccessories=function(t){this.accessories=t},t.prototype.getAchievementWithStickerID=function(t){for(var e,i=0;i<this.achievements[this.currentTeam].length;i++)this.achievements[this.currentTeam][i].stickerID==t&&(e=this.achievements[this.currentTeam][i].id);return e},t.prototype.getPlayerAchievements=function(t){var e=t||this.currentTeam;return this.playerAchievements[e]},t.prototype.getCarTypeHoleOffset=function(e){for(var i=0;i<t.cars.length;i++)if(t.cars[i].id==e)return t.cars[i].holeOffset;return[330,30]},t.prototype.setCurrentCoins=function(t){this.currentCoins=t},t.prototype.getCurrentCoins=function(){return this.currentCoins},t.prototype.setCurrentCarType=function(t){this.currentCarType=t},t.prototype.getCurrentCarType=function(){return this.currentCarType},t.prototype.setCurrentTeam=function(t){this.currentTeam=t},t.prototype.getCurrentTeam=function(){return this.currentTeam},t.prototype.getCurrentTeamIndex=function(){for(var e,i=0;i<t.teams.length;i++)t.teams[i].id==this.currentTeam&&(e=i);return e},t.prototype.getCurrentCarIndex=function(){for(var e,i=0;i<t.cars.length;i++)t.cars[i].id==this.currentCarType&&(e=i);return e},t.prototype.setCurrentGarageIndex=function(t){this.currentGarageIndex=t},t.prototype.getCurrentGarageIndex=function(){return this.currentGarageIndex},t.prototype.populateGarage=function(t){this.playerGarage.push({id:t,team:null,carPaintSprite:null,carRaceSprite:null,carStickersSprite:null,carGarageSprite:null,carGarageOffset:[0,0],stickerData:null,accessoriesData:null,wheelChoice:"purple-stock"})},t.prototype.clearPlayerData=function(){for(var t=0;t<this.playerGarage.length;t++){var e=this.playerGarage[t];e.carPaintSprite=null,e.carRaceSprite=null,e.carStickersSprite=null,e.carGarageSprite=null,e.carGarageOffset=[0,0],e.stickerData=null,e.accessoriesData=null,e.wheelChoice="purple-stock"}this.playerGarage=[],this.setDefaults()},t.prototype.addCarToGarage=function(t){this.playerGarage[this.currentGarageIndex].id=t,this.playerGarage[this.currentGarageIndex].team=Game.coreData.currentTeam,this.setCurrentGarageIndex(this.currentGarageIndex),this.setCurrentCarType(t)},t.prototype.removeCarFromGarage=function(t){this.playerGarage.splice(t,1)},t.prototype.storeCarPaintSprite=function(t){Game.displayStore.flush(["car-paint-sprite-"+this.currentGarageIndex]);var e=this.playerGarage[this.currentGarageIndex];e.carPaintSprite=new Sprite(t),e.carPaintSprite.group="car-sprite-"+this.currentGarageIndex,Game.displayStore.addSprite(e.carPaintSprite)},t.prototype.storeCarRaceSprite=function(t){Game.displayStore.flush(["car-race-sprite-"+this.currentGarageIndex]);var e=this.playerGarage[this.currentGarageIndex];e.carRaceSprite=new Sprite3d(t),e.carRaceSprite.group="car-race-sprite-"+this.currentGarageIndex,Game.displayStore.addSprite(e.carRaceSprite),e.carRaceSprite.setRegPoint(.5,1)},t.prototype.storeCarStickersSprite=function(t){Game.displayStore.flush(["car-stickers-sprite-"+this.currentGarageIndex]);var e=this.playerGarage[this.currentGarageIndex];e.carStickersSprite=new Sprite(t),e.carStickersSprite.group="car-stickers-sprite-"+this.currentGarageIndex,Game.displayStore.addSprite(e.carStickersSprite),e.carStickersSprite.setRegPoint(.5,1)},t.prototype.storeCarGarageSprite=function(t,e){Game.displayStore.flush(["car-garage-sprite-"+this.currentGarageIndex]);var i=this.playerGarage[this.currentGarageIndex];i.carGarageSprite=new Sprite(t),i.carGarageSprite.group="car-garage-sprite-"+this.currentGarageIndex,Game.displayStore.addSprite(i.carGarageSprite),i.carGarageOffset=e},t.prototype.spendCoins=function(t){this.currentCoins>=t?this.currentCoins-=t:console.log("trying to spend "+t)},t.prototype.unlockWheels=function(t){for(var e=0;e<this.wheels.length;e++)this.wheels[e].id==t&&(this.wheels[e].locked=!1)},t.prototype.unlockAccessory=function(t){for(var e=0;e<this.accessories[this.currentTeam].length;e++)this.accessories[this.currentTeam][e].id==t&&(this.accessories[this.currentTeam][e].locked=!1)},t.prototype.getLevelWheels=function(t){return this.trackWheels[t]},t.prototype.getStickers=function(t){return this.stickers[t]},t.prototype.getWheels=function(){return this.wheels},t.prototype.getAccessories=function(){return this.accessories[this.currentTeam]},t.prototype.getRandomAccessory=function(t){return this.accessories[t][Game.getRandom(0,this.accessories[t].length-1,!0)].id},t.prototype.saveStickers=function(t){this.playerGarage[this.currentGarageIndex].stickerData=[];for(var e=0;e<t.length;e++)this.playerGarage[this.currentGarageIndex].stickerData.push({menuTileIndex:t[e].menuTileIndex,pos:[t[e].pos[0],t[e].pos[1]]})},t.prototype.getPlayerGarageData=function(){return this.playerGarage},t.prototype.getPlayerCarData=function(){return this.playerGarage[this.currentGarageIndex]},t.prototype.clearPlayerCarCraftData=function(){this.playerGarage[this.currentGarageIndex].carPaintSprite=null,this.playerGarage[this.currentGarageIndex].carRaceSprite=null,this.playerGarage[this.currentGarageIndex].carStickersSprite=null,this.playerGarage[this.currentGarageIndex].carGarageSprite=null,this.playerGarage[this.currentGarageIndex].carGarageOffset=[0,0],this.playerGarage[this.currentGarageIndex].stickerData=null,this.playerGarage[this.currentGarageIndex].accessoriesData=null,this.playerGarage[this.currentGarageIndex].wheelChoice="purple-stock"},t.prototype.saveAccessories=function(t){this.playerGarage[this.currentGarageIndex].accessoriesData=[];for(var e=0;e<t.length;e++)this.playerGarage[this.currentGarageIndex].accessoriesData.push({menuTileIndex:t[e].menuTileIndex,attachPointIndex:t[e].attachPointIndex,id:t[e].id})},t.prototype.storeWheelChoice=function(t){this.playerGarage[this.currentGarageIndex].wheelChoice=t},t.prototype.unlockAchievement=function(t){var e=Game.coreData.getCurrentTeam();void 0==e&&(e="scooby");for(var i=this.getAchievements(e),n=0;n<i.length;n++){var o=!0;i[n].id==t&&1==i[n].locked&&(i[n].locked=!1,this.unlockSticker(i[n].stickerID,this.getStickers(e)),this.game.ui.showAchievementPopup(i[n]),this.playerAchievements[e].push(i[n].id),o=!1),n==i.length&&1==o&&Game.coreData.unlockAchievement("unlock-all-achievements")}},t.prototype.unlockSticker=function(t,e){for(var i=0;i<e.length;i++)e[i].id==t&&(e[i].locked=!1)},t.prototype.setGameTutorialViewed=function(t){for(var e=0;e<this.gameData.length;e++)if(this.gameData[e].id==t){this.gameData[e].tutorialViewed=!0;break}},t.prototype.getGameTutorialViewed=function(t){for(var e=!0,i=0;i<this.gameData.length;i++)if(this.gameData[i].id==t){e=this.gameData[i].tutorialViewed;break}return e},t.prototype.setFirstTime=function(t){this.firstTime=t},t.maxCarsInGarage=3,t.carTypeData={beetle:{wheelAttachPoints:[{pos:[135,265]},{pos:[545,265]}],accessoryAttachPoints:[{angle:.3,pos:[50,150]},{angle:Math.PI/2,pos:[300,20]},{angle:Math.PI,pos:[625,170]}],raceBodyOffset:[-4,0]},van:{wheelAttachPoints:[{pos:[155,280]},{pos:[505,280]}],accessoryAttachPoints:[{angle:0,pos:[45,150]},{angle:Math.PI/2,pos:[300,25]},{angle:Math.PI,pos:[630,180]}],raceBodyOffset:[0,0]},cadillac:{wheelAttachPoints:[{pos:[165,260]},{pos:[480,260]}],accessoryAttachPoints:[{angle:0,pos:[20,200]},{angle:Math.PI/2,pos:[290,75]},{angle:Math.PI/2,pos:[540,160]}],raceBodyOffset:[0,0]},bubble:{wheelAttachPoints:[{pos:[266,280]},{pos:[397,280]}],accessoryAttachPoints:[{angle:.9,pos:[212,80]},{angle:Math.PI/2,pos:[360,20]},{angle:Math.PI,pos:[460,140]}],raceBodyOffset:[0,0]},pickup:{wheelAttachPoints:[{pos:[190,280]},{pos:[540,280]}],accessoryAttachPoints:[{angle:Math.PI/2,pos:[150,30]},{angle:Math.PI/2,pos:[350,35]},{angle:Math.PI,pos:[630,150]}],raceBodyOffset:[-6,0]},gangster:{wheelAttachPoints:[{pos:[145,265]},{pos:[555,265]}],accessoryAttachPoints:[{angle:.9,pos:[90,130]},{angle:Math.PI/2,pos:[370,135]},{angle:Math.PI,pos:[625,160]}],raceBodyOffset:[-6,4]},truck:{wheelAttachPoints:[{pos:[176,300]},{pos:[546,300]}],accessoryAttachPoints:[{angle:0,pos:[40,120]},{angle:Math.PI/2,pos:[380,50]},{angle:Math.PI,pos:[610,160]}],raceBodyOffset:[-7,-1]}},t.accessoryTypeData={"bugs-bomb":{anchor:[.6,.9],defaultAngle:-Math.PI/2},"bugs-ears":{anchor:[.7,.7],defaultAngle:-Math.PI/4},"bugs-tail":{anchor:[.9,.6],defaultAngle:0},"bugs-carrot":{anchor:[.5,.9],defaultAngle:-Math.PI/2},"bugs-cowboy-hat":{anchor:[.6,.8],defaultAngle:-Math.PI/3},"tweety-ears":{anchor:[.5,.9],defaultAngle:-Math.PI/2},"tweety-halo":{anchor:[.5,1.5],defaultAngle:-Math.PI/2},"tweety-hammer":{anchor:[.5,.9],defaultAngle:-Math.PI/2},"tweety-tail":{anchor:[.9,.9],defaultAngle:-Math.PI/2},"tweety-wings":{anchor:[.8,.9],defaultAngle:-Math.PI/2},"tom-tail":{anchor:[.9,.8],defaultAngle:0},"tom-cheese":{anchor:[.5,.9],defaultAngle:-Math.PI/2},"tom-chefs-hat":{anchor:[.5,.9],defaultAngle:-Math.PI/2},"tom-jerry-ear":{anchor:[.9,.6],defaultAngle:0},"tom-trap":{anchor:[.5,.9],defaultAngle:-Math.PI/2},"wile-boxing":{anchor:[.2,.5],defaultAngle:-Math.PI},"wile-cactus":{anchor:[.5,.7],defaultAngle:-Math.PI/2},"wile-rocket":{anchor:[.5,.7],defaultAngle:-Math.PI/2},"wile-tail":{anchor:[.9,.9],defaultAngle:-Math.PI/2},"wile-tnt":{anchor:[.5,.9],defaultAngle:-Math.PI/2},"scooby-tail":{anchor:[.9,.9],defaultAngle:-Math.PI/4},"scooby-tag":{anchor:[.1,.1],defaultAngle:Math.PI},"scooby-ghost":{anchor:[.5,.6],defaultAngle:-Math.PI/2},"scooby-magnifying-glass":{anchor:[.6,.9],defaultAngle:-Math.PI/2},"scooby-snacks":{anchor:[.7,.9],defaultAngle:-Math.PI/2}},t.wheelTypeData={"purple-stock":{agility:13,bashability:3,acceleration:.03},"green-mini":{agility:14,bashability:2,acceleration:.043},"silver-speeders":{agility:10,bashability:4,acceleration:.045},micro:{agility:22,bashability:1,acceleration:.044},offroad:{agility:15,bashability:7,acceleration:.03},monster:{agility:16,bashability:9,acceleration:.043},whitewall:{agility:15,bashability:4,acceleration:.05},"blue-superspeed":{agility:5,bashability:2,acceleration:.07}},t.wheelStatsMinMax={agility:{min:5,max:25},bashability:{min:1,max:10},acceleration:{min:.1,max:.08}},t.teams=[{id:"bugs",holeOffset:[220,28]},{id:"scooby",holeOffset:[197,38]},{id:"tom",holeOffset:[233,32]},{id:"tweety",holeOffset:[224,26]},{id:"wile",holeOffset:[220,28]}],t.cars=[{id:"truck",holeOffset:[330,55]},{id:"van",holeOffset:[340,20]},{id:"cadillac",holeOffset:[340,90]},{id:"beetle",holeOffset:[300,30]},{id:"bubble",holeOffset:[340,25]},{id:"gangster",holeOffset:[340,150]},{id:"pickup",holeOffset:[300,45]}],t.pallettes={scooby:[13044807,15314704,5817796,16502214,3552822,16292124,12441406,6509219,16777215],tom:[14825535,16769050,27115,16365224,3552822,13799458,6339398,6509219,16777215],bugs:[13044807,16560433,5817796,16227461,3552822,27115,12441406,6509219,16777215],tweety:[15538246,16771072,7782122,16227461,2301728,16426522,4962678,6696337,16777215],wile:[13771562,16426522,8109527,16227461,3552822,9728324,12441406,5394338,16777215]},t.colourGroupings={scooby:[{base:0,compliment:[1,2,6]},{base:7,compliment:[1,2,6]},{base:4,compliment:[0,2,5]}],tom:[{base:2,compliment:[0,1,6]},{base:6,compliment:[4,1,2]},{base:7,compliment:[1,3,0]}],bugs:[{base:4,compliment:[1,2,5]},{base:7,compliment:[2,6,1]},{base:0,compliment:[1,2,3]}],tweety:[{base:5,compliment:[6,1,2]},{base:4,compliment:[0,2,7]},{base:6,compliment:[5,1,2]}],wile:[{base:2,compliment:[0,6,7]},{base:7,compliment:[6,3,2]},{base:0,compliment:[2,1,2]}]},t.trackData={"living-room":{difficulty:.4,coins:30,powerups:3,bombs:30,secondaryObstacles:30,ramps:30},bathroom:{difficulty:.7,coins:80,powerups:4,bombs:40,secondaryObstacles:40,ramps:40},garage:{difficulty:1,coins:120,powerups:5,bombs:55,secondaryObstacles:55,ramps:50}},t.tracks=["living-room","bathroom","garage"],t}(),XMLManager=function(){function t(t){this.game=t}return t.prototype.parseXML=function(t,e){"config"==e?this.parseConfigXML(t):"localization"==e&&this.parseLocalizationXML(t)},t.prototype.parseJSON=function(t,e){"localization"==e&&this.parseLocalizationJSON(t)},t.prototype.parseConfigXML=function(t){for(var e=t,i=e.getElementsByTagName("localization"),n=0;n<i[0].childNodes.length;n++)if("languagecode"==(l=i[0].childNodes[n]).nodeName){this.game.setLanguageCode(l.textContent);break}for(var o,r,a=e.getElementsByTagName("services"),s=null,n=0;n<a[0].childNodes.length;n++){var l=a[0].childNodes[n];if("service"==l.nodeName){for(var c=0;c<l.attributes.length;c++)"type"==l.attributes[c].nodeName&&(o=l.attributes[c].textContent),"enabled"==l.attributes[c].nodeName&&(r=l.attributes[c].textContent),"showGameTitle"==l.attributes[c].nodeName&&(s=l.attributes[c].textContent);if(!o||!r)return;this.setServiceParams(o,r,s)}}},t.prototype.setServiceParams=function(t,e,i){var n;switch("true"==e?n=!0:"false"==e&&(n=!1),t){case"eventReporting":this.game.trackingEventsManager.setTrackingParams(n,i);break;case"localStorage":this.game.setLocalStorageEnabled(n)}},t.prototype.parseLocalizationXML=function(t){for(var e,i=this.game.getCurrentLanguageCode(),n=t.getElementsByTagName("language"),o=0;o<n.length;o++)for(p=0;p<n[o].attributes.length;p++)if("id"==n[o].attributes[p].nodeName&&n[o].attributes[p].textContent==i){e=o;break}for(o=0;o<n[e].attributes.length;o++)"alphabet"==n[e].attributes[o].nodeName&&this.game.setAlphabet(n[e].attributes[o].textContent);for(var r,a,s,l,c,o=0;o<n[e].childNodes.length;o++){var h=n[e].childNodes[o];if(h.attributes){for(var p=0;p<h.attributes.length;p++)"id"==h.attributes[p].nodeName&&(r=h.attributes[p].textContent),"fontScale"==h.attributes[p].nodeName&&(a=Number(h.attributes[p].textContent)),"offsetX"==h.attributes[p].nodeName&&(s=Number(h.attributes[p].textContent)),"offsetY"==h.attributes[p].nodeName&&(l=Number(h.attributes[p].textContent));c=h.textContent,Game.stringsManager.addString({id:r,fontScale:a,offsetX:s,offsetY:l,text:c})}}},t.prototype.parseLocalizationJSON=function(t){var e=this.game.getCurrentLanguageCode();if(!t)throw ReferenceError("Can't parse Localization JSON (check formatting of file!)");var i=t[e];this.game.setAlphabet(i.alphabet);for(var n in i.strings){var o=i.strings[n],r=String(n),a=Number(o.fontscale),s=Number(o.offsetx),l=Number(o.offsety),c=o.content;Game.stringsManager.addString({id:r,fontScale:a,offsetX:s,offsetY:l,text:c})}},t}(),StringsManager=function(){function t(t){this.game=t,this.strings=new Array}return t.prototype.addString=function(t){if(1==this.checkDuplicate(t.id))throw ReferenceError("Oops! We've detected another string with the same ID: "+t.id);this.strings.push({id:t.id,fontScale:t.fontScale,offsetX:t.offsetX,offsetY:t.offsetY,text:this.replaceLineBreaks(t.text)})},t.prototype.checkDuplicate=function(t){for(var e=!1,i=0;i<this.strings.length;i++)if(this.strings[i].id==t){e=!0;break}return e},t.prototype.setTextString=function(t,e){for(var i=0;i<this.strings.length;i++)if(e==this.strings[i].id){t.text=this.strings[i].text,t.scale.x=this.strings[i].fontScale,t.scale.y=this.strings[i].fontScale,t.stringId=e;break}},t.prototype.getTextOffset=function(t){for(var e=0,i=0,n=0;n<this.strings.length;n++)if(t==this.strings[n].id){e=this.strings[n].offsetX,i=this.strings[n].offsetY;break}return{xOffset:e,yOffset:i}},t.prototype.getStringTextContent=function(t){for(var e=0;e<this.strings.length;e++)if(t==this.strings[e].id)return this.strings[e].text},t.prototype.replaceLineBreaks=function(t){return t.replace(new RegExp("<br>","g"),"\n")},t}(),AssetChunkManager=function(){function t(t){this.devMode=!1,this.game=t,this.firstLoad=!0}return t.prototype.storeInitialAssets=function(t){this.storedInitialAssets=t},t.prototype.generateLoadChunk=function(t){switch(console.log("generate asset list................",t),1==this.firstLoad?this.loadAssets=this.storedInitialAssets:0==this.firstLoad&&(this.loadAssets=new Array),this.game.setLoadingScreen("loadingScene"),t){case"race":this.loadAssets.push("race-assets"),this.loadAssets.push("powerup-"+Game.coreData.getCurrentTeam()),this.loadAssets.push("track-"+Game.coreData.getCurrentTrack()),this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("achievements-assets"),this.loadAssets.push("race-audio"),this.targetScene="raceScene";break;case"garage":this.loadAssets.push("garage-assets"),this.loadAssets.push("select-track-assets"),this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("select-team-assets"),this.loadAssets.push("select-car-assets"),this.loadAssets.push("craft-assets"),this.loadAssets.push("paint-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("craft-audio"),this.targetScene="garageScene";break;case"craft":this.loadAssets.push("garage-assets"),this.loadAssets.push("select-track-assets"),this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("select-team-assets"),this.loadAssets.push("select-car-assets"),this.loadAssets.push("craft-assets"),this.loadAssets.push("paint-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("craft-audio"),this.targetScene="selectTeamScene";break;case"home":this.loadAssets.push("start-assets"),this.loadAssets.push("garage-assets"),this.loadAssets.push("select-track-assets"),this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("select-team-assets"),this.loadAssets.push("select-car-assets"),this.loadAssets.push("craft-assets"),this.loadAssets.push("paint-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("craft-audio"),this.targetScene="startScene";break;case"none":case void 0:this.loadAssets.push("achievements-assets"),this.loadAssets.push("title-assets"),this.loadAssets.push("start-assets"),this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("select-team-assets"),this.loadAssets.push("select-car-assets"),this.loadAssets.push("select-track-assets"),this.loadAssets.push("craft-assets"),this.loadAssets.push("paint-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("garage-assets"),this.loadAssets.push("craft-audio"),this.targetScene="titleScene"}if(1==this.devMode&&1==this.firstLoad)switch(t){case"title-scene":this.loadAssets.push("title-assets"),this.targetScene="titleScene";break;case"start-scene":this.loadAssets.push("start-assets"),this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("select-team-assets"),this.loadAssets.push("select-car-assets"),this.loadAssets.push("garage-assets"),this.loadAssets.push("craft-assets"),this.loadAssets.push("paint-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("wheels-assets"),this.targetScene="startScene";break;case"select-team-scene":this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("select-team-assets"),this.loadAssets.push("select-car-assets"),this.loadAssets.push("garage-assets"),this.loadAssets.push("craft-assets"),this.loadAssets.push("paint-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("achievements-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("craft-audio"),this.targetScene="selectTeamScene";break;case"select-track-scene":this.loadAssets.push("select-track-assets"),this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("track-living-room"),this.loadAssets.push("track-bathroom"),this.loadAssets.push("track-garage"),this.loadAssets.push("race-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("achievements-assets"),this.targetScene="selectTrackScene";break;case"garage-scene":this.loadAssets.push("carousel-menu-assets"),this.loadAssets.push("garage-assets"),this.targetScene="garageScene";break;case"race-scene":this.loadAssets.push("select-track-assets"),this.loadAssets.push("race-assets"),this.loadAssets.push("powerup-tom"),this.loadAssets.push("powerup-scooby"),this.loadAssets.push("powerup-tweety"),this.loadAssets.push("powerup-wile"),this.loadAssets.push("powerup-bugs"),this.loadAssets.push("track-living-room"),this.loadAssets.push("track-bathroom"),this.loadAssets.push("track-garage"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("achievements-assets"),this.loadAssets.push("race-audio"),this.targetScene="raceScene";break;case"paint-scene":this.loadAssets.push("craft-assets"),this.loadAssets.push("paint-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("accessories-assets"),this.loadAssets.push("wheels-assets"),this.targetScene="paintScene";break;case"stickers-scene":this.loadAssets.push("craft-assets"),this.loadAssets.push("stickers-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("accessories-assets"),this.targetScene="stickersScene";break;case"wheels-scene":this.loadAssets.push("craft-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("accessories-assets"),this.targetScene="wheelsScene";break;case"accessories-scene":this.loadAssets.push("craft-assets"),this.loadAssets.push("wheels-assets"),this.loadAssets.push("accessories-assets"),this.targetScene="accessoriesScene"}return this.firstLoad=!1,this.loadAssets},t.prototype.flushAssets=function(t){var e=new Array,i=new Array;switch(t){case"race":e.push("race-assets"),i.push("race-audio");break;case"track":e.push("track-"+Game.coreData.getCurrentTrack());break;case"powerup":e.push("powerup-"+Game.coreData.getCurrentTeam());break;case"craft":e.push("craft-assets"),e.push("select-team-assets"),e.push("select-car-assets"),e.push("select-track-assets"),e.push("paint-assets"),e.push("title-assets"),e.push("wheels-assets"),e.push("garage-assets"),i.push("craft-audio");break;case"title":e.push("title-assets"),e.push("main-intro-animation-assets"),i.push("intro-audio")}Game.displayStore.flush(e);for(var n=0;n<i.length;n++)Game.audioManager.flush(i[n]);1==Game.webGL&&Game.renderer.textureGC.run()},t.prototype.getTargetScene=function(){return this.targetScene},t}(),TrackingEventsManager=function(){function t(t){this.game=t,this.trackingOn=!1}return t.prototype.setTrackingParams=function(t,e){this.trackingOn=t,this.overallGameTitle=e},t.prototype.trackGameEvent=function(t,e){0!=this.trackingOn&&"function"==typeof window.trackFlashEvent&&window.trackFlashEvent(this.overallGameTitle,t,e)},t.prototype.onLevelStart=function(t){0!=this.trackingOn&&"function"==typeof window.onLevelStart&&window.onLevelStart(t)},t.prototype.onLevelEnd=function(t){0!=this.trackingOn&&"function"==typeof window.onLevelComplete&&window.onLevelComplete(t)},t}(),LocalStorageManager=function(){function t(t){this.game=t,this.enableStorage=!1,this.localStorage=window.localStorage}return t.prototype.setLocalStorageEnabled=function(t){this.enableStorage=t},t.prototype.saveProgress=function(){if(0!=this.isLocalStorageAvailable())if(1==this.enableStorage){this.localStorage.setItem("firstTime",!1),Game.coreData.setFirstTime(!1),this.localStorage.setItem("playerAchievements",JSON.stringify(Game.coreData.playerAchievements)),this.localStorage.setItem("achievements",JSON.stringify(Game.coreData.achievements)),this.localStorage.setItem("wheels",JSON.stringify(Game.coreData.wheels)),this.localStorage.setItem("accessories",JSON.stringify(Game.coreData.accessories)),this.localStorage.setItem("stickers",JSON.stringify(Game.coreData.stickers));for(var t=[],e=0;e<Game.coreData.playerGarage.length;e++)if("empty"!=Game.coreData.playerGarage[e].id){var i=null,n=null,o=null,r=null;if(Game.coreData.playerGarage[e].carPaintSprite&&(Game.coreData.playerGarage[e].carPaintSprite.blendMode=PIXI.BLEND_MODES.NORMAL,i=this.getBase64Image(Game.coreData.playerGarage[e].carPaintSprite)),Game.coreData.playerGarage[e].carStickersSprite&&(n=this.getBase64Image(Game.coreData.playerGarage[e].carStickersSprite)),Game.coreData.playerGarage[e].carRaceSprite){var a=Game.coreData.playerGarage[e].carRaceSprite;a.parent&&a.parent.removeChild(s),this.game.currentScene.container.addChild(a),a.scale.set(1,1),a.scale3d.set(1,1,1),a.position.set(0,0),a.rotation=0,a.transform.updateTransform(new PIXI.TransformBase),a.transform.updateWorldTransform(new PIXI.TransformBase),a.filters=null,a.tint=16777215,o=this.getBase64Image(Game.coreData.playerGarage[e].carRaceSprite)}if(Game.coreData.playerGarage[e].carGarageSprite){var s=Game.coreData.playerGarage[e].carGarageSprite;s.parent&&s.parent.removeChild(s),this.game.currentScene.container.addChild(s),s.scale.set(1,1),s.position.set(0,0),s.rotation=0,s.transform.updateTransform(new PIXI.TransformBase),s.transform.updateWorldTransform(new PIXI.TransformBase),r=this.getBase64Image(s)}var l={};l.carPaintSprite=i,l.carStickersSprite=n,l.carRaceSprite=o,l.carGarageSprite=r,l.id=Game.coreData.playerGarage[e].id,l.team=Game.coreData.playerGarage[e].team,l.carGarageOffset=Game.coreData.playerGarage[e].carGarageOffset,l.stickerData=JSON.stringify(Game.coreData.playerGarage[e].stickerData),l.accessoriesData=JSON.stringify(Game.coreData.playerGarage[e].accessoriesData),l.wheelChoice=Game.coreData.playerGarage[e].wheelChoice,t.push(l)}console.log("saving!!!!!",t),this.localStorage.setItem("garage",JSON.stringify(t)),this.localStorage.setItem("currentGarageIndex",Game.coreData.currentGarageIndex),this.localStorage.setItem("currentCarType",Game.coreData.currentCarType),this.localStorage.setItem("currentTeam",Game.coreData.currentTeam),this.localStorage.setItem("currentCoins",Game.coreData.currentCoins)}else this.localStorage.clear()},t.prototype.restoreProgress=function(){if(0!=this.enableStorage){"false"==this.localStorage.getItem("firstTime")&&Game.coreData.setFirstTime(!1);var t=this.localStorage.getItem("currentCoins");t&&Game.coreData.setCurrentCoins(t);var e=this.localStorage.getItem("currentTeam");e&&Game.coreData.setCurrentTeam(e);var i=this.localStorage.getItem("currentCarType");i&&Game.coreData.setCurrentCarType(i);var n=this.localStorage.getItem("currentGarageIndex");if(n&&Game.coreData.setCurrentGarageIndex(n),this.localStorage.getItem("achievements")){var o=this.localStorage.getItem("achievements"),r=JSON.parse(o);Game.coreData.restoreAchievements(r)}if(this.localStorage.getItem("playerAchievements")){var a=this.localStorage.getItem("playerAchievements"),s=JSON.parse(a);Game.coreData.restorePlayerAchievements(s)}if(this.localStorage.getItem("stickers")){var l=this.localStorage.getItem("stickers"),c=JSON.parse(l);Game.coreData.restoreStickers(c)}if(this.localStorage.getItem("accessories")){var h=this.localStorage.getItem("accessories"),p=JSON.parse(h);Game.coreData.restoreAccessories(p)}if(this.localStorage.getItem("wheels")){var u=this.localStorage.getItem("wheels"),d=JSON.parse(u);Game.coreData.restoreWheels(d)}if(this.localStorage.getItem("garage")){for(var f=this.localStorage.getItem("garage"),m=JSON.parse(f),g=[],y=0;y<m.length;y++){var v=null,b=null,w=null,x=null;m[y].carPaintSprite&&(v=this.getImageFromBase64(m[y].carPaintSprite,"car-paint-sprite-"+y)),m[y].carStickersSprite&&(b=this.getImageFromBase64(m[y].carStickersSprite,"car-stickers-sprite-"+y)),m[y].carRaceSprite&&((w=this.getImageFromBase64(m[y].carRaceSprite,"car-race-sprite-"+y)).anchor=new PIXI.Point(.5,1),w.convertTo3d()),m[y].carGarageSprite&&(x=this.getImageFromBase64(m[y].carGarageSprite,"car-garage-sprite-"+y));var _={};_.carPaintSprite=v,_.carStickersSprite=b,_.carRaceSprite=w,_.carGarageSprite=x,_.id=m[y].id,_.team=m[y].team,_.carGarageOffset=m[y].carGarageOffset,_.stickerData=JSON.parse(m[y].stickerData),_.accessoriesData=JSON.parse(m[y].accessoriesData),_.wheelChoice=m[y].wheelChoice,g.push(_)}Game.coreData.playerGarage=g}}},t.prototype.getBase64Image=function(t){return Game.renderer.plugins.extract.base64(t,"image/png",.99)},t.prototype.getImageFromBase64=function(t,e){var i=new Sprite(Sprite.from(t).texture);return i.id=e,i.group=e+"-group",Game.displayStore.flush([e+"-group"]),Game.displayStore.addSprite(i),i},t.prototype.isLocalStorageAvailable=function(){var t=!1;if(void 0!==window.localStorage&&null!=window.localStorage){var e=window.localStorage;try{e.setItem("test","1"),e.removeItem("test"),t=!0}catch(e){t=!1}}else t=!1;return t},t}(),ParticleBurst=function(){function t(t,e,i,n){this.enabled=!1,this.cap=30,this.time=1.2,this.next=0,this.tickCount=0,this.container=e,this.pos=new PIXI.Point(0,0),this.particles=[],this.params=n,this.blendMode=n.blendMode||PIXI.BLEND_MODES.NORMAL,this.time=n.time||1,this.cap=this.params.cap||30,this.cancelled=!1,this.stagger=this.params.stagger||-1,this.game=i,this.scene=this.game.currentScene,this.overridable=n.overridable||!1,this.paused=!1,this.inUse=!1;for(var o=0;o<t.length;o++)for(var r=0;r<this.cap/t.length;r++){var a=Game.displayStore.getSprite(t[o]);this.particles.push({sprite:a,index:(o+1)*r}),a.alpha=0,this.container.addChild(a)}this.shuffleArray(this.particles)}return t.prototype.tint=function(t){for(var e=0;e<this.particles.length;e++)this.particles[e].sprite.tint=t},t.prototype.fire=function(t){this.scene=this.game.currentScene,this.animation=this.scene.killTween(this.animation),this.animation=new TimelineMax,this.cancelled=!1,this.inUse=!0;for(var e=0;e<this.particles.length;e++)this.cycleParticle(this.particles[e],this,e);this.animation.call(function(){this.inUse=!1},null,this),1==t&&this.animation.pause()},t.prototype.replay=function(){this.animation.restart()},t.prototype.updateParams=function(t,e){t.lowerAngle&&(e.params.lowerAngle=t.lowerAngle),t.upperAngle&&(e.params.upperAngle=t.upperAngle),t.lowerVelocity&&(e.params.lowerVelocity=t.lowerVelocity),t.upperVelocity&&(e.params.upperVelocity=t.upperVelocity),t.endScale&&(e.params.endScale=t.endScale),t.lowerStartScale&&(e.params.lowerStartScale=t.lowerStartScale),t.upperStartScale&&(e.params.upperStartScale=t.upperStartScale),t.lowerEndScale&&(e.params.lowerEndScale=t.lowerEndScale),t.upperEndScale&&(e.params.upperEndScale=t.upperEndScale),t.blendMode&&(e.params.blendMode=t.blendMode),t.friction&&(e.params.friction=t.friction),t.XstartRange&&(e.params.XstartRange=t.XstartRange),t.YstartRange&&(e.params.YstartRange=t.YstartRange),t.endAlpha&&(e.params.endAlpha=t.endAlpha),t.startAlpha&&(e.params.startAlpha=t.startAlpha),t.gravity&&(e.params.gravity=t.gravity),t.stagger&&(e.stagger=t.stagger),t.time&&(e.time=t.time)},t.prototype.cycleParticle=function(t,e,i){if(1!=e.cancelled){var n=t.sprite;n.position.x=Game.getRandom(-e.params.XstartRange,e.params.XstartRange),n.position.y=Game.getRandom(-e.params.YstartRange,e.params.YstartRange),n.alpha=0;var o=Game.getRandom(e.params.lowerStartScale,e.params.upperStartScale),r=e.params.scaleInTime||40;n.scale.x=0,n.scale.y=0,n.blendMode=e.blendMode;var a=i/e.stagger;a<0&&(a=0);var s=e.params.endScale||0,l=e.params.lowerEndScale||s,c=e.params.upperEndScale||s,h=Game.getRandom(l,c),p=e.params.startAlpha||1,u=e.params.fadeInTime||10;n.rotation=Game.getRandom(-Math.PI,Math.PI)*e.params.rotationPower,e.animation.add([TweenLite.to(n.position,e.time,{physics2D:{velocity:Game.getRandom(e.params.lowerVelocity,e.params.upperVelocity),angle:Game.getRandom(e.params.lowerAngle,e.params.upperAngle),acceleration:e.params.gravity,accelerationAngle:90,friction:e.params.friction}}),TweenLite.to(n,e.time/u,{alpha:p,ease:Sine.easeOut}),TweenLite.to(n,e.time,{delay:e.time/u,alpha:e.params.endAlpha,ease:Sine.easeOut}),TweenLite.to(n,e.time,{rotation:Game.getRandom(-3*e.params.rotationPower,3*e.params.rotationPower),ease:Sine.easeOut}),TweenLite.to(n.scale,e.time/r,{x:o,y:o,ease:Sine.easeOut}),TweenLite.to(n.scale,e.time,{delay:e.time/r,x:h,y:h,ease:Sine.easeOut})],a)}},t.prototype.shuffleArray=function(t){for(var e,i,n=t.length;n>0;)i=Math.floor(Math.random()*n),e=t[--n],t[n]=t[i],t[i]=e;return t},t.prototype.cancel=function(){this.cancelled=!0,this.animation.kill()},t.prototype.pause=function(){this.scene.pauseResumeTween(this.animation,"pause"),this.paused=!0},t.prototype.resume=function(){this.scene.pauseResumeTween(this.animation,"resume"),this.paused=!1},t.prototype.destroy=function(){this.animation=this.scene.killTween(this.animation);for(var t=0;t<this.particles.length;t++)this.particles[t].sprite.parent&&this.particles[t].sprite.parent.removeChild(this.particles[t].sprite),TweenLite.killTweensOf(this.particles[t].sprite),TweenLite.killTweensOf(this.particles[t].sprite.scale),Game.displayStore.returnPooledItem(this.particles[t].sprite);this.inUse=!1},t}(),ParticleStream=function(){function t(t,e,i,n){this.cap=30,this.time=1,this.next=0,this.tickCount=0,this.stagger=.1,this.enabled=!1,this.container=e,this.pos=new PIXI.Point(0,0),this.particles=[],this.container.interactive=!1,this.container.interactiveChildren=!1,this.iterations=0,this.scene=i,this.params=n,this.blendMode=n.blendMode||PIXI.BLEND_MODES.NORMAL,this.time=n.time||1,n.xPos&&n.yPos&&this.updatePos(new PIXI.Point(n.xPos,n.yPos)),this.cap=this.params.cap||30,this.stagger=this.time/this.cap;for(var o=0,r=0;r<t.length;r++)for(var a=0;a<Math.round(this.cap/t.length);a++){var s=Game.displayStore.getSprite(t[r]);this.particles.push({sprite:s,inUse:!1,index:o,lifeTime:this.time,tweens:[]}),s.alpha=0,this.container.addChild(s),o++}}return t.prototype.updateParams=function(t,e){e.params.lowerAngle=t.lowerAngle,e.params.upperAngle=t.upperAngle,e.params.lowerVelocity=t.lowerVelocity,e.params.upperVelocity=t.upperVelocity,e.params.endScale=t.endScale,e.params.endScaleX=t.endScaleX,e.params.endScaleY=t.endScaleY,e.params.startScaleX=t.startScaleX,e.params.lowerStartScale=t.lowerStartScale,e.params.upperStartScale=t.upperStartScale,e.params.rotationPower=t.rotationPower,e.params.friction=t.friction,e.params.fadeInTime=t.fadeInTime,e.params.fadeOutTime=t.fadeOutTime,e.params.scaleInTime=t.scaleInTime,e.params.scaleOutTime=t.scaleOutTime,e.time=t.time,e.stagger=e.time/e.cap,t.xPos&&t.yPos&&e.updatePos(new PIXI.Point(t.xPos,t.yPos))},t.prototype.pause=function(){this.paused=!0;for(var t=0;t<this.particles.length;t++)for(var e=this.particles[t],i=0;i<e.tweens.length;i++)this.scene.pauseResumeTween(e.tweens[t],"pause")},t.prototype.resume=function(){this.paused=!1;for(var t=0;t<this.particles.length;t++)for(var e=this.particles[t],i=0;i<e.tweens.length;i++)this.scene.pauseResumeTween(e.tweens[t],"resume")},t.prototype.cycleParticle=function(t,e){if(0!=e.enabled&&1!=e.paused){t.inUse=!0,t.lifeTime=e.time;var i=t.sprite;i.position.x=Game.getRandom(e.pos.x-e.params.XstartRange,e.pos.x+e.params.XstartRange),i.position.y=Game.getRandom(e.pos.y-e.params.YstartRange,e.pos.y+e.params.YstartRange),i.alpha=0;var n=e.params.lowerAngle||0,o=e.params.upperAngle||360,r=e.params.lowerVelocity||20,a=e.params.upperVelocity||50,s=e.params.endScaleX||e.params.endScale||0,l=e.params.endScaleY||e.params.endScale||0,c=(e.params.startScaleX,e.params.rotationPower),h=e.params.lowerStartScale||0,p=e.params.upperStartScale||0,u=e.params.startAlpha||1,d=Game.getRandom(h,p);i.scale.x=0,i.scale.y=0,i.rotation=Game.getRandom(0,2*Math.PI)*c,i.blendMode=e.blendMode,t.tweens.push(TweenMax.to(i.position,t.lifeTime,{physics2D:{velocity:Game.getRandom(r,a),angle:Game.getRandom(n,o),acceleration:e.params.gravity,accelerationAngle:90,friction:e.params.friction},onComplete:e.resetParticle,onCompleteParams:[t,e]}));var f;f=e.params.fadeInTime?e.params.fadeInTime:10;var m;m=e.params.fadeOutTime?e.params.fadeOutTime:4;var g;g=e.params.scaleInTime?e.params.scaleInTime:10;var y;y=e.params.scaleOutTime?e.params.scaleOutTime:4,t.tweens.push(TweenMax.to(i,t.lifeTime/f,{alpha:u,ease:Sine.easeOut})),t.tweens.push(TweenMax.to(i,t.lifeTime/m,{delay:t.lifeTime-t.lifeTime/m,alpha:0,ease:Sine.easeOut})),t.tweens.push(TweenMax.to(i.scale,t.lifeTime/g,{delay:t.lifeTime/g,x:d,y:d,ease:Sine.easeOut})),t.tweens.push(TweenMax.to(i.scale,t.lifeTime/y,{delay:t.lifeTime-t.lifeTime/y,x:s,y:l,ease:Sine.easeOut})),t.tweens.push(TweenMax.to(i,t.lifeTime,{rotation:Game.getRandom(0,2*Math.PI)*c,ease:Sine.easeOut}))}},t.prototype.resetParticle=function(t,e){t.inUse=!1,t.tweens=[],t.startTime=0},t.prototype.enable=function(){this.enabled=!0,this.iterations=0;for(var t=0;t<this.particles.length;t++)this.resetParticle(this.particles[t],this)},t.prototype.disable=function(){this.enabled=!1},t.prototype.trackItem=function(t){this.trackedItem=t},t.prototype.updatePos=function(t){this.pos.x=t.x,this.pos.y=t.y},t.prototype.tick=function(){this.iterations+=1/(60*this.time);for(var t=0;t<this.particles.length;t++)this.iterations>this.stagger&&0==this.particles[t].inUse&&(this.cycleParticle(this.particles[t],this),this.iterations=0)},t.prototype.shuffleArray=function(t){for(var e,i,n=t.length;n>0;)i=Math.floor(Math.random()*n),e=t[--n],t[n]=t[i],t[i]=e;return t},t.prototype.destroy=function(){this.disable();for(var t=0;t<this.particles.length;t++){var e=this.particles[t];TweenLite.killTweensOf(e.sprite),TweenLite.killTweensOf(e.sprite.scale),Game.displayStore.returnPooledItem(e.sprite);for(var i=0;i<e.tweens.length;i++)e.tweens[i]=this.scene.killTween(e.tweens[i])}Game.displayStore.returnPooledItem(this.container)},t}(),TutorialOverlay=function(){function t(t){this.scene=t,this.bgOverlay=Game.displayStore.getSprite("tutorial-element-bg"),this.bgOverlay.width=Game.stageWidth,this.bgOverlay.height=Game.stageHeight,this.bgOverlay.alpha=.4,this.dotSpacing=25,this.isOpen=!1,this.paginationOffAlpha=.25,this.paginationOnAlpha=1}return t.prototype.buildTutorial=function(t,e){this.isOpen=!0,this.currentPanelState=0,this.addedOverlay=e,this.tutorialHolder=Game.displayStore.getContainer("ui/tutorial-overlay-main-holder"),this.tutorialHolder.position.y=Game.stageHeight/2,this.tutorialHolder.scale.x=1,this.tutorialHolder.scale.y=1,this.gameID=t,this.panels=new Array,this.panels.push({container:Game.displayStore.getContainer("tutorial-frame-controls"),panelBG:Game.displayStore.getSprite("tutorial-panel-bg"),panelBGBorder:Game.displayStore.getSprite("tutorial-panel-bg-border"),id:"controls"}),this.panels.push({container:Game.displayStore.getContainer("tutorial-frame-howtoplay"),panelBG:Game.displayStore.getSprite("tutorial-panel-bg"),panelBGBorder:Game.displayStore.getSprite("tutorial-panel-bg-border"),id:"howtoplay"}),Game.coreData.setGameTutorialViewed(this.gameID),1==this.addedOverlay&&this.scene.container.addChild(this.bgOverlay),0==this.addedOverlay?this.scene.game.ui.setUI("help"):this.scene.game.ui.setUI("tutorial-overlay"),this.positions=new Array,this.positions.push(Game.stageWidth/2),this.positions.push(Game.stageWidth/2-Game.stageWidth);for(i=0;i<this.panels.length;i++)this.panels[i].container.addChildAt(this.panels[i].panelBGBorder,0),this.panels[i].container.addChildAt(this.panels[i].panelBG,0),this.panels[i].panelBGBorder.blendMode=PIXI.BLEND_MODES.ADD,this.panels[i].panelBGBorder.alpha=0,this.panels[i].container.position.x=Game.stageWidth*i,this.tutorialHolder.addChild(this.panels[i].container);this.scene.container.addChild(this.tutorialHolder),this.controlsTitle=Game.displayStore.getBitmapText("tutorial/title-font",this.panels[0].id),this.howToPlayTitle=Game.displayStore.getBitmapText("tutorial/title-font",this.panels[1].id),this.setUpTitle(this.controlsTitle,0),this.setUpTitle(this.howToPlayTitle,1),this.controlsTitle.setPosition(0-this.controlsTitle.width/2,-225),this.howToPlayTitle.setPosition(0-this.howToPlayTitle.width/2,-225),this.panels[0].container.addChild(this.controlsTitle),this.panels[1].container.addChild(this.howToPlayTitle),this.controlsTitle.tint=16777215,this.howToPlayTitle.tint=16777215,this.paginationDots=new Array;for(var i=0;i<9;i++)this.paginationDots.push({sprite:Game.displayStore.getSprite("tutorial-pagination-dot"),container:null});this.setUpPaginationDots(0,2,this.panels[0].container,0),this.setUpPaginationDots(3,5,this.panels[1].container,1),this.tutorialHolder.position.x=this.positions[this.currentPanelState],this.cyclePanel(0)},t.prototype.setUpTitle=function(t,e){t.setPosition(0-t.width/2,-225),this.panels[e].container.addChild(t)},t.prototype.setUpPaginationDots=function(t,e,i,n){var o,r=0;o=-this.dotSpacing/2,e-=1;for(var a=t;a<=e;a++)this.paginationDots[a].container=i,this.paginationDots[a].sprite.position.x=o,this.paginationDots[a].sprite.position.y=190,this.paginationDots[a].sprite.alpha=this.paginationOffAlpha,r==n&&(this.paginationDots[a].sprite.alpha=this.paginationOnAlpha),this.paginationDots[a].container.addChild(this.paginationDots[a].sprite),o+=this.dotSpacing,r++},t.prototype.remove=function(){this.isOpen=!1;for(t=0;t<this.panels.length;t++)this.panels[t].container.removeChild(this.panels[t].panelBG),this.panels[t].container.removeChild(this.panels[t].panelBGBorder),this.tutorialHolder.removeChild(this.panels[t].container);this.scene.container.removeChild(this.tutorialHolder),1==this.addedOverlay&&this.scene.container.removeChild(this.bgOverlay);for(var t=0;t<this.paginationDots.length;t++)this.paginationDots[t].container&&(this.paginationDots[t].container.removeChild(this.paginationDots[t].sprite),this.paginationDots[t].container=null),Game.displayStore.returnPooledItem(this.paginationDots[t].sprite);this.animationTween=this.scene.killTween(this.animationTween),Game.displayStore.flush([this.gameID+"-tutorial-assets"]),Game.displayStore.returnPooledItem(this.controlsTitle),Game.displayStore.returnPooledItem(this.howToPlayTitle),Game.displayStore.returnPooledItem(this.powerUpTitle),1==Game.useFilters&&(this.tutorialHolder.filters=null)},t.prototype.uiClicked=function(t){switch(t.id){case"tutorial-button-left":this.cyclePanel(-1);break;case"tutorial-button-right":this.cyclePanel(1);break;case"close-button":1==this.isOpen&&(this.remove(),this.scene.tutorialOverlayClosed())}},t.prototype.cyclePanel=function(t){this.currentPanelState+=t,this.currentPanelState<0&&(this.currentPanelState=0),this.currentPanelState>this.panels.length-1&&(this.currentPanelState=this.panels.length-1),0==t&&(this.tutorialHolder.scale.x=2,this.tutorialHolder.scale.y=2),this.animationTween=this.scene.killTween(this.animationTween),this.animationTween=new TimelineMax,0==t&&(Game.playSound("beam-in.mp3"),this.animationTween.add(TweenMax.to(this.tutorialHolder.scale,1,{x:1,y:1,ease:Elastic.easeOut}),0)),this.animationTween.add(TweenMax.to(this.tutorialHolder.position,.5,{x:this.positions[this.currentPanelState],ease:Expo.easeOut}),0);var e=new RoughEase({strength:3,points:20,randomize:!0,clamp:!0});this.panels[this.currentPanelState].panelBGBorder.alpha=0,this.animationTween.add(TweenMax.to(this.panels[this.currentPanelState].panelBGBorder,.2,{alpha:.8,ease:e}),.3),this.setButtonState()},t.prototype.setButtonState=function(){0==this.currentPanelState?(this.scene.game.ui.disableButton("tutorial-button-left"),this.scene.game.ui.enableButton("tutorial-button-right")):this.currentPanelState==this.panels.length-1?(this.scene.game.ui.disableButton("tutorial-button-right"),this.scene.game.ui.enableButton("tutorial-button-left")):(this.scene.game.ui.enableButton("tutorial-button-left"),this.scene.game.ui.enableButton("tutorial-button-right"))},t.prototype.tick=function(){},t.prototype.destroy=function(){},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Player=function(t){function e(e,i){var n=t.call(this,e,i)||this;if(n.obstacleHit=!1,n.numberobstaclesHit=0,n.bombsHit=0,n.rampActive=!1,n.rampTimer=0,n.rampTimerLimit=60,n.team=Game.coreData.getCurrentTeam(),n.team)n.scene.getRandomTeam(n.team),n.generateVehicle({carType:Game.coreData.getPlayerCarData().id,wheelType:Game.coreData.getPlayerCarData().wheelChoice,textureSprite:Game.coreData.getPlayerCarData().carRaceSprite}),Game.coreData.getPlayerCarData().carRaceSprite&&n.textureSprite.scale.set(.5,.5),n.addAttachments(Game.coreData.getPlayerCarData().accessoriesData);else{var o=Game.getRandom(0,CoreData.cars.length-1,!0);n.team=n.scene.getRandomTeam("tom"),n.generateVehicle({carType:CoreData.cars[o].id,wheelType:Game.coreData.getWheels()[0].id,textureSprite:Game.displayStore.getSprite3d("race-scene/"+CoreData.cars[o].id)});for(var r=[],a=CoreData.carTypeData[CoreData.cars[o].id].accessoryAttachPoints.length,s=0;s<a;s++){var l=Game.getRandom(0,1),c=Game.coreData.getRandomAccessory(n.team);l>.3&&r.push({attachPointIndex:s,id:c})}n.addAttachments(r)}return n.p2Shape.collisionGroup=PhysicsManager.PLAYER,n.p2Shape.collisionMask=PhysicsManager.SENSOR|PhysicsManager.RAMP|PhysicsManager.BARRIER|PhysicsManager.COLLECTABLE|PhysicsManager.RIVAL,n}return __extends(e,t),e.prototype.endRace=function(){t.prototype.endRace.call(this),this.p2Shape.collisionMask=PhysicsManager.NONE,this.stopAccelerating(.02)},e.prototype.accelerate=function(){t.prototype.accelerate.call(this,this.scene.levelSpeed)},e.prototype.hitCollectable=function(e){"coin"==e&&(console.log("player collect coin"),Game.playSound("coin-collect.mp3",1),this.scene.hud.collectCoin()),"powerup"==e&&(this.scene.playerCollectPowerup(),Game.playSound("level-up.mp3",1)),t.prototype.hitCollectable.call(this,e)},e.prototype.hitObstacle=function(e){t.prototype.hitObstacle.call(this,e),this.obstacleHit=!0,this.numberobstaclesHit++,"bomb"==e&&(this.scene.shakeScreen(1.5,5,40,.3,1),this.bombsHit++,Game.playSound("bomb-"+Game.getRandom(1,3,!0)+".mp3",1)),"ice"==e&&Game.playSound("ice-skid-"+Game.getRandom(1,2,!0)+".mp3",1),"oil"==e&&Game.playSound("oil-slick.mp3",1),"gum"==e&&(Game.playSound("splat-"+Game.getRandom(1,3,!0)+".mp3",1),Game.playSound("spooge-"+Game.getRandom(1,2,!0)+".mp3",1))},e.prototype.hitRamp=function(){this.rampActive=!0,this.prerampPosition=this.scene.hud.playerPosition,t.prototype.hitRamp.call(this,!0),Game.playSound("lazer-zap.mp3",1),Game.playSound("whizz.mp3",.8)},e.prototype.tick=function(){t.prototype.tick.call(this),1==this.rampActive&&++this.rampTimer>this.rampTimerLimit&&(this.rampActive=!1,console.log("RAMP CHECK FINISHED!"),this.rampTimer=0,this.postrampPosition=this.scene.hud.playerPosition,this.postrampPosition<this.prerampPosition&&Game.coreData.unlockAchievement("use-boost-to-overtake"),console.log(this.postrampPosition,this.prerampPosition))},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Vehicle),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Rival=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.sampleSpeed=20,n.randomLaneChangeChance=.2,n.mineAvoidChance=.7,n.gumAvoidChance=.5,n.collectChance=.4,n.rampChance=.6,n.rubberBandingThreshold=3,n.skillIndex=i.skillIndex,console.log(n.collectChance,n.skillIndex,n.collectChance*n.skillIndex);var o=Game.getRandom(0,CoreData.cars.length-1,!0);n.team=n.scene.getRandomTeam(),n.targetLocked=!1,n.generateVehicle({carType:CoreData.cars[o].id,wheelType:Game.coreData.getLevelWheels(Game.coreData.getCurrentTrack())[Game.getRandom(0,Game.coreData.getLevelWheels(Game.coreData.getCurrentTrack()).length-1,!0)],textureSprite:Game.displayStore.getSprite3d("race-scene/"+CoreData.cars[o].id)});for(var r=[],a=CoreData.carTypeData[CoreData.cars[o].id].accessoryAttachPoints.length,s=0;s<a;s++){var l=Game.getRandom(0,1),c=Game.coreData.getRandomAccessory(n.team);l>.3&&r.push({attachPointIndex:s,id:c})}return n.addAttachments(r),n.addRandomPaintAndStickers(),n.p2Shape.collisionGroup=PhysicsManager.RIVAL,n.p2Shape.collisionMask=PhysicsManager.SENSOR|PhysicsManager.BARRIER|PhysicsManager.RAMP|PhysicsManager.COLLECTABLE|PhysicsManager.PLAYER|PhysicsManager.RIVAL|PhysicsManager.POWERUP,n.agility=10,n.AIActive=!0,n.carBody.parentGroup=RaceScene.SORT_GROUP_PROP,n.wheelFL.parentGroup=RaceScene.SORT_GROUP_PROP,n.wheelFR.parentGroup=RaceScene.SORT_GROUP_PROP,n.wheelBL.parentGroup=RaceScene.SORT_GROUP_PROP,n.wheelBR.parentGroup=RaceScene.SORT_GROUP_PROP,n.container.alpha=1,n.container.visible=!0,n.dustTrail.visible=!0,n.shadow.visible=!0,n}return __extends(e,t),e.prototype.accelerate=function(){0!=this.AIActive&&t.prototype.accelerate.call(this,this.scene.levelSpeed*Game.getRandom(.95,1.02)*this.rubberbandFactor)},e.prototype.disableAI=function(){this.AIActive=!1},e.prototype.tick=function(){if(t.prototype.tick.call(this),0!=this.scene.started&&1!=this.scene.endingRace&&this.ticker%this.sampleSpeed==0&&1==this.AIActive){var e=this.scene.trackManager.tiles[this.scene.trackManager.getTileIndex(this.p2Body.position[0])];if(!e)return;this.checkLaneFor("bomb",this.currentLane)?Game.getRandom(0,1)<this.mineAvoidChance*this.skillIndex&&this.tryOtherLane():this.checkLaneFor("gum",this.currentLane)?Game.getRandom(0,1)<this.gumAvoidChance*this.skillIndex&&this.tryOtherLane():this.checkLaneFor("coin",this.currentLane-1)?Game.getRandom(0,1)<this.collectChance*this.skillIndex&&this.tryOtherLane(-1):this.checkLaneFor("coin",this.currentLane+1)?Game.getRandom(0,1)<this.collectChance*this.skillIndex&&this.tryOtherLane(1):this.checkLaneFor("powerup",this.currentLane-1)?Game.getRandom(0,1)<this.collectChance*this.skillIndex&&this.tryOtherLane(-1):this.checkLaneFor("powerup",this.currentLane+1)?Game.getRandom(0,1)<this.collectChance*this.skillIndex&&this.tryOtherLane(1):this.checkLaneFor("ramp",this.currentLane-1)?Game.getRandom(0,1)<this.rampChance*this.skillIndex&&this.tryOtherLane(-1):this.checkLaneFor("ramp",this.currentLane+1)?Game.getRandom(0,1)<this.rampChance*this.skillIndex&&this.tryOtherLane(1):Game.getRandom(0,1)<this.randomLaneChangeChance*this.skillIndex&&(this.highlighted?Game.getRandom(0,1)<this.skillIndex&&this.tryOtherLane():this.tryOtherLane());var i=this.scene.trackManager.tiles[this.scene.trackManager.getTileIndex(this.scene.player.p2Body.position[0])],n=e.index-i.index;n>2&&(n=2),Math.abs(n)>this.rubberBandingThreshold?(this.rubberbandFactor=1-n/12,this.targetAcceleration=this.scene.levelSpeed*this.rubberbandFactor):1!=this.rubberbandFactor&&(this.rubberbandFactor=1,this.targetAcceleration=this.scene.levelSpeed*this.rubberbandFactor),this.currentStatus==Vehicle.STATUS_SMASHED&&(this.targetAcceleration=0)}},e.prototype.checkLaneFor=function(t,e){var i=this.scene.trackManager.tiles[this.scene.trackManager.getTileIndex(this.p2Body.position[0])],n=!1;return i.itemRegister["0"+e]!=t&&i.itemRegister["1"+e]!=t&&i.itemRegister["2"+e]!=t&&i.itemRegister["3"+e]!=t&&i.itemRegister["4"+e]!=t||(n=!0),n},e.prototype.tryOtherLane=function(t){if(1!=this.targetLocked){var e=RaceScene.lanePositions.length-1;t?this.changeLane(this.currentLane+t):0==this.currentLane?this.scene.player.currentLane==e?this.changeLane(Game.getRandom(1,3,!0)):this.changeLane(Game.getRandom(1,2,!0)):4==this.currentLane?0!=this.scene.player.currentLane?this.changeLane(Game.getRandom(0,2,!0)):this.changeLane(Game.getRandom(1,3,!0)):4==this.scene.player.currentLane?this.changeLane(Game.getRandom(0,2,!0)):0==this.scene.player.currentLane?this.changeLane(Game.getRandom(1,3,!0)):this.changeLane(this.currentLane+Game.getRandom(-2,2,!0))}},e.prototype.smash=function(t){if(0!=this.highlighted){console.log("smashing",this.id,this.team),Game.coreData.unlockAchievement("use-power-up"),"tweety"==this.team&&Game.coreData.unlockAchievement("knock-out-tweety"),"scooby"==this.team&&Game.coreData.unlockAchievement("knock-out-scooby"),"tom"==this.team&&Game.coreData.unlockAchievement("knock-out-tom"),this.currentStatus=Vehicle.STATUS_SMASHED,this.crashAnimation=this.scene.killTween(this.crashAnimation),this.rampAnimation=this.scene.killTween(this.rampAnimation),this.scene.hud.smash(this),this.stopAccelerating(),this.removeHighlight(),this.dustTrail.visible=!1,this.shadow.visible=!1,this.deccelerationPower=.06,this.p2Shape.collisionMask=PhysicsManager.SENSOR|PhysicsManager.BARRIER|PhysicsManager.RAMP|PhysicsManager.COLLECTABLE,this.smashTimeline=this.scene.killTween(this.smashTimeline),this.smashTimeline=new TimelineMax;var e=new RoughEase({strength:10,points:10,taper:"none",randomize:!1,clamp:!0}),i=2*Game.getRandom(0,1,!0)-1;"blast"==t?(this.smashTimeline.add([TweenMax.to(this.backWheels.position3d,.1,{z:-this.wheelSize/6,ease:Power1.easeIn}),TweenMax.to(this.frontWheels.position3d,.1,{z:-this.wheelSize/3,ease:Power1.easeIn}),TweenMax.to(this.car.position3d,.2,{z:-300,ease:Power1.easeOut}),TweenMax.to(this.shadow.scale,.2,{x:this.shadowDefaultScale/2,y:.5,ease:Power2.easeOut}),TweenMax.to(this.shadow,.2,{alpha:.2,ease:Power2.easeOut})]),this.smashTimeline.add([TweenMax.to(this.car.position3d,.3,{z:30,ease:Power1.easeIn}),TweenMax.to(this.shadow.scale,.3,{x:this.shadowDefaultScale,y:1,ease:Power1.easeIn}),TweenMax.to(this.shadow,.1,{alpha:.5,ease:Power1.easeIn})]),this.smashTimeline.add([TweenMax.to(this.car.position3d,.3,{z:0,ease:Bounce.easeOut}),TweenMax.to(this.carBody.euler,1,{z:0,ease:Elastic.easeOut}),TweenMax.to(this.frontWheels.position3d,.7,{z:-this.wheelSize/2,ease:Elastic.easeOut}),TweenMax.to(this.backWheels.position3d,.7,{z:-this.wheelSize/2,delay:.04,ease:Elastic.easeOut})]),this.smashTimeline.add(TweenMax.to(this.frontWheels.position3d,.1,{z:-this.wheelSize/1.5,ease:Power1.easeOut}),.25),this.smashTimeline.add(TweenMax.to(this.car.euler,.7,{y:3*Math.PI,ease:Power1.easeOut}),0),this.smashTimeline.add(TweenMax.to(this.car.position3d,.9,{x:"-=400",ease:Power1.easeOut}),0),this.smashTimeline.add(TweenMax.to(this.car.euler,.4,{x:Math.PI*i/2,ease:Power2.easeInOut}),0)):(this.changeLane(Game.getRandom(0,4,!0)),this.carBody.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.wheelFL.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.wheelFR.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.wheelBL.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.wheelBR.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.smashTimeline.add([TweenMax.to(this.wheelFL.euler,.5,{x:.1,ease:Bounce.easeOut}),TweenMax.to(this.wheelFR.euler,.5,{x:-.1,ease:Bounce.easeOut}),TweenMax.to(this.wheelBL.euler,.5,{x:.1,ease:Bounce.easeOut}),TweenMax.to(this.wheelBR.euler,.5,{x:-.1,ease:Bounce.easeOut}),TweenMax.to(this.carBody.euler,.5,{z:Game.getRandom(-.2,.2),ease:Bounce.easeOut}),TweenMax.to(this.carBody.euler,.5,{x:Game.getRandom(.1,.3),ease:Bounce.easeOut}),TweenMax.to(this.carBody.position3d,.5,{z:0,ease:Bounce.easeOut})])),this.smashTimeline.add(TweenMax.to(this.container,1,{alpha:0,ease:e}),"+=0.5")}},e.prototype.hitObstacle=function(e){t.prototype.hitObstacle.call(this,e),"bomb"==e&&1==this.onScreen&&Game.playSound("bomb-"+Game.getRandom(1,3,!0)+".mp3",.5),"ice"==e&&1==this.onScreen&&Game.playSound("ice-skid-"+Game.getRandom(1,2,!0)+".mp3",.5),"oil"==e&&1==this.onScreen&&Game.playSound("oil-slick.mp3",.5),"gum"==e&&1==this.onScreen&&(Game.playSound("splat-"+Game.getRandom(1,3,!0)+".mp3",.5),Game.playSound("spooge-"+Game.getRandom(1,2,!0)+".mp3",.5))},e.prototype.hitRamp=function(){t.prototype.hitRamp.call(this),1==this.onScreen&&Game.playSound("whizz.mp3",.5)},e.prototype.hitCollectable=function(e){t.prototype.hitCollectable.call(this,e),"coin"==e&&1==this.onScreen&&Game.playSound("coin-collect.mp3",.5)},e.prototype.startTouchOtherVehicle=function(){this.touchingAnotherVehicle=!0,TweenMax.delayedCall(1,function(){for(var t=0;t<this.scene.vehicles.length;t++){var e=this.scene.vehicles[t];e!=this&&this.p2Body.overlaps(e.p2Body)&&this.changeLane(this.lastLane)}},null,this)},e.prototype.stopTouchOtherVehicle=function(){this.touchingAnotherVehicle=!1},e.prototype.changeLane=function(e){t.prototype.changeLane.call(this,e)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.smashTimeline=this.scene.killTween(this.smashTimeline)},e}(Vehicle),Tile=function(){function t(t,e,i){if(this.trackManager=t,this.onScreen=!0,this.itemRegister={},this.index=e,this.container=Game.displayStore.getContainer3d("race-scene/tile-container"),this.sprite3d=Game.displayStore.getSprite3d("race-scene/"+this.trackManager.track+"/floor-tile.png"),this.wallSpriteTop=Game.displayStore.getSprite3d("race-scene/"+this.trackManager.track+"/wall-tile.png"),this.wallSpriteTop.position3d.y=0,this.wallSpriteBottom=Game.displayStore.getSprite3d("race-scene/"+this.trackManager.track+"/wall-tile.png"),this.wallSpriteBottom.position3d.y=this.sprite3d.height+10,this.tableSpriteTop=Game.displayStore.getSprite3d("race-scene/"+this.trackManager.track+"/table-tile.png"),this.tableSpriteTop.position3d.y=2*-this.tableSpriteTop.height,this.tableSpriteTop.scale3d.set(1,2,1),this.tableSpriteBottom=Game.displayStore.getSprite3d("race-scene/"+this.trackManager.track+"/table-tile.png"),this.tableSpriteBottom.position3d.y=this.sprite3d.height,this.tableSpriteBottom.scale3d.set(1,2,1),this.wallSpriteTop.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.tableSpriteTop.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.sprite3d.parentGroup=RaceScene.SORT_GROUP_FLOOR,this.wallSpriteBottom.parentGroup=RaceScene.SORT_GROUP_PROP,this.container.addChild(this.sprite3d),this.container.addChild(this.wallSpriteTop),this.container.addChild(this.wallSpriteBottom),this.container.addChild(this.tableSpriteTop),this.container.addChild(this.tableSpriteBottom),1==i){var n=Game.displayStore.getSprite3d("race-scene/finish-line-tower"),o=Game.displayStore.getSprite3d("race-scene/finish-line-tower");n.position3d.y=-20,o.position3d.y=this.sprite3d.height+20,n.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,o.parentGroup=RaceScene.SORT_GROUP_PROP_FRONT,n.scale3d.x=.6,o.scale3d.x=.6,n.proj.euler.x=1.6,o.proj.euler.x=1.6;var r=Game.displayStore.getSprite3d("race-scene/finish-line.png"),a=Game.displayStore.getSprite3d("race-scene/finish-line.png"),s=Game.displayStore.getSprite3d("race-scene/finish-line.png");r.proj.euler.y=1.6,r.position3d.x=-10,r.position3d.z=-240,r.position3d.y=this.sprite3d.height/2,r.scale3d.set(1,.6,1),r.parentGroup=RaceScene.SORT_GROUP_PROP,a.proj.euler.y=1.6,a.position3d.x=10,a.position3d.z=-240,a.position3d.y=this.sprite3d.height/2,a.scale3d.set(1,.6,1),a.parentGroup=RaceScene.SORT_GROUP_PROP,s.position3d.y=this.sprite3d.height/2,s.scale3d.set(.5,.5,1),s.parentGroup=RaceScene.SORT_GROUP_BACK,this.container.addChild(n),this.container.addChild(o),this.container.addChild(r),this.container.addChild(a),this.container.addChild(s)}this.container.scale3d.set(RaceScene.levelScale,RaceScene.levelScale,1),this.wallSpriteTop.proj.euler.x=1,this.wallSpriteBottom.proj.euler.x=1}return t.prototype.registerItem=function(t,e){this.itemRegister[String(t[0])+String(t[1])]=e},t.prototype.isBlockAvailable=function(t,e){var i=!0;return"any"==e?null!=this.itemRegister[String(t[0])+String(t[1])]&&(i=!1):(null!=this.itemRegister[String(t[0])+String(t[1])]&&(i=!1),this.itemRegister[String(t[0])+String(t[1])]==e&&(i=!1)),i},t.prototype.hide=function(){this.onScreen=!1,this.container.visible=!1},t.prototype.show=function(){this.onScreen=!0,this.container.visible=!0},t.prototype.tick=function(){var t=this.container.getBounds(),e=Game.windowScaleFactor;t.y+t.height<-100||t.y>Game.stageHeight*e+100||t.x>Game.stageWidth*e+100||t.x+t.width<-100?1==this.onScreen&&this.hide():0==this.onScreen&&this.show()},t.prototype.destroy=function(){this.container.removeAllChildren()},t}(),Prop=function(){function t(t,e,i,n,o,r){this.scene=t,this.onScreen=!0,this.sprite3d=Game.displayStore.getSprite3d(e),this.sprite3d.proj.euler.x=Game.getRandom(1.3,1.8),this.sprite3d.scale3d.set(n),this.sprite3d.scale3d.x*=o,this.tab=Game.displayStore.getSprite3d("race-scene/white-tab.png"),this.tab.width=20,this.tab.height=30,"race-scene/garage/lamp-post.png"==e&&(this.sprite3d.scale3d.set(.8),this.sprite3d.scale3d.x*=o,this.tab.position.x=-25*o),this.container=Game.displayStore.getContainer3d("race-scene/object-holder"),this.container.position3d.x=i[0],this.container.position3d.y=i[1],this.container.proj.euler.y=r,this.container.position3d.y>0?(this.sprite3d.parentGroup=RaceScene.SORT_GROUP_PROP_FRONT,this.tab.setRegPoint(.5,0)):(this.sprite3d.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.tab.setRegPoint(.5,1)),this.container.addChild(this.tab),this.container.addChild(this.sprite3d),this.tab.parentGroup=RaceScene.SORT_GROUP_PROP_BACK}return t.prototype.setXPos=function(t){this.container.position3d.x=t},t.prototype.tick=function(){var t=this.sprite3d.getBounds(),e=Game.windowScaleFactor;t.y+t.height<0||t.y>Game.stageHeight*e||t.x>Game.stageWidth*e||t.x+t.width<0?1==this.onScreen&&this.hide():0==this.onScreen&&this.show()},t.prototype.show=function(){this.container.visible=!0,this.onScreen=!0},t.prototype.hide=function(){this.container.visible=!1,this.onScreen=!1},t.prototype.destroy=function(){this.container.removeAllChildren()},t}(),Obstacle=function(){function t(t,e){var i=this;this.scene=t,this.onScreen=!0,this.ticker=0,this.type=e,this.active=!0,"bomb"==e&&(this.sprite=Game.displayStore.getAnimatedSprite("race-scene/bomb-frames"),this.sprite.animationSpeed=.2,this.sprite.play(),this.sprite.loop=!0,this.sprite.convertTo3d(),this.sprite.proj.affine=PIXI.projection.AFFINE.AXIS_X,this.sprite.visible=!0,this.sprite.alpha=1,this.explode=Game.displayStore.getAnimatedSprite("race-scene/explode-frames"),this.explode.animationSpeed=.5,this.explode.stop(),this.explode.onComplete=function(){i.explode.gotoAndStop(0),i.explode.visible=0},this.explode.convertTo3d(),this.explode.proj.affine=PIXI.projection.AFFINE.AXIS_X,this.explode.loop=!1,this.explode.visible=!1,this.explode.parentGroup=RaceScene.SORT_GROUP_PROP,this.explode.scale3d.set(2.3,2.3),this.explode.position3d.z=-30,this.explode.position3d.x=10),"gum"==e&&(this.sprite=Game.displayStore.getAnimatedSprite("race-scene/gum-front.png"),this.sprite.convertTo3d(),this.sprite.proj.affine=PIXI.projection.AFFINE.AXIS_X,this.sprite.visible=!0,this.sprite.alpha=1,this.gumGoop=Game.displayStore.getAnimatedSprite("race-scene/gum-goop-frames"),this.gumGoop.animationSpeed=.5,this.gumGoop.stop(),this.gumGoop.onComplete=function(){i.gumGoop.gotoAndStop(0),i.gumGoop.visible=0},this.gumGoop.convertTo3d(),this.gumGoop.proj.affine=PIXI.projection.AFFINE.AXIS_X,this.gumGoop.loop=!1,this.gumGoop.visible=!1,this.gumGoop.parentGroup=RaceScene.SORT_GROUP_PROP,this.gumGoop.scale3d.set(2,2),this.gumGoop.position3d.z=0,this.gumGoop.position3d.x=-20,this.gumGoop.position3d.y=35,this.gumGoop.tint=16777215),"ice"==e&&(this.sprite=Game.displayStore.getAnimatedSprite("race-scene/bathroom/ice-patch.png"),this.sprite.convertTo3d(),this.sprite.visible=!0,this.sprite.alpha=.7,this.sprite.scale.x=2*Game.getRandom(0,1,!0)-1,this.sprite.scale.y=2*Game.getRandom(0,1,!0)-1,this.sprite.scale.x<1&&(this.sprite.position.x=.5*this.sprite.width),this.sprite.blendMode=PIXI.BLEND_MODES.ADD,this.sprite.parentGroup=RaceScene.SORT_GROUP_PROP_BACK),"oil"==e&&(this.sprite=Game.displayStore.getAnimatedSprite("race-scene/garage/oil-slick.png"),this.sprite.convertTo3d(),this.sprite.visible=!0,this.sprite.alpha=.9,this.sprite.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.gumGoop=Game.displayStore.getAnimatedSprite("race-scene/gum-goop-frames"),this.gumGoop.animationSpeed=.5,this.gumGoop.stop(),this.gumGoop.onComplete=function(){i.gumGoop.gotoAndStop(0),i.gumGoop.visible=0},this.gumGoop.convertTo3d(),this.gumGoop.proj.affine=PIXI.projection.AFFINE.AXIS_X,this.gumGoop.loop=!1,this.gumGoop.visible=!1,this.gumGoop.parentGroup=RaceScene.SORT_GROUP_PROP,this.gumGoop.scale3d.set(2,1.5),this.gumGoop.position3d.z=0,this.gumGoop.position3d.x=0,this.gumGoop.position3d.y=35,this.gumGoop.tint=0),this.p2Body=new p2.Body({mass:0,position:[0,0]}),this.scene.physicsManager.addBodyToWorld(this.p2Body),this.p2Shape=new p2.Circle({radius:20}),this.p2Shape.collisionGroup=PhysicsManager.BARRIER,this.p2Shape.collisionMask=PhysicsManager.PLAYER|PhysicsManager.RIVAL,this.p2Shape.sensor=!0,this.p2Body.addShape(this.p2Shape),this.container=Game.displayStore.getContainer3d("race-scene/object-holder"),this.container.position3d.x=this.p2Body.position[0],this.container.position3d.y=Game.stageHeight-this.p2Body.position[1],this.container.visible=!0,"bomb"==e&&(this.sprite.position3d.y=20,this.sprite.position3d.z=-10,this.shadow=Game.displayStore.getSprite3d("race-scene/shadow.png"),this.shadow.blendMode=PIXI.BLEND_MODES.MULTIPLY,this.shadow.alpha=.6,this.shadow.scale.set(.2,.6),this.shadow.position.x=-3,this.shadow.position.y=10,this.shadow.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.shadow.anchor.set(.5,.5),this.sprite.parentGroup=RaceScene.SORT_GROUP_PROP,this.container.addChild(this.shadow),this.container.addChild(this.explode)),"gum"==e&&(this.spriteBack=Game.displayStore.getSprite3d("race-scene/gum.png"),this.spriteBack.proj.affine=PIXI.projection.AFFINE.AXIS_X,this.sprite.proj.affine=PIXI.projection.AFFINE.AXIS_X,this.spriteBack.parentGroup=RaceScene.SORT_GROUP_PROP_BACK,this.container.addChild(this.spriteBack),this.sprite.position3d.y=40,this.sprite.position3d.z=0,this.spriteBack.position3d.y=40,this.spriteBack.position3d.z=0,this.sprite.parentGroup=RaceScene.SORT_GROUP_PROP,this.container.addChild(this.gumGoop)),"oil"==e&&this.container.addChild(this.gumGoop),this.container.addChild(this.sprite)}return t.prototype.setPos=function(t,e){this.tile=t;var i=[t.container.position3d.x+e[0],e[1]];this.p2Body.position[0]=i[0],this.p2Body.position[1]=i[1],this.container.position3d.x=this.p2Body.position[0],this.container.position3d.y=Game.stageHeight-this.p2Body.position[1]},t.prototype.vehicleHit=function(){switch(this.type){case"bomb":this.explode.gotoAndPlay(0),this.explode.visible=!0,this.sprite.visible=!1,this.shadow.visible=!1,this.p2Shape.collisionGroup=PhysicsManager.NONE,this.active=!1;break;case"gum":this.gumGoop.gotoAndPlay(0),this.gumGoop.visible=!0;break;case"oil":this.gumGoop.gotoAndPlay(0),this.gumGoop.visible=!0}},t.prototype.tick=function(){var t=this.container.getBounds(),e=Game.windowScaleFactor;"bomb"==this.type&&(this.sprite.position3d.z=-10*Math.sin(this.ticker/15)-30,this.shadow.scale.x=.1+.025*Math.sin(this.ticker/-15),this.shadow.scale.y=.3+.075*Math.sin(this.ticker/-15),this.shadow.alpha=.5-.25*Math.sin(this.ticker/15)),t.y+t.height<0||t.y>Game.stageHeight*e||t.x>Game.stageWidth*e||t.x+t.width<0?1==this.onScreen&&(this.container.visible=!1,this.onScreen=!1):0==this.onScreen&&(this.container.visible=!0,this.onScreen=!0),this.ticker++},t.prototype.pause=function(){"bomb"==this.type&&(this.sprite.stop(),this.explode.stop())},t.prototype.resume=function(){"bomb"==this.type&&(this.sprite.play(),this.explode.currentFrame>0&&this.explode.play())},t.prototype.destroy=function(){this.container.removeAllChildren(),Game.displayStore.returnPooledItem(this.sprite),Game.displayStore.returnPooledItem(this.shadow),this.explode&&Game.displayStore.returnPooledItem(this.explode)},t}(),Collectable=function(){function t(t,e){this.scene=t,this.onScreen=!0,this.ticker=0,this.collected=!1,this.type=e,this.shine=Game.displayStore.getSprite3d("race-scene/shine.png"),this.shine.blendMode=PIXI.BLEND_MODES.ADD,"powerup"==e?(this.shadow=Game.displayStore.getSprite3d("race-scene/gem-shadow.png"),this.sprite=Game.displayStore.getAnimatedSprite("race-scene/gem-frames"),this.sprite.animationSpeed=.25,this.sprite.convertTo3d(),this.sprite.scale3d.set(1.5,1.5,1.5),this.sprite.proj.affine=PIXI.projection.AFFINE.AXIS_Y,this.sprite.loop=!0,this.sprite.gotoAndPlay(0),this.shadow.scale3d.set(1,1,1),this.shadow.blendMode=PIXI.BLEND_MODES.MULTIPLY,this.shadow.alpha=.3):(this.shadow=Game.displayStore.getSprite3d("race-scene/shadow.png"),this.sprite=Game.displayStore.getSprite3d("race-scene/collect-"+this.type+".png"),this.sprite.scale3d.set(1,1,1),this.shadow.scale3d.set(.1,.1,1),this.shadow.blendMode=PIXI.BLEND_MODES.MULTIPLY,this.shadow.alpha=.6),this.sprite.proj.euler.x=Math.PI/2,this.sprite.position3d.y=0,this.sprite.position3d.z=-20,this.sprite.alpha=1,this.shadow.position.x=0,this.shadow.position.y=0,this.shadow.anchor.set(.5,.5),this.shine.proj.euler.x=Math.PI/2,this.shine.position3d.z=-40,this.p2Body=new p2.Body({mass:0,position:[0,0]}),this.scene.physicsManager.addBodyToWorld(this.p2Body),this.p2Shape=new p2.Circle({radius:20}),this.p2Shape.collisionGroup=PhysicsManager.COLLECTABLE,this.p2Shape.collisionMask="powerup"==e?PhysicsManager.PLAYER:PhysicsManager.PLAYER|PhysicsManager.RIVAL,this.p2Shape.sensor=!0,this.p2Body.addShape(this.p2Shape),this.container=Game.displayStore.getContainer3d("race-scene/object-holder"),this.container.position3d.x=this.p2Body.position[0],this.container.position3d.y=Game.stageHeight-this.p2Body.position[1],this.container.addChild(this.shadow),this.container.addChild(this.shine),this.container.addChild(this.sprite),this.container.parentGroup=RaceScene.SORT_GROUP_PROP}return t.prototype.setPos=function(t,e){this.tile=t;var i=[t.container.position3d.x+e[0],e[1]];this.p2Body.position[0]=i[0],this.p2Body.position[1]=i[1],this.container.position3d.x=this.p2Body.position[0],this.container.position3d.y=Game.stageHeight-this.p2Body.position[1]},t.prototype.playerHit=function(){if(1!=this.collected){this.collected=!0,this.p2Shape.collisionGroup=PhysicsManager.NONE;var t=Math.round(this.sprite.euler.y/Math.PI);this.collectTimeline=this.scene.killTween(this.collectTimeline),this.collectTimeline=new TimelineMax,this.collectTimeline.add([TweenMax.to(this.sprite.position3d,.6,{z:-75,ease:Elastic.easeOut}),TweenMax.to(this.sprite.euler,.1,{y:t*Math.PI,ease:Power3.easeOut}),TweenMax.to(this.container.scale3d,.1,{x:1.5,y:1.5,z:1.5,ease:Power3.easeOut}),TweenMax.to(this.shadow,.1,{alpha:0,ease:Power3.easeOut}),TweenMax.to(this.shadow.scale3d,.1,{x:0,y:0,z:0,ease:Power3.easeOut}),TweenMax.to(this.shine,.3,{alpha:0,ease:Power4.easeOut}),TweenMax.to(this.shine.scale3d,.3,{x:3,y:3,ease:Power4.easeOut})]),this.collectTimeline.add(TweenMax.to(this.sprite,.4,{alpha:0,ease:Power3.easeInOut}),.2)}},t.prototype.tick=function(){0==this.collected&&("coin"==this.type&&(this.sprite.euler.y=this.ticker/15),this.shadow.rotation=this.ticker/15,this.shine.euler.z=this.ticker/30);var t=this.sprite.getBounds(),e=Game.windowScaleFactor;t.y+t.height<0||t.y>Game.stageHeight*e||t.x>Game.stageWidth*e||t.x+t.width<0?1==this.onScreen&&this.hide():0==this.onScreen&&this.show(),this.ticker++},t.prototype.show=function(){this.container.visible=!0,this.onScreen=!0},t.prototype.hide=function(){this.container.visible=!1,this.onScreen=!1},t.prototype.destroy=function(){this.collectTimeline=this.scene.killTween(this.collectTimeline),this.container.removeAllChildren(),Game.displayStore.returnPooledItem(this.shine),Game.displayStore.returnPooledItem(this.sprite),Game.displayStore.returnPooledItem(this.shadow)},t}(),Ramp=function(){function t(t){var e=this;this.scene=t,this.onScreen=!0,this.spriteFront=Game.displayStore.getSprite3d("race-scene/ramp-side.png"),this.spriteFront.proj.euler.x=Math.PI/2,this.spriteFront.position3d.y=40,this.spriteFront.position3d.z=0,this.spriteFront.parentGroup=RaceScene.SORT_GROUP_PROP,this.spriteBack=Game.displayStore.getSprite3d("race-scene/ramp-side.png"),this.spriteBack.proj.euler.x=Math.PI/2,this.spriteBack.position3d.y=-40,this.spriteBack.position3d.z=0,this.spriteBack.parentGroup=RaceScene.SORT_GROUP_PROP,this.topContainer=Game.displayStore.getContainer3d("race-scene/ramp-top"),this.topContainer.proj.euler.y=.3,this.topContainer.position3d.y=0,this.topContainer.position3d.z=0,this.topContainer.parentGroup=RaceScene.SORT_GROUP_PROP,this.spriteTop=Game.displayStore.getAnimatedSprite("race-scene/ramp-frames"),this.spriteTop.animationSpeed=.2,this.spriteTop.gotoAndPlay(Game.getRandom(0,3,!0)),this.spriteTop.convertTo3d(),this.spriteTop.play(),this.topContainer.addChild(this.spriteTop),this.spriteTopGlow=Game.displayStore.getSprite3d("race-scene/ramp-top-glow.png"),this.topContainer.addChild(this.spriteTopGlow),this.spriteTopGlow.alpha=0,this.boost=Game.displayStore.getAnimatedSprite("race-scene/ramp-boost-frames"),this.boost.animationSpeed=.5,this.boost.gotoAndStop(0),this.boost.loop=!1,this.boost.rotation=Math.PI/2,this.boost.position.x=70,this.boost.blendMode=PIXI.BLEND_MODES.ADD,this.boost.visible=!1,this.boost.onComplete=function(){e.boost.gotoAndStop(0),e.boost.visible=!1},this.boost.scale.set(2.2,2.2),this.topContainer.addChild(this.boost),this.p2Body=new p2.Body({mass:0,position:[0,0]}),this.scene.physicsManager.addBodyToWorld(this.p2Body),this.jumpSensor=new p2.Circle({radius:20}),this.jumpSensor.collisionGroup=PhysicsManager.RAMP,this.jumpSensor.collisionMask=PhysicsManager.PLAYER|PhysicsManager.RIVAL,this.jumpSensor.sensor=!0,this.p2Body.addShape(this.jumpSensor,[30,0]),this.p2Shape=new p2.Box({width:120,height:80}),this.p2Shape.collisionGroup=PhysicsManager.BARRIER,this.p2Shape.collisionMask=PhysicsManager.PLAYER|PhysicsManager.RIVAL,this.container=Game.displayStore.getContainer3d("race-scene/object-holder"),this.container.position3d.x=this.p2Body.position[0],this.container.position3d.y=Game.stageHeight-this.p2Body.position[1],this.container.visible=!0,this.container.alpha=1,this.container.addChild(this.spriteFront),this.container.addChild(this.spriteBack),this.container.addChild(this.topContainer)}return t.prototype.setPos=function(t,e){this.tile=t;var i=[t.container.position3d.x+e[0],e[1]];this.p2Body.position[0]=i[0],this.p2Body.position[1]=i[1],this.container.position3d.x=this.p2Body.position[0],this.container.position3d.y=Game.stageHeight-this.p2Body.position[1]},t.prototype.vehicleHit=function(){this.spriteTopGlow.alpha=1,TweenMax.delayedCall(.1,function(){this.boost.gotoAndPlay(0),this.boost.visible=!0},null,this),TweenMax.to(this.spriteTopGlow,.6,{ease:Expo.easeInOut,alpha:0})},t.prototype.tick=function(){var t=this.container.getBounds(),e=Game.windowScaleFactor;t.y+t.height<0||t.y>Game.stageHeight*e||t.x>Game.stageWidth*e||t.x+t.width<0?1==this.onScreen&&(this.container.visible=!1,this.onScreen=!1):0==this.onScreen&&(this.container.visible=!0,this.onScreen=!0)},t.prototype.pause=function(){this.spriteTop.stop()},t.prototype.resume=function(){this.spriteTop.play()},t.prototype.destroy=function(){this.container.removeAllChildren(),Game.displayStore.returnPooledItem(this.container),Game.displayStore.returnPooledItem(this.spriteFront),Game.displayStore.returnPooledItem(this.topContainer),Game.displayStore.returnPooledItem(this.spriteTop),Game.displayStore.returnPooledItem(this.spriteBack),Game.displayStore.returnPooledItem(this.spriteSide)},t}(),InteractionManager=function(){function t(t){this.brakingThreshold=150,this.scene=t,this.touchPoints=[new PIXI.Point,new PIXI.Point],this.keysDown=new Object,this.ticker=0,this.touching=!1,this.braking=!1,this.targetingVehicle=!1,this.targetLocked=!1,this.indicatedLaneChangeAmount=0,this.showingIndicators=!1,this.container=Game.displayStore.getContainer("race-scene/interaction-holder"),this.container.interactive=!0,this.targetRingScale=0,this.targetRingAlpha=0,this.lastTargetLane=this.scene.player.currentLane,this.targetLane=this.scene.player.currentLane,this.powerupIndicatorHolder=Game.displayStore.getContainer3d("race-scene/powerup-indicator-holder"),this.powerupIndicatorHolder.position3d.x=180,this.powerupIndicatorHolder.scale3d.set(2,2,2),this.powerupIndicatorHolder.alpha=0,this.powerupTarget=Game.displayStore.getSprite3d("race-scene/enemy-target.png"),this.powerupTarget.blendMode=PIXI.BLEND_MODES.ADD,this.powerupTarget.parentGroup=RaceScene.SORT_GROUP_FLOOR;var e,i;this.powerupIndicators=[];for(o=0;o<10;o++){var n=Game.displayStore.getSprite3d("race-scene/powerup-indicator");this.powerupIndicatorHolder.addChild(n),n.position.x=n.width*o,n.position.y=0,n.blendMode=PIXI.BLEND_MODES.ADD,n.parentGroup=RaceScene.SORT_GROUP_FLOOR,e=n.width,i=n.height,this.powerupIndicators.push({sprite:n,targetAlpha:0})}this.powerupShape=new p2.Box({width:10*e*2,height:i}),this.powerupShape.collisionGroup=PhysicsManager.NONE,this.powerupShape.collisionMask=PhysicsManager.NONE,this.powerupShape.sensor=!0,this.powerupBody=new p2.Body({mass:0}),this.scene.physicsManager.addBodyToWorld(this.powerupBody),this.powerupBody.addShape(this.powerupShape,[10*e+150,0]),this.moveIndicators=[];for(var o=0;o<5;o++){var r=Game.displayStore.getSprite3d("race-scene/move-indicate");r.blendMode=PIXI.BLEND_MODES.ADD,r.alpha=0,r.position3d.x=120,r.position3d.y=this.scene.trackManager.gridSize*o+this.scene.trackManager.gridSize/2,r.scale3d.set(2,2,2),r.parentGroup=RaceScene.SORT_GROUP_FLOOR,this.scene.player.container.addChild(r),this.moveIndicators.push({sprite:r,targetAlpha:0})}this.scene.player.carContainer.addChild(this.powerupIndicatorHolder),this.startTouchPoint=new PIXI.Point,this.currentTouchPoint=new PIXI.Point,this.touchLine=new PIXI.mesh.Rope(Game.displayStore.getSprite("race-scene/snake.png").texture,this.touchPoints),this.touchLine.tint=4962678,this.touchLine.blendMode=PIXI.BLEND_MODES.ADD,this.touchLine.interactive=!1,this.touchRing=Game.displayStore.getSprite("race-scene/touch-current"),this.touchRing.alpha=0,this.touchRing.tint=4962678,this.touchRing.interactive=!1,this.touchRing.interactive=!1,this.touchRing.blendMode=PIXI.BLEND_MODES.ADD,this.powerupButton=new PowerupButton(this),this.container.addChild(this.touchRing),this.container.addChild(this.touchLine),this.touchSprite=Game.displayStore.getSprite("race-scene/blank-input"),this.touchSprite.width=Game.stageWidth,this.touchSprite.height=Game.stageHeight,this.touchSprite.alpha=0,this.touchSprite.position.set(0,0),this.touchSprite.interactive=!0,this.container.interactive=!0,this.addInteraction(),this.container.addChild(this.powerupButton.container),this.container.addChild(this.touchSprite)}return t.prototype.targetVehicle=function(t){this.powerupTarget.tint=16777215,this.targetLocked=!1,this.targetingVehicle=!0,this.powerupTarget.scale.set(2,2),TweenMax.to(this.powerupTarget.scale,.5,{x:1.5,y:1.5,ease:Elastic.easeOut}),this.powerupTarget.position.x=0,t.carContainer.addChild(this.powerupTarget)},t.prototype.stopTargetVehicle=function(){this.targetingVehicle=!1,this.powerupTarget.parent&&this.powerupTarget.parent.removeChild(this.powerupTarget)},t.prototype.lockTarget=function(){this.powerupTarget.tint=16711680,this.targetLocked=!0,this.powerupTarget.alpha=1,this.powerupTarget.scale.set(2.5,2.5);var t=new RoughEase({strength:10,points:10,taper:"none",randomize:!1,clamp:!0});TweenMax.to(this.powerupTarget.scale,1,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.powerupTarget,1,{alpha:0,ease:t})},t.prototype.addInteraction=function(){var t=this,e=this.container;console.log("add interaction"),Game.onDesktop||(e.on("touchstart",function(e){t.touchStart(t,e)}),e.on("touchend",function(e){t.touchEnd(t,e)}),e.on("touchendoutside",function(e){t.touchEndOutside(t,e)}),e.on("touchmove",function(e){t.touchMove(t,e)}))},t.prototype.touchStart=function(t,e){this.touching=!0;var i=new PIXI.Point;i.x=e.data.getLocalPosition(this.container).x,i.y=e.data.getLocalPosition(this.container).y,this.inputDown(this,i),this.touchRing.scale.x=this.touchRing.scale.y=0,TweenMax.to(this.touchRing.scale,.2,{x:1,y:1,ease:Back.easeOut})},t.prototype.hideIndicator=function(t){if(this.targetLane!=t){this.targetLane=t;for(var e=0;e<this.moveIndicators.length;e++){this.moveIndicators[e].sprite;this.moveIndicators[e].targetAlpha=0}}},t.prototype.touchMove=function(t,e){0!=this.touching&&(t.currentTouchPoint.x=e.data.getLocalPosition(t.container).x,t.currentTouchPoint.y=e.data.getLocalPosition(t.container).y)},t.prototype.touchEnd=function(t,e){t.inputUp(t,e.data.getLocalPosition(t.container))},t.prototype.touchEndOutside=function(t,e){t.inputUp(t,e.data.getLocalPosition(t.container))},t.prototype.inputDown=function(t,e){this.playerLaneOnTouch=this.scene.player.currentLane,t.startTouchPoint.x=t.currentTouchPoint.x=e.x,t.startTouchPoint.y=t.currentTouchPoint.y=e.y,t.touchRing.position.x=t.currentTouchPoint.x,t.touchRing.position.y=t.currentTouchPoint.y,t.touchLine.alpha=1,t.touchRing.alpha=1},t.prototype.inputUp=function(t,e){t.interactionTimer=t.scene.killTween(t.interactionTimer),this.touching=!1,this.targetRingScale=0,this.targetRingAlpha=0,1==this.braking&&this.stopBraking()},t.prototype.flipIndicatorArrows=function(t){var e;e=1==t?0:Math.PI;for(var i=0;i<this.moveIndicators.length;i++)this.moveIndicators[i].sprite.euler.z=e},t.prototype.keyDown=function(t){1==this.scene.started&&0==this.scene.endingRace&&("up"==t&&(++this.targetLane>4&&(this.targetLane=4),this.playerLaneOnTouch=this.scene.player.targetLane,this.showChangeLanePrediction(this.targetLane-this.playerLaneOnTouch)),"down"==t&&(--this.targetLane<0&&(this.targetLane=0),this.playerLaneOnTouch=this.scene.player.targetLane,this.showChangeLanePrediction(this.targetLane-this.playerLaneOnTouch)),"left"==t&&this.scene.player.brake(),"spacebar"==t&&this.activatePowerup())},t.prototype.keyUp=function(t){"left"==t&&this.scene.player.stopBraking()},t.prototype.collectPowerup=function(){this.powerupShape.collisionGroup=PhysicsManager.POWERUP,this.powerupShape.collisionMask=PhysicsManager.RIVAL,this.powerupButton.setState("ready"),this.showPowerupIndicators()},t.prototype.activatePowerup=function(){"ready"==this.powerupButton.state&&"aiming"==this.scene.powerup.status&&(this.powerupButton.setState("not-ready"),this.scene.activatePowerup(),this.powerupShape.collisionGroup=PhysicsManager.NONE,this.powerupShape.collisionMask=PhysicsManager.NONE,this.hidePowerupIndicators())},t.prototype.showPowerupIndicators=function(){if(1!=this.showingIndicators){this.showingIndicators=!0;var t=new RoughEase({template:Sine.easeOut,strength:10,points:5,taper:"none",randomize:!1,clamp:!0});TweenMax.to(this.powerupIndicatorHolder,.2,{alpha:.7,ease:t})}},t.prototype.hidePowerupIndicators=function(){if(0!=this.showingIndicators){this.showingIndicators=!1;var t=new RoughEase({template:Sine.easeOut,strength:10,points:5,taper:"none",randomize:!1,clamp:!0});TweenMax.to(this.powerupIndicatorHolder,.2,{alpha:0,ease:t})}},t.prototype.startRace=function(){},t.prototype.raceComplete=function(){this.hidePowerupIndicators(),this.powerupButton.setState("disabled")},t.prototype.isTouching=function(){return this.touching},t.prototype.getTouchDistance=function(){return this.scene.getDistance(this.currentTouchPoint,this.startTouchPoint)},t.prototype.getTouchAngle=function(){return this.scene.getAngle(this.currentTouchPoint,this.startTouchPoint)},t.prototype.tick=function(){if(this.powerupButton.tick(),this.powerupBody.position[0]=this.scene.player.p2Body.position[0],this.powerupBody.position[1]=this.scene.player.p2Body.position[1],0==this.targetLocked&&(this.powerupTarget.rotation+=.1,this.powerupTarget.alpha=.75+.25*Math.sin(this.ticker/10)),this.touchRing.position.x=this.currentTouchPoint.x,this.touchRing.position.y=this.currentTouchPoint.y,1==this.touching){this.touchPoints[0].x=this.startTouchPoint.x,this.touchPoints[0].y=this.startTouchPoint.y,this.touchPoints[1].x=this.currentTouchPoint.x+-38*Math.cos(this.scene.getAngle(this.currentTouchPoint,this.startTouchPoint)),this.touchPoints[1].y=this.currentTouchPoint.y+38*Math.sin(this.scene.getAngle(this.currentTouchPoint,this.startTouchPoint)),this.currentTouchPoint.x<this.startTouchPoint.x-this.brakingThreshold?(this.touchLine.tint=16711680,this.touchRing.tint=16711680,0==this.braking&&this.startBraking()):(this.touchLine.tint=4962678,this.touchRing.tint=4962678,1==this.braking&&this.stopBraking());var t=Math.abs(this.startTouchPoint.y-this.currentTouchPoint.y),e=120/Game.windowScaleFactor,i=Math.round(t/e);this.currentTouchPoint.y<this.startTouchPoint.y?this.showChangeLanePrediction(i):this.showChangeLanePrediction(-i)}else this.touchPoints[0].x+=(this.currentTouchPoint.x-this.touchPoints[0].x)/5,this.touchPoints[0].y+=(this.currentTouchPoint.y-this.touchPoints[0].y)/5,this.touchRing.alpha+=(this.targetRingAlpha-this.touchRing.alpha)/5,this.touchRing.scale.x+=(this.targetRingScale-this.touchRing.scale.x)/5,this.touchRing.scale.y+=(this.targetRingScale-this.touchRing.scale.y)/5;var n=this.scene.getDistance(this.touchPoints[0],this.currentTouchPoint);this.touchLine.alpha=n/100,this.touchLine.alpha>1&&(this.touchLine.alpha=1),this.targetLane==this.scene.player.currentLane&&this.moveIndicators[this.targetLane].targetAlpha>0&&(this.moveIndicators[this.targetLane].targetAlpha=0);for(r=0;r<this.moveIndicators.length;r++){var o=this.moveIndicators[r].sprite;this.targetLane==this.scene.player.currentLane&&(this.moveIndicators[r].targetAlpha=0),o.alpha+=(this.moveIndicators[r].targetAlpha-o.alpha)/4}for(var r=0;r<this.powerupIndicators.length;r++)this.powerupIndicators[r].sprite.alpha=.5+Math.sin(r-this.ticker/6)/2;this.ticker++},t.prototype.startBraking=function(){this.braking=!0,this.scene.player.brake()},t.prototype.stopBraking=function(){this.braking=!1,this.scene.player.stopBraking()},t.prototype.showChangeLanePrediction=function(t){var e;e=t<0?Math.abs(this.playerLaneOnTouch):Math.abs(-4+this.playerLaneOnTouch);var i=Math.abs(t);i>e&&(i=e),this.indicatedLaneChangeAmount=t<0?-i:i;var n;(n=this.playerLaneOnTouch+this.indicatedLaneChangeAmount)>RaceScene.lanePositions.length-1&&(n=RaceScene.lanePositions.length-1),n<0&&(n=0),n>this.scene.player.currentLane?this.flipIndicatorArrows(-1):n<this.scene.player.currentLane&&this.flipIndicatorArrows(1),this.targetLane=n,this.scene.player.targetLane!=n&&this.scene.player.getCurrentStatus()==Vehicle.STATUS_DEFAULT&&this.scene.player.changeLane(n);for(var o=0;o<this.moveIndicators.length;o++)o==RaceScene.lanePositions.length-1-n?(this.moveIndicators[o].targetAlpha=1,this.moveIndicators[o].sprite.alpha=1):this.moveIndicators[o].targetAlpha=0;this.lastTargetLane=n},t.prototype.highlightRivalsInLane=function(t){for(var e=0;e<this.scene.rivals.length;e++){var i=this.scene.rivals[e];i.p2Body.overlaps(this.scene.player.p2Body)?i.highlight():i.removeHighlight()}},t.prototype.getAngle=function(t,e,i,n){if(t==i&&e==n)return 0;var o=t-i,r=n-e;return Math.atan2(r,o)},t.prototype.destroy=function(){this.touchSprite.removeAllListeners(),this.container.removeAllChildren(),this.interactionTimer=this.scene.killTween(this.interactionTimer),this.popOutAnimation=this.scene.killTween(this.popOutAnimation),this.popupDelay=this.scene.killTween(this.popupDelay),this.touchLine.destroy(),this.powerupButton.destroy()},t}(),TrackManager=function(){function t(t,e){this.scene=t,this.onScreen=!0,this.container=Game.displayStore.getContainer3d("race-scene/track-holder"),this.track=e,this.ticker=0,this.raceLength=80,this.backEdgeScreenY=0,this.trackBody=new p2.Body({mass:0}),this.scene.physicsManager.addBodyToWorld(this.trackBody),this.topBorder=new p2.Plane,this.trackBody.addShape(this.topBorder),this.tiles=[],this.createTiles(),this.gridSize=this.tileSize/5,this.props=[],this.obstacles=[],this.collectables=[],this.ramps=[],this.createScenery(),this.createObstacles(),this.createRamps(),this.createCollectables()}return t.prototype.createTiles=function(){for(var t,e=0;e<this.raceLength;e++){var i;e==this.raceLength-3?t=i=new Tile(this,e,!0):i=new Tile(this,e),this.tiles.push(i);var n=(i.sprite3d.width-1)*RaceScene.levelScale;i.container.position3d.x=e*n,this.container.addChild(i.container),this.tileSize=n,i.show()}this.scene.surfaceLayer.addChild(this.container),this.raceEndSensorBody=new p2.Body({mass:0,position:[t.container.position3d.x+t.sprite3d.width*RaceScene.levelScale/2,Game.stageHeight-(t.sprite3d.position3d.y+t.sprite3d.height*RaceScene.levelScale/2)]}),this.scene.physicsManager.addBodyToWorld(this.raceEndSensorBody),this.raceEndSensorShape=new p2.Box({width:t.sprite3d.width*RaceScene.levelScale,height:t.sprite3d.height*RaceScene.levelScale}),this.raceEndSensorBody.addShape(this.raceEndSensorShape),this.raceEndSensorShape.collisionGroup=PhysicsManager.SENSOR,this.raceEndSensorShape.collisionMask=PhysicsManager.PLAYER|PhysicsManager.RIVAL,this.raceEndSensorShape.sensor=!0},t.prototype.createScenery=function(){function t(t,i,n){for(var o=0;o<t;o++){var a=n+Game.getRandom(-10,10),s=[r,a],l=Game.getRandom(.7,1),c=2*Game.getRandom(0,1,!0)-1,h=i.length,p=Math.round(t/h),u=i[Math.floor(o/p)],d=new Prop(e.scene,u,s,l,c,0);e.props.push(d),e.scene.surfaceLayer.addChild(d.container)}}var e=this,i=Game.coreData.getTrackAssets(this.track);t(100,i,-120),t(100,i,-60),t(100,i,this.tileSize+60),t(100,i,this.tileSize+90),this.scene.shuffleArray(this.props);for(var n=0;n<this.props.length;n++){var o=(e.tiles.length-1)*e.tileSize/this.props.length,r=800+o*n+Game.getRandom(-o/2,o/2);this.props[n].setXPos(r)}},t.prototype.createObstacles=function(){var t=["bomb"];"living-room"==Game.coreData.getCurrentTrack()&&t.push("gum"),"bathroom"==Game.coreData.getCurrentTrack()&&t.push("ice"),"garage"==Game.coreData.getCurrentTrack()&&t.push("oil");for(var e=CoreData.trackData[this.track].bombs+CoreData.trackData[this.track].secondaryObstacles,i=CoreData.trackData[this.track].bombs,n=this.tiles.length-4,o=0;o<e;o++){var r;r=o<i?t[0]:t[1];a=new Obstacle(this.scene,r);this.scene.surfaceLayer.addChild(a.container),this.obstacles.push(a)}this.scene.shuffleArray(this.obstacles);for(o=0;o<this.obstacles.length;o++){var a=this.obstacles[o],s=Game.getRandom(0,1),l=.6*n-Math.round(s*n);l<3&&(l=3);var c=Game.getRandom(l,n,!0),h=this.chooseRandomPosition(this.tiles[c]),p=[this.gridSize*(h[0]+1),this.gridSize*(h[1]+1)+40];a.setPos(this.tiles[c],p),this.tiles[c].registerItem(h,a.type)}},t.prototype.createRamps=function(){var t=CoreData.trackData[this.track].ramps,e=this.tiles.length-4,i=t/e;console.log(e,t,i,this.scene.difficulty);for(n=0;n<t;n++){o=new Ramp(this.scene);this.scene.surfaceLayer.addChild(o.container),this.ramps.push(o)}for(var n=0;n<this.ramps.length;n++){var o=this.ramps[n],r=Game.getRandom(0,1),a=.2*e-Math.round(r*e);a<2&&(a=2);var s=Game.getRandom(a,e,!0),l=this.chooseRandomPosition(this.tiles[s],[{type:"bomb",positions:[[-1,0],[-2,0]]},{type:"gum",positions:[[1,0],[-1,0],[-2,0]]}]),c=[this.gridSize*(l[0]+1),this.gridSize*(l[1]+1)+40];o.setPos(this.tiles[s],c),this.tiles[s].registerItem(l,"ramp")}},t.prototype.createCollectables=function(){for(var t=["powerup","coin"],e=CoreData.trackData[this.track].coins+CoreData.trackData[this.track].powerups,i=CoreData.trackData[this.track].powerups,n=this.tiles.length-4,o=0;o<e;o++){var r;r=o<i?t[0]:t[1];a=new Collectable(this.scene,r);this.scene.surfaceLayer.addChild(a.container),this.collectables.push(a)}this.scene.shuffleArray(this.collectables);for(o=0;o<this.collectables.length;o++){var a=this.collectables[o],s=Game.getRandom(0,1),l=.2*n-Math.round(s*n);l<3&&(l=3);var c=Game.getRandom(l,n,!0),h=this.chooseRandomPosition(this.tiles[c]),p=[this.gridSize*(h[0]+1),this.gridSize*(h[1]+1)+40];a.setPos(this.tiles[c],p),this.tiles[c].registerItem(h,a.type)}},t.prototype.getObstacleType=function(t){for(var e,i=0;i<this.obstacles.length;i++)this.obstacles[i].p2Body==t&&(e=this.obstacles[i].type);return e},t.prototype.getCollectableType=function(t){for(var e,i=0;i<this.collectables.length;i++)this.collectables[i].p2Body==t&&(e=this.collectables[i].type);return e},t.prototype.chooseRandomPosition=function(t,e){function i(){var e=[],r=[];e[0]=Game.getRandom(0,RaceScene.lanePositions.length-1,!0),e[1]=Game.getRandom(0,RaceScene.lanePositions.length-1,!0),r.push(e);for(s=0;s<n.length;s++)for(l=0;l<n[s].positions.length;l++)r.push([e[0]+n[s].positions[l][0],e[1]+n[s].positions[l][1]]);for(var a=!1,s=0;s<r.length;s++)for(var l=0;l<n.length;l++)0==t.isBlockAvailable(r[s],n[l].type)&&(a=!0);if(1!=a)return o[0]=e[0],void(o[1]=e[1]);i()}var n,o=[];return e?n=e:(n=[]).push({type:"any",positions:[[0,0]]}),i(),o},t.prototype.hitObstacle=function(t){for(var e=0;e<this.obstacles.length;e++)t==this.obstacles[e].p2Body&&this.obstacles[e].vehicleHit()},t.prototype.hitRamp=function(t){for(var e=0;e<this.ramps.length;e++)t==this.ramps[e].p2Body&&this.ramps[e].vehicleHit()},t.prototype.hitCollectable=function(t){for(var e=0;e<this.collectables.length;e++)t==this.collectables[e].p2Body&&this.collectables[e].playerHit()},t.prototype.getTileIndex=function(t){return Math.ceil(t/this.tileSize)},t.prototype.pause=function(){for(t=0;t<this.obstacles.length;t++)this.obstacles[t].pause();for(var t=0;t<this.ramps.length;t++)this.ramps[t].pause()},t.prototype.resume=function(){for(t=0;t<this.obstacles.length;t++)this.obstacles[t].resume();for(var t=0;t<this.ramps.length;t++)this.ramps[t].resume()},t.prototype.tick=function(){if(this.ticker%2==0){for(t=0;t<this.tiles.length;t++)this.tiles[t].tick();for(t=0;t<this.props.length;t++)this.props[t].tick()}for(t=0;t<this.obstacles.length;t++)this.obstacles[t].tick();for(var t=0;t<this.collectables.length;t++)this.collectables[t].tick();this.backEdgeScreenY=this.scene.mainHolder.toLocal(new PIXI.Point(this.scene.player.scenePos.x,-200),this.container,new PIXI.Point).y,this.ticker++},t.prototype.destroy=function(){for(t=0;t<this.tiles.length;t++)this.tiles[t].destroy();for(t=0;t<this.obstacles.length;t++)this.obstacles[t].destroy();for(t=0;t<this.ramps.length;t++)this.ramps[t].destroy();for(t=0;t<this.collectables.length;t++)this.collectables[t].destroy();for(var t=0;t<this.props.length;t++)this.props[t].destroy()},t}(),PhysicsManager=function(){function t(t){this.physicsEnabled=!0,this.resizeRatio=1,this.scene=t,this.shapesColour=16711680,this.springsColour=255,this.constraintsColour=65280}return t.prototype.initPhysicsWorld=function(){this.world=new p2.World({gravity:[0,0]}),this.speed=30,this.world.broadphase=new p2.NaiveBroadphase(1);var t=this;this.world.on("beginContact",function(e){t.checkCollision(t,e)}),this.world.on("endContact",function(e){t.checkEndCollision(t,e)}),this.world.on("postStep",function(t){}),this.world.sleepMode=p2.World.BODY_SLEEPING,this.physicsEnabled=!0},t.prototype.setWorldSpeed=function(t){this.speed=30/t},t.prototype.checkCollision=function(e,i){var n,o;if(i.bodyA==this.scene.player.p2Body||i.bodyB==this.scene.player.p2Body)n=i.bodyA===this.scene.player.p2Body?i.bodyA:i.bodyB;else for(var r=0;r<this.scene.rivals.length;r++)i.bodyA!=this.scene.rivals[r].p2Body&&i.bodyB!=this.scene.rivals[r].p2Body||(n=i.bodyA===this.scene.rivals[r].p2Body?i.bodyA:i.bodyB);o=i.bodyA===n?i.bodyB:i.bodyA,this.testShapes(i.shapeA,i.shapeB,t.RIVAL,t.PLAYER)?this.scene.playerHitRival(n,o):this.testShapes(i.shapeA,i.shapeB,t.RIVAL,t.RIVAL)?this.scene.rivalHitRival(n,o):this.testShapes(i.shapeA,i.shapeB,t.POWERUP,t.RIVAL)?this.scene.rivalHitPowerup(o):this.testShapes(i.shapeA,i.shapeB,t.SENSOR,t.PLAYER)?this.scene.playerHitSensor(o):this.testShapes(i.shapeA,i.shapeB,t.SENSOR,t.RIVAL)?this.scene.rivalHitSensor(o,n):this.testShapes(i.shapeA,i.shapeB,t.BARRIER,t.PLAYER)?this.scene.vehicleHitObstacle(o,n):this.testShapes(i.shapeA,i.shapeB,t.BARRIER,t.RIVAL)?this.scene.vehicleHitObstacle(o,n):this.testShapes(i.shapeA,i.shapeB,t.RAMP,t.PLAYER)?this.scene.vehicleHitRamp(o,n):this.testShapes(i.shapeA,i.shapeB,t.RAMP,t.RIVAL)?this.scene.vehicleHitRamp(o,n):this.testShapes(i.shapeA,i.shapeB,t.COLLECTABLE,t.PLAYER)?this.scene.playerHitCollectable(o):this.testShapes(i.shapeA,i.shapeB,t.COLLECTABLE,t.RIVAL)&&this.scene.rivalHitCollectable(o,n)},t.prototype.checkEndCollision=function(e,i){var n,o;if(i.bodyA==this.scene.player.p2Body||i.bodyB==this.scene.player.p2Body)n=i.bodyA===this.scene.player.p2Body?i.bodyA:i.bodyB;else for(var r=0;r<this.scene.rivals.length;r++)i.bodyA!=this.scene.rivals[r].p2Body&&i.bodyB!=this.scene.rivals[r].p2Body||(n=i.bodyA===this.scene.rivals[r].p2Body?i.bodyA:i.bodyB);o=i.bodyA===n?i.bodyB:i.bodyA,this.testShapes(i.shapeA,i.shapeB,t.RIVAL,t.PLAYER)?this.scene.vehicleStopHitVehicle(n,o):this.testShapes(i.shapeA,i.shapeB,t.RIVAL,t.RIVAL)?this.scene.vehicleStopHitVehicle(n,o):this.testShapes(i.shapeA,i.shapeB,t.RIVAL,t.POWERUP)&&this.scene.rivalStopHitPowerup(o)},t.prototype.testShapes=function(t,e,i,n){var o=!1;return t.collisionGroup==i&&e.collisionGroup==n&&(o=!0),t.collisionGroup==n&&e.collisionGroup==i&&(o=!0),o},t.prototype.testBodies=function(t,e,i,n){for(var o,r,a=0;a<t.shapes.length;a++)t.shapes[a].collisionGroup==i&&(o=t,r=e);for(a=0;a<e.shapes.length;a++)e.shapes[a].collisionGroup==i&&(o=e,r=t);if(n&&r)for(a=0;a<r.shapes.length;a++)r.shapes[a].collisionGroup!=n&&(o=null);return{a:o,b:r}},t.prototype.flipGravity=function(){for(var t=0;t<this.world.bodies.length;t++)this.world.bodies[t].gravityScale*=-1},t.prototype.getCircleElements=function(){var t=new p2.Body({mass:1}),e=new p2.Circle({radius:75}),i=new p2.Circle({radius:50});return t.addShape(e,[50,30]),t.addShape(i,[-80,20]),t.position[0]=Game.getRandom(100,Game.stageWidth-100),t.position[1]=Game.getRandom(100,Game.stageHeight-100),t.applyImpulse([Game.getRandom(-200,200),Game.getRandom(-200,200)]),this.world.addBody(t),{body:t,shape:e}},t.prototype.getSquareElements=function(){var t=new p2.Body({mass:1}),e=new p2.Box({width:95,height:95});return t.addShape(e,[20,75]),t.position[0]=Game.getRandom(100,Game.stageWidth-100),t.position[1]=Game.getRandom(100,Game.stageHeight-100),t.applyImpulse([Game.getRandom(-200,200),Game.getRandom(-200,200)]),t.angularVelocity=Game.getRandom(-5,5),this.world.addBody(t),{body:t,shape:e}},t.prototype.getPlaneElements=function(){var t=new p2.Body({mass:0}),e=new p2.Plane;return t.addShape(e),this.world.addBody(t),{body:t,shape:e}},t.prototype.createComplexShape=function(t,e,i,n,o,r){for(var a=[],s=o||[0,0],l=r||[0,0],c=0;c<e.shape.length;c++)c%2==1&&a.push([e.shape[c-1]+s[0],-e.shape[c]-s[1]]);a.reverse();var h=new p2.Convex({vertices:a});t.addShape(h,[-s[0]-l[0],s[1]-l[1]]);var p=t.shapes[t.shapes.length-1];i&&(p.collisionGroup=i),n&&(p.collisionMask=n)},t.prototype.scaleShapes=function(t,e){for(var i=[],n=0;n<t.length;n++){for(var o=t[n].shape,r=[],a=0;a<o.length;a++){var s=o[a]*e/2;r.push(s)}i.push({shape:r})}return i},t.prototype.centraliseVertices=function(t){for(var e=[],i=0;i<t.length;i++){for(var n=[],o=Number.MAX_VALUE,r=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE,l=t[i].shape,c=0;c<l.length;c++)c%2==0?((l[c]<o||!o)&&(o=l[c]),(l[c]>a||!a)&&(a=l[c])):((l[c]<r||!r)&&(r=l[c]),(l[c]>s||!s)&&(s=l[c]));n[0]=-o-(a-o)/2,n[1]=-r-(s-r)/2,e.push({data:t[i],offset:n})}return e},t.prototype.resetBody=function(t){t.invMass=1/t.mass,t.invInertia=1/t.inertia,t.angularVelocity=0,t.angularForce=0,t.angle=0,t.velocity=[0,0],t.setZeroForce()},t.prototype.addBodyToWorld=function(t){this.world.addBody(t)},t.prototype.removeBodyFromWorld=function(t){this.world.removeBody(t)},t.prototype.removeConstraintFromWorld=function(t){this.world.removeConstraint(t)},t.prototype.addConstraintToWorld=function(t){this.world.addConstraint(t)},t.prototype.removeSpringFromWorld=function(t){this.world.removeSpring(t)},t.prototype.addSpringToWorld=function(t){this.world.addSpring(t)},t.prototype.resizeElements=function(t,e){this.canvasHeight=e,this.canvasWidth=t,this.canvasOrigHeight&&(this.resizeRatio=this.canvasHeight/this.canvasOrigHeight)},t.prototype.stepPhysics=function(){0!=this.physicsEnabled&&this.world&&this.world.step(1/this.speed)},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.destroy=function(){this.world.clear(),this.world=null},t.BARRIER=Math.pow(2,1),t.PLAYER=Math.pow(2,2),t.RIVAL=Math.pow(2,3),t.COLLECTABLE=Math.pow(2,4),t.RAY=Math.pow(2,5),t.PLAYER_DETECT=Math.pow(2,6),t.NONE=Math.pow(2,7),t.SENSOR=Math.pow(2,8),t.RAMP=Math.pow(2,9),t.POWERUP=Math.pow(2,10),t}(),Hud=function(){function t(t){this.meterMarginLeft=23,this.meterMarginRight=30,this.scene=t,this.ticker=0,this.lastPlayerPosition=4,this.currentCoins=Game.coreData.getCurrentCoins(),this.startingCoins=this.currentCoins,this.progressMarkers=[],this.container=Game.displayStore.getContainer("race-scene/hud-container"),this.progressMeterHolder=Game.displayStore.getContainer("race-scene/progress-meter-holder"),this.progressMeter=this.progressMeterHolder.getSprite("race-scene/progress-meter.png"),this.racePositionHolder=this.progressMeterHolder.getContainer("race-scene/race-position-holder"),this.racePositionTextHolder=this.racePositionHolder.getContainer("race-scene/race-position-text-holder"),this.racePositionTextHolder.rotation=-.15,this.racePositionTextHolder.showOnlyChild(4),this.coinHolder=Game.displayStore.getContainer("race-scene/coin-container"),this.coinShadow=Game.displayStore.getSprite3d("race-scene/collect-coin.png"),this.coinShadow.setRegPoint(.5,.5),this.coinShadow.position.set(-28,0),this.coinShadow.tint=0,this.coinShadow.alpha=.3,this.coin=Game.displayStore.getSprite3d("race-scene/collect-coin.png"),this.coin.setRegPoint(.5,.5),this.coin.position.set(-28,-3),this.coinHolder.addChild(this.coinShadow),this.coinHolder.addChild(this.coin),this.coinCountTextShadow=Game.displayStore.getBitmapText("race-scene/coincount-text-shadow",""),this.coinCountTextShadow.tint=0,this.coinCountTextShadow.alpha=.3,this.coinCountTextShadow.position.set(0,-23),this.coinCountTextShadow.scale.set(.5,.5),this.coinHolder.addChild(this.coinCountTextShadow),this.coinCountTextShadow.text=String(this.currentCoins),this.coinCountText=Game.displayStore.getBitmapText("race-scene/coincount-text",""),this.coinCountText.position.set(0,-26),this.coinCountText.scale.set(.5,.5),this.coinHolder.addChild(this.coinCountText),this.coinCountText.text=String(this.currentCoins),this.countdownText=Game.displayStore.getBitmapText("race-scene/countdown-text",""),this.countdownTextHolder=Game.displayStore.getContainer("race-scene/countdown-text-holder"),this.countdownTextHolder.addChild(this.countdownText),this.countdownTextHolder.position.set(Game.stageWidth/2,Game.stageHeight/2-100),this.countdownTextHolder.scale.set(0,0),this.countdownTextHolder.alpha=1,this.container.addChild(this.countdownTextHolder),this.container.addChild(this.progressMeterHolder),this.container.addChild(this.coinHolder),this.doCountdown()}return t.prototype.raceComplete=function(){},t.prototype.addBoostGauge=function(){},t.prototype.smash=function(t){for(var e=0;e<this.progressMarkers.length;e++){var i=this.progressMarkers[e];i.vehicle==t&&(i.marker.getSpriteAt(0).tint=16711680,i.teamIcon.alpha=.7)}},t.prototype.addMarkerForVehicle=function(t){var e,i=Game.displayStore.getContainer("race-scene/progress-marker-holder"),n=Game.displayStore.getSprite("race-scene/results-"+t.team+".png");"player"==t.id?(e=Game.displayStore.getSprite("race-scene/progress-marker-player.png"),n.position.y=74):(e=Game.displayStore.getSprite("race-scene/progress-marker-rival.png"),n.position.y=40),n.scale.set(.8,.8),t.marker=i,e.tint=16777215,n.alpha=1,i.position.y=24,i.addChild(e),i.addChild(n),this.progressMeterHolder.addChild(i),this.progressMeterHolder.addChild(this.racePositionTextHolder),this.progressMarkers.push({marker:i,vehicle:t,teamIcon:n})},t.prototype.collectCoin=function(){this.currentCoins++,this.coinCountText.text=String(this.currentCoins),this.coinCountTextShadow.text=String(this.currentCoins),this.coinCountText.position.x=20-this.coinCountText.width/2,this.coinCountTextShadow.position.x=this.coinCountText.position.x,this.coin.scale.set(1.5,1.5),this.coinShadow.scale.set(1.3,1.3),this.collectCoinAnimation=this.scene.killTween(this.collectCoinAnimation),this.collectCoinAnimation=new TimelineMax,this.collectCoinAnimation.add([TweenMax.to(this.coin.scale,1,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.coinShadow.scale,1,{x:1,y:1,ease:Elastic.easeOut})],.1)},t.prototype.collectPowerup=function(){},t.prototype.doCountdown=function(){this.countTimeline=this.scene.killTween(this.countTimeline),this.countTimeline=new TimelineMax,this.updateCountdownText("countdown-3"),this.countTimeline.add(TweenMax.to(this.countdownTextHolder.scale,.5,{x:2,y:2,ease:Elastic.easeOut})),this.countTimeline.call(function(){this.countdownTextHolder.scale.set(0,0),this.updateCountdownText("countdown-2")},null,this,"+=0.5"),this.countTimeline.add(TweenMax.to(this.countdownTextHolder.scale,.5,{x:2,y:2,ease:Elastic.easeOut})),this.countTimeline.call(function(){this.countdownTextHolder.scale.set(0,0),this.updateCountdownText("countdown-1")},null,this,"+=0.5"),this.countTimeline.add(TweenMax.to(this.countdownTextHolder.scale,.5,{x:2,y:2,ease:Elastic.easeOut})),this.countTimeline.call(function(){this.countdownTextHolder.scale.set(0,0),this.updateCountdownText("countdown-go")},null,this,"+=0.5"),this.countTimeline.call(Game.playSound,["car-rev.wav",.5],this,"-=0.5"),this.countTimeline.call(this.scene.startGameplay,null,this.scene),this.countTimeline.add(TweenMax.to(this.countdownTextHolder.scale,.5,{x:2,y:2,ease:Elastic.easeOut})),this.countTimeline.add([TweenMax.to(this.countdownTextHolder,.5,{alpha:0,ease:Power4.easeInOut}),TweenMax.to(this.countdownTextHolder.scale,.5,{x:10,y:10,ease:Power2.easeIn})],"+=0.5"),this.countTimeline.call(Game.playSound,["countdown.mp3"],this,.1)},t.prototype.updateCountdownText=function(t){Game.stringsManager.setTextString(this.countdownText,t),this.countdownText.position.x=-this.countdownText.width/2,this.countdownText.position.y=-this.countdownText.height/1.7},t.prototype.positionHasChanged=function(t){1!=this.scene.endingRace&&(this.playerPosition=t,this.racePositionTextHolder.showOnlyChild(t),this.racePositionTextHolder.scale.set(2,2),TweenMax.to(this.racePositionTextHolder.scale,.7,{x:1,y:1,ease:Elastic.easeOut}),this.lastPlayerPosition=t)},t.prototype.tick=function(){for(var t=[],e=[],i=0;i<this.progressMarkers.length;i++){var n=this.progressMarkers[i].marker,o=this.progressMeter.width-this.meterMarginLeft-this.meterMarginRight;n.position.x<this.progressMeter.width-this.meterMarginRight?n.position.x=this.meterMarginLeft+o*this.progressMarkers[i].vehicle.raceProgress:n.position.x=this.progressMeter.width-this.meterMarginRight,e.push(this.progressMarkers[i].vehicle),t.push(this.progressMarkers[i]),e.sort(function(t,e){return e.raceProgress-t.raceProgress}),t.sort(function(t,e){return e.vehicle.raceProgress-t.vehicle.raceProgress})}var r=e.indexOf(this.scene.player);if(r>=0&&r!=this.lastPlayerPosition&&this.positionHasChanged(r),this.ticker%10==0)for(i=0;i<t.length;i++)this.progressMeterHolder.addChildAt(t[i].marker,1);this.ticker++},t.prototype.pause=function(){this.scene.pauseResumeTween(this.countTimeline,"pause"),this.scene.pauseResumeTween(this.collectCoinAnimation,"pause"),Game.pauseSound("countdown.mp3")},t.prototype.resume=function(){this.scene.pauseResumeTween(this.countTimeline,"resume"),this.scene.pauseResumeTween(this.collectCoinAnimation,"resume"),Game.resumeSound("countdown.mp3")},t.prototype.destroy=function(){1==this.scene.endingRace&&Game.coreData.setCurrentCoins(this.currentCoins),this.countTimeline=this.scene.killTween(this.countTimeline)},t}(),ResultsPanel=function(){function t(t){this.positions=["1st","2nd","3rd","4th","5th"],this.scene=t,this.loggedVehicles=0,this.blackOverlay=Game.displayStore.getSprite("race-scene/black-overlay.png"),this.blackOverlay.width=Game.stageWidth,this.blackOverlay.height=Game.stageHeight,this.blackOverlay.alpha=0,this.container=Game.displayStore.getContainer("race-scene/results-panel-container"),this.panel=this.container.getContainer("race-scene/results-panel"),this.showTimeline=new TimelineMax,this.panel.setRegPoint(.5,.5,!0),this.panel.position.set(Game.stageWidth/2,Game.stageHeight/2-40),this.panel.scale.set(0,0),this.panel.alpha=0,this.showTimeline.add(TweenMax.to(this.panel.scale,.2,{x:.8,y:.8,ease:Power2.easeIn})),this.showTimeline.add(TweenMax.to(this.panel.scale,.5,{x:1,y:1,ease:Elastic.easeOut})),this.showTimeline.add([TweenMax.to(this.panel,.5,{alpha:1,ease:Power3.easeOut}),TweenMax.to(this.blackOverlay,.5,{alpha:.6,ease:Power3.easeOut})],0),this.lines=[];for(var e=0;e<5;e++){var i=Game.displayStore.getContainer("race-scene/results-line-container"),n=Game.displayStore.getSprite("race-scene/results-player-bar.png");i.addChild(n),n.scale.x=0,n.position.x=41;var o=Game.displayStore.getBitmapText("race-scene/results-position-text","");o.text=this.positions[e],o.position.y=-35,o.tint=16771584,o.scale.set(.7,.7),o.position.x=45,i.addChild(o);var r=Game.displayStore.getContainer("race-scene/results-square-holder");r.addChild(Game.displayStore.getSprite("race-scene/results-square-player.png")),r.addChild(Game.displayStore.getSprite("race-scene/results-square-rival.png")),r.showOnlyChild(1),r.position.y=-8,r.position.x=170,i.addChild(r);var a=Game.displayStore.getBitmapText("race-scene/results-time-text","");a.text="0:56:23",a.position.y=-17,a.tint=16771584,a.scale.set(.4,.4),a.position.x=295-a.width/2,i.addChild(a);var s=Game.displayStore.getBitmapText("race-scene/results-coin-text","");s.text="+"+5*e,s.position.y=-21,s.scale.set(.5,.5),s.position.x=392-s.width,i.addChild(s);var l=Game.displayStore.getSprite("race-scene/results-coin");l.position.x=415,l.position.y=-2,i.addChild(l),i.position.y=58+65.5*e,i.alpha=0,this.panel.addChild(i),this.lines.push({bar:n,timeText:a,coinText:s,square:r,line:i})}}return t.prototype.logVehicle=function(t){var e=this.lines[this.loggedVehicles];e.timeText.text=t.raceTime/1e3,e.coinText.text="+"+t.coins,e.coinText.position.x=388-e.coinText.width,t==this.scene.player&&(e.square.showOnlyChild(0),TweenMax.to(e.bar.scale,.5,{x:1,ease:Power4.easeInOut}));var i=Game.displayStore.getSprite("race-scene/results-"+t.team+".png");i.position.y=22,e.square.addChild(i),TweenMax.to(e.line,.5,{alpha:1,ease:Power4.easeOut}),this.loggedVehicles++},t.prototype.show=function(){this.achievementsPanel=new AchievementsTallyPanel(this),this.container.addChild(this.achievementsPanel.container),this.achievementsPanel.show(),this.showTimeline.restart()},t.prototype.restore=function(){console.log("restore"),this.achievementsPanel=new AchievementsTallyPanel(this),this.container.addChild(this.achievementsPanel.container),this.achievementsPanel.show(!0)},t.prototype.hide=function(){},t.prototype.tick=function(){},t.prototype.destroy=function(){this.showTimeline=this.scene.killTween(this.showTimeline);for(var t=0;t<this.lines.length;t++)this.lines[t].line.removeAllChildren(),this.lines[t].square.removeAllChildren(),this.panel.removeChild(this.lines[t].line);this.achievementsPanel&&this.achievementsPanel.destroy()},t}(),PowerupButton=function(){function t(t){var e=this;this.scene=t.scene,this.powerupProgress=0,this.interactionManager=t,this.state="not-ready",this.container=Game.displayStore.getContainer("race-scene/powerup-button-container"),this.pos=[90,510],this.gem=this.container.getSprite("race-scene/powerup-meter-full.png"),this.gem.alpha=0,this.gem.scale.set(0,0),this.powerupMeterFrames=Game.displayStore.getAnimatedSprite("race-scene/energy-burst-frames"),this.powerupMeterFrames.blendMode=PIXI.BLEND_MODES.ADD,this.powerupMeterFrames.animationSpeed=.5,this.powerupMeterFrames.loop=!1,this.powerupMeterFrames.scale.set(2.5,2.5),this.powerupMeterFrames.onComplete=function(){e.powerupMeterFrames.visible=!1},this.powerupMeterFrames.visible=!1,this.scene.game.ui.powerupButton.scale.set(.5,.5),this.scene.game.ui.powerupButton.disableButton(!1),this.powerupMeterFrames.gotoAndStop(0),this.container.addChild(this.powerupMeterFrames),this.shadow=Game.displayStore.getSprite("race-scene/powerup-button-shadow"),this.shadow.alpha=.8,this.container.interactive=!0,this.container.interactiveChildren=!0,this.container.position.x=this.pos[0],this.container.position.y=this.pos[1],this.readyAnim=new TimelineMax;var i=new TimelineMax({repeat:-1});i.add([TweenMax.to(this.scene.game.ui.powerupButton.scale,.25,{x:.5,y:.5,ease:Power3.easeIn,repeat:1,yoyo:!0})]),i.call(function(){this.powerupMeterFrames.animationSpeed=-.6,this.powerupMeterFrames.gotoAndPlay(13),this.powerupMeterFrames.visible=!0},null,this,.15),this.readyAnim.call(function(){this.powerupMeterFrames.animationSpeed=-.5,this.powerupMeterFrames.gotoAndPlay(13),this.powerupMeterFrames.visible=!0},null,this,0),this.readyAnim.add([TweenMax.to(this.gem.scale,.4,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.gem,.3,{alpha:1,ease:Power2.easeOut}),TweenMax.to(this.scene.game.ui.powerupButton.scale,.4,{x:1,y:1,ease:Back.easeOut})]),this.readyAnim.add(i),this.readyAnim.pause(),this.container.alpha=1,this.container.scale.set(1,1)}return t.prototype.setState=function(t){switch(t){case"ready":this.scene.game.ui.powerupButton.enableButton(),this.readyAnim.restart();break;case"not-ready":this.readyAnim.stop(),this.scene.game.ui.powerupButton.disableButton(!1),TweenMax.to(this.scene.game.ui.powerupButton.scale,.3,{x:.5,y:.5,ease:Back.easeOut}),TweenMax.to(this.gem.scale,.5,{x:0,y:0,ease:Power3.easeIn}),TweenMax.to(this.gem,.5,{alpha:0,ease:Power3.easeInOut}),this.powerupMeterFrames.animationSpeed=.5,this.powerupMeterFrames.gotoAndPlay(0),this.powerupMeterFrames.visible=!0;break;case"disabled":this.scene.game.ui.powerupButton.disableButton(!1),TweenMax.to(this.container.scale,.3,{x:0,y:0,ease:Back.easeIn}),TweenMax.to(this.container,.3,{alpha:0,ease:Power3.easeIn})}this.state=t},t.prototype.pause=function(){this.scene.pauseResumeTween(this.readyAnim,"pause"),this.powerupMeterFrames.stop()},t.prototype.resume=function(){this.scene.pauseResumeTween(this.readyAnim,"resume"),this.powerupMeterFrames.play()},t.prototype.tick=function(){},t.prototype.destroy=function(){this.readyAnim=this.scene.killTween(this.readyAnim),Game.displayStore.returnPooledItem(this.container),Game.displayStore.returnPooledItem(this.shadow),Game.displayStore.returnPooledItem(this.meterHolder)},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Anvil=function(t){function e(e){var i=t.call(this,e)||this;return i.smash=Game.displayStore.getAnimatedSprite("race-scene/smash-frames"),i.smash.animationSpeed=.6,i.smash.stop(),i.smash.onComplete=function(){i.smash.gotoAndStop(0),i.smash.visible=0},i.smash.convertTo3d(),i.smash.loop=!1,i.smash.visible=!1,i.smash.parentGroup=RaceScene.SORT_GROUP_FLOOR,i.smash.scale3d.set(6,6,6),i.wingUpStroke=!0,i.tweetySpeed=0,i.lastTweetyPos=new PIXI.Point,i.tweetyScale=.5,i.targetX=0,i.targetY=0,i.shadowTarget=new PIXI.Point,i.tweety=Game.displayStore.getContainer3d("race-scene/tweety-container"),i.tweetyInner=i.tweety.getContainer("race-scene/tweety-inner"),i.body=i.tweetyInner.getSprite("race-scene/powerup-tweety/body.png"),i.wing=i.tweetyInner.getContainer("race-scene/powerup-tweety/wing"),i.head=i.tweetyInner.getContainer("race-scene/powerup-tweety/head"),i.eyelids=i.head.getSprite("race-scene/powerup-tweety/eyelids.png"),i.frontFoot=i.tweetyInner.getSprite("race-scene/powerup-tweety/front.png"),i.shadow=Game.displayStore.getSprite3d("race-scene/powerup-tweety/anvil-shadow.png"),i.shadow.alpha=.3,i.head.setRegPoint(.55,.95,!0),i.tweety.scale.set(.5,.5),i.eyelids.visible=!1,i.shadow.parentGroup=RaceScene.SORT_GROUP_PROP_FRONT,i.shadow.scale3d.set(2,2,2),i.anvilTweety=i.tweetyInner.getSprite("race-scene/powerup-tweety/anvil.png"),i.anvil=Game.displayStore.getSprite3d("race-scene/powerup-tweety/anvil"),i.anvil.proj.affine=PIXI.projection.AFFINE.AXIS_X,i.tweety.parentGroup=RaceScene.SORT_GROUP_PROP_FRONT,i.anvil.scale3d.set(1.5,1.5,1.5),i.anvil.setRegPoint(.5,1),i.anvil.parentGroup=RaceScene.SORT_GROUP_PROP,i.anvil.alpha=0,i.scene.surfaceLayer.addChild(i.smash),i.scene.surfaceLayer.addChild(i.anvil),i.scene.mainHolder.addChild(i.tweety),i}return __extends(e,t),e.prototype.setStatus=function(e){t.prototype.setStatus.call(this,e),"aiming"==e&&Game.playSound("wings-flap.wav"),"not-ready"==e&&Game.stopSound("wings-flap.wav")},e.prototype.activate=function(e){t.prototype.activate.call(this),this.timeline=this.scene.killTween(this.timeline),this.timeline=new TimelineMax,this.target=e;var i=new RoughEase({strength:10,points:10,taper:"none",randomize:!1,clamp:!0});Game.playSound("swish-long-1.mp3"),this.timeline.add([TweenMax.to(this,.4,{targetY:0,ease:Power2.easeIn}),TweenMax.to(this,.4,{targetX:Game.stageWidth,ease:Power2.easeIn})]),this.timeline.call(function(){var t;t=this.target?new PIXI.Point(this.target.scenePos.x+60*e.speed,this.target.scenePos.y):new PIXI.Point(this.scene.player.scenePos.x+Game.stageWidth,this.scene.player.scenePos.y),this.targetX=-500,this.anvil.alpha=1,this.anvil.position3d.x=t.x,this.anvil.position3d.y=t.y,this.anvil.position3d.z=-650,Game.stopSound("wings-flap.wav"),Game.playSound("anvil-drop.mp3"),this.anvil.euler.x=Math.PI/2,this.anvil.euler.z=Game.getRandom(-.6,.6)},null,this),this.timeline.add([TweenMax.to(this.anvil.position3d,1,{z:0,ease:Power2.easeIn}),TweenMax.to(this.anvil.euler,1,{z:0,ease:Power1.easeIn})],.4),this.timeline.add(TweenMax.to(this.anvil,.5,{alpha:0,ease:i}),2),this.timeline.call(function(){this.scene.smashRival(),this.smash.visible=!0,this.smash.gotoAndPlay(0)},null,this,1.4),this.timeline.call(function(){this.target=null,this.statusWhenFinished?(this.setStatus(this.statusWhenFinished),this.statusWhenFinished=null):this.setStatus("not-ready")},null,this,2.5)},e.prototype.flapWing=function(){this.wingUpStroke=!this.wingUpStroke,1==this.wingUpStroke?this.wing.showOnlyChild(0):this.wing.showOnlyChild(1)},e.prototype.tick=function(){t.prototype.tick.call(this);var e=40,i=10*Math.sin(this.ticker/12),n=15*Math.sin(this.ticker/20);"aiming"==this.status?(e=25,this.head.rotation=.1*Math.sin(this.ticker/10),this.target?(this.shadowTarget.x=this.target.scenePos.x+100,this.shadowTarget.y=this.target.scenePos.y,this.targetX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x+n,this.targetY=this.scene.trackManager.backEdgeScreenY+this.target.scenePos.y/10-30):(this.shadowTarget.x=this.scene.player.scenePos.x+500,this.shadowTarget.y=this.scene.player.scenePos.y,this.targetX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+120+n,this.targetY=this.scene.trackManager.backEdgeScreenY+this.scene.player.scenePos.y/10-30),this.tweetyScale=.2+-.3*Math.abs((this.targetY-295)/90),this.blinking()):"activating"==this.status&&(e=10,this.smash.position3d.x=this.anvil.position3d.x,this.smash.position3d.y=this.anvil.position3d.y,this.shadowTarget.x=this.anvil.position3d.x,this.shadowTarget.y=this.anvil.position3d.y),"not-ready"==this.status&&(this.blinking(),this.targetX=-500,e=40),this.tweety.position.x+=(this.targetX-this.tweety.position.x)/e,this.tweety.position.y=this.targetY-125+i,this.tweety.scale.x+=(.4+this.tweetyScale-this.tweety.scale.x)/15,this.tweety.scale.y=this.tweety.scale.x,this.shadow.position3d.x+=(this.shadowTarget.x-this.shadow.position3d.x)/e,this.shadow.position3d.y+=(this.shadowTarget.y-this.shadow.position3d.y)/e,this.shadow.scale3d.x=this.shadow.scale3d.y=3+i/-40,this.shadow.alpha=.3+i/60,this.tweetySpeed=this.tweety.position.x-this.lastTweetyPos.x;var o=this.tweetySpeed/15,r=6-Math.abs(Math.round((this.tweetySpeed-10)/4));r<1&&(r=1),this.ticker%r==0&&this.flapWing(),this.tweety.rotation+=(o-this.tweety.rotation)/12,"aiming"==this.status&&(this.anvilTweety.rotation+=(.8*this.tweety.rotation+.1-this.anvilTweety.rotation)/15),this.lastTweetyPos.x=this.tweety.position.x,this.lastTweetyPos.y=this.tweety.position.y},e.prototype.blinking=function(){this.ticker%8==0&&(this.eyelids.visible=!1,Game.getRandom(0,1)>.9&&(this.eyelids.visible=!0))},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.stopSound("wings-flap.wav")},e}(Powerup),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ScoobySnack=function(t){function e(e){var i=t.call(this,e)||this;i.snackIsInPlay=!1,i.scoobyX=0,i.tickMoveScooby=!0,i.smash=Game.displayStore.getAnimatedSprite("race-scene/smash-frames"),i.scooby=Game.displayStore.getContainer("race-scene/powerup-scooby/scooby-container"),i.body=i.scooby.getSprite("race-scene/powerup-scooby/scooby-body.png"),i.head=i.scooby.getContainer3d("race-scene/powerup-scooby/scooby-head"),i.arm=Game.displayStore.getSprite3d("race-scene/powerup-scooby/scooby-arm.png"),i.eyelids=i.head.getSprite3d("race-scene/powerup-scooby/scooby-eyelids.png"),i.eyelids.visible=!1,i.head.parentGroup=RaceScene.SORT_GROUP_PROP,i.eyelids.parentGroup=RaceScene.SORT_GROUP_PROP,i.arm.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.body.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.smash.animationSpeed=.6,i.smash.stop(),i.smash.onComplete=function(){i.smash.gotoAndStop(0),i.smash.visible=0},i.smash.convertTo3d(),i.smash.loop=!1,i.smash.visible=!1,i.smash.parentGroup=RaceScene.SORT_GROUP_FLOOR,i.smash.scale3d.set(6,6,6),i.scene.surfaceLayer.addChild(i.smash),i.scoobySnack=Game.displayStore.getContainer3d("race-scene/powerup-scooby/scooby-snack"),i.scoobySnack.parentGroup=RaceScene.SORT_GROUP_PROP,i.scoobySnack.proj.affine=PIXI.projection.AFFINE.AXIS_X,i.head.setRegPoint(.5,.8,!0),i.foodLayers=[];for(var n=0;n<i.scoobySnack.children.length;n++){var o=i.scoobySnack.getSpriteAt(n);o.setRegPoint(.5,.95,!0),o.position.x-=70,o.position.y-=40,i.foodLayers.push({layer:o,origY:o.position.y})}return i.scooby.position.x=-800,i.scooby.scale.set(.6,.6),i.scooby.setRegPoint(0,1),i.scooby.rotation=.2,i.scene.mainHolder.addChild(i.scooby),i.scooby.addChild(i.scoobySnack),i}return __extends(e,t),e.prototype.setStatus=function(e){if(t.prototype.setStatus.call(this,e),"aiming"==this.status){this.tickMoveScooby=!0,this.scoobySnack.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,this.scoobySnack.position3d.set(0,0,0),this.scoobySnack.alpha=1,this.scoobySnack.scale3d.set(1,1,1),this.scooby.addChild(this.scoobySnack),this.snackIsInPlay=!1,this.scoobySnack.rotation=0;for(var i=0;i<this.foodLayers.length;i++){var n=this.foodLayers[i].layer;n.position.y=this.foodLayers[i].origY,n.position3d.y=0}}},e.prototype.activate=function(e){t.prototype.activate.call(this),this.timeline=this.scene.killTween(this.timeline),this.timeline=new TimelineMax;var i=new RoughEase({strength:10,points:10,taper:"none",randomize:!1,clamp:!0});this.timeline.call(function(){this.eyelids.visible=!1},null,this),this.timeline.add([TweenMax.to(this.arm,.5,{rotation:0,ease:Power2.easeOut}),TweenMax.to(this.head,.5,{rotation:-.5,ease:Power2.easeInOut}),TweenMax.to(this.scooby,.5,{rotation:.3,ease:Power2.easeInOut})]);for(var n=0;n<this.foodLayers.length;n++){var o=this.foodLayers[n].layer;this.timeline.add(TweenMax.to(o,.3,{ease:Back.easeOut,y:"+=25"}),n/20)}this.timeline.call(function(){this.eyelids.visible=!0},null,this),this.timeline.add([TweenMax.to(this.arm,.2,{rotation:-.9,ease:Power2.easeIn}),TweenMax.to(this.head,.2,{rotation:0,ease:Power2.easeInOut}),TweenMax.to(this.scooby,.2,{rotation:.1,ease:Power2.easeInOut}),TweenMax.to(this.scoobySnack.position,.2,{y:-200,ease:Power2.easeIn})]),this.timeline.call(Game.playSound,["swish-long-1.mp3"],this,.7),this.timeline.call(function(){this.scoobySnack.parentGroup=RaceScene.SORT_GROUP_PROP,this.eyelids.visible=!1,this.scoobySnack.x=this.scoobySnack.y=0,this.scoobySnack.position3d.x=0,this.scoobySnack.position3d.z=0,this.scoobySnack.position3d.y=0,this.scoobySnack.scale3d.set(1.8,1.8,1.8),this.scene.surfaceLayer.addChild(this.scoobySnack);for(var t=0;t<this.foodLayers.length;t++)this.foodLayers[t].layer.position.y=-350;this.snackIsInPlay=!0},null,this),this.timeline.add([TweenMax.to(this.arm,.6,{rotation:0,ease:Power2.easeInOut}),TweenMax.to(this.head,.6,{rotation:-.5,ease:Power2.easeInOut}),TweenMax.to(this.scooby,.6,{rotation:.2,ease:Power2.easeInOut})],"+=0.2"),this.timeline.call(function(){for(var t=0;t<this.foodLayers.length;t++){var e=this.foodLayers[t].layer;this.timeline.add(TweenMax.to(e.position,.5,{y:this.foodLayers[t].origY-20,ease:Bounce.easeOut}),1.8+t/30)}Game.playSound("sandwich-impact.mp3"),Game.playSound("splat-3.mp3"),Game.playSound("slap.mp3")},null,this,1.8),this.timeline.call(Game.playSound,["swipe-4"],this,1.6),this.timeline.call(function(){this.tickMoveScooby=!1},null,this,1.5),this.timeline.add(TweenMax.to(this,1.5,{ease:Power1.easeInOut,scoobyX:-800}),1.5),this.timeline.call(function(){this.scene.smashRival(),this.smash.visible=!0,this.smash.gotoAndPlay(0),this.snackIsInPlay=!1},null,this,2),this.timeline.add([TweenMax.to(this.scoobySnack,1,{alpha:0,ease:i})],3),this.timeline.call(function(){this.target=null,this.statusWhenFinished?(this.setStatus(this.statusWhenFinished),this.statusWhenFinished=null):this.setStatus("not-ready")},null,this,4),this.timeline.pause();var r;r=e?new PIXI.Point(e.scenePos.x+24*e.speed,e.scenePos.y):new PIXI.Point(this.scene.player.scenePos.x+Game.stageWidth,this.scene.player.scenePos.y),this.timeline.restart(),this.container.position3d.x=r.x,this.container.position3d.y=r.y},e.prototype.tick=function(){t.prototype.tick.call(this),this.scene.tracker.position.x=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x,this.scene.tracker.position.y=this.scene.trackManager.backEdgeScreenY;var e=5*+Math.sin(this.ticker/22),i=10*Math.sin(this.ticker/60),n=40;if(this.scooby.position.y=this.scene.trackManager.backEdgeScreenY-60+e,"aiming"==this.status){n=15,this.target?this.scoobyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x+i:this.scoobyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+150+i,this.arm.rotation=-.2-.1*Math.sin(this.ticker/22),this.head.rotation=-.3-.1*Math.cos(this.ticker/22);for(var o=1;o<this.foodLayers.length;o++){var r=this.foodLayers[o].layer;r.rotation=-Math.sin((this.ticker+3*o)/12)/25,r.y+=.2*Math.cos((this.ticker+3*o)/12)}0==this.snackIsInPlay&&(this.scoobySnack.position.x=this.scooby.toLocal(new PIXI.Point(200,-40),this.arm,new PIXI.Point).x,this.scoobySnack.position.y=this.scooby.toLocal(new PIXI.Point(200,-40),this.arm,new PIXI.Point).y),this.blinking()}else if("activating"==this.status){n=10;var a=[0,0];this.target?(a[0]=this.target.scenePos.x,a[1]=this.target.scenePos.y):(a[0]=this.scene.player.scenePos.x+800,a[1]=this.scene.player.scenePos.y),1==this.tickMoveScooby&&(this.target?this.scoobyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x:this.scoobyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+200),1==this.snackIsInPlay&&(this.smash.position3d.x=a[0],this.smash.position3d.y=a[1],this.scoobySnack.position3d.x=a[0],this.scoobySnack.position3d.y=a[1]+45)}else"not-ready"==this.status&&(this.blinking(),this.scoobyX=-800,n=40);this.scooby.position.x+=(this.scoobyX-300-this.scooby.position.x)/n},e.prototype.blinking=function(){this.ticker%8==0&&(this.eyelids.visible=!1,Game.getRandom(0,1)>.9&&(this.eyelids.visible=!0))},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Powerup),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),TomSmash=function(t){function e(e){var i=t.call(this,e)||this;return i.smash=Game.displayStore.getAnimatedSprite("race-scene/smash-frames"),i.tom=Game.displayStore.getContainer("race-scene/tom-container"),i.body=i.tom.getSprite("race-scene/powerup-tom/tom-body.png"),i.arm=Game.displayStore.getSprite3d("race-scene/powerup-tom/tom-arm.png"),i.head=i.tom.getContainer("race-scene/powerup-tom/tom-head"),i.eyelids=i.head.getSprite("race-scene/powerup-tom/tom-eyelids.png"),i.eyelids.visible=!1,i.head.parentGroup=RaceScene.SORT_GROUP_FRONT,i.arm.parentGroup=RaceScene.SORT_GROUP_PROP_FRONT,i.body.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.smash.animationSpeed=.6,i.smash.stop(),i.smash.onComplete=function(){i.smash.gotoAndStop(0),i.smash.visible=0},i.smash.convertTo3d(),i.smash.loop=!1,i.smash.visible=!1,i.smash.parentGroup=RaceScene.SORT_GROUP_FLOOR,i.smash.scale3d.set(6,6,6),i.scene.surfaceLayer.addChild(i.smash),i.tom.position.x=-800,i.tom.scale.set(.6,.6),i.tom.setRegPoint(0,1),i.tom.rotation=-.2,i.scene.mainHolder.addChild(i.tom),i}return __extends(e,t),e.prototype.setStatus=function(e){t.prototype.setStatus.call(this,e),"aiming"==e&&Game.playSound("tom-evil-laugh.mp3")},e.prototype.activate=function(e){t.prototype.activate.call(this),this.timeline=this.scene.killTween(this.timeline),this.timeline=new TimelineMax;var i=[1.6,1.5,1.3,1.1,.8];new RoughEase({strength:10,points:10,taper:"none",randomize:!1,clamp:!0});this.timeline.call(function(){this.eyelids.visible=!1},null,this),this.timeline.add([TweenMax.to(this.arm,.5,{rotation:-.5,ease:Power2.easeOut}),TweenMax.to(this.head,.5,{rotation:.2,ease:Power2.easeInOut})]),this.timeline.call(function(){this.eyelids.visible=!0,Game.playSound("swipe-3.mp3")},null,this),this.timeline.add([TweenMax.to(this.arm,.2,{rotation:i[this.targetLane],ease:Power2.easeIn}),TweenMax.to(this.head,.2,{rotation:-.1,ease:Power2.easeInOut})]),this.timeline.call(function(){Game.playSound("tom-slap.mp3"),this.scene.smashRival(),this.smash.visible=!0,this.smash.gotoAndPlay(0)},null,this),this.timeline.add([TweenMax.to(this.arm,.6,{rotation:0,ease:Power2.easeInOut}),TweenMax.to(this.head,.6,{rotation:0,ease:Power2.easeInOut})],"+=0.2"),this.timeline.call(function(){this.eyelids.visible=!1},null,this,1),this.timeline.call(function(){this.target=null,this.statusWhenFinished?(this.setStatus(this.statusWhenFinished),this.statusWhenFinished=null):this.setStatus("not-ready")},null,this,2),this.timeline.pause(),this.timeline.restart()},e.prototype.tick=function(){t.prototype.tick.call(this),this.scene.tracker.position.x=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x,this.scene.tracker.position.y=this.scene.trackManager.backEdgeScreenY;var e=5*+Math.sin(this.ticker/22),i=10*Math.sin(this.ticker/60),n=40;this.tom.position.y=this.scene.trackManager.backEdgeScreenY-20+e;var o;if(o=this.target?this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x+i:this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+150+i,"aiming"==this.status)n=15,this.head.rotation=.1*Math.sin(this.ticker/22),this.arm.rotation=.1*-Math.sin(this.ticker/22),this.blinking();else if("activating"==this.status){n=5;var r=[0,0];this.target?(r[0]=this.target.scenePos.x,r[1]=this.target.scenePos.y):(r[0]=this.scene.player.scenePos.x+550,r[1]=this.scene.player.scenePos.y);var a=[10,-10,-30,-50,-70];o=this.target?this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x+i+a[this.targetLane]:this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+i+250+a[this.targetLane],this.smash.position3d.x=r[0],this.smash.position3d.y=r[1],this.container.position3d.x=r[0]-500}else"not-ready"==this.status&&(this.blinking(),o=-800,n=40);this.tom.position.x+=(o-400-this.tom.position.x)/n},e.prototype.blinking=function(){this.ticker%8==0&&(this.eyelids.visible=!1,Game.getRandom(0,1)>.9&&(this.eyelids.visible=!0))},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Powerup),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Dynamite=function(t){function e(e){var i=t.call(this,e)||this;return i.wileX=0,i.tickMoveWile=!0,i.trackTarget=!0,i.wile=Game.displayStore.getContainer("race-scene/powerup-wile/wile-container"),i.body=i.wile.getSprite("race-scene/powerup-wile/body.png"),i.head=i.wile.getContainer3d("race-scene/powerup-wile/head"),i.arm=i.wile.getContainer3d("race-scene/powerup-wile/arm"),i.arm.showOnlyChild(0),i.front=i.wile.getSprite3d("race-scene/powerup-wile/front.png"),i.eyelids=i.head.getSprite3d("race-scene/powerup-wile/eyelids.png"),i.eyelids.visible=!1,i.head.parentGroup=RaceScene.SORT_GROUP_PROP,i.eyelids.parentGroup=RaceScene.SORT_GROUP_PROP,i.front.parentGroup=RaceScene.SORT_GROUP_PROP_FRONT,i.arm.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.body.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.smash=Game.displayStore.getAnimatedSprite("race-scene/smash-frames"),i.smash.animationSpeed=.6,i.smash.stop(),i.smash.onComplete=function(){i.smash.gotoAndStop(0),i.smash.visible=!1},i.smash.convertTo3d(),i.smash.loop=!1,i.smash.visible=!1,i.smash.parentGroup=RaceScene.SORT_GROUP_FLOOR,i.smash.scale3d.set(6,6,6),i.scene.surfaceLayer.addChild(i.smash),i.flame=Game.displayStore.getAnimatedSprite("race-scene/flame-frames"),i.flame.animationSpeed=.7,i.flame.loop=!0,i.flame.play(),i.flame.convertTo3d(),i.flame.proj.affine=PIXI.projection.AFFINE.AXIS_X,i.flame.position.set(450,330),i.flame.scale.set(1.2,1.2),i.wile.addChild(i.flame),i.scorchMark=Game.displayStore.getSprite3d("race-scene/powerup-wile/scorch-mark.png"),i.scorchMark.scale3d.set(0,0,0),i.scorchMark.alpha=0,i.scorchMark.parentGroup=RaceScene.SORT_GROUP_FLOOR,i.scorchMark.blendMode=PIXI.BLEND_MODES.MULTIPLY,i.blast=Game.displayStore.getAnimatedSprite("race-scene/dynamite-blast-frames"),i.blast.animationSpeed=.7,i.blast.loop=!1,i.blast.onComplete=function(){i.blast.gotoAndStop(0),i.blast.visible=!1},i.blast.convertTo3d(),i.blast.proj.affine=PIXI.projection.AFFINE.AXIS_X,i.blast.scale3d.set(4,4,4),i.blast.visible=!1,i.blast.parentGroup=RaceScene.SORT_GROUP_FRONT,i.scene.surfaceLayer.addChild(i.blast),i.dynamite=Game.displayStore.getContainer3d("race-scene/powerup-wile/dynamite"),i.dynamite.parentGroup=RaceScene.SORT_GROUP_PROP,i.dynamite.proj.affine=PIXI.projection.AFFINE.AXIS_X,i.dynamite.scale3d.set(2,2,2),i.dynamite.position3d.z=-600,i.dynamite.visible=!1,i.head.setRegPointPixels(90,295,!0),i.wile.position.x=-800,i.wile.scale.set(.6,.6),i.wile.setRegPoint(0,1),i.wile.rotation=.1,i.dynamite.setRegPoint(.5,.95),i.scene.mainHolder.addChild(i.wile),i.scene.surfaceLayer.addChild(i.scorchMark),i.scene.surfaceLayer.addChild(i.dynamite),i}return __extends(e,t),e.prototype.setStatus=function(e){t.prototype.setStatus.call(this,e),"aiming"==this.status&&(this.tickMoveWile=!0,Game.playSound("fuse.wav")),"not-ready"==e&&Game.stopSound("fuse.wav")},e.prototype.activate=function(e){t.prototype.activate.call(this),this.timeline=this.scene.killTween(this.timeline),this.timeline=new TimelineMax,this.trackTarget=!0;var i=new RoughEase({strength:10,points:10,taper:"none",randomize:!1,clamp:!0});this.timeline.call(function(){this.eyelids.visible=!1,this.scorchMark.scale3d.set(0,0,0),this.scorchMark.alpha=0},null,this),this.timeline.add([TweenMax.to(this.arm,.5,{rotation:.2,ease:Power2.easeOut}),TweenMax.to(this.head,.5,{rotation:-.3,ease:Power2.easeInOut}),TweenMax.to(this.wile,.5,{rotation:.3,ease:Power2.easeInOut})]),this.timeline.call(function(){this.eyelids.visible=!0},null,this),this.timeline.add([TweenMax.to(this.arm,.2,{rotation:-.8,ease:Power2.easeIn}),TweenMax.to(this.head,.2,{rotation:.1,ease:Power2.easeInOut}),TweenMax.to(this.wile,.2,{rotation:.1,ease:Power2.easeInOut})]),this.timeline.call(function(){this.eyelids.visible=!1,this.arm.showOnlyChild(1),this.dynamite.visible=!0,this.dynamite.alpha=1,this.dynamite.addChild(this.flame),this.flame.position.set(-40,-10),this.flame.parentGroup=RaceScene.SORT_GROUP_FRONT},null,this),this.timeline.call(Game.playSound,["swish-long-1.mp3"],this,.8),this.timeline.call(Game.fadeSound,["fuse.wav",.5,.5],this,.8),this.timeline.add([TweenMax.to(this.arm,.6,{rotation:-.1,ease:Power2.easeInOut}),TweenMax.to(this.head,.6,{rotation:-.3,ease:Power2.easeInOut}),TweenMax.to(this.wile,.6,{rotation:.1,ease:Power2.easeInOut})],"+=0.2"),this.timeline.add(TweenMax.to(this.dynamite.position3d,.5,{z:0,ease:Bounce.easeOut}),1.4),this.timeline.call(function(){this.tickMoveWile=!1},null,this,1.4),this.timeline.add(TweenMax.to(this,1.5,{ease:Power1.easeInOut,wileX:-800}),1.4),this.timeline.call(function(){Game.playSound("thud.mp3"),this.trackTarget=!1,this.smash.visible=!0,this.smash.gotoAndPlay(0)},null,this,1.6),this.timeline.call(Game.fadeSound,["fuse.wav",.5,1],this,1.1),this.timeline.call(function(){this.target&&(this.scene.smashRival("blast"),this.dynamite.visible=!1,Game.playSound("dynamite.mp3"),Game.stopSound("fuse.wav"),this.scorchMark.position3d.x=this.dynamite.position3d.x,this.scorchMark.position3d.y=this.dynamite.position3d.y-60,this.blast.alpha=1,this.blast.visible=!0,this.blast.gotoAndPlay(0))},null,this,2.2),this.timeline.add([TweenMax.to(this.scorchMark,.3,{alpha:1,ease:Power3.easeOut}),TweenMax.to(this.scorchMark.scale3d,.3,{x:4,y:4,ease:Power3.easeOut})],2.2),this.target||(this.timeline.add(TweenMax.to(this.dynamite,1,{alpha:0,ease:i}),2),console.log("no target!")),this.timeline.call(function(){this.dynamite.alpha=1,this.dynamite.position3d.z=-600,this.wile.addChild(this.flame),this.flame.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,this.flame.visible=!0,this.arm.showOnlyChild(0),this.target=null,this.statusWhenFinished?(this.setStatus(this.statusWhenFinished),this.statusWhenFinished=null):this.setStatus("not-ready")},null,this,3.5)},e.prototype.pause=function(){t.prototype.pause.call(this),this.flame.stop(),Game.pauseSound("fuse.wav")},e.prototype.resume=function(){t.prototype.resume.call(this),this.flame.play(),Game.resumeSound("fuse.wav")},e.prototype.tick=function(){t.prototype.tick.call(this),console.log(this.status),this.scene.tracker.position.x=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x,this.scene.tracker.position.y=this.scene.trackManager.backEdgeScreenY;var e=5*+Math.sin(this.ticker/12),i=10*Math.sin(this.ticker/60),n=40;if(this.wile.position.y=this.scene.trackManager.backEdgeScreenY-80+e,"aiming"==this.status)n=20,this.target?this.wileX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x+i:this.wileX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+150+i,this.arm.rotation=-.6-.1*Math.sin(this.ticker/22),this.head.rotation=.1*Math.cos(this.ticker/22),this.flame.x=this.wile.toLocal(new PIXI.Point(62,116),this.arm,new PIXI.Point).x,this.flame.y=this.wile.toLocal(new PIXI.Point(62,116),this.arm,new PIXI.Point).y,this.blinking();else if("activating"==this.status){n=10;var o=[0,0];this.target?(o[0]=this.target.scenePos.x+300,o[1]=this.target.scenePos.y):(o[0]=this.scene.player.scenePos.x+800,o[1]=this.scene.player.scenePos.y),1==this.tickMoveWile&&(this.target?this.wileX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x:this.wileX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+200),1==this.trackTarget&&(this.dynamite.position3d.x=o[0]+120,this.dynamite.position3d.y=o[1]+110),this.smash.position3d.x=o[0],this.smash.position3d.y=o[1],this.blast.position3d.x=this.dynamite.position3d.x,this.blast.position3d.y=this.dynamite.position3d.y-30}else"not-ready"==this.status&&(this.blinking(),this.wileX=-800,n=40);this.wile.position.x+=(this.wileX-300-this.wile.position.x)/n},e.prototype.blinking=function(){this.ticker%8==0&&(this.eyelids.visible=!1,Game.getRandom(0,1)>.9&&(this.eyelids.visible=!0))},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.stopSound("fuse.wav")},e}(Powerup),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Basketball=function(t){function e(e){var i=t.call(this,e)||this;return i.ballIsInPlay=!1,i.daffyX=0,i.tickMoveDaffy=!0,i.smash=Game.displayStore.getAnimatedSprite("race-scene/smash-frames"),i.daffy=Game.displayStore.getContainer("race-scene/powerup-bugs/daffy-container"),i.body=i.daffy.getSprite("race-scene/powerup-bugs/body.png"),i.head=i.daffy.getContainer3d("race-scene/powerup-bugs/head"),i.arm=i.daffy.getContainer3d("race-scene/powerup-bugs/arm"),i.forearm=i.arm.getSprite3d("race-scene/powerup-bugs/forearm.png"),i.forearm.setRegPoint(.2,.9,!0),i.eyelids=i.head.getSprite3d("race-scene/powerup-bugs/eyelids.png"),i.eyelids.visible=!1,i.head.parentGroup=RaceScene.SORT_GROUP_PROP,i.eyelids.parentGroup=RaceScene.SORT_GROUP_PROP,i.arm.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.body.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.smash.animationSpeed=.6,i.smash.stop(),i.smash.onComplete=function(){i.smash.gotoAndStop(0),i.smash.visible=0},i.smash.convertTo3d(),i.smash.loop=!1,i.smash.visible=!1,i.smash.parentGroup=RaceScene.SORT_GROUP_FLOOR,i.smash.scale3d.set(6,6,6),i.scene.surfaceLayer.addChild(i.smash),i.basketballContainer=Game.displayStore.getContainer3d("race-scene/powerup-bugs/basketball-container"),i.basketball=i.basketballContainer.getAnimatedSprite("race-scene/basketball-frames"),i.basketball.animationSpeed=.5,i.basketball.loop=!0,i.basketball.play(),i.basketballContainer.proj.affine=PIXI.projection.AFFINE.AXIS_X,i.basketballContainer.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,i.daffy.addChild(i.basketballContainer),i.head.setRegPoint(.4,.7,!0),i.daffy.position.x=-800,i.daffy.scale.set(.5,.5),i.daffy.setRegPoint(0,1),i.daffy.rotation=0,i.scene.mainHolder.addChild(i.daffy),i}return __extends(e,t),e.prototype.setStatus=function(e){t.prototype.setStatus.call(this,e),"aiming"==this.status&&(this.tickMoveDaffy=!0,this.basketballContainer.visible=!0,this.ballIsInPlay=!1,this.daffy.addChild(this.basketballContainer),this.basketballContainer.position3d.set(0,0,0),this.basketballContainer.scale3d.set(1.2,1.2),this.basketball.position.set(0,0),this.basketballContainer.alpha=1,this.basketballContainer.parentGroup=RaceScene.SORT_GROUP_BEHIND_TABLE,Game.playSound("spinning.wav",1)),"not-ready"==e&&Game.stopSound("spinning.wav")},e.prototype.activate=function(e){t.prototype.activate.call(this),this.timeline=this.scene.killTween(this.timeline),this.timeline=new TimelineMax;var i=new RoughEase({strength:10,points:10,taper:"none",randomize:!1,clamp:!0});this.timeline.call(function(){this.eyelids.visible=!1},null,this),this.timeline.add([TweenMax.to(this.arm,.5,{rotation:.7,ease:Power2.easeOut}),TweenMax.to(this.head,.5,{rotation:-.3,ease:Power2.easeInOut}),TweenMax.to(this.daffy,.5,{rotation:.1,ease:Power2.easeInOut})]),this.timeline.call(function(){Game.fadeSound("spinning.wav",.5,.5),this.eyelids.visible=!0,Game.playSound("swish-long-1.mp3")},null,this),this.timeline.add([TweenMax.to(this.arm,.2,{rotation:-.7,ease:Power2.easeIn}),TweenMax.to(this.head,.2,{rotation:.1,ease:Power2.easeInOut}),TweenMax.to(this.daffy,.2,{rotation:-.1,ease:Power2.easeInOut})]),this.timeline.call(function(){this.eyelids.visible=!1,this.ballIsInPlay=!0,this.basketballContainer.scale3d.set(1.8,1.8),this.basketballContainer.parentGroup=RaceScene.SORT_GROUP_PROP,this.scene.surfaceLayer.addChild(this.basketballContainer),this.basketballContainer.position3d.z=-700,this.basketballContainer.position.set(0,0),this.basketball.position.set(100,0),Game.fadeSound("spinning.wav",.5,1)},null,this),this.timeline.add([TweenMax.to(this.arm,.6,{rotation:.5,ease:Power2.easeInOut}),TweenMax.to(this.head,.6,{rotation:0,ease:Power2.easeInOut}),TweenMax.to(this.daffy,.6,{rotation:0,ease:Power2.easeInOut})],"+=0.2");var n=new TimelineMax;n.call(Game.playSound,["swish-long-2.mp3"],this),n.add([TweenMax.to(this.basketballContainer.position3d,.5,{z:0,ease:Power1.easeIn}),TweenMax.to(this.basketball.position,.5,{x:0,ease:Linear.easeNone})]),n.add(TweenMax.to(this.basketball.scale,.1,{y:.7,ease:Power1.easeOut,yoyo:!0,repeat:1})),n.add(TweenMax.to(this.basketballContainer.position3d,.3,{z:-250,ease:Power1.easeOut})),n.add(TweenMax.to(this.basketballContainer.position3d,.3,{z:-200,ease:Power1.easeIn})),n.add(TweenMax.to(this.basketballContainer.position3d,.8,{z:0,ease:Bounce.easeOut})),n.add(TweenMax.to(this.basketball.scale,.1,{y:.8,ease:Power1.easeOut,yoyo:!0,repeat:1}),1.5),n.add(TweenMax.to(this.basketball.position,2,{x:-300,ease:Linear.easeNone}),.5),n.call(Game.playSound,["basketball-1.mp3"],this,.5),n.call(Game.playSound,["slap.mp3"],this,.5),n.call(Game.playSound,["basketball-2.mp3",.7],this,2),this.timeline.add(n,1.5),this.timeline.call(function(){this.tickMoveDaffy=!1},null,this,2),this.timeline.add(TweenMax.to(this,1.5,{ease:Power1.easeInOut,daffyX:-800}),2),this.timeline.add(TweenMax.to(this.basketballContainer,.5,{alpha:0,ease:i}),2.8),this.timeline.call(function(){this.scene.smashRival(),this.smash.visible=!0,this.smash.gotoAndPlay(0),this.ballIsInPlay=!1,Game.fadeSound("spinning.wav",1,0)},null,this,2),this.timeline.call(function(){this.ballIsInPlay=!1,this.target=null,Game.stopSound("spinning.wav"),this.statusWhenFinished?(this.setStatus(this.statusWhenFinished),this.statusWhenFinished=null):this.setStatus("not-ready")},null,this,4)},e.prototype.pause=function(){t.prototype.pause.call(this),this.basketball.stop(),Game.pauseSound("spinning.wav")},e.prototype.resume=function(){t.prototype.resume.call(this),this.basketball.play(),Game.resumeSound("spinning.wav")},e.prototype.tick=function(){t.prototype.tick.call(this),this.scene.tracker.position.x=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x,this.scene.tracker.position.y=this.scene.trackManager.backEdgeScreenY;var e=5*+Math.sin(this.ticker/12),i=10*Math.sin(this.ticker/60),n=40;if(this.daffy.position.y=this.scene.trackManager.backEdgeScreenY+20+e,"aiming"==this.status)n=15,this.target?this.daffyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x+i:this.daffyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+200+i,this.arm.rotation=.5+.1*Math.sin(this.ticker/22),this.forearm.rotation=.1-this.arm.rotation,this.head.rotation=.1*Math.cos(this.ticker/22),0==this.ballIsInPlay&&(this.basketballContainer.position.x=this.daffy.toLocal(new PIXI.Point(70,-250),this.forearm,new PIXI.Point).x,this.basketballContainer.position.y=this.daffy.toLocal(new PIXI.Point(70,-250),this.forearm,new PIXI.Point).y),this.blinking();else if("activating"==this.status){n=10;var o=[0,0];this.target?(o[0]=this.target.scenePos.x,o[1]=this.target.scenePos.y):(o[0]=this.scene.player.scenePos.x+800,o[1]=this.scene.player.scenePos.y),1==this.tickMoveDaffy&&(this.target?this.daffyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.target.carContainer,new PIXI.Point).x:this.daffyX=this.scene.mainHolder.toLocal(new PIXI.Point(0,0),this.scene.player.carContainer,new PIXI.Point).x+200),this.forearm.rotation=.1-this.arm.rotation,1==this.ballIsInPlay?(this.smash.position3d.x=o[0],this.smash.position3d.y=o[1],this.basketballContainer.position3d.x=o[0],this.basketballContainer.position3d.y=o[1]+45):this.basketballContainer.parent==this.daffy&&(this.basketballContainer.position.x=this.daffy.toLocal(new PIXI.Point(70,-250),this.forearm,new PIXI.Point).x,this.basketballContainer.position.y=this.daffy.toLocal(new PIXI.Point(70,-250),this.forearm,new PIXI.Point).y)}else"not-ready"==this.status&&(this.blinking(),this.daffyX=-800,n=40);this.daffy.position.x+=(this.daffyX-250-this.daffy.position.x)/n},e.prototype.blinking=function(){this.ticker%8==0&&(this.eyelids.visible=!1,Game.getRandom(0,1)>.9&&(this.eyelids.visible=!0))},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.stopSound("spinning.wav")},e}(Powerup),Swatch=function(){function t(t,e,i,n,o){this.scene=t,this.colour=i,this.group=o,this.index=e,this.swatch=Game.displayStore.getSprite("paint-scene/swatch"),this.swatch.tint=i,this.swatch.interactive=!0,this.outer=Game.displayStore.getSprite("paint-scene/swatch-outer"),this.shadow=Game.displayStore.getSprite("paint-scene/swatch-outer-shadow"),this.shadow.alpha=.3,this.shadow.tint=0,this.shadow.position.y=3,this.outer.rotation=this.shadow.rotation=Game.getRandom(0,2*Math.PI),this.container=Game.displayStore.getContainer("paint-scene/swatch-container"),this.container.addChild(this.shadow),this.container.addChild(this.outer),this.container.addChild(this.swatch),this.container.position.set(n[0],n[1]),this.addInteraction()}return t.prototype.addInteraction=function(){var t=this,e=this.swatch;Game.onDesktop?e.on("click",function(e){t.tap(t,e)}):e.on("tap",function(e){t.tap(t,e)})},t.prototype.tap=function(t,e){this.scene.activateSwatch(this)},t.prototype.activate=function(){TweenMax.to(this.container.scale,.5,{ease:Elastic.easeOut,x:1.3,y:1.3}),TweenMax.to(this.shadow.position,.5,{ease:Elastic.easeOut,y:6}),this.container.parent.addChild(this.container)},t.prototype.deactivate=function(){TweenMax.to(this.container.scale,.3,{ease:Back.easeOut,x:1,y:1}),TweenMax.to(this.shadow.position,.3,{ease:Back.easeOut,y:3})},t.prototype.setColour=function(t){this.swatch.tint=t,"tint"==this.group&&(this.colour=t,0==this.index&&(this.colour=parseInt(this.LightenDarkenColor(t.toString(16),-80),16)),2==this.index&&(this.colour=parseInt(this.LightenDarkenColor(t.toString(16),90),16)),this.swatch.tint=this.colour)},t.prototype.LightenDarkenColor=function(t,e){var i=!1;"#"==t[0]&&(t=t.slice(1),i=!0);var n=parseInt(t,16),o=(n>>16)+e;o>255?o=255:o<0&&(o=0);var r=(n>>8&255)+e;r>255?r=255:r<0&&(r=0);var a=(255&n)+e;return a>255?a=255:a<0&&(a=0),(i?"#":"")+(a|r<<8|o<<16).toString(16)},t.prototype.destroy=function(){this.swatch.removeAllListeners(),this.container.removeAllChildren()},t}(),Brush=function(){function t(t,e,i,n){var o=["thick","medium","fine"];this.scene=t,this.thickness=i,this.index=e,this.sprite=Game.displayStore.getSprite("paint-scene/brush-"+o[i-1]+".png"),this.sprite.interactive=!0,this.shadow=Game.displayStore.getSprite("paint-scene/brush-"+o[i-1]+".png"),this.shadow.alpha=.3,this.shadow.tint=0,this.shadow.position.y=6,this.container=Game.displayStore.getContainer("paint-scene/brush-container"),this.container.addChild(this.shadow),this.container.addChild(this.sprite),this.container.position.set(n[0],n[1]),this.addInteraction()}return t.prototype.addInteraction=function(){var t=this,e=this.sprite;Game.onDesktop?e.on("click",function(e){t.tap(t,e)}):e.on("tap",function(e){t.tap(t,e)})},t.prototype.tap=function(t,e){this.scene.activateBrush(this)},t.prototype.activate=function(){TweenMax.to(this.container.position,.5,{x:95,ease:Elastic.easeOut}),this.container.parent.addChild(this.container)},t.prototype.deactivate=function(){TweenMax.to(this.container.position,.3,{x:120,ease:Back.easeOut})},t.prototype.destroy=function(){this.sprite.removeAllListeners(),this.container.removeAllChildren()},t}(),Car=function(){function t(t){this.scene=t,this.sampleScale=1,this.outputSampleScale=2,this.loadedWheels=[],Game.coreData.getCurrentCarType()?this.type=Game.coreData.getCurrentCarType():(Game.coreData.setCurrentCarType("truck"),this.type=Game.coreData.getCurrentCarType());var e=CoreData.carTypeData[this.type];this.sprite=Game.displayStore.getSprite("craft-scene/"+this.type),this.spriteBG=Game.displayStore.getSprite("craft-scene/"+this.type),this.spriteBG.visible=!0,this.sprite.visible=!0,this.wheelAttachPointData=e.wheelAttachPoints,this.accessoryAttachPointData=e.accessoryAttachPoints,this.attachPoints=[],this.corners=[];for(var i=[{scale:new PIXI.Point(1,1),pos:new PIXI.Point(0,-60)},{scale:new PIXI.Point(-1,1),pos:new PIXI.Point(650,-60)},{scale:new PIXI.Point(1,-1),pos:new PIXI.Point(0,330)},{scale:new PIXI.Point(-1,-1),pos:new PIXI.Point(650,330)}],n=0;n<4;n++){var o=Game.displayStore.getSprite("craft-scene/highlight-corner.png");o.scale.x=i[n].scale.x,o.scale.y=i[n].scale.y,o.position=i[n].pos,this.corners.push(o)}this.renderTextureObject=Game.displayStore.getRenderTexture("car-render-texture",this.spriteBG.width/this.sampleScale,this.spriteBG.height/this.sampleScale,"car-render-texture-"+Game.coreData.getCurrentGarageIndex()+"-group",!1),this.renderTextureObject2=Game.displayStore.getRenderTexture("car-render-texture-2",this.spriteBG.width/this.sampleScale,this.spriteBG.height/this.sampleScale,"car-render-texture-2-"+Game.coreData.getCurrentGarageIndex()+"-group",!1),this.renderTextureObjectRaceOutput=Game.displayStore.getRenderTexture("car-render-texture-race-output",this.spriteBG.width/this.outputSampleScale,this.spriteBG.height/this.outputSampleScale,"car-render-texture-race-output-"+Game.coreData.getCurrentGarageIndex()+"-group",!1),this.renderTextureObjectCraftOutput=Game.displayStore.getRenderTexture("car-render-texture-craft-output",this.spriteBG.width,this.spriteBG.height,"car-render-texture-craft-output-"+Game.coreData.getCurrentGarageIndex()+"-group",!1),this.renderTexture=this.renderTextureObject.renderTexture,this.renderTexture2=this.renderTextureObject2.renderTexture,this.renderTextureRaceOutput=this.renderTextureObjectRaceOutput.renderTexture,this.renderTextureCraftOutput=this.renderTextureObjectCraftOutput.renderTexture,this.renderTextureSprite=this.renderTextureObject.outputSprite,this.renderTextureSprite2=this.renderTextureObject2.outputSprite,this.renderTextureSprite.alpha=0,this.renderTextureSprite.visible=!0,this.carMaskSquareHolder=Game.displayStore.getContainer("craft-scene/car-mask-square-holder"),this.carMaskSquareHolder.alpha=0,this.mask=Game.displayStore.getSprite("craft-scene/"+this.type+"-mask"),this.showMaskSprite=Game.displayStore.getSprite("craft-scene/"+this.type+"-mask-inverse"),this.mask.visible=!1;var r=PIXI.BLEND_MODES.MULTIPLY;this.showMaskSprite.tint=2398675,this.showMaskSprite.blendMode=r;var a=Game.displayStore.getSprite("craft-scene/car-mask-square");a.setRegPoint(1,0),a.width=Game.stageWidth,a.height=this.showMaskSprite.height,a.position.copy(this.showMaskSprite.position),a.blendMode=r,a.tint=2398675,this.carMaskSquareHolder.addChild(a);var s=Game.displayStore.getSprite("craft-scene/car-mask-square");s.setRegPoint(0,0),s.width=Game.stageWidth,s.height=this.showMaskSprite.height,s.position.x=this.showMaskSprite.position.x+this.showMaskSprite.width,s.position.y=this.showMaskSprite.position.y,s.blendMode=r,s.tint=2398675,this.carMaskSquareHolder.addChild(s);var l=Game.displayStore.getSprite("craft-scene/car-mask-square");l.setRegPoint(.5,1),l.width=2*Game.stageWidth,l.height=Game.stageHeight,l.position.copy(this.showMaskSprite.position),l.blendMode=r,l.tint=2398675,this.carMaskSquareHolder.addChild(l);var c=Game.displayStore.getSprite("craft-scene/car-mask-square");c.setRegPoint(.5,0),c.width=2*Game.stageWidth,c.height=Game.stageHeight,c.position.x=this.showMaskSprite.position.x,c.position.y=this.showMaskSprite.position.y+this.showMaskSprite.height,c.blendMode=r,c.tint=2398675,this.carMaskSquareHolder.addChild(c),this.carMaskSquareHolder.addChild(this.showMaskSprite),this.container=Game.displayStore.getContainer("craft-scene/car-container"),this.carContainer=this.container.getContainer("craft-scene/car-inner-container"),this.container.addChild(this.carContainer),this.shadow=Game.displayStore.getSprite("craft-scene/"+this.type+"-shadow"),this.shadow.alpha=.3,this.shadow.tint=0,this.shadow.position.x=3,this.shadow.position.y=6,this.outputContainer=Game.displayStore.getContainer("craft-scene/output-container"),this.innerOutputContainer=Game.displayStore.getContainer("craft-scene/inner-output-container"),this.outputContainer.addChild(this.innerOutputContainer),this.innerOutputContainer.addChild(this.sprite),this.innerOutputContainer.addChild(this.renderTextureSprite),this.undoContainer=Game.displayStore.getContainer("craft-scene/undo-container"),this.undoContainer.addChild(this.renderTextureSprite2),this.outputContainer.addChildAt(this.spriteBG,0),this.carContainer.addChild(this.outputContainer),this.outputContainer.addChild(this.mask),this.outputContainer.addChild(this.carMaskSquareHolder);for(n=0;n<this.corners.length;n++)this.container.addChild(this.corners[n]),this.corners[n].visible=!1;this.container.addChildAt(this.shadow,0),this.renderTextureSprite.scale.set(this.sampleScale),this.renderTextureSprite2.scale.set(this.sampleScale),this.setPos([220,150]),this.container.interactiveChildren=!1,this.container.interactive=!1}return t.prototype.enableCorners=function(){for(var t=(this.corners[1].position.x-this.corners[0].position.x)/(this.corners[2].position.y-this.corners[0].position.y),e=0;e<this.corners.length;e++)this.corners[e].visible=!0;TweenMax.from(this.corners[0].position,.7,{x:"+="+String(100),y:"+="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[1].position,.7,{x:"-="+String(100),y:"+="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[2].position,.7,{x:"+="+String(100),y:"-="+String(100*t),ease:Elastic.easeOut}),TweenMax.from(this.corners[3].position,.7,{x:"-="+String(100),y:"-="+String(100*t),ease:Elastic.easeOut})},t.prototype.enableMask=function(){this.mask.visible=!0,this.innerOutputContainer.mask=this.mask},t.prototype.disableMask=function(){this.mask.visible=!1,this.innerOutputContainer.mask=null},t.prototype.createWheelAttachPoints=function(){for(var t=0;t<this.wheelAttachPointData.length;t++){var e=new CarAttachPoint(this.wheelAttachPointData[t]);this.container.addChild(e.container),this.attachPoints.push(e)}},t.prototype.createAccessoryAttachPoints=function(){for(var t=0;t<this.accessoryAttachPointData.length;t++){var e=new CarAttachPoint(this.accessoryAttachPointData[t]);this.container.addChild(e.container),this.attachPoints.push(e)}},t.prototype.showAttachPoints=function(){for(var t=0;t<this.attachPoints.length;t++)this.attachPoints[t].enable()},t.prototype.setPos=function(t){this.container.position.set(t[0],t[1]),this.renderTextureSprite2.position.set(t[0],t[1])},t.prototype.setScale=function(t){this.container.scale.set(t,t)},t.prototype.showMask=function(t,e){t?(e.addChild(this.carMaskSquareHolder),this.carMaskSquareHolder.position.x=e.toLocal(new PIXI.Point,this.container).x+this.mask.position.x,this.carMaskSquareHolder.position.y=e.toLocal(new PIXI.Point,this.container).y+this.mask.position.y,this.carMaskSquareHolder.alpha=.5,this.carMaskSquareHolder.interactive=!1,this.carMaskSquareHolder.interactiveChildren=!1):this.carMaskSquareHolder.alpha=0},t.prototype.checkHighlightAttachPoints=function(t,e){var i,n=t.draggableItem.container.position;i=CoreData.accessoryTypeData[t.id]?CoreData.accessoryTypeData[t.id].defaultAngle:0;for(var o=0;o<this.attachPoints.length;o++){var r=this.attachPoints[o],a=this.scene.container.toLocal(new PIXI.Point,r.container);if(this.scene.getDistance(a,n)<e&&0==r.highlighted){r.highlight();var s=r.angle||0;TweenMax.to(t.draggableItem.container,.2,{rotation:s+i,ease:Power3.easeOut})}this.scene.getDistance(a,n)>e&&1==r.highlighted&&(r.removeHighlight(),TweenMax.to(t.draggableItem.container,.2,{rotation:0,ease:Power3.easeOut}))}},t.prototype.attachPointHighlighted=function(){for(var t,e=0;e<this.attachPoints.length;e++){var i=this.attachPoints[e];if(1==i.highlighted){t=i;break}}return t},t.prototype.attachPointsNotHighlighted=function(){for(var t=[],e=0;e<this.attachPoints.length;e++){var i=this.attachPoints[e];0==i.highlighted&&t.push(i)}return t},t.prototype.addSticker=function(t,e){1==e&&t.container.position.copy(this.innerOutputContainer.toLocal(new PIXI.Point,t.container)),t.pos=t.container.position,this.innerOutputContainer.addChild(t.container)},t.prototype.addAccessory=function(t,e){var i;i=CoreData.accessoryTypeData[t.id]?CoreData.accessoryTypeData[t.id].defaultAngle:0,t.container.position.copy(e.container.position),this.outputContainer.addChildAt(t.container,0),t.container.visible=!0,e.attachment&&(e.attachment.container.visible=!1),e.addAttachment(t),this.hidePopulatedAttachPoints();var n=e.angle||0;t.container.scale.set(.8,.8),t.container.rotation=n+i||0,t.updateRegPoint(),TweenMax.to(t.container.scale,.4,{x:1,y:1,ease:Elastic.easeOut})},t.prototype.addWheel=function(t,e){t.container.position.copy(e.container.position),this.outputContainer.addChild(t.container),t.container.visible=!0,e.disable(),e.addAttachment(t),t.container.scale.set(.8,.8),t.container.rotation=0,TweenMax.to(t.container.scale,.4,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(t.container,1,{rotation:2*Math.PI,ease:Power3.easeInOut})},t.prototype.hidePopulatedAttachPoints=function(){for(var t=0;t<this.attachPoints.length;t++){var e=this.attachPoints[t];e.attachment&&e.disable()}},t.prototype.clearAllAttachments=function(){for(var t=0;t<this.attachPoints.length;t++)this.attachPoints[t].attachment&&(this.attachPoints[t].attachment.container.visible=!1)},t.prototype.render=function(t,e,i,n,o){var r=new PIXI.Matrix,a=n||this.sampleScale,s=o||!1,l=i||this.renderTexture;i||(this.renderTextureSprite.alpha=1),r.scale(1/a,1/a),e&&r.translate(-this.container.position.x/a,-this.container.position.y/a),Game.renderer.render(t,l,s,r)},t.prototype.getPaintLayerTexture=function(){return this.renderTexture},t.prototype.getRaceOutputTexture=function(){return this.clearAllAttachments(),this.render(this.carContainer,!1,this.renderTextureRaceOutput,this.outputSampleScale,!1),this.renderTextureRaceOutput},t.prototype.getGarageOutputTexture=function(t){if(this.outputContainer.removeChild(this.carMaskSquareHolder),t){var e=Game.coreData.getPlayerCarData().carGarageSprite;e&&(this.outputContainer.addChildAt(e,0),e.position.set(-Game.coreData.getPlayerCarData().carGarageOffset[0],-Game.coreData.getPlayerCarData().carGarageOffset[1]))}this.renderTextureObjectGarageOutput=Game.displayStore.getRenderTexture("car-render-texture-garage-output",this.outputContainer.width,this.outputContainer.height,"car-render-texture-garage-output-"+Game.coreData.getCurrentGarageIndex(),!1),this.renderTextureGarageOutput=this.renderTextureObjectGarageOutput.renderTexture;for(var i=0;i<this.corners.length;i++)this.corners[i].visible=!1;this.hidePopulatedAttachPoints();var n=this.outputContainer.getLocalBounds();return this.outputContainer.position.set(-n.x,-n.y),this.render(this.carContainer,!1,this.renderTextureGarageOutput,1,!1),{texture:this.renderTextureGarageOutput,offset:[-n.x,-n.y]}},t.prototype.getStickersOutputTexture=function(){return this.renderTextureSprite.visible=!1,this.sprite.visible=!1,this.spriteBG.visible=!1,this.render(this.outputContainer,!1,this.renderTextureCraftOutput,1,!1),this.renderTextureCraftOutput},t.prototype.addStickersLayer=function(t){this.innerOutputContainer.addChild(t)},t.prototype.loadWheels=function(){var t;Game.coreData.getPlayerCarData().wheelChoice?t=Game.coreData.getPlayerCarData().wheelChoice:(Game.coreData.storeWheelChoice("wheel-style-2"),t=Game.coreData.getPlayerCarData().wheelChoice);for(var e=0;e<this.wheelAttachPointData.length;e++){var i=Game.displayStore.getSprite("wheels-scene/draggable-"+t);i.setRegPoint(.5,.5),i.position.set(this.wheelAttachPointData[e].pos[0],this.wheelAttachPointData[e].pos[1]),this.outputContainer.addChild(i),this.loadedWheels.push(i)}},t.prototype.loadPaintState=function(t){this.render(t),this.saveState(PIXI.BLEND_MODES.MULTIPLY)},t.prototype.saveState=function(t){this.renderTextureSprite.blendMode=PIXI.BLEND_MODES.NORMAL,this.sprite.visible=!1,this.render(this.outputContainer,!1,this.renderTexture2,this.sampleScale,!0),this.sprite.visible=!0,t&&(this.renderTextureSprite.blendMode=t)},t.prototype.undoStep=function(){var t=new PIXI.Matrix;t.scale(1/this.sampleScale,1/this.sampleScale),t.translate(-this.container.position.x/this.sampleScale,-this.container.position.y/this.sampleScale),Game.renderer.render(this.renderTextureSprite2,this.renderTexture,!0,t,!1)},t.prototype.destroy=function(){this.mask.visible=!1,this.innerOutputContainer.mask=null,this.sprite.removeAllListeners(),this.innerOutputContainer.removeAllChildren(),this.outputContainer.removeAllChildren(),this.carContainer.removeAllChildren(),this.container.removeAllChildren(),Game.displayStore.returnPooledItem(this.sprite),Game.displayStore.returnPooledItem(this.spriteBG),Game.displayStore.returnPooledItem(this.mask);for(t=0;t<this.corners.length;t++)Game.displayStore.returnPooledItem(this.corners[t]);for(;this.carMaskSquareHolder.children.length>0;)Game.displayStore.returnPooledItem(this.carMaskSquareHolder.getSpriteAt(0)),this.carMaskSquareHolder.removeChild(this.carMaskSquareHolder.getSpriteAt(0));for(var t=0;t<this.loadedWheels.length;t++)this.loadedWheels[t].parent&&this.loadedWheels[t].parent.removeChild(this.loadedWheels[t]),Game.displayStore.returnPooledItem(this.loadedWheels[t])},t}(),Trail=function(){function t(t){this.scene=t,this.targetAlpha=1,this.container=Game.displayStore.getContainer("paint-scene/trail-holder"),this.textures=[];for(i=0;i<3;i++){var e=Game.displayStore.getSprite("paint-scene/snake-"+i+".png").texture;this.textures.push(e)}this.historyX=[],this.historyY=[],this.historySize=15,this.ropeSize=30,this.points=[],this.lastPos=new PIXI.Point(0,0),this.currentDistance=0;for(i=0;i<this.historySize;i++)this.historyX.push(0),this.historyY.push(0);for(var i=0;i<this.ropeSize;i++)this.points.push(new PIXI.Point(0,0));this.rope=new PIXI.mesh.Rope(this.textures[1],this.points),this.container.addChild(this.rope),this.container.interactive=!1,this.container.interactiveChildren=!1}return t.prototype.doTrail=function(t){var e=new PIXI.Point(t.x,t.y),i=this.getDistance(t.x,t.y,this.lastPos.x,this.lastPos.y);this.currentDistance=i,this.rope.alpha+=(this.targetAlpha-this.rope.alpha)/7,this.historyX.pop(),this.historyX.unshift(e.x),this.historyY.pop(),this.historyY.unshift(e.y);for(var n=0;n<this.ropeSize;n++){var o=this.points[n],r=this.cubicInterpolation(this.historyX,n/this.ropeSize*this.historySize),a=this.cubicInterpolation(this.historyY,n/this.ropeSize*this.historySize);o.x=r,o.y=a}this.lastPos.x=t.x,this.lastPos.y=t.y},t.prototype.getDistance=function(t,e,i,n){var o=t-i,r=e-n;return Math.sqrt(o*o+r*r)},t.prototype.clipInput=function(t,e){return t<0&&(t=0),t>e.length-1&&(t=e.length-1),e[t]},t.prototype.getTangent=function(t,e,i){return e*(this.clipInput(t+1,i)-this.clipInput(t-1,i))/2},t.prototype.cubicInterpolation=function(t,e,i){null==i&&(i=1);var n=Math.floor(e),o=[this.getTangent(n,i,t),this.getTangent(n+1,i,t)],r=[this.clipInput(n,t),this.clipInput(n+1,t)],a=(e-=n)*e,s=e*a;return(2*s-3*a+1)*r[0]+(s-2*a+e)*o[0]+(-2*s+3*a)*r[1]+(s-a)*o[1]},t.prototype.setColour=function(t){this.rope.tint=t,this.colour=t},t.prototype.setThickness=function(t){this.container.removeChild(this.rope),this.rope.destroy(),this.rope=new PIXI.mesh.Rope(this.textures[t-1],this.points),this.rope.tint=this.colour,this.container.addChild(this.rope)},t.prototype.clearHistory=function(t){for(var e=0;e<this.historySize;e++)this.historyX[e]=t.x,this.historyY[e]=t.y},t.prototype.destroy=function(){this.container.removeChild(this.rope),this.rope.destroy()},t}(),MenuTile=function(){function t(t,e,i,n,o,r,a,s){this.scene=t,this.index=e,this.draggableItems=[],this.dragging=!1,this.mousePos=new PIXI.Point,this.id=n.id,this.locked=n.locked,this.price=n.price,CoreData.accessoryTypeData[this.id]&&(this.draggableSpriteAnchor=CoreData.accessoryTypeData[this.id].anchor),this.container=Game.displayStore.getContainer("craft-scene/tile-holder"),this.bg=Game.displayStore.getSprite("craft-scene/tile"),this.tileGreenBorder=Game.displayStore.getSprite("craft-scene/tile-green-border"),this.tileGreenBorder.visible=!1,this.tile=Game.displayStore.getSprite(s+"tile-"+this.id),this.tile.position.x=o[0],this.tile.position.y=o[1],this.tile.setRegPoint(r[0],r[1]),this.tileSpriteString=s+"tile-"+this.id,this.draggableSpriteString=s+"draggable-"+this.id,this.touchSprite=Game.displayStore.getSprite("craft-scene/tile-touch-sprite"),this.touchSprite.width=this.bg.width,this.touchSprite.height=this.bg.height,this.touchSprite.alpha=0,this.lockIcon=Game.displayStore.getContainer("craft-scene/lock-icon");var l=Game.displayStore.getSprite("craft-scene/lock-icon.png"),c=Game.displayStore.getSprite("craft-scene/lock-icon-unlocked.png");this.lockIcon.addChild(l),this.lockIcon.addChild(c),this.lockIcon.showOnlyChild(0),this.lockedAnimation=new TimelineMax;var h=new TimelineMax;h.add(TweenMax.to(this.lockIcon,.1,{rotation:.1,ease:Power2.easeOut})),h.add(TweenMax.to(this.lockIcon,.2,{rotation:-.1,repeat:4,yoyo:!0,ease:Power2.easeInOut})),h.add(TweenMax.to(this.lockIcon,.1,{rotation:0,ease:Power1.easeOut})),h.timeScale(2),this.lockedAnimation.add(TweenMax.to(this.lockIcon.scale,.2,{x:1.3,y:1.3,ease:Back.easeOut})),this.lockedAnimation.add(TweenMax.to(this.lockIcon.scale,.2,{x:1,y:1,ease:Back.easeOut}),.4),this.lockedAnimation.add(h,0),this.lockedAnimation.call(this.scene.game.ui.showPrompt,[null,"achievement",this],this.scene.game.ui,.5),this.lockedAnimation.call(Game.playSound,["unlock.mp3"],this,0),this.lockedAnimation.pause(),0==this.locked?(this.lockIcon.visible=!1,this.tile.tint=16777215):(this.tile.tint=0,this.lockIcon.visible=!0),this.container.addChild(this.bg),this.container.addChild(this.tile),this.container.addChild(this.lockIcon),this.container.addChild(this.tileGreenBorder),this.container.position.set(i[0],i[1]),this.price&&1==this.locked&&(this.lockIcon.visible=!1,this.priceIcon=Game.displayStore.getSprite("craft-scene/price-icon"),this.priceIcon.scale.set(.5,.5),this.priceIcon.position.set(-12,0),this.priceIcon.alpha=1,this.container.addChild(this.priceIcon),this.priceText=Game.displayStore.getBitmapText("craft-scene/price-text",""),this.priceText.text=String(this.price),this.priceText.scale.set(.4,.4),this.priceText.position.x=5,this.priceText.position.y=-18,this.priceText.alpha=1,this.container.addChild(this.priceText),this.unlockAnimation=new TimelineMax,this.unlockAnimation.call(function(){this.lockIcon.showOnlyChild(1),this.tile.tint=16777215,this.priceText.alpha=0,this.priceIcon.alpha=0,this.tile.scale.set(1.5,1.5),this.locked=!1,Game.coreData.unlockWheels(this.id)},null,this),this.unlockAnimation.add(TweenMax.to(this.tile.scale,1,{x:1,y:1,ease:Elastic.easeOut})),this.unlockAnimation.pause()),this.container.addChild(this.touchSprite),this.createDraggableItemPool(a),this.addInteraction()}return t.prototype.createDraggableItemPool=function(t){for(var e=0;e<20;e++){var i;i="sticker"==t?new Sticker(this,e,this.draggableSpriteString,this.id):"accessory"==t?new Accessory(this,e,this.draggableSpriteString,this.id,this.draggableSpriteAnchor):new DraggableMenuItem(this,e,this.draggableSpriteString,this.id),this.draggableItems.push(i)}},t.prototype.unlock=function(){this.unlockAnimation.restart()},t.prototype.addInteraction=function(){var t=this,e=this.touchSprite;this.touchSprite.interactive=!0,Game.onDesktop?e.on("mousedown",function(e){t.touchStart(t,e)}):e.on("touchstart",function(e){t.touchStart(t,e)})},t.prototype.showSelected=function(){this.tileGreenBorder.visible=!0},t.prototype.hideSelected=function(){this.tileGreenBorder.visible=!1},t.prototype.touchStart=function(t,e){if(1!=t.locked){t.dragging=!0,t.scene.setSelectedMenuItem(this),t.draggableItem.container.visible=!0;var i=new PIXI.Point;i.x=e.data.getLocalPosition(t.scene.dragLayer).x,i.y=e.data.getLocalPosition(t.scene.dragLayer).y,t.draggableItem.container.position.copy(i)}else 1==t.lockIcon.visible?t.lockedAnimation.restart():Game.coreData.getCurrentCoins()<this.price?t.scene.game.ui.showPrompt("not-enough-coins","close-only"):t.scene.buyItem(this)},t.prototype.getNewDraggableItem=function(t){for(var e,i=0;i<this.draggableItems.length;i++)if(0==this.draggableItems[i].inUse){e=this.draggableItems[i],this.draggableItems[i].inUse=!0;break}if(!e){for(i=0;i<this.draggableItems.length;i++)this.draggableItems[i].inUse=!1;e=this.draggableItems[0],this.draggableItems[0].inUse=!0}return e.container.visible=!0,this.scene.dragLayer.addChild(e.container),t||(this.draggableItem=e,this.draggableItem.startDrag()),e},t.prototype.dropItem=function(){},t.prototype.moveItem=function(t){this.draggableItem.moveItem(t)},t.prototype.activate=function(){this.container.position.x=95,this.container.parent.addChild(this.container)},t.prototype.deactivate=function(){this.container.position.x=120},t.prototype.tick=function(){},t.prototype.destroy=function(){this.touchSprite.removeAllListeners(),this.container.removeAllChildren(),this.lockIcon.removeAllChildren(),this.lockedAnimation=this.scene.killTween(this.lockedAnimation);for(var t=0;t<this.draggableItems.length;t++)this.draggableItems[t].destroy();this.priceIcon&&(Game.displayStore.returnPooledItem(this.priceIcon),Game.displayStore.returnPooledItem(this.priceText))},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sticker=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.crossButton=Game.displayStore.getSprite("sticker-scene/cross-button"),r.container.addChild(r.crossButton),r.crossButton.visible=!1,r.container.interactive=!0,r.container.interactiveChildren=!0,r.addInteraction(),r}return __extends(e,t),e.prototype.enterDeleteMode=function(){this.crossButton.scale.set(0,0),TweenMax.to(this.crossButton.scale,.2,{ease:Back.easeOut,x:1,y:1}),this.crossButton.visible=!0},e.prototype.exitDeleteMode=function(){this.crossButton.visible=!1},e.prototype.addInteraction=function(){var t=this,e=this.crossButton;this.crossButton.interactive=!0,Game.onDesktop?e.on("click",function(e){t.tap(t,e)}):e.on("tap",function(e){t.tap(t,e)})},e.prototype.tap=function(t,e){this.scene.removeSticker(this)},e.prototype.activate=function(){this.container.position.x=95,this.container.parent.addChild(this.container)},e.prototype.deactivate=function(){this.container.position.x=120},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.crossButton.removeAllListeners()},e}(DraggableMenuItem),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Accessory=function(t){function e(e,i,n,o,r){var a=t.call(this,e,i,n,o)||this;return a.crossButton=Game.displayStore.getSprite("accessories-scene/cross-button"),a.container.addChild(a.crossButton),a.crossButton.visible=!1,a.container.interactive=!0,a.container.interactiveChildren=!0,a.sprite.setRegPoint(r[0],r[1]),a.anchor=r,a.addInteraction(),a}return __extends(e,t),e.prototype.enterDeleteMode=function(){this.crossButton.visible=!0,this.crossButton.scale.set(0,0),TweenMax.to(this.crossButton.scale,.2,{ease:Back.easeOut,x:1,y:1})},e.prototype.exitDeleteMode=function(){this.crossButton.visible=!1},e.prototype.addInteraction=function(){var t=this,e=this.crossButton;this.crossButton.interactive=!0,Game.onDesktop?e.on("click",function(e){t.tap(t,e)}):e.on("tap",function(e){t.tap(t,e)})},e.prototype.updateRegPoint=function(){this.sprite.setRegPoint(this.anchor[0],this.anchor[1])},e.prototype.tap=function(t,e){this.scene.removeAccessory(this)},e.prototype.activate=function(){this.container.position.x=95,this.container.parent.addChild(this.container)},e.prototype.deactivate=function(){this.container.position.x=120},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.crossButton.removeAllListeners()},e}(DraggableMenuItem),CarAttachPoint=function(){function t(t){this.container=Game.displayStore.getContainer("craft-scene/attach-point-container"),this.sprite=Game.displayStore.getSprite("craft-scene/attach-point"),this.sprite.setRegPoint(.5,.5),this.container.addChild(this.sprite),this.container.visible=!1,this.container.position.set(t.pos[0],t.pos[1]),t.angle&&(this.angle=t.angle),this.highlighted=!1}return t.prototype.enable=function(){this.container.scale.set(0,0),this.container.visible=!0,TweenMax.killTweensOf(this.container.scale),TweenMax.to(this.container.scale,.5,{x:1,y:1,ease:Elastic.easeOut})},t.prototype.disable=function(){this.container.scale.set(0,0),this.container.visible=!1,this.highlighted=!1},t.prototype.highlight=function(){this.highlighted=!0,TweenMax.killTweensOf(this.container.scale),TweenMax.to(this.container.scale,.5,{x:1.2,y:1.2,ease:Elastic.easeOut})},t.prototype.removeHighlight=function(){this.highlighted=!1,TweenMax.killTweensOf(this.container.scale),TweenMax.to(this.container.scale,.5,{x:1,y:1,ease:Elastic.easeOut})},t.prototype.addAttachment=function(t){this.attachment=t,"tom-cheese"==this.attachment.id&&Game.coreData.unlockAchievement("unlock-cheese-wedge"),"scooby-snacks"==this.attachment.id&&Game.coreData.unlockAchievement("unlock-scooby-snack-attachment")},t.prototype.removeAttachment=function(t){this.attachment=null},t.prototype.destroy=function(){this.container.removeAllChildren()},t}(),Meter=function(){function t(t,e,i,n,o){this.scene=t,this.type=o,this.index=e,this.shadow=Game.displayStore.getSprite("craft-scene/meter-bg.png"),this.shadow.tint=0,this.shadow.alpha=.3,this.shadow.position.set(0,4),this.bg=Game.displayStore.getSprite("craft-scene/meter-bg.png"),this.fg=Game.displayStore.getSprite("craft-scene/meter-fg.png"),this.fg2=Game.displayStore.getSprite("craft-scene/meter-fg.png"),this.container=Game.displayStore.getContainer("craft-scene/meter-container"),this.container.addChild(this.shadow),this.container.addChild(this.bg),this.container.addChild(this.fg),this.container.addChild(this.fg2),this.container.position.set(i[0],i[1]),this.mask=new PIXI.Graphics,this.mask.beginFill(16711680,1),this.mask.drawRect(0,0,this.fg.width,this.fg.height),this.mask.position.x=-this.fg.width/2,this.mask.scale.x=0,this.mask2=new PIXI.Graphics,this.mask2.beginFill(16711680,1),this.mask2.drawRect(0,0,this.fg.width,this.fg.height),this.mask2.position.x=-this.fg.width/2,this.mask2.scale.x=0,this.fg.mask=this.mask,this.fg2.mask=this.mask2,this.container.addChild(this.mask),this.container.addChild(this.mask2),this.title=Game.displayStore.getBitmapText("craft-scene/meter-text",n),this.title.tint=16771584,this.title.position.y=30,this.title.anchor=new PIXI.Point(.5,0),this.container.addChild(this.title)}return t.prototype.setValue=function(t,e){if(this.fg.tint=16777215,t){var i=CoreData.wheelTypeData[t][this.type]/CoreData.wheelStatsMinMax[this.type].max;e?(TweenMax.to(this.mask2.scale,.3,{x:i,ease:Back.easeOut}),i>this.mask.scale.x?(this.container.addChild(this.fg2),this.container.addChild(this.fg),this.fg.tint=16777215,this.fg2.tint=65280):(this.container.addChild(this.fg),this.container.addChild(this.fg2),this.fg.tint=16711680,this.fg2.tint=16777215)):(TweenMax.to(this.mask2.scale,.3,{x:0,ease:Back.easeOut}),TweenMax.to(this.mask.scale,.3,{x:i,ease:Back.easeOut}))}else TweenMax.to(this.mask.scale,.3,{x:0,ease:Back.easeOut}),TweenMax.to(this.mask2.scale,.3,{x:0,ease:Back.easeOut});this.lastValue=this.mask2.scale.x},t.prototype.destroy=function(){this.container.removeAllChildren(),this.mask.clear()},t}(),CoinsPanel=function(){function t(t){this.scene=t,this.container=Game.displayStore.getContainer("craft-scene/player-coins"),this.coin=this.container.getContainer("craft-scene/player-coin-icon"),this.coinShadow=this.coin.getSprite("craft-scene/player-coin-icon-shadow"),this.coinShadow.alpha=.3,this.coinShadow.tint=0,this.coinShadow.position.y=5,this.coinIcon=this.coin.getSprite("craft-scene/player-coin-icon.png"),this.coins=Game.coreData.getCurrentCoins(),this.coinsText=Game.displayStore.getBitmapText("craft-scene/coins-text",""),this.coinsText.position.set(93,-3),this.coinsText.text=String(this.coins),this.coinsTextShadow=Game.displayStore.getBitmapText("craft-scene/coins-text-shadow",""),this.coinsTextShadow.position.set(93,1),this.coinsTextShadow.tint=0,this.coinsTextShadow.alpha=.3,this.coinsTextShadow.text=String(Game.coreData.getCurrentCoins()),this.container.addChild(this.coinsTextShadow),this.container.addChild(this.coinsText),this.container.setRegPoint(.5,.5,!0)}return t.prototype.updateCoins=function(){var t,e=Game.coreData.getCurrentCoins(),i=Math.abs(this.coins-e),n=this.coins,o=.5/i;t=e>this.coins?1:-1,this.updateCoinsTimeline=this.scene.killTween(this.updateCoinsTimeline),this.updateCoinsTimeline=new TimelineMax,this.updateCoinsTimeline.add(TweenMax.to(this.container.scale,.3,{x:1.2,y:1.2,ease:Power4.easeOut}));for(var r=0;r<i;r++)this.updateCoinsTimeline.call(function(){n+=t,this.coinsText.text=String(n),this.coinsTextShadow.text=String(n),this.coinsText.position.x=this.coinsTextShadow.position.x=90},null,this,"+="+String(o));this.updateCoinsTimeline.add(TweenMax.to(this.container.scale,.3,{x:1,y:1,ease:Back.easeOut}),"+=0.2"),this.updateCoinsTimeline.call(function(){this.scene.coinsAreUpdated(),this.coins=Game.coreData.getCurrentCoins()},null,this)},t.prototype.destroy=function(){this.container.removeAllChildren(),this.updateCoinsTimeline=this.scene.killTween(this.updateCoinsTimeline)},t}(),CarouselTile=function(){function t(t,e,i,n,o,r){this.scene=t,this.index=e,this.id=n.id,this.sampleScale=2;var a=n.carGarageSprite,s=[];if(this.tile=a||Game.displayStore.getSprite(o+"/tile-"+this.id),n.holeOffset?(s[0]=n.holeOffset[0],s[1]=n.holeOffset[1]):(s[0]=Game.coreData.getCarTypeHoleOffset(this.id)[0]+Game.coreData.getPlayerGarageData()[this.index].carGarageOffset[0],s[1]=Game.coreData.getCarTypeHoleOffset(this.id)[1]+Game.coreData.getPlayerGarageData()[this.index].carGarageOffset[1]),this.container=Game.displayStore.getContainer("carousel-menu/tile-container"),this.innerContainer=Game.displayStore.getContainer("carousel-menu/tile-inner-container"),this.rope=Game.displayStore.getContainer("carousel-menu/rope-container"),this.ropeBack=Game.displayStore.getSprite("carousel-menu/rope-back.png"),this.ropeFront=Game.displayStore.getSprite("carousel-menu/rope-front.png"),this.ropeBack.parentGroup=Scene.SORT_GROUP_BACK,this.rope.addChild(this.ropeBack),this.rope.addChild(this.ropeFront),this.rope.position.x=s[0],this.rope.position.y=s[1],this.innerContainer.addChild(this.tile),r){this.renderTextureObject=Game.displayStore.getRenderTexture("tile-"+this.index+"render-texture",this.tile.width/this.sampleScale,this.tile.height/this.sampleScale,"carousel-menu-assets",!1),this.renderTexture=this.renderTextureObject.renderTexture,this.renderTextureSprite=this.renderTextureObject.outputSprite;var l=new PIXI.Matrix;l.scale(1/this.sampleScale,1/this.sampleScale),Game.renderer.render(this.innerContainer,this.renderTexture,!0,l),this.renderTextureSprite.alpha=.3,this.renderTextureSprite.position.set(3,6),this.renderTextureSprite.tint=0,this.renderTextureSprite.scale.set(this.sampleScale),this.innerContainer.addChildAt(this.renderTextureSprite,0)}this.container.addChild(this.innerContainer),this.container.addChild(this.rope);s[0],this.tile.width,s[1],this.tile.height;this.innerContainer.setRegPointPixels(s[0],s[1],!0),this.container.setRegPointPixels(this.container.width/2,-this.rope.height+this.rope.position.y),this.container.position.set(i[0],i[1]-this.container.height/2)}return t.prototype.addPaperclip=function(){var t=Game.displayStore.getSprite("carousel-menu/paperclip-front");this.container.addChild(t);var e=Game.displayStore.getSprite("carousel-menu/paperclip-back");e.parentGroup=Scene.SORT_GROUP_BACK,this.container.addChild(e),t.position.x=e.position.x=this.rope.position.x,t.position.y=e.position.y=this.rope.position.y-6},t.prototype.addAchievementsPanel=function(){var t=Game.displayStore.getContainer("select-team-scene/achievements-panel"),e=Game.displayStore.getSprite("select-team-scene/achievements-panel-bg"),i=Game.displayStore.getSprite("select-team-scene/paperclip"),n=Game.displayStore.getSprite("select-team-scene/paperclip-back"),o=Game.displayStore.getSprite("select-team-scene/achievements-icon"),r=Game.displayStore.getBitmapText("select-team-scene/achievements-icon-text","");i.position.x=20,n.position.x=16,n.position.y=220,o.position.x=78,o.position.y=38,t.position.x=-12,t.position.y=220,r.tint=16771584,r.scale.set(.3,.3);for(var a=Game.coreData.getAchievements(this.id),s=a.length,l=0,c=0;c<s;c++)0==a[c].locked&&l++;r.text=l+"/"+s,r.position.x=80-r.width/2,r.position.y=16,this.innerContainer.addChildAt(n,0),t.addChild(e),t.addChild(o),t.addChild(r),t.addChild(i),this.achievementsPanel=t,this.achievementsPanel.setRegPointPixels(30,6,!0),this.innerContainer.addChild(t)},t.prototype.moveRight=function(){var t=Game.getRandom(.2,.4);this.animation=this.scene.killTween(this.animation),this.animation=new TimelineMax,this.animation.add(TweenMax.to(this.innerContainer,.2,{ease:Power1.easeIn,rotation:t}),.2),this.animation.add(TweenMax.to(this.innerContainer,1.6,{ease:Elastic.easeOut,rotation:0}),.4),this.animation.add(TweenMax.to(this.container,.3,{ease:Power1.easeInOut,rotation:.8*t}),0),this.animation.add(TweenMax.to(this.container,1.4,{ease:Elastic.easeOut,rotation:0}),.3),this.achievementsPanel&&(this.animation.add(TweenMax.to(this.achievementsPanel,.2,{ease:Power1.easeInOut,rotation:.5*t}),0),this.animation.add(TweenMax.to(this.achievementsPanel,.6,{ease:Back.easeOut,rotation:0}),.25))},t.prototype.moveLeft=function(){var t=Game.getRandom(-.2,-.4);this.animation=this.scene.killTween(this.animation),this.animation=new TimelineMax,this.animation.add(TweenMax.to(this.innerContainer,.2,{ease:Power1.easeIn,rotation:t}),.2),this.animation.add(TweenMax.to(this.innerContainer,1.6,{ease:Elastic.easeOut,rotation:0}),.4),this.animation.add(TweenMax.to(this.container,.3,{ease:Power1.easeInOut,rotation:.8*t}),0),this.animation.add(TweenMax.to(this.container,1.4,{ease:Elastic.easeOut,rotation:0}),.3),this.achievementsPanel&&(this.animation.add(TweenMax.to(this.achievementsPanel,.2,{ease:Power1.easeInOut,rotation:.5*t}),0),this.animation.add(TweenMax.to(this.achievementsPanel,.6,{ease:Back.easeOut,rotation:0}),.25))},t.prototype.select=function(){this.animation=this.scene.killTween(this.animation),this.animation=new TimelineMax,this.animation.add(TweenMax.to(this.container.position,.2,{ease:Power2.easeOut,y:"+=40"})),this.animation.add(TweenMax.to(this.container.position,1,{ease:Elastic.easeOut,y:150-this.container.height/2})),Game.playSound("boing-"+Game.getRandom(1,3,!0)+".mp3")},t.prototype.destroy=function(){this.animation=this.scene.killTween(this.animation),this.innerContainer.removeAllChildren(),this.container.removeAllChildren(),Game.displayStore.returnAllPooledItems("global")},t}(),AchievementPopup=function(){function t(t,e){this.scene=t.currentScene,this.queue=[],this.showTime=2,this.particles=e,this.container=Game.displayStore.getContainer("global/unlocked-achievement-bg"),this.bg=this.container.getSprite("achievements-scene/panel-bg"),this.iconContainer=this.container.getContainer("global/unlocked-achievement-icon-holder"),this.lockIcon=Game.displayStore.getContainer("global/lock-icon-container"),this.lockIcon.position.set(45,45),this.lockIcon.showOnlyChild(0),this.showing=!1,this.titleText=Game.displayStore.getBitmapText("global/unlocked-achievement-title",""),this.descriptionText=Game.displayStore.getBitmapText("global/unlocked-achievement-body",""),this.titleText.tint=16771584,this.titleText.position.x=105,this.titleText.position.y=0,this.descriptionText.position.x=105,this.descriptionText.position.y=35,this.trophy=Game.displayStore.getContainer("global/achievements-icon"),this.trophy.position.set(74,72),this.trophy.getSprite("global/achievements-icon-inner").scale.set(.5,.5),this.trophyShadow=this.trophy.getSprite("global/achievements-icon-shadow"),this.trophyShadow.scale.set(.5,.5),this.trophyShadow.tint=0,this.trophyShadow.alpha=.3,this.container.setRegPoint(.5,.5,!0),this.container.position.set(Game.stageWidth/2,Game.stageHeight-100),this.container.addChild(this.iconContainer),this.container.addChild(this.titleText),this.container.addChild(this.descriptionText),this.container.addChild(this.trophy),this.container.interactive=!1,this.container.interactiveChildren=!1,this.container.alpha=0,this.container.position.y=Game.stageHeight,this.container.interactive=!1,this.container.interactiveChildren=!1}return t.prototype.show=function(t){if(1!=this.showing){var e=Game.coreData.getCurrentTeam();void 0==e&&(e="scooby"),this.showing=!0,this.lockIcon.alpha=1,this.lockIcon.showOnlyChild(0),this.lockIcon.scale.set(0,0),this.iconContainer.removeAllChildren(),this.iconContainer.addChild(this.lockIcon),this.icon=Game.displayStore.getSprite("stickers-scene/"+e+"/tile-"+t.stickerID),this.iconContainer.addChildAt(this.icon,0),this.icon.setRegPoint(.5,.5),this.icon.position.set(45,40),this.icon.tint=0,this.trophy.alpha=0,this.trophy.scale.set(3,3),this.container.alpha=0,this.container.position.y=Game.stageHeight+30,this.container.addChildAt(this.particles.container,1),this.particles.container.position.set(45,45),this.showTimeline=this.scene.killTween(this.showTimeline),this.showTimeline=new TimelineMax,Game.playSound("swipe-1.mp3",.8),this.showTimeline.add([TweenMax.to(this.container.position,.2,{y:Game.stageHeight-40,ease:Power1.easeIn}),TweenMax.to(this.container,.2,{alpha:1,ease:Power1.easeOut})]),this.showTimeline.add(TweenMax.to(this.container.position,.5,{y:Game.stageHeight-80,ease:Elastic.easeOut})),this.showTimeline.call(function(){this.lockIcon.showOnlyChild(1),this.lockIcon.scale.set(2,2),Game.playSound("unlock.mp3")},null,this),this.showTimeline.add(TweenMax.to(this.lockIcon.scale,.5,{x:1,y:1,ease:Elastic.easeOut})),this.showTimeline.add([TweenMax.to(this.lockIcon,.3,{alpha:0,ease:Power2.easeInOut}),TweenMax.to(this.lockIcon.scale,.3,{x:3,y:3,ease:Power2.easeIn}),"-=0.3"]),this.showTimeline.call(function(){Game.playSound("achievement.mp3"),this.particles.fire(),this.icon.tint=16777215},null,this),this.showTimeline.add([TweenMax.to(this.trophy.scale,.5,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.trophy,.3,{alpha:1,ease:Power3.easeOut})]),this.showTimeline.add([TweenMax.to(this.container.position,.4,{y:Game.stageHeight+30,ease:Power3.easeInOut}),TweenMax.to(this.container,.4,{alpha:0,ease:Power3.easeOut})],"+="+String(this.showTime)),this.showTimeline.call(Game.playSound,["swipe-3.mp3",.6],this,"-=0.2"),this.showTimeline.call(function(){if(this.showing=!1,this.queue.length>0){var t=this.queue.pop();this.show(t)}},null,this);var i="achievement-"+e+"-title-"+t.id,n="achievement-"+e+"-description-"+t.id;Game.stringsManager.setTextString(this.titleText,i),Game.stringsManager.setTextString(this.descriptionText,n),this.descriptionText.maxWidth=1300,this.titleText.scale.set(.4,.4),this.descriptionText.scale.set(.2,.2)}else this.queue.push(t)},t.prototype.destroy=function(){this.container.removeAllChildren(),this.iconContainer.removeAllChildren()},t}(),AchievementsTallyPanel=function(){function t(t){this.scene=t,this.container=Game.displayStore.getContainer("global/achievements-panel-container"),this.character=this.container.getContainer("global/achievements-character-container"),this.icon=this.container.getSprite("global/achievements-panel-icon"),this.shadow=this.container.getSprite("global/achievements-panel-icon-shadow"),this.textField=Game.displayStore.getBitmapText("global/achievements-panel-text",""),this.shadow.alpha=.3,this.shadow.tint=0,this.container.addChild(this.textField),this.textField.position.x=60,this.textField.position.y=-86,this.textField.scale.set(.3,.3),this.textField.tint=16771584,this.textField.text="10/15",this.container.position.set(130,Game.stageHeight+this.container.height),this.openTimeline=new TimelineMax,this.openTimeline.add(TweenMax.to(this.container.position,.2,{y:Game.stageHeight+30,ease:Power1.easeIn}),.7),this.openTimeline.add(TweenMax.to(this.container.position,.5,{y:Game.stageHeight+10,ease:Elastic.easeOut}),.9),this.openTimeline.pause()}return t.prototype.show=function(t){TweenMax.delayedCall(.5,Game.playSound,["swipe-1.mp3",.5],this);var e=Game.coreData.getCurrentTeam();switch(void 0==e&&(e="scooby"),e){case"tom":this.character.showOnlyChild(0);break;case"scooby":this.character.showOnlyChild(1);break;case"bugs":TweenMax.delayedCall(.7,Game.playSound,["bugs-carrot.mp3"],this),this.character.showOnlyChild(2);break;case"tweety":this.character.showOnlyChild(3);break;case"wile":TweenMax.delayedCall(.7,Game.playSound,["road-runner-beep-beep.mp3"],this),this.character.showOnlyChild(4)}var i=Game.coreData.getAchievements(e).length,n=Game.coreData.getPlayerAchievements(e).length;this.textField.text=String(n)+"/"+String(i),this.textField.position.x=81-this.textField.width/2,1==t?this.container.position.y=Game.stageHeight+10:this.openTimeline.restart()},t.prototype.destroy=function(){this.openTimeline&&this.openTimeline.kill()},t}(),AchievementPanel=function(){function t(t,e){this.scene=t;var i=Game.coreData.getCurrentTeam();void 0==i&&(i="scooby"),this.container=Game.displayStore.getContainer("achievements-scene/panel"),this.bg=Game.displayStore.getSprite("achievements-scene/panel-bg"),this.container.interactive=!1,this.container.interactiveChildren=!1,this.iconContainer=Game.displayStore.getContainer("achievements-scene/icon-container"),this.iconBG=Game.displayStore.getSprite("achievements-scene/icon-bg"),this.iconContainer.setRegPoint(.5,.5),this.iconContainer.addChild(this.iconBG),this.iconDark=Game.displayStore.getSprite("achievements-scene/icon-dark"),this.iconDark.alpha=.6,this.iconContainer.position.set(65,63),this.icon=Game.displayStore.getSprite("stickers-scene/"+i+"/tile-"+e.stickerID),this.iconContainer.addChild(this.icon),this.iconContainer.addChild(this.iconDark),this.icon.setRegPoint(.5,.5),this.icon.scale.set(1.1,1.1),this.lockIcon=Game.displayStore.getContainer("achievements-scene/lock-icon-container"),this.lockIcon.addChild(Game.displayStore.getSprite("achievements-scene/lock-icon")),this.lockIcon.addChild(Game.displayStore.getSprite("achievements-scene/lock-icon-unlocked")),this.lockIcon.showOnlyChild(0),this.iconContainer.addChild(this.lockIcon);var n="achievement-"+i+"-title-"+e.id,o="achievement-"+i+"-description-"+e.id;this.titleText=Game.displayStore.getBitmapText("achievements-scene/achievement-title-text",n),this.descriptionText=Game.displayStore.getBitmapText("achievements-scene/achievement-description-text",o),this.titleText.maxWidth=730,this.descriptionText.maxWidth=1450,this.titleText.tint=16771584,this.titleText.scale.set(.5,.5),this.descriptionText.scale.set(.25,.25),this.titleText.position.x=140,this.titleText.position.y=10,this.descriptionText.position.x=140,this.descriptionText.position.y=55,this.trophy=Game.displayStore.getSprite("achievements-scene/achievements-icon"),this.trophy.alpha=0,this.trophy.scale.set(0,0),this.trophy.position.set(115,105),0==e.locked&&(this.trophy.alpha=1,this.trophy.scale.set(.5,.5),this.lockIcon.visible=!1,this.iconDark.visible=!1),this.container.addChild(this.bg),this.container.setRegPoint(.5,.5,!0),this.container.addChild(this.iconContainer),this.container.addChild(this.titleText),this.container.addChild(this.descriptionText),this.container.addChild(this.trophy)}return t.prototype.destroy=function(){this.container.removeAllChildren(),this.iconContainer.removeAllChildren(),Game.displayStore.returnPooledItem(this.bg),Game.displayStore.returnPooledItem(this.icon),Game.displayStore.returnPooledItem(this.iconContainer),Game.displayStore.returnPooledItem(this.titleText),Game.displayStore.returnPooledItem(this.descriptionText),Game.displayStore.returnPooledItem(this.trophy),Game.displayStore.returnPooledItem(this.container),Game.displayStore.returnPooledItem(this.iconBG),Game.displayStore.returnPooledItem(this.iconDark),Game.displayStore.returnPooledItem(this.lockIcon)},t}(),UI=function(){function t(t){this.tweens=new Array,this.uiInitialised=!1,this.currentKeyCycledButton=0,this.keyboardUIFocus=!1,this.game=t,this.buttons=new Array,this.spinnerOn=!1,this.enjoyIntroOn=!1,this.powerUpIntroOn=!1,this.pauseButtonSpacing=190,this.pauseVerticalSpacing=200}return t.prototype.initUI=function(){this.uiContainer=Game.displayStore.getContainer("ui-main-container"),this.uiContainer.interactive=!0,this.spacebarHint=Game.displayStore.getAnimatedSprite("spacebar-hint-frames"),this.spacebarHint.animationSpeed=.05,this.spacebarHint.scale.set(.8,.8),this.spacebarHint.stop(),this.pauseButton=Game.displayStore.getButton("pause-button"),this.pauseButton.position.x=948,this.pauseButton.position.y=68,this.pauseButton.setAsUIButton(),this.achievementsButton=Game.displayStore.getButton("achievements-button"),this.achievementsButton.position.x=304,this.achievementsButton.position.y=510,this.achievementsButton.setAsUIButton(),this.closeButton=Game.displayStore.getButton("close-button"),this.closeButton.position.x=948,this.closeButton.position.y=68,this.closeButton.setAsUIButton(),this.closeButtonRed=Game.displayStore.getButton("close-button-red"),this.closeButtonRed.position.x=948,this.closeButtonRed.position.y=68,this.closeButtonRed.setAsUIButton(),this.soundOnButton=Game.displayStore.getButton("soundonbutton"),this.soundOnButton.position.x=587,this.soundOnButton.position.y=308,this.soundOnButton.setAsUIButton(),this.soundOffButton=Game.displayStore.getButton("soundoffbutton"),this.soundOffButton.position.x=587,this.soundOffButton.position.y=308,this.soundOffButton.setAsUIButton(),this.homeButton=Game.displayStore.getButton("home-button"),this.homeButton.position.x=420,this.homeButton.position.y=308,this.homeButton.setAsUIButton(),this.helpButton=Game.displayStore.getButton("help-button"),this.helpButton.position.x=72,this.helpButton.position.y=68,this.helpButton.setAsUIButton(),this.backButton=Game.displayStore.getButton("back-button"),this.backButton.position.x=85,this.backButton.position.y=85,this.backButton.setAsUIButton(),this.tickButton=Game.displayStore.getButton("tick-button"),this.tickButton.position.x=940,this.tickButton.position.y=515,this.tickButton.setAsUIButton(),this.tickButtonGreen=Game.displayStore.getButton("tick-button-green"),this.tickButtonGreen.position.x=940,this.tickButtonGreen.position.y=515,this.tickButtonGreen.setAsUIButton(),this.playButton=Game.displayStore.getButton("play-button"),this.playButton.position.x=952,this.playButton.position.y=530,this.playButton.setAsUIButton(),this.nextRaceButton=Game.displayStore.getButton("next-race-button"),this.nextRaceButton.position.x=688,this.nextRaceButton.position.y=510,this.nextRaceButton.setAsUITextButton("next-race-button-text","button-next-race"),this.garageButton=Game.displayStore.getButton("garage-button"),this.garageButton.position.x=465,this.garageButton.position.y=510,this.garageButton.setAsUITextButton("garage-button-text","button-garage"),this.selectButton=Game.displayStore.getButton("select-button"),this.selectButton.position.x=512,this.selectButton.position.y=510,this.selectButton.setAsUITextButton("select-button-text","button-select"),this.editButton=Game.displayStore.getButton("edit-button"),this.editButton.position.x=350,this.editButton.position.y=500,this.editButton.setAsUITextButton("edit-button-text","button-edit"),this.raceButton=Game.displayStore.getButton("race-button"),this.raceButton.position.x=650,this.raceButton.position.y=500,this.raceButton.setAsUITextButton("race-button-text","button-race"),this.craftButton=Game.displayStore.getButton("craft-button"),this.craftButton.position.x=512,this.craftButton.position.y=510,this.craftButton.setAsUITextButton("craft-button-text","button-craft"),this.skipButton=Game.displayStore.getButton("skip-button"),this.skipButton.position.x=952,this.skipButton.position.y=530,this.skipButton.setAsUIButton(),this.powerupButton=Game.displayStore.getButton("powerup-button"),this.powerupButton.position.x=90,this.powerupButton.position.y=510,this.powerupButton.setAsUIButton(),this.undoButton=Game.displayStore.getButton("undo-button"),this.undoButton.position.x=790,this.undoButton.position.y=150,this.undoButton.setAsUIButton(),this.deleteButton=Game.displayStore.getButton("delete-button"),this.deleteButton.position.x=790,this.deleteButton.position.y=150,this.deleteButton.setAsUIButton(),this.menuButtonLeft=Game.displayStore.getButton("menu-button-left"),this.menuButtonLeft.position.x=85,this.menuButtonLeft.position.y=300,this.menuButtonLeft.setAsUIButton(),this.menuButtonRight=Game.displayStore.getButton("menu-button-right"),this.menuButtonRight.position.x=930,this.menuButtonRight.position.y=300,this.menuButtonRight.setAsUIButton(),this.panelButtonUp=Game.displayStore.getButton("panel-button-up"),this.panelButtonUp.position.x=855,this.panelButtonUp.position.y=100,this.panelButtonUp.setAsUIButton(),this.panelButtonDown=Game.displayStore.getButton("panel-button-down"),this.panelButtonDown.position.x=855,this.panelButtonDown.position.y=440,this.panelButtonDown.setAsUIButton(),this.promptPanel=Game.displayStore.getContainer("global/prompt"),this.promptPanelBG=this.promptPanel.getContainer("global/prompt-panel-bg"),this.promptPanel.position.set(Game.stageWidth/2,Game.stageHeight/2),this.promptPanel.scale.set(0,0),this.promptPanel.alpha=0,this.particlesContainer=Game.displayStore.getContainer("global/particles-container");var t={lowerAngle:0,upperAngle:360,lowerVelocity:200,upperVelocity:1300,lowerStartScale:2,upperStartScale:6,lowerEndScale:0,upperEndScale:0,friction:.15,XstartRange:20,YstartRange:20,time:1,gravity:500,stagger:0,cap:50,endAlpha:0,rotationPower:3,blendMode:PIXI.BLEND_MODES.ADD};this.particles=new ParticleBurst(["global/pixel.png"],this.particlesContainer,this.game,t),this.achievementPopup=new AchievementPopup(this.game,this.particles),this.uiContainer.addChild(this.achievementPopup.container),this.swapArrows=Game.displayStore.getSprite("global/swap-arrows.png"),this.swapArrows.visible=!1,this.promptText=Game.displayStore.getBitmapText("global/prompt-text",""),this.promptText.position.set(-this.promptText.width/2,32),this.promptText.tint=16771584,this.promptPanel.addChild(this.promptText),this.blackSquare=Game.displayStore.getSprite("global/black-square.png"),this.blackSquare.width=Game.stageWidth,this.blackSquare.height=Game.stageHeight,this.blackSquare.visible=!1,this.blackSquare.alpha=.5,this.coinIcon=Game.displayStore.getSprite("global/prompt-coins-icon"),this.coinIcon.visible=!1,this.coinIcon.position.set(60,30),this.promptPanel.addChild(this.coinIcon),this.coinsText=Game.displayStore.getBitmapText("global/prompt-coins-text",""),this.coinsText.visible=!1,this.coinsText.position.x=95,this.coinsText.position.y=0,this.coinsText.scale.set(.6,.6),this.promptPanel.addChild(this.coinsText);var e=this,i=window;i.addEventListener("keydown",function(t){e.onKeyDown(t)},!0),i.addEventListener("keyup",function(t){e.onKeyUp(t)},!0),this.uiInitialised=!0},t.prototype.showSpaceBarHint=function(){this.spacebarHint.visible=!0,this.spacebarHint.setRegPoint(.5,.5),this.spacebarHint.position.x=Game.stageWidth/2,this.spacebarHint.position.y=485,this.spacebarHint.play(),this.uiContainer.addChild(this.spacebarHint)},t.prototype.hideSpaceBarHint=function(){this.spacebarHint.visible=!1,this.spacebarHint.stop()},t.prototype.showAchievementPopup=function(t){this.uiContainer.addChild(this.achievementPopup.container),this.achievementPopup.show(t)},t.prototype.showPrompt=function(t,e,i){if(this.uiContainer.addChild(this.blackSquare),this.uiContainer.addChild(this.promptPanel),this.blackSquare.visible=!0,this.promptText.visible=!0,this.promptPanelBG.visible=!0,Game.stringsManager.setTextString(this.promptText,t),this.promptText.position.set(-this.promptText.width/2,-50),this.showPromptTimeline=this.game.currentScene.killTween(this.showPromptTimeline),this.showPromptTimeline=new TimelineMax,this.showPromptTimeline.add([TweenMax.to(this.promptPanel.scale,.2,{x:.8,y:.8,ease:Power2.easeIn}),TweenMax.to(this.promptPanel,.5,{alpha:1,ease:Power3.easeOut}),TweenMax.to(this.blackSquare,.1,{alpha:.7,ease:Power3.easeOut})]),this.showPromptTimeline.add(TweenMax.to(this.promptPanel.scale,.5,{x:1,y:1,ease:Elastic.easeOut}),.2),Game.playSound("swipe-1.mp3"),this.swapArrows.visible=!1,this.coinIcon.visible=!1,this.coinsText.visible=!1,"close-only"==e)this.addUIButton(this.closeButtonRed,!0,!0),this.closeButtonRed.position.set(750,210),this.promptPanelBG.showOnlyChild(0);else if("buy"==e){this.addUIButton(this.closeButtonRed,!0,!0),this.addUIButton(this.tickButtonGreen,!0,!0),this.closeButtonRed.position.set(380,430),this.tickButtonGreen.position.set(650,430),this.promptPanelBG.showOnlyChild(1),this.swapArrows.visible=!0,this.coinIcon.visible=!0,this.coinIcon.position.set(60,30),this.coinIcon.alpha=1,this.coinsText.visible=!0,this.coinsText.alpha=1,this.coinsText.text=String(i.price),this.buySprite=Game.displayStore.getSprite(i.draggableSpriteString),this.buySprite.setRegPoint(.5,.5),this.buySprite.position.set(-70,30),this.buySprite.tint=0;var n=this.buySprite.width/this.buySprite.height;this.buySprite.height=80,this.buySprite.width=this.buySprite.height*n,this.promptPanel.addChild(this.buySprite),this.promptPanel.addChild(this.coinIcon),this.promptText.position.y=-105}else if("achievement"==e){this.addUIButton(this.closeButtonRed,!0,!0),this.closeButtonRed.position.set(727,180),this.promptPanelBG.visible=!1,this.promptText.visible=!1;var o=Game.coreData.getAchievementWithStickerID(i.id);this.achievementPanel=new AchievementPanel(this.game.currentScene,{id:o,locked:!0,stickerID:i.id}),this.achievementPanel.container.position.set(0,0),this.promptPanel.addChild(this.achievementPanel.container)}else this.addUIButton(this.closeButtonRed,!0,!0),this.addUIButton(this.tickButtonGreen,!0,!0),this.closeButtonRed.position.set(380,400),this.tickButtonGreen.position.set(650,400),this.promptPanelBG.showOnlyChild(0)},t.prototype.hidePromptButtons=function(){this.removeButton(this.closeButtonRed),this.removeButton(this.tickButtonGreen)},t.prototype.hidePrompt=function(t,e){if(this.hidePromptTimeline=this.game.currentScene.killTween(this.hidePromptTimeline),this.hidePromptTimeline=new TimelineMax,"buy"==t){this.hidePromptTimeline.add([TweenMax.to(this.buySprite.position,.5,{x:0,ease:Expo.easeInOut}),TweenMax.to(this.coinIcon.position,.5,{x:0,ease:Expo.easeInOut}),TweenMax.to(this.coinIcon,.5,{alpha:0,ease:Expo.easeIn}),TweenMax.to(this.coinsText,.2,{alpha:0,ease:Expo.easeOut})],.3);var i=this.buySprite.width/this.buySprite.height;this.hidePromptTimeline.add(TweenMax.to(this.buySprite,.5,{width:60*i,height:60,ease:Power3.easeInOut})),this.hidePromptTimeline.add(TweenMax.to(this.buySprite,.1,{width:150*i,height:150,ease:Power3.easeIn})),this.hidePromptTimeline.call(function(){this.buySprite.tint=16777215,e.unlock(),this.promptPanel.addChildAt(this.particlesContainer,2),this.particlesContainer.position.set(0,20),this.particles.fire(),Game.playSound("find-item.mp3")},null,this),this.hidePromptTimeline.call(Game.playSound,["bolt-cut.mp3"],this,.5),this.hidePromptTimeline.add(TweenMax.to(this.buySprite,1,{width:100*i,height:100,ease:Elastic.easeOut})),this.hidePromptTimeline.call(Game.playSound,["spend-coins.mp3"],this,.1),this.hidePromptTimeline.call(Game.playSound,["swipe-3.mp3"],this,.3),this.hidePromptTimeline.call(Game.stopSound,["spend-coins.mp3"],this,.6)}"achievement"==t&&(this.promptPanel.removeChild(this.achievementPanel.container),this.achievementPanel.destroy()),this.hidePromptTimeline.call(function(){Game.playSound("swipe-3.mp3"),this.game.currentScene.hidePrompt&&this.game.currentScene.hidePrompt()},null,this),this.hidePromptTimeline.add([TweenMax.to(this.promptPanel.scale,.3,{x:0,y:0,ease:Power3.easeOut}),TweenMax.to(this.promptPanel,.2,{alpha:0,ease:Power3.easeOut}),TweenMax.to(this.blackSquare,.2,{alpha:0,ease:Power3.easeOut})]),this.hidePromptTimeline.call(function(){this.blackSquare.visible=!1,this.game.currentScene.promptIsHidden&&this.game.currentScene.promptIsHidden()},null,this),this.removeButton(this.closeButtonRed),this.removeButton(this.tickButtonGreen),this.buySprite&&this.hidePromptTimeline.call(function(){this.promptPanel.removeChild(this.buySprite),Game.displayStore.returnPooledItem(this.buySprite)},null,this)},t.prototype.getButton=function(t){for(var e,i=0;i<this.buttons.length;i++)this.buttons[i].id==t&&(e=this.buttons[i]);return e},t.prototype.setUI=function(t){if(0!=this.uiInitialised){switch(this.mode=t,this.removeAllButtons(),this.spacebarHint.visible=!1,this.currentKeyCycledButton=0,this.deselectDelay&&this.deselectDelay.kill(),t){case"title":window.og&&window.og.isFullScreen;break;case"main-intro":this.addSoundButtons(!1),this.addUIButton(this.skipButton,!1,!0);break;case"game-over":this.addSoundButtons(!0),this.addUIButton(this.homeButton,!0,!0);break;case"race":this.addUIButton(this.pauseButton,!0,!0),this.addUIButton(this.powerupButton,!1,!1);break;case"race-paused":this.addUIButton(this.closeButton,!0,!0),this.addUIButton(this.homeButton,!0,!0),this.addSoundButtons(!0);break;case"race-complete":this.addUIButton(this.achievementsButton,!0,!0),this.addUIButton(this.garageButton,!0,!0),this.addUIButton(this.nextRaceButton,!0,!0);break;case"race-complete-instant":this.addUIButton(this.achievementsButton,!1,!1),this.addUIButton(this.garageButton,!1,!1),this.addUIButton(this.nextRaceButton,!1,!1);break;case"achievements":this.addUIButton(this.backButton,!0,!0);break;case"garage":this.addUIButton(this.menuButtonLeft,!0,!0),this.addUIButton(this.menuButtonRight,!0,!0),this.addUIButton(this.backButton,!0,!0),this.addUIButton(this.raceButton,!0,!0),this.addUIButton(this.editButton,!0,!0),this.addUIButton(this.deleteButton,!0,!0),this.deleteButton.position.x=290,this.deleteButton.position.y=120;break;case"select-team":this.addUIButton(this.menuButtonLeft,!0,!0),this.addUIButton(this.menuButtonRight,!0,!0),this.addUIButton(this.selectButton,!0,!0);break;case"select-car":this.addUIButton(this.menuButtonLeft,!0,!0),this.addUIButton(this.menuButtonRight,!0,!0),this.addUIButton(this.backButton,!0,!0),this.addUIButton(this.selectButton,!0,!0);break;case"select-track":this.addUIButton(this.menuButtonLeft,!0,!0),this.addUIButton(this.menuButtonRight,!0,!0),this.addUIButton(this.backButton,!0,!0);break;case"paint":this.addUIButton(this.backButton,!0,!0),this.addUIButton(this.tickButton,!0,!0),this.addUIButton(this.undoButton,!0,!0),this.undoButton.position.x=830,this.undoButton.position.y=90;break;case"stickers":this.addUIButton(this.backButton,!0,!0),this.addUIButton(this.tickButton,!0,!0),this.addUIButton(this.undoButton,!0,!0),this.addUIButton(this.deleteButton,!0,!0),this.undoButton.position.x=650,this.undoButton.position.y=160,this.deleteButton.position.x=550,this.deleteButton.position.y=160;break;case"wheels":this.addUIButton(this.backButton,!0,!0),this.addUIButton(this.tickButton,!0,!0);break;case"accessories":this.addUIButton(this.backButton,!0,!0),this.addUIButton(this.tickButton,!0,!0),this.addUIButton(this.undoButton,!0,!0),this.addUIButton(this.deleteButton,!0,!0),this.undoButton.position.x=650,this.undoButton.position.y=160,this.deleteButton.position.x=550,this.deleteButton.position.y=160}this.uiContainer.addChild(this.achievementPopup.container)}},t.prototype.positionPauseMenuButtons=function(){this.homeButton.position.x=Game.stageWidth/2-this.pauseButtonSpacing,this.homeButton.position.y=1.5*this.pauseVerticalSpacing,this.helpButton.position.x=Game.stageWidth/2,this.helpButton.position.y=1.2*this.pauseVerticalSpacing,this.soundOnButton.position.x=Game.stageWidth/2+this.pauseButtonSpacing,this.soundOnButton.position.y=1.5*this.pauseVerticalSpacing,this.soundOffButton.position.x=Game.stageWidth/2+this.pauseButtonSpacing,this.soundOffButton.position.y=1.5*this.pauseVerticalSpacing},t.prototype.addSoundButtons=function(t){1==Game.soundOn?this.addUIButton(this.soundOffButton,t,!0):0==Game.soundOn&&this.addUIButton(this.soundOnButton,t,!0)},t.prototype.disableButton=function(t){for(var e,i=0;i<this.buttons.length;i++)this.buttons[i].id==t&&(e=this.buttons[i],this.rolloutButton(this,e),e.disableButton())},t.prototype.enableButton=function(t){for(var e,i=0;i<this.buttons.length;i++)this.buttons[i].id==t&&1==(e=this.buttons[i]).disabled&&e.enableButton()},t.prototype.endPowerupTimeline=function(t){t.activatePowerupTimeline=t.killTween(t.activatePowerupTimeline),t.powerUpIntroOn=!1},t.prototype.resize=function(t){0!=this.uiInitialised&&(this.uiContainer.scale.x=t,this.uiContainer.scale.y=t)},t.prototype.removeAllButtons=function(){if(this.buttons.length>0)for(var t=this.buttons.length-1;t>=0;t--)this.buttons[t]instanceof UIButton&&this.removeButton(this.buttons[t]);this.buttons=[]},t.prototype.removeButton=function(t){this.clearButton(t),t.parent==this.uiContainer&&this.uiContainer.removeChild(t),void 0!=this.getButtonIndex(t)&&this.buttons.splice(this.getButtonIndex(t),1)},t.prototype.getButtonIndex=function(t){for(var e=0;e<this.buttons.length;e++)if(this.buttons[e]==t)return e},t.prototype.pause=function(){1==this.enjoyIntroOn&&(this.enjoyTheRide.visible=!1,this.game.currentScene.pauseResumeTween(this.enjoyTheRideTimeline,"pause")),1==this.powerUpIntroOn&&(this.powerupActiveIcon.visible=!1,this.game.currentScene.pauseResumeTween(this.activatePowerupTimeline,"pause"))},t.prototype.resume=function(){1==this.enjoyIntroOn&&(this.enjoyTheRide.visible=!0,this.game.currentScene.pauseResumeTween(this.enjoyTheRideTimeline,"resume")),1==this.powerUpIntroOn&&(this.powerupActiveIcon.visible=!0,this.game.currentScene.pauseResumeTween(this.activatePowerupTimeline,"resume"))},t.prototype.endEnjoyTimeline=function(t){t.enjoyIntroOn=!1,t.enjoyTheRideTimeline=t.killTween(t.enjoyTheRideTimeline)},t.prototype.addCustomUIButton=function(t,e,i){t.setAsUIButton(),this.addUIButton(t,e,i)},t.prototype.addUIButton=function(t,e,i){for(var n=0;n<this.buttons.length;n++)if(this.buttons[n]==t)return;this.uiContainer.addChild(t),this.buttons.push(t),t.buttonInit(e,i),this.registerButton(t)},t.prototype.addNonUIButton=function(t){this.buttons.push(t)},t.prototype.setButtonIndex=function(t){this.currentKeyCycledButton=t,this.keyboardUIFocus=!0},t.prototype.registerButton=function(t){var e=this;if(1==window.forceMobile)return t.on("mouseover",function(t){e.rolloverButton(e,this)}),t.on("mouseout",function(t){e.rolloutButton(e,this)}),t.on("mousedown",function(t){e.downonButton(e,this)}),void t.on("mouseup",function(t){e.uponButton(e,this)});Game.onDesktop?(t.on("mouseover",function(t){e.rolloverButton(e,this)}),t.on("mouseout",function(t){e.rolloutButton(e,this)}),t.on("mousedown",function(t){e.downonButton(e,this)}),t.on("mouseup",function(t){1!=this.disabled&&(Game.playSound("button-click-ui.mp3"),e.uponButton(e,this))})):(t.on("touchstart",function(t){e.downonButton(e,this)}),t.on("touchend",function(t){1!=this.disabled&&(Game.playSound("button-click-ui.mp3"),e.uponButton(e,this))}),t.on("touchendoutside",function(t){e.rolloutButton(e,this)}))},t.prototype.disableAll=function(){this.uiContainer.interactiveChildren=!1},t.prototype.enableAll=function(){this.uiContainer.interactiveChildren=!0},t.prototype.clearButton=function(t){t.clearInteractions()},t.prototype.onKeyUp=function(t){if(1!=this.game.currentScene.interactionLocked&&1!=this.game.currentScene.transitioning){var e=this.getKey(t.keyCode,t);this.game.currentScene.keyUp(e)}},t.prototype.onKeyDown=function(t){if(1!=this.game.currentScene.interactionLocked&&1!=this.game.currentScene.transitioning){var e=this.getKey(t.keyCode,t);this.game.currentScene.keyDown(e)}},t.prototype.getKey=function(t,e){var i="none";return 37==t?(e.preventDefault?e.preventDefault():e.returnValue=!1,i="left"):39==t?(e.preventDefault?e.preventDefault():e.returnValue=!1,i="right"):38==t?(e.preventDefault?e.preventDefault():e.returnValue=!1,i="up"):40==t?(e.preventDefault?e.preventDefault():e.returnValue=!1,i="down"):32==t?(e.preventDefault?e.preventDefault():e.returnValue=!1,i="spacebar"):27==t?i="esc":13==t?i="enter":9==t?i="tab":88==t?i="x":68==t&&(i="d"),i},t.prototype.cycleUIButton=function(t){var e=this.buttons[this.currentKeyCycledButton];e instanceof UIButton?this.rolloutButton(this,e):this.game.currentScene.rolloutCustomButtonKeyboard(e),this.keyboardUIFocus=!0,this.deselectDelay&&this.deselectDelay.kill();var i;"left"==t?i=-1:"right"==t&&(i=1),this.currentKeyCycledButton+=i,this.currentKeyCycledButton<0&&(this.currentKeyCycledButton=this.buttons.length-1),this.currentKeyCycledButton>=this.buttons.length&&(this.currentKeyCycledButton=0);var n=this;(e=this.buttons[this.currentKeyCycledButton])instanceof UIButton?(this.rolloverButton(this,e),this.deselectDelay=TweenMax.delayedCall(2,function(){n.keyboardUIFocus=!1,n.rolloutButton(n,e)})):(this.game.currentScene.rolloverCustomButtonKeyboard(e),this.deselectDelay=TweenMax.delayedCall(2,function(){n.keyboardUIFocus=!1,n.game.currentScene.rolloutCustomButtonKeyboard(e)}))},t.prototype.activateCycledUIButton=function(){if(0!=this.keyboardUIFocus){var t=this.buttons[this.currentKeyCycledButton];t instanceof UIButton?this.game.currentScene.uiClicked(t):this.game.currentScene.selectCustomButtonKeyboard(t)}},t.prototype.tick=function(){},t.prototype.rolloverButton=function(t,e){1!=e.disabled&&1!=t.game.currentScene.interactionLocked&&(t.game.currentScene.uiRolledOver(e),e.id,t.pulseTween&&t.pulseTween.kill(),t.overTimeline&&t.overTimeline.kill(),t.overTimeline=new TimelineMax,t.overTimeline.add(TweenMax.to(e.buttonContainer.scale,.2,{x:1.2,y:1.2,ease:Expo.easeOut}),0),t.overTimeline.add(TweenMax.to(e.shadow.scale,.2,{x:1.1,y:1.1,ease:Expo.easeOut}),0),t.overTimeline.add(TweenMax.to(e.shadow,.2,{alpha:.2,ease:Expo.easeOut}),0))},t.prototype.rolloutButton=function(t,e){1!=e.disabled&&1!=t.game.currentScene.interactionLocked&&(t.game.currentScene.uiRolledOut(e),t.outTimeline&&t.outTimeline.kill(),t.outTimeline=new TimelineMax,t.outTimeline.add(TweenMax.to(e.buttonContainer.scale,.2,{x:1,y:1,ease:Expo.easeOut}),0),t.outTimeline.add(TweenMax.to(e.shadow.position,.2,{x:e.shadowOrigX,y:e.shadowOrigY,ease:Expo.easeOut}),0),t.outTimeline.add(TweenMax.to(e.shadow.scale,.2,{x:1,y:1,ease:Expo.easeOut}),0),t.outTimeline.add(TweenMax.to(e.shadow,.2,{alpha:.3,ease:Expo.easeOut}),0))},t.prototype.downonButton=function(t,e){1!=e.disabled&&1!=t.game.currentScene.interactionLocked&&(t.game.currentScene.downOnUI(e),t.pulseTween&&t.pulseTween.kill(),t.downTimeline&&t.downTimeline.kill(),t.downTimeline=new TimelineMax,t.downTimeline.add(TweenMax.to(e.buttonContainer.scale,.2,{x:1.3,y:1.3,ease:Expo.easeOut}),0),t.downTimeline.add(TweenMax.to(e.shadow.scale,.2,{x:1.15,y:1.15,ease:Expo.easeOut}),0))},t.prototype.uponButton=function(t,e){1!=e.disabled&&(t.game.currentScene.upOnUI(e),e.animateEffect,1!=t.game.currentScene.interactionLocked&&(t.upTimeline&&(t.upTimeline.kill(),t.delayedClick.kill()),t.upTimeline=new TimelineMax,t.upTimeline.add(TweenMax.to(e.buttonContainer.scale,.2,{x:1,y:1,ease:Expo.easeOut}),0),t.upTimeline.add(TweenMax.to(e.shadow.scale,.2,{x:1,y:1,ease:Expo.easeOut}),0),t.upTimeline.add(TweenMax.to(e.shadow.position,.2,{x:e.shadowOrigX,y:e.shadowOrigY,ease:Expo.easeOut}),0),t.upTimeline.add(TweenMax.to(e.shadow,.2,{alpha:.3,ease:Expo.easeOut}),0),t.delayedClick=TweenMax.delayedCall(.15,function(){t.game.currentScene.uiClicked(e)})))},t.prototype.pulseButton=function(t){this.pulseTween&&this.pulseTween.kill(),this.pulseTween=new TimelineMax({repeat:-1}),this.pulseTween.add(TweenMax.to(t.buttonContainer.scale,.8,{x:1.2,y:1.2,ease:Quad.easeInOut}),0),this.pulseTween.add(TweenMax.to(t.shadow.scale,.8,{x:1.2,y:1.2,ease:Quad.easeInOut}),0),this.pulseTween.add(TweenMax.to(t.buttonContainer.scale,.8,{x:1,y:1,ease:Quad.easeInOut}),.8),this.pulseTween.add(TweenMax.to(t.shadow.scale,.8,{x:1,y:1,ease:Quad.easeInOut}),.8),this.pulseTween.add(TweenMax.to(t.shadow.position,.8,{x:t.shadowOrigX+5,y:t.shadowOrigY+5,ease:Quad.easeInOut}),0),this.pulseTween.add(TweenMax.to(t.shadow,.8,{alpha:.7,ease:Quad.easeInOut}),0),this.pulseTween.add(TweenMax.to(t.shadow.position,.8,{x:t.shadowOrigX,y:t.shadowOrigY,ease:Quad.easeInOut}),.8),this.pulseTween.add(TweenMax.to(t.shadow,.8,{alpha:.3,ease:Quad.easeInOut}),.8)},t.prototype.playClickEffect=function(t,e){},t.prototype.playUISound=function(t){Game.stopCurrentInterruptableSound(),TweenMax.delayedCall(.2,Game.playSound,[t,!0])},t.prototype.sceneDestroy=function(){1==this.enjoyIntroOn&&(this.enjoyTheRide.visible=!1,this.game.currentScene.killTween(this.enjoyTheRideTimeline)),1==this.powerUpIntroOn&&(this.powerupActiveIcon.visible=!1,this.game.currentScene.killTween(this.activatePowerupTimeline))},t.prototype.showSpinner=function(){this.uiInitialised},t.prototype.hideSpinner=function(){this.uiInitialised},t.prototype.soundToggled=function(){1==Game.soundOn?(Game.soundOn=!1,Game.audioManager.soundOff(),this.removeButton(this.soundOffButton),this.addUIButton(this.soundOnButton,!1,!1)):0==Game.soundOn&&(Game.soundOn=!0,Game.audioManager.soundOn(),this.removeButton(this.soundOnButton),this.addUIButton(this.soundOffButton,!1,!1))},t.prototype.killTween=function(t){return t&&(t.kill(),t=null),t},t.prototype.changeFocusOut=function(){if(0!=this.uiInitialised&&(this.pauseButton.parent&&this.game.currentScene.pause(),1==Game.soundOn)){if(Game.soundOn=!1,Game.audioManager.soundOff(),!this.soundOnButton.parent&&!this.soundOffButton.parent)return;this.removeButton(this.soundOffButton),this.addUIButton(this.soundOnButton,!0,!0)}},t.prototype.exitGame=function(){Game.trace("exit url is..",window.og),window.og&&window.og.exitGameUrl&&window.open(window.og.exitGameUrl,"_self")},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),UIButton=function(t){function e(){var e=t.call(this)||this;return e.disabled=!1,e.animateEffect=!0,e}return __extends(e,t),e.prototype.setAsUIButton=function(t,e){this.buttonContainer=this.getContainer("button-container"),this.ui=t,this.bg=this.buttonContainer.getSprite("bg"),this.bg.setRegPoint(.5,.5),this.buttonContainer.getSprite("icon")&&(this.icon=this.buttonContainer.getSprite("icon"),this.icon.setRegPoint(.5,.5),this.icon.interactive=!0,this.icon.position.set(-1,-1),e&&(this.icon.position.x+=e[0],this.icon.position.y+=e[1])),this.glow=this.buttonContainer.getSprite("glow"),this.glow&&(this.glow.blendMode=PIXI.BLEND_MODES.ADD,this.glow.interactive=!1),this.shadow=this.getSprite("shadow"),this.shadow.tint=0,this.shadow.alpha=.3,this.shadow.setRegPoint(.5,.5),this.shadow.position.x=0,this.shadow.position.y=4,this.shadowOrigX=this.shadow.position.x,this.shadowOrigY=this.shadow.position.y,this.shadow.interactive=!1,this.interactive=!0,this.buttonMode=!0,this.enableAnimation=new TimelineMax,this.enableAnimation.call(function(){this.buttonContainer.scale.set(.8,.8),this.shadow.scale.set(.8,.8)},null,this,0),this.enableAnimation.add([TweenMax.to(this.buttonContainer.scale,.8,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.shadow.scale,.8,{x:1,y:1,ease:Elastic.easeOut,delay:.06})]),this.enableAnimation.pause()},e.prototype.setAsUITextButton=function(t,e){this.buttonContainer=this.getContainer("button-container"),this.bgLeft=this.buttonContainer.getSprite("bg-left"),this.bgCentre=this.buttonContainer.getSprite("bg-centre"),this.bgRight=this.buttonContainer.getSprite("bg-right"),this.shadow=this.getContainer("shadow-container");for(var i=0;i<this.shadow.children.length;i++)this.shadow.getSpriteAt(i).tint=0;this.shadowLeft=this.shadow.getSprite("shadow-left"),this.shadowCentre=this.shadow.getSprite("shadow-centre"),this.shadowRight=this.shadow.getSprite("shadow-right"),this.shadow.alpha=.3,this.shadow.position.x=0,this.shadow.position.y=4,this.shadowOrigX=this.shadow.position.x,this.shadowOrigY=this.shadow.position.y,this.shadow.interactive=!1,this.interactive=!0,this.buttonMode=!0,this.enableAnimation=new TimelineMax,this.enableAnimation.call(function(){this.buttonContainer.scale.set(.8,.8),this.shadow.scale.set(.8,.8)},null,this,0),this.enableAnimation.add([TweenMax.to(this.buttonContainer.scale,.8,{x:1,y:1,ease:Elastic.easeOut}),TweenMax.to(this.shadow.scale,.8,{x:1,y:1,ease:Elastic.easeOut,delay:.06})]),this.enableAnimation.pause(),this.buttonText=Game.displayStore.getBitmapText(t,e),Game.stringsManager.setTextString(this.buttonText,e),this.buttonText.tint=10438811,this.buttonText.setPosition(-this.buttonText.width/2,-this.buttonText.height/2-10),this.buttonContainer.addChild(this.buttonText);this.bgCentre.width=this.shadowCentre.width=this.buttonText.width+20,this.bgLeft.position.x=-this.bgCentre.width/2+1,this.shadowLeft.position.x=-this.bgCentre.width/2,this.bgRight.position.x=this.bgCentre.width/2-1,this.shadowRight.position.x=this.bgCentre.width/2},e.prototype.destroy=function(){this.removeAllListeners(),this.buttonContainer=null,this.icon=null,this.shadow=null,this.particles&&this.particles.destroy()},e.prototype.clearInteractions=function(){this.removeAllListeners(),this.buttonMode=!1,this.disabled=!1,this.particles&&this.particles.destroy()},e.prototype.disableButton=function(t){this.disabled=!0,this.particles&&this.particles.destroy(),this.buttonMode=!1,t||(this.bg&&(this.bg.tint=10066329),this.bgLeft&&(this.bgLeft.tint=10066329,this.bgCentre.tint=10066329,this.bgRight.tint=10066329),this.icon&&(this.icon.tint=10066329))},e.prototype.enableButton=function(){this.bg&&(this.bg.tint=16777215),this.bgLeft&&(this.bgLeft.tint=16777215,this.bgCentre.tint=16777215,this.bgRight.tint=16777215),this.icon&&(this.icon.tint=16777215),this.buttonContainer.alpha=1,this.shadow.alpha=.3,this.disabled=!1,this.alpha=1,this.buttonMode=!0,this.enableAnimation.restart()},e.prototype.hide=function(){this.alpha=0,this.particles&&this.particles.destroy(),this.clearInteractions()},e.prototype.show=function(){this.alpha=1},e.prototype.buttonInit=function(t,e){if(0==e&&(this.animateEffect=!1),1==t){this.bg&&(this.bg.tint=16777215),this.icon&&(this.icon.scale.x=this.icon.scale.y=1,this.icon.tint=16777215),this.bgLeft&&(this.bgLeft.tint=16777215,this.bgCentre.tint=16777215,this.bgRight.tint=16777215),this.shadow.position.x=0,this.shadow.position.y=0,this.shadow.scale.x=this.shadow.scale.y=0,this.shadow.alpha=0,this.buttonContainer.scale.x=0,this.buttonContainer.scale.y=0,this.initialOnAnimation=this.killTween(this.initialOnAnimation),this.initialOnAnimation=new TimelineMax;var i=Game.getRandom(0,.2);this.initialOnAnimation.add(TweenMax.to(this.buttonContainer.scale,1,{x:1,y:1,ease:Elastic.easeOut}),i),this.initialOnAnimation.add([TweenMax.to(this.shadow.position,1,{x:this.shadowOrigX,y:this.shadowOrigY,ease:Elastic.easeOut}),TweenMax.to(this.shadow,1,{alpha:.3,ease:Expo.easeInOut}),TweenMax.to(this.shadow.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.1})],i+.01)}else 0==t&&(this.icon&&(this.icon.scale.x=this.icon.scale.y=1),this.shadow.position.x=this.shadowOrigX,this.shadow.position.y=this.shadowOrigY,this.shadow.scale.x=this.shadow.scale.y=1,this.shadow.alpha=.3,this.buttonContainer.scale.x=1,this.buttonContainer.scale.y=1)},e.prototype.animatePowerUpActive=function(t){this.icon&&(this.icon.scale.x=this.icon.scale.y=1),this.shadow.position.x=0,this.shadow.position.y=0,this.shadow.scale.x=this.shadow.scale.y=1,this.shadow.alpha=0,this.buttonContainer.scale.x=0,this.buttonContainer.scale.y=0,this.powerUpPopAnimation=this.killTween(this.powerUpPopAnimation),this.powerUpPopAnimation=new TimelineMax,0==Game.isLowEndIPad&&0==t&&this.powerUpPopAnimation.call(function(){this.popParticles()},null,this,.1),this.glow.scale.x=this.glow.scale.y=3,this.icon.scale.x=2,this.icon.scale.y=2.5,this.powerUpPopAnimation.add(TweenMax.to(this.buttonContainer.scale,1,{x:1,y:1,ease:Elastic.easeOut}),0),this.powerUpPopAnimation.add(TweenMax.to(this.glow.scale,1.2,{x:1,y:1,ease:Expo.easeOut}),.05),this.powerUpPopAnimation.add(TweenMax.to(this.icon.scale,1,{x:1,y:1,ease:Elastic.easeOut}),.1)},e.prototype.popParticles=function(){this.particles&&this.particles.destroy();var t={lowerAngle:0,upperAngle:360,lowerVelocity:300,upperVelocity:1e3,endScale:0,lowerStartScale:1,upperStartScale:4,friction:.1,XstartRange:20,YstartRange:20,time:1,stagger:300,gravity:1300,cap:50,endAlpha:0,rotationPower:0,blendMode:PIXI.BLEND_MODES.ADD};this.particles=new ParticleBurst(["ui/powerup-particle.png"],this,this.ui.game.currentScene,t),this.particles.fire()},e.prototype.killParticles=function(){this.particles&&this.particles.destroy()},e.prototype.killTween=function(t){return t&&(t.kill(),t=null),t},e}(DisplayObjectContainer),Game=function(){function t(e,i,n,o,r,a,s,l){this.lastOrientationCorrect=!1,this.initLoaded=!1,this.scenes={},this.pixiInitialalised=!1,this.paused=!1,this.initialOrientationStatTaken=!1,this.iOSScrollMode=!1,this.allowScrollOverlay=!1,this.getURLValue=function(t){var e=!1;return window.location.href.indexOf(t)>-1&&(e=!0),e},this.checkContainerLimit=120,this.checkContainerCounter=0,t.basePath=e,t.ieVer=r,t.coreData=new CoreData(this),t.assetChunkManager=new AssetChunkManager(this),t.stringsManager=new StringsManager(this),this.xmlManager=new XMLManager(this),t.holderDiv=document.getElementById(i),this.parentalApprovalImageSubmit=!1,t.useFilters=!1,this.trackingEventsManager=new TrackingEventsManager(this),t.localStorageManager=new LocalStorageManager(this),this.visualAssets=n,this.audioAssets=o,this.scenes=new Array,this.localisationFormat=l,this.initialised=!1,this.useRetinaAssests=a,this.deeplinkConfigURL=s,1==this.useRetinaAssests?(this.pixelRatio=Math.round(window.devicePixelRatio),this.pixelRatio>2&&(this.pixelRatio=2)):this.pixelRatio=1,window.doobStats&&this.startStats(0)}return t.prototype.initialise=function(e,i,n,o,r,a){this.setViewportTag(),this.initialAssets=r,t.assetChunkManager.storeInitialAssets(this.initialAssets),t.onDesktop=this.isDesktop(),t.isLowEndIPad=a||this.isLowEndIPad(),this.frameCounter=0,this.frameCounterLimit=1,1==t.isLowEndIPad&&(this.frameCounterLimit=2),this.mobileDetect=new MobileDetect(window.navigator.userAgent),0==t.onDesktop&&(this.addMobileCSS(),"iPhone"==this.mobileDetect.phone()&&"iOS"==this.mobileDetect.os()&&(t.oniPhone=!0),"AndroidOS"==this.mobileDetect.os()&&(t.onAndroid=!0)),this.webAudio=this.isWebAudio(),t.displayStore=new DisplayStore(this),t.gameWidth=e,t.gameHeight=i,t.fps=o,t.bodyElement=document.getElementsByTagName("body")[0],this.rotateOverlay=document.getElementById("rotate-overlay"),this.scrollOverlay=document.getElementById("scroll-overlay"),this.scrollOverlay.style.position="absolute",this.scrollOverlay.style.left="0px",this.parentalApprovalDiv=document.getElementById("parental-approval-page"),this.uploadFaceDiv=document.getElementById("upload-face-page"),this.gameHolderDivList=new Array,this.gameHolderDivList.push(t.holderDiv),this.targetOrientation=n,this.loadModule=new LoadModule(this),this.touchEnabled=!1,t.audioManager=new AudioManagerMk2(this,t.onDesktop,this.webAudio),this.ui=new UI(this);var s=this.mobileDetect.mobile(),l=this.mobileDetect.os();null==s&&(s="desktop"),null==l&&(l="desktop");var c=new PIXI.loaders.Loader,h=this;c.add("config.xml"),"xml"==this.localisationFormat?(c.add("localization.xml"),c.once("complete",function(t){h.xmlManager.parseXML(t.resources["config.xml"].data,"config"),h.xmlManager.parseXML(t.resources["localization.xml"].data,"localization"),h.allXMLLoaded(h)})):"json"==this.localisationFormat&&(c.add("localization.json"),c.once("complete",function(t){h.xmlManager.parseXML(t.resources["config.xml"].data,"config"),h.xmlManager.parseJSON(t.resources["localization.json"].data,"localization"),h.allXMLLoaded(h)})),c.load(),this.stopScrollWheelOnGame()},t.prototype.allXMLLoaded=function(t){t.checkOrientation(!1,t)},t.prototype.addRenderer=function(t){0==t.pixiInitialalised&&(t.pixiInitialalised=!0,t.addPixiRenderer())},t.prototype.setLanguageCode=function(e){t.loc=e},t.prototype.getCurrentLanguageCode=function(){return t.loc},t.prototype.setAlphabet=function(e){t.alphabet=e},t.prototype.init=function(e){e.initPIXI(),e.startGameLoop(e),e.addRenderer(e),e.loadAssets(t.assetChunkManager.generateLoadChunk(e.initialGameAreaToLoad),!0,function(){e.ui.initUI(),e.setRotateOverlayBG(),e.setScrollMode(),e.setScene(t.assetChunkManager.getTargetScene(),!1),e.initLoaded=!0})},t.prototype.adjustInputCSS=function(t,e){var i=e/10,n=(String(i),t),o=(String(n),t/10*8),r=(String(o),t/10*1),i=(String(r),e/10),a=(String(i),e/4);String(a);if(i>80)String(80),String(40);if(t<1500)String(39);if(e>t)i=10,String(i)},t.prototype.getPixelRatio=function(){return this.pixelRatio},t.prototype.setScrollMode=function(){if(0==t.onDesktop&&1==t.oniPhone&&1==this.allowScrollOverlay){var e=t.displayStore.getSprite("scroll-bg");this.scrollOverlay.style.backgroundImage="url('"+e.textureURL+"')",document.addEventListener("touchstart",function(t){},{passive:!1});i=this;document.addEventListener("touchmove",function(t){0==i.iOSScrollMode&&t.preventDefault&&t.preventDefault()},{passive:!1})}if(0==t.onDesktop&&0==this.allowScrollOverlay){var i=this;document.addEventListener("touchmove",function(t){t.preventDefault()},{passive:!1})}},t.prototype.swapDOMElements=function(t,e){var i=e.parentNode,n=e.nextSibling;n===t?i.insertBefore(t,e):(t.parentNode.insertBefore(e,t),n?i.insertBefore(t,n):i.appendChild(t))},t.prototype.addMobileCSS=function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t.basePath+"styles/mobile.css"),document.getElementsByTagName("head")[0].appendChild(e)},t.prototype.setRotateOverlayBG=function(){var e=t.displayStore.getSprite("wrong-orientation-bg");this.rotateOverlay.style.backgroundImage="url('"+e.textureURL+"')"},t.prototype.checkOrientation=function(e,i){var n=i;n.initialised=e;var o=n.detectBrowserViewport().w,r=n.detectBrowserViewport().h;if(t.onDesktop)0==n.initialised?(n.gameInit(),n.initialised=!0):n.checkResize(o,r);else{o<r?n.currentOrientation="portrait":r<o&&o>400&&(n.currentOrientation="landscape"),0==n.initialOrientationStatTaken&&(n.initialOrientationStatTaken=!0);var a;n.currentOrientation!=n.targetOrientation?a=!1:n.currentOrientation==n.targetOrientation&&(a=!0),"any"==n.targetOrientation&&(a=!0),0==n.initialised&&0==a?n.applyRotateOverlay(!0,o,r):0==n.initialised&&1==a?(n.gameInit(),n.initialised=!0):1==n.initialised&&0==a?n.orientGame(o,r):1==n.initialised&&1==a&&(n.orientGame(o,r),n.checkResize(o,r))}setTimeout(function(){n.checkOrientation(n.initialised,n)},500)},t.prototype.orientGame=function(t,e){var i=!1;this.targetOrientation!=this.currentOrientation&&"landscape"!=this.currentOrientation||(i=!0),this.lastOrientationCorrect!=i&&(this.lastOrientationCorrect=i,i?(this.applyRotateOverlay(!1,t,e),this.correctOrientation=!0):(this.applyRotateOverlay(!0,t,e),this.correctOrientation=!1))},t.prototype.applyRotateOverlay=function(e,i,n){if("any"==this.targetOrientation)return t.holderDiv.className="active","portrait"==this.currentOrientation&&this.setScrollOverlay(!1,0),void this.centerGameOnScreen();if(1==e){if(this.rotateOverlay.className="active",t.holderDiv.removeAttribute("class"),this.rotateOverlay.style.width=i+"px",this.rotateOverlay.style.height=n+"px",this.setScrollOverlay(!1,i),0==this.initialised)return}else if(0==e){if(this.rotateOverlay.removeAttribute("class"),t.holderDiv.className="active",0==this.initialised)return;this.centerGameOnScreen()}},t.prototype.setScrollOverlay=function(e,i){0==e?(this.scrollOverlay.removeAttribute("class"),this.scrollOverlay.style.height="100px",t.holderDiv.style.top="0px",t.holderDiv.className="active",this.centerGameOnScreen()):1==e&&(this.scrollOverlay.className="active",t.holderDiv.removeAttribute("class"),this.scrollOverlay.style.height="9999999999999999px",this.scrollOverlay.style.width=String(i)+"px",window.scrollTo(0,0))},t.prototype.checkResize=function(e,i){if(e!=this.lastViewportWidth||i!=this.lastViewportHeight){if(1==t.oniPhone&&"landscape"==this.currentOrientation&&1==this.allowScrollOverlay){this.iOSScrollMode=!0;for(var n=[[320,480],[320,568],[375,667],[414,736]],o=0;o<n.length;o++){var r=n[o],a=(window.screen.height==r[0]&&window.screen.width==r[1]||window.screen.width==r[0]&&(window.screen.height,r[1]),r[0]);window.innerHeight==a&&(this.iOSScrollMode=!1)}this.setScrollOverlay(this.iOSScrollMode,e)}this.centerGameOnScreen()}this.lastViewportWidth=e,this.lastViewportHeight=i},t.prototype.gameInit=function(){this.resizeGameDivs(t.gameWidth+"px",t.gameHeight+"px"),t.stageWidth=t.gameWidth,t.stageHeight=t.gameHeight;var e=this,i=new PIXI.loaders.Loader;i.add(this.deeplinkConfigURL),i.once("complete",function(t){e.parseDeepLinkJSON(e,t.resources[e.deeplinkConfigURL].data["game-areas"][0])}),i.load()},t.prototype.parseDeepLinkJSON=function(t,e){for(var i in e){var n="\\b";if(n+=t.escapeRegExp(e[i]),n+="\\b",1==new RegExp(n,"i").test(window.location.href)){t.initialGameAreaToLoad=i;break}}t.beginGameInit(t)},t.prototype.beginGameInit=function(t){t.initAudio(t.loadModule),t.init(t),"any"==t.targetOrientation?t.applyRotateOverlay(!1,0,0):t.centerGameOnScreen()},t.prototype.centerGameOnScreen=function(){var e=this.detectBrowserViewport().w,i=this.detectBrowserViewport().h;if(t.onDesktop,1){this.scaleStage(e,i);var n=.5*(e-this.currentStageWidth),o=.5*(i-this.currentStageHeight);this.positionGameDivs(n+"px",o+"px"),t.gameOffset=this.getGameOffset(t.holderDiv),t.onAndroid}else t.gameOffset=this.getGameOffset(t.holderDiv),this.positionGameDivs((i-t.stageHeight)/2+"px",(e-t.stageWidth)/2+"px")},t.prototype.scaleStage=function(e,i){var n=i/e,o=t.gameHeight/t.gameWidth;n<o?(t.windowScaleFactor=i/t.gameHeight,this.currentStageWidth=i/o,this.currentStageHeight=i):(t.windowScaleFactor=e/t.gameWidth,this.currentStageWidth=e,this.currentStageHeight=e*o),this.resizeGameDivs(String(this.currentStageWidth),String(this.currentStageHeight+1)),this.resizePixiCanvas(this.currentStageWidth,this.currentStageHeight),this.adjustInputCSS(this.currentStageWidth,this.currentStageHeight)},t.prototype.resizeGameDivs=function(t,e){for(var i=0;i<this.gameHolderDivList.length;i++)this.gameHolderDivList[i].style.width=t+"px",this.gameHolderDivList[i].style.height=e+"px"},t.prototype.positionGameDivs=function(t,e){for(var i=0;i<this.gameHolderDivList.length;i++)this.gameHolderDivList[i].style.position="absolute",this.gameHolderDivList[i].style.top=e,this.gameHolderDivList[i].style.left=t},t.prototype.resizePixiCanvas=function(e,i){t.renderer&&t.renderer.resize(e,i);for(var n in this.scenes)this.scenes[n].resize(t.windowScaleFactor);this.ui&&this.ui.resize(t.windowScaleFactor)},t.prototype.addScene=function(t,e){var i=new t(this,e);this.scenes[i.id]=i},t.prototype.setLoadingScreen=function(t){this.currentLoadingScene=this.scenes[t]},t.prototype.setScene=function(e,i,n){void 0===i&&(i=!1);var o=0,r=t.tintColours[t.getRandom(0,6,!0)];1==i&&(o=.55),this.scenes[e]?(this.currentScene&&(this.currentScene.interactionLocked=!0,this.currentScene.interactive=!1,this.scenes[e].render=1!=i,o>0&&this.currentScene.initTransitionOut(o,r)),o>0?this.setSceneDelay=TweenMax.delayedCall(o,this.initSceneSwap,[this,o,e,r,n]):this.initSceneSwap(this,o,e,r,n)):t.trace("Can't find scene!"+e),this.lastSceneID=this.currentScene.id},t.prototype.initSceneSwap=function(e,i,n,o,r){e.currentScene&&0==e.currentScene.paused&&e.currentScene.destroy(),e.currentScene=e.scenes[n],e.currentScene.addUI(e.ui.uiContainer),e.ui.resize(t.windowScaleFactor),e.currentScene&&0==e.currentScene.paused?(e.currentScene.init(r),e.currentScene.initTransitionIn(i,o)):e.currentScene&&1==e.currentScene.paused&&(e.currentScene.interactionLocked=!1,e.currentScene.restore())},t.prototype.startStats=function(t){this.stats=new Stats,this.stats.setMode(t),this.stats.domElement.style.position="absolute",this.stats.domElement.style.right="0px",this.stats.domElement.style.top="0px",document.body.appendChild(this.stats.domElement)},t.prototype.initPIXI=function(){this.app=new PIXI.Application({width:t.stageWidth,height:t.stageHeight}),1==t.onDesktop?t.renderer=PIXI.autoDetectRenderer(t.stageWidth,t.stageHeight,{autoResize:!0,resolution:this.pixelRatio}):0==t.onDesktop&&(t.renderer=PIXI.autoDetectRenderer(t.stageWidth,t.stageHeight,{autoResize:!0,legacy:!0,resolution:this.pixelRatio})),this.app.renderer=t.renderer,t.renderer instanceof PIXI.CanvasRenderer?t.webGL=!1:t.webGL=!0,1==t.webGL&&1==t.onDesktop&&(t.useFilters=!0)},t.prototype.addPixiRenderer=function(){t.holderDiv.appendChild(t.renderer.view)},t.prototype.replaceStage=function(t){this.app.stage=t,console.log("replacing stage..",this.app.stage,this.app.stage==t)},t.prototype.startGameLoop=function(t){this.ticker=new PIXI.ticker.Ticker,this.ticker.speed=1,this.ticker.add(t.loopFuncRef=function(e){t.tick(t,e)}),this.ticker.start()},t.prototype.loadAssets=function(t,e,i,n){if(this.loadModule.reset(e),1!=e||n){var o;1==e&&1==n&&(1==this.ui.uiInitialised?(o=.5,this.setScene(this.currentLoadingScene.id,!1)):(o=0,this.setScene(this.currentLoadingScene.id,!1)));for(var r=0;r<t.length;r++){for(var a in this.visualAssets)a!=t[r]||this.loadModule.prepareLoad(t[r],this.visualAssets[a],"visual",e);for(var a in this.audioAssets)a!=t[r]||this.loadModule.prepareLoad(t[r],this.audioAssets[a],"audio",e)}var s=this;this.loadDelay=this.killDelay(this.loadDelay),this.loadDelay=TweenMax.delayedCall(o,function(){s.loadModule.load(i)})}else this.loadPreloaderAssets(this,t,i)},t.prototype.killDelay=function(t){return t&&(t.kill(),t=null),t},t.prototype.loadPreloaderAssets=function(t,e,i){t.loadAssets(t.currentLoadingScene.getPreloaderAssetList(),!1,function(){t.loadAssets(e,!0,i,!0)},!0)},t.prototype.tick=function(e,i){if(1!=e.paused){e.checkContainerCounter++,e.checkContainerCounter>=e.checkContainerLimit&&(e.checkContainerCounter=0,e.currentScene&&e.checkSceneContainer(e.currentScene));var n=e;n.stats&&n.stats.begin(),n.currentScene&&(t.renderer.render(n.currentScene.getRenderRootContainer()),n.currentScene.tick(i)),n.ui&&n.ui.tick(),n.stats&&n.stats.end()}},t.prototype.checkSceneContainer=function(t){if(0!=t.container.position.x||0!=t.container.position.y||0!=t.container.pivot.x||0!=t.container.pivot.y)throw new Error("Detected 'container' problem in scene '"+t.id+"'! Please don't change these properties.. Add an inner container if needed..")},t.openLink=function(t,e){1==e?window.open(t,"_blank"):window.open(t)},t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.saveProgress=function(){t.localStorageManager.saveProgress()},t.restoreProgress=function(){t.localStorageManager.restoreProgress()},t.prototype.setLocalStorageEnabled=function(e){t.localStorageManager.setLocalStorageEnabled(e)},t.prototype.initAudio=function(e){t.audioManager.initAudio(e)},t.playSound=function(e,i,n){t.audioManager.playSound(e,t.audioManager,i,n)},t.getSoundDuration=function(e){return t.audioManager.getSoundDuration(e,t.audioManager)},t.stopSound=function(e){t.audioManager.stopSound(e,t.audioManager)},t.fadeSound=function(e,i,n){t.audioManager.fadeSound(e,i,n,t.audioManager)},t.setSoundVolume=function(e,i){t.audioManager.setVolume(e,i)},t.stopCurrentInterruptableSound=function(){TweenMax.killDelayedCallsTo(t.playSound),t.audioManager.stopCurrentInterruptableSound()},t.pauseSound=function(e){t.audioManager.pauseSound(e,t.audioManager)},t.resumeSound=function(e){t.audioManager.resumeSound(e,t.audioManager)},t.prototype.launchIntoFullscreen=function(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},t.prototype.detectBrowserViewport=function(){var t=window.innerWidth,e=window.innerHeight;return void 0!==window.innerWidth?(t=window.innerWidth,e=window.innerHeight):void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):(t=720,e=480),{w:t,h:e}},t.prototype.isLowEndIPad=function(){var t=window.navigator.userAgent.toLowerCase();if(-1!=t.indexOf("ipod")||-1!=t.indexOf("iphone")||-1!=t.indexOf("ipad")){var e=window.screen.width*window.devicePixelRatio,i=window.screen.height*window.devicePixelRatio;if(1024==e&&768==i||768==e&&1024==i)return!0}return!1},t.prototype.isDesktop=function(){if(window.forceMobile)return!1;return 0!=window.screenX||!("ontouchstart"in window||"onmsgesturechange"in window)},t.prototype.isWebAudio=function(){var t=!0;return"undefined"!=typeof AudioContext?new AudioContext:void 0!==window.webkitAudioContext?new window.webkitAudioContext:t=!1,t},t.prototype.stopScrollWheelOnGame=function(){t.holderDiv.onwheel=function(t){t.preventDefault()},t.holderDiv.onmousewheel=function(t){t.preventDefault()}},t.prototype.setViewportTag=function(){if(!t.onDesktop)document.querySelector("meta[name=viewport]")},t.getRandom=function(t,e,i){var n=t+Math.random()*(e-t);return 1==i&&(n=Math.round(n)),n},t.prototype.getGameOffset=function(t){var e=0,i=0;if(t.offsetParent)do{e+=t.offsetLeft,i+=t.offsetTop}while(t=t.offsetParent);return{x:e,y:i}},t.prototype.escapeRegExp=function(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},t.prototype.handleFocusOut=function(){this.ui.changeFocusOut()},t.tintColours=[16114754,15276929,8925320,2398420,5093751,0,16777215],t.windowScaleFactor=1,t.onAndroid=!1,t.oniPhone=!1,t.isLowEndIPad=!1,t.onDesktop=!1,t.numberOfSoundsToPreload=0,t.numberOfAssetsToPreload=0,t.numberOfAssetsLoaded=0,t.soundOn=!0,t}();document.addEventListener("visibilitychange",function(){window.game.handleFocusOut()});var AudioManagerMk2=function(){function t(t,e,i){this.failedLoadFlash=!1,this.initialised=!1,this.soundLoadedCallback=function(){},this.flashTimeoutCall=function(){},this.game=t,this.onDesktop=e,this.webAudio=i,this.audioPath="",this.flashModeReady=!1,this.soundLoadAttempted=!1,this.sounds=new Array}return t.prototype.initAudio=function(t){if(this.loadModule=t,void 0!=this.forceMode)return this.force(this.forceMode),void(this.initialised=!0);1==this.onDesktop&&void 0!=Game.ieVer?(this.mode=1,this.flashModeReady=!1,this.initSoundManager()):this.initHowler(this.webAudio),this.initialised=!0},t.prototype.addSoundSpriteSound=function(t,e,i){Game.trace("add sprite!!!!",e,i),this.sounds.push({group:t,id:e,times:i})},t.prototype.addSound=function(t,e){this.loadModule.registerAudioAsset(),this.currentAssetLoc="sfx/",1==e.loc&&(this.currentAssetLoc="vo/"+Game.loc+"/");var i;i=1==e.loop,e.duration||(e.duration=-1),this.sounds.push({group:t,id:e.url,url:e.url,duration:e.duration,volume:1,loop:i,urlPrefix:this.currentAssetLoc,setToLoad:!1,currentlyPaused:!1})},t.prototype.initHowler=function(t,e){var i=!1;e&&(i=e),(1==t||1==t&&1==i&&0==this.forceMode)&&(this.mode=0,this.assetID="sounds")},t.prototype.initSoundManager=function(){this.assetID="sounds";var t=this;soundManager=new SoundManager,soundManager.setup({url:Game.basePath+"media/swf/",flashVersion:9,preferFlash:!0,debugMode:!1,useHighPerformance:!0,onready:function(){0==t.flashModeReady&&(t.flashModeReady=!0,1==t.soundLoadAttempted&&t.loadSounds()),t=null},ontimeout:function(){t.failedLoadFlash=!0,t.flashTimeoutCall()}}),soundManager.beginDelayedInit()},t.prototype.setLoadCallback=function(t){this.soundLoadedCallback=t},t.prototype.setFlashTimeout=function(t){this.flashTimeoutCall=t},t.prototype.loadSounds=function(){if(0==this.soundLoadAttempted&&(this.soundLoadAttempted=!0),0!=this.flashModeReady||1!=this.mode)for(var t=this,e=0;e<this.sounds.length;e++){var i,n=this.sounds[e];if(1!=n.setToLoad)if(n.setToLoad=!0,0==this.mode)i=new Howl({src:[Game.basePath+"media/audio/"+n.urlPrefix+n.url],autoplay:!1,loop:n.loop,onload:function(){t.soundLoadedCallback()}}),n.howlSound=i;else if(1==this.mode){if(soundManager.getSoundById(n.id,!0)){t.soundLoadedCallback();continue}soundManager.createSound({id:n.id,url:Game.basePath+"media/audio/"+n.urlPrefix+n.url,autoLoad:!0,autoPlay:!1,onload:function(){t.soundLoadedCallback()}})}}},t.prototype.playSound=function(t,e,i,n){1!=e.failedLoadFlash&&(n&&1==n&&(this.currentInterruptableSound=t),i&&e.setVolume(t,i),e.startSound(t))},t.prototype.fadeSound=function(t,e,i,n){n.fadeTheSound(t,e,i,n)},t.prototype.getSoundDuration=function(t,e){var i=e.getSoundByID(t);return i&&i.duration?i.duration:-1},t.prototype.startSound=function(t){var e=this.getSoundByID(t);void 0!=e&&e.id==t&&(0==this.mode?e.howlSound&&e.howlSound.play():1==this.mode&&this.soundManagerPlayLoop(t,e.loop))},t.prototype.setVolume=function(t,e){var i=this.getSoundByID(t);void 0!=i&&(0==this.mode&&i.howlSound.volume(e),1==this.mode&&soundManager.setVolume(t,100*e))},t.prototype.fadeTheSound=function(t,e,i,n){var o=n.getSoundByID(t);if(void 0!=o&&o.id==t)if(0==n.mode)o.howlSound&&o.howlSound.fade(o.howlSound._volume,i,1e3*e);else if(1==n.mode){var r={vol:1};TweenMax.to(r,e,{vol:i,onUpdate:function(){soundManager.setVolume(t,100*r.vol)},onComplete:function(){0==i&&soundManager.stop(t)}})}},t.prototype.soundManagerPlayLoop=function(t,e){var i=this;soundManager.play(t,{onfinish:function(){1==e&&i.soundManagerPlayLoop(t,e)}})},t.prototype.pauseSound=function(t,e){var i=e.getSoundByID(t);1==e.failedLoadFlash&&1==e.mode||void 0!=i&&(i.id!=t||(0==e.mode?i.howlSound&&1==i.howlSound.playing()&&(i.currentlyPaused=!0,i.howlSound.pause()):1==e.mode&&(i.currentlyPaused=!0,soundManager.pause(t))))},t.prototype.resumeSound=function(t,e){var i=e.getSoundByID(t);if(void 0!=i&&(1!=e.failedLoadFlash||1!=e.mode))return i.id==t&&1==i.currentlyPaused?(i.currentlyPaused=!1,void(0==e.mode?i.howlSound&&i.howlSound.play():1==e.mode&&soundManager.resume(t))):void 0},t.prototype.stopSound=function(t,e){var i=e.getSoundByID(t);1!=e.failedLoadFlash&&void 0!=i&&i.id==t&&(0==e.mode?i.howlSound&&(Game.trace("stopping sound",i,i.howlSound,i.howlerID),i.howlSound.stop()):1==e.mode&&soundManager.stop(t))},t.prototype.stopCurrentInterruptableSound=function(){this.currentInterruptableSound&&this.stopSound(this.currentInterruptableSound,this)},t.prototype.flush=function(t){if(Game.trace("Flushing audio system!",t,this.mode),0==this.mode)for(e=this.sounds.length-1;e>=0;e--){if((i=this.sounds[e]).group==t){if(0==this.checkSoundFlushable(t,i.id)){this.sounds.splice(e,1);continue}(n=this.sounds.splice(e,1))[0].howlSound.stop(),n[0].howlSound.unload(),n[0]=null,n=null}i=null}else if(1==this.mode&&this.sounds)for(var e=this.sounds.length-1;e>=0;e--){var i=this.sounds[e];if(i.group==t){if(0==this.checkSoundFlushable(t,i.id)){n=this.sounds.splice(e,1);soundManager.stop(n[0].id),n=null;continue}var n=this.sounds.splice(e,1);soundManager.stop(n[0].id),soundManager.destroySound(n[0].id),n[0]=null,n=null}i=null}},t.prototype.checkSoundFlushable=function(t,e){for(var i=!0,n=this.sounds.length-1;n>=0;n--){var o=this.sounds[n];o.group!=t&&o.id==e&&(i=!1)}return i},t.prototype.soundOn=function(){0==this.mode?Howler.mute(!1):1==this.mode&&soundManager.unmute()},t.prototype.soundOff=function(){0==this.mode?Howler.mute(!0):1==this.mode&&soundManager.mute()},t.prototype.getSoundByID=function(t){for(var e=0;e<this.sounds.length;e++){var i=this.sounds[e];if(t==i.id)return i}},t.prototype.listGroupsLoaded=function(){for(var t=new Array,e=0;e<this.sounds.length;e++)0==this.checkExists(this.sounds[e].group,t)&&t.push(this.sounds[e].group);for(e=0;e<t.length;e++)Game.trace("Members of this group are loaded: ",t[e])},t.prototype.listAssetsLoaded=function(){for(var t=0;t<this.sounds.length;t++)Game.trace("Asset loaded: ",this.sounds[t].id," - From group: ",this.sounds[t].group)},t.prototype.checkExists=function(t,e){var i=!1;if(0==e.length)return i;for(var n=0;n<e.length;n++)e[n]==t&&(i=!0);return i},t.prototype.force=function(t){this.assetID="sounds";var e;1==t?(e="SOUND MANAGER - FLASH MODE!",this.mode=1,this.initSoundManager()):0==t&&(e="HOWLER - NORMAL MODE!",this.mode=0,this.initHowler(!0,!0)),console.log(":::::::::::::::::::::::::::: FORCE AUDIO DEBUG MODE - "+this.forceMode+" => "+e)},t}(),LoadModule=function(){function t(t){this.firstLoadComplete=!1,this.game=t,this.lastLoadGroup=null}return t.prototype.prepareLoad=function(t,e,i,n,o){if(this.currentType=i,this.preloadCurrent=n,this.lastLoadGroup!=t){this.neverFlushCurrent=!1;for(r=0;r<e.length;r++)1!=e[r].neverFlush||(this.neverFlushCurrent=!0)}if(this.lastLoadGroup=t,"visual"==this.currentType)for(r=0;r<e.length;r++){if(this.itemPoolNumber=0,e[r].pool&&(this.itemPoolNumber=e[r].pool),o&&0!=this.itemPoolNumber)throw new ReferenceError('Ooops! You can only set "pool" attribute on elements at root level of Visual Assets manifest..');this.createVisualAsset(r,t,e[r],this.itemPoolNumber,e,o,this.neverFlushCurrent)}else if("audio"==this.currentType)for(var r=0;r<e.length;r++)e[r].url&&Game.audioManager.addSound(t,e[r])},t.prototype.createVisualAsset=function(t,e,i,n,o,r,a){if(i.platformspecific){if("desktop"==i.platformspecific&&0==Game.onDesktop)return;if("mobile"==i.platformspecific&&1==Game.onDesktop)return}if("bitmaptext"==i.type){if(i.alphabet&&i.alphabet!=Game.alphabet)return;this.createSpriteOrSpine(t,e,i,n,r,a)}if("spritesheet"==i.type&&this.createSpriteOrSpine(t,e,i,n,r,a),i.url){if("misc"==i.type)return void this.loadMiscFileType(i);this.createSpriteOrSpine(t,e,i,n,r,a)}else if(i.children){var s=0,l=!1,c=i.id;n>0&&(s=n-1,l=!0);for(var h=0;h<=s;h++){c=String(c+h);var p,u=i.children;if("button"==i.type)p=new UIButton;else{switch(i.projection){case"2d":p=new DisplayObjectContainer2d;break;case"2s":p=new DisplayObjectContainer2s;break;case"3d":p=new DisplayObjectContainer3d}i.projection||(p=new DisplayObjectContainer),p.pooled=l,p.pooledUniqueID=c}if(p.group=e,p.id=i.id,p.neverFlush=a,i.anchor){var d=!1;i.anchor[2]&&(d=i.anchor[2]),p.setRegPoint(i.anchor[0],i.anchor[1],d),p.origPivot={x:i.anchor[0],y:i.anchor[1],compensate:d},p.defaultPivot=!1}i.x&&(p.origX=i.x,p.position.x=p.origX),i.y&&(p.origY=i.y,p.position.y=p.origY),r?r.addChild(p):"button"==i.type?Game.displayStore.addButton(p):Game.displayStore.addContainer(p),this.prepareLoad(e,u,this.currentType,this.preloadCurrent,p)}}},t.prototype.loadMiscFileType=function(t){var e=Game.basePath;this.assetsPreparedForLoad.push({type:t.type,path:e,url:t.url})},t.prototype.createSpriteOrSpine=function(t,e,i,n,o,r){this.currentAssetLoc="base/",this.currentSpineFolder="",this.currentSpritesheetFolder="";var a="sprite";1==i.loc&&(this.currentAssetLoc="localised/"+Game.loc+"/"),"spine"==i.type&&(this.currentSpineFolder=i.dir+"/"),"spritesheet"==i.type&&(this.currentSpritesheetFolder=i.dir+"/"),"bitmaptext"==i.type&&(this.currentBitmapFontFolder=i.dir+"/"),i.type&&(a=i.type);var s;s="spine"==a?Game.basePath+"media/images/"+this.currentAssetLoc+this.currentSpineFolder:"spritesheet"==a?Game.basePath+"media/images/"+this.currentAssetLoc+this.currentSpritesheetFolder:"bitmaptext"==a?Game.basePath+"media/images/"+this.currentAssetLoc+this.currentBitmapFontFolder:Game.basePath+"media/images/"+this.currentAssetLoc;var l;l=i.id?i.id:i.url;i.pooledID&&i.pooledID,this.assetsToLoad++;var c=!0;void 0!=i.retina&&0==i.retina&&(c=!1),0==this.game.useRetinaAssests&&(c=!1),1==this.game.getPixelRatio()&&(c=!1),this.assetsPreparedForLoad.push({index:t,type:a,group:e,id:l,retina:c,pooledNum:n,textureLoadPath:null,path:s,url:i.url,dir:i.dir,atlasJSON:i.atlas,skeletonJSON:i.skeleton,container:o,x:i.x,y:i.y,anchor:i.anchor,w:i.w,h:i.h,frames:i.frames,fontname:i.fontname,fontdata:i.fontdata,alphabet:i.alphabet,projection:i.projection,neverFlush:r})},t.prototype.load=function(t){this.loadedCallback=t;for(var e=!1,i=Game.displayStore.getCurrentDisplayObjects(),n=new Array,o=0;o<this.assetsPreparedForLoad.length;o++){var r;if(1==this.assetsPreparedForLoad[o].retina?r="@2x":0==this.assetsPreparedForLoad[o].retina&&(r="@1x"),"spritesheet"==this.assetsPreparedForLoad[o].type?this.assetsPreparedForLoad[o].loadPath=this.assetsPreparedForLoad[o].path+this.assetsPreparedForLoad[o].atlasJSON:"bitmaptext"==this.assetsPreparedForLoad[o].type?this.assetsPreparedForLoad[o].loadPath=this.assetsPreparedForLoad[o].path+this.assetsPreparedForLoad[o].fontdata:"spine"==this.assetsPreparedForLoad[o].type?(e=!0,this.assetsPreparedForLoad[o].loadPath=this.assetsPreparedForLoad[o].path+this.assetsPreparedForLoad[o].skeletonJSON):this.assetsPreparedForLoad[o].loadPath=this.assetsPreparedForLoad[o].path+this.assetsPreparedForLoad[o].url,-1!=this.assetsPreparedForLoad[o].loadPath.lastIndexOf("/")){var a=this.assetsPreparedForLoad[o].loadPath.lastIndexOf("/"),s=this.assetsPreparedForLoad[o].loadPath;s=this.assetsPreparedForLoad[o].loadPath.substr(0,a+1)+r+this.assetsPreparedForLoad[o].loadPath.substr(a),this.assetsPreparedForLoad[o].loadPath=s}else this.assetsPreparedForLoad[o].loadPath=r+"/"+this.assetsPreparedForLoad[o].loadPath;this.assetsPreparedForLoad[o].textureLoadPath=this.assetsPreparedForLoad[o].loadPath,-1!=this.assetsPreparedForLoad[o].textureLoadPath.lastIndexOf(".xml")&&(this.assetsPreparedForLoad[o].textureLoadPath=this.assetsPreparedForLoad[o].textureLoadPath.replace(".xml",".png")),-1!=this.assetsPreparedForLoad[o].textureLoadPath.lastIndexOf(".json")&&(this.assetsPreparedForLoad[o].textureLoadPath=this.assetsPreparedForLoad[o].textureLoadPath.replace(".json",".png"));for(var l=!1,c=0;c<i.length;c++)if(this.assetsPreparedForLoad[o].textureLoadPath==i[c].textureURL){l=!0;break}0==l?n.push(this.assetsPreparedForLoad[o].loadPath):this.buildIndividualAsset(this,this.assetsPreparedForLoad[o])}n.length,(n=this.remove_duplicates(n)).length;for(var h=new PIXI.loaders.Loader,o=0;o<n.length;o++)if(0==e)h.add(String(n[o]),n[o]);else{var p={metadata:{spineAtlasSuffix:".txt"}};h.add(String(n[o]),n[o],p)}var u=this;Game.audioManager.setLoadCallback(this.checkLoadedFuncRef=function(){u.assetsLoaded++,u.checkAllAssetsLoaded(u)}),Game.audioManager.setFlashTimeout(this.flashTimeoutFuncRef=function(){}),h.load(this.buildAssetFuncRef=function(t,e){u.buildAssets(t,u)}),Game.audioManager.loadSounds()},t.prototype.buildAssets=function(t,e){for(var i in t.resources)for(var n=0;n<e.assetsPreparedForLoad.length;n++)t.resources[i].url==e.assetsPreparedForLoad[n].loadPath&&e.buildIndividualAsset(e,e.assetsPreparedForLoad[n],t.resources[i])},t.prototype.checkAllAssetsLoaded=function(t){1==t.usePreload&&t.game.currentScene&&t.game.currentScene.onLoadUpdate(t.assetsLoaded,t.assetsToLoad),t.assetsLoaded==t.assetsToLoad&&(t.callbackDelayTweenMax=t.killDelay(t.callbackDelayTweenMax),t.callbackDelayTweenMax=TweenMax.delayedCall(t.callbackDelay,t.loadedCallback))},t.prototype.killDelay=function(t){return t&&(t.kill(),t=null),t},t.prototype.buildIndividualAsset=function(t,e,i){var n=!0;i&&(n=!1),t.assetsLoaded++;var o,r=0,a=!1;e.pooledNum>0&&(r=e.pooledNum-1,a=!0);for(var s=0;s<=r;s++){o=e.id+String(s);var l;switch(1==e.retina?l=2:0==e.retina&&(l=1),e.type){case"sprite":y=1==n?PIXI.utils.TextureCache[e.loadPath]:i.texture;var c;switch(e.projection){case"2d":c=new Sprite2d(y);break;case"2s":c=new Sprite2s(y);break;case"3d":c=new Sprite3d(y)}e.projection||(c=new Sprite(y)),c.setTextureResolution(l),c.textureURL=e.textureLoadPath,c.group=e.group,c.id=e.id,c.neverFlush=e.neverFlush,c.pooled=a,c.pooledUniqueID=o,t.storeBuiltObject(c,e);break;case"bitmaptext":var h,p=80*this.game.getPixelRatio();(h=new BitmapText("0000",{font:String(p)+"px "+e.fontname,align:"left"})).textureURL=e.textureLoadPath,h.setTextureResolution(l),h.saveTexture(),h.group=e.group,h.id=e.id,h.fontname=e.fontname,h.pooled=a,h.pooledUniqueID=o,t.storeBuiltObject(h,e);break;case"spritesheet":var u,d;e.path,e.atlasJSON;d=new Array;var f=!1;if(e.frames&&e.frames.length>0&&(f=!0),0==n){if(1==f){for(var m=0;m<e.frames.length;m++)for(var g in i.data.frames)if(e.frames[m]==String(g)){y=PIXI.Texture.fromFrame(String(g));d.push(y)}}else if(0==f)for(var g in i.data.frames){var y=PIXI.Texture.fromFrame(String(g));d.push(y)}}else if(1==n)for(var v=Game.displayStore.getCurrentDisplayObjects(),b=0;b<v.length;b++)if(v[b].textureURL==e.textureLoadPath){for(var w=0;w<v[b].texturesStore.length;w++)d.push(v[b].texturesStore[w]);break}u=new AnimatedSprite(d),0==n&&-1!=i.data.meta.image.lastIndexOf(".jpg")&&(e.textureLoadPath=e.textureLoadPath.replace(".png",".jpg")),u.setJsonBaseTextureRef(e.loadPath+"_image"),u.textureURL=e.textureLoadPath,u.setTextureResolution(l),u.group=e.group,u.id=e.id,u.pooled=a,u.pooledUniqueID=o,t.storeBuiltObject(u,e);break;case"spine":var x;if(0==n)x=new Spine(i.spineData);else for(var v=Game.displayStore.getCurrentDisplayObjects(),b=0;b<v.length;b++)if(v[b].textureURL==e.textureLoadPath){x=new Spine(v[b].spineData);break}x.textureURL=e.textureLoadPath,x.setAtlasTextureRefID(e.loadPath+"_atlas_page_skeleton.png"),x.setTextureResolution(l),x.group=e.group,x.id=e.id,x.pooled=a,x.pooledUniqueID=o,t.storeBuiltObject(x,e)}}t.checkAllAssetsLoaded(t)},t.prototype.storeBuiltObject=function(t,e){if(e.x&&(t.origX=e.x,t.position.x=t.origX),e.y&&(t.origY=e.y,t.position.y=t.origY),e.anchor){var i=!1;e.anchor[2]&&(i=e.anchor[2]),t.setRegPoint(e.anchor[0],e.anchor[1],i),t.origAnchor={x:e.anchor[0],y:e.anchor[1],compensate:i},t.defaultAnchor=!1}if(e.w&&(t.width=e.w),e.h&&(t.height=e.h),e.container){var n=e.index;e.container.children.length<e.index&&(n=e.container.children.length),e.container.addChildAt(t,n)}"sprite"==e.type?Game.displayStore.addSprite(t):"spine"==e.type?Game.displayStore.addSpine(t):"spritesheet"==e.type?Game.displayStore.addAnimatedSprite(t):"bitmaptext"==e.type&&Game.displayStore.addBitmapText(t)},t.prototype.registerAudioAsset=function(){this.assetsToLoad++},t.prototype.reset=function(t){this.assetsToLoad=0,this.assetsLoaded=0,this.usePreload=t,this.loadedCallback=function(){},this.assetsPreparedForLoad=new Array,this.currentType="",this.itemPoolNumber=0,this.callbackDelay=1==t?1.2:0},t.prototype.remove_duplicates=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),GameoverScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.tickUpTime=1.5,n.id="gameoverScene",n}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.restartAllowed=!0,this.scoreTitleContainer=Game.displayStore.getContainer("game-over/score-title-container"),this.highScoreTitleContainer=Game.displayStore.getContainer("game-over/highscore-title-container"),this.giftShopTitleContainer=Game.displayStore.getContainer("game-over/gift-shop-title-container"),this.replayTitleContainer=Game.displayStore.getContainer("game-over/replay-title-container"),this.blackCover=Game.displayStore.getSprite("game-over/black"),this.wristbandContainer=Game.displayStore.getContainer("game-over/wristband-container"),this.wristbandParticlesContainer=Game.displayStore.getContainer("game-over/ticket-particle-container"),this.blackCover.width=Game.stageWidth,this.blackCover.height=Game.stageHeight,this.blackCover.alpha=0,this.currentScore=0,this.currentTickets=0,this.setBackgroundColor(13421772),this.game.ui.setUI("mini-game-gameover"),this.giftShopTitle.position.x=0-this.giftShopTitle.width/2+Game.stringsManager.getTextOffset("gameover-gift-shop").xOffset,this.giftShopTitle.position.y=this.giftShopPanel.position.y-50+Game.stringsManager.getTextOffset("gameover-gift-shop").yOffset,this.scoreTitle.position.x=this.scoreTitle.position.x-this.scoreTitle.width/2+Game.stringsManager.getTextOffset("gameover-score").xOffset,this.scoreTitle.position.y=this.scoreTitle.position.y-this.scoreTitle.height/2+Game.stringsManager.getTextOffset("gameover-score").yOffset},e.prototype.uiClicked=function(e){t.prototype.uiClicked.call(this,e),1!=this.interactionLocked&&e.id},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(){t.prototype.tick.call(this)},e.prototype.keyDown=function(t){},e.prototype.keyUp=function(t){},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),Game.stopSound("game-over/swish-long-1.mp3"),this.animation=this.killTween(this.animation)},e}(Scene),DisplayStore=function(){function t(t){this.game=t,this.displayObjects=new Array,this.loadedIDs=new Array}return t.prototype.addSprite=function(t){this.displayObjects.push(t)},t.prototype.addContainer=function(t){this.displayObjects.push(t)},t.prototype.addButton=function(t){this.displayObjects.push(t)},t.prototype.addSpine=function(t){this.displayObjects.push(t)},t.prototype.addAnimatedSprite=function(t){this.displayObjects.push(t)},t.prototype.addBitmapText=function(t){this.displayObjects.push(t)},t.prototype.getSpine=function(t){return this.getItem(t)},t.prototype.getSprite=function(t,e){return this.getItem(t,!0)},t.prototype.getSprite2d=function(t){return this.getItem(t,!0)},t.prototype.getSprite2s=function(t){return this.getItem(t,!0)},t.prototype.getSprite3d=function(t){return this.getItem(t,!0)},t.prototype.getContainer=function(t){return this.getItem(t,!0)},t.prototype.getContainer2d=function(t){return this.getItem(t,!0)},t.prototype.getContainer2s=function(t){return this.getItem(t,!0)},t.prototype.getContainer3d=function(t){return this.getItem(t,!0)},t.prototype.getButton=function(t){return this.getItem(t)},t.prototype.getAnimatedSprite=function(t){return this.getItem(t,!0)},t.prototype.getBitmapText=function(t,e){var i=this.getItem(t,!0);return Game.stringsManager.setTextString(i,e),i},t.prototype.getRenderTexture=function(t,e,i,n,o){var r;r=1==o?PIXI.RenderTexture.create(e,i,PIXI.SCALE_MODES.LINEAR,1):PIXI.RenderTexture.create(e,i,PIXI.SCALE_MODES.LINEAR,this.game.getPixelRatio());var a=new Sprite(r);return a.id=t,a.group=n,this.addSprite(a),{renderTexture:r,outputSprite:a}},t.prototype.getCurrentDisplayObjects=function(){return this.displayObjects},t.prototype.getItem=function(t,e){var i=!1;e&&(i=e);for(var n=!1,o=0;o<this.displayObjects.length;o++){if(this.retrievedItem=this.displayObjects[o],this.retrievedItem.id==t&&0==i&&(n=!0),this.retrievedItem.id==t&&1==i&&0==this.retrievedItem.pooled&&(n=!0),this.retrievedItem.id==t&&1==i&&1==this.retrievedItem.pooled&&0==this.retrievedItem.pooledActive&&(n=!0,this.retrievedItem.pooledActive=!0),1==n)return this.retrievedItem=this.resetRetrievedItem(this.retrievedItem),this.retrievedItem;if(o==this.displayObjects.length-1&&this.displayObjects[o].id!=t)throw new ReferenceError("Ooops! Can't find sprite with ID: "+t)}},t.prototype.returnPooledItem=function(t){for(var e=t,i=0;i<this.displayObjects.length;i++)if(e==this.displayObjects[i]&&1==e.pooled&&1==e.pooledActive&&e.pooledUniqueID==this.displayObjects[i].pooledUniqueID)return void(this.displayObjects[i].pooledActive=!1)},t.prototype.returnAllPooledItems=function(t){for(var e=0;e<this.displayObjects.length;e++)this.displayObjects[e].group&&this.displayObjects[e].group==t&&1==this.displayObjects[e].pooledActive&&(this.displayObjects[e].pooledActive=!1)},t.prototype.flush=function(t){for(var e=0;e<t.length;e++)for(var i=this.displayObjects.length-1;i>=0;i--){if(!this.displayObjects[i].group)throw new ReferenceError("Oops! Trying to flush an item with no 'group' ID. Example: You're using a RenderTexture to make a sprite but haven't added a 'group' ID to the Sprite..");if(this.displayObjects[i].group==t[e]&&0==this.displayObjects[i].neverFlush){var n=this.displayObjects.splice(i,1);n[0].disposeAssets(),n[0].destroy(),n[0]=null,n=null}}},t.prototype.checkTextureDeletable=function(t){for(var e=0;e<this.displayObjects.length;e++)if(this.displayObjects[e].items){if(0==this.checkItemsChildrenForTexture(this.displayObjects[e],t))return!1}else if(this.displayObjects[e].textureURL&&this.displayObjects[e].textureURL==t.textureURL&&this.displayObjects[e].group!=t.group)return!1;return!0},t.prototype.checkItemsChildrenForTexture=function(t,e){for(var i in t.items)if(t.items[i].items){if(0==this.checkItemsChildrenForTexture(t.items[i],e))return!1}else if(t.items[i].textureURL&&t.items[i].textureURL==e.textureURL&&t.items[i].group!=e.group)return!1;return!0},t.prototype.listGroupsLoaded=function(){for(var t=new Array,e=0;e<this.displayObjects.length;e++)0==this.checkExists(this.displayObjects[e].group,t)&&t.push(this.displayObjects[e].group);for(e=0;e<t.length;e++)console.log("Members of this group are loaded: ",t[e])},t.prototype.checkExists=function(t,e){var i=!1;if(0==e.length)return i;for(var n=0;n<e.length;n++)if(e[n]==t){i=!0;break}return i},t.prototype.listAssetsLoaded=function(){for(var t=0;t<this.displayObjects.length;t++)console.log("Asset loaded: ",this.displayObjects[t].id," - From group: ",this.displayObjects[t].group,this.displayObjects[t].pooledActive)},t.prototype.checkGroupLoaded=function(t){for(var e=!1,i=0;i<this.displayObjects.length;i++)if(this.displayObjects[i].group==t){e=!0;break}return e},t.prototype.setRegPoint=function(t,e,i,n){t.anchor.x=e,t.anchor.y=i,1==n&&(t.position.x=t.width*e+t.position.x,t.position.y=t.height*i+t.position.y)},t.prototype.disposeAssets=function(t){1==this.checkTextureDeletable(t)&&(t.disposeAssetsOnDestroy=!0,PIXI.Texture.removeFromCache(t.texture),PIXI.BaseTexture.removeFromCache(t.texture.baseTexture))},t.prototype.disposeAssetsBitmapText=function(t){1==Game.displayStore.checkTextureDeletable(t)&&(t.disposeAssetsOnDestroy=!0,t.pixiTex.destroy(!0),PIXI.Texture.removeFromCache(t.pixiTex),PIXI.BaseTexture.removeFromCache(t.pixiTex.baseTexture))},t.prototype.setTextureResolution=function(t,e){t.texture.baseTexture.resolution=e,t.texture.baseTexture.update()},t.prototype.setTextureResolutionBitmapText=function(t,e){var i=PIXI.utils.TextureCache[t.textureURL];i.baseTexture.resolution=e,i.baseTexture.update()},t.prototype.showOnlyChild=function(t,e){if(t.children&&t.children.length>1)for(var i=t.children.length-1;i>=0;i--)t.getChildAt(i).visible=i==e},t.prototype.resetRetrievedItem=function(t){return null==t?null:(t.scale.x=1,t.scale.y=1,t.rotation=0,t.scale3d&&(t.scale3d.x=1,t.scale3d.y=1,t.scale3d.z=1),t.projection&&(t.projection.euler.x=0,t.projection.euler.y=0,t.projection.euler.z=0),"number"==typeof t.origX&&(t.position.x=t.origX),"number"==typeof t.origY&&(t.position.y=t.origY),t.origAnchor&&("number"==typeof t.origAnchor.x&&(t.anchor.x=t.origAnchor.x),"number"==typeof t.origAnchor.y&&(t.anchor.y=t.origAnchor.y)),t.origPivot&&("number"==typeof t.origPivot.x&&(t.pivot.x=t.origPivot.x),"number"==typeof t.origPivot.y&&(t.pivot.y=t.origPivot.y)),"boolean"==typeof t.defaultAnchor&&0==t.defaultAnchor&&t.setRegPoint(t.origAnchor.x,t.origAnchor.y,t.origAnchor.compensate),"boolean"==typeof t.defaultPivot&&0==t.defaultPivot&&t.setRegPoint(t.origPivot.x,t.origPivot.y,t.origPivot.compensate),t)},t.prototype.disposeContainerAssets=function(t){if(t.children&&t.children.length>0)for(var e=t.children.length-1;e>=0;e--)t.removeChild(t.getChildAt(e));for(var i in t.items)t.items[i]=null,delete t.items[i]},t.prototype.removeContainerChildren=function(t){for(var e=t.children.length-1;e>=0;e--)t.removeChild(t.getChildAt(e))},t.prototype.setRegPointContainer=function(t,e,i,n){var o=t.width*e,r=t.height*i;t.pivot.x=o,t.pivot.y=r,1==n&&(t.position.x+=o,t.position.y+=r,t.origPivot.compensate=!0)},t.prototype.setRegPointContainerPixels=function(t,e,i,n){var o=t.pivot.x,r=t.pivot.y;if(t.pivot.x=e,t.pivot.y=i,1==n){var a=t.pivot.x-o,s=t.pivot.y-r,l=a*Math.cos(t.rotation)-s*Math.sin(t.rotation),c=s*Math.cos(t.rotation)+a*Math.sin(t.rotation);t.position.x+=l*t.scale.x,t.position.y+=c*t.scale.y}},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),TestPhysicsScene=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.id="testPhysicsScene",n}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.setBackgroundColor(13421772),this.tutorialOverlay=new TutorialOverlay(this),this.mainHolder=Game.displayStore.getContainer("test-physics/main-holder"),this.physicsManager=new TestPhysicsManager(this,this.mainHolder),this.physicsManager.initPhysicsWorld(),this.physicsDebugger=new PhysicsDebugger(this,this.mainHolder,this.physicsManager.world),this.testBodies=new Array;var i=Game.displayStore.getSprite("test-physics/circle.png"),n=Game.displayStore.getSprite("test-physics/square.png"),o=Game.displayStore.getSprite("test-physics/plane.png");o.width=Game.stageWidth;var r=this.physicsManager.getCircleElements(),a=this.physicsManager.getSquareElements(),s=this.physicsManager.getPlaneElements();this.testBodies.push({body:r.body,shape:r.shape,sprite:i}),this.testBodies.push({body:a.body,shape:a.shape,sprite:n}),this.testBodies.push({body:s.body,shape:s.shape,sprite:o}),this.mainHolder.addChild(i),this.mainHolder.addChild(n),this.mainHolder.addChild(o),this.tutorialViewed=Game.coreData.getGameTutorialViewed("blank"),Game.assetChunkManager.flushAssets("title"),Game.assetChunkManager.flushAssets("hub"),this.container.addChild(this.mainHolder),this.inputSprite=Game.displayStore.getSprite("test-physics/blank-input.png"),this.inputSprite.width=Game.stageWidth,this.inputSprite.height=Game.stageHeight,this.container.addChild(this.inputSprite),this.inputSprite.interactive=!0,this.inputSprite.buttonMode=!0;var l=this;Game.onDesktop?this.inputSprite.on("mousedown",function(t){l.inputDown(l,t.data.getLocalPosition(l.container))}):this.inputSprite.on("touchstart",function(t){l.inputDown(l,t.data.getLocalPosition(l.container))}),1==this.tutorialViewed?this.startGameplay():this.tutorialOverlay.buildTutorial("blank",!0)},e.prototype.inputDown=function(t,e){t.physicsManager.flipGravity()},e.prototype.startGameplay=function(){this.game.ui.setUI("gameplay-blank")},e.prototype.tutorialOverlayClosed=function(){this.startGameplay()},e.prototype.uiClicked=function(e){switch(t.prototype.uiClicked.call(this,e),this.tutorialOverlay.uiClicked(e),e.id){case"playbuttonlarge":this.resume();break;case"pause-button":this.pause()}},e.prototype.uiRolledOver=function(e){t.prototype.uiRolledOver.call(this,e)},e.prototype.tick=function(e){if(t.prototype.tick.call(this,e),1!=this.paused&&1!=this.tutorialOverlay.isOpen){for(var i=0;i<this.testBodies.length;i++)this.testBodies[i].sprite.position.x=this.testBodies[i].body.position[0],this.testBodies[i].sprite.position.y=Game.stageHeight-this.testBodies[i].body.position[1],this.testBodies[i].sprite.rotation=-this.testBodies[i].body.angle;this.physicsManager.stepPhysics(),this.physicsDebugger.updateDebugOverlay()}},e.prototype.gameOver=function(t){},e.prototype.keyDown=function(e){t.prototype.keyDown.call(this,e),1!=this.paused&&("left"==e?this.leftKeyDown():"right"==e&&this.rightKeyDown())},e.prototype.keyUp=function(e){t.prototype.keyUp.call(this,e),1!=this.paused&&("left"==e?this.leftKeyUp():"right"==e&&this.rightKeyUp())},e.prototype.leftKeyDown=function(){},e.prototype.leftKeyUp=function(){},e.prototype.rightKeyDown=function(){},e.prototype.rightKeyUp=function(){},e.prototype.restore=function(){t.prototype.restore.call(this),this.game.ui.setUI("pause")},e.prototype.activatePowerUpEffect=function(){},e.prototype.deactivatePowerUpEffect=function(){},e.prototype.secondChanceUse=function(){},e.prototype.pause=function(){t.prototype.pause.call(this)},e.prototype.resume=function(){t.prototype.resume.call(this),this.setBackgroundColor(15724527),this.game.ui.setUI("gameplay-blank")},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.tutorialOverlay.destroy()},e}(Scene),TestPhysicsManager=function(){function t(t,e){this.physicsEnabled=!0,this.resizeRatio=1,this.scene=t,this.mainContainer=e,this.shapesColour=16711680,this.springsColour=255,this.constraintsColour=65280}return t.prototype.initPhysicsWorld=function(){this.world=new p2.World({gravity:[0,-200]}),this.world.broadphase=new p2.NaiveBroadphase(1),this.world.defaultContactMaterial.restitution=.8;var t=this;this.world.on("beginContact",function(e){t.checkCollision(t,e)}),this.world.on("endContact",function(t){}),this.world.on("postStep",function(t){}),this.physicsEnabled=!0;var e=new p2.Body({position:[100,100],mass:0,angle:.5*-Math.PI}),i=new p2.Plane;e.addShape(i),this.world.addBody(e);var n=new p2.Body({mass:0,position:[Game.stageWidth,0],angle:.5*Math.PI}),o=new p2.Plane;n.addShape(o),this.world.addBody(n);var r=new p2.Body({mass:0,position:[0,Game.stageHeight],angle:.1-Math.PI}),a=new p2.Plane;r.addShape(a,[0,100]),this.world.addBody(r);var s=new p2.Body({mass:1,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)],angle:Game.getRandom(0,2*Math.PI)});s.fromPolygon([[-106,-88],[126,88],[126,-48],[105,-100]]),this.world.addBody(s);var l=new p2.Body({mass:0,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),c=new p2.Circle({radius:20});l.addShape(c);var h=new p2.Body({mass:.5,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),p=new p2.Circle({radius:10});h.addShape(p);var u=new p2.RevoluteConstraint(l,h,{collideConnected:!1,localPivotA:[0,0],localPivotB:[100,0]});this.world.addBody(l),this.world.addBody(h),this.world.addConstraint(u);var d=new p2.Body({mass:0,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),f=new p2.Box({width:30,height:10});d.addShape(f);var m=new p2.Body({mass:5,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]});m.fromPolygon([[0,-30],[40,20],[-35,0]]);var g=new p2.LinearSpring(d,m,{stiffness:100,restLength:100,damping:8});this.world.addBody(d),this.world.addBody(m),this.world.addSpring(g);var y=new p2.Body({mass:0,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),v=new p2.Capsule({length:120,radius:30});v.sensor=!0,y.addShape(v),this.world.addBody(y);var b=new p2.Body({mass:1,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),w=new p2.Capsule({length:200,radius:20});b.addShape(w),this.world.addBody(b);var x=new p2.Body({mass:.5,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),_=new p2.Particle;x.addShape(_),this.world.addBody(x);var S=new p2.Body({mass:.5,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),T=new p2.Particle;S.addShape(T),this.world.addBody(S);var P=new p2.Body({mass:.5,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),C=new p2.Particle;P.addShape(C),this.world.addBody(P);var I=new p2.Body({mass:.5,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)]}),k=new p2.Particle;I.addShape(k),this.world.addBody(I);var A=new p2.Body({mass:.4,position:[Game.getRandom(100,Game.stageWidth-100),Game.getRandom(100,Game.stageHeight-100)],angle:Game.getRandom(2*-Math.PI,2*Math.PI)}),M=new p2.Line({length:100});A.addShape(M),this.world.addBody(A);for(var O=[],R=0;R<200;R++){var B=Game.getRandom(Game.stageHeight-300,Game.stageHeight-500);O.push(B)}var G=new p2.Body,E=new p2.Heightfield(O,{elementWidth:50});G.addShape(E,[0,-100]),this.world.addBody(G),console.log("this is the heightfield..",G,E)},t.prototype.checkCollision=function(t,e){},t.prototype.flipGravity=function(){for(var t=0;t<this.world.bodies.length;t++)this.world.bodies[t].gravityScale*=-1},t.prototype.getCircleElements=function(){var t=new p2.Body({mass:1}),e=new p2.Circle({radius:75}),i=new p2.Circle({radius:50});return t.addShape(e,[50,30]),t.addShape(i,[-80,20]),t.position[0]=Game.getRandom(100,Game.stageWidth-100),t.position[1]=Game.getRandom(100,Game.stageHeight-100),t.applyImpulse([Game.getRandom(-200,200),Game.getRandom(-200,200)]),this.world.addBody(t),{body:t,shape:e}},t.prototype.getSquareElements=function(){var t=new p2.Body({mass:1}),e=new p2.Box({width:95,height:95});return t.addShape(e,[20,75]),t.position[0]=Game.getRandom(100,Game.stageWidth-100),t.position[1]=Game.getRandom(100,Game.stageHeight-100),t.applyImpulse([Game.getRandom(-200,200),Game.getRandom(-200,200)]),t.angularVelocity=Game.getRandom(-5,5),this.world.addBody(t),{body:t,shape:e}},t.prototype.getPlaneElements=function(){var t=new p2.Body({mass:0}),e=new p2.Plane;return t.addShape(e),this.world.addBody(t),{body:t,shape:e}},t.prototype.resetBody=function(t){t.invMass=1/t.mass,t.invInertia=1/t.inertia,t.angularVelocity=0,t.angularForce=0,t.angle=0,t.velocity=[0,0],t.setZeroForce()},t.prototype.addBodyToWorld=function(t){this.world.addBody(t)},t.prototype.removeBodyFromWorld=function(t){this.world.removeBody(t)},t.prototype.removeConstraintFromWorld=function(t){this.world.removeConstraint(t)},t.prototype.addConstraintToWorld=function(t){this.world.addConstraint(t)},t.prototype.removeSpringFromWorld=function(t){this.world.removeSpring(t)},t.prototype.addSpringToWorld=function(t){this.world.addSpring(t)},t.prototype.resizeElements=function(t,e){this.canvasHeight=e,this.canvasWidth=t,this.canvasOrigHeight&&(this.resizeRatio=this.canvasHeight/this.canvasOrigHeight)},t.prototype.stepPhysics=function(){0!=this.physicsEnabled&&this.world&&this.world.step(1/30)},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.destroy=function(){this.world.clear(),this.world=null},t}(),PhysicsDebugger=function(){function t(t,e,i){this.scene=t,this.mainContainer=e,this.world=i,this.shapesColour=16711680,this.springsColour=255,this.constraintsColour=65280,this.sensorColour=16776960,this.particleRadius=3,this.graphics=new PIXI.Graphics,this.mainContainer.addChild(this.graphics)}return t.prototype.updateDebugOverlay=function(){this.clearDebugOverlay();for(T=0;T<this.world.bodies.length;T++)for(var t=[this.world.bodies[T].position[0],Game.stageHeight-this.world.bodies[T].position[1]],e=-this.world.bodies[T].angle,i=0;i<this.world.bodies[T].shapes.length;i++){if(this.world.bodies[T].shapes[i]instanceof p2.Convex){h=this.shapesColour;1==this.world.bodies[T].shapes[i].sensor&&(h=this.sensorColour),this.graphics.lineStyle(3,h);for(var n=[this.world.bodies[T].shapes[i].position[0],this.world.bodies[T].shapes[i].position[1]],o=0;o<this.world.bodies[T].shapes[i].vertices.length;o++){var r=[n[0]+this.world.bodies[T].shapes[i].vertices[o][0],n[1]+this.world.bodies[T].shapes[i].vertices[o][1]],a=this.getDistance(r[0],r[1],0,0),s=this.getAngle(r[0],r[1],0,0),l=t[0]+Math.cos(s+e)*a,c=t[1]+Math.sin(s+e)*a;0==o?(this.graphics.moveTo(l,c),p=l,u=c):this.graphics.lineTo(l,c)}this.graphics.lineTo(p,u)}if(this.world.bodies[T].shapes[i]instanceof p2.Circle){var n=[this.world.bodies[T].shapes[i].position[0],this.world.bodies[T].shapes[i].position[1]],a=this.getDistance(n[0],n[1],0,0),s=this.getAngle(n[0],n[1],0,0),l=t[0]+Math.cos(s+e)*a,c=t[1]+Math.sin(s+e)*a,h=this.shapesColour;1==this.world.bodies[T].shapes[i].sensor&&(h=this.sensorColour),this.graphics.lineStyle(3,h),this.graphics.drawCircle(l,c,this.world.bodies[T].shapes[i].boundingRadius)}if(this.world.bodies[T].shapes[i]instanceof p2.Particle){var n=[this.world.bodies[T].shapes[i].position[0],this.world.bodies[T].shapes[i].position[1]],a=this.getDistance(n[0],n[1],0,0),s=this.getAngle(n[0],n[1],0,0),l=t[0]+Math.cos(s+e)*a,c=t[1]+Math.sin(s+e)*a,h=this.shapesColour;1==this.world.bodies[T].shapes[i].sensor&&(h=this.sensorColour),this.graphics.lineStyle(3,h),this.graphics.beginFill(h),this.graphics.drawCircle(l,c,this.particleRadius),this.graphics.endFill()}if(this.world.bodies[T].shapes[i]instanceof p2.Capsule){for(var p,u,n=[this.world.bodies[T].shapes[i].position[0],this.world.bodies[T].shapes[i].position[1]],d=this.world.bodies[T].shapes[i].length,f=this.world.bodies[T].shapes[i].radius,m=[[n[0]-d/2,n[1]-f],[n[0]+d/2,n[1]-f],[n[0]+d/2,n[1]+f],[n[0]-d/2,n[1]+f]],g=[[n[0]-d/2,n[1]],[n[0]+d/2,n[1]]],y=[],v=[],o=0;o<m.length;o++){var r=[n[0]+m[o][0],n[1]+m[o][1]],a=this.getDistance(r[0],r[1],0,0),s=this.getAngle(r[0],r[1],0,0),l=t[0]+Math.cos(s+e)*a,c=t[1]+Math.sin(s+e)*a;y[o]=[l,c]}for(o=0;o<g.length;o++){var r=[n[0]+g[o][0],n[1]+g[o][1]],a=this.getDistance(r[0],r[1],0,0),s=this.getAngle(r[0],r[1],0,0),l=t[0]+Math.cos(s+e)*a,c=t[1]+Math.sin(s+e)*a;v[o]=[l,c]}h=this.shapesColour;1==this.world.bodies[T].shapes[i].sensor&&(h=this.sensorColour),this.graphics.lineStyle(3,h),this.graphics.moveTo(y[0][0],y[0][1]),this.graphics.lineTo(y[1][0],y[1][1]),this.graphics.arc(v[0][0],v[0][1],f,e+.5*Math.PI,e+1.5*Math.PI,!1),this.graphics.lineTo(y[2][0],y[2][1]),this.graphics.arc(v[1][0],v[1][1],f,e+1.5*Math.PI,e+.5*Math.PI,!1)}if(this.world.bodies[T].shapes[i]instanceof p2.Plane){var n=[this.world.bodies[T].shapes[i].position[0],this.world.bodies[T].shapes[i].position[1]],h=this.shapesColour;1==this.world.bodies[T].shapes[i].sensor&&(h=this.sensorColour),this.graphics.lineStyle(3,h);var b=t[0]+n[0]+-2e3*Math.cos(e),w=t[1]+n[1]+-2e3*Math.sin(e);this.graphics.moveTo(b,w);var x=t[0]+n[0]+2e3*Math.cos(e),_=t[1]+n[1]+2e3*Math.sin(e);this.graphics.lineTo(x,_)}if(this.world.bodies[T].shapes[i]instanceof p2.Line){h=this.shapesColour;1==this.world.bodies[T].shapes[i].sensor&&(h=this.sensorColour);n=[this.world.bodies[T].shapes[i].position[0],this.world.bodies[T].shapes[i].position[1]];this.graphics.lineStyle(3,h);var S=this.world.bodies[T].shapes[i].length,b=t[0]+n[0]+Math.cos(e)*(S/2*-1),w=t[1]+n[1]+Math.sin(e)*(S/2*-1);this.graphics.moveTo(b,w);var x=t[0]+n[0]+Math.cos(e)*(S/2),_=t[1]+n[1]+Math.sin(e)*(S/2);this.graphics.lineTo(x,_)}if(this.world.bodies[T].shapes[i]instanceof p2.Heightfield){h=this.shapesColour;1==this.world.bodies[T].shapes[i].sensor&&(h=this.sensorColour);for(var n=[this.world.bodies[T].shapes[i].position[0],this.world.bodies[T].shapes[i].position[1]],o=0;o<this.world.bodies[T].shapes[i].heights.length;o++){var r=[n[0]+o*this.world.bodies[T].shapes[i].elementWidth,n[1]+this.world.bodies[T].shapes[i].heights[o]],a=this.getDistance(r[0],r[1],0,0),s=this.getAngle(r[0],r[1],0,0),l=t[0]+Math.cos(s+e)*a,c=t[1]+Math.sin(s+e)*a;0==o?(this.graphics.moveTo(l,c),p=l,u=c):this.graphics.lineTo(l,c)}}}for(T=0;T<this.world.constraints.length;T++)if(this.world.constraints[T].bodyA){this.graphics.lineStyle(3,this.constraintsColour);var b=this.world.constraints[T].bodyA.position[0],w=Game.stageHeight-this.world.constraints[T].bodyA.position[1];this.graphics.moveTo(b,w);var x=this.world.constraints[T].bodyB.position[0],_=Game.stageHeight-this.world.constraints[T].bodyB.position[1];this.graphics.lineTo(x,_)}for(var T=0;T<this.world.springs.length;T++){this.graphics.lineStyle(3,this.springsColour);var b=this.world.springs[T].bodyA.position[0],w=Game.stageHeight-this.world.springs[T].bodyA.position[1];this.graphics.moveTo(b,w);var x=this.world.springs[T].bodyB.position[0],_=Game.stageHeight-this.world.springs[T].bodyB.position[1];this.graphics.lineTo(x,_)}},t.prototype.getDistance=function(t,e,i,n){var o=t-i,r=e-n;return Math.sqrt(o*o+r*r)},t.prototype.getAngle=function(t,e,i,n){if(t==i&&e==n)return 0;var o=t-i,r=n-e;return Math.atan2(r,o)},t.prototype.clearDebugOverlay=function(){this.debugGraphicsLayer&&this.graphics.clear(),this.debugGraphicsLayer=[]},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.manualClear=function(){this.clearDebugOverlay()},t.prototype.destroy=function(){this.clearDebugOverlay(),this.graphics=null},t}();