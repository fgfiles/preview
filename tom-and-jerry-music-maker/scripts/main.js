(function(){"use strict";function e(e){return e&&DataView.prototype.isPrototypeOf(e)}function t(e){if("string"!=typeof e&&(e+=""),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e+=""),e}function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return Rt.iterable&&(t[Symbol.iterator]=function(){return t}),t}function a(e){this.map={},e instanceof a?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function i(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function l(e){var t=new FileReader,r=i(t);return t.readAsArrayBuffer(e),r}function s(e){var t=new FileReader,r=i(t);return t.readAsText(e),r}function c(e){for(var t=new Uint8Array(e),r=Array(t.length),n=0;n<t.length;n++)r[n]=dt(t[n]);return r.join("")}function u(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function d(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:Rt.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:Rt.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:Rt.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():Rt.arrayBuffer&&Rt.blob&&e(t)?(this._bodyArrayBuffer=u(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Rt.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||Dt(t))?this._bodyArrayBuffer=u(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Rt.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Rt.blob&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(l)}),this.text=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},Rt.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(e){var t=e.toUpperCase();return-1<Ot.indexOf(t)?t:e}function m(e,t){t=t||{};var r=t.body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new a(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=e+"";if(this.credentials=t.credentials||this.credentials||"same-origin",(t.headers||!this.headers)&&(this.headers=new a(t.headers)),this.method=p(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function f(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(a))}}),t}function g(e){var t=new a,r=e.replace(/\r?\n[\t ]+/g," ");return r.split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var a=r.join(":").trim();t.append(n,a)}}),t}function h(e,t){t||(t={}),this.type="default",this.status=t.status===void 0?200:t.status,this.ok=200<=this.status&&300>this.status,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new a(t.headers),this.url=t.url||"",this._initBody(e)}function v(e,t){return new Promise(function(r,n){function a(){i.abort()}var o=new m(e,t);if(o.signal&&o.signal.aborted)return n(new Ut("Aborted","AbortError"));var i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:g(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;r(new h(t,e))},i.onerror=function(){n(new TypeError("Network request failed"))},i.ontimeout=function(){n(new TypeError("Network request failed"))},i.onabort=function(){n(new Ut("Aborted","AbortError"))},i.open(o.method,o.url,!0),"include"===o.credentials?i.withCredentials=!0:"omit"===o.credentials&&(i.withCredentials=!1),"responseType"in i&&Rt.blob&&(i.responseType="blob"),o.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),o.signal&&(o.signal.addEventListener("abort",a),i.onreadystatechange=function(){4===i.readyState&&o.signal.removeEventListener("abort",a)}),i.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})}function x(){var e=new zt(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function y(e){var t=new zt(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function b(e,t,r,n){var a=new zt(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a}function _(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=r[0],s=r[1],c=r[2],u=r[3];return e[0]=n*l+o*s,e[1]=a*l+i*s,e[2]=n*c+o*u,e[3]=a*c+i*u,e}function T(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function S(){var e=new zt(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function E(e){var t=new zt(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function w(e,t,r,n,a,o){var i=new zt(6);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i[4]=a,i[5]=o,i}function k(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],s=t[5],c=r[0],u=r[1],d=r[2],p=r[3],m=r[4],f=r[5];return e[0]=n*c+o*u,e[1]=a*c+i*u,e[2]=n*d+o*p,e[3]=a*d+i*p,e[4]=n*m+o*f+l,e[5]=a*m+i*f+s,e}function A(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function N(){var e=new zt(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function P(e){var t=new zt(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function I(e,t,r,n,a,o,i,l,s){var c=new zt(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=a,c[5]=o,c[6]=i,c[7]=l,c[8]=s,c}function F(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],s=t[5],c=t[6],u=t[7],d=t[8],p=r[0],m=r[1],f=r[2],g=r[3],h=r[4],v=r[5],x=r[6],y=r[7],b=r[8];return e[0]=p*n+m*i+f*c,e[1]=p*a+m*l+f*u,e[2]=p*o+m*s+f*d,e[3]=g*n+h*i+v*c,e[4]=g*a+h*l+v*u,e[5]=g*o+h*s+v*d,e[6]=x*n+y*i+b*c,e[7]=x*a+y*l+b*u,e[8]=x*o+y*s+b*d,e}function M(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function C(){var e=new zt(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function R(e){var t=new zt(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function L(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function D(e,t,r,n,a,o,i,l,s,c,u,d,p,m,f,g){var h=new zt(16);return h[0]=e,h[1]=t,h[2]=r,h[3]=n,h[4]=a,h[5]=o,h[6]=i,h[7]=l,h[8]=s,h[9]=c,h[10]=u,h[11]=d,h[12]=p,h[13]=m,h[14]=f,h[15]=g,h}function O(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function G(e,t){if(e===t){var r=t[1],n=t[2],a=t[3],o=t[6],i=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=a,e[13]=i,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function U(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],l=t[5],s=t[6],c=t[7],u=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],h=t[14],v=t[15],x=r*l-n*i,y=r*s-a*i,b=r*c-o*i,_=n*s-a*l,T=n*c-o*l,S=a*c-o*s,E=u*g-d*f,w=u*h-p*f,k=u*v-m*f,A=d*h-p*g,N=d*v-m*g,P=p*v-m*h,I=x*P-y*N+b*A+_*k-T*w+S*E;return I?(I=1/I,e[0]=(l*P-s*N+c*A)*I,e[1]=(a*N-n*P-o*A)*I,e[2]=(g*S-h*T+v*_)*I,e[3]=(p*T-d*S-m*_)*I,e[4]=(s*k-i*P-c*w)*I,e[5]=(r*P-a*k+o*w)*I,e[6]=(h*b-f*S-v*y)*I,e[7]=(u*S-p*b+m*y)*I,e[8]=(i*N-l*k+c*E)*I,e[9]=(n*k-r*N-o*E)*I,e[10]=(f*T-g*b+v*x)*I,e[11]=(d*b-u*T-m*x)*I,e[12]=(l*w-i*A-s*E)*I,e[13]=(r*A-n*w+a*E)*I,e[14]=(g*y-f*_-h*x)*I,e[15]=(u*_-d*y+p*x)*I,e):null}function B(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],s=t[5],c=t[6],u=t[7],d=t[8],p=t[9],m=t[10],f=t[11],g=t[12],h=t[13],v=t[14],x=t[15],y=r[0],b=r[1],_=r[2],T=r[3];return e[0]=y*n+b*l+_*d+T*g,e[1]=y*a+b*s+_*p+T*h,e[2]=y*o+b*c+_*m+T*v,e[3]=y*i+b*u+_*f+T*x,y=r[4],b=r[5],_=r[6],T=r[7],e[4]=y*n+b*l+_*d+T*g,e[5]=y*a+b*s+_*p+T*h,e[6]=y*o+b*c+_*m+T*v,e[7]=y*i+b*u+_*f+T*x,y=r[8],b=r[9],_=r[10],T=r[11],e[8]=y*n+b*l+_*d+T*g,e[9]=y*a+b*s+_*p+T*h,e[10]=y*o+b*c+_*m+T*v,e[11]=y*i+b*u+_*f+T*x,y=r[12],b=r[13],_=r[14],T=r[15],e[12]=y*n+b*l+_*d+T*g,e[13]=y*a+b*s+_*p+T*h,e[14]=y*o+b*c+_*m+T*v,e[15]=y*i+b*u+_*f+T*x,e}function V(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=n+n,s=a+a,c=o+o,u=n*l,d=n*s,p=n*c,m=a*s,f=a*c,g=o*c,h=i*l,v=i*s,x=i*c;return e[0]=1-(m+g),e[1]=d+x,e[2]=p-v,e[3]=0,e[4]=d-x,e[5]=1-(u+g),e[6]=f+h,e[7]=0,e[8]=p+v,e[9]=f-h,e[10]=1-(u+m),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function H(e,t){var r=new zt(3),n=-t[0],a=-t[1],o=-t[2],i=t[3],l=t[4],s=t[5],c=t[6],u=t[7],d=n*n+a*a+o*o+i*i;return 0<d?(r[0]=2*(l*i+u*n+s*o-c*a)/d,r[1]=2*(s*i+u*a+c*n-l*o)/d,r[2]=2*(c*i+u*o+l*a-s*n)/d):(r[0]=2*(l*i+u*n+s*o-c*a),r[1]=2*(s*i+u*a+c*n-l*o),r[2]=2*(c*i+u*o+l*a-s*n)),V(e,t,r),e}function z(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function W(e,t){var r=t[0],n=t[1],a=t[2],o=t[4],i=t[5],l=t[6],s=t[8],c=t[9],u=t[10];return e[0]=mt(r*r+n*n+a*a),e[1]=mt(o*o+i*i+l*l),e[2]=mt(s*s+c*c+u*u),e}function j(e,t){var r=t[0]+t[5]+t[10],n=0;return 0<r?(n=2*mt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*mt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*mt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*mt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e}function X(e,t,r,n){var a=t[0],o=t[1],i=t[2],l=t[3],s=a+a,c=o+o,u=i+i,d=a*s,p=a*c,m=a*u,f=o*c,g=o*u,h=i*u,v=l*s,x=l*c,y=l*u,b=n[0],_=n[1],T=n[2];return e[0]=(1-(f+h))*b,e[1]=(p+y)*b,e[2]=(m-x)*b,e[3]=0,e[4]=(p-y)*_,e[5]=(1-(d+h))*_,e[6]=(g+v)*_,e[7]=0,e[8]=(m+x)*T,e[9]=(g-v)*T,e[10]=(1-(d+f))*T,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Y(e,t,r,n,a){var o=1/st(t/2),i=1/(n-a);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(a+n)*i,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*a*n*i,e[15]=0,e}function q(e,t,r,n,a,o,i){var l=1/(t-r),s=1/(n-a),c=1/(o-i);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*l,e[13]=(a+n)*s,e[14]=(i+o)*c,e[15]=1,e}function K(e,t,r,n){var a=void 0,o=void 0,i=void 0,l=void 0,s=void 0,c=void 0,u=void 0,d=void 0,p=void 0,m=void 0,f=t[0],g=t[1],h=t[2],v=n[0],x=n[1],y=n[2],b=r[0],_=r[1],T=r[2];return St(f-b)<Ht&&St(g-_)<Ht&&St(h-T)<Ht?O(e):(u=f-b,d=g-_,p=h-T,m=1/mt(u*u+d*d+p*p),u*=m,d*=m,p*=m,a=x*p-y*d,o=y*u-v*p,i=v*d-x*u,m=mt(a*a+o*o+i*i),m?(m=1/m,a*=m,o*=m,i*=m):(a=0,o=0,i=0),l=d*i-p*o,s=p*a-u*i,c=u*o-d*a,m=mt(l*l+s*s+c*c),m?(m=1/m,l*=m,s*=m,c*=m):(l=0,s=0,c=0),e[0]=a,e[1]=l,e[2]=u,e[3]=0,e[4]=o,e[5]=s,e[6]=d,e[7]=0,e[8]=i,e[9]=c,e[10]=p,e[11]=0,e[12]=-(a*f+o*g+i*h),e[13]=-(l*f+s*g+c*h),e[14]=-(u*f+d*g+p*h),e[15]=1,e)}function Q(e,t,r,n){var a=t[0],o=t[1],i=t[2],l=n[0],s=n[1],c=n[2],u=a-r[0],d=o-r[1],p=i-r[2],m=u*u+d*d+p*p;0<m&&(m=1/mt(m),u*=m,d*=m,p*=m);var f=s*p-c*d,g=c*u-l*p,h=l*d-s*u;return m=f*f+g*g+h*h,0<m&&(m=1/mt(m),f*=m,g*=m,h*=m),e[0]=f,e[1]=g,e[2]=h,e[3]=0,e[4]=d*h-p*g,e[5]=p*f-u*h,e[6]=u*g-d*f,e[7]=0,e[8]=u,e[9]=d,e[10]=p,e[11]=0,e[12]=a,e[13]=o,e[14]=i,e[15]=1,e}function J(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Z(){var e=new zt(3);return e[0]=0,e[1]=0,e[2]=0,e}function $(e){var t=new zt(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ee(e){var t=e[0],r=e[1],n=e[2];return mt(t*t+r*r+n*n)}function te(e,t,r){var n=new zt(3);return n[0]=e,n[1]=t,n[2]=r,n}function re(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function ne(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function ae(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function oe(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return mt(r*r+n*n+a*a)}function ie(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return r*r+n*n+a*a}function le(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function se(e,t){var r=t[0],n=t[1],a=t[2],o=r*r+n*n+a*a;return 0<o&&(o=1/mt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function ce(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ue(e,t,r){var n=t[0],a=t[1],o=t[2],i=r[0],l=r[1],s=r[2];return e[0]=a*s-o*l,e[1]=o*i-n*s,e[2]=n*l-a*i,e}function de(e,t,n,a){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0],i[1]=o[1]*ct(a)-o[2]*ut(a),i[2]=o[1]*ut(a)+o[2]*ct(a),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function pe(e,t,n,a){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[2]*ut(a)+o[0]*ct(a),i[1]=o[1],i[2]=o[2]*ct(a)-o[0]*ut(a),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function me(e,t,n,a){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0]*ct(a)-o[1]*ut(a),i[1]=o[0]*ut(a)+o[1]*ct(a),i[2]=o[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function fe(){var e=new zt(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function ge(e){var t=new zt(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function he(e,t,r,n){var a=new zt(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a}function ve(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function xe(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e}function ye(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function be(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function _e(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Te(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Se(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Ee(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],o=t[3]-e[3];return mt(r*r+n*n+a*a+o*o)}function we(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+a*a+o*o}function ke(e){var t=e[0],r=e[1],n=e[2],a=e[3];return mt(t*t+r*r+n*n+a*a)}function Ae(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t*t+r*r+n*n+a*a}function Ne(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=r*r+n*n+a*a+o*o;return 0<i&&(i=1/mt(i),e[0]=r*i,e[1]=n*i,e[2]=a*i,e[3]=o*i),e}function Pe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ie(e,r,n,a){var t=r[0],o=r[1],i=r[2],l=r[3];return e[0]=t+a*(n[0]-t),e[1]=o+a*(n[1]-o),e[2]=i+a*(n[2]-i),e[3]=l+a*(n[3]-l),e}function Fe(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3];return e[0]=r[0]*n+r[4]*a+r[8]*o+r[12]*i,e[1]=r[1]*n+r[5]*a+r[9]*o+r[13]*i,e[2]=r[2]*n+r[6]*a+r[10]*o+r[14]*i,e[3]=r[3]*n+r[7]*a+r[11]*o+r[15]*i,e}function Me(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Ce(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],i=t[0],l=t[1],s=t[2],c=t[3];return St(r-i)<=Ht*ht(1,St(r),St(i))&&St(n-l)<=Ht*ht(1,St(n),St(l))&&St(a-s)<=Ht*ht(1,St(a),St(s))&&St(o-c)<=Ht*ht(1,St(o),St(c))}function Re(){var e=new zt(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Le(e,t,r){r*=.5;var n=ut(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=ct(r),e}function De(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=r[0],s=r[1],c=r[2],u=r[3];return e[0]=n*u+i*l+a*c-o*s,e[1]=a*u+i*s+o*l-n*c,e[2]=o*u+i*c+n*s-a*l,e[3]=i*u-n*l-a*s-o*c,e}function Oe(e,t,r){r*=.5;var n=t[0],a=t[1],o=t[2],i=t[3],l=ut(r),s=ct(r);return e[0]=n*s+i*l,e[1]=a*s+o*l,e[2]=o*s-a*l,e[3]=i*s-n*l,e}function Ge(e,t,r){r*=.5;var n=t[0],a=t[1],o=t[2],i=t[3],l=ut(r),s=ct(r);return e[0]=n*s-o*l,e[1]=a*s+i*l,e[2]=o*s+n*l,e[3]=i*s-a*l,e}function Ue(e,t,r){r*=.5;var n=t[0],a=t[1],o=t[2],i=t[3],l=ut(r),s=ct(r);return e[0]=n*s+a*l,e[1]=a*s-n*l,e[2]=o*s+i*l,e[3]=i*s-o*l,e}function Be(e,r,n,a){var t=r[0],o=r[1],i=r[2],l=r[3],s=n[0],c=n[1],u=n[2],d=n[3],p=void 0,m=void 0,f=void 0,g=void 0,h=void 0;return m=t*s+o*c+i*u+l*d,0>m&&(m=-m,s=-s,c=-c,u=-u,d=-d),1e-6<1-m?(p=lt(m),f=ut(p),g=ut((1-a)*p)/f,h=ut(a*p)/f):(g=1-a,h=a),e[0]=g*t+h*s,e[1]=g*o+h*c,e[2]=g*i+h*u,e[3]=g*l+h*d,e}function Ve(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(0<r)n=mt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);var o=(a+1)%3,l=(a+2)%3;n=mt(t[3*a+a]-t[3*o+o]-t[3*l+l]+1),e[a]=.5*n,n=.5/n,e[3]=(t[3*o+l]-t[3*l+o])*n,e[o]=(t[3*o+a]+t[3*a+o])*n,e[l]=(t[3*l+a]+t[3*a+l])*n}return e}function He(e,t,r,n){var a=.5*pt/180;t*=a,r*=a,n*=a;var o=ut(t),i=ct(t),l=ut(r),s=ct(r),c=ut(n),u=ct(n);return e[0]=o*s*u-i*l*c,e[1]=i*l*u+o*s*c,e[2]=i*s*c-o*l*u,e[3]=i*s*u+o*l*c,e}function ze(){var e=new zt(8);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function We(e){var t=new zt(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function je(e,t,r,n,a,o,i,l){var s=new zt(8);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=a,s[5]=o,s[6]=i,s[7]=l,s}function Xe(e,t,r,n,a,o,i){var l=new zt(8);l[0]=e,l[1]=t,l[2]=r,l[3]=n;var s=.5*a,c=.5*o,u=.5*i;return l[4]=s*n+c*r-u*t,l[5]=c*n+u*e-s*r,l[6]=u*n+s*t-c*e,l[7]=-s*e-c*t-u*r,l}function Ye(e,r,n){var t=.5*n[0],a=.5*n[1],o=.5*n[2],i=r[0],l=r[1],s=r[2],c=r[3];return e[0]=i,e[1]=l,e[2]=s,e[3]=c,e[4]=t*c+a*s-o*l,e[5]=a*c+o*i-t*s,e[6]=o*c+t*l-a*i,e[7]=-t*i-a*l-o*s,e}function qe(e,r){var n=Re();j(n,r);var a=new zt(3);return z(a,r),Ye(e,n,a),e}function Ke(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Qe(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=r[4],s=r[5],c=r[6],u=r[7],d=t[4],p=t[5],m=t[6],f=t[7],g=r[0],h=r[1],v=r[2],x=r[3];return e[0]=n*x+i*g+a*v-o*h,e[1]=a*x+i*h+o*g-n*v,e[2]=o*x+i*v+n*h-a*g,e[3]=i*x-n*g-a*h-o*v,e[4]=n*u+i*l+a*c-o*s+d*x+f*g+p*v-m*h,e[5]=a*u+i*s+o*l-n*c+p*x+f*h+m*g-d*v,e[6]=o*u+i*c+n*s-a*l+m*x+f*v+d*h-p*g,e[7]=i*u-n*l-a*s-o*c+f*x-d*g-p*h-m*v,e}function Je(){var e=new zt(2);return e[0]=0,e[1]=0,e}function Ze(e){var t=new zt(2);return t[0]=e[0],t[1]=e[1],t}function $e(e,t){var r=new zt(2);return r[0]=e,r[1]=t,r}function et(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function tt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function rt(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function nt(e,t){var r=t[0]-e[0],n=t[1]-e[1];return mt(r*r+n*n)}function at(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function ot(e){var t=e[0],r=e[1];return mt(t*t+r*r)}function it(e){var t=e[0],r=e[1];return t*t+r*r}var lt=Math.acos,st=Math.tan,ct=Math.cos,ut=Math.sin,pt=Math.PI,dt=String.fromCharCode,mt=Math.sqrt,ft=Math.LN2,gt=Math.round,ht=Math.max,vt=Math.ceil,xt=Math.log,yt=Math.pow,bt=Math.exp,_t=Math.expm1,Tt=Math.floor,St=Math.abs,Et=Math.min,wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,o){try{var i=t[a](o),l=i.value}catch(e){return void r(e)}return i.done?void e(l):Promise.resolve(l).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}},At=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Nt=function(){function e(e,t){for(var r=0,n;r<t.length;r++)n=t[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Pt=function e(t,r,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,r);if(void 0===a){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in a)return a.value;var i=a.get;return void 0===i?void 0:i.call(n)},It=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Ft=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")},Mt=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e};(function c(d,e,t){function r(i,o){if(!e[i]){if(!d[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var u=e[i]={exports:{}};d[i][0].call(u.exports,function(t){var e=d[i][1][t];return r(e?e:t)},u,u.exports,c,d,e,t)}return e[i].exports}for(var n="function"==typeof require&&require,a=0;a<t.length;a++)r(t[a]);return r})({1:[function(e){(function(t){function r(e,t,r){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:r})}if(e(327),e(328),e(2),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),["pop","reverse","shift","keys","values","entries","indexOf","every","some","forEach","map","filter","find","findIndex","includes","join","slice","concat","push","splice","unshift","sort","lastIndexOf","reduce","reduceRight","copyWithin","fill"].forEach(function(e){[][e]&&r(Array,e,Function.call.bind([][e]))})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{2:2,327:327,328:328}],2:[function(e,t){e(130),t.exports=e(23).RegExp.escape},{130:130,23:23}],3:[function(e,t){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],4:[function(e,t){var r=e(18);t.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},{18:18}],5:[function(e,t){var r=e(128)("unscopables"),n=Array.prototype;n[r]==null&&e(42)(n,r,{}),t.exports=function(e){n[r][e]=!0}},{128:128,42:42}],6:[function(e,t){t.exports=function(e,t,r,n){if(!(e instanceof t)||n!==void 0&&n in e)throw TypeError(r+": incorrect invocation!");return e}},{}],7:[function(e,t){var r=e(51);t.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},{51:51}],8:[function(e,t){var r=e(119),n=e(114),a=e(118);t.exports=[].copyWithin||function(e,t){var o=r(this),i=a(o.length),l=n(e,i),s=n(t,i),c=2<arguments.length?arguments[2]:void 0,u=Et((c===void 0?i:n(c,i))-s,i-l),d=1;for(s<l&&l<s+u&&(d=-1,s+=u-1,l+=u-1);0<u--;)s in o?o[l]=o[s]:delete o[l],l+=d,s+=d;return o}},{114:114,118:118,119:119}],9:[function(e,t){var r=e(119),n=e(114),a=e(118);t.exports=function(e){for(var t=r(this),o=a(t.length),i=arguments.length,l=n(1<i?arguments[1]:void 0,o),s=2<i?arguments[2]:void 0,c=void 0===s?o:n(s,o);c>l;)t[l++]=e;return t}},{114:114,118:118,119:119}],10:[function(e,t){var r=e(39);t.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},{39:39}],11:[function(e,t){var r=e(117),n=e(118),a=e(114);t.exports=function(e){return function(t,o,i){var l=r(t),s=n(l.length),c=a(i,s),u;if(e&&o!=o){for(;s>c;)if(u=l[c++],u!=u)return!0;}else for(;s>c;c++)if((e||c in l)&&l[c]===o)return e||c||0;return!e&&-1}}},{114:114,117:117,118:118}],12:[function(e,t){var r=e(25),n=e(47),a=e(119),o=e(118),i=e(15);t.exports=function(e,t){var l=1==e,s=4==e,c=6==e,u=t||i;return function(t,i,d){for(var p=a(t),m=n(p),g=r(i,d,3),f=o(m.length),h=0,v=l?u(t,f):2==e?u(t,0):void 0,x,y;f>h;h++)if((5==e||c||h in m)&&(x=m[h],y=g(x,h,p),e))if(l)v[h]=y;else if(y)switch(e){case 3:return!0;case 5:return x;case 6:return h;case 2:v.push(x);}else if(s)return!1;return c?-1:3==e||s?s:v}}},{118:118,119:119,15:15,25:25,47:47}],13:[function(e,t){var r=e(3),n=e(119),a=e(47),o=e(118);t.exports=function(e,t,l,s,c){r(t);var u=n(e),d=a(u),p=o(u.length),m=c?p-1:0,f=c?-1:1;if(2>l)for(;;){if(m in d){s=d[m],m+=f;break}if(m+=f,c?0>m:p<=m)throw TypeError("Reduce of empty array with no initial value")}for(;c?0<=m:p>m;m+=f)m in d&&(s=t(s,d[m],m,u));return s}},{118:118,119:119,3:3,47:47}],14:[function(e,t){var r=e(51),n=e(49),a=e(128)("species");t.exports=function(e){var t;return n(e)&&(t=e.constructor,"function"==typeof t&&(t===Array||n(t.prototype))&&(t=void 0),r(t)&&(t=t[a],null===t&&(t=void 0))),void 0===t?Array:t}},{128:128,49:49,51:51}],15:[function(e,t){var r=e(14);t.exports=function(e,t){return new(r(e))(t)}},{14:14}],16:[function(e,t){var r=e(3),n=e(51),a=e(46),o=[].slice,l={},i=function(e,t,r){if(!(t in l)){for(var a=[],n=0;n<t;n++)a[n]="a["+n+"]";l[t]=Function("F,a","return new F("+a.join(",")+")")}return l[t](e,r)};t.exports=Function.bind||function(e){var t=r(this),l=o.call(arguments,1),s=function r(){var n=l.concat(o.call(arguments));return this instanceof r?i(t,n.length,n):a(t,n,e)};return n(t.prototype)&&(s.prototype=t.prototype),s}},{3:3,46:46,51:51}],17:[function(e,t){var r=e(18),n=e(128)("toStringTag"),a="Arguments"==r(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(t){}};t.exports=function(e){var t,i,l;return e===void 0?"Undefined":null===e?"Null":"string"==typeof(i=o(t=Object(e),n))?i:a?r(t):"Object"==(l=r(t))&&"function"==typeof t.callee?"Arguments":l}},{128:128,18:18}],18:[function(e,t){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],19:[function(e,t){var r=e(72).f,n=e(71),a=e(93),o=e(25),i=e(6),l=e(39),s=e(55),c=e(57),u=e(100),d=e(29),p=e(66).fastKey,m=e(125),f=d?"_s":"size",g=function(e,t){var r=p(t),n;if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};t.exports={getConstructor:function(e,t,s,c){var u=e(function(e,r){i(e,u,t,"_i"),e._t=t,e._i=n(null),e._f=void 0,e._l=void 0,e[f]=0,null!=r&&l(r,s,e[c],e)});return a(u.prototype,{clear:function(){for(var e=m(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[f]=0},delete:function(e){var r=m(this,t),n=g(r,e);if(n){var a=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=a),a&&(a.p=o),r._f==n&&(r._f=a),r._l==n&&(r._l=o),r[f]--}return!!n},forEach:function(e){m(this,t);for(var r=o(e,1<arguments.length?arguments[1]:void 0,3),n;n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!g(m(this,t),e)}}),d&&r(u.prototype,"size",{get:function(){return m(this,t)[f]}}),u},def:function(e,t,r){var n=g(e,t),a,o;return n?n.v=r:(e._l=n={i:o=p(t,!0),k:t,v:r,p:a=e._l,n:void 0,r:!1},!e._f&&(e._f=n),a&&(a.n=n),e[f]++,"F"!==o&&(e._i[o]=n)),e},getEntry:g,setStrong:function(e,t,r){s(e,t,function(e,r){this._t=m(e,t),this._k=r,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?c(0,r.k):"values"==t?c(0,r.v):c(0,[r.k,r.v]):(e._t=void 0,c(1))},r?"entries":"values",!r,!0),u(t)}}},{100:100,125:125,25:25,29:29,39:39,55:55,57:57,6:6,66:66,71:71,72:72,93:93}],20:[function(e,t){var r=e(17),n=e(10);t.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return n(this)}}},{10:10,17:17}],21:[function(e,t){var r=e(93),n=e(66).getWeak,a=e(7),o=e(51),i=e(6),l=e(39),s=e(12),c=e(41),u=e(125),d=s(5),p=s(6),m=0,f=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},h=function(e,t){return d(e.a,function(e){return e[0]===t})};g.prototype={get:function(e){var t=h(this,e);if(t)return t[1]},has:function(e){return!!h(this,e)},set:function(e,t){var r=h(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},t.exports={getConstructor:function(e,t,a,s){var d=e(function(e,r){i(e,d,t,"_i"),e._t=t,e._i=m++,e._l=void 0,null!=r&&l(r,a,e[s],e)});return r(d.prototype,{delete:function(e){if(!o(e))return!1;var r=n(e);return!0===r?f(u(this,t))["delete"](e):r&&c(r,this._i)&&delete r[this._i]},has:function(e){if(!o(e))return!1;var r=n(e);return!0===r?f(u(this,t)).has(e):r&&c(r,this._i)}}),d},def:function(e,t,r){var o=n(a(t),!0);return!0===o?f(e).set(t,r):o[e._i]=r,e},ufstore:f}},{12:12,125:125,39:39,41:41,51:51,6:6,66:66,7:7,93:93}],22:[function(e,t){var r=e(40),n=e(33),a=e(94),o=e(93),i=e(66),l=e(39),s=e(6),c=e(51),u=e(35),d=e(56),p=e(101),m=e(45);t.exports=function(e,t,f,g,h,v){var x=r[e],y=x,b=h?"set":"add",_=y&&y.prototype,T={},S=function(e){var t=_[e];a(_,e,"delete"==e?function(e){return(!v||c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return(!v||c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"!=typeof y||!(v||_.forEach&&!u(function(){new y().entries().next()})))y=g.getConstructor(t,e,h,b),o(y.prototype,f),i.NEED=!0;else{var E=new y,w=E[b](v?{}:-0,1)!=E,k=u(function(){E.has(1)}),A=d(function(e){new y(e)}),N=!v&&u(function(){for(var e=new y,t=5;t--;)e[b](t,t);return!e.has(-0)});A||(y=t(function(t,r){s(t,y,e);var n=m(new x,t,y);return null!=r&&l(r,h,n[b],n),n}),y.prototype=_,_.constructor=y),(k||N)&&(S("delete"),S("has"),h&&S("get")),(N||w)&&S(b),v&&_.clear&&delete _.clear}return p(y,e),T[e]=y,n(n.G+n.W+n.F*(y!=x),T),v||g.setStrong(y,e,h),y}},{101:101,33:33,35:35,39:39,40:40,45:45,51:51,56:56,6:6,66:66,93:93,94:94}],23:[function(e,t){var r=t.exports={version:"2.5.0"};"number"==typeof __e&&(__e=r)},{}],24:[function(e,t){var r=e(72),n=e(92);t.exports=function(e,t,a){t in e?r.f(e,t,n(0,a)):e[t]=a}},{72:72,92:92}],25:[function(e,t){var r=e(3);t.exports=function(e,t,n){return(r(e),void 0===t)?e:1===n?function(r){return e.call(t,r)}:2===n?function(r,n){return e.call(t,r,n)}:3===n?function(r,n,a){return e.call(t,r,n,a)}:function(){return e.apply(t,arguments)}}},{3:3}],26:[function(e,t){var r=e(35),n=Date.prototype.getTime,a=Date.prototype.toISOString,o=function(e){return 9<e?e:"0"+e};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=a.call(new Date(-50000000000001))})||!r(function(){a.call(new Date(NaN))})?function(){if(!isFinite(n.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),a=0>t?"-":9999<t?"+":"";return a+("00000"+St(t)).slice(a?-6:-4)+"-"+o(e.getUTCMonth()+1)+"-"+o(e.getUTCDate())+"T"+o(e.getUTCHours())+":"+o(e.getUTCMinutes())+":"+o(e.getUTCSeconds())+"."+(99<r?r:"0"+o(r))+"Z"}:a},{35:35}],27:[function(e,t){var r=e(7),n=e(120),a="number";t.exports=function(e){if("string"!==e&&e!==a&&"default"!==e)throw TypeError("Incorrect hint");return n(r(this),e!=a)}},{120:120,7:7}],28:[function(e,t){t.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},{}],29:[function(e,t){t.exports=!e(35)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{35:35}],30:[function(e,t){var r=e(51),n=e(40).document,a=r(n)&&r(n.createElement);t.exports=function(e){return a?n.createElement(e):{}}},{40:40,51:51}],31:[function(e,t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],32:[function(e,t){var r=e(81),n=e(78),a=e(82);t.exports=function(e){var t=r(e),o=n.f;if(o)for(var l=o(e),s=a.f,c=0,u;l.length>c;)s.call(e,u=l[c++])&&t.push(u);return t}},{78:78,81:81,82:82}],33:[function(e,t){var r=e(40),n=e(23),a=e(42),o=e(94),i=e(25),l="prototype",s=function e(t,s,c){var u=t&e.F,d=t&e.G,p=t&e.S,m=t&e.P,f=t&e.B,g=d?r:p?r[s]||(r[s]={}):(r[s]||{})[l],h=d?n:n[s]||(n[s]={}),v=h[l]||(h[l]={}),x,y,b,_;for(x in d&&(c=s),c)y=!u&&g&&void 0!==g[x],b=(y?g:c)[x],_=f&&y?i(b,r):m&&"function"==typeof b?i(Function.call,b):b,g&&o(g,x,b,t&e.U),h[x]!=b&&a(h,x,_),m&&v[x]!=b&&(v[x]=b)};r.core=n,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},{23:23,25:25,40:40,42:42,94:94}],34:[function(e,t){var r=e(128)("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},{128:128}],35:[function(e,t){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],36:[function(e,t){var r=e(42),n=e(94),a=e(35),o=e(28),i=e(128);t.exports=function(e,t,l){var s=i(e),c=l(o,s,""[e]),u=c[0],d=c[1];a(function(){var t={};return t[s]=function(){return 7},7!=""[e](t)})&&(n(String.prototype,e,u),r(RegExp.prototype,s,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},{128:128,28:28,35:35,42:42,94:94}],37:[function(e,t){var r=e(7);t.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{7:7}],38:[function(e,t){function r(e,t,s,c,u,d,p,m){for(var f=u,g=0,h=!!p&&i(p,m,3),v,x;g<c;){if(g in s){if(v=h?h(s[g],g,t):s[g],x=!1,a(v)&&(x=v[l],x=void 0===x?n(v):!!x),x&&0<d)f=r(e,t,v,o(v.length),f,d-1)-1;else{if(9007199254740991<=f)throw TypeError();e[f]=v}f++}g++}return f}var n=e(49),a=e(51),o=e(118),i=e(25),l=e(128)("isConcatSpreadable");t.exports=r},{118:118,128:128,25:25,49:49,51:51}],39:[function(e,t,r){var n=e(25),a=e(53),o=e(48),i=e(7),l=e(118),s=e(129),c={},u={},r=t.exports=function(e,t,r,d,p){var m=p?function(){return e}:s(e),g=n(r,d,t?2:1),f=0,h,v,x,y;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(o(m)){for(h=l(e.length);h>f;f++)if(y=t?g(i(v=e[f])[0],v[1]):g(e[f]),y===c||y===u)return y;}else for(x=m.call(e);!(v=x.next()).done;)if(y=a(x,g,v.value,t),y===c||y===u)return y};r.BREAK=c,r.RETURN=u},{118:118,129:129,25:25,48:48,53:53,7:7}],40:[function(e,t){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],41:[function(e,t){var r={}.hasOwnProperty;t.exports=function(e,t){return r.call(e,t)}},{}],42:[function(e,t){var r=e(72),n=e(92);t.exports=e(29)?function(e,t,a){return r.f(e,t,n(1,a))}:function(e,t,r){return e[t]=r,e}},{29:29,72:72,92:92}],43:[function(e,t){var r=e(40).document;t.exports=r&&r.documentElement},{40:40}],44:[function(e,t){t.exports=!e(29)&&!e(35)(function(){return 7!=Object.defineProperty(e(30)("div"),"a",{get:function(){return 7}}).a})},{29:29,30:30,35:35}],45:[function(e,t){var r=e(51),n=e(99).set;t.exports=function(e,t,a){var o=t.constructor,i;return o!==a&&"function"==typeof o&&(i=o.prototype)!==a.prototype&&r(i)&&n&&n(e,i),e}},{51:51,99:99}],46:[function(e,t){t.exports=function(e,t,r){var n=r===void 0;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3]);}return e.apply(r,t)}},{}],47:[function(e,t){var r=e(18);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{18:18}],48:[function(e,t){var r=e(58),n=e(128)("iterator"),a=Array.prototype;t.exports=function(e){return e!==void 0&&(r.Array===e||a[n]===e)}},{128:128,58:58}],49:[function(e,t){var r=e(18);t.exports=Array.isArray||function(e){return"Array"==r(e)}},{18:18}],50:[function(e,t){var r=e(51);t.exports=function(e){return!r(e)&&isFinite(e)&&Tt(e)===e}},{51:51}],51:[function(e,t){t.exports=function(e){return"object"===("undefined"==typeof e?"undefined":wt(e))?null!==e:"function"==typeof e}},{}],52:[function(e,t){var r=e(51),n=e(18),a=e(128)("match");t.exports=function(e){var t;return r(e)&&((t=e[a])===void 0?"RegExp"==n(e):!!t)}},{128:128,18:18,51:51}],53:[function(e,t){var r=e(7);t.exports=function(t,e,n,a){try{return a?e(r(n)[0],n[1]):e(n)}catch(n){var o=t["return"];throw void 0!==o&&r(o.call(t)),n}}},{7:7}],54:[function(e,t){var r=e(71),n=e(92),a=e(101),o={};e(42)(o,e(128)("iterator"),function(){return this}),t.exports=function(e,t,i){e.prototype=r(o,{next:n(1,i)}),a(e,t+" Iterator")}},{101:101,128:128,42:42,71:71,92:92}],55:[function(e,t){var r=e(60),n=e(33),a=e(94),o=e(42),i=e(41),l=e(58),s=e(54),c=e(101),u=e(79),d=e(128)("iterator"),p=!([].keys&&"next"in[].keys()),m="keys",f="values",g=function(){return this};t.exports=function(e,t,h,v,x,y,b){s(h,t,v);var _=function(e){return!p&&e in w?w[e]:e===m?function(){return new h(this,e)}:e===f?function(){return new h(this,e)}:function(){return new h(this,e)}},T=t+" Iterator",S=x==f,E=!1,w=e.prototype,k=w[d]||w["@@iterator"]||x&&w[x],A=k||_(x),N=x?S?_("entries"):A:void 0,P="Array"==t?w.entries||k:k,I,F,M;if(P&&(M=u(P.call(new e)),M!==Object.prototype&&M.next&&(c(M,T,!0),!r&&!i(M,d)&&o(M,d,g))),S&&k&&k.name!==f&&(E=!0,A=function(){return k.call(this)}),(!r||b)&&(p||E||!w[d])&&o(w,d,A),l[t]=A,l[T]=g,x)if(I={values:S?A:_(f),keys:y?A:_(m),entries:N},b)for(F in I)F in w||a(w,F,I[F]);else n(n.P+n.F*(p||E),t,I);return I}},{101:101,128:128,33:33,41:41,42:42,54:54,58:58,60:60,79:79,94:94}],56:[function(e,t){var r=e(128)("iterator"),n=!1;try{var a=[7][r]();a["return"]=function(){n=!0}}catch(t){}t.exports=function(e,t){if(!t&&!n)return!1;var a=!1;try{var o=[7],i=o[r]();i.next=function(){return{done:a=!0}},o[r]=function(){return i},e(o)}catch(t){}return a}},{128:128}],57:[function(e,t){t.exports=function(e,t){return{value:t,done:!!e}}},{}],58:[function(e,t){t.exports={}},{}],59:[function(e,t){var r=e(81),n=e(117);t.exports=function(e,t){for(var a=n(e),o=r(a),i=o.length,l=0,s;i>l;)if(a[s=o[l++]]===t)return s}},{117:117,81:81}],60:[function(e,t){t.exports=!1},{}],61:[function(e,t){var r=_t;t.exports=!r||22025.465794806718<r(10)||22025.465794806718>r(10)||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:-1e-6<e&&1e-6>e?e+e*e/2:bt(e)-1}:r},{}],62:[function(e,t){var r=e(65),n=yt,o=n(2,-52),i=n(2,-23),l=n(2,127)*(2-i),s=n(2,-126),c=function(e){return e+1/o-1/o};t.exports=Math.fround||function(e){var t=St(e),n=r(e),u,d;return t<s?n*c(t/s/i)*s*i:(u=(1+i/o)*t,d=u-(u-t),d>l||d!=d?n*(1/0):n*d)}},{65:65}],63:[function(e,t){t.exports=Math.log1p||function(e){return-1e-8<(e=+e)&&1e-8>e?e-e*e/2:xt(1+e)}},{}],64:[function(e,t){t.exports=Math.scale||function(e,t,r,n,a){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||a!=a?NaN:e===1/0||e===-Infinity?e:(e-t)*(a-n)/(r-t)+n}},{}],65:[function(e,t){t.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:0>e?-1:1}},{}],66:[function(e,t){var r=e(124)("meta"),n=e(51),a=e(41),o=e(72).f,i=0,l=Object.isExtensible||function(){return!0},s=!e(35)(function(){return l(Object.preventExtensions({}))}),c=function(e){o(e,r,{value:{i:"O"+ ++i,w:{}}})},u=t.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!n(e))return"symbol"==("undefined"==typeof e?"undefined":wt(e))?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[r].i},getWeak:function(e,t){if(!a(e,r)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[r].w},onFreeze:function(e){return s&&u.NEED&&l(e)&&!a(e,r)&&c(e),e}}},{124:124,35:35,41:41,51:51,72:72}],67:[function(e,t){var r=e(160),n=e(33),a=e(103)("metadata"),o=a.store||(a.store=new(e(266))),i=function(e,t,n){var a=o.get(e);if(!a){if(!n)return;o.set(e,a=new r)}var i=a.get(t);if(!i){if(!n)return;a.set(t,i=new r)}return i};t.exports={store:o,map:i,has:function(e,t,r){var n=i(t,r,!1);return n!==void 0&&n.has(e)},get:function(e,t,r){var n=i(t,r,!1);return n===void 0?void 0:n.get(e)},set:function(e,t,r,n){i(r,n,!0).set(e,t)},keys:function(e,t){var r=i(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},key:function(e){return e===void 0||"symbol"==("undefined"==typeof e?"undefined":wt(e))?e:e+""},exp:function(e){n(n.S,"Reflect",e)}}},{103:103,160:160,266:266,33:33}],68:[function(e,t){var r=e(40),n=e(113).set,a=r.MutationObserver||r.WebKitMutationObserver,o=r.process,i=r.Promise,l="process"==e(18)(o);t.exports=function(){var e=function(){var e,r;for(l&&(e=o.domain)&&e.exit();t;){r=t.fn,t=t.next;try{r()}catch(r){throw t?c():s=void 0,r}}s=void 0,e&&e.enter()},t,s,c;if(l)c=function(){o.nextTick(e)};else if(a){var u=!0,d=document.createTextNode("");new a(e).observe(d,{characterData:!0}),c=function(){d.data=u=!u}}else if(i&&i.resolve){var p=i.resolve();c=function(){p.then(e)}}else c=function(){n.call(r,e)};return function(e){var r={fn:e,next:void 0};s&&(s.next=r),t||(t=r,c()),s=r}}},{113:113,18:18,40:40}],69:[function(e,t){function r(e){var t,r;this.promise=new e(function(e,n){if(t!==void 0||r!==void 0)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)}var n=e(3);t.exports.f=function(e){return new r(e)}},{3:3}],70:[function(e,t){var r=e(81),n=e(78),a=e(82),o=e(119),i=e(47),l=Object.assign;t.exports=!l||e(35)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=l({},e)[r]||Object.keys(l({},t)).join("")!=n})?function(e){for(var t=o(e),l=arguments.length,s=1,c=n.f,u=a.f;l>s;)for(var d=i(arguments[s++]),p=c?r(d).concat(c(d)):r(d),m=p.length,f=0,g;m>f;)u.call(d,g=p[f++])&&(t[g]=d[g]);return t}:l},{119:119,35:35,47:47,78:78,81:81,82:82}],71:[function(e,t){var r=e(7),n=e(73),a=e(31),o=e(102)("IE_PROTO"),i=function(){},l="prototype",s=function(){var t=e(30)("iframe"),r=a.length,n="<",o=">",c;for(t.style.display="none",e(43).appendChild(t),t.src="javascript:",c=t.contentWindow.document,c.open(),c.write(n+"script"+o+"document.F=Object"+n+"/script"+o),c.close(),s=c.F;r--;)delete s[l][a[r]];return s()};t.exports=Object.create||function(e,t){var a;return null===e?a=s():(i[l]=r(e),a=new i,i[l]=null,a[o]=e),void 0===t?a:n(a,t)}},{102:102,30:30,31:31,43:43,7:7,73:73}],72:[function(e,t,r){var n=e(7),a=e(44),o=e(120),i=Object.defineProperty;r.f=e(29)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),a)try{return i(e,t,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{120:120,29:29,44:44,7:7}],73:[function(e,t){var r=e(72),n=e(7),a=e(81);t.exports=e(29)?Object.defineProperties:function(e,t){n(e);for(var o=a(t),l=o.length,s=0,c;l>s;)r.f(e,c=o[s++],t[c]);return e}},{29:29,7:7,72:72,81:81}],74:[function(e,t){t.exports=e(60)||!e(35)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete e(40)[t]})},{35:35,40:40,60:60}],75:[function(e,t,r){var n=e(82),a=e(92),o=e(117),i=e(120),l=e(41),s=e(44),c=Object.getOwnPropertyDescriptor;r.f=e(29)?c:function(e,t){if(e=o(e),t=i(t,!0),s)try{return c(e,t)}catch(t){}return l(e,t)?a(!n.f.call(e,t),e[t]):void 0}},{117:117,120:120,29:29,41:41,44:44,82:82,92:92}],76:[function(e,t){var r=e(117),n=e(77).f,a={}.toString,o="object"==("undefined"==typeof window?"undefined":wt(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i=function(e){try{return n(e)}catch(t){return o.slice()}};t.exports.f=function(e){return o&&"[object Window]"==a.call(e)?i(e):n(r(e))}},{117:117,77:77}],77:[function(e,t,r){var n=e(80),a=e(31).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return n(e,a)}},{31:31,80:80}],78:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],79:[function(e,t){var r=e(41),n=e(119),a=e(102)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=n(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},{102:102,119:119,41:41}],80:[function(e,t){var r=e(41),n=e(117),a=e(11)(!1),o=e(102)("IE_PROTO");t.exports=function(e,t){var l=n(e),s=0,c=[],u;for(u in l)u!=o&&r(l,u)&&c.push(u);for(;t.length>s;)r(l,u=t[s++])&&(~a(c,u)||c.push(u));return c}},{102:102,11:11,117:117,41:41}],81:[function(e,t){var r=e(80),n=e(31);t.exports=Object.keys||function(e){return r(e,n)}},{31:31,80:80}],82:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],83:[function(e,t){var r=e(33),n=e(23),a=e(35);t.exports=function(e,t){var o=(n.Object||{})[e]||Object[e],i={};i[e]=t(o),r(r.S+r.F*a(function(){o(1)}),"Object",i)}},{23:23,33:33,35:35}],84:[function(e,t){var r=e(81),n=e(117),a=e(82).f;t.exports=function(e){return function(t){for(var o=n(t),l=r(o),s=l.length,c=0,u=[],d;s>c;)a.call(o,d=l[c++])&&u.push(e?[d,o[d]]:o[d]);return u}}},{117:117,81:81,82:82}],85:[function(e,t){var r=e(77),n=e(78),a=e(7),o=e(40).Reflect;t.exports=o&&o.ownKeys||function(e){var t=r.f(a(e)),o=n.f;return o?t.concat(o(e)):t}},{40:40,7:7,77:77,78:78}],86:[function(e,t){var r=e(40).parseFloat,n=e(111).trim;t.exports=1/r(e(112)+"-0")==-Infinity?r:function(e){var t=n(e+"",3),a=r(t);return 0===a&&"-"==t.charAt(0)?-0:a}},{111:111,112:112,40:40}],87:[function(e,t){var r=e(40).parseInt,n=e(111).trim,a=e(112),o=/^[-+]?0[xX]/;t.exports=8!==r(a+"08")||22!==r(a+"0x16")?function(e,t){var a=n(e+"",3);return r(a,t>>>0||(o.test(a)?16:10))}:r},{111:111,112:112,40:40}],88:[function(e,t){var r=e(89),n=e(46),a=e(3);t.exports=function(){for(var e=a(this),t=arguments.length,o=Array(t),l=0,s=r._,c=!1;t>l;)(o[l]=arguments[l++])===s&&(c=!0);return function(){var r=this,a=arguments.length,i=0,l=0,u;if(!c&&!a)return n(e,o,r);if(u=o.slice(),c)for(;t>i;i++)u[i]===s&&(u[i]=arguments[l++]);for(;a>l;)u.push(arguments[l++]);return n(e,u,r)}}},{3:3,46:46,89:89}],89:[function(e,t){t.exports=e(40)},{40:40}],90:[function(e,t){t.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},{}],91:[function(e,t){var r=e(69);t.exports=function(e,t){var n=r.f(e),a=n.resolve;return a(t),n.promise}},{69:69}],92:[function(e,t){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],93:[function(e,t){var r=e(94);t.exports=function(e,t,n){for(var a in t)r(e,a,t[a],n);return e}},{94:94}],94:[function(e,t){var r=e(40),n=e(42),a=e(41),o=e(124)("src"),i="toString",l=Function[i],s=(""+l).split(i);e(23).inspectSource=function(e){return l.call(e)},(t.exports=function(e,t,i,l){var c="function"==typeof i;c&&(a(i,"name")||n(i,"name",t));e[t]===i||(c&&(a(i,o)||n(i,o,e[t]?""+e[t]:s.join(t+""))),e===r?e[t]=i:l?e[t]?e[t]=i:n(e,t,i):(delete e[t],n(e,t,i)))})(Function.prototype,i,function(){return"function"==typeof this&&this[o]||l.call(this)})},{124:124,23:23,40:40,41:41,42:42}],95:[function(e,t){t.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return(t+"").replace(e,r)}}},{}],96:[function(e,t){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},{}],97:[function(e,t){var r=e(33),a=e(3),o=e(25),i=e(39);t.exports=function(e){r(r.S,e,{from:function(e){var t=arguments[1],r,l,s,c;return(a(this),r=void 0!==t,r&&a(t),null==e)?new this:(l=[],r?(s=0,c=o(t,arguments[2],2),i(e,!1,function(e){l.push(c(e,s++))})):i(e,!1,l.push,l),new this(l))}})}},{25:25,3:3,33:33,39:39}],98:[function(e,t){var r=e(33);t.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},{33:33}],99:[function(e,t){var r=e(51),n=e(7),a=function(e,t){if(n(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,n){try{n=e(25)(Function.call,e(75).f(Object.prototype,"__proto__").set,2),n(t,[]),r=!(t instanceof Array)}catch(t){r=!0}return function(e,t){return a(e,t),r?e.__proto__=t:n(e,t),e}}({},!1):void 0),check:a}},{25:25,51:51,7:7,75:75}],100:[function(e,t){var r=e(40),n=e(72),a=e(29),o=e(128)("species");t.exports=function(e){var t=r[e];a&&t&&!t[o]&&n.f(t,o,{configurable:!0,get:function(){return this}})}},{128:128,29:29,40:40,72:72}],101:[function(e,t){var r=e(72).f,n=e(41),a=e(128)("toStringTag");t.exports=function(e,t,o){e&&!n(e=o?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},{128:128,41:41,72:72}],102:[function(e,t){var r=e(103)("keys"),n=e(124);t.exports=function(e){return r[e]||(r[e]=n(e))}},{103:103,124:124}],103:[function(e,t){var r=e(40),n="__core-js_shared__",a=r[n]||(r[n]={});t.exports=function(e){return a[e]||(a[e]={})}},{40:40}],104:[function(e,t){var r=e(7),n=e(3),a=e(128)("species");t.exports=function(e,t){var o=r(e).constructor,i;return o===void 0||(i=r(o)[a])==null?t:n(i)}},{128:128,3:3,7:7}],105:[function(e,t){var r=e(35);t.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},{35:35}],106:[function(e,t){var r=e(116),n=e(28);t.exports=function(e){return function(t,o){var c=n(t)+"",s=r(o),i=c.length,l,u;return 0>s||s>=i?e?"":void 0:(l=c.charCodeAt(s),55296>l||56319<l||s+1===i||56320>(u=c.charCodeAt(s+1))||57343<u?e?c.charAt(s):l:e?c.slice(s,s+2):(l-55296<<10)+(u-56320)+65536)}}},{116:116,28:28}],107:[function(e,t){var r=e(52),n=e(28);t.exports=function(e,t,a){if(r(t))throw TypeError("String#"+a+" doesn't accept regex!");return n(e)+""}},{28:28,52:52}],108:[function(e,t){var r=e(33),n=e(35),a=e(28),o=/"/g,i=function(e,t,r,n){var i=a(e)+"",l="<"+t;return""!==r&&(l+=" "+r+"=\""+(n+"").replace(o,"&quot;")+"\""),l+">"+i+"</"+t+">"};t.exports=function(e,t){var a={};a[e]=t(i),r(r.P+r.F*n(function(){var t=""[e]("\"");return t!==t.toLowerCase()||3<t.split("\"").length}),"String",a)}},{28:28,33:33,35:35}],109:[function(e,t){var r=e(118),n=e(110),a=e(28);t.exports=function(e,t,o,i){var l=a(e)+"",s=l.length,c=void 0===o?" ":o+"",u=r(t);if(u<=s||""==c)return l;var d=u-s,p=n.call(c,vt(d/c.length));return p.length>d&&(p=p.slice(0,d)),i?p+l:l+p}},{110:110,118:118,28:28}],110:[function(e,t){var r=e(116),a=e(28);t.exports=function(e){var t=a(this)+"",o="",i=r(e);if(0>i||i==1/0)throw RangeError("Count can't be negative");for(;0<i;(i>>>=1)&&(t+=t))1&i&&(o+=t);return o}},{116:116,28:28}],111:[function(e,t){var r=e(33),n=e(28),a=e(35),o=e(112),i="["+o+"]",l="\u200B\x85",s=RegExp("^"+i+i+"*"),c=RegExp(i+i+"*$"),u=function(e,t,n){var i={},s=a(function(){return!!o[e]()||l[e]()!=l}),c=i[e]=s?t(d):o[e];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},d=u.trim=function(e,t){return e=n(e)+"",1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(c,"")),e};t.exports=u},{112:112,28:28,33:33,35:35}],112:[function(e,t){t.exports="\t\n\x0B\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF"},{}],113:[function(e,t){var r=e(25),n=e(46),a=e(43),o=e(30),i=e(40),l=i.process,s=i.setImmediate,c=i.clearImmediate,u=i.MessageChannel,d=i.Dispatch,p=0,m={},f="onreadystatechange",g=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},h=function(e){g.call(e.data)},v,x,y;s&&c||(s=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++p]=function(){n("function"==typeof e?e:Function(e),t)},v(p),p},c=function(e){delete m[e]},"process"==e(18)(l)?v=function(e){l.nextTick(r(g,e,1))}:d&&d.now?v=function(e){d.now(r(g,e,1))}:u?(x=new u,y=x.port2,x.port1.onmessage=h,v=r(y.postMessage,y,1)):i.addEventListener&&"function"==typeof postMessage&&!i.importScripts?(v=function(e){i.postMessage(e+"","*")},i.addEventListener("message",h,!1)):f in o("script")?v=function(e){a.appendChild(o("script"))[f]=function(){a.removeChild(this),g.call(e)}}:v=function(e){setTimeout(r(g,e,1),0)}),t.exports={set:s,clear:c}},{18:18,25:25,30:30,40:40,43:43,46:46}],114:[function(e,t){var r=e(116);t.exports=function(e,t){return e=r(e),0>e?ht(e+t,0):Et(e,t)}},{116:116}],115:[function(e,t){var r=e(116),n=e(118);t.exports=function(e){if(e===void 0)return 0;var t=r(e),a=n(t);if(t!==a)throw RangeError("Wrong length!");return a}},{116:116,118:118}],116:[function(e,t){t.exports=function(e){return isNaN(e=+e)?0:(0<e?Tt:vt)(e)}},{}],117:[function(e,t){var r=e(47),n=e(28);t.exports=function(e){return r(n(e))}},{28:28,47:47}],118:[function(e,t){var r=e(116);t.exports=function(e){return 0<e?Et(r(e),9007199254740991):0}},{116:116}],119:[function(e,t){var r=e(28);t.exports=function(e){return Object(r(e))}},{28:28}],120:[function(e,t){var r=e(51);t.exports=function(e,t){if(!r(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!r(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},{51:51}],121:[function(e,t){if(e(29)){var r=e(60),n=e(40),a=e(35),o=e(33),i=e(123),l=e(122),s=e(25),c=e(6),u=e(92),d=e(42),p=e(93),m=e(116),f=e(118),g=e(115),h=e(114),v=e(120),x=e(41),y=e(17),b=e(51),_=e(119),T=e(48),S=e(71),E=e(79),w=e(77).f,k=e(129),A=e(124),N=e(128),P=e(12),I=e(11),F=e(104),M=e(141),C=e(58),R=e(56),L=e(100),D=e(9),O=e(8),G=e(72),U=e(75),B=G.f,V=U.f,H=n.RangeError,z=n.TypeError,W=n.Uint8Array,j="ArrayBuffer",X="Shared"+j,Y="BYTES_PER_ELEMENT",q="prototype",K=Array[q],Q=l.ArrayBuffer,J=l.DataView,Z=P(0),$=P(2),ee=P(3),te=P(4),re=P(5),ne=P(6),ae=I(!0),oe=I(!1),ie=M.values,le=M.keys,se=M.entries,ce=K.lastIndexOf,ue=K.reduce,de=K.reduceRight,pe=K.join,me=K.sort,fe=K.slice,ge=K.toString,he=K.toLocaleString,ve=N("iterator"),xe=N("toStringTag"),ye=A("typed_constructor"),be=A("def_constructor"),_e=i.CONSTR,Te=i.TYPED,Se=i.VIEW,Ee="Wrong length!",we=P(1,function(e,t){return Ie(F(e,e[be]),t)}),ke=a(function(){return 1===new W(new Uint16Array([1]).buffer)[0]}),Ae=!!W&&!!W[q].set&&a(function(){new W(1).set({})}),Ne=function(e,t){var r=m(e);if(0>r||r%t)throw H("Wrong offset!");return r},Pe=function(e){if(b(e)&&Te in e)return e;throw z(e+" is not a typed array!")},Ie=function(e,t){if(!(b(e)&&ye in e))throw z("It is not a typed array constructor!");return new e(t)},Fe=function(e,t){return Me(F(e,e[be]),t)},Me=function(e,t){for(var r=0,n=t.length,a=Ie(e,n);n>r;)a[r]=t[r++];return a},Ce=function(e,t,r){B(e,t,{get:function(){return this._d[r]}})},Re=function(e){var t=_(e),r=arguments.length,n=1<r?arguments[1]:void 0,a=n!==void 0,o=k(t),l,c,u,d,p,m;if(o!=null&&!T(o)){for(m=o.call(t),u=[],l=0;!(p=m.next()).done;l++)u.push(p.value);t=u}for(a&&2<r&&(n=s(n,arguments[2],2)),l=0,c=f(t.length),d=Ie(this,c);c>l;l++)d[l]=a?n(t[l],l):t[l];return d},Le=function(){for(var e=0,t=arguments.length,r=Ie(this,t);t>e;)r[e]=arguments[e++];return r},De=!!W&&a(function(){he.call(new W(1))}),Oe=function(){return he.apply(De?fe.call(Pe(this)):Pe(this),arguments)},Ge={copyWithin:function(e,t){return O.call(Pe(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return te(Pe(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(){return D.apply(Pe(this),arguments)},filter:function(e){return Fe(this,$(Pe(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return re(Pe(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return ne(Pe(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){Z(Pe(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return oe(Pe(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ae(Pe(this),e,1<arguments.length?arguments[1]:void 0)},join:function(){return pe.apply(Pe(this),arguments)},lastIndexOf:function(){return ce.apply(Pe(this),arguments)},map:function(e){return we(Pe(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(){return ue.apply(Pe(this),arguments)},reduceRight:function(){return de.apply(Pe(this),arguments)},reverse:function(){for(var e=this,t=Pe(e).length,r=Tt(t/2),n=0,a;n<r;)a=e[n],e[n++]=e[--t],e[t]=a;return e},some:function(e){return ee(Pe(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return me.call(Pe(this),e)},subarray:function(e,t){var r=Pe(this),n=r.length,a=h(e,n);return new(F(r,r[be]))(r.buffer,r.byteOffset+a*r.BYTES_PER_ELEMENT,f((t===void 0?n:h(t,n))-a))}},Ue=function(e,t){return Fe(this,fe.call(Pe(this),e,t))},Be=function(e){Pe(this);var t=Ne(arguments[1],1),r=this.length,n=_(e),a=f(n.length),o=0;if(a+t>r)throw H(Ee);for(;o<a;)this[t+o]=n[o++]},Ve={entries:function(){return se.call(Pe(this))},keys:function(){return le.call(Pe(this))},values:function(){return ie.call(Pe(this))}},He=function(e,t){return b(e)&&e[Te]&&"symbol"!=("undefined"==typeof t?"undefined":wt(t))&&t in e&&+t+""==t+""},ze=function(e,t){return He(e,t=v(t,!0))?u(2,e[t]):V(e,t)},We=function(e,t,r){return He(e,t=v(t,!0))&&b(r)&&x(r,"value")&&!x(r,"get")&&!x(r,"set")&&!r.configurable&&(!x(r,"writable")||r.writable)&&(!x(r,"enumerable")||r.enumerable)?(e[t]=r.value,e):B(e,t,r)};_e||(U.f=ze,G.f=We),o(o.S+o.F*!_e,"Object",{getOwnPropertyDescriptor:ze,defineProperty:We}),a(function(){ge.call({})})&&(ge=he=function(){return pe.call(this)});var je=p({},Ge);p(je,Ve),d(je,ve,Ve.values),p(je,{slice:Ue,set:Be,constructor:function(){},toString:ge,toLocaleString:Oe}),Ce(je,"buffer","b"),Ce(je,"byteOffset","o"),Ce(je,"byteLength","l"),Ce(je,"length","e"),B(je,xe,{get:function(){return this[Te]}}),t.exports=function(e,t,l,s){s=!!s;var u=e+(s?"Clamped":"")+"Array",p=n[u],m=p||{},h=p&&E(p),v=!p||!i.ABV,x={},_=p&&p[q],T=function(r,n){var a=r._d;return a.v["get"+e](n*t+a.o,ke)},k=function(r,n,a){var o=r._d;s&&(a=0>(a=gt(a))?0:255<a?255:255&a),o.v["set"+e](n*t+o.o,a,ke)},A=function(e,t){B(e,t,{get:function(){return T(this,t)},set:function(e){return k(this,t,e)},enumerable:!0})};v?(p=l(function(e,r,n,a){c(e,p,u,"_d");var o=0,i=0,l,s,m,h;if(!b(r))m=g(r),s=m*t,l=new Q(s);else if(r instanceof Q||(h=y(r))==j||h==X){l=r,i=Ne(n,t);var v=r.byteLength;if(void 0===a){if(v%t)throw H(Ee);if(s=v-i,0>s)throw H(Ee)}else if(s=f(a)*t,s+i>v)throw H(Ee);m=s/t}else return Te in r?Me(p,r):Re.call(p,r);for(d(e,"_d",{b:l,o:i,l:s,e:m,v:new J(l)});o<m;)A(e,o++)}),_=p[q]=S(je),d(_,"constructor",p)):(!a(function(){p(1)})||!a(function(){new p(-1)})||!R(function(e){new p,new p(null),new p(1.5),new p(e)},!0))&&(p=l(function(e,r,n,a){c(e,p,u);var o;return b(r)?r instanceof Q||(o=y(r))==j||o==X?void 0===a?void 0===n?new m(r):new m(r,Ne(n,t)):new m(r,Ne(n,t),a):Te in r?Me(p,r):Re.call(p,r):new m(g(r))}),Z(h===Function.prototype?w(m):w(m).concat(w(h)),function(e){e in p||d(p,e,m[e])}),p[q]=_,!r&&(_.constructor=p));var N=_[ve],P=!!N&&("values"==N.name||N.name==null),I=Ve.values;d(p,ye,!0),d(_,Te,u),d(_,Se,!0),d(_,be,p),(s?new p(1)[xe]!=u:!(xe in _))&&B(_,xe,{get:function(){return u}}),x[u]=p,o(o.G+o.W+o.F*(p!=m),x),o(o.S,u,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*a(function(){m.of.call(p,1)}),u,{from:Re,of:Le}),Y in _||d(_,Y,t),o(o.P,u,Ge),L(u),o(o.P+o.F*Ae,u,{set:Be}),o(o.P+o.F*!P,u,Ve),r||_.toString==ge||(_.toString=ge),o(o.P+o.F*a(function(){new p(1).slice()}),u,{slice:Ue}),o(o.P+o.F*(a(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!a(function(){_.toLocaleString.call([1,2])})),u,{toLocaleString:Oe}),C[u]=P?N:I,r||P||d(_,ve,I)}}else t.exports=function(){}},{100:100,104:104,11:11,114:114,115:115,116:116,118:118,119:119,12:12,120:120,122:122,123:123,124:124,128:128,129:129,141:141,17:17,25:25,29:29,33:33,35:35,40:40,41:41,42:42,48:48,51:51,56:56,58:58,6:6,60:60,71:71,72:72,75:75,77:77,79:79,8:8,9:9,92:92,93:93}],122:[function(e,t,r){function n(t,r,n){var a=Array(n),o=8*n-r-1,l=(1<<o)-1,u=l>>1,d=23===r?U(2,-24)-U(2,-77):0,p=0,f=0>t||0===t&&0>1/t?1:0,s,g,h;for(t=G(t),t!=t||t===D?(g=t==t?0:1,s=l):(s=B(V(t)/H),1>t*(h=U(2,-s))&&(s--,h*=2),t+=1<=s+u?d/h:d*U(2,1-u),2<=t*h&&(s++,h/=2),s+u>=l?(g=0,s=l):1<=s+u?(g=(t*h-1)*U(2,r),s+=u):(g=t*U(2,u-1)*U(2,r),s=0));8<=r;a[p++]=255&g,g/=256,r-=8);for(s=s<<r|g,o+=r;0<o;a[p++]=255&s,s/=256,o-=8);return a[--p]|=128*f,a}function a(t,r,n){var a=8*n-r-1,o=(1<<a)-1,l=o>>1,c=a-7,u=n-1,d=t[u--],p=127&d,f;for(d>>=7;0<c;p=256*p+t[u],u--,c-=8);for(f=p&(1<<-c)-1,p>>=-c,c+=r;0<c;f=256*f+t[u],u--,c-=8);if(0===p)p=1-l;else{if(p===o)return f?NaN:d?-D:D;f+=U(2,r),p-=l}return(d?-1:1)*f*U(2,p-r)}function o(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function i(e){return[255&e]}function l(e){return[255&e,255&e>>8]}function s(e){return[255&e,255&e>>8,255&e>>16,255&e>>24]}function c(e){return n(e,52,8)}function u(e){return n(e,23,4)}function d(e,t,r){k(e.prototype,t,{get:function(){return this[r]}})}function p(e,t,r,n){var a=E(+r);if(a+t>e[q])throw L("Wrong index!");var o=e[Y]._b,i=a+e[K],l=o.slice(i,i+t);return n?l:l.reverse()}function m(e,t,r,n,a,o){var l=E(+r);if(l+t>e[q])throw L("Wrong index!");for(var s=e[Y]._b,c=l+e[K],u=n(+a),d=0;d<t;d++)s[c+d]=u[o?d:t-d-1]}var f=e(40),g=e(29),h=e(60),v=e(123),x=e(42),y=e(93),b=e(35),_=e(6),T=e(116),S=e(118),E=e(115),w=e(77).f,k=e(72).f,A=e(9),N=e(101),P="ArrayBuffer",I="DataView",F="prototype",M=f[P],C=f[I],R=f.Math,L=f.RangeError,D=f.Infinity,O=M,G=St,U=yt,B=Tt,V=xt,H=ft,z="buffer",W="byteLength",X="byteOffset",Y=g?"_b":z,q=g?"_l":W,K=g?"_o":X;if(!v.ABV)M=function(e){_(this,M,P);var t=E(e);this._b=A.call(Array(t),0),this[q]=t},C=function(e,t,r){_(this,C,I),_(e,M,I);var n=e[q],a=T(t);if(0>a||a>n)throw L("Wrong offset!");if(r=void 0===r?n-a:S(r),a+r>n)throw L("Wrong length!");this[Y]=e,this[K]=a,this[q]=r},g&&(d(M,W,"_l"),d(C,z,"_b"),d(C,W,"_l"),d(C,X,"_o")),y(C[F],{getInt8:function(e){return p(this,1,e)[0]<<24>>24},getUint8:function(e){return p(this,1,e)[0]},getInt16:function(e){var t=p(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=p(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return o(p(this,4,e,arguments[1]))},getUint32:function(e){return o(p(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return a(p(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return a(p(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){m(this,1,e,i,t)},setUint8:function(e,t){m(this,1,e,i,t)},setInt16:function(e,t){m(this,2,e,l,t,arguments[2])},setUint16:function(e,t){m(this,2,e,l,t,arguments[2])},setInt32:function(e,t){m(this,4,e,s,t,arguments[2])},setUint32:function(e,t){m(this,4,e,s,t,arguments[2])},setFloat32:function(e,t){m(this,4,e,u,t,arguments[2])},setFloat64:function(e,t){m(this,8,e,c,t,arguments[2])}});else{if(!b(function(){M(1)})||!b(function(){new M(-1)})||b(function(){return new M,new M(1.5),new M(NaN),M.name!=P})){M=function(e){return _(this,M),new O(E(e))};for(var Q=M[F]=O[F],J=w(O),Z=0,$;J.length>Z;)($=J[Z++])in M||x(M,$,O[$]);h||(Q.constructor=M)}var ee=new C(new M(2)),te=C[F].setInt8;ee.setInt8(0,2147483648),ee.setInt8(1,2147483649),(ee.getInt8(0)||!ee.getInt8(1))&&y(C[F],{setInt8:function(e,t){te.call(this,e,t<<24>>24)},setUint8:function(e,t){te.call(this,e,t<<24>>24)}},!0)}N(M,P),N(C,I),x(C[F],v.VIEW,!0),r[P]=M,r[I]=C},{101:101,115:115,116:116,118:118,123:123,29:29,35:35,40:40,42:42,6:6,60:60,72:72,77:77,9:9,93:93}],123:[function(e,t){for(var r=e(40),n=e(42),a=e(124),o=a("typed_array"),l=a("view"),s=!!(r.ArrayBuffer&&r.DataView),c=s,u=0,d=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"],p;u<9;)(p=r[d[u++]])?(n(p.prototype,o,!0),n(p.prototype,l,!0)):c=!1;t.exports={ABV:s,CONSTR:c,TYPED:o,VIEW:l}},{124:124,40:40,42:42}],124:[function(e,t){var r=0,n=Math.random();t.exports=function(e){return"Symbol(".concat(e===void 0?"":e,")_",(++r+n).toString(36))}},{}],125:[function(e,t){var r=e(51);t.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},{51:51}],126:[function(e,t){var r=e(40),n=e(23),a=e(60),o=e(127),i=e(72).f;t.exports=function(e){var t=n.Symbol||(n.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||i(t,e,{value:o.f(e)})}},{127:127,23:23,40:40,60:60,72:72}],127:[function(e,t,r){r.f=e(128)},{128:128}],128:[function(e,t){var r=e(103)("wks"),n=e(124),a=e(40).Symbol,o="function"==typeof a,i=t.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:n)("Symbol."+e))};i.store=r},{103:103,124:124,40:40}],129:[function(e,t){var r=e(17),n=e(128)("iterator"),a=e(58);t.exports=e(23).getIteratorMethod=function(e){if(e!=null)return e[n]||e["@@iterator"]||a[r(e)]}},{128:128,17:17,23:23,58:58}],130:[function(e){var t=e(33),r=e(95)(/[\\^$*+?.()|[\]{}]/g,"\\$&");t(t.S,"RegExp",{escape:function(e){return r(e)}})},{33:33,95:95}],131:[function(e){var t=e(33);t(t.P,"Array",{copyWithin:e(8)}),e(5)("copyWithin")},{33:33,5:5,8:8}],132:[function(e){var t=e(33),r=e(12)(4);t(t.P+t.F*!e(105)([].every,!0),"Array",{every:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],133:[function(e){var t=e(33);t(t.P,"Array",{fill:e(9)}),e(5)("fill")},{33:33,5:5,9:9}],134:[function(e){var t=e(33),r=e(12)(2);t(t.P+t.F*!e(105)([].filter,!0),"Array",{filter:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],135:[function(e){var t=e(33),r=e(12)(6),n="findIndex",a=!0;n in[]&&[,][n](function(){a=!1}),t(t.P+t.F*a,"Array",{findIndex:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)(n)},{12:12,33:33,5:5}],136:[function(e){var t=e(33),r=e(12)(5),n="find",a=!0;n in[]&&[,][n](function(){a=!1}),t(t.P+t.F*a,"Array",{find:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)(n)},{12:12,33:33,5:5}],137:[function(e){var t=e(33),r=e(12)(0),n=e(105)([].forEach,!0);t(t.P+t.F*!n,"Array",{forEach:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],138:[function(e){var t=e(25),r=e(33),n=e(119),a=e(53),o=e(48),i=e(118),l=e(24),s=e(129);r(r.S+r.F*!e(56)(function(){}),"Array",{from:function(e){var r=n(e),c="function"==typeof this?this:Array,u=arguments.length,d=1<u?arguments[1]:void 0,p=void 0!==d,m=0,f=s(r),g,h,v,x;if(p&&(d=t(d,2<u?arguments[2]:void 0,2)),null!=f&&!(c==Array&&o(f)))for(x=f.call(r),h=new c;!(v=x.next()).done;m++)l(h,m,p?a(x,d,[v.value,m],!0):v.value);else for(g=i(r.length),h=new c(g);g>m;m++)l(h,m,p?d(r[m],m):r[m]);return h.length=m,h}})},{118:118,119:119,129:129,24:24,25:25,33:33,48:48,53:53,56:56}],139:[function(e){var t=e(33),r=e(11)(!1),n=[].indexOf,a=!!n&&0>1/[1].indexOf(1,-0);t(t.P+t.F*(a||!e(105)(n)),"Array",{indexOf:function(e){return a?n.apply(this,arguments)||0:r(this,e,arguments[1])}})},{105:105,11:11,33:33}],140:[function(e){var t=e(33);t(t.S,"Array",{isArray:e(49)})},{33:33,49:49}],141:[function(e,t){var r=e(5),n=e(57),a=e(58),o=e(117);t.exports=e(55)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,n(1)):"keys"==t?n(0,r):"values"==t?n(0,e[r]):n(0,[r,e[r]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},{117:117,5:5,55:55,57:57,58:58}],142:[function(e){var t=e(33),r=e(117),n=[].join;t(t.P+t.F*(e(47)!=Object||!e(105)(n)),"Array",{join:function(e){return n.call(r(this),e===void 0?",":e)}})},{105:105,117:117,33:33,47:47}],143:[function(e){var t=e(33),r=e(117),n=e(116),a=e(118),o=[].lastIndexOf,i=!!o&&0>1/[1].lastIndexOf(1,-0);t(t.P+t.F*(i||!e(105)(o)),"Array",{lastIndexOf:function(e){if(i)return o.apply(this,arguments)||0;var t=r(this),l=a(t.length),s=l-1;for(1<arguments.length&&(s=Et(s,n(arguments[1]))),0>s&&(s=l+s);0<=s;s--)if(s in t&&t[s]===e)return s||0;return-1}})},{105:105,116:116,117:117,118:118,33:33}],144:[function(e){var t=e(33),r=e(12)(1);t(t.P+t.F*!e(105)([].map,!0),"Array",{map:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],145:[function(e){var t=e(33),r=e(24);t(t.S+t.F*e(35)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)r(n,e,arguments[e++]);return n.length=t,n}})},{24:24,33:33,35:35}],146:[function(e){var t=e(33),r=e(13);t(t.P+t.F*!e(105)([].reduceRight,!0),"Array",{reduceRight:function(e){return r(this,e,arguments.length,arguments[1],!0)}})},{105:105,13:13,33:33}],147:[function(e){var t=e(33),r=e(13);t(t.P+t.F*!e(105)([].reduce,!0),"Array",{reduce:function(e){return r(this,e,arguments.length,arguments[1],!1)}})},{105:105,13:13,33:33}],148:[function(e){var t=e(33),r=e(43),n=e(18),a=e(114),o=e(118),l=[].slice;t(t.P+t.F*e(35)(function(){r&&l.call(r)}),"Array",{slice:function(e,t){var r=o(this.length),s=n(this);if(t=void 0===t?r:t,"Array"==s)return l.call(this,e,t);for(var c=a(e,r),u=a(t,r),d=o(u-c),p=Array(d),m=0;m<d;m++)p[m]="String"==s?this.charAt(c+m):this[c+m];return p}})},{114:114,118:118,18:18,33:33,35:35,43:43}],149:[function(e){var t=e(33),r=e(12)(3);t(t.P+t.F*!e(105)([].some,!0),"Array",{some:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],150:[function(e){var t=e(33),r=e(3),n=e(119),a=e(35),o=[].sort,i=[1,2,3];t(t.P+t.F*(a(function(){i.sort(void 0)})||!a(function(){i.sort(null)})||!e(105)(o)),"Array",{sort:function(e){return e===void 0?o.call(n(this)):o.call(n(this),r(e))}})},{105:105,119:119,3:3,33:33,35:35}],151:[function(e){e(100)("Array")},{100:100}],152:[function(e){var t=e(33);t(t.S,"Date",{now:function(){return new Date().getTime()}})},{33:33}],153:[function(e){var t=e(33),r=e(26);t(t.P+t.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},{26:26,33:33}],154:[function(e){var t=e(33),r=e(119),n=e(120);t(t.P+t.F*e(35)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(){var e=r(this),t=n(e);return"number"!=typeof t||isFinite(t)?e.toISOString():null}})},{119:119,120:120,33:33,35:35}],155:[function(e){var t=e(128)("toPrimitive"),r=Date.prototype;t in r||e(42)(r,t,e(27))},{128:128,27:27,42:42}],156:[function(e){var t=Date.prototype,r="Invalid Date",n="toString",a=t[n],o=t.getTime;new Date(NaN)+""!=r&&e(94)(t,n,function(){var e=o.call(this);return e===e?a.call(this):r})},{94:94}],157:[function(e){var t=e(33);t(t.P,"Function",{bind:e(16)})},{16:16,33:33}],158:[function(e){var t=e(51),r=e(79),n=e(128)("hasInstance"),a=Function.prototype;n in a||e(72).f(a,n,{value:function(e){if("function"!=typeof this||!t(e))return!1;if(!t(this.prototype))return e instanceof this;for(;e=r(e);)if(this.prototype===e)return!0;return!1}})},{128:128,51:51,72:72,79:79}],159:[function(e){var t=e(72).f,r=Function.prototype,n=/^\s*function ([^ (]*)/,a="name";a in r||e(29)&&t(r,a,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},{29:29,72:72}],160:[function(e,t){var r=e(19),n=e(125),a="Map";t.exports=e(22)(a,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(n(this,a),e);return t&&t.v},set:function(e,t){return r.def(n(this,a),0===e?0:e,t)}},r,!0)},{125:125,19:19,22:22}],161:[function(e){var t=e(33),r=e(63),n=mt,a=Math.acosh;t(t.S+t.F*!(a&&710==Tt(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return 1>(e=+e)?NaN:94906265.62425156<e?xt(e)+ft:r(e-1+n(e-1)*n(e+1))}})},{33:33,63:63}],162:[function(e){function t(e){return isFinite(e=+e)&&0!=e?0>e?-t(-e):xt(e+mt(e*e+1)):e}var r=e(33),n=Math.asinh;r(r.S+r.F*!(n&&0<1/n(0)),"Math",{asinh:t})},{33:33}],163:[function(e){var t=e(33),r=Math.atanh;t(t.S+t.F*!(r&&0>1/r(-0)),"Math",{atanh:function(e){return 0==(e=+e)?e:xt((1+e)/(1-e))/2}})},{33:33}],164:[function(e){var t=e(33),r=e(65);t(t.S,"Math",{cbrt:function(e){return r(e=+e)*yt(St(e),1/3)}})},{33:33,65:65}],165:[function(e){var t=e(33);t(t.S,"Math",{clz32:function(e){return(e>>>=0)?31-Tt(xt(e+.5)*Math.LOG2E):32}})},{33:33}],166:[function(e){var t=e(33),r=bt;t(t.S,"Math",{cosh:function(e){return(r(e=+e)+r(-e))/2}})},{33:33}],167:[function(e){var t=e(33),r=e(61);t(t.S+t.F*(r!=_t),"Math",{expm1:r})},{33:33,61:61}],168:[function(e){var t=e(33);t(t.S,"Math",{fround:e(62)})},{33:33,62:62}],169:[function(e){var t=e(33);t(t.S,"Math",{hypot:function(){for(var e=0,t=0,r=arguments.length,n=0,a,o;t<r;)a=St(arguments[t++]),n<a?(o=n/a,e=e*o*o+1,n=a):0<a?(o=a/n,e+=o*o):e+=a;return n===1/0?1/0:n*mt(e)}})},{33:33}],170:[function(e){var t=e(33),r=Math.imul;t(t.S+t.F*e(35)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(e,t){var r=+e,n=+t,a=65535&r,o=65535&n;return 0|a*o+((65535&r>>>16)*o+a*(65535&n>>>16)<<16>>>0)}})},{33:33,35:35}],171:[function(e){var t=e(33);t(t.S,"Math",{log10:function(e){return xt(e)*Math.LOG10E}})},{33:33}],172:[function(e){var t=e(33);t(t.S,"Math",{log1p:e(63)})},{33:33,63:63}],173:[function(e){var t=e(33);t(t.S,"Math",{log2:function(e){return xt(e)/ft}})},{33:33}],174:[function(e){var t=e(33);t(t.S,"Math",{sign:e(65)})},{33:33,65:65}],175:[function(e){var t=e(33),r=e(61),n=bt;t(t.S+t.F*e(35)(function(){return!0}),"Math",{sinh:function(e){return 1>St(e=+e)?(r(e)-r(-e))/2:(n(e-1)-n(-e-1))*(Math.E/2)}})},{33:33,35:35,61:61}],176:[function(e){var t=e(33),r=e(61),n=bt;t(t.S,"Math",{tanh:function(e){var t=r(e=+e),a=r(-e);return t==1/0?1:a==1/0?-1:(t-a)/(n(e)+n(-e))}})},{33:33,61:61}],177:[function(e){var t=e(33);t(t.S,"Math",{trunc:function(e){return(0<e?Tt:vt)(e)}})},{33:33}],178:[function(e){var t=e(40),r=e(41),n=e(18),a=e(45),o=e(120),i=e(35),l=e(77).f,s=e(75).f,c=e(72).f,u=e(111).trim,d="Number",p=t[d],m=p,f=p.prototype,g=n(e(71)(f))==d,h="trim"in String.prototype,v=function(e){var t=o(e,!1);if("string"==typeof t&&2<t.length){t=h?t.trim():u(t,3);var r=t.charCodeAt(0),n,a,s;if(43===r||45===r){if(n=t.charCodeAt(2),88===n||120===n)return NaN;}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:a=2,s=49;break;case 79:case 111:a=8,s=55;break;default:return+t;}for(var c=t.slice(2),d=0,p=c.length,l;d<p;d++)if(l=c.charCodeAt(d),48>l||l>s)return NaN;return parseInt(c,a)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=1>arguments.length?0:e,r=this;return r instanceof p&&(g?i(function(){f.valueOf.call(r)}):n(r)!=d)?a(new m(v(t)),r,p):v(t)};for(var x=e(29)?l(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),y=0,b;x.length>y;y++)r(m,b=x[y])&&!r(p,b)&&c(p,b,s(m,b));p.prototype=f,f.constructor=p,e(94)(t,d,p)}},{111:111,120:120,18:18,29:29,35:35,40:40,41:41,45:45,71:71,72:72,75:75,77:77,94:94}],179:[function(e){var t=e(33);t(t.S,"Number",{EPSILON:2.220446049250313e-16})},{33:33}],180:[function(e){var t=e(33),r=e(40).isFinite;t(t.S,"Number",{isFinite:function(e){return"number"==typeof e&&r(e)}})},{33:33,40:40}],181:[function(e){var t=e(33);t(t.S,"Number",{isInteger:e(50)})},{33:33,50:50}],182:[function(e){var t=e(33);t(t.S,"Number",{isNaN:function(e){return e!=e}})},{33:33}],183:[function(e){var t=e(33),r=e(50);t(t.S,"Number",{isSafeInteger:function(e){return r(e)&&9007199254740991>=St(e)}})},{33:33,50:50}],184:[function(e){var t=e(33);t(t.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{33:33}],185:[function(e){var t=e(33);t(t.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{33:33}],186:[function(e){var t=e(33),r=e(86);t(t.S+t.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},{33:33,86:86}],187:[function(e){var t=e(33),r=e(87);t(t.S+t.F*(Number.parseInt!=r),"Number",{parseInt:r})},{33:33,87:87}],188:[function(e){var t=e(33),r=e(116),n=e(4),a=e(110),o=1 .toFixed,l=Tt,u=[0,0,0,0,0,0],i="Number.toFixed: incorrect invocation!",c="0",d=function(e,t){for(var r=-1,n=t;6>++r;)n+=e*u[r],u[r]=n%1e7,n=l(n/1e7)},s=function(e){for(var t=6,r=0;0<=--t;)r+=u[t],u[t]=l(r/e),r=1e7*(r%e)},p=function(){for(var e=6,r="";0<=--e;)if(""!==r||0===e||0!==u[e]){var n=u[e]+"";r=""===r?n:r+a.call(c,7-n.length)+n}return r},g=function e(t,r,n){return 0===r?n:1==r%2?e(t,r-1,n*t):e(t*t,r/2,n)},h=function(e){for(var t=0,r=e;4096<=r;)t+=12,r/=4096;for(;2<=r;)t+=1,r/=2;return t};t(t.P+t.F*(!!o&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==1000000000000000100 .toFixed(0))||!e(35)(function(){o.call({})})),"Number",{toFixed:function(t){var o=n(this,i),l=r(t),u="",f=c,v,y,b,_;if(0>l||20<l)throw RangeError(i);if(o!=o)return"NaN";if(-1e21>=o||1e21<=o)return o+"";if(0>o&&(u="-",o=-o),1e-21<o)if(v=h(o*g(2,69,1))-69,y=0>v?o*g(2,-v,1):o/g(2,v,1),y*=4503599627370496,v=52-v,0<v){for(d(0,y),b=l;7<=b;)d(1e7,0),b-=7;for(d(g(10,b,1),0),b=v-1;23<=b;)s(8388608),b-=23;s(1<<b),d(1,1),s(2),f=p()}else d(0,y),d(1<<-v,0),f=p()+a.call(c,l);return 0<l?(_=f.length,f=u+(_<=l?"0."+a.call(c,l-_)+f:f.slice(0,_-l)+"."+f.slice(_-l))):f=u+f,f}})},{110:110,116:116,33:33,35:35,4:4}],189:[function(e){var t=e(33),r=e(35),n=e(4),a=1 .toPrecision;t(t.P+t.F*(r(function(){return"1"!==a.call(1,void 0)})||!r(function(){a.call({})})),"Number",{toPrecision:function(e){var t=n(this,"Number#toPrecision: incorrect invocation!");return e===void 0?a.call(t):a.call(t,e)}})},{33:33,35:35,4:4}],190:[function(e){var t=e(33);t(t.S+t.F,"Object",{assign:e(70)})},{33:33,70:70}],191:[function(e){var t=e(33);t(t.S,"Object",{create:e(71)})},{33:33,71:71}],192:[function(e){var t=e(33);t(t.S+t.F*!e(29),"Object",{defineProperties:e(73)})},{29:29,33:33,73:73}],193:[function(e){var t=e(33);t(t.S+t.F*!e(29),"Object",{defineProperty:e(72).f})},{29:29,33:33,72:72}],194:[function(e){var t=e(51),r=e(66).onFreeze;e(83)("freeze",function(e){return function(n){return e&&t(n)?e(r(n)):n}})},{51:51,66:66,83:83}],195:[function(e){var t=e(117),r=e(75).f;e(83)("getOwnPropertyDescriptor",function(){return function(e,n){return r(t(e),n)}})},{117:117,75:75,83:83}],196:[function(e){e(83)("getOwnPropertyNames",function(){return e(76).f})},{76:76,83:83}],197:[function(e){var t=e(119),r=e(79);e(83)("getPrototypeOf",function(){return function(e){return r(t(e))}})},{119:119,79:79,83:83}],198:[function(e){var t=e(51);e(83)("isExtensible",function(e){return function(r){return!!t(r)&&(!e||e(r))}})},{51:51,83:83}],199:[function(e){var t=e(51);e(83)("isFrozen",function(e){return function(r){return!t(r)||!!e&&e(r)}})},{51:51,83:83}],200:[function(e){var t=e(51);e(83)("isSealed",function(e){return function(r){return!t(r)||!!e&&e(r)}})},{51:51,83:83}],201:[function(e){var t=e(33);t(t.S,"Object",{is:e(96)})},{33:33,96:96}],202:[function(e){var t=e(119),r=e(81);e(83)("keys",function(){return function(e){return r(t(e))}})},{119:119,81:81,83:83}],203:[function(e){var t=e(51),r=e(66).onFreeze;e(83)("preventExtensions",function(e){return function(n){return e&&t(n)?e(r(n)):n}})},{51:51,66:66,83:83}],204:[function(e){var t=e(51),r=e(66).onFreeze;e(83)("seal",function(e){return function(n){return e&&t(n)?e(r(n)):n}})},{51:51,66:66,83:83}],205:[function(e){var t=e(33);t(t.S,"Object",{setPrototypeOf:e(99).set})},{33:33,99:99}],206:[function(e){var t=e(17),r={};r[e(128)("toStringTag")]="z","[object z]"!=r+""&&e(94)(Object.prototype,"toString",function(){return"[object "+t(this)+"]"},!0)},{128:128,17:17,94:94}],207:[function(e){var t=e(33),r=e(86);t(t.G+t.F*(parseFloat!=r),{parseFloat:r})},{33:33,86:86}],208:[function(e){var t=e(33),r=e(87);t(t.G+t.F*(parseInt!=r),{parseInt:r})},{33:33,87:87}],209:[function(e){var t=e(60),r=e(40),n=e(25),a=e(17),o=e(33),i=e(51),l=e(3),s=e(6),c=e(39),u=e(104),d=e(113).set,p=e(68)(),m=e(69),f=e(90),g=e(91),h="Promise",v=r.TypeError,x=r.process,y=r[h],b="process"==a(x),_=function(){},T=R=m.f,S=!!function(){try{var t=y.resolve(1),r=(t.constructor={})[e(128)("species")]=function(e){e(_,_)};return(b||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof r}catch(t){}}(),E=t?function(e,t){return e===t||e===y&&t===C}:function(e,t){return e===t},w=function(e){var t;return!!(i(e)&&"function"==typeof(t=e.then))&&t},k=function(e,t){if(!e._n){e._n=!0;var r=e._c;p(function(){for(var n=e._v,a=1==e._s,o=0,l=function(t){var r=a?t.ok:t.fail,o=t.resolve,i=t.reject,l=t.domain,s,c;try{r?(!a&&(2==e._h&&P(e),e._h=1),!0===r?s=n:(l&&l.enter(),s=r(n),l&&l.exit()),s===t.promise?i(v("Promise-chain cycle")):(c=w(s))?c.call(s,o,i):o(s)):i(n)}catch(t){i(t)}};r.length>o;)l(r[o++]);e._c=[],e._n=!1,t&&!e._h&&A(e)})}},A=function(e){d.call(r,function(){var t=e._v,n=N(e),a,o,i;if(n&&(a=f(function(){b?x.emit("unhandledRejection",t,e):(o=r.onunhandledrejection)?o({promise:e,reason:t}):(i=r.console)&&i.error&&i.error("Unhandled promise rejection",t)}),e._h=b||N(e)?2:1),e._a=void 0,n&&a.e)throw a.v})},N=function e(t){if(1==t._h)return!1;for(var r=t._a||t._c,n=0,a;r.length>n;)if(a=r[n++],a.fail||!e(a.promise))return!1;return!0},P=function(e){d.call(r,function(){var t;b?x.emit("rejectionHandled",e):(t=r.onrejectionhandled)&&t({promise:e,reason:e._v})})},I=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,!t._a&&(t._a=t._c.slice()),k(t,!0))},F=function e(t){var r=this,a;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw v("Promise can't be resolved itself");(a=w(t))?p(function(){var o={_w:r,_d:!1};try{a.call(t,n(e,o,1),n(I,o,1))}catch(t){I.call(o,t)}}):(r._v=t,r._s=1,k(r,!1))}catch(t){I.call({_w:r,_d:!1},t)}}},M,R,L,C;S||(y=function(e){s(this,y,h,"_h"),l(e),M.call(this);try{e(n(F,this,1),n(I,this,1))}catch(e){I.call(this,e)}},M=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},M.prototype=e(93)(y.prototype,{then:function(e,t){var r=T(u(this,y));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=b?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&k(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),L=function(){var e=new M;this.promise=e,this.resolve=n(F,e,1),this.reject=n(I,e,1)},m.f=T=function(e){return E(y,e)?new L(e):R(e)}),o(o.G+o.W+o.F*!S,{Promise:y}),e(101)(y,h),e(100)(h),C=e(23)[h],o(o.S+o.F*!S,h,{reject:function(e){var t=T(this),r=t.reject;return r(e),t.promise}}),o(o.S+o.F*(t||!S),h,{resolve:function(e){return e instanceof y&&E(e.constructor,this)?e:g(this,e)}}),o(o.S+o.F*!(S&&e(56)(function(e){y.all(e)["catch"](_)})),h,{all:function(e){var t=this,r=T(t),n=r.resolve,a=r.reject,o=f(function(){var r=[],o=0,i=1;c(e,!1,function(e){var l=o++,s=!1;r.push(void 0),i++,t.resolve(e).then(function(e){s||(s=!0,r[l]=e,--i||n(r))},a)}),--i||n(r)});return o.e&&a(o.v),r.promise},race:function(e){var t=this,r=T(t),n=r.reject,a=f(function(){c(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return a.e&&n(a.v),r.promise}})},{100:100,101:101,104:104,113:113,128:128,17:17,23:23,25:25,3:3,33:33,39:39,40:40,51:51,56:56,6:6,60:60,68:68,69:69,90:90,91:91,93:93}],210:[function(e){var t=e(33),r=e(3),n=e(7),a=(e(40).Reflect||{}).apply,o=Function.apply;t(t.S+t.F*!e(35)(function(){a(function(){})}),"Reflect",{apply:function(e,t,i){var l=r(e),s=n(i);return a?a(l,t,s):o.call(l,t,s)}})},{3:3,33:33,35:35,40:40,7:7}],211:[function(e){var t=e(33),r=e(71),n=e(3),a=e(7),o=e(51),i=e(35),l=e(16),s=(e(40).Reflect||{}).construct,c=i(function(){function e(){}return!(s(function(){},[],e)instanceof e)}),u=!i(function(){s(function(){})});t(t.S+t.F*(c||u),"Reflect",{construct:function(e,t){n(e),a(t);var i=3>arguments.length?e:n(arguments[2]);if(u&&!c)return s(e,t,i);if(e==i){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);}var d=[null];return d.push.apply(d,t),new(l.apply(e,d))}var p=i.prototype,m=r(o(p)?p:Object.prototype),f=Function.apply.call(e,m,t);return o(f)?f:m}})},{16:16,3:3,33:33,35:35,40:40,51:51,7:7,71:71}],212:[function(e){var t=e(72),r=e(33),n=e(7),a=e(120);r(r.S+r.F*e(35)(function(){Reflect.defineProperty(t.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,r,o){n(e),r=a(r,!0),n(o);try{return t.f(e,r,o),!0}catch(t){return!1}}})},{120:120,33:33,35:35,7:7,72:72}],213:[function(e){var t=e(33),r=e(75).f,n=e(7);t(t.S,"Reflect",{deleteProperty:function(e,t){var a=r(n(e),t);return(!a||a.configurable)&&delete e[t]}})},{33:33,7:7,75:75}],214:[function(e){var t=e(33),r=e(7),n=function(e){this._t=r(e),this._i=0;var t=this._k=[],n;for(n in e)t.push(n)};e(54)(n,"Object",function(){var e=this,t=e._k,r;do if(e._i>=t.length)return{value:void 0,done:!0};while(!((r=t[e._i++])in e._t));return{value:r,done:!1}}),t(t.S,"Reflect",{enumerate:function(e){return new n(e)}})},{33:33,54:54,7:7}],215:[function(e){var t=e(75),r=e(33),n=e(7);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(e,r){return t.f(n(e),r)}})},{33:33,7:7,75:75}],216:[function(e){var t=e(33),r=e(79),n=e(7);t(t.S,"Reflect",{getPrototypeOf:function(e){return r(n(e))}})},{33:33,7:7,79:79}],217:[function(e){function t(e,o){var s=3>arguments.length?e:arguments[2],c,u;return l(e)===s?e[o]:(c=r.f(e,o))?a(c,"value")?c.value:void 0===c.get?void 0:c.get.call(s):i(u=n(e))?t(u,o,s):void 0}var r=e(75),n=e(79),a=e(41),o=e(33),i=e(51),l=e(7);o(o.S,"Reflect",{get:t})},{33:33,41:41,51:51,7:7,75:75,79:79}],218:[function(e){var t=e(33);t(t.S,"Reflect",{has:function(e,t){return t in e}})},{33:33}],219:[function(e){var t=e(33),r=e(7),n=Object.isExtensible;t(t.S,"Reflect",{isExtensible:function(e){return r(e),!n||n(e)}})},{33:33,7:7}],220:[function(e){var t=e(33);t(t.S,"Reflect",{ownKeys:e(85)})},{33:33,85:85}],221:[function(e){var t=e(33),r=e(7),n=Object.preventExtensions;t(t.S,"Reflect",{preventExtensions:function(e){r(e);try{return n&&n(e),!0}catch(t){return!1}}})},{33:33,7:7}],222:[function(e){var t=e(33),r=e(99);r&&t(t.S,"Reflect",{setPrototypeOf:function(e,t){r.check(e,t);try{return r.set(e,t),!0}catch(t){return!1}}})},{33:33,99:99}],223:[function(e){function t(e,i,u){var d=4>arguments.length?e:arguments[3],p=n.f(s(e),i),m,f;if(!p){if(c(f=a(e)))return t(f,i,u,d);p=l(0)}return o(p,"value")?!!(!1!==p.writable&&c(d))&&(m=n.f(d,i)||l(0),m.value=u,r.f(d,i,m),!0):void 0!==p.set&&(p.set.call(d,u),!0)}var r=e(72),n=e(75),a=e(79),o=e(41),i=e(33),l=e(92),s=e(7),c=e(51);i(i.S,"Reflect",{set:t})},{33:33,41:41,51:51,7:7,72:72,75:75,79:79,92:92}],224:[function(e){var t=e(40),r=e(45),n=e(72).f,a=e(77).f,o=e(52),l=e(37),s=t.RegExp,c=s,u=s.prototype,d=/a/g,p=/a/g,m=new s(d)!==d;if(e(29)&&(!m||e(35)(function(){return p[e(128)("match")]=!1,s(d)!=d||s(p)==p||"/a/i"!=s(d,"i")}))){s=function(e,t){var n=this instanceof s,a=o(e),i=t===void 0;return!n&&a&&e.constructor===s&&i?e:r(m?new c(a&&!i?e.source:e,t):c((a=e instanceof s)?e.source:e,a&&i?l.call(e):t),n?this:u,s)};for(var f=function(e){(e in s)||n(s,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},g=a(c),h=0;g.length>h;)f(g[h++]);u.constructor=s,s.prototype=u,e(94)(t,"RegExp",s)}e(100)("RegExp")},{100:100,128:128,29:29,35:35,37:37,40:40,45:45,52:52,72:72,77:77,94:94}],225:[function(e){e(29)&&"g"!=/./g.flags&&e(72).f(RegExp.prototype,"flags",{configurable:!0,get:e(37)})},{29:29,37:37,72:72}],226:[function(e){e(36)("match",1,function(e,t,r){return[function(r){var n=e(this),a=r==null?void 0:r[t];return a===void 0?new RegExp(r)[t](n+""):a.call(r,n)},r]})},{36:36}],227:[function(e){e(36)("replace",2,function(e,t,r){return[function(n,a){var o=e(this),i=n==null?void 0:n[t];return i===void 0?r.call(o+"",n,a):i.call(n,o,a)},r]})},{36:36}],228:[function(e){e(36)("search",1,function(e,t,r){return[function(r){var n=e(this),a=r==null?void 0:r[t];return a===void 0?new RegExp(r)[t](n+""):a.call(r,n)},r]})},{36:36}],229:[function(e){e(36)("split",2,function(t,r,n){var a=e(52),o=n,l=[].push,i="split",s="length",c="lastIndex";if("c"=="abbc"[i](/(b)*/)[1]||4!="test"[i](/(?:)/,-1)[s]||2!="ab"[i](/(?:ab)*/)[s]||4!="."[i](/(.?)(.?)/)[s]||1<"."[i](/()()/)[s]||""[i](/.?/)[s]){var u=/()??/.exec("")[1]===void 0;n=function(e,t){var r=this+"";if(void 0===e&&0===t)return[];if(!a(e))return o.call(r,e,t);var n=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,m=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,d+"g"),g,h,v,x,y;for(u||(g=new RegExp("^"+f.source+"$(?!\\s)",d));(h=f.exec(r))&&(v=h.index+h[0][s],!(v>p&&(n.push(r.slice(p,h.index)),!u&&1<h[s]&&h[0].replace(g,function(){for(y=1;y<arguments[s]-2;y++)void 0===arguments[y]&&(h[y]=void 0)}),1<h[s]&&h.index<r[s]&&l.apply(n,h.slice(1)),x=h[0][s],p=v,n[s]>=m)));)f[c]===h.index&&f[c]++;return p===r[s]?(x||!f.test(""))&&n.push(""):n.push(r.slice(p)),n[s]>m?n.slice(0,m):n}}else"0"[i](void 0,0)[s]&&(n=function(e,t){return void 0===e&&0===t?[]:o.call(this,e,t)});return[function(e,a){var o=t(this),i=e==null?void 0:e[r];return i===void 0?n.call(o+"",e,a):i.call(e,o,a)},n]})},{36:36,52:52}],230:[function(e){e(225);var t=e(7),r=e(37),n=e(29),a="toString",o=/./[a],i=function(t){e(94)(RegExp.prototype,a,t,!0)};e(35)(function(){return"/a/b"!=o.call({source:"a",flags:"b"})})?i(function(){var e=t(this);return"/".concat(e.source,"/","flags"in e?e.flags:!n&&e instanceof RegExp?r.call(e):void 0)}):o.name!=a&&i(function(){return o.call(this)})},{225:225,29:29,35:35,37:37,7:7,94:94}],231:[function(e,t){var r=e(19),n=e(125),a="Set";t.exports=e(22)(a,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return r.def(n(this,a),e=0===e?0:e,e)}},r)},{125:125,19:19,22:22}],232:[function(e){e(108)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},{108:108}],233:[function(e){e(108)("big",function(e){return function(){return e(this,"big","","")}})},{108:108}],234:[function(e){e(108)("blink",function(e){return function(){return e(this,"blink","","")}})},{108:108}],235:[function(e){e(108)("bold",function(e){return function(){return e(this,"b","","")}})},{108:108}],236:[function(e){var t=e(33),r=e(106)(!1);t(t.P,"String",{codePointAt:function(e){return r(this,e)}})},{106:106,33:33}],237:[function(e){var t=e(33),r=e(118),n=e(107),a="endsWith",o=""[a];t(t.P+t.F*e(34)(a),"String",{endsWith:function(e){var t=n(this,e,a),o=1<arguments.length?arguments[1]:void 0,i=r(t.length),l=o===void 0?i:Et(r(o),i),s=e+"";return t.slice(l-s.length,l)===s}})},{107:107,118:118,33:33,34:34}],238:[function(e){e(108)("fixed",function(e){return function(){return e(this,"tt","","")}})},{108:108}],239:[function(e){e(108)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},{108:108}],240:[function(e){e(108)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},{108:108}],241:[function(e){var t=e(33),r=e(114),n=dt,a=String.fromCodePoint;t(t.S+t.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(){for(var e=[],t=arguments.length,a=0,o;t>a;){if(o=+arguments[a++],r(o,1114111)!==o)throw RangeError(o+" is not a valid code point");e.push(65536>o?n(o):n(((o-=65536)>>10)+55296,o%1024+56320))}return e.join("")}})},{114:114,33:33}],242:[function(e){var t=e(33),r=e(107),n="includes";t(t.P+t.F*e(34)(n),"String",{includes:function(e){return!!~r(this,e,n).indexOf(e,1<arguments.length?arguments[1]:void 0)}})},{107:107,33:33,34:34}],243:[function(e){e(108)("italics",function(e){return function(){return e(this,"i","","")}})},{108:108}],244:[function(e){var t=e(106)(!0);e(55)(String,"String",function(e){this._t=e+"",this._i=0},function(){var e=this._t,r=this._i,n;return r>=e.length?{value:void 0,done:!0}:(n=t(e,r),this._i+=n.length,{value:n,done:!1})})},{106:106,55:55}],245:[function(e){e(108)("link",function(e){return function(t){return e(this,"a","href",t)}})},{108:108}],246:[function(e){var t=e(33),r=e(117),n=e(118);t(t.S,"String",{raw:function(e){for(var t=r(e.raw),a=n(t.length),o=arguments.length,l=[],s=0;a>s;)l.push(t[s++]+""),s<o&&l.push(arguments[s]+"");return l.join("")}})},{117:117,118:118,33:33}],247:[function(e){var t=e(33);t(t.P,"String",{repeat:e(110)})},{110:110,33:33}],248:[function(e){e(108)("small",function(e){return function(){return e(this,"small","","")}})},{108:108}],249:[function(e){var t=e(33),r=e(118),n=e(107),a="startsWith",o=""[a];t(t.P+t.F*e(34)(a),"String",{startsWith:function(e){var t=n(this,e,a),o=r(Et(1<arguments.length?arguments[1]:void 0,t.length)),i=e+"";return t.slice(o,o+i.length)===i}})},{107:107,118:118,33:33,34:34}],250:[function(e){e(108)("strike",function(e){return function(){return e(this,"strike","","")}})},{108:108}],251:[function(e){e(108)("sub",function(e){return function(){return e(this,"sub","","")}})},{108:108}],252:[function(e){e(108)("sup",function(e){return function(){return e(this,"sup","","")}})},{108:108}],253:[function(e){e(111)("trim",function(e){return function(){return e(this,3)}})},{111:111}],254:[function(e){var t=e(40),r=e(41),n=e(29),a=e(33),o=e(94),l=e(66).KEY,i=e(35),s=e(103),c=e(101),u=e(124),d=e(128),p=e(127),m=e(126),f=e(59),g=e(32),h=e(49),v=e(7),x=e(117),y=e(120),b=e(92),_=e(71),T=e(76),S=e(75),E=e(72),w=e(81),A=S.f,N=E.f,P=T.f,I=t.Symbol,F=t.JSON,M=F&&F.stringify,C="prototype",R=d("_hidden"),L=d("toPrimitive"),D={}.propertyIsEnumerable,O=s("symbol-registry"),G=s("symbols"),U=s("op-symbols"),B=Object[C],V="function"==typeof I,H=t.QObject,z=!H||!H[C]||!H[C].findChild,W=n&&i(function(){return 7!=_(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=A(B,t);n&&delete B[t],N(e,t,r),n&&e!==B&&N(B,t,n)}:N,X=function(e){var t=G[e]=_(I[C]);return t._k=e,t},Y=V&&"symbol"==wt(I.iterator)?function(e){return"symbol"==("undefined"==typeof e?"undefined":wt(e))}:function(e){return e instanceof I},q=function(e,t,n){return e===B&&q(U,t,n),v(e),t=y(t,!0),v(n),r(G,t)?(n.enumerable?(r(e,R)&&e[R][t]&&(e[R][t]=!1),n=_(n,{enumerable:b(0,!1)})):(!r(e,R)&&N(e,R,b(1,{})),e[R][t]=!0),W(e,t,n)):N(e,t,n)},K=function(e,t){v(e);for(var r=g(t=x(t)),n=0,a=r.length,o;a>n;)q(e,o=r[n++],t[o]);return e},Q=function(e){var t=D.call(this,e=y(e,!0));return(this!==B||!r(G,e)||r(U,e))&&(!(t||!r(this,e)||!r(G,e)||r(this,R)&&this[R][e])||t)},J=function(e,t){if(e=x(e),t=y(t,!0),e!==B||!r(G,t)||r(U,t)){var n=A(e,t);return n&&r(G,t)&&!(r(e,R)&&e[R][t])&&(n.enumerable=!0),n}},Z=function(e){for(var t=P(x(e)),n=[],a=0,o;t.length>a;)r(G,o=t[a++])||o==R||o==l||n.push(o);return n},$=function(e){for(var t=e===B,n=P(t?U:x(e)),a=[],o=0,l;n.length>o;)r(G,l=n[o++])&&(!t||r(B,l))&&a.push(G[l]);return a};V||(I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var e=u(0<arguments.length?arguments[0]:void 0);return n&&z&&W(B,e,{configurable:!0,set:function t(n){this===B&&t.call(U,n),r(this,R)&&r(this[R],e)&&(this[R][e]=!1),W(this,e,b(1,n))}}),X(e)},o(I[C],"toString",function(){return this._k}),S.f=J,E.f=q,e(77).f=T.f=Z,e(82).f=Q,e(78).f=$,n&&!e(60)&&o(B,"propertyIsEnumerable",Q,!0),p.f=function(e){return X(d(e))}),a(a.G+a.W+a.F*!V,{Symbol:I});for(var ee=["hasInstance","isConcatSpreadable","iterator","match","replace","search","species","split","toPrimitive","toStringTag","unscopables"],te=0;ee.length>te;)d(ee[te++]);for(var re=w(d.store),ne=0;re.length>ne;)m(re[ne++]);a(a.S+a.F*!V,"Symbol",{for:function(e){return r(O,e+="")?O[e]:O[e]=I(e)},keyFor:function(e){if(Y(e))return f(O,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),a(a.S+a.F*!V,"Object",{create:function(e,t){return t===void 0?_(e):K(_(e),t)},defineProperty:q,defineProperties:K,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),F&&a(a.S+a.F*(!V||i(function(){var e=I();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))})),"JSON",{stringify:function(e){if(!(void 0===e||Y(e))){for(var t=[e],r=1,n,a;arguments.length>r;)t.push(arguments[r++]);return n=t[1],"function"==typeof n&&(a=n),(a||!h(n))&&(n=function(e,t){if(a&&(t=a.call(this,e,t)),!Y(t))return t}),t[1]=n,M.apply(F,t)}}}),I[C][L]||e(42)(I[C],L,I[C].valueOf),c(I,"Symbol"),c(Math,"Math",!0),c(t.JSON,"JSON",!0)},{101:101,103:103,117:117,120:120,124:124,126:126,127:127,128:128,29:29,32:32,33:33,35:35,40:40,41:41,42:42,49:49,59:59,60:60,66:66,7:7,71:71,72:72,75:75,76:76,77:77,78:78,81:81,82:82,92:92,94:94}],255:[function(e){var t=e(33),r=e(123),n=e(122),a=e(7),o=e(114),i=e(118),l=e(51),s=e(40).ArrayBuffer,c=e(104),u=n.ArrayBuffer,d=n.DataView,p=r.ABV&&s.isView,m=u.prototype.slice,f=r.VIEW,g="ArrayBuffer";t(t.G+t.W+t.F*(s!==u),{ArrayBuffer:u}),t(t.S+t.F*!r.CONSTR,g,{isView:function(e){return p&&p(e)||l(e)&&f in e}}),t(t.P+t.U+t.F*e(35)(function(){return!new u(2).slice(1,void 0).byteLength}),g,{slice:function(e,t){if(m!==void 0&&t===void 0)return m.call(a(this),e);for(var r=a(this).byteLength,n=o(e,r),l=o(void 0===t?r:t,r),s=new(c(this,u))(i(l-n)),p=new d(this),f=new d(s),g=0;n<l;)f.setUint8(g++,p.getUint8(n++));return s}}),e(100)(g)},{100:100,104:104,114:114,118:118,122:122,123:123,33:33,35:35,40:40,51:51,7:7}],256:[function(e){var t=e(33);t(t.G+t.W+t.F*!e(123).ABV,{DataView:e(122).DataView})},{122:122,123:123,33:33}],257:[function(e){e(121)("Float32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],258:[function(e){e(121)("Float64",8,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],259:[function(e){e(121)("Int16",2,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],260:[function(e){e(121)("Int32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],261:[function(e){e(121)("Int8",1,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],262:[function(e){e(121)("Uint16",2,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],263:[function(e){e(121)("Uint32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],264:[function(e){e(121)("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}})},{121:121}],265:[function(e){e(121)("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}},!0)},{121:121}],266:[function(e,t){var r=e(12)(0),n=e(94),a=e(66),o=e(70),i=e(21),l=e(51),s=e(35),c=e(125),u="WeakMap",d=a.getWeak,p=Object.isExtensible,m=i.ufstore,f={},g=function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},h={get:function(e){if(l(e)){var t=d(e);return!0===t?m(c(this,u)).get(e):t?t[this._i]:void 0}},set:function(e,t){return i.def(c(this,u),e,t)}},v=t.exports=e(22)(u,g,h,i,!0,!0),x;s(function(){return 7!=new v().set((Object.freeze||Object)(f),7).get(f)})&&(x=i.getConstructor(g,u),o(x.prototype,h),a.NEED=!0,r(["delete","has","get","set"],function(e){var t=v.prototype,r=t[e];n(t,e,function(t,n){if(l(t)&&!p(t)){this._f||(this._f=new x);var a=this._f[e](t,n);return"set"==e?this:a}return r.call(this,t,n)})}))},{12:12,125:125,21:21,22:22,35:35,51:51,66:66,70:70,94:94}],267:[function(e){var t=e(21),r=e(125),n="WeakSet";e(22)(n,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return t.def(r(this,n),e,!0)}},t,!1,!0)},{125:125,21:21,22:22}],268:[function(e){var t=e(33),r=e(38),n=e(119),a=e(118),o=e(3),i=e(15);t(t.P,"Array",{flatMap:function(e){var t=n(this),l,s;return o(e),l=a(t.length),s=i(t,0),r(s,t,t,l,0,1,e,arguments[1]),s}}),e(5)("flatMap")},{118:118,119:119,15:15,3:3,33:33,38:38,5:5}],269:[function(e){var t=e(33),r=e(38),n=e(119),a=e(118),o=e(116),i=e(15);t(t.P,"Array",{flatten:function(){var e=arguments[0],t=n(this),l=a(t.length),s=i(t,0);return r(s,t,t,l,0,void 0===e?1:o(e)),s}}),e(5)("flatten")},{116:116,118:118,119:119,15:15,33:33,38:38,5:5}],270:[function(e){var t=e(33),r=e(11)(!0);t(t.P,"Array",{includes:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)("includes")},{11:11,33:33,5:5}],271:[function(e){var t=e(33),r=e(68)(),n=e(40).process,a="process"==e(18)(n);t(t.G,{asap:function(e){var t=a&&n.domain;r(t?t.bind(e):e)}})},{18:18,33:33,40:40,68:68}],272:[function(e){var t=e(33),r=e(18);t(t.S,"Error",{isError:function(e){return"Error"===r(e)}})},{18:18,33:33}],273:[function(e){var t=e(33);t(t.G,{global:e(40)})},{33:33,40:40}],274:[function(e){e(97)("Map")},{97:97}],275:[function(e){e(98)("Map")},{98:98}],276:[function(e){var t=e(33);t(t.P+t.R,"Map",{toJSON:e(20)("Map")})},{20:20,33:33}],277:[function(e){var t=e(33);t(t.S,"Math",{clamp:function(e,t,r){return Et(r,ht(t,e))}})},{33:33}],278:[function(e){var t=e(33);t(t.S,"Math",{DEG_PER_RAD:pt/180})},{33:33}],279:[function(e){var t=e(33);t(t.S,"Math",{degrees:function(e){return e*(180/pt)}})},{33:33}],280:[function(e){var t=e(33),r=e(64),n=e(62);t(t.S,"Math",{fscale:function(e,t,a,o,i){return n(r(e,t,a,o,i))}})},{33:33,62:62,64:64}],281:[function(e){var t=e(33);t(t.S,"Math",{iaddh:function(e,t,r,n){var a=e>>>0,o=r>>>0;return 0|(t>>>0)+(n>>>0)+((a&o|(a|o)&~(a+o>>>0))>>>31)}})},{33:33}],282:[function(e){var t=e(33);t(t.S,"Math",{imulh:function(e,r){var n=+e,a=+r,o=n&65535,i=a&65535,l=n>>16,s=a>>16,c=(l*i>>>0)+(o*i>>>16);return l*s+(c>>16)+((o*s>>>0)+(c&65535)>>16)}})},{33:33}],283:[function(e){var t=e(33);t(t.S,"Math",{isubh:function(e,t,r,n){var a=e>>>0,o=r>>>0;return 0|(t>>>0)-(n>>>0)-((~a&o|~(a^o)&a-o>>>0)>>>31)}})},{33:33}],284:[function(e){var t=e(33);t(t.S,"Math",{RAD_PER_DEG:180/pt})},{33:33}],285:[function(e){var t=e(33);t(t.S,"Math",{radians:function(e){return e*(pt/180)}})},{33:33}],286:[function(e){var t=e(33);t(t.S,"Math",{scale:e(64)})},{33:33,64:64}],287:[function(e){var t=e(33);t(t.S,"Math",{signbit:function(e){return(e=+e)==e?0==e?1/e==1/0:0<e:e}})},{33:33}],288:[function(e){var t=e(33);t(t.S,"Math",{umulh:function(e,r){var n=+e,a=+r,o=n&65535,i=a&65535,l=n>>>16,s=a>>>16,c=(l*i>>>0)+(o*i>>>16);return l*s+(c>>>16)+((o*s>>>0)+(c&65535)>>>16)}})},{33:33}],289:[function(e){var t=e(33),r=e(119),n=e(3),a=e(72);e(29)&&t(t.P+e(74),"Object",{__defineGetter__:function(e,t){a.f(r(this),e,{get:n(t),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],290:[function(e){var t=e(33),r=e(119),n=e(3),a=e(72);e(29)&&t(t.P+e(74),"Object",{__defineSetter__:function(e,t){a.f(r(this),e,{set:n(t),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],291:[function(e){var t=e(33),r=e(84)(!0);t(t.S,"Object",{entries:function(e){return r(e)}})},{33:33,84:84}],292:[function(e){var t=e(33),r=e(85),n=e(117),a=e(75),o=e(24);t(t.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t=n(e),l=a.f,s=r(t),c={},u=0,d,p;s.length>u;)p=l(t,d=s[u++]),void 0!==p&&o(c,d,p);return c}})},{117:117,24:24,33:33,75:75,85:85}],293:[function(e){var t=e(33),r=e(119),n=e(120),a=e(79),o=e(75).f;e(29)&&t(t.P+e(74),"Object",{__lookupGetter__:function(e){var t=r(this),i=n(e,!0),l;do if(l=o(t,i))return l.get;while(t=a(t))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],294:[function(e){var t=e(33),r=e(119),n=e(120),a=e(79),o=e(75).f;e(29)&&t(t.P+e(74),"Object",{__lookupSetter__:function(e){var t=r(this),i=n(e,!0),l;do if(l=o(t,i))return l.set;while(t=a(t))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],295:[function(e){var t=e(33),r=e(84)(!1);t(t.S,"Object",{values:function(e){return r(e)}})},{33:33,84:84}],296:[function(e){var t=e(33),r=e(40),n=e(23),a=e(68)(),o=e(128)("observable"),i=e(3),l=e(7),s=e(6),c=e(93),u=e(42),d=e(39),p=d.RETURN,f=function(e){return null==e?void 0:i(e)},g=function(e){var t=e._c;t&&(e._c=void 0,t())},h=function(e){return e._o===void 0},m=function(e){h(e)||(e._o=void 0,g(e))},v=function(t,e){l(t),this._c=void 0,this._o=t,t=new x(this);try{var r=e(t),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:i(r),this._c=r)}catch(r){return void t.error(r)}h(this)&&g(this)};v.prototype=c({},{unsubscribe:function(){m(this)}});var x=function(e){this._s=e};x.prototype=c({},{next:function(e){var t=this._s;if(!h(t)){var r=t._o;try{var n=f(r.next);if(n)return n.call(r,e)}catch(r){try{m(t)}finally{throw r}}}},error:function(e){var t=this._s;if(h(t))throw e;var r=t._o;t._o=void 0;try{var n=f(r.error);if(!n)throw e;e=n.call(r,e)}catch(r){try{g(t)}finally{throw r}}return g(t),e},complete:function(e){var t=this._s;if(!h(t)){var r=t._o;t._o=void 0;try{var n=f(r.complete);e=n?n.call(r,e):void 0}catch(r){try{g(t)}finally{throw r}}return g(t),e}}});var y=function(e){s(this,y,"Observable","_f")._f=i(e)};c(y.prototype,{subscribe:function(e){return new v(e,this._f)},forEach:function(e){var t=this;return new(n.Promise||r.Promise)(function(r,n){i(e);var a=t.subscribe({next:function(t){try{return e(t)}catch(t){n(t),a.unsubscribe()}},error:n,complete:r})})}}),c(y,{from:function(e){var t="function"==typeof this?this:y,r=f(l(e)[o]);if(r){var n=l(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}return new t(function(t){var r=!1;return a(function(){if(!r){try{if(d(e,!1,function(e){if(t.next(e),r)return p})===p)return}catch(n){if(r)throw n;return void t.error(n)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:y)(function(e){var t=!1;return a(function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}}),function(){t=!0}})}}),u(y.prototype,o,function(){return this}),t(t.G,{Observable:y}),e(100)("Observable")},{100:100,128:128,23:23,3:3,33:33,39:39,40:40,42:42,6:6,68:68,7:7,93:93}],297:[function(e){var t=e(33),r=e(23),n=e(40),a=e(104),o=e(91);t(t.P+t.R,"Promise",{finally:function(t){var i=a(this,r.Promise||n.Promise),e="function"==typeof t;return this.then(e?function(e){return o(i,t()).then(function(){return e})}:t,e?function(r){return o(i,t()).then(function(){throw r})}:t)}})},{104:104,23:23,33:33,40:40,91:91}],298:[function(e){var t=e(33),r=e(69),n=e(90);t(t.S,"Promise",{try:function(e){var t=r.f(this),a=n(e);return(a.e?t.reject:t.resolve)(a.v),t.promise}})},{33:33,69:69,90:90}],299:[function(e){var t=e(67),r=e(7),n=t.key,a=t.set;t.exp({defineMetadata:function(e,t,o,i){a(e,t,r(o),n(i))}})},{67:67,7:7}],300:[function(e){var t=e(67),r=e(7),n=t.key,a=t.map,o=t.store;t.exp({deleteMetadata:function(e,t){var i=3>arguments.length?void 0:n(arguments[2]),l=a(r(t),i,!1);if(void 0===l||!l["delete"](e))return!1;if(l.size)return!0;var s=o.get(t);return s["delete"](i),!!s.size||o["delete"](t)}})},{67:67,7:7}],301:[function(e){var t=e(231),r=e(10),n=e(67),a=e(7),o=e(79),i=n.keys,l=n.key,s=function e(n,a){var l=i(n,a),s=o(n);if(null===s)return l;var c=e(s,a);return c.length?l.length?r(new t(l.concat(c))):c:l};n.exp({getMetadataKeys:function(e){return s(a(e),2>arguments.length?void 0:l(arguments[1]))}})},{10:10,231:231,67:67,7:7,79:79}],302:[function(e){var t=e(67),r=e(7),n=e(79),a=t.has,o=t.get,i=t.key,l=function e(t,r,i){var l=a(t,r,i);if(l)return o(t,r,i);var s=n(r);return null===s?void 0:e(t,s,i)};t.exp({getMetadata:function(e,t){return l(e,r(t),3>arguments.length?void 0:i(arguments[2]))}})},{67:67,7:7,79:79}],303:[function(e){var t=e(67),r=e(7),n=t.keys,a=t.key;t.exp({getOwnMetadataKeys:function(e){return n(r(e),2>arguments.length?void 0:a(arguments[1]))}})},{67:67,7:7}],304:[function(e){var t=e(67),r=e(7),n=t.get,a=t.key;t.exp({getOwnMetadata:function(e,t){return n(e,r(t),3>arguments.length?void 0:a(arguments[2]))}})},{67:67,7:7}],305:[function(e){var t=e(67),r=e(7),n=e(79),a=t.has,o=t.key,i=function e(t,r,o){var i=a(t,r,o);if(i)return!0;var l=n(r);return null!==l&&e(t,l,o)};t.exp({hasMetadata:function(e,t){return i(e,r(t),3>arguments.length?void 0:o(arguments[2]))}})},{67:67,7:7,79:79}],306:[function(e){var t=e(67),r=e(7),n=t.has,a=t.key;t.exp({hasOwnMetadata:function(e,t){return n(e,r(t),3>arguments.length?void 0:a(arguments[2]))}})},{67:67,7:7}],307:[function(e){var t=e(67),r=e(7),n=e(3),a=t.key,o=t.set;t.exp({metadata:function(e,t){return function(i,l){o(e,t,(l===void 0?n:r)(i),a(l))}}})},{3:3,67:67,7:7}],308:[function(e){e(97)("Set")},{97:97}],309:[function(e){e(98)("Set")},{98:98}],310:[function(e){var t=e(33);t(t.P+t.R,"Set",{toJSON:e(20)("Set")})},{20:20,33:33}],311:[function(e){var t=e(33),r=e(106)(!0);t(t.P,"String",{at:function(e){return r(this,e)}})},{106:106,33:33}],312:[function(e){var t=e(33),r=e(28),n=e(118),a=e(52),o=e(37),i=RegExp.prototype,l=function(e,t){this._r=e,this._s=t};e(54)(l,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),t(t.P,"String",{matchAll:function(e){if(r(this),!a(e))throw TypeError(e+" is not a regexp!");var t=this+"",s="flags"in i?e.flags+"":o.call(e),c=new RegExp(e.source,~s.indexOf("g")?s:"g"+s);return c.lastIndex=n(e.lastIndex),new l(c,t)}})},{118:118,28:28,33:33,37:37,52:52,54:54}],313:[function(e){var t=e(33),r=e(109);t(t.P,"String",{padEnd:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0,!1)}})},{109:109,33:33}],314:[function(e){var t=e(33),r=e(109);t(t.P,"String",{padStart:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0,!0)}})},{109:109,33:33}],315:[function(e){e(111)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},{111:111}],316:[function(e){e(111)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},{111:111}],317:[function(e){e(126)("asyncIterator")},{126:126}],318:[function(e){e(126)("observable")},{126:126}],319:[function(e){var t=e(33);t(t.S,"System",{global:e(40)})},{33:33,40:40}],320:[function(e){e(97)("WeakMap")},{97:97}],321:[function(e){e(98)("WeakMap")},{98:98}],322:[function(e){e(97)("WeakSet")},{97:97}],323:[function(e){e(98)("WeakSet")},{98:98}],324:[function(e){for(var t=e(141),r=e(81),n=e(94),a=e(40),o=e(42),l=e(58),s=e(128),c=s("iterator"),u=s("toStringTag"),d=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=r(p),f=0;f<m.length;f++){var g=m[f],h=p[g],v=a[g],x=v&&v.prototype,y;if(x&&(x[c]||o(x,c,d),x[u]||o(x,u,g),l[g]=d,h))for(y in t)x[y]||n(x,y,t[y],!0)}},{128:128,141:141,40:40,42:42,58:58,81:81,94:94}],325:[function(e){var t=e(33),r=e(113);t(t.G+t.B,{setImmediate:r.set,clearImmediate:r.clear})},{113:113,33:33}],326:[function(e){var t=e(40),r=e(33),n=e(46),a=e(88),o=t.navigator,i=!!o&&/MSIE .\./.test(o.userAgent),l=function(e){return i?function(t,r){return e(n(a,[].slice.call(arguments,2),"function"==typeof t?t:Function(t)),r)}:e};r(r.G+r.B+r.F*i,{setTimeout:l(t.setTimeout),setInterval:l(t.setInterval)})},{33:33,40:40,46:46,88:88}],327:[function(e,t){e(254),e(191),e(193),e(192),e(195),e(197),e(202),e(196),e(194),e(204),e(203),e(199),e(200),e(198),e(190),e(201),e(205),e(206),e(157),e(159),e(158),e(208),e(207),e(178),e(188),e(189),e(179),e(180),e(181),e(182),e(183),e(184),e(185),e(186),e(187),e(161),e(162),e(163),e(164),e(165),e(166),e(167),e(168),e(169),e(170),e(171),e(172),e(173),e(174),e(175),e(176),e(177),e(241),e(246),e(253),e(244),e(236),e(237),e(242),e(247),e(249),e(232),e(233),e(234),e(235),e(238),e(239),e(240),e(243),e(245),e(248),e(250),e(251),e(252),e(152),e(154),e(153),e(156),e(155),e(140),e(138),e(145),e(142),e(148),e(150),e(137),e(144),e(134),e(149),e(132),e(147),e(146),e(139),e(143),e(131),e(133),e(136),e(135),e(151),e(141),e(224),e(230),e(225),e(226),e(227),e(228),e(229),e(209),e(160),e(231),e(266),e(267),e(255),e(256),e(261),e(264),e(265),e(259),e(262),e(260),e(263),e(257),e(258),e(210),e(211),e(212),e(213),e(214),e(217),e(215),e(216),e(218),e(219),e(220),e(221),e(223),e(222),e(270),e(268),e(269),e(311),e(314),e(313),e(315),e(316),e(312),e(317),e(318),e(292),e(295),e(291),e(289),e(290),e(293),e(294),e(276),e(310),e(275),e(309),e(321),e(323),e(274),e(308),e(320),e(322),e(273),e(319),e(272),e(277),e(278),e(279),e(280),e(281),e(283),e(282),e(284),e(285),e(286),e(288),e(287),e(297),e(298),e(299),e(300),e(302),e(301),e(304),e(303),e(305),e(306),e(307),e(271),e(296),e(326),e(325),e(324),t.exports=e(23)},{131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151,152:152,153:153,154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,23:23,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,292:292,293:293,294:294,295:295,296:296,297:297,298:298,299:299,300:300,301:301,302:302,303:303,304:304,305:305,306:306,307:307,308:308,309:309,310:310,311:311,312:312,313:313,314:314,315:315,316:316,317:317,318:318,319:319,320:320,321:321,322:322,323:323,324:324,325:325,326:326}],328:[function(e,t){(function(e){!function(e){function r(e,t,r,n){var o=t&&t.prototype instanceof a?t:a,i=Object.create(o.prototype),l=new m(n||[]);return i._invoke=c(e,r,l),i}function n(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function a(){}function o(){}function i(){}function l(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(t){function r(e,a,o,i){var l=n(t[e],t,a);if("throw"===l.type)i(l.arg);else{var s=l.arg,c=s.value;return c&&"object"===("undefined"==typeof c?"undefined":wt(c))&&v.call(c,"__await")?Promise.resolve(c.__await).then(function(e){r("next",e,o,i)},function(e){r("throw",e,o,i)}):Promise.resolve(c).then(function(e){s.value=e,o(s)},i)}}function a(e,t){function n(){return new Promise(function(n,a){r(e,t,n,a)})}return o=o?o.then(n,n):n()}"object"===wt(e.process)&&e.process.domain&&(r=e.process.domain.bind(r));var o;this._invoke=a}function c(e,t,r){var a="suspendedStart";return function(o,i){if(a==="executing")throw new Error("Generator is already running");if("completed"===a){if("throw"===o)throw i;return g()}for(r.method=o,r.arg=i;;){var l=r.delegate;if(l){var s=u(l,r);if(s){if(s===E)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var c=n(e,t,r);if("normal"===c.type){if(a=r.done?"completed":"suspendedYield",c.arg===E)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a="completed",r.method="throw",r.arg=c.arg)}}}function u(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,u(e,t),"throw"===t.method))return E;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var a=n(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,E;var o=a.arg;if(!o)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,E;if(o.done)t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0);else return o;return t.delegate=null,E}function d(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function p(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function m(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(d,this),this.reset(!0)}function f(e){if(e){var t=e[y];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(v.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:g}}function g(){return{value:void 0,done:!0}}var h=Object.prototype,v=h.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},y=x.iterator||"@@iterator",b=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",T="object"===("undefined"==typeof t?"undefined":wt(t)),S=e.regeneratorRuntime;if(S)return void(T&&(t.exports=S));S=e.regeneratorRuntime=T?t.exports:{},S.wrap=r;var E={},w={};w[y]=function(){return this};var k=Object.getPrototypeOf,A=k&&k(k(f([])));A&&A!==h&&v.call(A,y)&&(w=A);var N=i.prototype=a.prototype=Object.create(w);o.prototype=N.constructor=i,i.constructor=o,i[_]=o.displayName="GeneratorFunction",S.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===o||"GeneratorFunction"===(t.displayName||t.name))},S.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,!(_ in e)&&(e[_]="GeneratorFunction")),e.prototype=Object.create(N),e},S.awrap=function(e){return{__await:e}},l(s.prototype),s.prototype[b]=function(){return this},S.AsyncIterator=s,S.async=function(e,t,n,a){var o=new s(r(e,t,n,a));return S.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},l(N),N[_]="Generator",N[y]=function(){return this},N.toString=function(){return"[object Generator]"},S.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},S.values=f,m.prototype={constructor:m,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(p),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return o.type="throw",o.arg=e,r.next=t,n&&(r.method="next",r.arg=void 0),!!n}if(this.done)throw e;for(var r=this,n=this.tryEntries.length-1;0<=n;--n){var a=this.tryEntries[n],o=a.completion;if("root"===a.tryLoc)return t("end");if(a.tryLoc<=this.prev){var l=v.call(a,"catchLoc"),s=v.call(a,"finallyLoc");if(l&&s){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);if(this.prev<a.finallyLoc)return t(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);}else if(!s)throw new Error("try statement without catch or finally");else if(this.prev<a.finallyLoc)return t(a.finallyLoc)}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1,n;0<=r;--r)if(n=this.tryEntries[r],n.tryLoc<=this.prev&&v.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,E):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),E},finish:function(e){for(var t=this.tryEntries.length-1,r;0<=t;--t)if(r=this.tryEntries[t],r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),p(r),E},catch:function(e){for(var t=this.tryEntries.length-1,r;0<=t;--t)if(r=this.tryEntries[t],r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;p(r)}return a}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:f(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),E}}}("object"===("undefined"==typeof e?"undefined":wt(e))?e:"object"===("undefined"==typeof window?"undefined":wt(window))?window:"object"===("undefined"==typeof self?"undefined":wt(self))?self:this)}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}]},{},[1]),!function(m){function g(r,a){this.options={},r=r||this.options;var t={frequency:350,peak:1};for(var o in this.inputNode=this.filterNode=b.context.createBiquadFilter(),this.filterNode.type=a,this.outputNode=y.context.createGain(),this.filterNode.connect(this.outputNode),t)this[o]=r[o],this[o]=void 0===this[o]||null===this[o]?t[o]:this[o]}function x(){var o=b.context.sampleRate*this.time,i=y.context.createBuffer(2,o,b.context.sampleRate),n=i.getChannelData(0),a=i.getChannelData(1),r,l;for(l=0;o>l;l++)r=this.reverse?o-l:l,n[l]=(2*Math.random()-1)*yt(1-r/o,this.decay),a[l]=(2*Math.random()-1)*yt(1-r/o,this.decay);this.reverbNode.buffer=i}function t(r){for(var e=b.context.sampleRate,t=new Float32Array(e),n=0,i;e>n;n++)i=2*n/e-1,t[n]=20*((3+r)*i)*(pt/180)/(pt+r*St(i));return t}var y={},b=y,e="object"==("undefined"==typeof module?"undefined":wt(module))&&module.exports,n="function"==typeof define&&define.amd;e?module.exports=y:n?define([],y):m.Pizzicato=m.Pz=y;var r=m.AudioContext||m.webkitAudioContext;if(!r)return void console.error("No AudioContext found in this environment. Please ensure your window or global object contains a working AudioContext constructor function.");y.context=new r;var a=y.context.createGain();a.connect(y.context.destination),y.Util={isString:function(t){return"[object String]"===toString.call(t)},isObject:function(t){return"[object Object]"===toString.call(t)},isFunction:function(t){return"[object Function]"===toString.call(t)},isNumber:function(t){return"[object Number]"===toString.call(t)&&t===+t},isArray:function(t){return"[object Array]"===toString.call(t)},isInRange:function(r,e,t){return!!(b.Util.isNumber(r)&&b.Util.isNumber(e)&&b.Util.isNumber(t))&&r>=e&&t>=r},isBool:function(t){return"boolean"==typeof t},isOscillator:function(t){return t&&"[object OscillatorNode]"===t.toString()},isAudioBufferSourceNode:function(t){return t&&"[object AudioBufferSourceNode]"===t.toString()},isSound:function(t){return t instanceof b.Sound},isEffect:function(r){for(var e in y.Effects)if(r instanceof y.Effects[e])return!0;return!1},normalize:function(r,e,t){return b.Util.isNumber(r)&&b.Util.isNumber(e)&&b.Util.isNumber(t)?(t-e)*r/1+e:void 0},getDryLevel:function(t){return!b.Util.isNumber(t)||1<t||0>t?0:.5>=t?1:1-2*(t-.5)},getWetLevel:function(t){return!b.Util.isNumber(t)||1<t||0>t?0:.5<=t?1:1-2*(.5-t)}};var o=y.context.createGain(),i=Object.getPrototypeOf(Object.getPrototypeOf(o)),s=i.connect;i.connect=function(r){var e=b.Util.isEffect(r)?r.inputNode:r;return s.call(this,e),r},Object.defineProperty(y,"volume",{enumerable:!0,get:function(){return a.gain.value},set:function(t){b.Util.isInRange(t,0,1)&&a&&(a.gain.value=t)}}),Object.defineProperty(y,"masterGainNode",{enumerable:!1,get:function(){return a},set:function(){console.error("Can't set the master gain node")}}),y.Events={on:function(r,e,t){if(r&&e){this._events=this._events||{};var a=this._events[r]||(this._events[r]=[]);a.push({callback:e,context:t||this,handler:this})}},trigger:function(r){if(r){var e,a,l,s;if(this._events=this._events||{},e=this._events[r]||(this._events[r]=[])){for(a=ht(0,arguments.length-1),l=[],s=0;a>s;s++)l[s]=arguments[s+1];for(s=0;s<e.length;s++)e[s].callback.apply(e[s].context,l)}}},off:function(t){t?this._events[t]=void 0:this._events={}}},y.Sound=function(r,e){function t(r,n){r=r||{},this.getRawSourceNode=function(){var e=this.sourceNode?this.sourceNode.frequency.value:r.frequency,t=y.context.createOscillator();return t.type=r.type||"sine",t.frequency.value=e||440,t},this.sourceNode=this.getRawSourceNode(),this.sourceNode.gainSuccessor=b.context.createGain(),this.sourceNode.connect(this.sourceNode.gainSuccessor),s.isFunction(n)&&n()}function n(r,a){r=s.isArray(r)?r:[r];var t=new XMLHttpRequest;t.open("GET",r[0],!0),t.responseType="arraybuffer",t.onload=function(e){y.context.decodeAudioData(e.target.response,function(r){o.getRawSourceNode=function(){var e=y.context.createBufferSource();return e.loop=this.loop,e.buffer=r,e},s.isFunction(a)&&a()}.bind(o),function(e){return console.error("Error decoding audio file "+r[0]),1<r.length?(r.shift(),void n(r,a)):(e=e||new Error("Error decoding audio file "+r[0]),void(s.isFunction(a)&&a(e)))}.bind(o))},t.onreadystatechange=function(){4===t.readyState&&200!==t.status&&console.error("Error while fetching "+r[0]+". "+t.statusText)},t.send()}function a(t){var r=s.isFunction(t)?t:t.audioFunction,a=s.isObject(t)&&t.bufferSize?t.bufferSize:null;if(!a)try{y.context.createScriptProcessor()}catch(e){a=2048}this.getRawSourceNode=function(){var t=y.context.createScriptProcessor(a,1,1);return t.onaudioprocess=r,t}}var o=this,s=y.Util,i=function(t){if(t&&!s.isFunction(t)&&!s.isString(t)&&!s.isObject(t))return"Description type not supported. Initialize a sound using an object, a function or a string.";if(s.isObject(t)){if(!s.isString(t.source)||-1===["wave","file","input","script","sound"].indexOf(t.source))return"Specified source not supported. Sources can be wave, file, input or script";if(!("file"!==t.source||t.options&&t.options.path))return"A path is needed for sounds with a file source";if(!("script"!==t.source||t.options&&t.options.audioFunction))return"An audio function is needed for sounds with a script source"}}(r),l=s.isObject(r)&&s.isObject(r.options);if(i)throw console.error(i),new Error("Error initializing Pizzicato Sound: "+i);this.detached=l&&r.options.detached,this.masterVolume=y.context.createGain(),this.fadeNode=y.context.createGain(),this.fadeNode.gain.value=0,this.detached||this.masterVolume.connect(y.masterGainNode),this.lastTimePlayed=0,this.effects=[],this.effectConnectors=[],this.playing=this.paused=!1,this.loop=l&&r.options.loop,this.attack=l&&s.isNumber(r.options.attack)?r.options.attack:.04,this.volume=l&&s.isNumber(r.options.volume)?r.options.volume:1,l&&s.isNumber(r.options.release)?this.release=r.options.release:l&&s.isNumber(r.options.sustain)?(console.warn("'sustain' is deprecated. Use 'release' instead."),this.release=r.options.sustain):this.release=.04,r?s.isString(r)?n.bind(this)(r,e):s.isFunction(r)?a.bind(this)(r,e):"file"===r.source?n.bind(this)(r.options.path,e):"wave"===r.source?t.bind(this)(r.options,e):"input"===r.source?function(r,n){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia?void navigator.getUserMedia({audio:!0},function(t){o.getRawSourceNode=function(){return y.context.createMediaStreamSource(t)},s.isFunction(n)&&n()}.bind(o),function(t){s.isFunction(n)&&n(t)}):void console.error("Your browser does not support getUserMedia")}.bind(this)(r,e):"script"===r.source?a.bind(this)(r.options,e):"sound"===r.source&&function(t){this.getRawSourceNode=t.sound.getRawSourceNode,t.sound.sourceNode&&b.Util.isOscillator(t.sound.sourceNode)&&(this.sourceNode=this.getRawSourceNode(),this.frequency=t.sound.frequency)}.bind(this)(r.options,e):t.bind(this)({},e)},y.Sound.prototype=Object.create(y.Events,{play:{enumerable:!0,value:function(r,n){this.playing||(b.Util.isNumber(n)||(n=this.offsetTime||0),b.Util.isNumber(r)||(r=0),this.playing=!0,this.paused=!1,this.sourceNode=this.getSourceNode(),this.applyAttack(),b.Util.isFunction(this.sourceNode.start)&&(this.lastTimePlayed=y.context.currentTime-n,this.sourceNode.start(b.context.currentTime+r,n)),this.trigger("play"))}},stop:{enumerable:!0,value:function(){(this.paused||this.playing)&&(this.paused=this.playing=!1,this.stopWithRelease(),this.offsetTime=0,this.trigger("stop"))}},pause:{enumerable:!0,value:function(){if(!this.paused&&this.playing){this.paused=!0,this.playing=!1,this.stopWithRelease();var t=b.context.currentTime-this.lastTimePlayed;this.offsetTime=this.sourceNode.buffer?t%(this.sourceNode.buffer.length/b.context.sampleRate):t,this.trigger("pause")}}},clone:{enumerable:!0,value:function(){for(var r=new y.Sound({source:"sound",options:{loop:this.loop,attack:this.attack,release:this.release,volume:this.volume,sound:this}}),e=0;e<this.effects.length;e++)r.addEffect(this.effects[e]);return r}},onEnded:{enumerable:!0,value:function(t){return function(){this.sourceNode&&this.sourceNode!==t||(this.playing&&this.stop(),this.paused||this.trigger("end"))}}},addEffect:{enumerable:!0,value:function(r){if(!b.Util.isEffect(r))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(r);var e=0<this.effectConnectors.length?this.effectConnectors[this.effectConnectors.length-1]:this.fadeNode;e.disconnect(),e.connect(r);var t=b.context.createGain();return this.effectConnectors.push(t),r.connect(t),t.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(r){var e=this.effects.indexOf(r);if(-1===e)return console.warn("Cannot remove effect that is not applied to this sound."),this;var t=this.playing;t&&this.pause();var a=0===e?this.fadeNode:this.effectConnectors[e-1];a.disconnect();var n=this.effectConnectors[e];n.disconnect(),r.disconnect(n),this.effectConnectors.splice(e,1),this.effects.splice(e,1);var o;return o=e>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[e],a.connect(o),t&&this.play(),this}},connect:{enumerable:!0,value:function(t){return this.masterVolume.connect(t),this}},disconnect:{enumerable:!0,value:function(t){return this.masterVolume.disconnect(t),this}},connectEffects:{enumerable:!0,value:function(){for(var r=[],e=0;e<this.effects.length;e++){var a=e==this.effects.length-1,o=a?this.masterVolume:this.effects[e+1].inputNode;r[e]=b.context.createGain(),this.effects[e].outputNode.disconnect(this.effectConnectors[e]),this.effects[e].outputNode.connect(o)}}},volume:{enumerable:!0,get:function(){return this.masterVolume?this.masterVolume.gain.value:void 0},set:function(t){b.Util.isInRange(t,0,1)&&this.masterVolume&&(this.masterVolume.gain.value=t)}},frequency:{enumerable:!0,get:function(){return this.sourceNode&&b.Util.isOscillator(this.sourceNode)?this.sourceNode.frequency.value:null},set:function(t){this.sourceNode&&b.Util.isOscillator(this.sourceNode)&&(this.sourceNode.frequency.value=t)}},sustain:{enumerable:!0,get:function(){return console.warn("'sustain' is deprecated. Use 'release' instead."),this.release},set:function(t){console.warn("'sustain' is deprecated. Use 'release' instead."),b.Util.isInRange(t,0,10)&&(this.release=t)}},getSourceNode:{enumerable:!0,value:function(){if(this.sourceNode){var r=this.sourceNode;r.gainSuccessor.gain.setValueAtTime(r.gainSuccessor.gain.value,b.context.currentTime),r.gainSuccessor.gain.linearRampToValueAtTime(1e-4,b.context.currentTime+.2),setTimeout(function(){r.disconnect(),r.gainSuccessor.disconnect()},200)}var e=this.getRawSourceNode();return e.gainSuccessor=b.context.createGain(),e.connect(e.gainSuccessor),e.gainSuccessor.connect(this.fadeNode),this.fadeNode.connect(this.getInputNode()),b.Util.isAudioBufferSourceNode(e)&&(e.onended=this.onEnded(e).bind(this)),e}},getInputNode:{enumerable:!0,value:function(){return 0<this.effects.length?this.effects[0].inputNode:this.masterVolume}},applyAttack:{enumerable:!1,value:function(){var r=this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(b.context.currentTime),this.fadeNode.gain.setValueAtTime(r,b.context.currentTime),!this.attack)return void this.fadeNode.gain.setValueAtTime(1,y.context.currentTime);var e=(1-this.fadeNode.gain.value)*this.attack;this.fadeNode.gain.setValueAtTime(this.fadeNode.gain.value,y.context.currentTime),this.fadeNode.gain.linearRampToValueAtTime(1,y.context.currentTime+e)}},stopWithRelease:{enumerable:!1,value:function(){var e=this.sourceNode,t=function(){return b.Util.isFunction(e.stop)?e.stop(0):e.disconnect()},r=this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(b.context.currentTime),this.fadeNode.gain.setValueAtTime(r,b.context.currentTime),!this.release)return void t();var n=this.fadeNode.gain.value*this.release;this.fadeNode.gain.setValueAtTime(this.fadeNode.gain.value,y.context.currentTime),this.fadeNode.gain.linearRampToValueAtTime(1e-5,y.context.currentTime+n),window.setTimeout(function(){t()},1e3*n)}}}),y.Group=function(r){r=r||[],this.mergeGainNode=b.context.createGain(),this.masterVolume=b.context.createGain(),this.sounds=[],this.effects=[],this.effectConnectors=[],this.mergeGainNode.connect(this.masterVolume),this.masterVolume.connect(b.masterGainNode);for(var n=0;n<r.length;n++)this.addSound(r[n])},y.Group.prototype=Object.create(b.Events,{connect:{enumerable:!0,value:function(t){return this.masterVolume.connect(t),this}},disconnect:{enumerable:!0,value:function(t){return this.masterVolume.disconnect(t),this}},addSound:{enumerable:!0,value:function(t){return b.Util.isSound(t)?-1<this.sounds.indexOf(t)?void console.warn("The Pizzicato.Sound object was already added to this group"):(t.detached&&console.warn("Groups do not support detached sounds. You can manually create an audio graph to group detached sounds together."),t.disconnect(b.masterGainNode),t.connect(this.mergeGainNode),void this.sounds.push(t)):void console.error("You can only add Pizzicato.Sound objects")}},removeSound:{enumerable:!0,value:function(r){var e=this.sounds.indexOf(r);return-1===e?void console.warn("Cannot remove a sound that is not part of this group."):(r.disconnect(this.mergeGainNode),r.connect(b.masterGainNode),void this.sounds.splice(e,1))}},volume:{enumerable:!0,get:function(){return this.masterVolume?this.masterVolume.gain.value:void 0},set:function(t){b.Util.isInRange(t,0,1)&&(this.masterVolume.gain.value=t)}},play:{enumerable:!0,value:function(){for(var t=0;t<this.sounds.length;t++)this.sounds[t].play();this.trigger("play")}},stop:{enumerable:!0,value:function(){for(var t=0;t<this.sounds.length;t++)this.sounds[t].stop();this.trigger("stop")}},pause:{enumerable:!0,value:function(){for(var t=0;t<this.sounds.length;t++)this.sounds[t].pause();this.trigger("pause")}},addEffect:{enumerable:!0,value:function(r){if(!b.Util.isEffect(r))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(r);var e=0<this.effectConnectors.length?this.effectConnectors[this.effectConnectors.length-1]:this.mergeGainNode;e.disconnect(),e.connect(r);var t=b.context.createGain();return this.effectConnectors.push(t),r.connect(t),t.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(r){var e=this.effects.indexOf(r);if(-1===e)return console.warn("Cannot remove effect that is not applied to this group."),this;var t=0===e?this.mergeGainNode:this.effectConnectors(e-1);t.disconnect();var a=this.effectConnectors[e];a.disconnect(),r.disconnect(a),this.effectConnectors.splice(e,1),this.effects.splice(e,1);var n;return n=e>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[e],t.connect(n),this}}}),y.Effects={};var l=Object.create(null,{connect:{enumerable:!0,value:function(t){return this.outputNode.connect(t),this}},disconnect:{enumerable:!0,value:function(t){return this.outputNode.disconnect(t),this}}});y.Effects.Delay=function(r){this.options={},r=r||this.options;var n={feedback:.5,time:.3,mix:.5};for(var t in this.inputNode=y.context.createGain(),this.outputNode=y.context.createGain(),this.dryGainNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.feedbackGainNode=y.context.createGain(),this.delayNode=y.context.createDelay(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.delayNode),this.inputNode.connect(this.delayNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.Delay.prototype=Object.create(l,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(t){b.Util.isInRange(t,0,180)&&(this.options.time=t,this.delayNode.delayTime.value=t)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.feedback=parseFloat(t,10),this.feedbackGainNode.gain.value=this.feedback)}}}),y.Effects.Compressor=function(r){this.options={},r=r||this.options;var n={threshold:-24,knee:30,attack:.003,release:.25,ratio:12};for(var t in this.inputNode=this.compressorNode=y.context.createDynamicsCompressor(),this.outputNode=y.context.createGain(),this.compressorNode.connect(this.outputNode),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.Compressor.prototype=Object.create(l,{threshold:{enumerable:!0,get:function(){return this.compressorNode.threshold.value},set:function(t){y.Util.isInRange(t,-100,0)&&(this.compressorNode.threshold.value=t)}},knee:{enumerable:!0,get:function(){return this.compressorNode.knee.value},set:function(t){y.Util.isInRange(t,0,40)&&(this.compressorNode.knee.value=t)}},attack:{enumerable:!0,get:function(){return this.compressorNode.attack.value},set:function(t){y.Util.isInRange(t,0,1)&&(this.compressorNode.attack.value=t)}},release:{enumerable:!0,get:function(){return this.compressorNode.release.value},set:function(t){y.Util.isInRange(t,0,1)&&(this.compressorNode.release.value=t)}},ratio:{enumerable:!0,get:function(){return this.compressorNode.ratio.value},set:function(t){y.Util.isInRange(t,1,20)&&(this.compressorNode.ratio.value=t)}},getCurrentGainReduction:function(){return this.compressorNode.reduction}}),y.Effects.LowPassFilter=function(t){g.call(this,t,"lowpass")},y.Effects.HighPassFilter=function(t){g.call(this,t,"highpass")};var c=Object.create(l,{frequency:{enumerable:!0,get:function(){return this.filterNode.frequency.value},set:function(t){y.Util.isInRange(t,10,22050)&&(this.filterNode.frequency.value=t)}},peak:{enumerable:!0,get:function(){return this.filterNode.Q.value},set:function(t){y.Util.isInRange(t,1e-4,1e3)&&(this.filterNode.Q.value=t)}}});y.Effects.LowPassFilter.prototype=c,y.Effects.HighPassFilter.prototype=c,y.Effects.Distortion=function(r){this.options={},r=r||this.options;var n={gain:.5};for(var t in this.waveShaperNode=y.context.createWaveShaper(),this.inputNode=this.outputNode=this.waveShaperNode,n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.Distortion.prototype=Object.create(l,{gain:{enumerable:!0,get:function(){return this.options.gain},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.gain=t,this.adjustGain())}},adjustGain:{writable:!1,configurable:!1,enumerable:!1,value:function(){for(var r=b.Util.isNumber(this.options.gain)?parseInt(100*this.options.gain,10):50,t=44100,o=new Float32Array(t),n=0,i;t>n;++n)i=2*n/t-1,o[n]=20*((3+r)*i)*(pt/180)/(pt+r*St(i));this.waveShaperNode.curve=o}}}),y.Effects.Flanger=function(r){this.options={},r=r||this.options;var n={time:.45,speed:.2,depth:.1,feedback:.1,mix:.5};for(var t in this.inputNode=y.context.createGain(),this.outputNode=y.context.createGain(),this.inputFeedbackNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.dryGainNode=y.context.createGain(),this.delayNode=y.context.createDelay(),this.oscillatorNode=y.context.createOscillator(),this.gainNode=y.context.createGain(),this.feedbackNode=y.context.createGain(),this.oscillatorNode.type="sine",this.inputNode.connect(this.inputFeedbackNode),this.inputNode.connect(this.dryGainNode),this.inputFeedbackNode.connect(this.delayNode),this.inputFeedbackNode.connect(this.wetGainNode),this.delayNode.connect(this.wetGainNode),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.inputFeedbackNode),this.oscillatorNode.connect(this.gainNode),this.gainNode.connect(this.delayNode.delayTime),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),this.oscillatorNode.start(0),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.Flanger.prototype=Object.create(l,{time:{enumberable:!0,get:function(){return this.options.time},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.time=t,this.delayNode.delayTime.value=b.Util.normalize(t,.001,.02))}},speed:{enumberable:!0,get:function(){return this.options.speed},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.speed=t,this.oscillatorNode.frequency.value=b.Util.normalize(t,.5,5))}},depth:{enumberable:!0,get:function(){return this.options.depth},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.depth=t,this.gainNode.gain.value=b.Util.normalize(t,5e-4,.005))}},feedback:{enumberable:!0,get:function(){return this.options.feedback},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.feedback=t,this.feedbackNode.gain.value=b.Util.normalize(t,0,.8))}},mix:{enumberable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}}}),y.Effects.StereoPanner=function(r){this.options={},r=r||this.options;var n={pan:0};for(var t in this.inputNode=y.context.createGain(),this.outputNode=y.context.createGain(),y.context.createStereoPanner?(this.pannerNode=y.context.createStereoPanner(),this.inputNode.connect(this.pannerNode),this.pannerNode.connect(this.outputNode)):this.inputNode.connect(this.outputNode),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.StereoPanner.prototype=Object.create(l,{pan:{enumerable:!0,get:function(){return this.options.pan},set:function(t){b.Util.isInRange(t,-1,1)&&(this.options.pan=t,this.pannerNode&&(this.pannerNode.pan.value=t))}}}),y.Effects.Convolver=function(o,l){this.options={},o=o||this.options;var t=this,i=new XMLHttpRequest,n={mix:.5};for(var a in this.callback=l,this.inputNode=y.context.createGain(),this.convolverNode=y.context.createConvolver(),this.outputNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.dryGainNode=y.context.createGain(),this.inputNode.connect(this.convolverNode),this.convolverNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),n)this[a]=o[a],this[a]=void 0===this[a]||null===this[a]?n[a]:this[a];return o.impulse?(i.open("GET",o.impulse,!0),i.responseType="arraybuffer",i.onload=function(r){var e=r.target.response;y.context.decodeAudioData(e,function(r){t.convolverNode.buffer=r,t.callback&&b.Util.isFunction(t.callback)&&t.callback()},function(r){r=r||new Error("Error decoding impulse file"),t.callback&&b.Util.isFunction(t.callback)&&t.callback(r)})},i.onreadystatechange=function(){4===i.readyState&&200!==i.status&&console.error("Error while fetching "+o.impulse+". "+i.statusText)},void i.send()):void console.error("No impulse file specified.")},y.Effects.Convolver.prototype=Object.create(l,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}}}),y.Effects.PingPongDelay=function(r){this.options={},r=r||this.options;var n={feedback:.5,time:.3,mix:.5};for(var t in this.inputNode=y.context.createGain(),this.outputNode=y.context.createGain(),this.delayNodeLeft=y.context.createDelay(),this.delayNodeRight=y.context.createDelay(),this.dryGainNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.feedbackGainNode=y.context.createGain(),this.channelMerger=y.context.createChannelMerger(2),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNodeLeft.connect(this.channelMerger,0,0),this.delayNodeRight.connect(this.channelMerger,0,1),this.delayNodeLeft.connect(this.delayNodeRight),this.feedbackGainNode.connect(this.delayNodeLeft),this.delayNodeRight.connect(this.feedbackGainNode),this.inputNode.connect(this.feedbackGainNode),this.channelMerger.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.PingPongDelay.prototype=Object.create(l,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(t){b.Util.isInRange(t,0,180)&&(this.options.time=t,this.delayNodeLeft.delayTime.value=t,this.delayNodeRight.delayTime.value=t)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.feedback=parseFloat(t,10),this.feedbackGainNode.gain.value=this.feedback)}}}),y.Effects.Reverb=function(r){this.options={},r=r||this.options;var a={mix:.5,time:.01,decay:.01,reverse:!1};for(var t in this.inputNode=y.context.createGain(),this.reverbNode=y.context.createConvolver(),this.outputNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.dryGainNode=y.context.createGain(),this.inputNode.connect(this.reverbNode),this.reverbNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),a)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?a[t]:this[t];x.bind(this)()},y.Effects.Reverb.prototype=Object.create(l,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(t){b.Util.isInRange(t,1e-4,10)&&(this.options.time=t,x.bind(this)())}},decay:{enumerable:!0,get:function(){return this.options.decay},set:function(t){b.Util.isInRange(t,1e-4,10)&&(this.options.decay=t,x.bind(this)())}},reverse:{enumerable:!0,get:function(){return this.options.reverse},set:function(t){b.Util.isBool(t)&&(this.options.reverse=t,x.bind(this)())}}}),y.Effects.Tremolo=function(r){this.options={},r=r||this.options;var n={speed:4,depth:1,mix:.8};for(var t in this.inputNode=y.context.createGain(),this.outputNode=y.context.createGain(),this.dryGainNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.tremoloGainNode=y.context.createGain(),this.tremoloGainNode.gain.value=0,this.lfoNode=y.context.createOscillator(),this.shaperNode=y.context.createWaveShaper(),this.shaperNode.curve=new Float32Array([0,1]),this.shaperNode.connect(this.tremoloGainNode.gain),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.lfoNode.connect(this.shaperNode),this.lfoNode.type="sine",this.lfoNode.start(0),this.inputNode.connect(this.tremoloGainNode),this.tremoloGainNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.Tremolo.prototype=Object.create(l,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(t){b.Util.isInRange(t,0,20)&&(this.options.speed=t,this.lfoNode.frequency.value=t)}},depth:{enumerable:!0,get:function(){return this.options.depth},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.depth=t,this.shaperNode.curve=new Float32Array([1-t,1]))}}}),y.Effects.DubDelay=function(r){this.options={},r=r||this.options;var n={feedback:.6,time:.7,mix:.5,cutoff:700};for(var t in this.inputNode=y.context.createGain(),this.outputNode=y.context.createGain(),this.dryGainNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.feedbackGainNode=y.context.createGain(),this.delayNode=y.context.createDelay(),this.bqFilterNode=y.context.createBiquadFilter(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.bqFilterNode),this.bqFilterNode.connect(this.delayNode),this.delayNode.connect(this.feedbackGainNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]},y.Effects.DubDelay.prototype=Object.create(l,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(t){b.Util.isInRange(t,0,180)&&(this.options.time=t,this.delayNode.delayTime.value=t)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.feedback=parseFloat(t,10),this.feedbackGainNode.gain.value=this.feedback)}},cutoff:{enumerable:!0,get:function(){return this.options.cutoff},set:function(t){b.Util.isInRange(t,0,4e3)&&(this.options.cutoff=t,this.bqFilterNode.frequency.value=this.cutoff)}}}),y.Effects.RingModulator=function(r){this.options={},r=r||this.options;var n={speed:30,distortion:1,mix:.5};for(var t in this.inputNode=y.context.createGain(),this.outputNode=y.context.createGain(),this.dryGainNode=y.context.createGain(),this.wetGainNode=y.context.createGain(),this.vIn=y.context.createOscillator(),this.vIn.start(0),this.vInGain=y.context.createGain(),this.vInGain.gain.value=.5,this.vInInverter1=y.context.createGain(),this.vInInverter1.gain.value=-1,this.vInInverter2=y.context.createGain(),this.vInInverter2.gain.value=-1,this.vInDiode1=new u(y.context),this.vInDiode2=new u(y.context),this.vInInverter3=y.context.createGain(),this.vInInverter3.gain.value=-1,this.vcInverter1=y.context.createGain(),this.vcInverter1.gain.value=-1,this.vcDiode3=new u(y.context),this.vcDiode4=new u(y.context),this.outGain=y.context.createGain(),this.outGain.gain.value=3,this.compressor=y.context.createDynamicsCompressor(),this.compressor.threshold.value=-24,this.compressor.ratio.value=16,this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.vcInverter1),this.inputNode.connect(this.vcDiode4.node),this.vcInverter1.connect(this.vcDiode3.node),this.vIn.connect(this.vInGain),this.vInGain.connect(this.vInInverter1),this.vInGain.connect(this.vcInverter1),this.vInGain.connect(this.vcDiode4.node),this.vInInverter1.connect(this.vInInverter2),this.vInInverter1.connect(this.vInDiode2.node),this.vInInverter2.connect(this.vInDiode1.node),this.vInDiode1.connect(this.vInInverter3),this.vInDiode2.connect(this.vInInverter3),this.vInInverter3.connect(this.compressor),this.vcDiode3.connect(this.compressor),this.vcDiode4.connect(this.compressor),this.compressor.connect(this.outGain),this.outGain.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[t]=r[t],this[t]=void 0===this[t]||null===this[t]?n[t]:this[t]};var u=function(t){this.context=t,this.node=this.context.createWaveShaper(),this.vb=.2,this.vl=.4,this.h=1,this.setCurve()};return u.prototype.setDistortion=function(t){return this.h=t,this.setCurve()},u.prototype.setCurve=function(){var l,c,u,d,p,m,f,g;for(c=1024,p=new Float32Array(c),l=m=0,f=p.length;0<=f?f>m:m>f;l=0<=f?++m:--m)u=(l-c/2)/(c/2),u=St(u),d=u<=this.vb?0:this.vb<u&&u<=this.vl?this.h*(yt(u-this.vb,2)/(2*this.vl-2*this.vb)):this.h*u-this.h*this.vl+this.h*(yt(this.vl-this.vb,2)/(2*this.vl-2*this.vb)),p[l]=d;return g=this.node.curve=p},u.prototype.connect=function(t){return this.node.connect(t)},y.Effects.RingModulator.prototype=Object.create(l,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(t){b.Util.isInRange(t,0,1)&&(this.options.mix=t,this.dryGainNode.gain.value=y.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=y.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(t){b.Util.isInRange(t,0,2e3)&&(this.options.speed=t,this.vIn.frequency.value=t)}},distortion:{enumerable:!0,get:function(){return this.options.distortion},set:function(r){if(b.Util.isInRange(r,.2,50)){this.options.distortion=parseFloat(r,10);for(var e=[this.vInDiode1,this.vInDiode2,this.vcDiode3,this.vcDiode4],t=0,a=e.length;a>t;t++)e[t].setDistortion(r)}}}}),y.Effects.Quadrafuzz=function(r){this.options={},r=r||this.options;var n={lowGain:.6,midLowGain:.8,midHighGain:.5,highGain:.6};this.inputNode=b.context.createGain(),this.outputNode=b.context.createGain(),this.dryGainNode=b.context.createGain(),this.wetGainNode=b.context.createGain(),this.lowpassLeft=b.context.createBiquadFilter(),this.lowpassLeft.type="lowpass",this.lowpassLeft.frequency.value=147,this.lowpassLeft.Q.value=.7071,this.bandpass1Left=b.context.createBiquadFilter(),this.bandpass1Left.type="bandpass",this.bandpass1Left.frequency.value=587,this.bandpass1Left.Q.value=.7071,this.bandpass2Left=b.context.createBiquadFilter(),this.bandpass2Left.type="bandpass",this.bandpass2Left.frequency.value=2490,this.bandpass2Left.Q.value=.7071,this.highpassLeft=b.context.createBiquadFilter(),this.highpassLeft.type="highpass",this.highpassLeft.frequency.value=4980,this.highpassLeft.Q.value=.7071,this.overdrives=[];for(var l=0;4>l;l++)this.overdrives[l]=b.context.createWaveShaper(),this.overdrives[l].curve=t();this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode);var s=[this.lowpassLeft,this.bandpass1Left,this.bandpass2Left,this.highpassLeft];for(l=0;l<s.length;l++)this.wetGainNode.connect(s[l]),s[l].connect(this.overdrives[l]),this.overdrives[l].connect(this.outputNode);for(var o in n)this[o]=r[o],this[o]=void 0===this[o]||null===this[o]?n[o]:this[o]},y.Effects.Quadrafuzz.prototype=Object.create(l,{lowGain:{enumerable:!0,get:function(){return this.options.lowGain},set:function(r){b.Util.isInRange(r,0,1)&&(this.options.lowGain=r,this.overdrives[0].curve=t(b.Util.normalize(this.lowGain,0,150)))}},midLowGain:{enumerable:!0,get:function(){return this.options.midLowGain},set:function(r){b.Util.isInRange(r,0,1)&&(this.options.midLowGain=r,this.overdrives[1].curve=t(b.Util.normalize(this.midLowGain,0,150)))}},midHighGain:{enumerable:!0,get:function(){return this.options.midHighGain},set:function(r){b.Util.isInRange(r,0,1)&&(this.options.midHighGain=r,this.overdrives[2].curve=t(b.Util.normalize(this.midHighGain,0,150)))}},highGain:{enumerable:!0,get:function(){return this.options.highGain},set:function(r){b.Util.isInRange(r,0,1)&&(this.options.highGain=r,this.overdrives[3].curve=t(b.Util.normalize(this.highGain,0,150)))}}}),y}("undefined"==typeof window?global:window);var Ct=function(){function a(t,a){if(!e[t]){e[t]={};for(var r=0;r<t.length;r++)e[t][t.charAt(r)]=r}return e[t][a]}var l=dt,e={},c={compressToBase64:function(e){if(null==e)return"";var t=c._compress(e,6,function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"=";}},decompressFromBase64:function(t){return null==t?"":""==t?null:c._decompress(t.length,32,function(r){return a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t.charAt(r))})},compressToUTF16:function(e){return null==e?"":c._compress(e,15,function(e){return l(e+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:c._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(a){for(var o=c.compress(a),r=new Uint8Array(2*o.length),n=0,i=o.length,t;i>n;n++)t=o.charCodeAt(n),r[2*n]=t>>>8,r[2*n+1]=t%256;return r},decompressFromUint8Array:function(r){if(null===r||void 0===r)return c.decompress(r);for(var a=Array(r.length/2),n=0,o=a.length;o>n;n++)a[n]=256*r[2*n]+r[2*n+1];var t=[];return a.forEach(function(e){t.push(l(e))}),c.decompress(t.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":c._compress(e,6,function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(e)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),c._decompress(e.length,32,function(t){return a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",e.charAt(t))}))},compress:function(e){return c._compress(e,16,function(e){return l(e)})},_compress:function(g,o,r){if(null==g)return"";var n={},s={},p="",x="",y="",b=2,_=3,T=2,S=[],d=0,E=0,w,k,A;for(A=0;A<g.length;A+=1)if(p=g.charAt(A),Object.prototype.hasOwnProperty.call(n,p)||(n[p]=_++,s[p]=!0),x=y+p,Object.prototype.hasOwnProperty.call(n,x))y=x;else{if(Object.prototype.hasOwnProperty.call(s,y)){if(256>y.charCodeAt(0)){for(w=0;T>w;w++)d<<=1,E==o-1?(E=0,S.push(r(d)),d=0):E++;for(k=y.charCodeAt(0),w=0;8>w;w++)d=d<<1|1&k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k>>=1}else{for(k=1,w=0;T>w;w++)d=d<<1|k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k=0;for(k=y.charCodeAt(0),w=0;16>w;w++)d=d<<1|1&k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k>>=1}b--,0==b&&(b=yt(2,T),T++),delete s[y]}else for(k=n[y],w=0;T>w;w++)d=d<<1|1&k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k>>=1;b--,0==b&&(b=yt(2,T),T++),n[x]=_++,y=p+""}if(""!=y){if(Object.prototype.hasOwnProperty.call(s,y)){if(256>y.charCodeAt(0)){for(w=0;T>w;w++)d<<=1,E==o-1?(E=0,S.push(r(d)),d=0):E++;for(k=y.charCodeAt(0),w=0;8>w;w++)d=d<<1|1&k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k>>=1}else{for(k=1,w=0;T>w;w++)d=d<<1|k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k=0;for(k=y.charCodeAt(0),w=0;16>w;w++)d=d<<1|1&k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k>>=1}b--,0==b&&(b=yt(2,T),T++),delete s[y]}else for(k=n[y],w=0;T>w;w++)d=d<<1|1&k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k>>=1;b--,0==b&&(b=yt(2,T),T++)}for(k=2,w=0;T>w;w++)d=d<<1|1&k,E==o-1?(E=0,S.push(r(d)),d=0):E++,k>>=1;for(;;){if(d<<=1,E==o-1){S.push(r(d));break}E++}return S.join("")},decompress:function(e){return null==e?"":""==e?null:c._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(r,o,n){var e=[],f=4,g=4,x=3,y="",b=[],_={val:n(0),position:o,index:1},T,S,E,w,k,A,N,P;for(S=0;3>S;S+=1)e[S]=S;for(w=0,A=4,N=1;N!=A;)k=_.val&_.position,_.position>>=1,0==_.position&&(_.position=o,_.val=n(_.index++)),w|=(0<k?1:0)*N,N<<=1;switch(T=w){case 0:for(w=0,A=256,N=1;N!=A;)k=_.val&_.position,_.position>>=1,0==_.position&&(_.position=o,_.val=n(_.index++)),w|=(0<k?1:0)*N,N<<=1;P=l(w);break;case 1:for(w=0,A=65536,N=1;N!=A;)k=_.val&_.position,_.position>>=1,0==_.position&&(_.position=o,_.val=n(_.index++)),w|=(0<k?1:0)*N,N<<=1;P=l(w);break;case 2:return"";}for(e[3]=P,E=P,b.push(P);;){if(_.index>r)return"";for(w=0,A=yt(2,x),N=1;N!=A;)k=_.val&_.position,_.position>>=1,0==_.position&&(_.position=o,_.val=n(_.index++)),w|=(0<k?1:0)*N,N<<=1;switch(P=w){case 0:for(w=0,A=256,N=1;N!=A;)k=_.val&_.position,_.position>>=1,0==_.position&&(_.position=o,_.val=n(_.index++)),w|=(0<k?1:0)*N,N<<=1;e[g++]=l(w),P=g-1,f--;break;case 1:for(w=0,A=65536,N=1;N!=A;)k=_.val&_.position,_.position>>=1,0==_.position&&(_.position=o,_.val=n(_.index++)),w|=(0<k?1:0)*N,N<<=1;e[g++]=l(w),P=g-1,f--;break;case 2:return b.join("");}if(0==f&&(f=yt(2,x),x++),e[P])y=e[P];else{if(P!==g)return null;y=E+E.charAt(0)}b.push(y),e[g++]=E+y.charAt(0),f--,E=y,0==f&&(f=yt(2,x),x++)}}};return c}();"function"==typeof define&&define.amd?define(function(){return Ct}):"undefined"!=typeof module&&null!=module&&(module.exports=Ct);var Rt={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(Rt.arrayBuffer)var Lt=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Dt=ArrayBuffer.isView||function(e){return e&&-1<Lt.indexOf(Object.prototype.toString.call(e))};a.prototype.append=function(e,n){e=t(e),n=r(n);var a=this.map[e];this.map[e]=a?a+", "+n:n},a.prototype["delete"]=function(e){delete this.map[t(e)]},a.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},a.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},a.prototype.set=function(e,n){this.map[t(e)]=r(n)},a.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},a.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),n(e)},a.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},a.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),n(e)},Rt.iterable&&(a.prototype[Symbol.iterator]=a.prototype.entries);var Ot=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},d.call(m.prototype),d.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},h.error=function(){var e=new h(null,{status:0,statusText:""});return e.type="error",e};var Gt=[301,302,303,307,308];h.redirect=function(e,t){if(-1===Gt.indexOf(t))throw new RangeError("Invalid status code");return new h(null,{status:t,headers:{location:e}})};var Ut=self.DOMException;try{new Ut}catch(e){Ut=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},Ut.prototype=Object.create(Error.prototype),Ut.prototype.constructor=Ut}v.polyfill=!0,self.fetch||(self.fetch=v,self.Headers=a,self.Request=m,self.Response=h);var Bt=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{elementId:null,alertOnError:!1},r=t.elementId,n=void 0===r?n:r,a=t.alertOnError,o=void 0===a?o:a;At(this,e),this.register(),this.errors=[],this.alertOnError=o,n&&(this.consoleElement=document.getElementById(n),this.consoleElement.style.display="none",this.consoleElement.style.position="absolute",this.consoleElement.style.width="100%",this.consoleElement.style.background="rgba(0,0,0,0.8)",this.consoleElement.style.color="#FFFFFF",this.consoleElement.style.fontFamily="monospace",this.consoleElement.style.maxHeight="256px",this.consoleElement.style.overflowY="scroll",!this.consoleElement&&console.warn("ElementID '"+n+"' not found while trying to register Error Console"))}return Nt(e,[{key:"register",value:function(){window.onerror=this.handleError.bind(this)}},{key:"handleError",value:function(e,t,r,n,a){this.errors.push({msg:e,url:t,line:r,col:n,error:a}),this.alertOnError&&alert(e+"\n\n"+a),this.updateConsoleElement()}},{key:"handleRejection",value:function(e){console.log(arguments),this.handleError.bind(this)("Unhandled rejection","","","",e.reason)}},{key:"hideConsole",value:function(){this.consoleElement.display="none"}},{key:"showConsole",value:function(){this.consoleElement.display="block",this.updateConsoleElement()}},{key:"updateConsoleElement",value:function(){if(this.consoleElement){this.consoleElement.innerHTML="",this.errors.length&&(this.consoleElement.style.display="");var e=!0,t=!1,r=void 0;try{for(var n=this.errors[Symbol.iterator](),a,o;!(e=(a=n.next()).done);e=!0)o=a.value,this.consoleElement.innerHTML+=o.msg+" <br/>\n                                            &nbsp;&nbsp;&nbsp; in "+o.url+" <br/>\n                                            &nbsp;&nbsp;&nbsp; at line "+o.line+", column "+o.col+" </br>"}catch(e){t=!0,r=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw r}}}}}]),e}(),Vt={LIGHTING_ENABLED:!0,DIRECTIONAL_SHADOWS_ENABLED:!0,POINT_SHADOWS_ENABLED:!1,SHADOWS_VSM_ENABLED:!1,DEFAULT_SHADOW_BIAS:2e-5,MAX_BONES:8,MAX_LIGHTS:4},Ht=1e-6,zt="undefined"==typeof Float32Array?Array:Float32Array,Wt=Math.random,jt=Object.freeze({EPSILON:Ht,get ARRAY_TYPE(){return zt},RANDOM:Wt,setMatrixArrayType:function(e){zt=e},toRadian:function(e){return e*(pt/180)},equals:function(e,t){return St(e-t)<=Ht*ht(1,St(e),St(t))}}),Xt=Object.freeze({create:x,clone:y,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},fromValues:b,set:function(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e},transpose:function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},invert:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=r*o-a*n;return i?(i=1/i,e[0]=o*i,e[1]=-n*i,e[2]=-a*i,e[3]=r*i,e):null},adjoint:function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},multiply:_,rotate:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=ut(r),s=ct(r);return e[0]=n*s+o*l,e[1]=a*s+i*l,e[2]=n*-l+o*s,e[3]=a*-l+i*s,e},scale:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=r[0],s=r[1];return e[0]=n*l,e[1]=a*l,e[2]=o*s,e[3]=i*s,e},fromRotation:function(e,t){var r=ut(t),n=ct(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},str:function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},frob:function(e){return mt(yt(e[0],2)+yt(e[1],2)+yt(e[2],2)+yt(e[3],2))},LDU:function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},subtract:T,exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},equals:function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],i=t[0],l=t[1],s=t[2],c=t[3];return St(r-i)<=Ht*ht(1,St(r),St(i))&&St(n-l)<=Ht*ht(1,St(n),St(l))&&St(a-s)<=Ht*ht(1,St(a),St(s))&&St(o-c)<=Ht*ht(1,St(o),St(c))},multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},mul:_,sub:T}),Yt=Object.freeze({create:S,clone:E,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},fromValues:w,set:function(e,t,r,n,a,o,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=i,e},invert:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],l=t[5],s=r*o-n*a;return s?(s=1/s,e[0]=o*s,e[1]=-n*s,e[2]=-a*s,e[3]=r*s,e[4]=(a*l-o*i)*s,e[5]=(n*i-r*l)*s,e):null},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:k,rotate:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],u=t[5],d=ut(r),s=ct(r);return e[0]=n*s+o*d,e[1]=a*s+i*d,e[2]=n*-d+o*s,e[3]=a*-d+i*s,e[4]=l,e[5]=u,e},scale:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],s=t[5],c=r[0],u=r[1];return e[0]=n*c,e[1]=a*c,e[2]=o*u,e[3]=i*u,e[4]=l,e[5]=s,e},translate:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],s=t[5],c=r[0],u=r[1];return e[0]=n,e[1]=a,e[2]=o,e[3]=i,e[4]=n*c+o*u+l,e[5]=a*c+i*u+s,e},fromRotation:function(e,t){var r=ut(t),n=ct(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},frob:function(e){return mt(yt(e[0],2)+yt(e[1],2)+yt(e[2],2)+yt(e[3],2)+yt(e[4],2)+yt(e[5],2)+1)},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},subtract:A,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},equals:function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],l=e[5],s=t[0],c=t[1],u=t[2],d=t[3],p=t[4],m=t[5];return St(r-s)<=Ht*ht(1,St(r),St(s))&&St(n-c)<=Ht*ht(1,St(n),St(c))&&St(a-u)<=Ht*ht(1,St(a),St(u))&&St(o-d)<=Ht*ht(1,St(o),St(d))&&St(i-p)<=Ht*ht(1,St(i),St(p))&&St(l-m)<=Ht*ht(1,St(l),St(m))},mul:k,sub:A}),qt=Object.freeze({create:N,fromMat4:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},clone:P,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromValues:I,set:function(e,t,r,n,a,o,i,l,s,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=i,e[6]=l,e[7]=s,e[8]=c,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(e===t){var r=t[1],n=t[2],a=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=a}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],l=t[5],s=t[6],c=t[7],u=t[8],d=u*i-l*c,p=-u*o+l*s,m=c*o-i*s,f=r*d+n*p+a*m;return f?(f=1/f,e[0]=d*f,e[1]=(-u*n+a*c)*f,e[2]=(l*n-a*i)*f,e[3]=p*f,e[4]=(u*r-a*s)*f,e[5]=(-l*r+a*o)*f,e[6]=m*f,e[7]=(-c*r+n*s)*f,e[8]=(i*r-n*o)*f,e):null},adjoint:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],l=t[5],s=t[6],c=t[7],u=t[8];return e[0]=i*u-l*c,e[1]=a*c-n*u,e[2]=n*l-a*i,e[3]=l*s-o*u,e[4]=r*u-a*s,e[5]=a*o-r*l,e[6]=o*c-i*s,e[7]=n*s-r*c,e[8]=r*i-n*o,e},determinant:function(e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],i=e[5],l=e[6],s=e[7],c=e[8];return t*(c*o-i*s)+r*(-c*a+i*l)+n*(s*a-o*l)},multiply:F,translate:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],s=t[5],c=t[6],u=t[7],d=t[8],p=r[0],m=r[1];return e[0]=n,e[1]=a,e[2]=o,e[3]=i,e[4]=l,e[5]=s,e[6]=p*n+m*i+c,e[7]=p*a+m*l+u,e[8]=p*o+m*s+d,e},rotate:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=t[4],u=t[5],d=t[6],p=t[7],m=t[8],f=ut(r),s=ct(r);return e[0]=s*n+f*i,e[1]=s*a+f*l,e[2]=s*o+f*u,e[3]=s*i-f*n,e[4]=s*l-f*a,e[5]=s*u-f*o,e[6]=d,e[7]=p,e[8]=m,e},scale:function(e,t,r){var n=r[0],a=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=a*t[3],e[4]=a*t[4],e[5]=a*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},fromRotation:function(e,t){var r=ut(t),n=ct(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=r+r,l=n+n,s=a+a,c=r*i,u=n*i,d=n*l,p=a*i,m=a*l,f=a*s,g=o*i,h=o*l,v=o*s;return e[0]=1-d-f,e[3]=u-v,e[6]=p+h,e[1]=u+v,e[4]=1-c-f,e[7]=m-g,e[2]=p-h,e[5]=m+g,e[8]=1-c-d,e},normalFromMat4:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],l=t[5],s=t[6],c=t[7],u=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],h=t[14],v=t[15],x=r*l-n*i,y=r*s-a*i,b=r*c-o*i,_=n*s-a*l,T=n*c-o*l,S=a*c-o*s,E=u*g-d*f,w=u*h-p*f,k=u*v-m*f,A=d*h-p*g,N=d*v-m*g,P=p*v-m*h,I=x*P-y*N+b*A+_*k-T*w+S*E;return I?(I=1/I,e[0]=(l*P-s*N+c*A)*I,e[1]=(s*k-i*P-c*w)*I,e[2]=(i*N-l*k+c*E)*I,e[3]=(a*N-n*P-o*A)*I,e[4]=(r*P-a*k+o*w)*I,e[5]=(n*k-r*N-o*E)*I,e[6]=(g*S-h*T+v*_)*I,e[7]=(h*b-f*S-v*y)*I,e[8]=(f*T-g*b+v*x)*I,e):null},projection:function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return mt(yt(e[0],2)+yt(e[1],2)+yt(e[2],2)+yt(e[3],2)+yt(e[4],2)+yt(e[5],2)+yt(e[6],2)+yt(e[7],2)+yt(e[8],2))},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},subtract:M,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],l=e[5],s=e[6],c=e[7],u=e[8],d=t[0],p=t[1],m=t[2],f=t[3],g=t[4],h=t[5],v=t[6],x=t[7],y=t[8];return St(r-d)<=Ht*ht(1,St(r),St(d))&&St(n-p)<=Ht*ht(1,St(n),St(p))&&St(a-m)<=Ht*ht(1,St(a),St(m))&&St(o-f)<=Ht*ht(1,St(o),St(f))&&St(i-g)<=Ht*ht(1,St(i),St(g))&&St(l-h)<=Ht*ht(1,St(l),St(h))&&St(s-v)<=Ht*ht(1,St(s),St(v))&&St(c-x)<=Ht*ht(1,St(c),St(x))&&St(u-y)<=Ht*ht(1,St(u),St(y))},mul:F,sub:M}),Kt=B,Qt=Object.freeze({create:C,clone:R,copy:L,fromValues:D,set:function(e,t,r,n,a,o,i,l,s,c,u,d,p,m,f,g,h){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=i,e[6]=l,e[7]=s,e[8]=c,e[9]=u,e[10]=d,e[11]=p,e[12]=m,e[13]=f,e[14]=g,e[15]=h,e},identity:O,transpose:G,invert:U,adjoint:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],l=t[5],s=t[6],c=t[7],u=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],h=t[14],v=t[15];return e[0]=l*(p*v-m*h)-d*(s*v-c*h)+g*(s*m-c*p),e[1]=-(n*(p*v-m*h)-d*(a*v-o*h)+g*(a*m-o*p)),e[2]=n*(s*v-c*h)-l*(a*v-o*h)+g*(a*c-o*s),e[3]=-(n*(s*m-c*p)-l*(a*m-o*p)+d*(a*c-o*s)),e[4]=-(i*(p*v-m*h)-u*(s*v-c*h)+f*(s*m-c*p)),e[5]=r*(p*v-m*h)-u*(a*v-o*h)+f*(a*m-o*p),e[6]=-(r*(s*v-c*h)-i*(a*v-o*h)+f*(a*c-o*s)),e[7]=r*(s*m-c*p)-i*(a*m-o*p)+u*(a*c-o*s),e[8]=i*(d*v-m*g)-u*(l*v-c*g)+f*(l*m-c*d),e[9]=-(r*(d*v-m*g)-u*(n*v-o*g)+f*(n*m-o*d)),e[10]=r*(l*v-c*g)-i*(n*v-o*g)+f*(n*c-o*l),e[11]=-(r*(l*m-c*d)-i*(n*m-o*d)+u*(n*c-o*l)),e[12]=-(i*(d*h-p*g)-u*(l*h-s*g)+f*(l*p-s*d)),e[13]=r*(d*h-p*g)-u*(n*h-a*g)+f*(n*p-a*d),e[14]=-(r*(l*h-s*g)-i*(n*h-a*g)+f*(n*s-a*l)),e[15]=r*(l*p-s*d)-i*(n*p-a*d)+u*(n*s-a*l),e},determinant:function(e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],i=e[5],l=e[6],s=e[7],c=e[8],u=e[9],d=e[10],p=e[11],m=e[12],f=e[13],g=e[14],h=e[15];return(t*i-r*o)*(d*h-p*g)-(t*l-n*o)*(u*h-p*f)+(t*s-a*o)*(u*g-d*f)+(r*l-n*i)*(c*h-p*m)-(r*s-a*i)*(c*g-d*m)+(n*s-a*l)*(c*f-u*m)},multiply:B,translate:function(e,t,r){var n=r[0],a=r[1],o=r[2],i=void 0,l=void 0,s=void 0,c=void 0,u=void 0,d=void 0,p=void 0,m=void 0,f=void 0,g=void 0,h=void 0,v=void 0;return t===e?(e[12]=t[0]*n+t[4]*a+t[8]*o+t[12],e[13]=t[1]*n+t[5]*a+t[9]*o+t[13],e[14]=t[2]*n+t[6]*a+t[10]*o+t[14],e[15]=t[3]*n+t[7]*a+t[11]*o+t[15]):(i=t[0],l=t[1],s=t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],f=t[8],g=t[9],h=t[10],v=t[11],e[0]=i,e[1]=l,e[2]=s,e[3]=c,e[4]=u,e[5]=d,e[6]=p,e[7]=m,e[8]=f,e[9]=g,e[10]=h,e[11]=v,e[12]=i*n+u*a+f*o+t[12],e[13]=l*n+d*a+g*o+t[13],e[14]=s*n+p*a+h*o+t[14],e[15]=c*n+m*a+v*o+t[15]),e},scale:function(e,t,r){var n=r[0],a=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},rotate:function(e,r,n,a){var o=a[0],i=a[1],l=a[2],u=mt(o*o+i*i+l*l),d=void 0,p=void 0,m=void 0,f=void 0,g=void 0,h=void 0,v=void 0,b=void 0,_=void 0,T=void 0,S=void 0,E=void 0,w=void 0,k=void 0,A=void 0,N=void 0,P=void 0,I=void 0,F=void 0,M=void 0,C=void 0,R=void 0,L=void 0,D=void 0;return St(u)<Ht?null:(u=1/u,o*=u,i*=u,l*=u,d=ut(n),p=ct(n),m=1-p,f=r[0],g=r[1],h=r[2],v=r[3],b=r[4],_=r[5],T=r[6],S=r[7],E=r[8],w=r[9],k=r[10],A=r[11],N=o*o*m+p,P=i*o*m+l*d,I=l*o*m-i*d,F=o*i*m-l*d,M=i*i*m+p,C=l*i*m+o*d,R=o*l*m+i*d,L=i*l*m-o*d,D=l*l*m+p,e[0]=f*N+b*P+E*I,e[1]=g*N+_*P+w*I,e[2]=h*N+T*P+k*I,e[3]=v*N+S*P+A*I,e[4]=f*F+b*M+E*C,e[5]=g*F+_*M+w*C,e[6]=h*F+T*M+k*C,e[7]=v*F+S*M+A*C,e[8]=f*R+b*L+E*D,e[9]=g*R+_*L+w*D,e[10]=h*R+T*L+k*D,e[11]=v*R+S*L+A*D,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)},rotateX:function(e,t,r){var n=ut(r),a=ct(r),o=t[4],i=t[5],l=t[6],s=t[7],c=t[8],u=t[9],d=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*a+c*n,e[5]=i*a+u*n,e[6]=l*a+d*n,e[7]=s*a+p*n,e[8]=c*a-o*n,e[9]=u*a-i*n,e[10]=d*a-l*n,e[11]=p*a-s*n,e},rotateY:function(e,t,r){var n=ut(r),a=ct(r),o=t[0],i=t[1],l=t[2],s=t[3],c=t[8],u=t[9],d=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*a-c*n,e[1]=i*a-u*n,e[2]=l*a-d*n,e[3]=s*a-p*n,e[8]=o*n+c*a,e[9]=i*n+u*a,e[10]=l*n+d*a,e[11]=s*n+p*a,e},rotateZ:function(e,t,r){var n=ut(r),a=ct(r),o=t[0],i=t[1],l=t[2],s=t[3],c=t[4],u=t[5],d=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*a+c*n,e[1]=i*a+u*n,e[2]=l*a+d*n,e[3]=s*a+p*n,e[4]=c*a-o*n,e[5]=u*a-i*n,e[6]=d*a-l*n,e[7]=p*a-s*n,e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotation:function(e,r,n){var a=n[0],o=n[1],i=n[2],l=mt(a*a+o*o+i*i),u=void 0,d=void 0,p=void 0;return St(l)<Ht?null:(l=1/l,a*=l,o*=l,i*=l,u=ut(r),d=ct(r),p=1-d,e[0]=a*a*p+d,e[1]=o*a*p+i*u,e[2]=i*a*p-o*u,e[3]=0,e[4]=a*o*p-i*u,e[5]=o*o*p+d,e[6]=i*o*p+a*u,e[7]=0,e[8]=a*i*p+o*u,e[9]=o*i*p-a*u,e[10]=i*i*p+d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},fromXRotation:function(e,t){var r=ut(t),n=ct(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromYRotation:function(e,t){var r=ut(t),n=ct(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:function(e,t){var r=ut(t),n=ct(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotationTranslation:V,fromQuat2:H,getTranslation:z,getScaling:W,getRotation:j,fromRotationTranslationScale:X,fromRotationTranslationScaleOrigin:function(e,t,r,n,a){var o=t[0],i=t[1],l=t[2],s=t[3],c=o+o,u=i+i,d=l+l,p=o*c,m=o*u,f=o*d,g=i*u,h=i*d,v=l*d,x=s*c,y=s*u,b=s*d,_=n[0],T=n[1],S=n[2],E=a[0],w=a[1],k=a[2],A=(1-(g+v))*_,N=(m+b)*_,P=(f-y)*_,I=(m-b)*T,F=(1-(p+v))*T,M=(h+x)*T,C=(f+y)*S,R=(h-x)*S,L=(1-(p+g))*S;return e[0]=A,e[1]=N,e[2]=P,e[3]=0,e[4]=I,e[5]=F,e[6]=M,e[7]=0,e[8]=C,e[9]=R,e[10]=L,e[11]=0,e[12]=r[0]+E-(A*E+I*w+C*k),e[13]=r[1]+w-(N*E+F*w+R*k),e[14]=r[2]+k-(P*E+M*w+L*k),e[15]=1,e},fromQuat:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=r+r,l=n+n,s=a+a,c=r*i,u=n*i,d=n*l,p=a*i,m=a*l,f=a*s,g=o*i,h=o*l,v=o*s;return e[0]=1-d-f,e[1]=u+v,e[2]=p-h,e[3]=0,e[4]=u-v,e[5]=1-c-f,e[6]=m+g,e[7]=0,e[8]=p+h,e[9]=m-g,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},frustum:function(e,t,r,n,a,o,i){var l=1/(r-t),s=1/(a-n),c=1/(o-i);return e[0]=2*o*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*s,e[6]=0,e[7]=0,e[8]=(r+t)*l,e[9]=(a+n)*s,e[10]=(i+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*(i*o)*c,e[15]=0,e},perspective:Y,perspectiveFromFieldOfView:function(e,t,r,n){var a=st(t.upDegrees*pt/180),o=st(t.downDegrees*pt/180),i=st(t.leftDegrees*pt/180),l=st(t.rightDegrees*pt/180),s=2/(i+l),c=2/(a+o);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(.5*((i-l)*s)),e[9]=.5*((a-o)*c),e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},ortho:q,lookAt:K,targetTo:Q,str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},frob:function(e){return mt(yt(e[0],2)+yt(e[1],2)+yt(e[2],2)+yt(e[3],2)+yt(e[4],2)+yt(e[5],2)+yt(e[6],2)+yt(e[7],2)+yt(e[8],2)+yt(e[9],2)+yt(e[10],2)+yt(e[11],2)+yt(e[12],2)+yt(e[13],2)+yt(e[14],2)+yt(e[15],2))},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},subtract:J,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},equals:function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],l=e[5],s=e[6],c=e[7],u=e[8],d=e[9],p=e[10],m=e[11],f=e[12],g=e[13],h=e[14],v=e[15],x=t[0],y=t[1],b=t[2],_=t[3],T=t[4],S=t[5],E=t[6],w=t[7],k=t[8],A=t[9],N=t[10],P=t[11],I=t[12],F=t[13],M=t[14],C=t[15];return St(r-x)<=Ht*ht(1,St(r),St(x))&&St(n-y)<=Ht*ht(1,St(n),St(y))&&St(a-b)<=Ht*ht(1,St(a),St(b))&&St(o-_)<=Ht*ht(1,St(o),St(_))&&St(i-T)<=Ht*ht(1,St(i),St(T))&&St(l-S)<=Ht*ht(1,St(l),St(S))&&St(s-E)<=Ht*ht(1,St(s),St(E))&&St(c-w)<=Ht*ht(1,St(c),St(w))&&St(u-k)<=Ht*ht(1,St(u),St(k))&&St(d-A)<=Ht*ht(1,St(d),St(A))&&St(p-N)<=Ht*ht(1,St(p),St(N))&&St(m-P)<=Ht*ht(1,St(m),St(P))&&St(f-I)<=Ht*ht(1,St(f),St(I))&&St(g-F)<=Ht*ht(1,St(g),St(F))&&St(h-M)<=Ht*ht(1,St(h),St(M))&&St(v-C)<=Ht*ht(1,St(v),St(C))},mul:Kt,sub:J}),Jt=ee,Zt=function(){var e=Z();return function(t,r,n,a,o,s){var c,u;for(r||(r=3),n||(n=0),u=a?Et(a*r+n,t.length):t.length,c=n;c<u;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}(),$t=Object.freeze({create:Z,clone:$,length:ee,fromValues:te,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},subtract:re,multiply:ne,divide:ae,ceil:function(e,t){return e[0]=vt(t[0]),e[1]=vt(t[1]),e[2]=vt(t[2]),e},floor:function(e,t){return e[0]=Tt(t[0]),e[1]=Tt(t[1]),e[2]=Tt(t[2]),e},min:function(e,t,r){return e[0]=Et(t[0],r[0]),e[1]=Et(t[1],r[1]),e[2]=Et(t[2],r[2]),e},max:function(e,t,r){return e[0]=ht(t[0],r[0]),e[1]=ht(t[1],r[1]),e[2]=ht(t[2],r[2]),e},round:function(e,t){return e[0]=gt(t[0]),e[1]=gt(t[1]),e[2]=gt(t[2]),e},scale:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},distance:oe,squaredDistance:ie,squaredLength:le,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},normalize:se,dot:ce,cross:ue,lerp:function(e,r,n,a){var t=r[0],o=r[1],i=r[2];return e[0]=t+a*(n[0]-t),e[1]=o+a*(n[1]-o),e[2]=i+a*(n[2]-i),e},hermite:function(e,r,n,a,o,i){var t=i*i,l=t*(2*i-3)+1,s=t*(i-2)+i,c=t*(i-1),u=t*(3-2*i);return e[0]=r[0]*l+n[0]*s+a[0]*c+o[0]*u,e[1]=r[1]*l+n[1]*s+a[1]*c+o[1]*u,e[2]=r[2]*l+n[2]*s+a[2]*c+o[2]*u,e},bezier:function(e,r,n,a,o,i){var t=1-i,l=t*t,s=i*i,c=l*t,u=3*i*l,d=3*s*t,p=s*i;return e[0]=r[0]*c+n[0]*u+a[0]*d+o[0]*p,e[1]=r[1]*c+n[1]*u+a[1]*d+o[1]*p,e[2]=r[2]*c+n[2]*u+a[2]*d+o[2]*p,e},random:function(e,t){t=t||1;var n=2*Wt()*pt,r=2*Wt()-1,a=mt(1-r*r)*t;return e[0]=ct(n)*a,e[1]=ut(n)*a,e[2]=r*t,e},transformMat4:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=r[3]*n+r[7]*a+r[11]*o+r[15];return i=i||1,e[0]=(r[0]*n+r[4]*a+r[8]*o+r[12])/i,e[1]=(r[1]*n+r[5]*a+r[9]*o+r[13])/i,e[2]=(r[2]*n+r[6]*a+r[10]*o+r[14])/i,e},transformMat3:function(e,t,r){var n=t[0],a=t[1],o=t[2];return e[0]=n*r[0]+a*r[3]+o*r[6],e[1]=n*r[1]+a*r[4]+o*r[7],e[2]=n*r[2]+a*r[5]+o*r[8],e},transformQuat:function(e,t,r){var n=r[0],a=r[1],o=r[2],i=r[3],l=t[0],s=t[1],c=t[2],u=a*c-o*s,d=o*l-n*c,p=n*s-a*l,m=a*p-o*d,f=o*u-n*p,g=n*d-a*u,h=2*i;return u*=h,d*=h,p*=h,m*=2,f*=2,g*=2,e[0]=l+u+m,e[1]=s+d+f,e[2]=c+p+g,e},rotateX:de,rotateY:pe,rotateZ:me,angle:function(e,t){var r=te(e[0],e[1],e[2]),n=te(t[0],t[1],t[2]);se(r,r),se(n,n);var a=ce(r,n);return 1<a?0:-1>a?pt:lt(a)},str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},equals:function(e,t){var r=e[0],n=e[1],a=e[2],o=t[0],i=t[1],l=t[2];return St(r-o)<=Ht*ht(1,St(r),St(o))&&St(n-i)<=Ht*ht(1,St(n),St(i))&&St(a-l)<=Ht*ht(1,St(a),St(l))},sub:re,mul:ne,div:ae,dist:oe,sqrDist:ie,len:Jt,sqrLen:le,forEach:Zt}),er=function(){var e=fe();return function(t,r,n,a,o,s){var c,u;for(r||(r=4),n||(n=0),u=a?Et(a*r+n,t.length):t.length,c=n;c<u;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}(),tr=Object.freeze({create:fe,clone:ge,fromValues:he,copy:ve,set:xe,add:ye,subtract:be,multiply:_e,divide:Te,ceil:function(e,t){return e[0]=vt(t[0]),e[1]=vt(t[1]),e[2]=vt(t[2]),e[3]=vt(t[3]),e},floor:function(e,t){return e[0]=Tt(t[0]),e[1]=Tt(t[1]),e[2]=Tt(t[2]),e[3]=Tt(t[3]),e},min:function(e,t,r){return e[0]=Et(t[0],r[0]),e[1]=Et(t[1],r[1]),e[2]=Et(t[2],r[2]),e[3]=Et(t[3],r[3]),e},max:function(e,t,r){return e[0]=ht(t[0],r[0]),e[1]=ht(t[1],r[1]),e[2]=ht(t[2],r[2]),e[3]=ht(t[3],r[3]),e},round:function(e,t){return e[0]=gt(t[0]),e[1]=gt(t[1]),e[2]=gt(t[2]),e[3]=gt(t[3]),e},scale:Se,scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},distance:Ee,squaredDistance:we,length:ke,squaredLength:Ae,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},normalize:Ne,dot:Pe,lerp:Ie,random:function(e,t){return t=t||1,e[0]=Wt(),e[1]=Wt(),e[2]=Wt(),e[3]=Wt(),Ne(e,e),Se(e,e,t),e},transformMat4:Fe,transformQuat:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=r[0],l=r[1],s=r[2],c=r[3],u=c*n+l*o-s*a,d=c*a+s*n-i*o,p=c*o+i*a-l*n,m=-i*n-l*a-s*o;return e[0]=u*c+m*-i+d*-s-p*-l,e[1]=d*c+m*-l+p*-i-u*-s,e[2]=p*c+m*-s+u*-l-d*-i,e[3]=t[3],e},str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},exactEquals:Me,equals:Ce,sub:be,mul:_e,div:Te,dist:Ee,sqrDist:we,len:ke,sqrLen:Ae,forEach:er}),rr=ve,nr=Pe,ar=ke,or=Ae,ir=Ne,lr=function(){var e=Z(),t=te(1,0,0),r=te(0,1,0);return function(n,o,a){var i=ce(o,a);return-.999999>i?(ue(e,t,o),1e-6>Jt(e)&&ue(e,r,o),se(e,e),Le(n,e,Math.PI),n):.999999<i?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(ue(e,o,a),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+i,ir(n,n))}}(),sr=function(){var e=Re(),r=Re();return function(n,o,a,i,l,s){return Be(e,o,l,s),Be(r,a,i,s),Be(n,e,r,2*s*(1-s)),n}}(),cr=function(){var e=N();return function(t,r,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],ir(t,Ve(t,e))}}(),ur=Object.freeze({create:Re,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:Le,getAxisAngle:function(e,t){var r=2*lt(t[3]),n=ut(r/2);return 0==n?(e[0]=1,e[1]=0,e[2]=0):(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n),r},multiply:De,rotateX:Oe,rotateY:Ge,rotateZ:Ue,calculateW:function(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=r,e[1]=n,e[2]=a,e[3]=mt(St(1-r*r-n*n-a*a)),e},slerp:Be,invert:function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=r*r+n*n+a*a+o*o,l=i?1/i:0;return e[0]=-r*l,e[1]=-n*l,e[2]=-a*l,e[3]=o*l,e},conjugate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},fromMat3:Ve,fromEuler:He,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},clone:ge,fromValues:he,copy:rr,set:xe,add:ye,mul:De,scale:Se,dot:nr,lerp:Ie,length:ar,len:ar,squaredLength:or,sqrLen:or,normalize:ir,exactEquals:Me,equals:Ce,rotationTo:lr,sqlerp:sr,setAxes:cr}),dr=nr,pr=ar,mr=or,fr=Object.freeze({create:ze,clone:We,fromValues:je,fromRotationTranslationValues:Xe,fromRotationTranslation:Ye,fromTranslation:function(e,r){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*r[0],e[5]=.5*r[1],e[6]=.5*r[2],e[7]=0,e},fromRotation:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},fromMat4:qe,copy:Ke,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},set:function(e,t,r,n,a,o,i,l,s){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=i,e[6]=l,e[7]=s,e},getReal:rr,getDual:function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},setReal:rr,setDual:function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},getTranslation:function(e,t){var r=t[4],n=t[5],a=t[6],o=t[7],i=-t[0],l=-t[1],s=-t[2],c=t[3];return e[0]=2*(r*c+o*i+n*s-a*l),e[1]=2*(n*c+o*l+a*i-r*s),e[2]=2*(a*c+o*s+r*l-n*i),e},translate:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=.5*r[0],s=.5*r[1],c=.5*r[2],u=t[4],d=t[5],p=t[6],m=t[7];return e[0]=n,e[1]=a,e[2]=o,e[3]=i,e[4]=i*l+a*c-o*s+u,e[5]=i*s+o*l-n*c+d,e[6]=i*c+n*s-a*l+p,e[7]=-n*l-a*s-o*c+m,e},rotateX:function(e,t,r){var n=-t[0],a=-t[1],o=-t[2],i=t[3],l=t[4],s=t[5],c=t[6],u=t[7],d=l*i+u*n+s*o-c*a,p=s*i+u*a+c*n-l*o,m=c*i+u*o+l*a-s*n,f=u*i-l*n-s*a-c*o;return Oe(e,t,r),n=e[0],a=e[1],o=e[2],i=e[3],e[4]=d*i+f*n+p*o-m*a,e[5]=p*i+f*a+m*n-d*o,e[6]=m*i+f*o+d*a-p*n,e[7]=f*i-d*n-p*a-m*o,e},rotateY:function(e,t,r){var n=-t[0],a=-t[1],o=-t[2],i=t[3],l=t[4],s=t[5],c=t[6],u=t[7],d=l*i+u*n+s*o-c*a,p=s*i+u*a+c*n-l*o,m=c*i+u*o+l*a-s*n,f=u*i-l*n-s*a-c*o;return Ge(e,t,r),n=e[0],a=e[1],o=e[2],i=e[3],e[4]=d*i+f*n+p*o-m*a,e[5]=p*i+f*a+m*n-d*o,e[6]=m*i+f*o+d*a-p*n,e[7]=f*i-d*n-p*a-m*o,e},rotateZ:function(e,t,r){var n=-t[0],a=-t[1],o=-t[2],i=t[3],l=t[4],s=t[5],c=t[6],u=t[7],d=l*i+u*n+s*o-c*a,p=s*i+u*a+c*n-l*o,m=c*i+u*o+l*a-s*n,f=u*i-l*n-s*a-c*o;return Ue(e,t,r),n=e[0],a=e[1],o=e[2],i=e[3],e[4]=d*i+f*n+p*o-m*a,e[5]=p*i+f*a+m*n-d*o,e[6]=m*i+f*o+d*a-p*n,e[7]=f*i-d*n-p*a-m*o,e},rotateByQuatAppend:function(e,t,r){var n=r[0],a=r[1],o=r[2],i=r[3],l=t[0],s=t[1],c=t[2],u=t[3];return e[0]=l*i+u*n+s*o-c*a,e[1]=s*i+u*a+c*n-l*o,e[2]=c*i+u*o+l*a-s*n,e[3]=u*i-l*n-s*a-c*o,l=t[4],s=t[5],c=t[6],u=t[7],e[4]=l*i+u*n+s*o-c*a,e[5]=s*i+u*a+c*n-l*o,e[6]=c*i+u*o+l*a-s*n,e[7]=u*i-l*n-s*a-c*o,e},rotateByQuatPrepend:function(e,t,r){var n=t[0],a=t[1],o=t[2],i=t[3],l=r[0],s=r[1],c=r[2],u=r[3];return e[0]=n*u+i*l+a*c-o*s,e[1]=a*u+i*s+o*l-n*c,e[2]=o*u+i*c+n*s-a*l,e[3]=i*u-n*l-a*s-o*c,l=r[4],s=r[5],c=r[6],u=r[7],e[4]=n*u+i*l+a*c-o*s,e[5]=a*u+i*s+o*l-n*c,e[6]=o*u+i*c+n*s-a*l,e[7]=i*u-n*l-a*s-o*c,e},rotateAroundAxis:function(e,t,r,n){if(St(n)<Ht)return Ke(e,t);var a=mt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);n*=.5;var o=ut(n),i=o*r[0]/a,l=o*r[1]/a,s=o*r[2]/a,c=ct(n),u=t[0],d=t[1],p=t[2],m=t[3];e[0]=u*c+m*i+d*s-p*l,e[1]=d*c+m*l+p*i-u*s,e[2]=p*c+m*s+u*l-d*i,e[3]=m*c-u*i-d*l-p*s;var f=t[4],g=t[5],h=t[6],v=t[7];return e[4]=f*c+v*i+g*s-h*l,e[5]=g*c+v*l+h*i-f*s,e[6]=h*c+v*s+f*l-g*i,e[7]=v*c-f*i-g*l-h*s,e},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e},multiply:Qe,mul:Qe,scale:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e},dot:dr,lerp:function(e,r,n,a){var o=1-a;return 0>dr(r,n)&&(a=-a),e[0]=r[0]*o+n[0]*a,e[1]=r[1]*o+n[1]*a,e[2]=r[2]*o+n[2]*a,e[3]=r[3]*o+n[3]*a,e[4]=r[4]*o+n[4]*a,e[5]=r[5]*o+n[5]*a,e[6]=r[6]*o+n[6]*a,e[7]=r[7]*o+n[7]*a,e},invert:function(e,t){var r=mr(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e},conjugate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},length:pr,len:pr,squaredLength:mr,sqrLen:mr,normalize:function(e,t){var r=mr(t);return 0<r&&(r=mt(r),e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r,e[3]=t[3]/r,e[4]=t[4]/r,e[5]=t[5]/r,e[6]=t[6]/r,e[7]=t[7]/r),e},str:function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},equals:function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],l=e[5],s=e[6],c=e[7],u=t[0],d=t[1],p=t[2],m=t[3],f=t[4],g=t[5],h=t[6],v=t[7];return St(r-u)<=Ht*ht(1,St(r),St(u))&&St(n-d)<=Ht*ht(1,St(n),St(d))&&St(a-p)<=Ht*ht(1,St(a),St(p))&&St(o-m)<=Ht*ht(1,St(o),St(m))&&St(i-f)<=Ht*ht(1,St(i),St(f))&&St(l-g)<=Ht*ht(1,St(l),St(g))&&St(s-h)<=Ht*ht(1,St(s),St(h))&&St(c-v)<=Ht*ht(1,St(c),St(v))}}),gr=function(){var e=Je();return function(t,r,n,a,o,s){var c,u;for(r||(r=2),n||(n=0),u=a?Et(a*r+n,t.length):t.length,c=n;c<u;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}(),hr=Object.freeze({create:Je,clone:Ze,fromValues:$e,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,r){return e[0]=t,e[1]=r,e},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},subtract:et,multiply:tt,divide:rt,ceil:function(e,t){return e[0]=vt(t[0]),e[1]=vt(t[1]),e},floor:function(e,t){return e[0]=Tt(t[0]),e[1]=Tt(t[1]),e},min:function(e,t,r){return e[0]=Et(t[0],r[0]),e[1]=Et(t[1],r[1]),e},max:function(e,t,r){return e[0]=ht(t[0],r[0]),e[1]=ht(t[1],r[1]),e},round:function(e,t){return e[0]=gt(t[0]),e[1]=gt(t[1]),e},scale:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},distance:nt,squaredDistance:at,length:ot,squaredLength:it,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:function(e,t){var r=t[0],n=t[1],a=r*r+n*n;return 0<a&&(a=1/mt(a),e[0]=t[0]*a,e[1]=t[1]*a),e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},cross:function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},lerp:function(e,r,n,a){var t=r[0],o=r[1];return e[0]=t+a*(n[0]-t),e[1]=o+a*(n[1]-o),e},random:function(e,t){t=t||1;var n=2*Wt()*pt;return e[0]=ct(n)*t,e[1]=ut(n)*t,e},transformMat2:function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a,e[1]=r[1]*n+r[3]*a,e},transformMat2d:function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a+r[4],e[1]=r[1]*n+r[3]*a+r[5],e},transformMat3:function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[3]*a+r[6],e[1]=r[1]*n+r[4]*a+r[7],e},transformMat4:function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[4]*a+r[12],e[1]=r[1]*n+r[5]*a+r[13],e},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]},equals:function(e,t){var r=e[0],n=e[1],a=t[0],o=t[1];return St(r-a)<=Ht*ht(1,St(r),St(a))&&St(n-o)<=Ht*ht(1,St(n),St(o))},len:ot,sub:et,mul:tt,div:rt,dist:nt,sqrDist:at,sqrLen:it,forEach:gr}),vr=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},xr=function(){function e(e,t){for(var r=0,n;r<t.length;r++)n=t[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),yr=function e(t,r,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,r);if(a===void 0){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in a)return a.value;var i=a.get;return void 0===i?void 0:i.call(n)},br=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":wt(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},_r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"===("undefined"==typeof t?"undefined":wt(t))||"function"==typeof t)?t:e},Tr=function(){function e(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),l;!(n=(l=i.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(e){a=!0,o=e}finally{try{!n&&i["return"]&&i["return"]()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Sr=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},Er=C(),wr=0,kr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=void 0===r?"Component_"+wr++:r,a=t.enabled,o=t.transform,i=void 0===o?new wn:o,l=t.visible;vr(this,e),this.id=n,this.enabled=void 0===a||a,this.transform=i,this.visible=void 0===l||l}return xr(e,[{key:"update",value:function(){}},{key:"render",value:function(){}}]),e}(),Ar=0,Nr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=void 0===r?Ar++:r,a=t.components,o=void 0===a?[]:a,i=t.enabled,l=t.visible,s=t.transform,c=void 0===s?new wn:s;vr(this,e),this._priv||(this._priv={events:[]}),this._priv.events||(this._priv.events=[]),this.id=n,this.enabled=void 0===i||i,this.visible=void 0===l||l,this.opacity=1,this.pointerEvents=!0,this.parentScene=null,this.components=o,this.transform=c,this.tMatrix=C()}return xr(e,[{key:"update",value:function(e,t){for(var r=0;r<this.components.length;r++)this.components[r].enabled&&this.components[r].update(e,t,this)}},{key:"render",value:function(e,t,r,n,a,o,l,s,c){a.push(this),l?Kt(this.tMatrix,l,this.transform.localMatrix):L(this.tMatrix,this.transform.localMatrix);for(var u=0;u<this.components.length;u++)this.components[u].visible&&this.components[u].render(e,t,r,n,a,o,this.tMatrix,s,c);a.pop()}},{key:"addComponent",value:function(e){this.components.push(e)}},{key:"removeComponent",value:function(e){-1>=this.components.indexOf(e)||this.components.splice(this.components.indexOf(e),1)}},{key:"renderPick",value:function(e,t,r){if(this.visible&&this.pointerEvents)for(var n=0;n<this.components.length;n++)this.components[n].visible&&this.components[n].renderPick&&this.components[n].renderPick(e,t,this,r)}},{key:"registerHandler",value:function(){}},{key:"unregisterHandler",value:function(){}},{key:"onload",value:function(){var e=!0,t=!1,r=void 0;try{for(var n=this._priv.events[Symbol.iterator](),a,o;!(e=(a=n.next()).done);e=!0)o=a.value,this.registerHandler(o)}catch(e){t=!0,r=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw r}}}},{key:"onunload",value:function(){var e=!0,t=!1,r=void 0;try{for(var n=this._priv.events[Symbol.iterator](),a,o;!(e=(a=n.next()).done);e=!0)o=a.value,this.unregisterHandler(o)}catch(e){t=!0,r=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw r}}}},{key:"onSpawn",value:function(e){this.parentScene=e}},{key:"onDestroy",value:function(){}},{key:"emit",value:function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=!0,o=!1,i=void 0;try{for(var l=this._priv.events[Symbol.iterator](),s,c;!(a=(s=l.next()).done);a=!0)c=s.value,c.event==e&&c.target[c.property].apply(this,r)}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}}}]),e}(),Pr={},Ir=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.src,n=void 0===r?"":r,a=t.flipY,o=t.textureType,i=void 0===o?"TEXTURE_2D":o,l=t.magFilter,s=void 0===l?"LINEAR":l,c=t.minFilter,u=void 0===c?"LINEAR_MIPMAP_LINEAR":c,d=t.generateMipmap,p=t.img,m=void 0===p?new Image:p,f=t.wrap,g=void 0===f?{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}:f;vr(this,e),this.src=n,this._loadPromise=null,this.loaded=!1,this.texture=[],this.img=m,this.flipY=void 0===a||a,this.magFilter=s,this.minFilter=u,this.textureType=i,this._generateMipmap=void 0===d||d,this.wrap=g}return xr(e,[{key:"width",get:function(){return this.img.naturalWidth||this.img.width},set:function(e){return this.img.width=e}},{key:"height",get:function(){return this.img.naturalHeight||this.img.height},set:function(e){return this.img.height=e}}]),xr(e,[{key:"load",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return this._loadPromise?this._loadPromise:(Pr[this.src]?(this.img=Pr[this.src],this._loadPromise=new Promise(function(r){e.loaded=!0,e._loadPromise=null,t&&e.setAsTexture(t),r(e)})):(this._loadPromise=new Promise(function(r,n){e.img.onload=function(){e.loaded=!0,e._loadPromise=null,Pr[e.src]=e.img,t&&e.setAsTexture(t),r(e)},e.img.onerror=function(){e.loaded=!1,e._loadPromise=null,n("Error loading image file: '"+e.img.src+"'")}}),this.img.src=this.src),this._loadPromise)}},{key:"unload",value:function(e){e.webgl.deleteTexture(this.texture[e.id])}},{key:"createTexture",value:function(e){this.texture[e.id]=e.webgl.createTexture(),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),e.webgl.pixelStorei(e.webgl.UNPACK_FLIP_Y_WEBGL,this.flipY),e.webgl.texImage2D(e.webgl[this.textureType],0,e.webgl.RGBA,e.webgl.RGBA,e.webgl.UNSIGNED_BYTE,this.img)}},{key:"updateTexture",value:function(e){this._generateMipmap&&e.webgl.generateMipmap(e.webgl[this.textureType])}},{key:"setAsTexture",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return this.img?this.loaded?(this.texture[e.id]||(this.createTexture(e),this.updateTexture(e)),e.webgl.activeTexture(e.webgl["TEXTURE"+t]),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_WRAP_S,e.webgl[this.wrap.s]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_WRAP_T,e.webgl[this.wrap.t]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_MAG_FILTER,e.webgl[this.magFilter]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_MIN_FILTER,e.webgl[this.minFilter]),r&&e.webgl.uniform1i(r,t),e._currentTexture[t]=this,!0):(console.warn("Texture image not yet loaded"),!1):(console.error("Texture has no image loaded"),!1)}}]),e}(),Fr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=void 0===r?"":r,a=t.tracks,o=void 0===a?[]:a,i=t.loop,l=t.enabled,s=t.rate,c=void 0===s?1:s,u=t.paused;vr(this,e),this.name=n,this.tracks=o,this.enabled=void 0!==l&&l,this.paused=void 0!==u&&u,this.rate=c,this.currentTime=0,this.loop=void 0===i||i}return xr(e,[{key:"update",value:function(e){if(this.enabled&&!this.paused&&this.rate){this.currentTime+=e*this.rate;for(var t=!0,r=0;r<this.tracks.length;r++)this.tracks[r].update(e*this.rate,this.currentTime),this.tracks[r].complete||(t=!1);t&&(this.loop?this.reset():this.stop())}}},{key:"pause",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!this.paused;this.paused=e}},{key:"stop",value:function(){this.reset(),this.enabled=!1}},{key:"play",value:function(){this.enabled&&this.reset(),this.enabled=!0}},{key:"reset",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].reset();this.currentTime=0}}]),e}(),Mr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=void 0===r?"":r,a=t.values,o=void 0===a?[[]]:a,i=t.times,l=void 0===i?[]:i,s=t.type,c=void 0===s?"position":s,u=t.parent,d=void 0===u?null:u;vr(this,e),this.name=n,this.values=o,this.times=l,this.type=c,this.parent=d,this.currentTime=0,this.currentFrameStartTime=0,this.currentFrameIndex=0,this.currentFrameValues=this.values[0],this.currentFrameTime=this.times[0],this.nextFrameIndex=0,this.nextFrameValues=this.values[0],this.nextFrameTime=this.times[0],this.complete=!1,this.reset()}return xr(e,[{key:"update",value:function(e,t){if(!this.complete){if(this.currentTime+=e,t>=this.nextFrameTime&&(this.currentFrameStartTime=this.currentFrameTime,this.currentFrameIndex=this.nextFrameIndex,this.currentFrameValues=this.nextFrameValues,this.currentFrameTime=this.nextFrameTime,this.nextFrameIndex++,this.nextFrameValues=this.values[this.nextFrameIndex],this.nextFrameTime=this.times[this.nextFrameIndex],this.nextFrameIndex>=this.times.length))return void(this.complete=!0);var r=(t-this.currentFrameTime)/(this.nextFrameTime-this.currentFrameTime);(r==1/0||r==-Infinity)&&(r=0),this.interpolateLinear(this.currentFrameValues,this.nextFrameValues,r)}}},{key:"interpolateLinear",value:function(e,t,r){if(this.parent)switch(this.type){case"position":this.parent.transform.xyz=[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r];break;case"scale":this.parent.transform.sxyz=[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r];break;case"rotation2":this.parent.transform.rotateFromEuler(e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r);break;case"rotation":switch(t[3]){case"ZYX":this.parent.transform.rotateToZYX(e[2]+(t[2]-e[2])*r,e[1]+(t[1]-e[1])*r,e[0]+(t[0]-e[0])*r);break;case"XYZ":default:this.parent.transform.rotateToXYZ(e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r);}break;case"quaternion":var n=[];Be(n,e,t,r),this.parent.transform.rotationQuat=n;}}},{key:"reset",value:function(){this.currentTime=null,this.currentFrameIndex=0,this.currentFrameValues=this.values[this.currentFrameIndex],this.currentFrameTime=this.times[this.currentFrameIndex],this.nextFrameIndex=0,this.nextFrameValues=this.values[this.nextFrameIndex],this.nextFrameTime=this.times[this.nextFrameIndex],this.update(0,0),this.complete=!1}}]),e}(),Cr=C(),Rr=0,Lr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=void 0===r?"":r,a=t.id,o=void 0===a?Rr++:a,i=t.parent,l=void 0===i?null:i,s=t.children,c=void 0===s?[]:s,u=t.isRoot,d=t.inheritTransform,p=t.transform,m=void 0===p?new wn:p;vr(this,e),this.name=n,this.id=o,this.children=c,this.isRoot=void 0!==u&&u,this.parent=l,this.inheritTransform=void 0===d||d,this.transform=m,this.bindpose=C(),this.inverseBindpose=C(),this.offsetMatrix=C()}return xr(e,[{key:"update",value:function(){}},{key:"add",value:function(e){this.children.add(e),e.parent=this}},{key:"calcBindPose",value:function(){this.calcAbsolutePosition(this.bindpose),U(this.inverseBindpose,this.bindpose)}},{key:"calcAbsolutePosition",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Cr;if(this.parent&&this.inheritTransform&&this.parent.calcAbsolutePosition){var t=new Float32Array(16);this.parent.calcAbsolutePosition(t),B(e,t,this.transform.localMatrix)}else L(e,this.transform.localMatrix)}},{key:"getFlatMatrix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];this.calcAbsolutePosition(Cr),B(Cr,Cr,this.inverseBindpose);for(var n=0;16>n;n++)e[16*t+n]=Cr[n];if(t++,r)for(var a=0;a<this.children.length;a++)t=this.children[a].getFlatMatrix(e,t,!0);return t}}]),e}(),Dr=C(),Or=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.nearPlane,n=void 0===r?1:r,a=e.farPlane,o=void 0===a?1e3:a,i=e.fov,l=void 0===i?.872665:i,s=e.projectionType,c=void 0===s?"projection":s,u=e.followType,d=void 0===u?"STATIC":u,p=e.stiffness,m=void 0===p?.65:p;vr(this,t);var f=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return f._nearPlane=n,f._farPlane=o,f._projectionType=c,f.fov=l,f.viewports=[],f.shaderPasses=[],f.mvTransform=new wn,f.followEntity=null,f.followOffset=[0,0,0],f.followType=d,f.stiffness=m,f.limit={minimum:{x:null,y:null,z:null},maximum:{x:null,y:null,z:null}},f.lock=[null,null,null],f}return br(t,e),xr(t,[{key:"nearPlane",get:function(){return this._nearPlane},set:function(e){return this._nearPlane=e,this._nearPlane}},{key:"farPlane",get:function(){return this._farPlane},set:function(e){return this._farPlane=e,this._farPlane}},{key:"projectionType",get:function(){return this._projectionType},set:function(e){return this._projectionType=e,this._projectionType}}]),xr(t,[{key:"render",value:function(e,t,r,n,a,o,i){n.push(this),Kt(Dr,a,this.transform.localMatrixInversed);var l=!0,s=!1,c=void 0;try{for(var u=t.entities[Symbol.iterator](),d,p;!(l=(d=u.next()).done);l=!0)p=d.value,p!==this&&p.visible&&p.render(e,t,r,this,n,Dr,null,o,i)}catch(e){s=!0,c=e}finally{try{!l&&u.return&&u.return()}finally{if(s)throw c}}n.pop()}},{key:"renderScenePick",value:function(e){for(var t=0;t<this.scene.entities.length;t++)this.scene.entities[t].renderPick(e,this,t)}},{key:"update",value:function(){if(this.followEntity){var e=this.transform.x-this.followOffset[0],t=this.transform.y-this.followOffset[1],r=this.transform.z-this.followOffset[2],n=this.followEntity.transform.x,a=this.followEntity.transform.y,o=this.followEntity.transform.z;switch(this.followType.toUpperCase()){case"EASEIN":e+=gt((n-e)*yt(this.stiffness,2)),t+=gt((a-t)*yt(this.stiffness,2)),r+=gt((o-r)*yt(this.stiffness,2));break;case"EASEOUT":e+=gt((n-e)*this.stiffness),t+=gt((a-t)*this.stiffness),r+=gt((o-r)*this.stiffness);break;case"SPRING":var i={x:this.followEntity.transform.x+this.followOffset[0]-this.transform.x,y:this.followEntity.transform.y+this.followOffset[1]-this.transform.y,z:this.followEntity.transform.z+this.followOffset[2]-this.transform.z};e+=5.5*i.x,t+=6.5*i.y,r+=5.5*i.z;break;case"STATIC":default:e=n,t=a,r=o;}e+=this.followOffset[0],t+=this.followOffset[1],r+=this.followOffset[2],null!==this.limit.minimum.x&&e<this.limit.minimum.x&&(e=this.limit.minimum.x),null!==this.limit.minimum.y&&t<this.limit.minimum.y&&(t=this.limit.minimum.y),null!==this.limit.minimum.z&&r<this.limit.minimum.z&&(r=this.limit.minimum.z),null!==this.limit.maximum.x&&e>this.limit.maximum.x&&(e=this.limit.maximum.x),null!==this.limit.maximum.y&&t>this.limit.maximum.y&&(t=this.limit.maximum.y),null!==this.limit.maximum.z&&r>this.limit.maximum.z&&(r=this.limit.maximum.z),this.transform.translateTo(e,t,r)}null!==this.lock[0]&&this.transform.translateToX(this.lock[0]),null!==this.lock[1]&&this.transform.translateToY(this.lock[1]),null!==this.lock[2]&&this.transform.translateToY(this.lock[2])}},{key:"addViewport",value:function(e){this.viewports.push(e)}},{key:"follow",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[this.transform.x,this.transform.y,this.transform.z];this.followEntity=e,this.followOffset=t}},{key:"lockX",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.transform.x;this.lock[0]=e}},{key:"unlockX",value:function(){this.lock[0]=null}},{key:"lockY",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.transform.y;this.lock[1]=e}},{key:"unlockY",value:function(){this.lock[1]=null}},{key:"lockZ",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.transform.z;this.lock[1]=e}},{key:"unlockZ",value:function(){this.lock[0]=null}},{key:"getFrustum",value:function(e){var t=[[-1,-1,-1,1],[-1,-1,1,1],[-1,1,-1,1],[-1,1,1,1],[1,-1,-1,1],[1,-1,1,1],[1,1,-1,1],[1,1,1,1]],r=[];L(r,e.projectionMatrix),B(r,r,this.transform.localMatrixInversed),U(r,r);var n=!0,a=!1,o=void 0;try{for(var i=t[Symbol.iterator](),l,s;!(n=(l=i.next()).done);n=!0)s=l.value,Fe(s,s,r),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3],s[3]/=s[3]}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return t}},{key:"unproject",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,a=this.farPlane;this._farPlane=this.transform.z,e.evaluate(!1);var o=fe(),i=this.parallax?this.transform.getInverseParallax(this):this.transform.localMatrixInversed,l=this.mvTransform.localMatrix,s=e.projectionMatrix,c=[0,0,e.contextElement.width,e.contextElement.height],u=C();L(u,s),B(u,u,i),B(u,u,l),U(u,u),o[0]=2*((t-c[0])/c[2])-1,o[1]=2*((r-c[1])/c[3])-1,o[2]=2*n-1,o[3]=1;var d=fe();return(Fe(d,o,u),this._farPlane=a,e.evaluate(!1),0==d[3])?null:(d[3]=1/d[3],[d[0]*d[3],d[1]*d[3],d[2]*d[3]])}},{key:"project",value:function(e,t){var r=e.parallax?this.transform.getInverseParallax(this):this.transform.localMatrixInversed,n=this.mvTransform.localMatrix,a=e.projectionMatrix,o=C();L(o,a),B(o,o,r),B(o,o,n);var i=[],l=t.xyz[0],s=t.xyz[1],c=t.xyz[2],u=o[0]*l+o[4]*s+o[8]*c+o[12],d=o[1]*l+o[5]*s+o[9]*c+o[13],p=o[3]*l+o[7]*s+o[11]*c+o[15];return i[0]=(u/p+1)/2,i[1]=1-(d/p+1)/2,i[0]=gt(i[0]*e.contextElement.width),i[1]=gt(i[1]*e.contextElement.height),i}},{key:"getParallaxOffset",value:function(e){return this.transform.getParallaxOffset(e.xyz?e.xyz:e,this)}}]),t}(Nr),Gr;(function(){if(Gr=window&&!1!="performance"in window?window.performance:{},!1=="now"in Gr){var e=new Date().getTime();Gr.timing&&Gr.timing.navigationStart&&(e=Gr.timing.navigationStart),Gr.now=function(){return new Date().getTime()-e}}})();var Ur;(function(){window&&window.requestAnimationFrame&&(Ur=window.requestAnimationFrame);for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!Ur;++r)Ur=window[t[r]+"RequestAnimationFrame"];Ur||(Ur=function(t){var r=new Date().getTime(),n=ht(0,16-(r-e)),a=setTimeout(function(){t(r+n)},n);return e=r+n,a})})();var Br=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.targetCyclesPerSecond,n=void 0===r?60:r,a=t.targetFramesPerSecond,o=void 0===a?30:a,i=t.autoRun;vr(this,e),this._running=!1,this.targetCyclesPerSecond=n,this.targetFramesPerSecond=o,this.frameAccumulatorRemainderThreshold=16,this.renderEnabled=!0,this.stats={fps:0,cps:0,framesThisSecond:0,cyclesThisSecond:0,droppedFramesThisSecond:0,framesSkippedThisSecond:0,renderExecutionTime:0,updateExecutionTime:0,currentGameTime:0,lastUpdate:Gr.now(),lastRender:Gr.now(),lastFrame:Gr.now()},this._r={i:null,newTime:Gr.now(),deltaTime:1e3*(1/this.targetCyclesPerSecond),renderDeltaTime:1e3*(1/this.targetFramesPerSecond),frameAccumulator:0},this.scenes=[],this.viewports=[],(void 0===i||i)&&this.start()}return xr(e,[{key:"start",value:function(){this._running||(this._running=!0,this.update())}},{key:"stop",value:function(){this._running=!1}},{key:"resetAccumulator",value:function(){this.stats.lastFrame=Gr.now(),this._r.frameAccumulator=0}},{key:"update",value:function(){if(this._running){this._r.newTime=Gr.now(),this._r.frameTime=this._r.newTime-this.stats.lastFrame,1e3<this._r.frameTime&&(this._r.frameTime=1e3),this.stats.lastFrame=this._r.newTime,this._r.frameAccumulator+=this._r.frameTime,this.stats.cyclesThisFrame=0,this._r.i=Tt(this._r.frameAccumulator/this._r.deltaTime);for(var e=Gr.now();0<=this._r.i--;){var t=!0,r=!1,n=void 0;try{for(var a=this.scenes[Symbol.iterator](),o,i;!(t=(o=a.next()).done);t=!0)i=o.value,i.enabled&&i.update(this._r.deltaTime)}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}if(this.stats.currentGameTime+=100*this._r.deltaTime,this.stats.cyclesThisFrame++,!this._running)return}if(this.stats.updateExecutionTime=Gr.now()-e,this.stats.cyclesThisSecond+=this.stats.cyclesThisFrame,this._r.frameAccumulator-=this.stats.cyclesThisFrame*this._r.deltaTime,this.stats.droppedFramesThisSecond+=this.stats.cyclesThisSecond-1,this.stats.frameAccumulatorRemainder=this._r.frameAccumulator,e=Gr.now(),this.renderEnabled&&this.stats.cyclesThisFrame){var l=!0,s=!1,c=void 0;try{for(var u=this.scenes[Symbol.iterator](),d,p;!(l=(d=u.next()).done);l=!0)p=d.value,p.render(Gr.now()-this.stats.lastRender)}catch(e){s=!0,c=e}finally{try{!l&&u.return&&u.return()}finally{if(s)throw c}}this.stats.lastRender=Gr.now(),this.stats.framesThisSecond++}else this.stats.framesSkippedThisSecond++;this.stats.renderExecutionTime=Gr.now()-e,1e3<Gr.now()-this.stats.lastUpdate&&(this.stats.fps=this.stats.framesThisSecond,this.stats.cps=this.stats.cyclesThisSecond,this.stats.framesThisSecond=0,this.stats.cyclesThisSecond=0,this.stats.framesSkippedThisSecond=0,this.stats.lastUpdate=Gr.now()),Ur(this.update.bind(this))}}},{key:"cyclesToMilliseconds",value:function(e){return e*this._r.deltaTime}},{key:"millisecondsToCycles",value:function(e){return e/this._r.deltaTime}},{key:"add",value:function(e){this.scenes.push(e)}},{key:"remove",value:function(e){this.scenes.splice(this.scenes.indexOf(e),1)}}]),e}(),Vr=function(){function e(){vr(this,e),this.set.apply(this,arguments),this._color3Float32Array=new Float32Array(3),this._color4Float32Array=new Float32Array(4)}return xr(e,[{key:"red",get:function(){return this.color[0]},set:function(e){return this.color[0]=e}},{key:"green",get:function(){return this.color[1]},set:function(e){return this.color[1]=e}},{key:"blue",get:function(){return this.color[2]},set:function(e){return this.color[2]=e}},{key:"alpha",get:function(){return this.color[3]},set:function(e){return this.color[3]=e}}]),xr(e,[{key:"set",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if("string"==typeof e){var a=this.parseHex(e);this.color=new Float32Array([a[0],a[1],a[2],a[3]])}else e instanceof Array?(void 0===e[3]&&(e[3]=1),this.color=new Float32Array([e[0],e[1],e[2],e[3]])):this.color=new Float32Array([e,t,r,n])}},{key:"toArray",value:function(){return this.color}},{key:"toVec3Array",value:function(){return this._color3Float32Array.set([this.color[0],this.color[1],this.color[2]]),this._color3Float32Array}},{key:"toRGBAArray",value:function(){return this._color4Float32Array.set([255*this.color[0],255*this.color[1],255*this.color[2],this.color[3]]),this._color4Float32Array}},{key:"parseHex",value:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,r,n){return t+t+r+r+n+n});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r&&(this.color[0]=parseInt(r[1],16)/255,this.color[1]=parseInt(r[2],16)/255,this.color[2]=parseInt(r[3],16)/255),this}},{key:"adjustHSL",value:function(e,t,r){var n=this.rgbToHsl();return n[0]+=(e||0)/100,n[1]+=(t||0)/100,n[2]+=(r||0)/100,0>n[0]&&(n[0]=0),0>n[1]&&(n[1]=0),0>n[2]&&(n[2]=0),1<n[0]&&(n[0]=1),1<n[1]&&(n[1]=1),1<n[2]&&(n[2]=1),n=this.hslToRgb(n[0],n[1],n[2]),this.set(n[0],n[1],n[2],this.alpha),this}},{key:"adjustHue",value:function(e){var t=this.rgbToHsl();return t[0]+=(e||0)/100,t=this.hslToRgb(t[0],t[1],t[2]),this.set(t[0],t[1],t[2],this.alpha),this}},{key:"adjustSaturation",value:function(e){var t=this.rgbToHsl();return t[1]+=(e||0)/100,t=this.hslToRgb(t[0],t[1],t[2]),this.set(t[0],t[1],t[2],this.alpha),this}},{key:"adjustLightness",value:function(e){var t=this.rgbToHsl();return t[2]+=(e||0)/100,t=this.hslToRgb(t[0],t[1],t[2]),this.set(t[0],t[1],t[2],this.alpha),this}},{key:"rgbToHsl",value:function(e,t,n){null==e&&(e=this.red,t=this.green,n=this.blue);var a=ht(e,t,n),o=Et(e,t,n),i=(a+o)/2,l,c;if(a==o)l=c=0;else{var u=a-o;c=.5<i?u/(2-a-o):u/(a+o),a===e?l=(t-n)/u+(t<n?6:0):a===t?l=(n-e)/u+2:a===n?l=(e-t)/u+4:void 0,l/=6}return[l,c,i]}},{key:"hslToRgb",value:function(e,t,n){var a,o,i;if(null==e)return[this.red,this.green,this.blue];if(0==t)a=o=i=n;else{var l=.5>n?n*(1+t):n+t-n*t,s=2*n-l;a=this.hue2rgb(s,l,e+1/3),o=this.hue2rgb(s,l,e),i=this.hue2rgb(s,l,e-1/3)}return[gt(a),gt(o),gt(i)]}},{key:"hue2rgb",value:function(e,r,n){return 0>n&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(r-e)*n:n<1/2?r:n<2/3?e+6*((r-e)*(2/3-n)):e}}]),e}(),Hr=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.count,n=void 0===r?1e3:r,a=e.life,o=void 0===a?1e3:a,i=e.rate,l=void 0===i?1e3:i,s=e.offset,c=void 0===s?[0,0,0]:s,u=e.velocity,d=void 0===u?[0,0,0]:u;vr(this,t);var p=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return p._r={i:null,frameTime:0,timeAccumulator:0},p.warmed=!1,p.rate=l,p.life=o,p.offset=c,p.velocity=d,p.particles=[],p.particleAge=[],p.count=n,p}return br(t,e),xr(t,[{key:"count",get:function(){return this.particles.length},set:function(e){this.particles.length=e,this.particleAge.length=e,this.warmed=!1}}]),xr(t,[{key:"render",value:function(e,r,n,a,o){yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this,e,r,n,a,o);for(var l=0;l<this.particles.length;l++)this.particles[l].visible&&this.particles[l].render(e,r,n,a,o,this)}},{key:"update",value:function(e,r,n){yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,r,n),this.warmed||this.prewarm();for(var a=0;a<this.particles.length;a++)this.particles[a].enabled&&(this.particles[a].transform.translate(this.velocity[0],this.velocity[1],this.velocity[2]),this.particleAge[a]+=e,this.particleAge[a]>=this.life&&(this.particles[a].enabled=!1,this.particles[a].visible=!1));if(this.rate)for(this._r.timeAccumulator+=e,this._r.i=Tt(this._r.timeAccumulator/this.rate);0<=this._r.i--;)this.emit(),this._r.timeAccumulator-=this.rate}},{key:"entityCreate",value:function(){}},{key:"prewarm",value:function(){for(var e=0;e<this.particles.length;e++)this.particles[e]||(this.particles[e]=this.entityCreate(e),this.particles[e].enabled=!1,this.particles[e].visible=!1,this.particleAge[e]=0);this.warmed=!0}},{key:"emit",value:function(){for(var e=0;e<this.particles.length;e++)if(!this.particles[e].enabled)return this.particles[e].enabled=!0,this.particles[e].visible=!0,this.particleAge[e]=0,void this.particles[e].transform.translateTo(this.offset[0],this.offset[1],this.offset[2])}}]),t}(kr),zr=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?1024:r,a=e.height,o=void 0===a?1024:a,i=e.flipY,l=e.textureType,s=void 0===l?"TEXTURE_2D":l,c=e.magFilter,u=void 0===c?"LINEAR":c,d=e.minFilter,p=void 0===d?"LINEAR":d,m=e.generateMipmap,f=e.wrap,g=void 0===f?{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}:f;vr(this,t);var h=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return h.framebuffer=null,h.framebufferWidth=n,h.framebufferHeight=o,h.flipY=void 0!==i&&i,h.magFilter=u,h.minFilter=p,h.textureType=s,h.wrap=g,h.generateMipmap=void 0!==m&&m,h.useDepthBuffer=!0,h.loaded=!0,h}return br(t,e),xr(t,[{key:"width",get:function(){return this.framebufferWidth},set:function(e){return this.framebufferWidth=e}},{key:"height",get:function(){return this.framebufferHeight},set:function(e){return this.framebufferHeight=e}}]),xr(t,[{key:"bind",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.width,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this.height,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:e.webgl[this.textureType];this.texture[e.id]&&r===this.width&&n===this.height||(this.width=r,this.height=n,this.texture[e.id]&&this.unload(e),this.createTexture(e)),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),this.framebuffer||(this.framebuffer=e.webgl.createFramebuffer(),this.width=r,this.height=n),this.img=this.framebuffer,e.webgl.bindFramebuffer(e.webgl.FRAMEBUFFER,this.framebuffer),e.webgl.framebufferRenderbuffer(e.webgl.FRAMEBUFFER,e.webgl.DEPTH_ATTACHMENT,e.webgl.RENDERBUFFER,this.depthBuffer),e.webgl.viewport(0,0,this.width,this.height),e.webgl.framebufferTexture2D(e.webgl.FRAMEBUFFER,e.webgl.COLOR_ATTACHMENT0,a,this.texture[e.id],0),e._currentTexture[t]=this}},{key:"unbind",value:function(e){e.webgl.bindFramebuffer(e.webgl.FRAMEBUFFER,null),e.webgl.viewport(0,0,e.width,e.height)}},{key:"createTexture",value:function(e){this.texture[e.id]=e.webgl.createTexture(),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),e.webgl.pixelStorei(e.webgl.UNPACK_FLIP_Y_WEBGL,this.flipY);var t=this.framebufferWidth,r=this.framebufferHeight,n=0,a=e.webgl.RGBA,o=0,l=e.webgl.RGBA,s=e.webgl.UNSIGNED_BYTE,c=null;if("TEXTURE_CUBE_MAP"===this.textureType)for(var u=0;6>u;u++)e.webgl.texImage2D(e.webgl.TEXTURE_CUBE_MAP_POSITIVE_X+u,n,a,t,r,o,l,s,c);else e.webgl.texImage2D(e.webgl[this.textureType],n,a,t,r,o,l,s,c);this.useDepthBuffer&&(this.depthBuffer=e.webgl.createRenderbuffer(),e.webgl.bindRenderbuffer(e.webgl.RENDERBUFFER,this.depthBuffer),e.webgl.renderbufferStorage(e.webgl.RENDERBUFFER,e.webgl.DEPTH_COMPONENT16,t,r))}},{key:"updateTexture",value:function(){}}]),t}(Ir),Wr=function(){function e(t){vr(this,e),this.program=t.webgl.createProgram(),this.attribute={},this.uniform={},this.fragmentShader="",this.vertexShader=""}return xr(e,[{key:"addVertexShader",value:function(e,t){var r=e.webgl.createShader(e.webgl.VERTEX_SHADER);if(e.webgl.shaderSource(r,t),e.webgl.compileShader(r),e.webgl.attachShader(this.program,r),!e.webgl.getShaderParameter(r,e.webgl.COMPILE_STATUS))throw"An error occurred compiling the vertex shader: "+e.webgl.getShaderInfoLog(r);this.vertexShader=t}},{key:"addFragmentShader",value:function(e,t){var r=e.webgl.createShader(e.webgl.FRAGMENT_SHADER);if(e.webgl.shaderSource(r,t),e.webgl.compileShader(r),e.webgl.attachShader(this.program,r),!e.webgl.getShaderParameter(r,e.webgl.COMPILE_STATUS))throw"An error occurred compiling the fragment shader: "+e.webgl.getShaderInfoLog(r);this.fragmentShader=t}},{key:"getAttributesFromShaders",value:function(e){for(var t=e.webgl.getProgramParameter(this.program,e.webgl.ACTIVE_ATTRIBUTES),r=0,n;r<t;r++)n=e.webgl.getActiveAttrib(this.program,r),this.attribute[n.name]=e.webgl.getAttribLocation(this.program,n.name),0>this.attribute[n.name]&&delete this.attribute[n.name]}},{key:"getUniformLocations",value:function(e){for(var t=e.webgl.getProgramParameter(this.program,e.webgl.ACTIVE_UNIFORMS),r=0,n;r<t;r++)n=e.webgl.getActiveUniform(this.program,r),this.uniform[n.name]=e.webgl.getUniformLocation(this.program,n.name),0>this.uniform[n.name]&&delete this.uniform[n.name]}},{key:"use",value:function(e){e.webgl.useProgram(this.program)}}]),e}(),jr=C(),Xr=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=void 0===r?"Light_"+_id$3++:r,a=e.transform,o=void 0===a?new wn:a,i=e.ambientColor,l=void 0===i?new Vr(0,0,0,1):i,s=e.diffuseColor,c=void 0===s?new Vr(1,1,1,1):s,u=e.specularColor,d=void 0===u?new Vr(1,1,1,1):u,p=e.intensity,m=void 0===p?1:p,f=e.maxDistance,g=void 0===f?128:f;vr(this,t);var h=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return h.ambientColor=l,h.diffuseColor=c,h.specularColor=d,h.intensity=m,h.maxDistance=g,h.projectionMatrix=C(),O(h.projectionMatrix),h}return br(t,e),xr(t,[{key:"getMVPMatrix",value:function(e,t){return Y(this.projectionMatrix,1.5708,1,.01,this.maxDistance),L(jr,this.projectionMatrix),t&&Kt(jr,jr,t),Kt(jr,jr,this.transform.localMatrixInversed),e&&Kt(jr,jr,e),jr}}]),t}(Nr),Yr=C(),qr=C(),Kr=C(),Qr=C(),Jr=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=void 0===r?"DirectionalLight_"+_id$4++:r,a=e.vector,o=void 0===a?[0,-1,0]:a;vr(this,t);var i=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return i.vector=o,i.maxShadowDistance=50,i}return br(t,e),xr(t,[{key:"getMVPMatrix",value:function(e,t){var r=1/0,n=-Infinity,a=1/0,o=-Infinity,l=1/0,s=-Infinity,c=t.camera.getFrustum(t),u=St(c[7][0]-c[0][0])/this.maxShadowDistance,d=St(c[7][1]-c[0][1])/this.maxShadowDistance,p=St(c[7][2]-c[0][2])/this.maxShadowDistance,m=[0,0,0],f=!0,g=!1,h=void 0;try{for(var v=c[Symbol.iterator](),x,y;!(f=(x=v.next()).done);f=!0)y=x.value,m[0]+=y[0],m[1]+=y[1],m[2]+=y[2]}catch(e){g=!0,h=e}finally{try{!f&&v.return&&v.return()}finally{if(g)throw h}}for(var b=0;3>b;b++)m[b]/=8;var _=[];se(_,this.vector),_[0]+=m[0],_[1]+=m[1],_[2]+=m[2],K(qr,m,_,[0,1,0]);var T=!0,S=!1,E=void 0;try{for(var w=c[Symbol.iterator](),k,A;!(T=(k=w.next()).done);T=!0)A=k.value,Fe(A,A,qr),r=Et(r,A[0]),n=ht(n,A[0]),a=Et(a,A[1]),o=ht(o,A[1]),l=Et(l,A[2]),s=ht(s,A[2])}catch(e){S=!0,E=e}finally{try{!T&&w.return&&w.return()}finally{if(S)throw E}}q(Kr,-1,1,-1,1,l,s),u=Et(2/(n-r),2/this.maxShadowDistance),d=Et(2/(o-a),2/this.maxShadowDistance),p=Et(1/(s-l),1/this.maxShadowDistance);var N=-.5*(r+n)*u,P=-.5*(a+o)*d,I=-l*p;return Qr[0]=u,Qr[5]=d,Qr[10]=p,Qr[12]=N,Qr[13]=P,Qr[14]=I,Kt(Yr,Qr,Kr),Kt(Yr,Yr,qr),e&&Kt(Yr,Yr,e),Yr}}]),t}(Xr),Zr=C(),$r=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.constantAttenuation=1,e.linearAttenuation=1,e.quadraticAttenuation=1,e}return br(t,e),xr(t,[{key:"getMVPMatrix",value:function(e,t,r){return Y(this.projectionMatrix,1.5708,1,.01,this.maxDistance),L(Zr,this.projectionMatrix),r&&Kt(Zr,Zr,r),Kt(Zr,Zr,this.transform.localMatrixInversed),e&&Kt(Zr,Zr,e),Zr}}]),t}(Xr),en=C(),tn=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.spotDirection=[0,-1,0],e.spotExponent=1,e.spotCutoff=1,e.constantAttenuation=1,e.linearAttenuation=1,e.quadraticAttenuation=1,e}return br(t,e),xr(t,[{key:"getMVPMatrix",value:function(e,t){return Y(this.projectionMatrix,1.5708,1,.01,this.maxDistance),L(en,this.projectionMatrix),t&&Kt(en,en,t),Kt(en,en,this.transform.localMatrixInversed),e&&Kt(en,en,e),en}}]),t}(Xr),rn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=void 0===r?"NURBSCurve_"+_id$7++:r,a=e.arcLengthDivisions,o=void 0===a?5:a,i=e.controlPoints,l=void 0===i?[]:i,s=e.degree,c=void 0===s?3:s,u=e.knots,d=void 0===u?[]:u,p=e.startKnot,m=void 0===p?0:p,f=e.endKnot,g=void 0===f?d.length-1:f;vr(this,t);var h=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return h.arcLengthDivisions=o,h.controlPoints=l,h.degree=c,h.knots=d,h.startKnot=m,h.endKnot=g,h.valid=!0,h}return br(t,e),xr(t,[{key:"calcBasisFunctions",value:function(e,t,n,a){var o=[],i=[],l=[];o[0]=1;for(var s=1;s<=n;++s){i[s]=t-a[e+1-s],l[s]=a[e+s]-t;for(var c=0,u=0;u<s;++u){var d=l[u+1],p=i[s-u],m=o[u]/(d+p);o[u]=c+d*m,c=p*m}o[s]=c}return o}},{key:"calcBSplinePoint",value:function(e,t,r,n){for(var a=this.findSpan(e,n,t),o=this.calcBasisFunctions(a,n,e,t),i=[0,0,0,0],l=0;l<=e;++l){var s=r[a-e+l],c=o[l],u=s[3]*c;i[0]+=s[0]*u,i[1]+=s[1]*u,i[2]+=s[2]*u,i[3]+=s[3]*c}return i}},{key:"findSpan",value:function(e,t,r){var a=r.length-e-1;if(t>=r[a])return r.indexOf(r[a])-1;if(t<=r[e])return e;for(var n=e,o=a,i=Tt((n+o)/2);t<r[i]||t>=r[i+1];)t<r[i]?o=i:n=i,i=Tt((n+o)/2);return i}},{key:"getLengths",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&this.valid)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],r=this.getPoint(0),n=0,a,o;for(t.push(0),o=1;o<=e;o++)a=this.getPoint(o/e),n+=oe(a,r),t.push(n),r=a;return this.cacheArcLengths=t,t}},{key:"getPoint",value:function(e){var t=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=this.calcBSplinePoint(this.degree,this.knots,this.controlPoints,t);return 1!=r[3]&&Se(r,r,1/r[3]),[r[0],r[1],r[2],r[3]]}},{key:"getPointAt",value:function(e){var r=this.getUtoTmapping(e);return this.getPoint(r)}},{key:"getUtoTmapping",value:function(e,r){var n=this.getLengths(),a=0,o=n.length,l;l=r?r:e*n[o-1];for(var s=0,c=o-1,u;s<=c;)if(a=Tt(s+(c-s)/2),u=n[a]-l,0>u)s=a+1;else if(0<u)c=a-1;else{c=a;break}if(a=c,n[a]===l)return a/(o-1);var d=n[a],p=n[a+1],m=(l-d)/(p-d),f=(a+m)/(o-1);return f}}]),t}(kr),nn=[-1,-1,0,1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,1,0],an=C(),on=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=void 0===r?"":r,a=t.depthTest,o=t.depthFunc,i=void 0===o?"LEQUAL":o,l=t.depthMask,s=t.depthRangeNear,c=void 0===s?0:s,u=t.depthRangeFar,d=void 0===u?1:u,p=t.cullFace,m=t.cullFaceMode,f=void 0===m?"BACK":m,g=t.frontFace,h=void 0===g?"CCW":g;vr(this,e),this.name=n,this.program=[],this.vbuffer=null,this.blend=!0,this.depthTest=void 0===a||a,this.depthFunc=i,this.depthMask=void 0===l||l,this.depthRangeNear=c,this.depthRangeFar=d,this.cullFace=void 0===p||p,this.cullFaceMode=f,this.frontFace=h,this.timeOffset=0,this.buffers={screenVertices:[]}}return xr(e,[{key:"render",value:function(e,t,r,n,a,o,i){this.program[r.id]||(this.program[r.id]=r.createProgram(this)),r.useProgram(this.program[r.id]),this.blend?(r.webgl.enable(r.webgl.BLEND),r.webgl.blendFuncSeparate(r.webgl.SRC_ALPHA,r.webgl.ONE_MINUS_SRC_ALPHA,r.webgl.ZERO,r.webgl.ONE)):r.webgl.disable(r.webgl.BLEND),this.depthTest?(r.webgl.enable(r.webgl.DEPTH_TEST),r.webgl.depthMask(this.depthMask),r.webgl.depthFunc(r.webgl[this.depthFunc]),r.webgl.depthRange(this.depthRangeNear,this.depthRangeFar)):r.webgl.disable(r.webgl.DEPTH_TEST),this.cullFace?(r.webgl.enable(r.webgl.CULL_FACE),r.webgl.cullFace(r.webgl[this.cullFaceMode]),r.webgl.frontFace(r.webgl[this.frontFace])):r.webgl.disable(r.webgl.CULL_FACE),void 0!==r.program.attribute.aVertexScreenPosition&&(!this.buffers.screenVertices[r.id]&&(this.buffers.screenVertices[r.id]=r.webgl.createBuffer(),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.screenVertices[r.id]),r.webgl.bufferData(r.webgl.ARRAY_BUFFER,new Float32Array(nn),r.webgl.STATIC_DRAW)),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.screenVertices[r.id]),r.webgl.vertexAttribPointer(r.program.attribute.aVertexScreenPosition,3,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexScreenPosition)),void 0!==r.program.uniform.uMVCPMatrix&&(Kt(an,o,i),r.webgl.uniformMatrix4fv(r.program.uniform.uMVCPMatrix,!1,an)),void 0!==r.program.uniform.uCMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uCMatrix,!1,n.transform.localMatrixInversed),void 0!==r.program.uniform.uMVMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uMVMatrix,!1,n.mvTransform.localMatrix),void 0!==r.program.uniform.uVMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uVMatrix,!1,o),void 0!==r.program.uniform.uMMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uMMatrix,!1,i),void 0!==r.program.uniform.uCameraPosition&&r.webgl.uniform3fv(r.program.uniform.uCameraPosition,n.transform.xyz),void 0!==r.program.uniform.iTime&&r.webgl.uniform1f(r.program.uniform.iTime,(t.clock.stats.currentGameTime+this.timeOffset)/1e5),void 0!==r.program.uniform.uNormalMatrix&&(U(an,i),G(an,an),r.webgl.uniformMatrix4fv(r.program.uniform.uNormalMatrix,!1,an)),void 0!==r.program.uniform.uTMatrix&&(r.parallax?r.webgl.uniformMatrix4fv(r.program.uniform.uTMatrix,!1,entity.transform.getParallaxMat4(n)):r.webgl.uniformMatrix4fv(r.program.uniform.uTMatrix,!1,entity.transform.localMatrix))}},{key:"setValues",value:function(){}}]),e}(),ln=C(),sn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=void 0===r?"Mesh_"+_id$8++:r,a=e.material,o=void 0===a?new ia:a,i=e.vertices,l=void 0===i?new Float32Array(0):i,s=e.uvs,c=void 0===s?new Float32Array(0):s,u=e.normals,d=void 0===u?new Float32Array(0):u,p=e.weights,m=void 0===p?new Float32Array(0):p,f=e.weightIndices,g=void 0===f?new Float32Array(0):f,h=e.parameters,v=e.faces,x=e.bufferUsage,y=void 0===x?{vertices:"STATIC_DRAW",uvs:"STATIC_DRAW",normals:"STATIC_DRAW",weights:"STATIC_DRAW",weightIndices:"STATIC_DRAW"}:x;vr(this,t);var b=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return b.material=o,b.vertices=l,b.uvs=c,b.normals=d,b.weights=m,b.weightIndices=g,b.castShadow=!0,b.receiveShadow=!0,b.buffers={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},b.valid={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},b.bufferUsage=y,b}return br(t,e),xr(t,[{key:"update",value:function(){}},{key:"render",value:function(e,t,r,n,a,o,i){var l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:this.material,s=arguments[8];l&&this.vertices.length&&(a.push(this),Kt(ln,i,this.transform.localMatrix),!1===l.render(e,t,r,n,a,o,ln,s)||(void 0!==r.program.attribute.aVertexPosition&&((!this.buffers.vertices[r.id]||!this.valid.vertices[r.id])&&(this.buffers.vertices[r.id]=r.webgl.createBuffer(),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.vertices[r.id]),r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.vertices,r.webgl[this.bufferUsage.vertices]),this.valid.vertices[r.id]=!0),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.vertices[r.id]),r.webgl.vertexAttribPointer(r.program.attribute.aVertexPosition,3,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexPosition)),void 0!==r.program.attribute.aTextureCoord&&((!this.buffers.uvs[r.id]||!this.valid.uvs[r.id])&&(this.buffers.uvs[r.id]=r.webgl.createBuffer(),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.uvs[r.id]),r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.uvs,r.webgl[this.bufferUsage.uvs]),this.valid.uvs[r.id]=!0),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.uvs[r.id]),r.webgl.vertexAttribPointer(r.program.attribute.aTextureCoord,2,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aTextureCoord)),void 0!==r.program.attribute.aVertexNormal&&((!this.buffers.normals[r.id]||!this.valid.normals[r.id])&&(this.buffers.normals[r.id]=r.webgl.createBuffer(),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.normals[r.id]),r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.normals,r.webgl[this.bufferUsage.normals]),this.valid.normals[r.id]=!0),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.normals[r.id]),r.webgl.vertexAttribPointer(r.program.attribute.aVertexNormal,3,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexNormal)),void 0!==r.program.attribute.aVertexWeights&&((!this.buffers.weights[r.id]||!this.valid.weights[r.id])&&(this.buffers.weights[r.id]=r.webgl.createBuffer(),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.weights[r.id]),r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.weights,r.webgl[this.bufferUsage.weights]),this.valid.weights[r.id]=!0),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.weights[r.id]),r.webgl.vertexAttribPointer(r.program.attribute.aVertexWeights,4,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexWeights)),void 0!==r.program.attribute.aVertexWeightIndices&&((!this.buffers.weightIndices[r.id]||!this.valid.weightIndices[r.id])&&(this.buffers.weightIndices[r.id]=r.webgl.createBuffer(),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.weightIndices[r.id]),r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.weightIndices,r.webgl[this.bufferUsage.weightIndices]),this.valid.weightIndices[r.id]=!0),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.weightIndices[r.id]),r.webgl.vertexAttribPointer(r.program.attribute.aVertexWeightIndices,4,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexWeightIndices)),void 0!==r.program.uniform["uDeformMatrix[0]"]&&r.webgl.uniformMatrix4fv(r.program.uniform["uDeformMatrix[0]"],!1,a[a.length-2].skeleton.getFlatMatrix(a[a.length-3].transform.localMatrix)),r.webgl.drawArrays(r.webgl.TRIANGLES,0,this.vertices.length/3),a.pop()))}},{key:"invalidate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],a=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];this.valid={vertices:e?[]:this.valid.vertices,uvs:t?[]:this.valid.uvs,normals:r?[]:this.valid.normals,weights:n?[]:this.valid.weights,weightIndices:a?[]:this.valid.weightIndices}}},{key:"addPlane",value:function(e,t){function r(e,t){var r=e.length,n=new Float32Array(r+t.length);return n.set(e),n.set(t,r),n}return this.vertices=r(this.vertices,[0,0,0,1*e,0,0,1*e,1*t,0,0,1*t,0,0,0,0,1*e,1*t,0]),this.uvs=r(this.uvs,[0,1,1,1,1,0,0,0,0,1,1,0]),this.normals=r(this.normals,[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]),this.invalidate(),this}},{key:"addCube",value:function(){function e(e,t){var r=e.length,n=new Float32Array(r+t.length);return n.set(e),n.set(t,r),n}return this.vertices=e(this.vertices,[-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5]),this.uvs=e(this.vertices,[0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,1,1,0,1,1,0,1,0,0,1,0,0,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1]),this.normals=e(this.vertices,[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),this.invalidate(),this}}]),t}(kr),cn=C(),un=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.materials,n=e.meshes,a=void 0===n?[]:n,o=e.bones,i=void 0===o?[]:o,l=e.skeleton,s=void 0===l?null:l,c=e.skeletalAnimations,u=void 0===c?[]:c,d=e.animationClips,p=void 0===d?[]:d;vr(this,t);var m=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return m.meshes=a,m.animationClips=p,m.bones=i,m.skeleton=s,m.skeletalAnimations=u,m}return br(t,e),xr(t,[{key:"update",value:function(e){this.skeleton&&this.skeleton.update(e);for(var t=0;t<this.animationClips.length;t++)this.animationClips[t].update(e)}},{key:"render",value:function(e,t,r,n,a,o,l,s,c){a.push(this),Kt(cn,l,this.transform.localMatrix);for(var u=0;u<this.meshes.length;u++)this.meshes[u].render(e,t,r,n,a,o,cn,s,c);a.pop()}},{key:"renderPick",value:function(e,t,r,n){}},{key:"calcParentMatrix",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:cn}}]),t}(kr),dn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.count,n=e.life,a=e.rate,o=e.velocity,i=e.offset,l=e.spriteOptions,s=void 0===l?{}:l;vr(this,t);var c=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,arguments[0]));return c.sprites=[],c.spriteOptions=s,c}return br(t,e),xr(t,[{key:"entityCreate",value:function(e){return this.sprites[e]||(this.sprites[e]=new Tn(this.spriteOptions)),this.sprites[e]}}]),t}(Hr),pn=function(){function e(){vr(this,e)}return xr(e,[{key:"preloadTextures",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},a=e.length,o={};return new Promise(function(i,l){a||i();var s=!0,c=!1,u=void 0;try{for(var d=e[Symbol.iterator](),p,m;!(s=(p=d.next()).done);s=!0)m=p.value,n.src=m,o[m]=new Ir(n),o[m].load(r).then(function(){if(a--,t){var r=(e.length-a)/e.length;t(r,e.length-a)}a||i(o)}).catch(function(){l.apply(void 0,arguments)})}catch(e){c=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(c)throw u}}})}}]),e}(),mn=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.renderPasses,n=void 0===r?[]:r,a=t.frameBufferTexture,o=void 0===a?null:a,i=t.viewportClear;vr(this,e),this.renderPasses=n,this.frameBufferTexture=o,this.viewportClear=void 0===i||i}return xr(e,[{key:"render",value:function(e,t,r,n,a){var o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[];this.frameBufferTexture?(o.push(this.frameBufferTexture),this.frameBufferTexture.bind(r,0,r.width,r.height),this.viewportClear&&r.clear(),r.render(e,t,n,a,void 0,o),this.frameBufferTexture.unbind(r)):(this.viewportClear&&r.clear(),r.render(e,t,n,a,void 0,o));var i=!0,l=!1,s=void 0;try{for(var c=this.renderPasses[Symbol.iterator](),u,d;!(i=(u=c.next()).done);i=!0)d=u.value,d.render(e,t,r,n,a,void 0,o)}catch(e){l=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw s}}this.frameBufferTexture&&o.pop()}}]),e}(),fn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.material,n=void 0===r?null:r;vr(this,t);var a=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return a.material=n,a}return br(t,e),xr(t,[{key:"render",value:function(e,t,r,n,a){var o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[];this.frameBufferTexture?(o.push(this.frameBufferTexture),this.frameBufferTexture.bind(r,0,"TEXTURE_2D",r.width,r.height),this.viewportClear&&r.clear(),this.material.render(e,t,r,n,a,o),this.frameBufferTexture.unbind(r)):(this.viewportClear&&r.clear(),this.material.render(e,t,r,n,a,o));var i=!0,l=!1,s=void 0;try{for(var c=this.renderPasses[Symbol.iterator](),u,d;!(i=(u=c.next()).done);i=!0)d=u.value,d.render(e,t,r,n,a,o)}catch(e){l=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw s}}this.frameBufferTexture&&o.pop()}}]),t}(mn),gn=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{map:[],clock:null};vr(this,e),this.map=t.map,this.currentController=[],this.clock=t.clock,this.routeViews=[],this.scenes=[],this.queryDOM()}return xr(e,[{key:"navigate",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=r.view,a=void 0===n?"main":n;this.routeUnload(this.currentController[a],a);var o=this.map[e];if(!o)return!1;this.queryDOM();var i=!0,l=!1,s=void 0;try{for(var c=this.routeViews[Symbol.iterator](),u,d;!(i=(u=c.next()).done);i=!0)d=u.value,a&&a!=d.id&&a.id!=d||o.module.populateDOM(d)}catch(e){l=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw s}}return o.module.onload(t),o.module.start(),this.currentController[a]=o.module,this.currentRoute=o,this.clock&&!o.module.clock&&(this.clock.add(o.module),this.clock.resetAccumulator()),!0}},{key:"modal",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},n=arguments[3],a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},o=a.view,i=void 0===o?"main":o,l=this.map[e];if(!l)return!1;this.queryDOM();var s=!0,c=!1,u=void 0;try{for(var d=this.routeViews[Symbol.iterator](),p,m;!(s=(p=d.next()).done);s=!0)m=p.value,i&&i!=m.id&&i.id!=m||l.module.populateDOM(m)}catch(e){c=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(c)throw u}}return l.module.onload(n),l.module.start(),l.module._modal={callee:this,module:l.module,view:i,onResolve:t,onReject:r},this.currentController[i]=l.module,this.currentRoute=l,this.clock&&(this.clock.add(l.module),this.clock.resetAccumulator()),l.module._modal}},{key:"modalResult",value:function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];t&&(r&&this.routeUnload(t.module,t.view),e?t.onResolve():t.onReject())}},{key:"modalUnload",value:function(e){e&&this.routeUnload(e.module,e.view)}},{key:"queryDOM",value:function(){this.routeViews=[];for(var e=document.getElementsByTagName("onyx-route-view"),t=0;t<e.length;t++)this.routeViews.push(e[t]);!this.routeViews.length&&document.getElementById("onyx-route-view")&&this.routeViews.push(document.getElementById("onyx-route-view"))}},{key:"routeUnload",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(e){e.stop(),this.clock&&this.clock.remove(e);var r=!0,n=!1,a=void 0;try{for(var o=this.routeViews[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)l=i.value,t&&t!=l.id&&t.id!=l||(e.onunload(l),e.clearDom(l))}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}}}]),e}(),hn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.template,n=void 0===r?null:r,a=e.templateURL,o=void 0===a?null:a,i=e.sceneURL,l=void 0===i?null:i,s=e.element,c=void 0===s?"":s,u=e.clock,d=void 0===u?null:u;vr(this,t);var p=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return p.viewports=[],p.viewportElements=[],p.entities=[],p.removeEntities=[],p.cameras=[],p.lights=[],p.renderPasses=[new jn({renderPasses:[new mn]})],p.templateURL=o,p.sceneURL=l,p.template=n,p.clock=d,p.ambientLightColor=new Vr(.05,.05,.05,1),p.directionalLight=new Jr({id:"DirectionalLight_Default",diffuseColor:new Vr(.5,.5,.5,1),intensity:2,vector:[-.85,-.8,-.75]}),p.fogColor=new Vr(1,1,1,1),p.fogDensity=0,c&&(p.element=document.querySelector(c),!p.element&&console.warn("[Onyx] Element '"+c+"' not found")),d&&d.add(p),p.queryDOM(p.element),p.loadSceneURL(),p.loadTemplateURL(),p}return br(t,e),xr(t,[{key:"registerHandler",value:function(e){var t=this,r=e.elementId?document.getElementById(e.elementId):document.body;return r?void window.setTimeout(function(){e.callback=e.target[e.property].bind(t),r.addEventListener?r.addEventListener(e.event,e.callback):r[e.event]=e.callback},0):void console.warn("[Onyx] Element \""+e.elementId+"\" not found")}},{key:"unregisterHandler",value:function(e){var t=e.elementId?document.getElementById(e.elementId):document.body;return t?void(t.addEventListener?t.removeEventListener(e.event,e.callback):t[e.event]=null):void console.warn("[Onyx] Element \""+e.elementId+"\" not found")}},{key:"modalResult",value:function(e,t){this._modal&&this._modal.callee.modalResult(e,this._modal,t)}},{key:"modalUnload",value:function(){this._modal&&this._modal.callee.modalUnload(this._modal)}},{key:"loadSceneURL",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.sceneURL;return!!t&&void this.fetchTemplate(t).then(function(t){e.scene=t})}},{key:"loadTemplateURL",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.templateURL;return!!t&&void this.fetchTemplate(t).then(function(t){e.template=t})}},{key:"onload",value:function(){for(var e=arguments.length,r=Array(e),n=0,a;n<e;n++)r[n]=arguments[n];(a=yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onload",this)).call.apply(a,[this].concat(r)),this.element&&this.queryDOM(this.element)}},{key:"onunload",value:function(){for(var e=arguments.length,r=Array(e),n=0,a;n<e;n++)r[n]=arguments[n];(a=yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onunload",this)).call.apply(a,[this].concat(r)),this.entities=[],this.viewports=[],this.viewportElements=[],this.components=[],this.element&&(this.element.innerHTML="",this.element.style.display="none")}},{key:"populateDOM",value:function(e){null!==this.template&&void 0!==this.template&&(e.innerHTML=this.template),this.element&&(this.element.style.display="block"),this.queryDOM(this.element)}},{key:"clearDom",value:function(e){e&&(e.innerHTML="")}},{key:"queryDOM",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document.body;this.viewportElements=[];for(var t=e.getElementsByTagName("onyx-viewport"),r=0;r<t.length;r++)this.viewportElements.push(t[r]);if("undefined"!=typeof document.querySelectorAll&&!navigator.isCocoonJS){t=e.querySelectorAll("[onyx-viewport]");for(var r=0;r<t.length;r++)this.viewportElements.push(t[r])}else{t=e.getElementsByTagName("*");for(var r=0,n;r<t.length;r++)n=t[r],("undefined"!=typeof n["onyx-viewport"]||n.hasAttribute&&n.hasAttribute("onyx-viewport"))&&this.viewportElements.push(n)}var a=!0,o=!1,l=void 0;try{for(var s=this.viewportElements[Symbol.iterator](),c,u;!(a=(c=s.next()).done);a=!0)u=c.value,this.viewports.push(new Vn(u))}catch(e){o=!0,l=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw l}}}},{key:"render",value:function(e){if(this.visible){var t=!0,r=!1,n=void 0;try{for(var a=this.renderPasses[Symbol.iterator](),o;!(t=(o=a.next()).done);t=!0){var i=o.value,l=!0,s=!1,c=void 0;try{for(var u=this.viewports[Symbol.iterator](),d,p;!(l=(d=u.next()).done);l=!0)p=d.value,i.render(e,this,p,[this],this.transform.localMatrix)}catch(e){s=!0,c=e}finally{try{!l&&u.return&&u.return()}finally{if(s)throw c}}}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}}},{key:"update",value:function(e){if(yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,this),!!this.enabled){var r=!0,n=!1,a=void 0;try{for(var o=this.entities[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)l=i.value,l.update(e,this)}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}var s=!0,c=!1,u=void 0;try{for(var d=this.removeEntities[Symbol.iterator](),p,m;!(s=(p=d.next()).done);s=!0)m=p.value,this.remove(m,!1)}catch(e){c=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(c)throw u}}this.removeEntities=[]}}},{key:"add",value:function(e){this.entities.push(e),e.onSpawn&&e.onSpawn(this),e instanceof Or&&this.cameras.push(e),(e instanceof Xr||e instanceof $r||e instanceof tn)&&(this.lights.push(e),this.lights.length>Vt.MAX_LIGHTS&&console.warn("[Onyx] Warning: Light count greater than MAX_LIGHTS."))}},{key:"addRenderPass",value:function(e){this.renderPasses.push(e)}},{key:"remove",value:function(e,t){t?this.removeEntities.push(e):-1<this.entities.indexOf(e)&&(this.entities.splice(this.entities.indexOf(e),1),e.onDestroy&&e.onDestroy(this))}},{key:"start",value:function(){this.clock&&this.clock.start()}},{key:"stop",value:function(){this.clock&&this.clock.stop()}},{key:"setTimeout",value:function(e,t){var r=this,n=new Mn;return this.add(n),n.setTimeout(function(){r.remove(n),e&&e()},t),n}},{key:"setInterval",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=new Mn;return this.add(n),n.setInterval(function(){e&&e()},t,r),n}},{key:"setModulate",value:function(e,t){var r=new Mn;return this.add(r),r.setModulate(function(t,r,n){e&&e(t,r,n)},t),r}},{key:"sortEntitiesByZ",value:function(e){e?this.entities.sort(function(e,t){return e.transform&&t.transform&&e.transform.z-t.transform.z}):this.entities.sort(function(e,t){return!e.transform||!t.transform||t.transform.z-e.transform.z})}},{key:"fetchTemplate",value:function(t){return fetch(t,{"Content-Type":"text/html"}).then(function(e){if(!e.ok)throw Error(e.statusText,e.url);return e.text()}).then(function(e){return e}).catch(function(r){console.error("Error fetching template '"+t+"'.",r)})}}]),t}(Nr),vn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.transform,n=void 0===r?new wn:r,a=e.children,o=void 0===a?[]:a;vr(this,t);var i=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.transform=n,i.children=o,i.matrixBuffer=new Float32Array(16*Vt.MAX_BONES),i}return br(t,e),xr(t,[{key:"calcBindPose",value:function(){for(var e=0;e<this.children.length;e++)this.children[e].calcBindPose(!0)}},{key:"flattenChildren",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.children,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=!0,n=!1,a=void 0;try{for(var o=e[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)l=i.value,t.push(l),this.flattenChildren(l.children,t)}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t}},{key:"getFlatMatrix",value:function(){for(var e=0,t=0;t<this.children.length;t++)e=this.children[t].getFlatMatrix(this.matrixBuffer,e,!1);return this.matrixBuffer}}]),t}(kr),xn=C(),yn=[0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,1,0],bn=[0,1,1,1,1,0,0,0,0,1,1,0],_n=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],Tn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.src,n=void 0===r?"":r,a=e.transform,o=void 0===a?new wn:a,i=e.magFilter,l=void 0===i?"LINEAR":i,s=e.minFilter,c=void 0===s?"LINEAR_MIPMAP_LINEAR":s,u=e.wrap,d=void 0===u?{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}:u,p=e.flipX,m=e.flipY,f=e.pivot,g=void 0===f?[0,0]:f,h=e.lighting,v=void 0===h?0:h,x=e.shadowCastingMode,y=void 0===x?1:x,b=e.pixelsPerUnit,_=void 0===b?1:b;vr(this,t);var T=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return T.transform=o,T._pixelsPerUnit=_,T._minFilter=c,T._magFilter=l,T._wrap=d,T._src=n,T.flipX=void 0!==p&&p,T.flipY=void 0!==m&&m,T.pivot=g,T.width=0,T.height=0,T.animations={},T.mesh=new sn({id:"MESH_SPRITE_"+T.id,material:new ia({name:"SPRITE_"+n,lighting:v,shadowCastingMode:y}),vertices:new Float32Array(yn),uvs:new Float32Array(bn),normals:new Float32Array(_n)}),T.src=n,T}return br(t,e),xr(t,[{key:"src",get:function(){return this._src},set:function(e){return e?this.texture&&this.texture.src==e?void 0:(this.texture=new Ir({src:e,flipY:!1,magFilter:this._magFilter,minFilter:this._minFilter}),this.mesh.material.diffuseTexture=this.texture,this.mesh.material.buildProgram(),this.texture.load().then(function(){}),this.texture.img.src):(this.texture=null,void(this.mesh.material.diffuseTexture=this.texture))}},{key:"minFilter",get:function(){return this._minFilter},set:function(e){this._minFilter=e,this.texture.minFilter=e}},{key:"magFilter",get:function(){return this._magFilter},set:function(e){this._magFilter=e,this.texture.magFilter=e}}]),xr(t,[{key:"loadTextures",value:function(){return this.texture.load()}},{key:"render",value:function(e,t,r,n,a,o,i,l,s){a.push(this),Kt(xn,i,this.transform.localMatrix),this.mesh.render(e,t,r,n,a,o,xn,l,s),a.pop()}},{key:"update",value:function(e,r,n){yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,r,n),this.currentAnimation&&this.currentAnimation.update(e,r,n,this)}},{key:"addAnimation",value:function(e,t){this.animations[e]=t,t.sprite=this}},{key:"playAnimation",value:function(e,t){return this.animations[e]?void(this.currentAnimation=this.animations[e],this.currentAnimation.play(t)):console.warn("Animation '"+e+"' not found")}},{key:"selectAnimation",value:function(e){return this.animations[e]?void(this.currentAnimation=this.animations[e],this.currentAnimation.setFrame(0)):console.warn("Animation '"+e+"' not found")}},{key:"fitToTexture",value:function(){this.selectFrame(0,0,this.texture.img.width,this.texture.img.height,this.pivot[0],this.pivot[1],0,!0)}},{key:"selectFrame",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:this.pivot[0],o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:this.pivot[1],i=!!(7<arguments.length&&void 0!==arguments[7])&&arguments[7],l=this.mesh.material,s=l.diffuseTexture;if(null!==s){var c=e/s.img.width,u=(e+r)/s.img.width,d=t/s.img.height,p=(t+n)/s.img.height;if(this.flipX){var m=[u,c];c=m[0],u=m[1]}if(this.flipY){var f=[d,p];p=f[0],d=f[1]}this.mesh.uvs.set([c,p,u,p,u,d,c,d,c,p,u,d]),r*=this._pixelsPerUnit,n*=this._pixelsPerUnit,r!=this.width||n!=this.height||i?(this.mesh.vertices[0]=yn[0]*r+-a*r,this.mesh.vertices[3]=yn[3]*r+-a*r,this.mesh.vertices[6]=yn[6]*r+-a*r,this.mesh.vertices[9]=yn[9]*r+-a*r,this.mesh.vertices[12]=yn[12]*r+-a*r,this.mesh.vertices[15]=yn[15]*r+-a*r,this.mesh.vertices[1]=yn[1]*n+-o*n,this.mesh.vertices[4]=yn[4]*n+-o*n,this.mesh.vertices[7]=yn[7]*n+-o*n,this.mesh.vertices[10]=yn[10]*n+-o*n,this.mesh.vertices[13]=yn[13]*n+-o*n,this.mesh.vertices[16]=yn[16]*n+-o*n,this.mesh.invalidate(!0,!0,!1,!1,!1)):this.mesh.invalidate(!1,!0,!1,!1,!1),this.width=r,this.height=n}}}]),t}(kr),Sn=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.loop;vr(this,e),this.frames=[],this.state=0,this.loop=void 0===r||r,this.currentTime=0,this.currentFrame=null,this.currentFrameIndex=0,this.callback=null}return xr(e,[{key:"update",value:function(e){if(this.state){var t=this.currentFrame.speed||0;if(this.currentTime+e>t){if(this.currentFrameIndex++,!this.frames[this.currentFrameIndex])if(this.callback&&this.callback(),this.loop)this.currentFrameIndex=0;else return void(this.state=0);this.setFrame(),this.currentTime=0}this.currentTime+=e}}},{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.state=1,this.loop=t,this.callback=e,this.reset(),this.setFrame()}},{key:"reset",value:function(){this.currentTime=0,this.currentFrame=this.frames[0],this.currentFrameIndex=0}},{key:"addFrame",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.x,r=void 0===t?0:t,n=e.y,a=void 0===n?0:n,o=e.width,i=void 0===o?0:o,l=e.height,s=void 0===l?0:l,c=e.pivotX,u=void 0===c?0:c,d=e.pivotY,p=void 0===d?0:d,m=e.speed,f=void 0===m?0:m;this.frames.push({x:r,y:a,width:i,height:s,pivotX:u,pivotY:p,speed:f})}},{key:"setFrame",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.currentFrameIndex;this.currentFrame=this.frames[e],this.sprite.selectFrame(this.currentFrame.x,this.currentFrame.y,this.currentFrame.width,this.currentFrame.height,this.currentFrame.pivotX,this.currentFrame.pivotY,this.currentFrame.materialIndex)}}]),e}(),En=C(),wn=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.position,n=void 0===r?[0,0,0,1]:r,a=t.rotation,o=void 0===a?[0,0,0,1]:a,i=t.scale,l=void 0===i?[1,1,1]:i;vr(this,e),this.valid={mat4:!1,translation:!1,rotation:!1,rotationQuat:!1,scale:!1,inverse:!1,inverseTransposed:!1},this._temp={mat4:C(),inverseMat4:C(),inverseTransposeMat4:C(),translation:te(n[0]||0,n[1]||0,n[2]||0,void 0===n[3]?1:n[3]),rotation:te(o[0]||0,o[1]||0,o[2]||0,void 0===o[3]?1:o[3]),rotationQuat:Re(),scale:te(void 0===l[0]?1:l[0],void 0===l[1]?1:l[1],void 0===l[2]?1:l[2])}}var t=Math.asin,r=Math.atan2;return xr(e,[{key:"invalidate",value:function(){this.valid={mat4:!1,translation:!1,rotation:!1,rotationQuat:!1,scale:!1,inverse:!1,inverseTransposed:!1}}},{key:"targetTo",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,1,0];Q(En,this.xyz,e,n),j(this._temp.rotationQuat,En);var a=this._temp.rotationQuat[0],o=this._temp.rotationQuat[1],i=this._temp.rotationQuat[2],l=this._temp.rotationQuat[3];this.yaw=r(2*o*l-2*a*i,1-2*o*o-2*i*i),this.pitch=r(2*a*l-2*o*i,1-2*a*a-2*i*i),this.roll=t(2*a*o+2*i*l),this.valid.mat4=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"lookAt",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,1,0];K(En,this.xyz,e,n),j(this._temp.rotationQuat,En);var a=this._temp.rotationQuat[0],o=this._temp.rotationQuat[1],i=this._temp.rotationQuat[2],l=this._temp.rotationQuat[3];this.yaw=r(2*o*l-2*a*i,1-2*o*o-2*i*i),this.pitch=r(2*a*l-2*o*i,1-2*a*a-2*i*i),this.roll=t(2*a*o+2*i*l),this.valid.mat4=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"orbitX",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];de(this._temp.translation,this._temp.translation,t,e),this.valid.mat4=!1,this.valid.inverse=!1,this.valid.translation=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"orbitY",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];pe(this._temp.translation,this._temp.translation,t,e),this.valid.mat4=!1,this.valid.inverse=!1,this.valid.translation=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"orbitZ",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];me(this._temp.translation,this._temp.translation,t,e),this.valid.mat4=!1,this.valid.inverse=!1,this.valid.translation=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"localMatrix",get:function(){return this.valid.mat4||(X(this._temp.mat4,this.rotationQuat,this._temp.translation,this._temp.scale),this.valid.mat4=!0),this._temp.mat4},set:function(e){this._temp.mat4=e,this.invalidate(),this.valid.mat4=!0}},{key:"localMatrixInversed",get:function(){return this.valid.inverse&&this.valid.mat4||(U(this._temp.inverseMat4,this.localMatrix),this.valid.inverse=!0),this._temp.inverseMat4}},{key:"localMatrixInversedTransposed",get:function(){return this.valid.inverseTransposed&&this.valid.inverse&&this.valid.mat4||(G(this._temp.inverseTransposeMat4,this.localMatrixInversed),this.valid.inverseTransposed=!0),this._temp.inverseTransposeMat4}},{key:"rotationQuat",get:function(){return this.valid.rotationQuat||(He(this._temp.rotationQuat,this._temp.rotation[0]*(180/pt),this._temp.rotation[1]*(180/pt),this._temp.rotation[2]*(180/pt)),this.valid.rotationQuat=!0,this.valid.mat4=!1),this._temp.rotationQuat},set:function(){this._temp.rotationQuat=this._temp.rotationQuat,this.valid.rotationQuat=!0}},{key:"x",get:function(){return this.valid.translation||(z(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation[0]},set:function(e){return this._temp.translation[0]=e,this.valid.mat4=!1,e}},{key:"y",get:function(){return this.valid.translation||(z(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation[1]},set:function(e){return this._temp.translation[1]=e,this.valid.mat4=!1,e}},{key:"z",get:function(){return this.valid.translation||(z(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation[2]},set:function(e){return this._temp.translation[2]=e,this.valid.mat4=!1,this._temp.translation[2]}},{key:"xyz",get:function(){return this.valid.translation||(z(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation},set:function(e){return this._temp.translation[0]=e[0],this._temp.translation[1]=e[1],this._temp.translation[2]=e[2],this.valid.mat4=!1,this._temp.translation}},{key:"sx",get:function(){return this.valid.scale||(W(this._temp.scale,this.localMatrix),this.valid.scale=!0),this._temp.scale[0]},set:function(e){return this._temp.scale[0]=e,this.valid.mat4=!1,this._temp.scale[0]}},{key:"sy",get:function(){return this.valid.scale||(W(this._temp.scale,this.localMatrix),this.valid.scale=!0),this._temp.scale[1]},set:function(e){return this._temp.scale[1]=e,this.valid.mat4=!1,this._temp.scale[1]}},{key:"sz",get:function(){return this.valid.scale||(W(this._temp.scale,this.localMatrix),this.valid.scale=!0),this._temp.scale[2]},set:function(e){return this._temp.scale[2]=e,this.valid.mat4=!1,this._temp.scale[2]}},{key:"sxyz",set:function(e){return this._temp.scale[0]=e[0],this._temp.scale[1]=e[1],this._temp.scale[2]=e[2],this.valid.mat4=!1,this._temp.scale}},{key:"pitch",get:function(){return this.valid.rotation||(j(this._temp.rotation,this.localMatrix),this.valid.rotation=!0),this._temp.rotation[0]},set:function(e){return this._temp.rotation[0]=e,this.valid.rotationQuat=!1,this.valid.mat4=!1,this._temp.rotation[0]}},{key:"yaw",get:function(){return this.valid.rotation||(j(this._temp.rotation,this.localMatrix),this.valid.rotation=!0),this._temp.rotation[1]},set:function(e){return this._temp.rotation[1]=e,this.valid.rotationQuat=!1,this.valid.mat4=!1,this._temp.rotation[1]}},{key:"roll",get:function(){return this.valid.rotation||(j(this._temp.rotation,this.localMatrix),this.valid.rotation=!0),this._temp.rotation[2]},set:function(e){return this._temp.rotation[2]=e,this.valid.rotationQuat=!1,this.valid.mat4=!1,this._temp.rotation[2]}}]),e}(),kn=C(),An=[0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,1,0],Nn=[0,1,1,1,1,0,0,0,0,1,1,0],Pn=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],In=0,Fn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=void 0===r?In++:r,a=e.transform,o=void 0===a?new wn:a,i=e.map,l=void 0===i?"":i,s=e.atlas,c=void 0===s?"":s,u=e.pixelsPerUnit,d=void 0===u?1:u,p=e.tileSize,m=void 0===p?[16,16]:p,f=e.atlasPadding,g=e.magFilter,h=void 0===g?"LINEAR":g,v=e.minFilter,x=void 0===v?"LINEAR_MIPMAP_LINEAR":v;vr(this,t);var y=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return y.id=n,y.mesh=new sn({material:new la("TILEMAP_"+n,{atlas:null,map:null}),vertices:new Float32Array(An),uvs:new Float32Array(Nn),normals:new Float32Array(Pn)}),y.transform=o,y._minFilter=x,y._magFilter=h,y._pixelsPerUnit=d,y._tileSize=m,y.map=l,y.atlas=c,y.tileSize=m,y}return br(t,e),xr(t,[{key:"atlas",get:function(){return this._atlas},set:function(e){var t=this;return e?(this._atlas=new Ir({src:e,flipY:!1,magFilter:this._magFilter,minFilter:this._minFilter,generateMipmap:!1}),this.mesh.material.atlas=this._atlas,this._atlas.load().then(function(){t.pixelsPerUnit=t._pixelsPerUnit}),this._atlas):(this._atlas=null,void(this.mesh.material.atlas=this._atlas))}},{key:"map",get:function(){return this._map},set:function(e){var t=this;return e?(this._map=new Ir({src:e,flipY:!1,magFilter:this._magFilter,minFilter:this._minFilter,wrap:{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"},generateMipmap:!1}),this.mesh.material.map=this._map,this._map.load().then(function(){t.pixelsPerUnit=t._pixelsPerUnit}),this._map):(this._map=null,void(this.mesh.material.map=this.map))}},{key:"pixelsPerUnit",get:function(){return this._pixelsPerUnit},set:function(e){this._pixelsPerUnit=e,this.mesh.vertices[0]=0,this.mesh.vertices[3]=this._map.img.width*this._pixelsPerUnit,this.mesh.vertices[6]=this._map.img.width*this._pixelsPerUnit,this.mesh.vertices[9]=0,this.mesh.vertices[12]=0,this.mesh.vertices[15]=this._map.img.width*this._pixelsPerUnit,this.mesh.vertices[1]=0,this.mesh.vertices[4]=0,this.mesh.vertices[7]=this._map.img.height*this._pixelsPerUnit,this.mesh.vertices[10]=this._map.img.height*this._pixelsPerUnit,this.mesh.vertices[13]=0,this.mesh.vertices[16]=this._map.img.height*this._pixelsPerUnit,this.mesh.invalidate(!0,!0)}},{key:"tileSize",get:function(){return this._tileSize},set:function(e){!1==e instanceof Array&&(e=[e,e]),this._tileSize=e}},{key:"minFilter",get:function(){return this._minFilter},set:function(e){this._minFilter=e,this._atlas.minFilter=e,this._map.minFilter=e}},{key:"magFilter",get:function(){return this._magFilter},set:function(e){this._magFilter=e,this._atlas.magFilter=e,this._map.magFilter=e}}]),xr(t,[{key:"render",value:function(e,t,r,n,a,o,i){a.push(this),Kt(kn,i,this.transform.localMatrix),this.mesh.render(e,t,r,n,a,o,kn),a.pop()}}]),t}(kr),Mn=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.currentTime=0,e.interval=0,e.currentIntervalCount=0,e.intervalCount=-1,e.mode="timeout",e.direction=1,e.enabled=!0,e.callback=function(){},e}return br(t,e),xr(t,[{key:"update",value:function(e,t){if(this.enabled)switch(this.currentTime+=e*this.direction,this.mode){case"timeout":this.currentTime>this.interval&&(this.callback(t),this.enabled=!1);break;case"interval":this.currentTime>this.interval&&(this.currentTime=0+(this.currentTime-this.interval),this.callback(t),this.currentIntervalCount++,0<this.intervalCount&&this.currentIntervalCount>=this.intervalCount&&(this.enabled=!1));break;case"modulate":this.currentTime>this.interval?(this.currentTime=this.interval-(this.currentTime-this.interval),this.direction=-1):0>this.currentTime&&(this.currentTime=0-this.currentTime,this.direction=1),this.callback(t,e,this.currentTime/this.interval);}}},{key:"setTimeout",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.interval=t,this.callback=e,this.mode="timeout",this.currentTime=0,this.enabled=!0}},{key:"setInterval",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.interval=t,this.intervalCount=r,this.callback=e,this.mode="interval",this.currentTime=0,this.currentIntervalCount=0,this.enabled=!0}},{key:"setModulate",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.interval=t,this.callback=e,this.mode="modulate",this.currentTime=0,this.enabled=!0}}]),t}(Nr),Cn=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.currentTime=0,e.percentComplete=1,e.duration=0,e.direction=1,e.mode="linear",e.propParent=null,e.prop="",e.from=0,e.to=0,e.callback=null,e}return br(t,e),xr(t,[{key:"update",value:function(e){if(this.enabled&&1!==this.percentComplete){switch(this.currentTime+=e*this.direction,this.percentComplete=Et(this.currentTime/this.duration,1),this.mode){case"linear":this.propParent[this.prop]=this.from+(this.to-this.from)*this.percentComplete;break;case"easeIn":this.propParent[this.prop]=this.from+(this.to-this.from)*(-ct(this.percentComplete*pt)/2+.5);}1===this.percentComplete&&this.callback&&this.callback()}}},{key:"linear",value:function(e,t,r,n,a){this.duration=n,this.propParent=e,this.prop=t,this.from=e[t],this.to=r,this.callback=a,this.mode="linear",this.currentTime=0,this.percentComplete=0}},{key:"easeIn",value:function(e,t,r,n,a){this.duration=n,this.propParent=e,this.prop=t,this.from=e[t],this.to=r,this.callback=a,this.mode="easeIn",this.currentTime=0,this.percentComplete=0}}]),t}(kr),Rn=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;vr(this,e),this.x=t,this.y=r}return xr(e,[{key:"set",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.x=e[0]||0,this.y=e[1]||0}},{key:"copy",value:function(t){return t?(t.x=t.x,t.y=t.y):t=new e(this.x,this.y),t}}]),e}(),Ln=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;vr(this,t);var a=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return a.z=n,a}return br(t,e),xr(t,[{key:"set",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0}},{key:"copy",value:function(e){return e?(e.x=e.x,e.y=e.y,e.z=e.z):e=new t(this.x,this.y,this.z),e}}]),t}(Rn),Dn=new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,1,0]),On=new Float32Array([0,0,1,0,1,1,0,1,0,0,1,1]),Gn=function(e){function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:32,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:32;vr(this,t);var a=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.width=r,a.height=n,a.unitScale=1,a.centered=!1,a.flipX=!1,a.flipY=!1,a.antiAliasing=!0,a.mesh=new sn,a.mesh.addMaterial("video",Dn,{uvs:On,texture:e}),a.mesh.materials[0].textureLoad.then(function(){a.mesh.materials[0].texture.flipY=!0,a.antiAliasing||(a.mesh.materials[0].texture.magFilter="NEAREST",a.mesh.materials[0].texture.minFilter="NEAREST"),r=a.width*a.unitScale,n=a.height*a.unitScale,a.mesh.materials[0].vertices[3]=r,a.mesh.materials[0].vertices[6]=r,a.mesh.materials[0].vertices[15]=r,a.mesh.materials[0].vertices[7]=n,a.mesh.materials[0].vertices[10]=n,a.mesh.materials[0].vertices[16]=n,a.centered&&(a.mesh.materials[0].vertices[0]-=r/2,a.mesh.materials[0].vertices[3]-=r/2,a.mesh.materials[0].vertices[6]-=r/2,a.mesh.materials[0].vertices[9]-=r/2,a.mesh.materials[0].vertices[12]-=r/2,a.mesh.materials[0].vertices[15]-=r/2,a.mesh.materials[0].vertices[1]-=n/2,a.mesh.materials[0].vertices[4]-=n/2,a.mesh.materials[0].vertices[7]-=n/2,a.mesh.materials[0].vertices[10]-=n/2,a.mesh.materials[0].vertices[13]-=n/2,a.mesh.materials[0].vertices[16]-=n/2)}),a}return br(t,e),xr(t,[{key:"update",value:function(){}},{key:"render",value:function(e,t,r){this.mesh.render(e,t,r)}},{key:"renderPick",value:function(e,t,r,n){this.mesh.renderPick(e,t,r,n)}},{key:"play",value:function(){this.mesh.materials[0].texture.video.play()}}]),t}(kr),Un=0,Bn=C(),Vn=function(){function e(t){var r=this;if(vr(this,e),this._currentTexture=[],this.id=Un++,this.mouseEventViewport=null,this.mouseEventRadius=1,this.camera=null,this.contextElement=t,this._clearColor=new Vr(0,0,0,1),this.clearOnRender=!0,this.programs=[],this.program=null,this.enabledExtensions={},this.frameBufferTextures=[],this.projectionMatrix=C(),this.orthoWidth=1*t.getAttribute("ortho-width")||0,this.orthoHeight=1*t.getAttribute("ortho-height")||0,this.parallax="true"==t.getAttribute("parallax"),!window.WebGLRenderingContext)throw new Error("[Onyx] WebGL is not supported by this browser.");var n={alpha:!0,antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!1,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!0,stencil:!0};"false"==t.getAttribute("alpha")&&(n.alpha=!1),"false"==t.getAttribute("antialias")&&(n.antialias=!1),"false"==t.getAttribute("depth")&&(n.depth=!1),"true"==t.getAttribute("fail-if-major-performance-caveat")&&(n.failIfMajorPerformanceCaveat=!0),t.getAttribute("power-preference")&&(n.powerPreference=t.getAttribute("powerPreference")),"false"==t.getAttribute("premultiplied-alpha")&&(n.premultipliedAlpha=!1),"false"==t.getAttribute("preserve-drawing-buffer")&&(n.preserveDrawingBuffer=!1),"false"==t.getAttribute("stencil")&&(n.stencil=!1);try{this.webgl=t.getContext("webgl",n)||t.getContext("experimental-webgl",n)}catch(t){throw new Error("[Onyx] Couldn't initialize WebGL")}if(!this.webgl){throw new Error("[Onyx] WebGL appears to be disabled")}this.webgl.viewport(0,0,t.width,t.height),this.webgl.clearColor(this._clearColor.color[0],this._clearColor.color[1],this._clearColor.color[2],this._clearColor.color[3]),this.webgl.blendFuncSeparate(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA,this.webgl.ZERO,this.webgl.ONE),this.projectionMatrix=C(),this.enableExtension("OES_standard_derivatives"),this.clear(),window.addEventListener("resize",function(){r.evaluate()}),this.evaluate()}return xr(e,[{key:"clearColor",get:function(){return this._clearColor},set:function(e){return this._clearColor=e,this.webgl.clearColor(this._clearColor.color[0],this._clearColor.color[1],this._clearColor.color[2],this._clearColor.color[3]),this._clearColor}},{key:"width",get:function(){return this.contextElement.clientWidth*this.getDevicePixelRatio(this.webgl)}},{key:"height",get:function(){return this.contextElement.clientHeight*this.getDevicePixelRatio(this.webgl)}}]),xr(e,[{key:"clear",value:function(){this.webgl.clearColor(this._clearColor.color[0],this._clearColor.color[1],this._clearColor.color[2],this._clearColor.color[3]),this.webgl.clear(this.webgl.COLOR_BUFFER_BIT|this.webgl.DEPTH_BUFFER_BIT)}},{key:"enableExtension",value:function(e){this.enabledExtensions[e]||(this.enabledExtensions[e]=this.webgl.getExtension(e)),this.enabledExtensions[e]||console.warn("Extension \""+e+"\" not available.")}},{key:"evaluate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(e){var t=this.getDevicePixelRatio(this.webgl);navigator.isCocoonJS?(this.contextElement.width=window.innerWidth*t,this.contextElement.height=window.innerHeight*t):this.contextElement.clientWidth&&this.contextElement.clientHeight&&(this.contextElement.width=this.contextElement.clientWidth*t,this.contextElement.height=this.contextElement.clientHeight*t)}else this.contextElement.clientWidth&&this.contextElement.clientHeight&&(this.contextElement.width!==this.contextElement.clientWidth*devicePixelRatio&&(this.contextElement.width=this.contextElement.clientWidth*devicePixelRatio),this.contextElement.height!==this.contextElement.clientHeight*devicePixelRatio&&(this.contextElement.height=this.contextElement.clientHeight*devicePixelRatio));if(this.webgl.viewport(0,0,this.webgl.drawingBufferWidth,this.webgl.drawingBufferHeight),!!this.camera)if("orthographic"==this.camera._projectionType.toLowerCase()){var r=this.orthoWidth,n=this.orthoHeight;if(!r&&!n)r=this.contextElement.clientWidth,n=this.contextElement.clientHeight;else{var a=this.webgl.drawingBufferWidth/this.webgl.drawingBufferHeight;r?!n&&(n=r/a):r=n*a}q(this.projectionMatrix,0,r,0,n,this.camera._nearPlane,this.camera._farPlane)}else Y(this.projectionMatrix,this.camera.fov,this.webgl.drawingBufferWidth/this.webgl.drawingBufferHeight,this.camera._nearPlane,this.camera._farPlane)}},{key:"getDevicePixelRatio",value:function(){return"devicePixelRatio"in window?1<window.devicePixelRatio?window.devicePixelRatio:1:1}},{key:"render",value:function(e,t,r,n,a,o){Kt(Bn,n,this.projectionMatrix),this.camera&&this.camera.render(e,t,this,r,Bn,a,o)}},{key:"renderPick",value:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(this.camera){this.mouseEventViewport.contextElement.width=this.contextElement.width||this.contextElement.naturalWidth,this.mouseEventViewport.contextElement.height=this.contextElement.height||this.contextElement.naturalHeight,this.mouseEventViewport.evaluate(!0),this.mouseEventViewport.canvas2d.width=this.contextElement.width||this.contextElement.naturalWidth,this.mouseEventViewport.canvas2d.height=this.contextElement.height||this.contextElement.naturalHeight,this.mouseEventViewport.webgl.clear(this.webgl.COLOR_BUFFER_BIT|this.webgl.DEPTH_BUFFER_BIT),this.mouseEventViewport.clear(),this.camera.renderScenePick(this.mouseEventViewport);var a=[];e-=n/2,t-=n/2,this.mouseEventViewport.context2d.drawImage(this.mouseEventViewport.contextElement,0,0);for(var o=this.mouseEventViewport.context2d.getImageData(0|e,0|t,n,n).data,l=0,s;l<o.length;l++)s=this.camera.stage.entities[o[l]-1],s&&a.push(s);var c=[],u=!0,d=!1,p=void 0;try{for(var m=a[Symbol.iterator](),f,g;!(u=(f=m.next()).done);u=!0)g=f.value,c[this.camera.stage.entities.indexOf(g)]||(c[this.camera.stage.entities.indexOf(g)]=0),c[this.camera.stage.entities.indexOf(g)]++}catch(e){d=!0,p=e}finally{try{!u&&m.return&&m.return()}finally{if(d)throw p}}var h=0,v=0;for(var x in c)c[x]>h&&(h=c[x],v=x);this.camera.stage.entities[v]&&this.camera.stage.entities[v].emit("click",r)}}},{key:"createProgram",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a=this.programs[Symbol.iterator](),o,i;!(t=(o=a.next()).done);t=!0)if(i=o.value,i.vertexShader==e.vertexShader&&i.fragmentShader==e.fragmentShader)return i}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}this.programs.push(new Wr(this));var l=this.programs[this.programs.length-1];if(l.addVertexShader(this,e.vertexShader),l.addFragmentShader(this,e.fragmentShader),this.webgl.linkProgram(l.program),!this.webgl.getProgramParameter(l.program,this.webgl.LINK_STATUS))throw"Unable to initialize the shader program. "+this.webgl.getProgramInfoLog(l.program);return l.getAttributesFromShaders(this,e.shaderAttributes),l.getUniformLocations(this,e.shaderUniforms),l}},{key:"useProgram",value:function(e){this.program===e||(this.program=e,this.program.use(this))}},{key:"bindToCamera",value:function(e){this.camera=e,e.addViewport(this),this.evaluate()}},{key:"listenForMouseEvents",value:function(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,n=document.createElement("canvas");this.mouseEventViewport=new e(n),this.mouseEventRadius=r;try{this.mouseEventViewport.canvas2d=document.createElement("canvas"),this.mouseEventViewport.context2d=this.mouseEventViewport.canvas2d.getContext("2d")}catch(t){console.error("Couldn't initialize 2D")}this.contextElement.addEventListener("mousedown",function(e){t.renderPick(e.offsetX,e.offsetY,e,t.mouseEventRadius)}),this.contextElement.addEventListener("touchstart",function(e){t.renderPick(gt(e.targetTouches[0].pageX),gt(e.targetTouches[0].pageY),e,e.targetTouches[0].radiusX)})}},{key:"addFrameBufferTexture",value:function(e){this.frameBufferTextures.push(e)}},{key:"removeFrameBufferTexture",value:function(e){-1<this.frameBufferTextures.indexOf(e)&&this.frameBufferTextures.splice(this.frameBufferTextures.indexOf(e),1)}}]),e}(),Hn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.renderPasses,n=e.shader,a=void 0===n?null:n;vr(this,t);var o=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return o.frameBufferTextures=[],o.shader=a,o}return br(t,e),xr(t,[{key:"render",value:function(e,t,r,n,a){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:[];this.viewportClear&&r.clear(),this.shader&&this.shader.render(e,t,r,t.cameras[0],n,a,o);var i=!0,l=!1,s=void 0;try{for(var c=this.renderPasses[Symbol.iterator](),u,d;!(i=(u=c.next()).done);i=!0)d=u.value,d.render(e,t,r,n,a,o)}catch(e){l=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw s}}}}]),t}(mn),zn=C(),Wn=C(),jn=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.renderPasses,n=e.width,a=void 0===n?1024:n,o=e.height,i=void 0===o?1024:o;vr(this,t);var l=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return l.width=a,l.height=i,l.frameBufferTextures=[],l.material=new Yn,l.materialSkinned=new Kn,l}return br(t,e),xr(t,[{key:"render",value:function(e,t,r,n,a){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:[];if(!Vt.DIRECTIONAL_SHADOWS_ENABLED&&!Vt.POINT_SHADOWS_ENABLED){var i=!0,l=!1,s=void 0;try{for(var c=this.renderPasses[Symbol.iterator](),u,d;!(i=(u=c.next()).done);i=!0)d=u.value,d.render(e,t,r,n,a,o)}catch(e){l=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw s}}}else{var p=0;if(Vt.DIRECTIONAL_SHADOWS_ENABLED){this.frameBufferTextures[p]||(this.frameBufferTextures[p]=new zr({height:this.width,width:this.height,magFilter:"NEAREST",minFilter:"NEAREST",textureType:"TEXTURE_2D",flipY:!0,wrap:{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}})),this.frameBufferTextures[p].bind(r,0,r.webgl.TEXTURE_2D),r.clear(),r.webgl.clearColor(0,0,0,0),r.webgl.clearDepth(1),r.webgl.clear(r.webgl.COLOR_BUFFER_BIT|r.webgl.DEPTH_BUFFER_BIT);var m=!0,f=!1,g=void 0;try{for(var h=t.entities[Symbol.iterator](),v,x;!(m=(v=h.next()).done);m=!0)x=v.value,!1==x instanceof Or&&x.visible&&(x.components[0]&&x.components[0].meshes&&x.components[0].meshes[0].material.skeletal?x.render(e,t,r,t.directionalLight,n,Wn,null,this.materialSkinned):x.render(e,t,r,t.directionalLight,n,Wn,null,this.material))}catch(e){f=!0,g=e}finally{try{!m&&h.return&&h.return()}finally{if(f)throw g}}this.frameBufferTextures[p].unbind(r),p++}o.push(this.frameBufferTextures);var y=!0,b=!1,_=void 0;try{for(var T=this.renderPasses[Symbol.iterator](),S,E;!(y=(S=T.next()).done);y=!0)E=S.value,E.render(e,t,r,n,a,o)}catch(e){b=!0,_=e}finally{try{!y&&T.return&&T.return()}finally{if(b)throw _}}o.pop()}}}]),t}(mn),Xn=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.vertexShader="\n    attribute vec3 aVertexPosition;\n\n    uniform mat4 uMVCPMatrix;\n\n    void main(void) {\n        gl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n    }\n",e.fragmentShader="\n\tprecision mediump float;\n\n    void main(void) {\n        gl_FragColor = vec4(1.0);\n    }\n",e}return br(t,e),t}(on),Yn=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.vertexShader="\n    attribute vec3 aVertexPosition;\n\n    uniform mat4 uLMVMatrix;\n    \n    varying float vDepth;\n\n    void main(void) {\n        gl_Position = uLMVMatrix * vec4(aVertexPosition, 1.0);\n\n        float zBuf = gl_Position.z / gl_Position.w;  // between -1 and 1\n        vDepth = 0.5 + (zBuf * 0.5);           // between 0 and 1\n    }\n",e.fragmentShader="\n    #extension GL_OES_standard_derivatives: enable\n\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n        precision highp float;\n    #else\n        precision mediump float;\n    #endif\n\n    #ifdef GL_OES_standard_derivatives\n        #define USE_SVM\n    #endif\n\n    varying float vDepth;\n\n    vec2 packDepthVec2(const in float depth) {\n        const vec2 bitShift = vec2(255.0, 1.0);\n        const vec2 bitMask = vec2(0.0, 1.0 / 255.0);\n      \n        vec2 res = fract(depth * bitShift);\n        res -= res.xy * bitMask;\n      \n        return res;\n    }\n\n    vec3 packDepthVec3(const in float depth) {\n        const vec3 bitShift = vec3(255.0 * 255.0, 255.0, 1.0);\n        const vec3 bitMask = vec3(0.0, 1.0 / 255.0, 1.0 / 255.0);\n      \n        vec3 res = fract(depth * bitShift);\n        res -= res.xyz * bitMask;\n      \n        return res;\n    }\n\n    vec4 packDepthVec4(const in float depth) {\n        const vec4 bitShift = vec4(255.0 * 255.0 * 255.0, 255.0 * 255.0, 255.0, 1.0);\n        const vec4 bitMask = vec4(0.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n      \n        vec4 res = fract(depth * bitShift);\n        res -= res.xxyz * bitMask;\n      \n        return res;\n    }\n\n    void main(void) {\n        #ifdef USE_SVM\n            float depth2 = pow(vDepth, 2.0);\n\n            // approximate the spatial average of vDepth^2\n            float dx = dFdx(vDepth);\n            float dy = dFdy(vDepth);\n            float depth2Avg = depth2 + 0.25 * (dx*dx + dy*dy);\n\n            // depth saved in red and green channels while average depth^2 is\n            // stored in the blue and alpha channels\n            gl_FragColor = vec4(packDepthVec3(vDepth), depth2Avg);\n        #else\n            // Packs normalized fragment's Z-Coordinate which is in [0,1] interval.\n            \n            gl_FragColor = packDepthVec4(gl_FragCoord.z);\n        #endif\n    }\n",e.fragmentShader=e.fragmentShader.replace("#define USE_SVM",""),e.blend=!1,e.cullFaceMode="FRONT",e}return br(t,e),xr(t,[{key:"render",value:function(e,r,n,a,o,i,l){var s=o[o.length-1];return!!(s&&s.material.shadowCastingMode)&&void(yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this,e,r,n,a,o),n.webgl.disable(n.webgl.CULL_FACE),n.webgl.uniformMatrix4fv(n.program.uniform.uLMVMatrix,!1,a.getMVPMatrix(l,n,i)))}}]),t}(on),qn="\n    #define MAX_BONES "+Vt.MAX_BONES+"\n    \n    attribute vec3 aVertexPosition;\n\tattribute vec4 aVertexWeights;\n\tattribute vec4 aVertexWeightIndices;\n\n    uniform mat4 uLMVMatrix;\n\n    uniform mat4 uDeformMatrix[MAX_BONES]; // Bone matrices\n    \n    varying float vDepth;\n\n    mat4 boneTransformMat4() {\n\t\tmat4 ret;\n\n\t\t// Weight normalization factor\n\t\tfloat normfac = 1.0 / (aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3]);\n\n\t\t// Weight1 * Bone1 + Weight2 * Bone2\n\t\tret = normfac * aVertexWeights[0] * uDeformMatrix[int(floor(aVertexWeightIndices[0] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[1] * uDeformMatrix[int(floor(aVertexWeightIndices[1] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[2] * uDeformMatrix[int(floor(aVertexWeightIndices[2] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[3] * uDeformMatrix[int(floor(aVertexWeightIndices[3] + 0.5))];\n\n\t\treturn ret;\n\t}\n\n    void main(void) {\n\t\t// Set the position\n        if(aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3] > 0.0){\n            mat4 bt = boneTransformMat4();\n\n            gl_Position = uLMVMatrix * bt * vec4(aVertexPosition, 1.0);\n        }else{\n            gl_Position = uLMVMatrix * vec4(aVertexPosition, 1.0);\n        }\n\n        float zBuf = gl_Position.z / gl_Position.w;  // between -1 and 1\n        vDepth = 0.5 + (zBuf * 0.5);           // between 0 and 1\n    }\n",Kn=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.vertexShader=qn,e}return br(t,e),t}(Yn),Qn=[-1,-1,0,1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,1,0],Jn=[0,0,1,0,1,1,0,1,0,0,1,1],Zn=function(e){function t(){vr(this,t);var e=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.vertexShader="\n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    varying vec2 vTextureCoord;\n\n    void main(void) {\n        vTextureCoord = aTextureCoord;\n\n        gl_Position = vec4(aVertexPosition, 1.0);\n    }\n",e.fragmentShader="\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n        precision highp float;\n    #else\n        precision mediump float;\n    #endif\n\n    varying vec2 vTextureCoord;\n\n    uniform sampler2D uTexture;\n\n    void main(void) {\n        gl_FragColor = texture2D(uTexture, vTextureCoord);\n    }\n",e.vertices=new Float32Array(Qn),e.uvs=new Float32Array(Jn),e.buffers={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},e.valid={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},e}return br(t,e),xr(t,[{key:"render",value:function(e,r,n,a,o,i){this.vertices.length&&(yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).apply(this,arguments),void 0!==n.program.attribute.aVertexPosition&&((!this.buffers.vertices[n.id]||!this.valid.vertices[n.id])&&(this.buffers.vertices[n.id]=n.webgl.createBuffer(),n.webgl.bindBuffer(n.webgl.ARRAY_BUFFER,this.buffers.vertices[n.id]),n.webgl.bufferData(n.webgl.ARRAY_BUFFER,this.vertices,n.webgl.STATIC_DRAW),this.valid.vertices[n.id]=!0),n.webgl.bindBuffer(n.webgl.ARRAY_BUFFER,this.buffers.vertices[n.id]),n.webgl.vertexAttribPointer(n.program.attribute.aVertexPosition,3,n.webgl.FLOAT,!1,0,0),n.webgl.enableVertexAttribArray(n.program.attribute.aVertexPosition)),void 0!==n.program.attribute.aTextureCoord&&((!this.buffers.uvs[n.id]||!this.valid.uvs[n.id])&&(this.buffers.uvs[n.id]=n.webgl.createBuffer(),n.webgl.bindBuffer(n.webgl.ARRAY_BUFFER,this.buffers.uvs[n.id]),n.webgl.bufferData(n.webgl.ARRAY_BUFFER,this.uvs,n.webgl.STATIC_DRAW),this.valid.uvs[n.id]=!0),n.webgl.bindBuffer(n.webgl.ARRAY_BUFFER,this.buffers.uvs[n.id]),n.webgl.vertexAttribPointer(n.program.attribute.aTextureCoord,2,n.webgl.FLOAT,!1,0,0),n.webgl.enableVertexAttribArray(n.program.attribute.aTextureCoord)),!1===i[i.length-1].setAsTexture(n,0,n.program.uniform.uTexture)||n.webgl.drawArrays(n.webgl.TRIANGLES,0,this.vertices.length/3))}}]),t}(on),$n=new Float32Array(3*Vt.MAX_LIGHTS),ea=new Float32Array(16*Vt.MAX_LIGHTS),ta=new Float32Array(3*Vt.MAX_LIGHTS),ra=Array(Vt.MAX_LIGHTS),na=Array(Vt.MAX_LIGHTS),aa="\n\tprecision highp float;\n\n\t#define MAX_BONES "+Vt.MAX_BONES+"\n\t#define MAX_LIGHTS "+Vt.MAX_LIGHTS+"\n\n\t#define SKELETAL_ENABLED\n\t#define TEXTURES_ENABLED\n\t#if MAX_LIGHTS > 0\n\t#define SHADOWS_ENABLED\n\t#endif\n\n\tattribute vec4 aVertexPosition;\n\tattribute vec3 aVertexNormal;\n\tattribute vec2 aTextureCoord;\n\tattribute vec4 aVertexWeights;\n\tattribute vec4 aVertexWeightIndices;\n\n\tuniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n\tuniform mat4 uMMatrix; // World Matrix\n\tuniform mat4 uViewMatrix; // View Matrix\n\tuniform mat4 uNormalMatrix;\n\n\tuniform mat4 uDeformMatrix[MAX_BONES]; // Bone matrices\n\n\tuniform mat4 uDirectionalLightMVPMatrix; // Light MVP Matrix\n\tvarying vec4 vDirectionalShadowPos;\n\n\t#if MAX_LIGHTS > 0\n\tuniform mat4 uLightMVPMatrix[MAX_LIGHTS]; // Light MVP Matrix\n\tvarying vec4 vShadowPos[MAX_LIGHTS];\n\t#endif\n\n\tvarying vec3 vPositionCoord;\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst mat4 texUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);\n\t\n\tmat4 boneTransformMat4() {\n\t\tmat4 ret;\n\n\t\t// Weight normalization factor\n\t\tfloat normfac = 1.0 / (aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3]);\n\n\t\t// Weight1 * Bone1 + Weight2 * Bone2\n\t\tret = normfac * aVertexWeights[0] * uDeformMatrix[int(floor(aVertexWeightIndices[0] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[1] * uDeformMatrix[int(floor(aVertexWeightIndices[1] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[2] * uDeformMatrix[int(floor(aVertexWeightIndices[2] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[3] * uDeformMatrix[int(floor(aVertexWeightIndices[3] + 0.5))];\n\n\t\treturn ret;\n\t}\n\n\tvoid main() {\n\t\t// Set the position\n\t\t#ifdef SKELETAL_ENABLED\n\t\t\tif(aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3] > 0.0){\n\t\t\t\tmat4 bt = boneTransformMat4();\n\t\t\t\tvNormal = normalize((bt * vec4(aVertexNormal, 0.0)).xyz);\n\n\t\t\t\tgl_Position = uMVCPMatrix * bt * aVertexPosition;\n\t\t\t}else{\n\t\t\t\tvNormal = normalize(mat3(uNormalMatrix) * aVertexNormal);\n\n\t\t\t\tgl_Position = uMVCPMatrix * aVertexPosition;\n\t\t\t}\n\t\t#else\n\t\t\tvNormal = normalize(mat3(uNormalMatrix) * aVertexNormal);\n\n\t\t\tgl_Position = uMVCPMatrix * aVertexPosition;\n\t\t#endif\n\n\t\tvPositionCoord = vec3(uMMatrix * aVertexPosition);\n\t\t\n        // Set texture coordinate\n        #ifdef TEXTURES_ENABLED\n            vTextureCoord = aTextureCoord;\n\t\t#endif\n\n\t\t#ifdef SHADOWS_ENABLED\n\t\t\tvDirectionalShadowPos = texUnitConverter * uDirectionalLightMVPMatrix * aVertexPosition;\n\n\t\t\tfor(int i=0; i < "+Vt.MAX_LIGHTS+"; ++i){\n\t\t\t\tvShadowPos[i] = uLightMVPMatrix[i] * aVertexPosition;\n\t\t\t\t// vShadowPos[i] = aVertexPosition.xyz - uLightPosition[i];\n\t\t\t}\n\t\t#endif\n\t}\n",oa="\n\t#extension GL_OES_standard_derivatives: enable\n\n\t#ifdef GL_FRAGMENT_PRECISION_HIGH\n\t\tprecision highp float;\n\t\t// precision highp int;\n\t#else\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\t#endif\n\n\t#define MAX_LIGHTS "+Vt.MAX_LIGHTS+"\n\n    #ifdef GL_OES_standard_derivatives\n        #define USE_SVM\n    #endif\n\n\t#if MAX_LIGHTS > 0\n\t#define POINT_LIGHTING_ENABLED\n\t#define DIRECTIONAL_SHADOWS_ENABLED\n\t#define POINT_SHADOWS_ENABLED\n\t#endif\n\t#define DIRECTIONAL_LIGHTING_ENABLED\n\t#define SHADOW_BIAS 0.0007\n\t#define FOG_ENABLED\n\t#define TEXTURE_DIFFUSE_ENABLED\n\t#define TEXTURE_SPECULAR_COLOR_ENABLED\n\t#define TEXTURE_AMBIENT_ENABLED\n\t#define TEXTURE_AMBIENT_BLEND_MODE 1 // 0: Additive | 1: Multiply | 2: Screen\n\t#define TEXTURE_AMBIENT_COORDINATES 0 // 0: Use UVs | 1: Use World Coordinates XY | 2: Use World Coordinates XZ\n\t#define TEXTURE_AMBIENT_SIZE 1024.00\n\t#define TEXTURE_AMBIENT_SCALE 1.0\n\t#define TEXTURE_AMBIENT_FLIPY\n\t#define TEXTURE_EMIT_ENABLED\n\n\tvarying vec3 vPositionCoord;\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tvarying vec4 vDirectionalShadowPos;\n\t#if MAX_LIGHTS > 0\n\tvarying vec4 vShadowPos[MAX_LIGHTS];\n\t#endif\n\n\tuniform vec3 uCameraPosition;\n\n\tuniform vec3 uSceneAmbientLightColor;\n\n\tuniform vec3 uDirectionalLightColor;\n\tuniform vec3 uDirectionalLightVector;\n\tuniform float uDirectionalLightIntensity;\n\t\n\tuniform sampler2D uDiffuseTexture;\n\tuniform sampler2D uSpecularColorTexture;\n\tuniform sampler2D uSpecularHighlightTexture;\n\tuniform sampler2D uAmbientTexture; // TODO: Should be global illumination texture\n\tuniform sampler2D uEmitTexture;\n\n\tuniform vec4 uFogColor;\n\tuniform float uFogDensity;\n\tuniform float uFogDistance;\n\n\t#if MAX_LIGHTS > 0\n\tuniform vec3 uLightPosition[MAX_LIGHTS]; // Light positions\n\tuniform vec3 uLightColor[MAX_LIGHTS];\n\tuniform float uLightIntensity[MAX_LIGHTS];\n\tuniform float uLightMaxDistance[MAX_LIGHTS];\n\tuniform samplerCube uPointLightDepth[MAX_LIGHTS];\n\t#endif\n\tuniform sampler2D uDirectionalLightDepth;\n\tuniform float uDirectionalLightDepthSize;\n\n\tuniform vec3 uMaterialDiffuseColor;\n\tuniform vec3 uMaterialSpecularColor;\n\tuniform vec3 uMaterialAmbientColor;\n\tuniform vec3 uMaterialEmitColor;\n\tuniform vec3 uMaterialTransmissionFilter;\n\tuniform float uMaterialDissolve;\n\tuniform float uMaterialSpecularExponent;\n\tuniform float uMaterialEmitExponent;\n\n\tuniform float uShadowBias;\n\n\tfloat unpackDepthVec2(in vec2 color) {\n\t\tconst vec2 bitShift = vec2(1.0 / 255.0, 1.0);\n\t\treturn dot(color, bitShift);\n\t}\n\n\tfloat unpackDepthVec3(in vec3 color) {\n\t\tconst vec3 bitShift = vec3(1.0 / (255.0 * 255.0), 1.0 / 255.0, 1.0);\n\t\treturn dot(color, bitShift);\n\t}\n\n\tfloat unpackDepthVec4(in vec4 color) {\n\t\tconst vec4 bitShift = vec4(1.0 / (255.0 * 255.0 * 255.0), 1.0 / (255.0 * 255.0), 1.0 / 255.0, 1.0);\n\t\treturn dot(color, bitShift);\n\t}\n\n\tvec4 shadow_filter(vec2 uv_shadowMap, in sampler2D depthColorTexture){\n        // if (!use_filter) {\n        \t// return texture2D(depthColorTexture, uv_shadowMap);\n\t\t// }\n\t\t\n        vec4 result = vec4(0.0);\n\t\t\n\t\tfor (int x = -1; x <= 1; x++) {\n        \tfor (int y = -1; y <= 1; y++) {\n        \t\tfloat x_l = (uv_shadowMap.x - float(x) / uDirectionalLightDepthSize);\n        \t\tfloat y_l = (uv_shadowMap.y - float(y) / uDirectionalLightDepthSize);\n        \t\tvec2 lookup = vec2(x_l, y_l);\n        \t\tresult += texture2D(depthColorTexture, lookup).rgba; //get(x,y);\n        \t}\n\t\t}\n\t\t\n        return result / 9.0;\n\t}\n\t\n\tfloat linstep(float low, float high, float v){\n\t\treturn clamp((v-low)/(high-low), 0.0, 1.0);\n\t}\n\n\tfloat directionalShadow(in vec4 shadowPosition, in sampler2D depthColorTexture) {\n\t\t#ifdef USE_SVM\n\t\t\tvec4 shadowMapColor = shadow_filter(shadowPosition.xy, depthColorTexture);\n\t\t\tfloat distance = shadowPosition.z;\n\t\t\tfloat mean = unpackDepthVec3(shadowMapColor.rgb);\n\n\t\t\t// Surface is fully lit\n\t\t\tif(distance < mean) return 1.0;\n\n\t\t\tfloat depth_2 = shadowMapColor.a;\n\n\t\t\t// The fragment is either in shadow or penumbra. We now use chebyshev's upperBound to check\n\t\t\t// How likely this pixel is to be lit (p_max)\n\t\t\tfloat variance = depth_2 - pow(mean, 2.00);\n\t\t\tvariance = max(variance, uShadowBias);\n\n\t\t\tfloat d = distance - mean;\n\t\t\tfloat p_max = variance / (variance + d*d);\n\t\t\tp_max = clamp(p_max, 0.0, 1.0);\n\t\t\tfloat p = smoothstep(distance - 0.02, distance, mean);\n\n\t\t\treturn p_max;\n\t\t\t\n\t\t\t// float p_max = linstep(0.2, 1.0, variance / (variance + d*d));\n\t\t\t// float p = smoothstep(distance - 0.02, distance, mean);\n\t\t\t// return (max(p, p_max) > 1.0 - uShadowBias)?1.0:0.0;\n\t\t\t// return clamp(max(p, p_max), 0.0, 1.0);\n\t\t\t// shadowCoeff = 0 = shadow\n\t\t\t// shadowCoeff = 1 = no shadow\n\t\t#else\n\t\t\tvec3 fragmentDepth = shadowPosition.xyz;\n\t\t\tfragmentDepth.z -= uShadowBias;\n\n\t\t\tfloat texelDepth = unpackDepthVec4(texture2D(depthColorTexture, fragmentDepth.xy));\n\t\t\treturn (fragmentDepth.z < texelDepth) ? 1.0 : 0.0;\n\n\t\t\t// float texelSize = 1.0 / 1024.0;\n\t\t\t// float amountInLight = 0.0;\n\n\t\t\t// for (int x = -1; x <= 1; x++) {\n\t\t\t// \tfor (int y = -1; y <= 1; y++) {\n\t\t\t// \t\tfloat texelDepth = unpackDepthVec4(texture2D(depthColorTexture, fragmentDepth.xy + vec2(x, y) * texelSize));\n\n\t\t\t// \t\tif (fragmentDepth.z < texelDepth) {\n\t\t\t// \t\t\tamountInLight += 1.0;\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\t\t\t// amountInLight /= 9.0;\n\n\t\t\t// return amountInLight;\n\t\t#endif\n\t}\n\n\tfloat omnidirectionalShadow(in vec3 direction, in samplerCube sampler) {\n\t\tdirection *= vec3(1.0, -1.0, 1.0);\n\t\tfloat vertexDepth = clamp(length(direction), 0.0, 1.0);\n\t\tfloat shadowMapDepth = unpackDepthVec4(textureCube(sampler, direction)) + SHADOW_BIAS;\n\n\t\treturn (vertexDepth > shadowMapDepth) ? 0.0 : 1.0;\n\t}\n\n\tfloat calculateFog(){\n\t\t// get the distance of the pixel\n\t\tfloat perspective_far = uFogDistance;\n\t\tfloat fog_cord = (gl_FragCoord.z / gl_FragCoord.w) / perspective_far;\n\n\t\t// density of fog\n\t\tfloat fog_density = uFogDensity;\n\n\t\t// increase fog by density\n\t\t// fog also thickens with distance\n\t\treturn fog_cord * fog_density;\n\t}\n\n\tvoid main(void) {\n\t\tvec3 N = normalize(vNormal);\n\t\tvec3 V = normalize(uCameraPosition); // we are in Eye Coordinates, so EyePos is (0,0,0) \n\n\t\t#if defined(DIRECTIONAL_LIGHTING_ENABLED) || defined(POINT_LIGHTING_ENABLED)\n\n\t\t\t// Calculate lighting\n\t\t\tvec4 Iamb = vec4(0.0);\n\t\t\tvec4 Ispec = vec4(0.0);\n\t\t\tvec4 Idiff = vec4(0.0);\n\t\t\tvec4 Iemit = vec4(0.0);\n\n\t\t\t#ifdef DIRECTIONAL_LIGHTING_ENABLED\n\t\t\t\tvec3 L = normalize(-uDirectionalLightVector); \n\t\t\t\tvec3 R = normalize(-reflect(L,N)); \n\t\t\t\n\t\t\t\t//calculate Ambient Term: \n\t\t\t\tIamb += vec4(uSceneAmbientLightColor, 0.0); \n\n\t\t\t\t#ifdef DIRECTIONAL_SHADOWS_ENABLED\n\t\t\t\t\tfloat shadow = directionalShadow(vDirectionalShadowPos, uDirectionalLightDepth);\n\t\t\t\t#else\n\t\t\t\t\tfloat shadow = 1.0;\n\t\t\t\t#endif\n\t\t\t\t\n\t\t\t\t//calculate Diffuse Term: \n\t\t\t\tIdiff += vec4(clamp(shadow * uDirectionalLightColor * max(dot(N,L), 0.0), 0.0, 1.0), 0.0);\n\t\t\t\n\t\t\t\t// calculate Specular Term:\n\t\t\t\tIspec += vec4(clamp(shadow * uDirectionalLightColor * pow(max(dot(R,V),0.0),0.3*uMaterialSpecularExponent), 0.0, 1.0), 0.0);\n\t\t\t#endif\n\t\t\t\n\t\t\t#ifdef POINT_LIGHTING_ENABLED\n\t\t\t\tfor (int i=0; i<MAX_LIGHTS; i++){\n\n\t\t\t\t\tvec3 L = normalize(uLightPosition[i] - vPositionCoord); \n\n\t\t\t\t\tif(length(L) > 0.0){\n\t\t\t\t\t\tvec3 R = normalize(-reflect(L,N)); \n\n\t\t\t\t\t\t#ifdef POINT_SHADOWS_ENABLED\n\t\t\t\t\t\t\tfloat shadow = omnidirectionalShadow(L, uPointLightDepth[i]); //lightPosition, in samplerCube sampler\n\t\t\t\t\t\t\tif(shadow <= 0.0) continue;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tfloat shadow = 1.0;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t//calculate Ambient Term: \n\t\t\t\t\t\t// vec4 Iamb = vec4(uMaterialAmbientColor, 1.0); \n\t\t\t\t\t\t\n\t\t\t\t\t\t//calculate Diffuse Term: \n\t\t\t\t\t\tIdiff += vec4(clamp(uLightColor[i] * max(dot(N,L), 0.0), 0.0, 1.0), 0.0);\n\t\t\t\t\t\n\t\t\t\t\t\t// calculate Specular Term:\n\t\t\t\t\t\tIspec += vec4(clamp(uLightColor[i] * pow(max(dot(R,V),0.0),0.3*uMaterialSpecularExponent), 0.0, 1.0), 0.0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t#endif\n\n\t\t\t#if defined(TEXTURE_AMBIENT_ENABLED) || defined(TEXTURE_DIFFUSE_ENABLED)\n\t\t\t\t#if defined(TEXTURE_AMBIENT_ENABLED)\n\t\t\t\t\t\tIamb *= texture2D(uAmbientTexture, vTextureCoord);\n\t\t\t\t\t#endif\n\t\t\t\t#if defined(TEXTURE_DIFFUSE_ENABLED)\n\t\t\t\t\tIamb *= texture2D(uDiffuseTexture, vTextureCoord);\n\t\t\t\t#endif\n\t\t\t#else\n\t\t\t\tIamb *= vec4(uSceneAmbientLightColor * uMaterialAmbientColor, 1.0);\n\t\t\t#endif\n\n\t\t\t#ifdef TEXTURE_DIFFUSE_ENABLED\n\t\t\t\tIdiff *= texture2D(uDiffuseTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tIdiff *= vec4(uMaterialDiffuseColor, 1.0);\n\t\t\t#endif\n\n\t\t\t#ifdef TEXTURE_SPECULAR_COLOR_ENABLED\n\t\t\t\tIspec *= texture2D(uSpecularColorTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tIspec *= vec4(uMaterialSpecularColor, 1.0);\n\t\t\t#endif\n\n\t\t\t#ifdef TEXTURE_EMIT_ENABLED\n\t\t\t\tIemit += texture2D(uEmitTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tIemit += vec4(uMaterialEmitColor, 1.0);\n\t\t\t#endif\n\t\t\tIemit.rgb *= uMaterialEmitExponent;\n\n\t\t\t// Final Color = Diffuse + Specular + Ambient + Emit\n\t\t\tgl_FragColor = Idiff + Ispec + Iamb + Iemit; \n\t\t  \tgl_FragColor.a *= uMaterialDissolve;\n\t\t#else\n\t\t\t#ifdef TEXTURE_DIFFUSE_ENABLED\n\t\t\t\tgl_FragColor = texture2D(uDiffuseTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tgl_FragColor = vec4(uMaterialDiffuseColor, 1.0);\n\t\t\t#endif\n\t\t#endif\n\n\t\t// Discard if there's no pixel to show. This helps when there's empty space background\n\t\t// TODO: Is there a way to optimize this?\n\t\tif (gl_FragColor.a == 0.0) discard;\n\n\t\t#ifdef FOG_ENABLED\n\t\t\tfloat fog = calculateFog();\n\n\t\t\t// mix together the frag color with the fog color\n\t\t\tgl_FragColor = mix(uFogColor, gl_FragColor, clamp(1.0-fog,0.0,1.0));\n\t\t#endif\n\t}\n",ia=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.ambientColor,n=void 0===r?new Vr(0,0,0,1):r,a=e.diffuseColor,o=void 0===a?new Vr(1,1,1,1):a,i=e.specularColor,l=void 0===i?new Vr(0,0,0,1):i,s=e.specularExponent,c=void 0===s?128:s,u=e.emitColor,d=void 0===u?new Vr(0,0,0,0):u,p=e.emitExponent,m=void 0===p?1:p,f=e.transmissionFilter,g=void 0===f?new Vr(1,1,1,1):f,h=e.dissolve,v=void 0===h?1:h,x=e.lighting,y=void 0===x?1:x,b=e.shadowCastingMode,_=void 0===b?1:b,T=e.receiveShadows,S=e.shadowBias,E=void 0===S?Vt.DEFAULT_SHADOW_BIAS:S,w=e.skeletal,k=e.ambientTextureCoordinateSpace,A=void 0===k?"UVtoXZ":k,N=e.ambientTextureFlipY,P=e.receivesFog,I=e.ambientTexture,F=void 0===I?null:I,M=e.diffuseTexture,C=void 0===M?null:M,R=e.specularColorTexture,L=void 0===R?null:R,D=e.specularHighlightTexture,O=void 0===D?null:D,G=e.emitTexture,U=void 0===G?null:G,B=e.alphaTexture,V=void 0===B?null:B,H=e.bumpMapTexture,z=void 0===H?null:H,W=e.displacementTexture,j=void 0===W?null:W,X=e.decalTexture,Y=void 0===X?null:X;vr(this,t);var q=_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return q.vertexShader=aa,q.fragmentShader=oa,q.ambientColor=n,q.diffuseColor=o,q.specularColor=l,q.emitColor=d,q.specularExponent=c,q.emitExponent=m,q.transmissionFilter=g,q.dissolve=v,q.ambientTexture=F,q.diffuseTexture=C,q.specularColorTexture=L,q.specularHighlightTexture=O,q.emitTexture=U,q.alphaTexture=V,q.bumpMapTexture=z,q.displacementTexture=j,q.decalTexture=Y,q.shadowBias=E,q.lighting=y,q.skeletal=void 0!==w&&w,q.shadowCastingMode=_,q.receiveShadows=void 0===T||T,q.receivesFog=void 0===P||P,q.ambientTextureCoordinateSpace=A,q.ambientTextureFlipY=void 0!==N&&N,q.buildProgram(),q}return br(t,e),xr(t,[{key:"render",value:function(e,r,n,a,o,i,l,s){if((yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this,e,r,n,a,o,i,l,s),!(this.diffuseTexture&&!1===this.diffuseTexture.setAsTexture(n,0,n.program.uniform.uDiffuseTexture)))&&!(this.ambientTexture&&!1===this.ambientTexture.setAsTexture(n,1,n.program.uniform.uAmbientTexture))&&!(this.specularColorTexture&&!1===this.specularColorTexture.setAsTexture(n,2,n.program.uniform.uSpecularColorTexture))&&!(this.specularHighlightTexture&&!1===this.specularHighlightTexture.setAsTexture(n,3,n.program.uniform.uSpecularHighlightTexture))&&!(this.emitTexture&&!1===this.emitTexture.setAsTexture(n,4,n.program.uniform.uEmitTexture))){n.webgl.uniform4fv(n.program.uniform.uDiffuseColor,this.diffuseColor.toArray()),n.webgl.uniform3fv(n.program.uniform.uMaterialDiffuseColor,this.diffuseColor.toVec3Array()),n.webgl.uniform3fv(n.program.uniform.uMaterialSpecularColor,this.specularColor.toVec3Array()),n.webgl.uniform3fv(n.program.uniform.uMaterialAmbientColor,this.ambientColor.toVec3Array()),n.webgl.uniform3fv(n.program.uniform.uMaterialEmitColor,this.emitColor.toVec3Array()),n.webgl.uniform3fv(n.program.uniform.uMaterialTransmissionFilter,this.transmissionFilter.toVec3Array()),n.webgl.uniform1f(n.program.uniform.uMaterialSpecularExponent,this.specularExponent),n.webgl.uniform1f(n.program.uniform.uMaterialEmitExponent,this.emitExponent),n.webgl.uniform1f(n.program.uniform.uMaterialDissolve,this.dissolve);var c=0;if(n.webgl.uniform3fv(n.program.uniform.uSceneAmbientLightColor,r.ambientLightColor.toVec3Array()),n.webgl.uniform3fv(n.program.uniform.uDirectionalLightColor,r.directionalLight.diffuseColor.toVec3Array()),n.webgl.uniform3fv(n.program.uniform.uDirectionalLightVector,r.directionalLight.vector),n.webgl.uniform1f(n.program.uniform.uShadowBias,this.shadowBias),Vt.DIRECTIONAL_SHADOWS_ENABLED){if(n.program.uniform.uDirectionalLightDepth&&s[s.length-1]){if(!1===s[s.length-1][c].setAsTexture(n,5+c,n.program.uniform.uDirectionalLightDepth))return;n.webgl.uniform1f(n.program.uniform.uDirectionalLightDepthSize,s[s.length-1][c].width)}n.webgl.uniformMatrix4fv(n.program.uniform.uDirectionalLightMVPMatrix,!1,r.directionalLight.getMVPMatrix(l,n)),c++}if(void 0!==n.program.uniform["uLightPosition[0]"]){$n.fill(0),ea.fill(0),ta.fill(0),ra.fill(0),na.fill(0);for(var u=0,d;u<Vt.MAX_LIGHTS;u++)if(d=r.lights[u],d&&d.enabled){for(var p=0;3>p;p++)$n[3*u+p]=d.transform.xyz[p];for(var m=d.getMVPMatrix(l,n),p=0;16>p;p++)ea[16*u+p]=m[p];for(var p=0;3>p;p++)ta[3*u+p]=d.diffuseColor.toArray()[p];ra[u]=1*d.intensity,na[u]=1*d.maxDistance}c+=Vt.MAX_LIGHTS,n.webgl.uniform3fv(n.program.uniform["uLightPosition[0]"],$n),n.webgl.uniformMatrix4fv(n.program.uniform["uLightMVPMatrix[0]"],!1,ea),n.webgl.uniform3fv(n.program.uniform["uLightColor[0]"],ta)}n.webgl.uniform4fv(n.program.uniform.uFogColor,r.fogColor.toArray()),n.webgl.uniform1f(n.program.uniform.uFogDensity,r.fogDensity),n.webgl.uniform1f(n.program.uniform.uFogDistance,n.camera._farPlane),n.webgl.blendFunc(n.webgl.SRC_ALPHA,n.webgl.ONE_MINUS_SRC_ALPHA),n.webgl.enable(n.webgl.BLEND)}}},{key:"buildProgram",value:function(){switch(this.vertexShader=aa,this.fragmentShader=oa,this.fragmentShader=this.fragmentShader.replace("#define USE_SVM",""),this.vertexShader=this.vertexShader.replace("#define POINT_SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define POINT_SHADOWS_ENABLED",""),this.lighting){case 1:break;case 0:default:this.vertexShader=this.vertexShader.replace("#define DIRECTIONAL_LIGHTING_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define DIRECTIONAL_LIGHTING_ENABLED",""),this.vertexShader=this.vertexShader.replace("#define POINT_LIGHTING_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define POINT_LIGHTING_ENABLED",""),this.vertexShader=this.vertexShader.replace("#define SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define SHADOWS_ENABLED","");}if(this.ambientTexture||this.diffuseTexture||this.specularColorTexture||this.specularHighlightTexture||this.alphaTexture||this.bumpMapTexture||this.displacementTexture||this.decalTexture||(this.vertexShader=this.vertexShader.replace("#define TEXTURES_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define TEXTURES_ENABLED","")),!this.ambientTexture)this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_ENABLED","");else{switch(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_SIZE 1024.00","#define TEXTURE_AMBIENT_SIZE "+this.ambientTexture.width.toFixed(2)),this.ambientTexture.scale&&(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_SCALE 1.0","#define TEXTURE_AMBIENT_SCALE "+this.ambientTexture.scale.toFixed(2))),this.ambientTextureCoordinateSpace){case"UV":this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 0","#define TEXTURE_AMBIENT_COORDINATES 0");break;case"UVtoXY":this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 0","#define TEXTURE_AMBIENT_COORDINATES 1");break;case"UVtoXZ":this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 0","#define TEXTURE_AMBIENT_COORDINATES 2");}"WORLD"!==this.ambientTextureCoordinateSpace&&(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 1","#define TEXTURE_AMBIENT_COORDINATES 0")),this.ambientTextureFlipY||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_FLIPY",""))}this.diffuseTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_DIFFUSE_ENABLED","")),this.specularColorTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_SPECULAR_COLOR_ENABLED","")),this.specularHighlightTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_SPECULAR_HIGHLIGHT_ENABLED","")),this.emitTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_EMIT_ENABLED","")),this.skeletal||(this.vertexShader=this.vertexShader.replace("#define SKELETAL_ENABLED","")),this.receivesFog||(this.fragmentShader=this.fragmentShader.replace("#define FOG_ENABLED","")),this.receiveShadows||(this.vertexShader=this.vertexShader.replace("#define SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define SHADOWS_ENABLED",""))}}]),t}(on),la=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=r.cullFace,a=r.cullFaceMode,o=void 0===a?"BACK":a,i=r.frontFace,l=void 0===i?"CCW":i;vr(this,t);var s=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.vertexShader="\n\tprecision highp float;\n\n\tattribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n\n\tuniform vec2 uAtlasSize;\n\tuniform vec2 uMapSize;\n\tuniform vec2 uTileSize;\n\t\n\tvarying vec2 vPixelCoord;\n\tvarying vec2 vTexCoord;\n\n\tvarying vec2 vAtlasSize;\n\tvarying vec2 vMapSize;\n\tvarying vec2 vTileSize;\n\n\tvoid main() {\n\t\tvPixelCoord = aTextureCoord;\n\t\tvTexCoord = vPixelCoord * (uAtlasSize / (uAtlasSize / uMapSize)) * uTileSize;\n\n\t\tvTileSize = uTileSize;\n\t\tvAtlasSize = uAtlasSize;\n\n\t\tgl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",s.fragmentShader="\n\t#ifdef GL_FRAGMENT_PRECISION_HIGH\n\t\tprecision highp float;\n\t#else\n\t\tprecision mediump float;\n\t#endif\n\n\tuniform sampler2D uAtlasTexture;\n\tuniform sampler2D uMapTexture;\n\n\tvarying vec2 vPixelCoord;\n\tvarying vec2 vTexCoord;\n\n\tvarying vec2 vAtlasSize;\n\tvarying vec2 vMapSize;\n\tvarying vec2 vTileSize;\n\n\tvoid main(void) {\n\t\t// Grab the tile number (x,y)\n\t\tvec4 tile = texture2D(uMapTexture, vPixelCoord);\n\t\tif(tile.a == 0.0 || (tile.x == 1.0 && tile.y == 1.0)) {\n\t\t\tdiscard;\n\t\t}\n\t\t// gl_FragColor = vec4(tile.x * 30.0, tile.y * 30.0, 0.0, 1.0);\n\t\t\n\t\t// Grab the tile's texture frag color\n\t\tvec2 spriteOffset = floor(tile.xy * 256.0) * vTileSize;\n\t\tvec2 spriteCoord = mod(vTexCoord, vTileSize);\n\t\tgl_FragColor = tile.a * texture2D(uAtlasTexture, (spriteOffset + spriteCoord) / vAtlasSize);\n\t}\n",s.cullFace=void 0!==n&&n,s.cullFaceMode=o,s.frontFace=l,s}return br(t,e),xr(t,[{key:"render",value:function(e,r,n,a,o,i,l,s){yr(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this,e,r,n,a,o,i,l,s),this.map&&!1===this.map.setAsTexture(n,0,n.program.uniform.uMapTexture)||this.atlas&&!1===this.atlas.setAsTexture(n,1,n.program.uniform.uAtlasTexture)||(this.cullFace?(n.webgl.enable(n.webgl.CULL_FACE),n.webgl.cullFace(n.webgl[this.cullFaceMode]),n.webgl.frontFace(n.webgl[this.frontFace])):n.webgl.disable(n.webgl.CULL_FACE),n.webgl.uniform2fv(n.program.uniform.uAtlasSize,[this.atlas.width,this.atlas.height]),n.webgl.uniform2fv(n.program.uniform.uMapSize,[this.map.width,this.map.height]),n.webgl.uniform2fv(n.program.uniform.uTileSize,o[o.length-2].tileSize))}}]),t}(on),sa="\n\t#define SKELETAL_ENABLED\n\n\tattribute vec3 aVertexPosition, barycentric;\n\tattribute vec4 aVertexWeights;\n\tattribute vec4 aVertexWeightIndices;\n\n\tuniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n\tuniform mat4 uMMatrix; // Model\n\tuniform mat4 uTMatrix; // Entity\n\tuniform mat4 uCMatrix; // Camera\n\tuniform mat4 uMVMatrix;// Inverse Camera\n\tuniform mat4 uPMatrix; // Projection\n\tuniform mat4 uNormalMatrix;\n\tuniform mat4 uDeformMatrix["+64+"]; // Bone matrices\n\t\n\tvarying vec4 vPositionCoord;\n\tvarying vec3 vBC;\n\t\n\tmat4 boneTransformMat4() {\n\t\tmat4 ret;\n\n\t\t// Weight normalization factor\n\t\tfloat normfac = 1.0 / (aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3]);\n\n\t\t// Weight1 * Bone1 + Weight2 * Bone2\n\t\tret = normfac * aVertexWeights[0] * uDeformMatrix[int(floor(aVertexWeightIndices[0] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[1] * uDeformMatrix[int(floor(aVertexWeightIndices[1] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[2] * uDeformMatrix[int(floor(aVertexWeightIndices[2] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[3] * uDeformMatrix[int(floor(aVertexWeightIndices[3] + 0.5))];\n\n\t\treturn ret;\n\t}\n\n\tvoid main() {\n\t\tvBC = barycentric;\n\n\t\t// Set the position\n\t\t#ifdef SKELETAL_ENABLED\n\t\t\tif(aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3] > 0.0){\n\t\t\t\tmat4 bt = boneTransformMat4();\n\t\t\t\tgl_Position = uMVCPMatrix * bt * vec4(aVertexPosition, 1.0);\n\n\t\t\t\tvNormal = (bt * vec4(aVertexNormal, 0.0)).xyz;\n\t\t\t}else{\n\t\t\t\tgl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n\t\t\t}\n\t\t#else\n\t\t\tgl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n\t\t#endif\n\t}\n",ca="\n\t#extension GL_OES_standard_derivatives : enable\n\n\tprecision mediump float;\n\n\tvarying vec4 vPositionCoord;\n\tvarying vec3 vBC;\n    \n    float edgeFactor(){\n        vec3 d = fwidth(vBC);\n        vec3 a3 = smoothstep(vec3(0.0), d*1.5, vBC);\n        return min(min(a3.x, a3.y), a3.z);\n    }\n\n\tvoid main(void) {\n        gl_FragColor.rgb = mix(vec3(0.0), vec3(0.5), edgeFactor());\n\t}\n",ua=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";vr(this,t);var r=_r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.vertexShader=sa,r.fragmentShader=ca,r.shaderAttributes=[].concat(Sr(ATTRIBUTES)),r.shaderUniforms=[].concat(Sr(UNIFORMS)),r.buildProgram(),r}return br(t,e),xr(t,[{key:"buildProgram",value:function(){this.shaderAttributes=[].concat(Sr(ATTRIBUTES)),this.shaderUniforms=[].concat(Sr(UNIFORMS)),this.vertexShader=sa,this.fragmentShader=ca,this.skeletal||(this.vertexShader=this.vertexShader.replace("#define SKELETAL_ENABLED",""),-1<this.shaderUniforms.indexOf("uDeformMatrix")&&this.shaderUniforms.splice(this.shaderUniforms.indexOf("uDeformMatrix"),1))}}]),t}(on),da=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};vr(this,e),this.options=t}return xr(e,null,[{key:"load",value:function(){var e=kt(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadFromURL",value:function(e,t,r){return!!e&&(t.src=e,t.srcPath=e.substr(0,e.lastIndexOf("/")),void 0===t.resPath&&(t.resPath=t.srcPath),t.srcFilename=e.split("/").pop(),r&&r[e]?void(t.input=r[e].input):this.fetchFromURL(e).then(function(n){t.input=n,r&&(r[e]={input:n})}))}},{key:"fetchFromURL",value:function(){var e=kt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t,{"Content-Type":"text/html"}).then(function(e){if(!e.ok)throw Error(e.statusText,e.url);return e.text()}).then(function(e){return e}).catch(function(r){console.error("Error fetching template '"+t+"'.",r)}));case 1:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),pa={},ma=function(e){function t(){return vr(this,t),_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return br(t,e),xr(t,null,[{key:"clearCache",value:function(){pa={}}},{key:"load",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t=arguments,r,n,a,o,i,l,s,c,u,d,p,m,f,g,h,v,x,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0<t.length&&void 0!==t[0]?t[0]:{},n=r,void 0===n.resPath&&r.src&&(n.resPath=r.src.substr(0,r.src.lastIndexOf("/"))),e.next=5,this.loadFromURL(r.src,n,pa);case 5:if(pa[r.src].materials){e.next=113;break}a=[],o=n.input.split("\n"),i=null,l=[],s=!0,c=!1,u=void 0,e.prev=13,d=o[Symbol.iterator]();case 15:if(s=(p=d.next()).done){e.next=78;break}m=p.value,l=m.split(" "),e.t0=l[0].toLowerCase(),e.next="newmtl"===e.t0?21:"illum"===e.t0?24:"ka"===e.t0?25:"kd"===e.t0?27:"ks"===e.t0?29:"ns"===e.t0?31:"ke"===e.t0?33:"tf"===e.t0?35:"d"===e.t0?37:"map_ka"===e.t0?39:"map_kd"===e.t0?43:"map_ks"===e.t0?47:"map_ke"===e.t0?51:"map_ns"===e.t0?55:"map_d"===e.t0?59:"map_bump"===e.t0?63:"bump"===e.t0?63:"disp"===e.t0?67:"decal"===e.t0?71:75;break;case 21:return a.push(new ia({name:l[1].trim(),lighting:1})),i=a[a.length-1],e.abrupt("break",75);case 24:return e.abrupt("break",75);case 25:return i.ambientColor.set(1*l[1],1*l[2],1*l[3]),e.abrupt("break",75);case 27:return i.diffuseColor.set(1*l[1],1*l[2],1*l[3]),e.abrupt("break",75);case 29:return i.specularColor.set(1*l[1],1*l[2],1*l[3]),e.abrupt("break",75);case 31:return i.specularExponent=1*l[1],e.abrupt("break",75);case 33:return i.emitColor.set(1*l[1],1*l[2],1*l[3]),e.abrupt("break",75);case 35:return i.transmissionFilter.set(1*l[1],void 0===l[2]?1*l[1]:1*l[2],void 0===l[3]?1*l[1]:1*l[3]),e.abrupt("break",75);case 37:return i.dissolve=1*l[1],e.abrupt("break",75);case 39:return i.ambientTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=42,i.ambientTexture.load();case 42:return e.abrupt("break",75);case 43:return i.diffuseTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=46,i.diffuseTexture.load();case 46:return e.abrupt("break",75);case 47:return i.specularColorTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=50,i.specularColorTexture.load();case 50:return e.abrupt("break",75);case 51:return i.emitTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=54,i.emitTexture.load();case 54:return e.abrupt("break",75);case 55:return i.specularHighlightTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=58,i.specularHighlightTexture.load();case 58:return e.abrupt("break",75);case 59:return i.alphaTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=62,i.alphaTexture.load();case 62:return e.abrupt("break",75);case 63:return i.bumpMapTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=66,i.bumpMapTexture.load();case 66:return e.abrupt("break",75);case 67:return i.displacementTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=70,i.displacementTexture.load();case 70:return e.abrupt("break",75);case 71:return i.decalTexture=new Ir({src:n.resPath+"/"+l[l.length-1]}),e.next=74,i.decalTexture.load();case 74:return e.abrupt("break",75);case 75:s=!0,e.next=15;break;case 78:e.next=84;break;case 80:e.prev=80,e.t1=e["catch"](13),c=!0,u=e.t1;case 84:e.prev=84,e.prev=85,!s&&d.return&&d.return();case 87:if(e.prev=87,!c){e.next=90;break}throw u;case 90:return e.finish(87);case 91:return e.finish(84);case 92:for(f=!0,g=!1,h=void 0,e.prev=95,v=a[Symbol.iterator]();!(f=(x=v.next()).done);f=!0)y=x.value,y.buildProgram();e.next=103;break;case 99:e.prev=99,e.t2=e["catch"](95),g=!0,h=e.t2;case 103:e.prev=103,e.prev=104,!f&&v.return&&v.return();case 106:if(e.prev=106,!g){e.next=109;break}throw h;case 109:return e.finish(106);case 110:return e.finish(103);case 111:pa[r.src].materials=a,delete pa[r.src].input;case 113:return e.abrupt("return",pa[r.src].materials);case 114:case"end":return e.stop();}},e,this,[[13,80,84,92],[85,,87,91],[95,99,103,111],[104,,106,110]])}));return function(){return e.apply(this,arguments)}}()}]),t}(da),fa={},ga=function(e){function t(){return vr(this,t),_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return br(t,e),xr(t,null,[{key:"clearCache",value:function(){fa={}}},{key:"load",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t=arguments,r,n,a,o,i,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0<t.length&&void 0!==t[0]?t[0]:{},n={},e.next=4,this.loadFromURL(r.src,n,fa);case 4:return this.options=r,fa[r.src].model||(a=JSON.parse(fa[r.src].input),o=this.cloneMeshes(a.model.meshes,n),i=this.cloneSkeleton(a.model.bones,n),i.children=i.flattenChildren(),i.children=this.sortBones(i.children,a.model.meshes[0].boneOrder),l=this.cloneAnimationClips(a.model.animationClips,i,n),fa[r.src].model=new un({meshes:o,skeleton:i,animationClips:l}),delete fa[r.src].input),e.abrupt("return",fa[r.src].model);case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cloneModel",value:function(e,t){var r=this.cloneMeshes(e.meshes,t),n=this.cloneSkeleton(e.skeleton,t),a=this.cloneAnimationClips(e.animationClips,n,t);return new un({meshes:r,skeleton:n,animationClips:a})}},{key:"cloneMeshes",value:function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),l;!(n=(l=i.next()).done);n=!0){var s=l.value,c=null;s.material.diffuseTexture&&(s.material.diffuseTexture instanceof Ir?c=s.material.diffuseTexture:c=new Ir({src:t.resPath+"/"+s.material.diffuseTexture.src})),r.push(new sn({id:"MESH_COPY",material:new ia(s.material),vertices:new Float32Array(s.vertices),uvs:new Float32Array(s.uvs),normals:new Float32Array(s.normals),weights:new Float32Array(s.weights),weightIndices:new Float32Array(s.weightIndices)})),r[r.length-1].material.buildProgram()}}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}},{key:"cloneSkeleton",value:function(e){if(e){var t=new vn({children:this.cloneBones(e)});return t.calcBindPose(),t}}},{key:"sortBones",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=[];t.forEach(function(t){var n=!1;e=e.filter(function(e){return!!(n||e.id!=t)||(r.push(e),n=!0,!1)})});var n=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),l,s;!(n=(l=i.next()).done);n=!0)s=l.value,0>r.indexOf(s)&&r.push(s)}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}},{key:"cloneBones",value:function(e,t){function r(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.id==e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=[],o=!0,i=!1,l=void 0;try{for(var s=(e.children||e)[Symbol.iterator](),c;!(o=(c=s.next()).done);o=!0){var u=c.value,d=r(u.id,n);if(!d){var p=new wn;if(u.matrixWorld)p.localMatrix=new Float32Array(u.matrix);else if(u.transform.translation)switch(p.translate.xyz=[u.transform.translation[0],u.transform.translation[1],u.transform.translation[2]],p.sxyz=[u.transform.scale[0],u.transform.scale[1],u.transform.scale[2]],u.transform.rotation[3]){case"ZYX":p.rotateToZYX(u.transform.rotation[2],u.transform.rotation[1],u.transform.rotation[0]);break;case"XYZ":default:p.rotateToXYZ(u.transform.rotation[0],u.transform.rotation[1],u.transform.rotation[2]);}else p.localMatrix=new Float32Array(u.transform.localMatrix);d=new Lr({name:u.name,id:u.id||u.FBXID,parent:t,inheritTransform:u.inheritTransform,transform:p}),d.children=this.cloneBones(u,d,n)}a.push(d),n.push(d)}}catch(e){i=!0,l=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw l}}return a}},{key:"cloneAnimationClips",value:function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),l,s;!(n=(l=i.next()).done);n=!0)s=l.value,r.push(new Fr({name:s.name,loop:s.loop,enabled:s.enabled,tracks:this.cloneAnimationTracks(s.tracks,t)}))}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}},{key:"cloneAnimationTracks",value:function(e,t){function r(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t.children[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.id==e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}function n(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t.children[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.name==e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}var a=[],o=!0,i=!1,l=void 0;try{for(var s=e[Symbol.iterator](),c;!(o=(c=s.next()).done);o=!0){var u=c.value,d=null;d=u.parent.id?r(u.parent.id,t):n(u.parent,t),a.push(new Mr({name:u.name,type:u.type,times:u.times.slice(),values:u.values.slice(),parent:d}))}}catch(e){i=!0,l=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw l}}return a}}]),t}(da),ha={},va=function(e){function t(){return vr(this,t),_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return br(t,e),xr(t,[{key:"setIlluminationMode",value:function(){}}],[{key:"clearCache",value:function(){ha={}}},{key:"load",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t=arguments,r,n,a,o,i,l,s,c,u,d,p,m,f,g,h,v,x,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0<t.length&&void 0!==t[0]?t[0]:{},n={},e.next=4,this.loadFromURL(r.src,n,ha);case 4:if(this.options=r,ha[r.src].model){e.next=68;break}a=n.input.split("\n"),o=null,i=[],l=[],s=[],c=[],u=[],d=[],p=[],m=!0,f=!1,g=void 0,e.prev=18,h=a[Symbol.iterator]();case 20:if(m=(v=h.next()).done){e.next=52;break}x=v.value,p=x.split(" "),""===p[1]&&p.splice(1,1),e.t0=p[0],e.next="o"===e.t0?27:"g"===e.t0?27:"mtllib"===e.t0?32:"usemtl"===e.t0?36:"v"===e.t0?38:"vt"===e.t0?40:"vn"===e.t0?42:"vp"===e.t0?44:"f"===e.t0?46:"s"===e.t0?48:49;break;case 27:if("default"!=p[p.length-1]){e.next=29;break}return e.abrupt("continue",49);case 29:return o=this.getMaterialById(p[p.length-1],i),o||(y=new sn({id:p[p.length-1],material:null,vertices:[],uvs:[],normals:[]}),i.push(y),o=y),e.abrupt("break",49);case 32:return e.next=34,ma.load({resPath:n.resPath,src:n.resPath+"/"+p[1].trim()});case 34:return l=e.sent,e.abrupt("break",49);case 36:return o.material=this.getMaterialByName(p[1].trim(),l),e.abrupt("break",49);case 38:return this.parseGeometricVertices(p,s),e.abrupt("break",49);case 40:return this.parseTextureCoordinates(p,c),e.abrupt("break",49);case 42:return this.parseVertexNormals(p,u),e.abrupt("break",49);case 44:return this.parseParameterSpaceVertices(p,d),e.abrupt("break",49);case 46:return this.parsePolygonalFaces(p,s,c,u,d,o),e.abrupt("break",49);case 48:return e.abrupt("break",49);case 49:m=!0,e.next=20;break;case 52:e.next=58;break;case 54:e.prev=54,e.t1=e["catch"](18),f=!0,g=e.t1;case 58:e.prev=58,e.prev=59,!m&&h.return&&h.return();case 61:if(e.prev=61,!f){e.next=64;break}throw g;case 64:return e.finish(61);case 65:return e.finish(58);case 66:ha[r.src].model=new un({meshes:i}),delete ha[r.src].input;case 68:return e.abrupt("return",this.cloneModel(ha[r.src].model));case 69:case"end":return e.stop();}},e,this,[[18,54,58,66],[59,,61,65]])}));return function(){return e.apply(this,arguments)}}()},{key:"getMeshById",value:function(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.id===e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return null}},{key:"getMaterialById",value:function(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.id===e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return null}},{key:"getMeshByName",value:function(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.name===e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return null}},{key:"getMaterialByName",value:function(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.name===e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return null}},{key:"parseGeometricVertices",value:function(e,t){void 0===e[4]&&(e[4]=1),t.push(1*e[1],1*e[2],1*e[3])}},{key:"parseTextureCoordinates",value:function(e,t){void 0===e[3]?t.push(1*e[1],1*e[2]):t.push(1*e[1],1*e[2])}},{key:"parseVertexNormals",value:function(e,t){t.push(1*e[1],1*e[2],1*e[3])}},{key:"parseParameterSpaceVertices",value:function(e,t){t.push(1*e[1],1*e[2],1*e[3])}},{key:"parsePolygonalFaces",value:function(e,t,r,n,a,o){for(var l=[],s=1;s<e.length;s++)l[s-1]=e[s].split("/");for(var s=0;s<l.length;s++)2>l[s].length&&l.splice(s,1);3===l.length?(o.vertices.push(t[3*(1*l[0][0]-1)+0],t[3*(1*l[0][0]-1)+1],t[3*(1*l[0][0]-1)+2],t[3*(1*l[1][0]-1)+0],t[3*(1*l[1][0]-1)+1],t[3*(1*l[1][0]-1)+2],t[3*(1*l[2][0]-1)+0],t[3*(1*l[2][0]-1)+1],t[3*(1*l[2][0]-1)+2]),""!==l[0][1]&&o.uvs.push(r[2*(1*l[0][1]-1)+0],r[2*(1*l[0][1]-1)+1],r[2*(1*l[1][1]-1)+0],r[2*(1*l[1][1]-1)+1],r[2*(1*l[2][1]-1)+0],r[2*(1*l[2][1]-1)+1]),""!==l[0][2]&&o.normals.push(n[3*(1*l[0][2]-1)+0],n[3*(1*l[0][2]-1)+1],n[3*(1*l[0][2]-1)+2],n[3*(1*l[1][2]-1)+0],n[3*(1*l[1][2]-1)+1],n[3*(1*l[1][2]-1)+2],n[3*(1*l[2][2]-1)+0],n[3*(1*l[2][2]-1)+1],n[3*(1*l[2][2]-1)+2])):(o.vertices.push(t[3*(1*l[0][0]-1)+0],t[3*(1*l[0][0]-1)+1],t[3*(1*l[0][0]-1)+2],t[3*(1*l[1][0]-1)+0],t[3*(1*l[1][0]-1)+1],t[3*(1*l[1][0]-1)+2],t[3*(1*l[2][0]-1)+0],t[3*(1*l[2][0]-1)+1],t[3*(1*l[2][0]-1)+2],t[3*(1*l[0][0]-1)+0],t[3*(1*l[0][0]-1)+1],t[3*(1*l[0][0]-1)+2],t[3*(1*l[2][0]-1)+0],t[3*(1*l[2][0]-1)+1],t[3*(1*l[2][0]-1)+2],t[3*(1*l[3][0]-1)+0],t[3*(1*l[3][0]-1)+1],t[3*(1*l[3][0]-1)+2]),""!==l[0][1]&&o.uvs.push(r[2*(1*l[0][1]-1)+0],r[2*(1*l[0][1]-1)+1],r[2*(1*l[1][1]-1)+0],r[2*(1*l[1][1]-1)+1],r[2*(1*l[2][1]-1)+0],r[2*(1*l[2][1]-1)+1],r[2*(1*l[0][1]-1)+0],r[2*(1*l[0][1]-1)+1],r[2*(1*l[2][1]-1)+0],r[2*(1*l[2][1]-1)+1],r[2*(1*l[3][1]-1)+0],r[2*(1*l[3][1]-1)+1]),""!==l[0][2]&&o.normals.push(n[3*(1*l[0][2]-1)+0],n[3*(1*l[0][2]-1)+1],n[3*(1*l[0][2]-1)+2],n[3*(1*l[1][2]-1)+0],n[3*(1*l[1][2]-1)+1],n[3*(1*l[1][2]-1)+2],n[3*(1*l[2][2]-1)+0],n[3*(1*l[2][2]-1)+1],n[3*(1*l[2][2]-1)+2],n[3*(1*l[0][2]-1)+0],n[3*(1*l[0][2]-1)+1],n[3*(1*l[0][2]-1)+2],n[3*(1*l[2][2]-1)+0],n[3*(1*l[2][2]-1)+1],n[3*(1*l[2][2]-1)+2],n[3*(1*l[3][2]-1)+0],n[3*(1*l[3][2]-1)+1],n[3*(1*l[3][2]-1)+2]))}},{key:"cloneModel",value:function(e){var t=this.cloneMeshes(e.meshes),r=this.cloneSkeleton(e.skeleton),n=this.cloneAnimationClips(e.animationClips,r);return new un({id:e.id,meshes:t,skeleton:r,animationClips:n})}},{key:"cloneMeshes",value:function(e){var t=[],r=!0,n=!1,a=void 0;try{for(var o=e[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)l=i.value,l.material&&t.push(new sn({id:l.id,material:new ia(l.material),vertices:new Float32Array(l.vertices),uvs:new Float32Array(l.uvs),normals:new Float32Array(l.normals),weights:new Float32Array(l.weights),weightIndices:new Float32Array(l.weightIndices)}))}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t}},{key:"cloneSkeleton",value:function(e){return e?new Skeleton({children:this.cloneBones(e)}):void 0}},{key:"cloneBones",value:function(e,t){function r(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.id==e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=[],o=!0,i=!1,l=void 0;try{for(var s=e.children[Symbol.iterator](),c;!(o=(c=s.next()).done);o=!0){var u=c.value,d=r(u.id,n);if(!d){var p=new Transform;p.localMatrix=new Float32Array(u.transform.localMatrix),p.generateTranslationRotationScale(),d=new Bone({name:u.name,id:u.id||u.FBXID,parent:t,inheritTransform:u.inheritTransform,transform:p}),d.children=this.cloneBones(u,d,n)}a.push(d),n.push(d)}}catch(e){i=!0,l=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw l}}return a}},{key:"cloneAnimationClips",value:function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),l,s;!(n=(l=i.next()).done);n=!0)s=l.value,r.push(new AnimationClip({name:s.name,loop:s.loop,enabled:s.enabled,tracks:this.cloneAnimationTracks(s.tracks,t)}))}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}},{key:"cloneAnimationTracks",value:function(e,t){function r(e,t){var r=!0,n=!1,a=void 0;try{for(var o=t.children[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l.id==e)return l}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}var n=[],a=!0,o=!1,i=void 0;try{for(var l=e[Symbol.iterator](),s,c;!(a=(s=l.next()).done);a=!0)c=s.value,n.push(new AnimationTrack({name:c.name,type:c.type,times:c.times.slice(),values:c.values.slice(),parent:r(c.parent.id,t)}))}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}}]),t}(da),xa={},ya=function(e){function t(){return vr(this,t),_r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return br(t,e),xr(t,null,[{key:"clearCache",value:function(){xa={}}},{key:"load",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t=arguments,r,n,a,o,i,l,s,c,u,d,p,m,f,g,h,v,x,y,b,_,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0<t.length&&void 0!==t[0]?t[0]:{},n={},e.next=4,this.loadFromURL(r.src,n,xa);case 4:if(n.options=r,xa[r.src].sprite){e.next=61;break}return a=JSON.parse(n.input),o=r.src,r.src=n.resPath+"/"+a.meta.image,i=new Tn(r),r.src=o,e.next=13,i.loadTextures();case 13:if(l=n.srcFilename.split(".")[0],s=new Sn(l),r.defaultPivot||(r.defaultPivot=[.5,.5]),!(a.frames instanceof Array)){e.next=38;break}for(c=!0,u=!1,d=void 0,e.prev=20,p=a.frames[Symbol.iterator]();!(c=(m=p.next()).done);c=!0)f=m.value,s.addFrame({speed:n.options.speed||15/1e3,x:1*f.frame.x,y:1*f.frame.y,width:1*f.frame.w,height:1*f.frame.h,pivotX:f.pivot?1*f.pivot.x:r.defaultPivot[0],pivotY:f.pivot?1*f.pivot.y:r.defaultPivot[1],materialIndex:0});e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](20),u=!0,d=e.t0;case 28:e.prev=28,e.prev=29,!c&&p.return&&p.return();case 31:if(e.prev=31,!u){e.next=34;break}throw d;case 34:return e.finish(31);case 35:return e.finish(28);case 36:e.next=57;break;case 38:for(g=!0,h=!1,v=void 0,e.prev=41,x=Object.entries(a.frames)[Symbol.iterator]();!(g=(y=x.next()).done);g=!0)b=Tr(y.value,2),_=b[0],T=b[1],s.addFrame({speed:n.options.speed||15/1e3,x:1*T.frame.x,y:1*T.frame.y,width:1*T.frame.w,height:1*T.frame.h,pivotX:T.pivot?1*T.pivot.x:r.defaultPivot[0],pivotY:T.pivot?1*T.pivot.y:r.defaultPivot[1],materialIndex:0});e.next=49;break;case 45:e.prev=45,e.t1=e["catch"](41),h=!0,v=e.t1;case 49:e.prev=49,e.prev=50,!g&&x.return&&x.return();case 52:if(e.prev=52,!h){e.next=55;break}throw v;case 55:return e.finish(52);case 56:return e.finish(49);case 57:i.addAnimation(l,s),xa[r.src].sprite=i,delete xa[r.src].sprite.id,delete xa[r.src].input;case 61:return n.sprite=this.cloneSprite(xa[r.src].sprite),void 0!==n.options.defaultAnimation&&(n.options.autoplay||void 0===n.options.autoplay?n.sprite.playAnimation(n.options.defaultAnimation):n.sprite.selectAnimation(n.options.defaultAnimation)),e.abrupt("return",n.sprite);case 64:case"end":return e.stop();}},e,this,[[20,24,28,36],[29,,31,35],[41,45,49,57],[50,,52,56]])}));return function(){return e.apply(this,arguments)}}()},{key:"cloneSprite",value:function(e,t){var r=new Tn(e);return t&&(r.mesh.material.diffuseTexture=e.mesh.material.diffuseTexture),this.cloneSpriteAnimations(r,e.animations),r.transform=new wn(e.transform),r}},{key:"cloneSpriteAnimations",value:function(e,t){var r=!0,n=!1,a=void 0;try{for(var o=Object.entries(t)[Symbol.iterator](),i;!(r=(i=o.next()).done);r=!0){var l=Tr(i.value,2),s=l[0],c=l[1],u=new Sn(c),d=!0,p=!1,m=void 0;try{for(var f=c.frames[Symbol.iterator](),g,h;!(d=(g=f.next()).done);d=!0)h=g.value,u.addFrame(h)}catch(e){p=!0,m=e}finally{try{!d&&f.return&&f.return()}finally{if(p)throw m}}e.addAnimation(s,u)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t}}]),t}(da),ba={images:["res/img/main-01.png","res/img/main-02.png","res/img/main-03.png","res/img/main-04.png","res/img/main-05.png","res/img/main-06.png","res/img/main-07.png","res/img/main-08.png","res/img/main-09.png","res/img/title.png","res/img/main-TitleCard.png"]},_a=768/900,Ta=function(e){function t(){At(this,t);var e=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.renderPasses=[new mn({viewportClear:!0})],e.complete=!1,e.currentPercent=0,e.sprites={},e.assets={},e}return It(t,e),Nt(t,[{key:"onload",value:function(){var e=this;Pt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onload",this).call(this),this.progress=0,this.showBackgroundGraphics().then(function(){e.preloadTextures(ba,function(){e.showProgress(.25)},function(){e.showProgress(.5),game.router.map.game.module.preloadSamples(function(t){e.showProgress(.5+.45*t)},function(){ya.load({src:"res/img/main.json",autoplay:!1,speed:0,defaultPivot:[0,0],pixelsPerUnit:1,minFilter:"NEAREST",magFilter:"NEAREST"}).then(function(t){e.assets.main=t,ya.load({src:"res/img/main-TitleCard.json",autoplay:!1,speed:125,defaultPivot:[0,0],pixelsPerUnit:1,minFilter:"LINEAR",magFilter:"LINEAR"}).then(function(t){e.assets["main-TitleCard"]=t,router.map.game.module.spriteMap.build(),router.map.game.module.spriteMap.refreshModel(),e.showProgress(1)})})})})})}},{key:"update",value:function(){for(var e=arguments.length,r=Array(e),n=0,a;n<e;n++)r[n]=arguments[n];(a=Pt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this)).call.apply(a,[this].concat(r));var o=100*this.progress;this.currentPercent<o&&(this.currentPercent+=(o-this.currentPercent)/20),this.sprites.bar&&(this.sprites.bar.components[0].transform.sx=this.currentPercent/100*_a),this.complete||router.clock.stats.currentGameTime<165e3||(100==this.currentPercent||1<=this.progress&&!this.complete)&&(this.currentPercent=100,this.complete=!0,this.setTimeout(function(){router.navigate("title")},150))}},{key:"showBackgroundGraphics",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.camera=new Or({projectionType:"orthographic",transform:new wn({position:[0,0,100]})}),this.add(this.camera),this.viewports[0].bindToCamera(this.camera),t=[_a,_a,_a],e.next=6,this.newSprite("bar-background",1,362,173,0,t);case 6:return e.next=8,this.newSprite("bar",2,362,173,1,t);case 8:return e.next=10,this.newSprite("overlay",0,0,0,2,t);case 10:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"newSprite",value:function(){var e=kt(regeneratorRuntime.mark(function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:[1,1,1],l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.spriteModel){e.next=4;break}return e.next=3,ya.load({src:"res/img/preloader_1x.json",defaultAnimation:"preloader_1x",autoplay:!1,speed:0,defaultPivot:[0,0],pixelsPerUnit:1,minFilter:"LINEAR",magFilter:"LINEAR"});case 3:this.spriteModel=e.sent;case 4:l=ya.cloneSprite(this.spriteModel),l.transform=new wn({position:[n,a,o],scale:i}),l.selectAnimation("preloader_1x"),l.currentAnimation.setFrame(r),this.sprites[t]=new Nr({components:[l]}),this.add(this.sprites[t]);case 10:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"preloadTextures",value:function(e,t,r){var n=this,a=new pn;a.preloadTextures(e.images,t,this.viewports[0],{flipY:!1,minFilter:"NEAREST",magFilter:"NEAREST"}).then(function(e){n.assets=e,r&&r()}).catch(function(a){console.log(a),window.setTimeout(function(){n.preloadTextures(e,t,r)},1e3)})}},{key:"showProgress",value:function(e){this.progress=e}}]),t}(hn),Sa=function(e){function t(){At(this,t);var e=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.vertexShader="\n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    varying vec2 vTextureCoord;\n\n    void main(void) {\n        vTextureCoord = aTextureCoord;\n\n        gl_Position = vec4(aVertexPosition, 1.0);\n    }\n",e.fragmentShader="\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n        precision highp float;\n    #else\n        precision mediump float;\n    #endif\n\n    varying vec2 vTextureCoord;\n\n    uniform sampler2D uTexture;\n    uniform float iTime;\n    uniform float uTileCount;\n    uniform float uFade;\n\n    void main(void) {\n        if(uTileCount < 2048.){\n            gl_FragColor = texture2D(uTexture, ceil(vTextureCoord.xy * uTileCount) / uTileCount);\n            gl_FragColor.a *= min(uFade, 1.);\n        }else{\n            gl_FragColor = texture2D(uTexture, vTextureCoord.xy);\n        }\n    }\n",e.tileCount=1,e.direction=0,e.fade=1,e.speed=1.25,e.fadeComplete=function(){},e}return It(t,e),Nt(t,[{key:"render",value:function(e,r,n){Pt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).apply(this,arguments);var a=e/(1e3/60);this.direction&&(0<this.direction?this.tileCount*=this.speed*a:this.tileCount/=this.speed*a,(1>this.tileCount||2048<this.tileCount)&&(this.fadeComplete(),this.direction=0,this.tileCount=ht(Et(this.tileCount,2048),1))),this.fade=this.tileCount/16,n.webgl.uniform1f(n.program.uniform.uTileCount,this.tileCount),n.webgl.uniform1f(n.program.uniform.uFade,this.fade)}},{key:"fadeIn",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};this.direction=1,this.fadeComplete=e}},{key:"fadeOut",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};this.direction=-1,this.fadeComplete=e}}]),t}(Zn),Ea={version:"1.6",defaultInstrument:0,defaultTempo:80,steps:16,tracks:10,unlockLevels:{levels:[0,0,0,0,0,0,0,0,0],instruments:[1,1,1,1,1,1,1,1,1,1],presets:[1,1,1,1,1]},expValue:{construction:{second:10,click:0,newInstrument:20},playback:{second:10,newTempo:10,reverse:0,playSaved:10}},titleAnimationSequence:[[50],[100,1],[100,2],[100,3],[100,4],[100,5],[100,6],[100,7],[100,8],[100,9],[100,10],[500],[100,1,10],[100,2,9],[100,3,8],[100,4,7],[100,5,6],[100,6,5],[100,7,4],[100,8,3],[100,9,2],[100,10,1],[1e3],[100,2],[100],[100,2],[100],[100,2],[100],[100,6],[100,7],[100,8],[100,9],[500],[100,1],[100,2],[100,3],[100,4],[100,5],[450]],instruments:[{id:0,name:"Cheese",samples:[{note:"A#-4",filename:"instrument-1.0001.mp3"},{note:"C#-4",filename:"instrument-1.0002.mp3"},{note:"D#-4",filename:"instrument-1.0003.mp3"},{note:"F#-4",filename:"instrument-1.0004.mp3"},{note:"G#-4",filename:"instrument-1.0005.mp3"},{note:"A#-5",filename:"instrument-1.0006.mp3"},{note:"C#-5",filename:"instrument-1.0007.mp3"},{note:"D#-5",filename:"instrument-1.0008.mp3"},{note:"F#-5",filename:"instrument-1.0009.mp3"},{note:"G#-5",filename:"instrument-1.0010.mp3"}]},{id:1,name:"Apple",samples:[{note:"A#-4",filename:"instrument-2.0001.mp3"},{note:"C#-4",filename:"instrument-2.0002.mp3"},{note:"D#-4",filename:"instrument-2.0003.mp3"},{note:"F#-4",filename:"instrument-2.0004.mp3"},{note:"G#-4",filename:"instrument-2.0005.mp3"},{note:"A#-5",filename:"instrument-2.0006.mp3"},{note:"C#-5",filename:"instrument-2.0007.mp3"},{note:"D#-5",filename:"instrument-2.0008.mp3"},{note:"F#-5",filename:"instrument-2.0009.mp3"},{note:"G#-5",filename:"instrument-2.0010.mp3"}]},{id:2,name:"Banana",samples:[{note:"A#-4",filename:"instrument-3.0001.mp3"},{note:"C#-4",filename:"instrument-3.0002.mp3"},{note:"D#-4",filename:"instrument-3.0003.mp3"},{note:"F#-4",filename:"instrument-3.0004.mp3"},{note:"G#-4",filename:"instrument-3.0005.mp3"},{note:"A#-5",filename:"instrument-3.0006.mp3"},{note:"C#-5",filename:"instrument-3.0007.mp3"},{note:"D#-5",filename:"instrument-3.0008.mp3"},{note:"F#-5",filename:"instrument-3.0009.mp3"},{note:"G#-5",filename:"instrument-3.0010.mp3"}]},{id:3,name:"Watermellon",samples:[{note:"A#-4",filename:"instrument-4.0001.mp3"},{note:"C#-4",filename:"instrument-4.0002.mp3"},{note:"D#-4",filename:"instrument-4.0003.mp3"},{note:"F#-4",filename:"instrument-4.0004.mp3"},{note:"G#-4",filename:"instrument-4.0005.mp3"},{note:"A#-5",filename:"instrument-4.0006.mp3"},{note:"C#-5",filename:"instrument-4.0007.mp3"},{note:"D#-5",filename:"instrument-4.0008.mp3"},{note:"F#-5",filename:"instrument-4.0009.mp3"},{note:"G#-5",filename:"instrument-4.0010.mp3"}]},{id:4,name:"Orange",samples:[{note:"A#-4",filename:"instrument-5.0001.mp3"},{note:"C#-4",filename:"instrument-5.0002.mp3"},{note:"D#-4",filename:"instrument-5.0003.mp3"},{note:"F#-4",filename:"instrument-5.0004.mp3"},{note:"G#-4",filename:"instrument-5.0005.mp3"},{note:"A#-5",filename:"instrument-5.0006.mp3"},{note:"C#-5",filename:"instrument-5.0007.mp3"},{note:"D#-5",filename:"instrument-5.0008.mp3"},{note:"F#-5",filename:"instrument-5.0009.mp3"},{note:"G#-5",filename:"instrument-5.0010.mp3"}]},{id:5,name:"Hamburger",samples:[{note:"A#-4",filename:"instrument-6.0001.mp3"},{note:"C#-4",filename:"instrument-6.0002.mp3"},{note:"D#-4",filename:"instrument-6.0003.mp3"},{note:"F#-4",filename:"instrument-6.0004.mp3"},{note:"G#-4",filename:"instrument-6.0005.mp3"},{note:"A#-5",filename:"instrument-6.0006.mp3"},{note:"C#-5",filename:"instrument-6.0007.mp3"},{note:"D#-5",filename:"instrument-6.0008.mp3"},{note:"F#-5",filename:"instrument-6.0009.mp3"},{note:"G#-5",filename:"instrument-6.0010.mp3"}]},{id:6,name:"Pear",samples:[{note:"A#-4",filename:"instrument-7.0001.mp3"},{note:"C#-4",filename:"instrument-7.0002.mp3"},{note:"D#-4",filename:"instrument-7.0003.mp3"},{note:"F#-4",filename:"instrument-7.0004.mp3"},{note:"G#-4",filename:"instrument-7.0005.mp3"},{note:"A#-5",filename:"instrument-7.0006.mp3"},{note:"C#-5",filename:"instrument-7.0007.mp3"},{note:"D#-5",filename:"instrument-7.0008.mp3"},{note:"F#-5",filename:"instrument-7.0009.mp3"},{note:"G#-5",filename:"instrument-7.0010.mp3"}]},{id:7,name:"Hotdog",samples:[{note:"A#-4",filename:"instrument-8.0001.mp3"},{note:"C#-4",filename:"instrument-8.0002.mp3"},{note:"D#-4",filename:"instrument-8.0003.mp3"},{note:"F#-4",filename:"instrument-8.0004.mp3"},{note:"G#-4",filename:"instrument-8.0005.mp3"},{note:"A#-5",filename:"instrument-8.0006.mp3"},{note:"C#-5",filename:"instrument-8.0007.mp3"},{note:"D#-5",filename:"instrument-8.0008.mp3"},{note:"F#-5",filename:"instrument-8.0009.mp3"},{note:"G#-5",filename:"instrument-8.0010.mp3"}]},{id:8,name:"Pineapple",samples:[{note:"A#-4",filename:"instrument-9.0001.mp3"},{note:"C#-4",filename:"instrument-9.0002.mp3"},{note:"D#-4",filename:"instrument-9.0003.mp3"},{note:"F#-4",filename:"instrument-9.0004.mp3"},{note:"G#-4",filename:"instrument-9.0005.mp3"},{note:"A#-5",filename:"instrument-9.0006.mp3"},{note:"C#-5",filename:"instrument-9.0007.mp3"},{note:"D#-5",filename:"instrument-9.0008.mp3"},{note:"F#-5",filename:"instrument-9.0009.mp3"},{note:"G#-5",filename:"instrument-9.0010.mp3"}]},{id:9,name:"Computer",samples:[{note:"A#-4",filename:"instrument-10.0001.mp3"},{note:"C#-4",filename:"instrument-10.0002.mp3"},{note:"D#-4",filename:"instrument-10.0003.mp3"},{note:"F#-4",filename:"instrument-10.0004.mp3"},{note:"G#-4",filename:"instrument-10.0005.mp3"},{note:"A#-5",filename:"instrument-10.0006.mp3"},{note:"C#-5",filename:"instrument-10.0007.mp3"},{note:"D#-5",filename:"instrument-10.0008.mp3"},{note:"F#-5",filename:"instrument-10.0009.mp3"},{note:"G#-5",filename:"instrument-10.0010.mp3"}]},{id:10,name:"Sound-Effects",samples:[{note:"Silence",filename:"silence.mp3"},{note:"Unlock-1",filename:"TJ-unlock-1.mp3"},{note:"Unlock-2",filename:"TJ-unlock-2.mp3"},{note:"LevelUp",filename:"TJ-levelup.mp3"},{note:"Scratch-1",filename:"TJ-scratch-1.mp3"},{note:"Scratch-2",filename:"TJ-scratch-2.mp3"},{note:"Button",filename:"TJ-button.mp3"},{note:"Fave",filename:"TJ-favorite.mp3"},{note:"Lock-LVL",filename:"TJ-lock-lvl.mp3"},{note:"Fruit",filename:"TJ-fruit.mp3"},{note:"Palette",filename:"TJ-palette.mp3"},{note:"Palette-Locked",filename:"TJ-palette-locked.mp3"},{note:"Echo-Deselect",filename:"TJ-echo-deselect.mp3"},{note:"Echo-Select",filename:"TJ-echo-select.mp3"},{note:"Timer-On",filename:"TJ-timer-press.mp3"},{note:"Timer-Off",filename:"TJ-timer-unpress.mp3"},{note:"Heart",filename:"TJ-heart-alt.mp3"},{note:"Grid-Tap-Off",filename:"TJ-grid-tap1.mp3"},{note:"Grid-Tap-On",filename:"TJ-grid-tap2.mp3"},{note:"Trash-Tap",filename:"TJ-trash-tap.mp3"},{note:"Trash-Thumbdown",filename:"TJ-trash-thumbdown.mp3"},{note:"Trash-Thumbup",filename:"TJ-trash-thumbup.mp3"},{note:"Hand-Reveal",filename:"TJ-hand-appear.mp3"},{note:"Hand-First-Tap",filename:"TJ-hand-bubbleon.mp3"},{note:"Icon-Reveal",filename:"TJ-intro-sfx.mp3"},{note:"Title-Music",filename:"TJ-soundtrack.mp3",loop:!0,release:2.2}]}],sequences:{blank:{tempo:80,notes:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},default:{tempo:80,notes:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}}},wa=function(e){function t(){At(this,t);var e=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.renderPassMosaic=new Sa,e.renderPassesWithMosaic=[new mn({viewportClear:!0,frameBufferTexture:new zr,renderPasses:[new fn({viewportClear:!0,material:e.renderPassMosaic})]})],e.renderPassesSimple=[new mn],e.renderPasses=e.renderPassesWithMosaic,e.sprites={},e.mouseDown=!1,e}return It(t,e),Nt(t,[{key:"onload",value:function(){var e=this;this.viewports[0].id=0;var t=new Or({projectionType:"orthographic",transform:new wn({position:[0,0,10]})});this.add(t),this.viewports[0].bindToCamera(t),this.renderPassMosaic.fadeIn(function(){e.renderPasses=e.renderPassesSimple}),this.loadScene().then(function(){e.setTimeout(function(){e.viewportElements[0].addEventListener("mousedown",function(t){return e.onMouseDown(t)},!1),e.viewportElements[0].addEventListener("touchstart",function(t){return e.onMouseDown(t)},!1),e.viewportElements[0].addEventListener("mouseup",function(t){return e.onClick(t)},!1),e.viewportElements[0].addEventListener("touchend",function(t){return e.onClick(t)},!1),game.router.map.game.module.playSFX("Title-Music")},150)})}},{key:"onMouseDown",value:function(){this.mouseDown=!0,this.sprites.button.components[0].currentAnimation.setFrame(5)}},{key:"onClick",value:function(){this.mouseDown=!1,game.router.map.game.module.playSFX("Silence"),this.renderPasses=this.renderPassesWithMosaic,this.renderPassMosaic.fadeOut(function(){router.navigate("game")})}},{key:"loadScene",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t=this,r,n,a,o,l,s,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.newSprite({label:"background-light",frame:0,x:0,y:-1,z:-2,scale:[10.01,10.01,1]});case 2:r=240,n=Tt(768/r)+1,a=regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.newSprite({label:"background-pattern-"+a,frame:20,x:0,y:a*r,z:-1,scale:[1,1,1]});case 2:t.setInterval(function(){t.sprites["background-pattern-"+a].transform.y-=1,t.sprites["background-pattern-"+a].transform.y<-r&&(t.sprites["background-pattern-"+a].transform.y=r*n-1)},16);case 3:case"end":return e.stop();}},e,t)}),o=0;case 6:if(!(o<n+1)){e.next=11;break}return e.delegateYield(a(o),"t0",8);case 8:o++,e.next=6;break;case 11:return e.next=13,this.newSprite({label:"characters",frame:6,x:714,y:-1,z:2});case 13:return e.next=15,this.newSprite({label:"game-logo",frame:8,x:19,y:131,z:3});case 15:return e.next=17,this.newSprite({label:"logo",frame:21,x:96,y:520,z:0});case 17:return e.next=19,this.newSprite({label:"panel",frame:19,x:92,y:36,z:4});case 19:return e.next=21,this.newSprite({label:"button",frame:1,x:236,y:22,z:5});case 21:return e.next=23,this.newSprite({label:"credits",frame:7,x:800,y:0,z:4});case 23:return l=(Ea.version+"").split(""),e.next=26,this.newSprite({label:"version-v",frame:33,x:10,y:10,z:4});case 26:if(void 0===l[0]){e.next=29;break}return e.next=29,this.newSprite({label:"version-major",frame:22+"0123456789.v".indexOf(l[0]),x:34,y:10,z:4});case 29:if(void 0===l[1]){e.next=32;break}return e.next=32,this.newSprite({label:"version-.",frame:22+"0123456789.v".indexOf(l[1]),x:44,y:10,z:4});case 32:if(void 0===l[2]){e.next=35;break}return e.next=35,this.newSprite({label:"version-minor-0",frame:22+"0123456789.v".indexOf(l[2]),x:56,y:10,z:4});case 35:if(void 0===l[3]){e.next=38;break}return e.next=38,this.newSprite({label:"version-minor-1",frame:22+"0123456789.v".indexOf(l[3]),x:72,y:10,z:4});case 38:if(void 0===l[4]){e.next=41;break}return e.next=41,this.newSprite({label:"version-minor-2",frame:22+"0123456789.v".indexOf(l[4]),x:88,y:10,z:4});case 41:return e.next=43,this.newSprite({label:"letter-0",frame:9,x:14,y:278,z:5,visible:!1});case 43:return e.next=45,this.newSprite({label:"letter-1",frame:10,x:141,y:312,z:5,visible:!1});case 45:return e.next=47,this.newSprite({label:"letter-2",frame:11,x:269,y:346,z:5,visible:!1});case 47:return e.next=49,this.newSprite({label:"letter-3",frame:12,x:364,y:373,z:5,visible:!1});case 49:return e.next=51,this.newSprite({label:"letter-4",frame:13,x:461,y:398,z:5,visible:!1});case 51:return e.next=53,this.newSprite({label:"letter-5",frame:14,x:115,y:149,z:5,visible:!1});case 53:return e.next=55,this.newSprite({label:"letter-6",frame:15,x:243,y:184,z:5,visible:!1});case 55:return e.next=57,this.newSprite({label:"letter-7",frame:16,x:369,y:219,z:5,visible:!1});case 57:return e.next=59,this.newSprite({label:"letter-8",frame:17,x:498,y:253,z:5,visible:!1});case 59:return e.next=61,this.newSprite({label:"letter-9",frame:18,x:625,y:287,z:5,visible:!1});case 61:return e.next=63,this.newSprite({label:"pixelation",frame:0,x:-10,y:-1,z:8,scale:[10,10,1]});case 63:this.sprites.pixelation.visible=!1,s=-1,this.setInterval(function(){s++,3<s&&(s=0),t.mouseDown||t.sprites.button.components[0].currentAnimation.setFrame(1+s)},200),c=-1,u=this.setInterval(function(){c++,c>Ea.titleAnimationSequence.length-1&&(c=0);for(var e=0,r;10>e;e++)r=-1<Ea.titleAnimationSequence[c].indexOf(e+1),t.sprites["letter-"+e].visible=r;u.interval=Ea.titleAnimationSequence[c][0]},100);case 68:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"newSprite",value:function(){var e=kt(regeneratorRuntime.mark(function e(t){var r=t.label,n=t.frame,a=void 0===n?0:n,o=t.x,i=void 0===o?0:o,l=t.y,s=void 0===l?0:l,c=t.z,u=void 0===c?0:c,d=t.scale,p=void 0===d?[1,1,1]:d,m=t.pivot,f=t.visible,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g=ya.cloneSprite(router.map.preloader.module.assets["main-TitleCard"],!0),g.selectAnimation("main-TitleCard"),g.currentAnimation.setFrame(a),this.sprites[r]=new Nr({components:[g],transform:new wn({position:[i,s,u],scale:p})}),this.sprites[r].visible=void 0===f||f,this.add(this.sprites[r]);case 6:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fadeIn",value:function(){var e=this;this.sprites.pixelation.visible=!0,this.sprites.pixelation.components[0].currentAnimation.setFrame(2);var t=0;this.setInterval(function(){e.sprites.pixelation.components[0].currentAnimation.setFrame(1-t),t++,1<t&&(e.sprites.pixelation.visible=!1)},1e3/12,2)}},{key:"fadeOut",value:function(e){var t=this;this.sprites.pixelation.visible=!0,this.sprites.pixelation.components[0].currentAnimation.setFrame(0);var r=0;this.setInterval(function(){t.sprites.pixelation.components[0].currentAnimation.setFrame(r),r++,6<=r&&e&&e()},1e3/12,6)}}]),t}(hn),ka=5,Aa=13,Na=29,Pa=36,Ia=87,Fa=56,Ma=66,Ca=76,Ra=81,La=85,Da=96,Oa=99,Ga=92,Ua=102,Ba=74,Va=[9,9,9,9,1],Ha=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Ft(e),At(this,t);var r=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return r.spriteModel=null,r.model=new un({meshes:[new sn({id:"MESH_SPRITEMAP_0E_"+r.id,material:new ia({name:"MATERIAL_SPRITEMAP_0",lighting:0,shadowCastingMode:1}),bufferUsage:{vertices:"DYNAMIC_DRAW",uvs:"DYNAMIC_DRAW",normals:"DYNAMIC_DRAW",weights:"STATIC_DRAW",weightIndices:"STATIC_DRAW"}})]}),r.addComponent(r.model),r.sprites={},r.isReady=!1,r.selectedInstrumentSequence=[],r.paletteTextures=[],r.presetNo=-1,r.paletteNo=0,r.arrays={vertices:null,uvs:null,normals:null},r.hasTapped={board:!1,instrument:!1},r}return It(t,e),Nt(t,[{key:"update",value:function(){for(var e in Pt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).apply(this,arguments),this.sprites){var r;(r=this.sprites[e]).update.apply(r,arguments)}this.updateTiles(),this.refreshModel(!0)}},{key:"refreshModel",value:function(e){var t=[],r=[],n=[],a=!0,o=!1,l=void 0;try{for(var s=Object.keys(this.sprites)[Symbol.iterator](),c;!(a=(c=s.next()).done);a=!0){var u=c.value,d=this.sprites[u];if(e){for(var p=0;p<d.components[0].mesh.vertices.length;p+=3)t.push(d.components[0].mesh.vertices[p+0]*d.components[0].transform.sx+d.components[0].transform.x),t.push(d.components[0].mesh.vertices[p+1]*d.components[0].transform.sy+d.components[0].transform.y),d.visible?t.push(d.components[0].mesh.vertices[p+2]+d.components[0].transform.z):t.push(-1e4);for(var m=0;m<d.components[0].mesh.normals.length;m++)n.push(d.components[0].mesh.normals[m])}for(var f=0;f<d.components[0].mesh.uvs.length;f++)r.push(d.components[0].mesh.uvs[f])}}catch(e){o=!0,l=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw l}}e&&((!this.arrays.vertices||this.arrays.vertices.length!==t.length)&&(this.arrays.vertices=new Float32Array(t.length),this.model.meshes[0].vertices=this.arrays.vertices),(!this.arrays.normals||this.arrays.normals.length!==n.length)&&(this.arrays.normals=new Float32Array(n.length),this.model.meshes[0].normals=this.arrays.normals),this.arrays.vertices.set(t),this.arrays.normals.set(n)),this.arrays.uvs&&this.arrays.uvs.length===r.length||(this.arrays.uvs=new Float32Array(r.length),this.model.meshes[0].uvs=this.arrays.uvs),this.arrays.uvs.set(r),this.model.meshes[0].invalidate(e,!0,!0)}},{key:"build",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t=this,r,n,a,o,l,s,c,u,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.newSprite("background",0,-228,-128,-3,void 0,[228,128,0],[.5,.5]);case 2:return e.next=4,this.newSprite("panel",97,66,83);case 4:return e.next=6,this.newSprite("panel-top",82,91,632,-1,function(){return t.reverseDirection()});case 6:return e.next=8,this.newSprite("tempo",99,1086,632,0,function(e,r,n){t.changeTempo(e,r,n)});case 8:return e.next=10,this.newSprite("palette",Ia,912,632,0,function(){return t.cycleColorPalette()});case 10:return e.next=12,this.newSprite("echo-arrow",Ra,1025.5,680,2);case 12:return e.next=14,this.newSprite("echo",83,999,632,0,function(){return t.cycleEcho()});case 14:return e.next=16,this.newSprite("pause-arrow",Ra,1234,680,2);case 16:return e.next=18,this.newSprite("pause",98,1218,632,0,function(){return t.pause()});case 18:return e.next=20,this.newSprite("reset-confirm",100,1184,86,2,function(e,r,n){t.reset(e,r,n)});case 20:return e.next=22,this.newSprite("reset-open",101,1198,86,1,function(){return t.resetOpen()});case 22:return e.next=24,this.newSprite("hand",Ca,740,142,10,void 0,[7,7,1],[0,0],100,5);case 24:return e.next=26,this.newSprite("hand-2",Ca,-45,-170,10,void 0,[7,7,1],[0,0],100,5);case 26:r=0;case 27:if(!(3>r)){e.next=33;break}return e.next=30,this.newSprite("tempo-NO-"+r,Pa,1115+19*r,648);case 30:r++,e.next=27;break;case 33:return e.next=35,this.newSprite("Tom",Na,80,590,9);case 35:return e.next=37,this.newSprite("Jerry",Aa,176,590,10);case 37:n=regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.newSprite("fruit-"+r,Fa+r,124+70*r,106,1,function(){t.hasTapped.instrument=!0,t.parentScene.tutorialInterval&&(t.parentScene.tutorialInterval.currentTime=1600),t.selectInstrument(r,!1),t.parentScene.addExp(t.parentScene.CONFIG.expValue.construction.newInstrument),t.checkCheatSequence(r)});case 2:return e.next=4,t.newSprite("fruit-arrow-"+r,Ra,146+70*r,166,2);case 4:return e.next=6,t.newSprite("fruit-lock-"+r,Da,131+70*r,70,3);case 6:if(n=t.parentScene.CONFIG.unlockLevels.instruments[r],!(0<n)){e.next=11;break}return e.next=10,t.newSprite("lvl-lock-"+r,Ga+(n-2),129+70*r,135,4);case 10:t.sprites["lvl-lock-"+r].visible=!1;case 11:t.sprites["fruit-"+r].visible=!1;case 12:case"end":return e.stop();}},e,t)}),a=0;case 39:if(!(10>a)){e.next=44;break}return e.delegateYield(n(a),"t0",41);case 41:a++,e.next=39;break;case 44:o=regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.newSprite("heart-"+r,La,905+53*r,84,3,function(){t.selectPreset(r,!1)});case 2:return e.next=4,t.newSprite("heart-arrow-"+r,Ra,917+53*r,135,5);case 4:return e.next=6,t.newSprite("heart-lock-"+r,Oa,904+53*r,64,3);case 6:if(t.sprites["heart-arrow-"+r].visible=!1,t.sprites["heart-lock-"+r].visible=!1,n=t.parentScene.CONFIG.unlockLevels.presets[r],!(0<n)){e.next=13;break}return e.next=12,t.newSprite("lvl-lock-heart-"+r,Ga+(n-2),900+53*r,84,4);case 12:t.sprites["lvl-lock-heart-"+r].visible=!1;case 13:case"end":return e.stop();}},e,t)}),l=0;case 46:if(!(l<ka)){e.next=51;break}return e.delegateYield(o(l),"t1",48);case 48:l++,e.next=46;break;case 51:s=regeneratorRuntime.mark(function e(r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.newSprite("tile-"+r+"-"+n,Ua,92+r*Ba,199+n*39,0,function(){t.setNote(r,n)});case 2:case"end":return e.stop();}},e,t)}),a=0;case 2:if(!(a<t.parentScene.CONFIG.tracks)){e.next=7;break}return e.delegateYield(n(a),"t0",4);case 4:a++,e.next=2;break;case 7:case"end":return e.stop();}},e,t)}),c=0;case 53:if(!(c<this.parentScene.CONFIG.steps)){e.next=58;break}return e.delegateYield(s(c),"t2",55);case 55:c++,e.next=53;break;case 58:for(this.sprites["hand-2"].visible=!1,this.sprites["pause-arrow"].visible=!1,this.sprites["echo-arrow"].visible=!1,this.sprites["reset-confirm"].visible=!1,this.sprites.hand.visible=!1,u=0;u<9;u++)this.paletteTextures.push(router.map.preloader.module.assets["res/img/main-0"+(u+1)+".png"]);d=0,this.parentScene.setInterval(function(){t.parentScene.paused||0>=t.parentScene.tempo?(t.pausedIntervalCount++,140>t.pausedIntervalCount?(14<d&&(d=0),t.sprites.Tom.components[0].currentAnimation.setFrame(21+Tt(d/2)),t.sprites.Jerry.components[0].currentAnimation.setFrame(5+Tt(d/2))):(6<d&&(d=0),t.sprites.Tom.components[0].currentAnimation.setFrame(17+Tt(d/2)),t.sprites.Jerry.components[0].currentAnimation.setFrame(1+Tt(d/2)))):(t.pausedIntervalCount=0,3<d&&(d=0),t.sprites.Tom.components[0].currentAnimation.setFrame(Na+d),t.sprites.Jerry.components[0].currentAnimation.setFrame(Aa+d)),d++},100),this.cycleColorPalette(0,!0),this.isReady=!0;case 68:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"newSprite",value:function(){var e=kt(regeneratorRuntime.mark(function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,l=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[1,1,1],s=this,c=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,u=9<arguments.length&&void 0!==arguments[9]?arguments[9]:1,d,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d=ya.cloneSprite(router.map.preloader.module.assets.main,!0),d.transform=new wn({position:[n,a,o],scale:l}),d.selectAnimation("main"),d.currentAnimation.setFrame(r),this.sprites[t]=new Nr({components:[d]}),this.model.meshes[0].material=router.map.preloader.module.assets.main.mesh.material,this.sprites[t].onClick=i,1<u&&(p=0,this.parentScene.setInterval(function(){s.sprites[t].visible&&(p++,p>=u&&(p=0),d.currentAnimation.setFrame(p+r))},c));case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClick",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=!0,n=!1,a=void 0;try{for(var o=Object.keys(this.sprites)[Symbol.iterator](),i;!(r=(i=o.next()).done);r=!0){var l=i.value,s=this.sprites[l];if(s.visible&&e>s.components[0].transform.x&&e<s.components[0].transform.x+s.components[0].width&&t>s.components[0].transform.y&&t<s.components[0].transform.y+s.components[0].height&&s.onClick){s.onClick(e-s.components[0].transform.x,t-s.components[0].transform.y,s);break}}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}77<e&&1261>e&&588<t&&633>t&&this.reverseDirection()}},{key:"cycleColorPalette",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.paletteNo+1,t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];this.paletteNo=e,this.paletteNo>Et(this.paletteTextures.length-1,this.parentScene.level-1)&&(this.paletteNo=0),0>this.paletteNo&&(this.paletteNo=this.paletteTextures.length),game.router.map.game.module.spriteMap.components[0].meshes[0].material.diffuseTexture=this.paletteTextures[this.paletteNo],t||(1<this.parentScene.level?this.parentScene.playSFX("Palette"):this.parentScene.playSFX("Palette-Locked"))}},{key:"changeTempo",value:function(e,t,r){var n=10;n*=e<r.components[0].width/2?-1:1,this.parentScene.setTempo(this.parentScene.tempo+n),this.parentScene.playSFX("Button"),this.updateTiles()}},{key:"checkCheatSequence",value:function(e){this.selectedInstrumentSequence.push(e);for(var t=0;t<this.selectedInstrumentSequence.length;t++)if(this.selectedInstrumentSequence[t]!==Va[t]&&this.selectedInstrumentSequence[t]!==Va[t]){this.selectedInstrumentSequence=[e];break}this.selectedInstrumentSequence.toString()===Va.toString()&&(this.parentScene.exp=99999)}},{key:"pause",value:function(){this.parentScene.pause(),this.parentScene.playSFX("Timer-"+(this.parentScene.paused?"On":"Off")),this.sprites.pause.components[0].transform.y=this.parentScene.paused?622:632,this.sprites["pause-arrow"].visible=this.parentScene.paused}},{key:"resetOpen",value:function(){this.sprites["reset-confirm"].visible=!0,this.parentScene.playSFX("Trash-Tap")}},{key:"reset",value:function(e,t,r){var n=!(t<72+(r.components[0].height-72)/2);n?(this.parentScene.reset(),this.parentScene.playSFX("Trash-Thumbup")):this.parentScene.playSFX("Trash-Thumbdown"),r.visible=!1}},{key:"reverseDirection",value:function(){this.parentScene.reverseDirection()}},{key:"setNote",value:function(e,t){this.hasTapped.board||(this.hasTapped.board=!0,this.parentScene.tutorialInterval&&3<this.parentScene.tutorialInterval.stepNo&&(this.parentScene.tutorialInterval.currentTime=1600)),this.parentScene.sequence[e][t]?(this.parentScene.unsetNote(e,t),this.parentScene.playSFX("Grid-Tap-Off")):(this.parentScene.setNote(e,t),this.parentScene.playSFX("Grid-Tap-On"))}},{key:"selectPreset",value:function(){var e=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(r==this.presetNo)return void this.parentScene.setToURL();if(0>this.parentScene.unlocked.presets.indexOf(r)){this.sprites["lvl-lock-heart-"+r].components[1]&&this.sprites["lvl-lock-heart-"+r].removeComponent(this.sprites["lvl-lock-heart-"+r].components[1]),this.sprites["lvl-lock-heart-"+r].visible=!0,this.sprites["lvl-lock-heart-"+r].components[0].transform.y=84;var a=new Cn;return a.easeIn(this.sprites["lvl-lock-heart-"+r].components[0].transform,"y",124,1e3,function(){e.sprites["lvl-lock-heart-"+r].visible=!1}),this.sprites["lvl-lock-heart-"+r].addComponent(a),void this.parentScene.playSFX("Lock-LVL")}this.presetNo=r;for(var t=0,o;t<ka;t++)o=0>this.parentScene.unlocked.presets.indexOf(t)?84:La,this.sprites["heart-"+t].components[0].currentAnimation.setFrame(o),this.sprites["heart-"+t].components[0].transform.y=84,this.sprites["heart-arrow-"+t].visible=!1;this.sprites["heart-"+r].components[0].currentAnimation.setFrame(86),this.sprites["heart-"+r].components[0].transform.y=74,this.sprites["heart-arrow-"+r].visible=!0,this.parentScene.setPage(r),this.parentScene.setToURL(),n||this.parentScene.playSFX("Heart")}},{key:"selectInstrument",value:function(){var e=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(0<=r&&0>this.parentScene.unlocked.instruments.indexOf(r)){this.sprites["lvl-lock-"+r].components[1]&&this.sprites["lvl-lock-"+r].removeComponent(this.sprites["lvl-lock-"+r].components[1]),this.sprites["lvl-lock-"+r].visible=!0,this.sprites["lvl-lock-"+r].components[0].transform.y=120;var a=new Cn;return a.easeIn(this.sprites["lvl-lock-"+r].components[0].transform,"y",170,1e3,function(){e.sprites["lvl-lock-"+r].visible=!1}),this.sprites["lvl-lock-"+r].addComponent(a),void this.parentScene.playSFX("Lock-LVL")}for(var t=0;10>t;t++)0>this.parentScene.unlocked.instruments.indexOf(t)?this.sprites["fruit-"+t].components[0].currentAnimation.setFrame(Fa+t):this.sprites["fruit-"+t].components[0].currentAnimation.setFrame(Ma+t),this.sprites["fruit-"+t].components[0].transform.y=106,this.sprites["fruit-arrow-"+t].visible=!1;0<=r&&(this.sprites["fruit-"+r].components[0].currentAnimation.setFrame(Ma+r),this.sprites["fruit-"+r].components[0].transform.y=95,this.sprites["fruit-arrow-"+r].visible=!0,this.parentScene.setInstrument(r)),n||this.parentScene.playSound({note:"C#-4",instrument:r})}},{key:"unlockInstrument",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.sprites["fruit-lock-"+t].unlocked?void 0:1>=this.parentScene.CONFIG.unlockLevels.instruments[t]?void(this.sprites["fruit-lock-"+t].visible=!1):1>=this.parentScene.CONFIG.unlockLevels.instruments[t]?void(this.sprites["fruit-lock-"+t].visible=!1):void(this.sprites["fruit-lock-"+t].unlocked=!0,this.sprites["fruit-lock-"+t].components[0].currentAnimation.setFrame(Da),this.parentScene.setTimeout(function(){var r=0;e.parentScene.setInterval(function(){r++,3>r?e.sprites["fruit-lock-"+t].components[0].currentAnimation.setFrame(Da+r):e.sprites["fruit-lock-"+t].visible=!1},200,3)},850))}},{key:"cycleEcho",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.parentScene.delay?0:8;this.parentScene.delay=e,this.parentScene.delay?this.parentScene.playSFX("Echo-Select"):this.parentScene.playSFX("Echo-Deselect")}},{key:"unlockPreset",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.sprites["heart-"+t].unlocked?void 0:1>=this.parentScene.CONFIG.unlockLevels.presets[t]?void(this.sprites["heart-lock-"+t].visible=!1):void(this.sprites["heart-"+t].unlocked=!0,this.sprites["heart-"+t].components[0].currentAnimation.setFrame(La+1),this.sprites["heart-lock-"+t].components[0].currentAnimation.setFrame(Oa),this.parentScene.setTimeout(function(){var r=0;e.parentScene.setInterval(function(){r++,3>r?e.sprites["heart-lock-"+t].components[0].currentAnimation.setFrame(Oa+r):e.sprites["heart-lock-"+t].visible=!1},250,3)},850))}},{key:"updateTiles",value:function(){if(this.isReady){var e=this.sprites["tile-"+(this.parentScene.stepNo-1*this.parentScene.direction%this.parentScene.CONFIG.steps)+"-0"],t=this.sprites["tile-"+this.parentScene.stepNo%this.parentScene.CONFIG.steps+"-0"];this.sprites.Tom.components[0].flipX=0>this.parentScene.direction,this.sprites.Jerry.components[0].flipX=0>this.parentScene.direction;var r=.5;this.parentScene.paused||(r=this.parentScene.interval?this.parentScene.interval.currentTime/this.parentScene.interval.interval:0),e?(this.sprites.Tom.visible=!0,this.sprites.Tom.components[0].transform.x=e.components[0].transform.x-(Ba*(1-r)-Ba/2)*this.parentScene.direction):this.sprites.Tom.visible=!1,this.sprites.Jerry.components[0].transform.x=t.components[0].transform.x-(Ba*(1-r)-Ba/2)*this.parentScene.direction;for(var n=0;n<this.parentScene.CONFIG.tracks;n++)for(var a=0;a<this.parentScene.CONFIG.steps;a++){var o=this.parentScene.sequence[a][n],l=this.sprites["tile-"+a+"-"+n];l&&(o?l.components[0].currentAnimation.setFrame(46+o.instrument):this.parentScene.delay&&a==this.parentScene.stepNo-1*this.parentScene.direction%this.parentScene.CONFIG.steps?l.components[0].currentAnimation.setFrame(Ua+1):a==this.parentScene.stepNo%this.parentScene.CONFIG.steps?l.components[0].currentAnimation.setFrame(Ua+2):l.components[0].currentAnimation.setFrame(Ua))}1<this.parentScene.level?this.sprites.palette.components[0].currentAnimation.setFrame(Ia+this.paletteNo+1):this.sprites.palette.components[0].currentAnimation.setFrame(Ia),this.parentScene.delay?(this.sprites.echo.components[0].transform.y=622,this.sprites["echo-arrow"].visible=!0):(this.sprites.echo.components[0].transform.y=632,this.sprites["echo-arrow"].visible=!1);var s=this.parentScene.tempo+"";s=("000"+s).substring(s.length);for(var c=0;3>c;c++)this.sprites["tempo-NO-"+c].components[0].currentAnimation.setFrame(Pa+1*s[c])}}}]),t}(Nr),za={compressor:new Pizzicato.Effects.Compressor({threshold:-24,ratio:12}),delay:new Pizzicato.Effects.Delay({time:.22,feedback:.4,mix:.3})},Wa=function(e){function t(){At(this,t);var e=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.CONFIG=Ea,e.renderPassMosaic=new Sa,e.renderPassesWithMosaic=[new mn({viewportClear:!0,frameBufferTexture:new zr,renderPasses:[new fn({viewportClear:!0,material:e.renderPassMosaic})]})],e.renderPassesSimple=[new mn],e.renderPasses=e.renderPassesWithMosaic,e.isReady=!1,e.samples={},e.tracks=[],e.soundGroups={},e.tempo=Ea.defaultTempo,e.currentInstrument=-1,e.direction=1,e.paused=!1,e.exp=0,e.currentLevelExp=0,e.nextLevelExp=0,e.unlocked={levels:[],instruments:[],presets:[]},e.used={tempos:[Ea.defaultTempo],instruments:[Ea.defaultInstrument]},e.sequence=[],e.stepNo=0,e.pages=[],e.pageNo=0,e.delay=0,e.delayApplied=[],e.spriteMap=new Ha,e.spriteMap.parentScene=e,e}return It(t,e),Nt(t,[{key:"onload",value:function(){var e=this;this.viewports[0].id=0,this.setSequence("default");var t=new Or({projectionType:"orthographic",transform:new wn({position:[0,0,100]})});this.add(t),this.viewports[0].bindToCamera(t),this.viewportElements[0].addEventListener("mousedown",function(t){return e.onClick(t)},!1),this.viewportElements[0].addEventListener("touchstart",function(t){return e.onClick(t)},!1),document.addEventListener("keypress",function(t){return e.onKeypress(t)},!1),this.startUpSequence(),this.add(this.spriteMap),t.visible=!1}},{key:"startUpSequence",value:function(){var e=kt(regeneratorRuntime.mark(function e(){var t=this,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.updateStatus(),this.renderPassMosaic.fadeIn(function(){t.renderPasses=t.renderPassesSimple}),this.paused=!0,this.setStep(1),this.stopSFX("Title-Music"),this.playSFX("Icon-Reveal"),r=0,this.setInterval(function(){t.spriteMap.sprites["fruit-"+r].components[0].transform.sxyz=[1.5,1.5,1.5],t.spriteMap.sprites["fruit-"+r].visible=!0,t.setTimeout(function(){t.spriteMap.sprites["fruit-"+(r-1)].components[0].transform.sxyz=[1,1,1]},100),r++},180,10),this.setFromURL()||(this.tutorialInterval=this.setTimeout(function(){t.spriteMap.sprites.hand.visible=!0,t.playSFX("Hand-Reveal"),t.setTimeout(function(){t.playSFX("Hand-First-Tap")},275);var e=4,r=!1;t.tutorialInterval=t.setInterval(function(){return(e++,5<e&&(e=1),t.spriteMap.hasTapped.instrument&&t.spriteMap.hasTapped.board)?(t.remove(t.tutorialInterval),void(t.spriteMap.sprites.hand.visible=!1)):void(t.spriteMap.hasTapped.instrument&&3>=e?e=4:t.spriteMap.hasTapped.board&&(3<e&&(r?(t.remove(t.tutorialInterval),t.spriteMap.sprites.hand.visible=!1):e=1),r=!0),3<e?(t.spriteMap.sprites.hand.components[0].transform.x=740,t.spriteMap.sprites.hand.components[0].transform.y=142):(t.spriteMap.sprites.hand.components[0].transform.x=-45+70*e,t.spriteMap.sprites.hand.components[0].transform.y=-170),t.tutorialInterval.stepNo=e)},1500)},2400)),this.setTimeout(function(){t.setupAudio(),t.paused=!1,t.currentInstrument=Ea.defaultInstrument,t.updateStatus(),t.ready()},2600);case 10:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateStatus",value:function(){var e=this;this.level=0;for(var t=0;t<Ea.unlockLevels.levels.length;t++)Ea.unlockLevels.levels[t]<=this.exp&&(this.level++,0>this.unlocked.levels.indexOf(t)&&(this.unlocked.levels.push(t),1<Ea.unlockLevels.levels[t]&&(this.spriteMap.sprites["bar-full-wait"].visible=!0,this.setTimeout(function(){e.spriteMap.sprites["bar-full-wait"].visible=!1,e.spriteMap.cycleColorPalette(e.level-1),e.playSFX("Unlock-"+(Tt(2*Math.random())+1))},1e3),this.playSFX("LevelUp"))));this.currentLevelExp=Ea.unlockLevels.levels[this.level-1],this.nextLevelExp=Ea.unlockLevels.levels[this.level],this.nextLevelExp||(this.nextLevelExp=this.currentLevelExp);for(var r=0;r<Ea.unlockLevels.instruments.length;r++)Ea.unlockLevels.instruments[r]<=this.level&&this.unlocked.instruments.indexOf(r)&&(this.spriteMap.unlockInstrument(r),this.unlocked.instruments.push(r));for(var n=0;n<Ea.unlockLevels.presets.length;n++)Ea.unlockLevels.presets[n]<=this.level&&this.unlocked.presets.indexOf(n)&&(this.spriteMap.unlockPreset(n),this.unlocked.presets.push(n));this.spriteMap.selectInstrument(this.currentInstrument,!0)}},{key:"preloadSamples",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},r=0,n=0;this.samples={};var a=!0,o=!1,i=void 0;try{for(var l=Ea.instruments[Symbol.iterator](),s;!(a=(s=l.next()).done);a=!0){var c=s.value,u=!0,d=!1,p=void 0;try{for(var m=c.samples[Symbol.iterator](),f,g;!(u=(f=m.next()).done);u=!0)g=f.value,n++,this.samples[c.id]||(this.samples[c.id]={}),r++,this.samples[c.id][g.note]=new Pizzicato.Sound({source:"file",options:{path:"res/audio/"+g.filename,volume:g.volume,loop:g.loop,release:g.release,attack:g.attack},audioFunction:function(t){for(var e=t.outputBuffer.getChannelData(0),r=0;r<t.outputBuffer.length;r++)e[r]=Math.random()}},function(){r--,e((n-r)/n),0>=r&&t()})}catch(e){d=!0,p=e}finally{try{!u&&m.return&&m.return()}finally{if(d)throw p}}}}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}}},{key:"onKeypress",value:function(e){"$"==e.key&&(this.exp=99999),"0"==e.key&&(this.delay=0),"1"==e.key&&(this.delay=1),"2"==e.key&&(this.delay=2),"3"==e.key&&(this.delay=3),"4"==e.key&&(this.delay=4),"5"==e.key&&(this.delay=5),"6"==e.key&&(this.delay=6),"7"==e.key&&(this.delay=7),"8"==e.key&&(this.delay=8),"9"==e.key&&(this.delay=9)}},{key:"onClick",value:function(e){if(this.isReady){var t=this.viewportElements[0].clientHeight/768,r=e.target.getBoundingClientRect(),n=e.clientX-r.left,a=e.clientY-r.top;n/=t,a/=t,a=768-a,this.spriteMap.onClick(n,a),this.addExp(Ea.expValue.construction.click)}}},{key:"addExp",value:function(e){this.exp+=e,this.updateStatus()}},{key:"ready",value:function(){var e=this;this.spriteMap.selectPreset(0),this.interval=this.setInterval(function(){e.paused||e.setStep(e.stepNo+e.direction)},6e4/this.tempo/4),this.setInterval(function(){e.paused?e.addExp(Ea.expValue.construction.second):e.addExp(Ea.expValue.playback.second)},1e3),this.isReady=!0}},{key:"onAudioProcess",value:function(e){for(var t=0,r=0;r<e.length;r++)t=ht(t,e[r]);t/=128,t-=1}},{key:"pause",value:function(){this.paused=!this.paused,this.interval.enabled=!this.paused}},{key:"playSFX",value:function(e){this.samples[10][e].play()}},{key:"stopSFX",value:function(e){this.samples[10][e].stop()}},{key:"playSound",value:function(e){var t=e.note,r=void 0===t?"A#":t,n=e.instrument,a=void 0===n?1:n,o=e.delay,l=void 0===o?this.delay:o;if(this.samples&&this.samples[a]&&this.samples[a][r]){var s;for(var c in this.tracks[a]||(this.tracks[a]={}),this.tracks[a][r]||(this.tracks[a][r]=[]),this.tracks[a][r])if(!this.tracks[a][r][c].playing){s=this.tracks[a][r][c];break}s||(s=this.samples[a][r].clone(),this.tracks[a][r].push(s),!this.soundGroups[a]&&(this.soundGroups[a]=new Pizzicato.Group),this.soundGroups[a].addSound(s)),this.delayApplied[a]&&(this.removeAllEffects(this.soundGroups[a]),this.delayApplied[a]=!1),l&&(za.delay.time=6e4/this.tempo/4/128/this.delay,this.soundGroups[a].addEffect(za.delay),this.delayApplied[a]=!0),s.play()}}},{key:"reset",value:function(){this.setSequence("blank")}},{key:"reverseDirection",value:function(){this.direction*=-1,this.addExp(Ea.expValue.playback.reverse),this.playSFX("Scratch-"+(Tt(2*Math.random())+1))}},{key:"removeAllEffects",value:function(e){e.removeEffect(za.delay)}},{key:"setInstrument",value:function(e){this.currentInstrument=e}},{key:"setNote",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=r.note,a=void 0===n?"":n,o=r.instrument,i=void 0===o?this.currentInstrument:o,l=r.pan,s=void 0===l?1:l,c=r.pitch,u=void 0===c?0:c,d=r.volume,p=void 0===d?1:d,m=r.page,f=void 0===m?this.pageNo:m;if(!isNaN(i)){var g=!0,h=!1,v=void 0;try{for(var x=Ea.instruments[Symbol.iterator](),y,b;!(g=(y=x.next()).done);g=!0)b=y.value,b.id==i&&(i=b)}catch(e){h=!0,v=e}finally{try{!g&&x.return&&x.return()}finally{if(h)throw v}}}if(!a){var _=i.samples[t];if(!_)return;a=_.note}var T={note:a,instrument:i.id,pan:s,pitch:u,volume:p};this.pages[f]||(this.pages[f]=JSON.parse(JSON.stringify(Ea.sequences.blank)).notes),this.pages[f][e][t]=T,f===this.pageNo&&(this.sequence[e][t]=T)}},{key:"setPage",value:function(e){e==this.pageNo||(this.pages[this.pageNo]=JSON.parse(JSON.stringify(this.sequence)),this.pages[e]?this.sequence=JSON.parse(JSON.stringify(this.pages[e])):(this.sequence=JSON.parse(JSON.stringify(Ea.sequences.blank)).notes,this.playSFX("Fave")),this.pageNo=e)}},{key:"setSequence",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default",t=JSON.parse(JSON.stringify(Ea.sequences[e]));this.sequence=t.notes,this.setTempo(t.tempo)}},{key:"unsetNote",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.sequence[e][t]=0}},{key:"setStep",value:function(e){e>=Ea.steps&&(e=0),0>e&&(e=Ea.steps+e),this.stepNo=e;var t=!0,r=!1,n=void 0;try{for(var a=this.sequence[e%Ea.steps][Symbol.iterator](),o,i;!(t=(o=a.next()).done);t=!0)i=o.value,i&&this.playSound(i)}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}},{key:"setTempo",value:function(e){0>e||999<e||(this.interval&&(this.interval.interval=6e4/e/4),this.tempo=e,0>this.used.tempos.indexOf(e)&&(this.used.tempos.push(e),this.addExp(Ea.expValue.playback.reverse)))}},{key:"setupAudio",value:function(){var e=Pizzicato.context,t;t=e.createAnalyser();e.createScriptProcessor(2048,1,1);new Uint8Array(t.frequencyBinCount);var r=e.createDynamicsCompressor();r.threshold.setValueAtTime(-50,e.currentTime),r.knee.setValueAtTime(40,e.currentTime),r.ratio.setValueAtTime(12,e.currentTime),r.attack.setValueAtTime(0,e.currentTime),r.release.setValueAtTime(.25,e.currentTime),za.delay.connect(t),Pizzicato.masterGainNode.disconnect(),Pizzicato.masterGainNode.connect(r),r.connect(e.destination),Pizzicato.masterGainNode.connect(e.destination)}},{key:"setFromURL",value:function(){try{if(!(window.parent||window).location.hash)return;var e=LZString.decompressFromBase64((window.parent||window).location.hash.replace("#",""));this.setTempo(1*e.slice(0,3)),this.delay=1*e.slice(3,5),this.spriteMap.cycleColorPalette(1*e.slice(5,7),!0);var t=e.slice(7).match(/.{1,2}/g);if(!t)return;for(var r=0,n;r<t.length;r+=4)n=[1*t[r],1*t[r+1],1*t[r+2],1*t[r+3]],this.setNote(n[1],n[2],{instrument:n[3],page:n[0]});return this.addExp(Ea.expValue.playback.playSaved),!0}catch(t){}return!1}},{key:"setToURL",value:function(){try{this.pages[this.pageNo]=JSON.parse(JSON.stringify(this.sequence));var e="",t=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;return e+="",""+"0".repeat(ht(t-e.length,0))+e};e=t(this.tempo,3),e+=t(this.delay,2),e+=t(this.spriteMap.paletteNo,2);var r=!0,n=!1,a=void 0;try{for(var o=this.pages[Symbol.iterator](),i,l;!(r=(i=o.next()).done);r=!0)if(l=i.value,l)for(var s=0;s<l.length;s++)for(var c=0;c<l[s].length;c++){var u=l[s][c],d=this.pages.indexOf(l);if(u){var p=!0,m=!1,f=void 0;try{for(var g=Ea.instruments[Symbol.iterator](),h,v;!(p=(h=g.next()).done);p=!0)if(v=h.value,v.id==this.currentInstrument);}catch(e){m=!0,f=e}finally{try{!p&&g.return&&g.return()}finally{if(m)throw f}}e+=""+t(d,2)+t(s,2)+t(c,2)+t(u.instrument,2)}}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}(window.parent||window).location.hash=LZString.compressToBase64(e)}catch(t){}return!1}}]),t}(hn);window.Pizzicato=Pizzicato,window.LZString=Ct,new Bt({elementId:"error-console",alertOnError:!1}),Vt.DIRECTIONAL_SHADOWS_ENABLED=!1;window.game=new function e(){At(this,e),this.router=new gn({clock:new Br,map:{preloader:{module:new Ta},title:{module:new wa},game:{module:new Wa}}}),this.router.navigate("preloader")},window.router=window.game.router})();