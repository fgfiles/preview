(function(jg){function p(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function w(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=qg++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var G=function(){};G.__name__=["HxOverrides"];G.cca=function(a,
b){var c=a.charCodeAt(b);return c!=c?void 0:c};G.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};G.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};G.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var x=function(){};x.__name__=["Main"];x.main=function(){x.init()};x.validateBrowser=function(){var a=document.createElement("canvas");
if(null==a.getContext||null==a.getContext("2d").fillText)return!1;a=window.audioContextInstance;return n.isMobile()&&null==a?!1:!0};x.validateCookies=function(){return null!=Za.getLocalStorage()&&null!=Za.getSessionStorage()&&null!=navigator.cookieEnabled&&navigator.cookieEnabled};x.init=function(){if(x.validateBrowser())if(x.validateCookies()){x.container=x.getDocument().createElement("div");window.tabindex="0";x.container.style.position="relative";x.container.className="container";window.document.body.appendChild(x.container);
var a=x.getWindow().location.href,a=x.getQueryStringValue(a,"locale");""==a&&(a="en-us");x.dataLocale=a;x.root=new n("barbie_dreamhouse",1024,1024);x.root.addGameState(new Gd);x.root.init();window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){a=n.isMobile()?x.TARGET_FPS_MOBILE:x.TARGET_FPS;window.setTimeout(x.update,1E3/a)};x.update()}else window.location.href="cookies.html";else window.location.href="unsupported.html"};x.getQueryStringValue=
function(a,b){var c=a.split("?");if(2>c.length)return"";for(var c=c[1].split("&"),d=0,e=c.length;d<e;){var f=d++;if(Da.startsWith(c[f],b)&&(f=c[f].split("="),!(2>f.length)))return f[1]}return""};x.update=function(){x.root.processFrame();"1"==I.getProperty("debugDraw")&&x.root.debugRender();window.requestAnimFrame(x.update)};x.getDocument=function(){return window.document};x.getWindow=function(){return window};x.getCanvas=function(){return x.canvas};x.getContainer=function(){return x.container};x.getBasePath=
function(){for(var a=window.location.href.split("/"),b="",c=0,d=a.length-1;c<d;)var e=c++,b=b+(a[e]+"/");return b};Math.__name__=["Math"];var ma=function(){};ma.__name__=["Reflect"];ma.field=function(a,b){try{return a[b]}catch(c){return null}};ma.setProperty=function(a,b,c){var d,e;e=a.__properties__?d=a.__properties__["set_"+b]:!1;if(e)a[d](c);else a[b]=c};ma.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&("hx__closures__"!=d&&c.call(a,d))&&
b.push(d)}return b};ma.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};ma.compare=function(a,b){return a==b?0:a>b?1:-1};ma.compareMethods=function(a,b){return a==b?!0:ma.isFunction(a)&&ma.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};ma.isEnumValue=function(a){return null!=a?null!=a.__enum__:!1};var ra=function(){};ra.__name__=["Std"];ra.string=function(a){return y.__string_rec(a,"")};ra.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=
G.cca(a,1)&&88!=G.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};var ac=function(){this.b=""};ac.__name__=["StringBuf"];ac.prototype={__class__:ac};var Da=function(){};Da.__name__=["StringTools"];Da.startsWith=function(a,b){return a.length>=b.length?G.substr(a,0,b.length)==b:!1};Da.replace=function(a,b,c){return a.split(b).join(c)};var Wa=function(){};Wa.__name__=["Type"];Wa.getClassName=function(a){a=a.__name__;return null==a?null:a.join(".")};Wa.createEnum=function(a,b,c){var d=ma.field(a,b);
if(null==d)throw new K("No such constructor "+b);if(ma.isFunction(d)){if(null==c)throw new K("Constructor "+b+" need parameters");return d.apply(a,c)}if(null!=c&&0!=c.length)throw new K("Constructor "+b+" does not need parameters");return d};Wa.createEnumIndex=function(a,b,c){var d=a.__constructs__[b];if(null==d)throw new K(b+" is not a valid enum constructor index");return Wa.createEnum(a,d,c)};var C=function(a){this.nodeType=a;this.children=[];this.attributeMap=new Oa};C.__name__=["Xml"];C.parse=
function(a){return Lb.parse(a)};C.createElement=function(a){var b=new C(C.Element);if(b.nodeType!=C.Element)throw new K("Bad node type, expected Element but found "+b.nodeType);b.nodeName=a;return b};C.createPCData=function(a){var b=new C(C.PCData);if(b.nodeType==C.Document||b.nodeType==C.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};C.createCData=function(a){var b=new C(C.CData);if(b.nodeType==C.Document||b.nodeType==C.Element)throw new K("Bad node type, unexpected "+
b.nodeType);b.nodeValue=a;return b};C.createComment=function(a){var b=new C(C.Comment);if(b.nodeType==C.Document||b.nodeType==C.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};C.createDocType=function(a){var b=new C(C.DocType);if(b.nodeType==C.Document||b.nodeType==C.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};C.createProcessingInstruction=function(a){var b=new C(C.ProcessingInstruction);if(b.nodeType==C.Document||b.nodeType==
C.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};C.createDocument=function(){return new C(C.Document)};C.prototype={get:function(a){if(this.nodeType!=C.Element)throw new K("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=ea[a]?b.getReserved(a):b.h[a]},set:function(a,b){if(this.nodeType!=C.Element)throw new K("Bad node type, expected Element but found "+this.nodeType);var c=this.attributeMap;null!=ea[a]?c.setReserved(a,
b):c.h[a]=b},exists:function(a){if(this.nodeType!=C.Element)throw new K("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=ea[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},elementsNamed:function(a){if(this.nodeType!=C.Document&&this.nodeType!=C.Element)throw new K("Bad node type, expected Element or Document but found "+this.nodeType);for(var b=[],c=0,d=this.children;c<d.length;){var e=d[c];++c;var f;if(e.nodeType==C.Element){if(e.nodeType!=C.Element)throw new K("Bad node type, expected Element but found "+
e.nodeType);f=e.nodeName==a}else f=!1;f&&b.push(e)}return G.iter(b)},addChild:function(a){if(this.nodeType!=C.Document&&this.nodeType!=C.Element)throw new K("Bad node type, expected Element or Document but found "+this.nodeType);null!=a.parent&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){if(this.nodeType!=C.Document&&this.nodeType!=C.Element)throw new K("Bad node type, expected Element or Document but found "+this.nodeType);return G.remove(this.children,a)?
(a.parent=null,!0):!1},__class__:C};var $a=function(){this.lowerBound=new s;this.upperBound=new s};$a.__name__=["box2D","collision","B2AABB"];$a.prototype={isValid:function(){var a=this.upperBound.y-this.lowerBound.y;return a=(a=0<=this.upperBound.x-this.lowerBound.x&&0<=a)&&this.lowerBound.isValid()?this.upperBound.isValid():!1},getCenter:function(){return new s((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},getExtents:function(){return new s((this.upperBound.x-
this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},contains:function(a){var b;return b=(b=(b=(b=this.lowerBound.x<=a.lowerBound.x)?this.lowerBound.y<=a.lowerBound.y:!1)?a.upperBound.x<=this.upperBound.x:!1)?a.upperBound.y<=this.upperBound.y:!1},rayCast:function(a,b){var c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e=b.p1.x,f=b.p1.y,g=b.p2.x-b.p1.x,k=b.p2.y-b.p1.y,h=Math.abs(g),l=Math.abs(k),M=a.normal;if(h<Number.MIN_VALUE){if(e<this.lowerBound.x||this.upperBound.x<e)return!1}else if(h=1/g,
g=(this.lowerBound.x-e)*h,e=(this.upperBound.x-e)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(M.x=h,M.y=0,c=g),d=Math.min(d,e),c>d)return!1;if(l<Number.MIN_VALUE){if(f<this.lowerBound.y||this.upperBound.y<f)return!1}else if(h=1/k,g=(this.lowerBound.y-f)*h,e=(this.upperBound.y-f)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(M.y=h,M.x=0,c=g),d=Math.min(d,e),c>d)return!1;a.fraction=c;return!0},testOverlap:function(a){var b=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||
0<b||0<this.lowerBound.x-a.upperBound.x||0<c?!1:!0},combine:function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=Math.max(a.upperBound.x,b.upperBound.x);this.upperBound.y=Math.max(a.upperBound.y,b.upperBound.y)},__class__:$a};var s=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};s.__name__=["box2D","common","math","B2Vec2"];s.make=function(a,b){return new s(a,b)};s.prototype={setZero:function(){this.y=
this.x=0},set:function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b},setV:function(a){this.x=a.x;this.y=a.y},getNegative:function(){return new s(-this.x,-this.y)},negativeSelf:function(){this.x=-this.x;this.y=-this.y},copy:function(){return new s(this.x,this.y)},add:function(a){this.x+=a.x;this.y+=a.y},subtract:function(a){this.x-=a.x;this.y-=a.y},multiply:function(a){this.x*=a;this.y*=a},mulM:function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y;this.y=a.col1.y*b+a.col2.y*this.y},mulTM:function(a){var b=
r.dot(this,a.col1);this.y=r.dot(this,a.col2);this.x=b},crossVF:function(a){var b=this.x;this.x=a*this.y;this.y=-a*b},crossFV:function(a){var b=this.x;this.x=-a*this.y;this.y=a*b},minV:function(a){this.x=this.x<a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y},maxV:function(a){this.x=this.x>a.x?this.x:a.x;this.y=this.y>a.y?this.y:a.y},abs:function(){0>this.x&&(this.x=-this.x);0>this.y&&(this.y=-this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*
this.x+this.y*this.y},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;this.x*=b;this.y*=b;return a},isValid:function(){return r.isValid(this.x)?r.isValid(this.y):!1},__class__:s};var Hd=function(){this.v=new s;this.id=new xc};Hd.__name__=["box2D","collision","ClipVertex"];Hd.prototype={set:function(a){this.v.setV(a.v);this.id.set(a.id)},__class__:Hd};var xc=function(){this.features=new af;this.features._m_id=this};xc.__name__=["box2D","collision",
"B2ContactID"];xc.prototype={set:function(a){this.set_key(a._key)},copy:function(){var a=new xc;a.set_key(this.get_key());return a},get_key:function(){return this._key},set_key:function(a){this._key=a;this.features._referenceEdge=this._key&255;this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&-16777216)>>24&255;return this._key},__class__:xc,__properties__:{set_key:"set_key",get_key:"get_key"}};var af=function(){};
af.__name__=["box2D","collision","Features"];af.prototype={get_referenceEdge:function(){return this._referenceEdge},set_referenceEdge:function(a){this._referenceEdge=a;this._m_id._key=this._m_id._key&-256|this._referenceEdge&255;return a},get_incidentEdge:function(){return this._incidentEdge},set_incidentEdge:function(a){this._incidentEdge=a;this._m_id._key=this._m_id._key&-65281|this._incidentEdge<<8&65280;return a},get_incidentVertex:function(){return this._incidentVertex},set_incidentVertex:function(a){this._incidentVertex=
a;this._m_id._key=this._m_id._key&-16711681|this._incidentVertex<<16&16711680;return a},get_flip:function(){return this._flip},set_flip:function(a){this._flip=a;this._m_id._key=this._m_id._key&16777215|this._flip<<24&-16777216;return a},__class__:af,__properties__:{set_flip:"set_flip",get_flip:"get_flip",set_incidentVertex:"set_incidentVertex",get_incidentVertex:"get_incidentVertex",set_incidentEdge:"set_incidentEdge",get_incidentEdge:"get_incidentEdge",set_referenceEdge:"set_referenceEdge",get_referenceEdge:"get_referenceEdge"}};
var J=function(){};J.__name__=["box2D","collision","B2Collision"];J.clipSegmentToLine=function(a,b,c,d){var e,f=0;e=b[0];var g=e.v;e=b[1];var k=e.v,h=c.x*g.x+c.y*g.y-d;e=c.x*k.x+c.y*k.y-d;0>=h&&a[f++].set(b[0]);0>=e&&a[f++].set(b[1]);0>h*e&&(c=h/(h-e),e=a[f],e=e.v,e.x=g.x+c*(k.x-g.x),e.y=g.y+c*(k.y-g.y),e=a[f],e.id=(0<h?b[0]:b[1]).id,++f);return f};J.edgeSeparation=function(a,b,c,d,e){var f=a.m_vertices;a=a.m_normals;var g=d.m_vertexCount,k=d.m_vertices,h,l;h=b.R;l=a[c];a=h.col1.x*l.x+h.col2.x*l.y;
d=h.col1.y*l.x+h.col2.y*l.y;h=e.R;var M=h.col1.x*a+h.col1.y*d;h=h.col2.x*a+h.col2.y*d;for(var u=0,m=Number.MAX_VALUE,r=0;r<g;){var n=r++;l=k[n];l=l.x*M+l.y*h;l<m&&(m=l,u=n)}l=f[c];h=b.R;c=b.position.x+(h.col1.x*l.x+h.col2.x*l.y);b=b.position.y+(h.col1.y*l.x+h.col2.y*l.y);l=k[u];h=e.R;f=e.position.x+(h.col1.x*l.x+h.col2.x*l.y);e=e.position.y+(h.col1.y*l.x+h.col2.y*l.y);return(f-c)*a+(e-b)*d};J.findMaxSeparation=function(a,b,c,d,e){var f=b.m_vertexCount,g=b.m_normals,k,h=e.R;k=d.m_centroid;var l=e.position.x+
(h.col1.x*k.x+h.col2.x*k.y),M=e.position.y+(h.col1.y*k.x+h.col2.y*k.y),h=c.R;k=b.m_centroid;for(var l=l-(c.position.x+(h.col1.x*k.x+h.col2.x*k.y)),M=M-(c.position.y+(h.col1.y*k.x+h.col2.y*k.y)),h=l*c.R.col1.x+M*c.R.col1.y,M=l*c.R.col2.x+M*c.R.col2.y,l=0,u=-Number.MAX_VALUE,m=0;m<f;){var r=m++;k=g[r];k=k.x*h+k.y*M;k>u&&(u=k,l=r)}g=J.edgeSeparation(b,c,l,d,e);u=0<=l-1?l-1:f-1;h=J.edgeSeparation(b,c,u,d,e);m=l+1<f?l+1:0;M=J.edgeSeparation(b,c,m,d,e);if(h>g&&h>M)k=-1;else if(M>g)k=1,u=m,h=M;else return a[0]=
l,g;for(;;)if(l=-1==k?0<=u-1?u-1:f-1:u+1<f?u+1:0,g=J.edgeSeparation(b,c,l,d,e),g>h)u=l,h=g;else break;a[0]=u;return h};J.findIncidentEdge=function(a,b,c,d,e,f){var g=b.m_normals,k=e.m_vertexCount;b=e.m_vertices;e=e.m_normals;var h;h=c.R;c=g[d];var g=h.col1.x*c.x+h.col2.x*c.y,l=h.col1.y*c.x+h.col2.y*c.y;h=f.R;c=h.col1.x*g+h.col1.y*l;l=h.col2.x*g+h.col2.y*l;g=c;h=0;for(var M=Number.MAX_VALUE,u=0;u<k;){var m=u++;c=e[m];c=g*c.x+l*c.y;c<M&&(M=c,h=m)}e=h;g=e+1<k?e+1:0;k=a[0];c=b[e];h=f.R;k.v.x=f.position.x+
(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(e);k.id.features.set_incidentVertex(0);k=a[1];c=b[g];h=f.R;k.v.x=f.position.x+(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(g);k.id.features.set_incidentVertex(1)};J.makeClipPointVector=function(){var a=[];a[0]=new Hd;a[1]=new Hd;return a};J.collidePolygons=function(a,
b,c,d,e){var f;a.m_pointCount=0;var g=b.m_radius+d.m_radius,k;J.s_edgeAO[0]=0;var h=J.findMaxSeparation(J.s_edgeAO,b,c,d,e);k=J.s_edgeAO[0];if(!(h>g)){var l;J.s_edgeBO[0]=0;var M=J.findMaxSeparation(J.s_edgeBO,d,e,b,c);l=J.s_edgeBO[0];if(!(M>g)){M>0.98*h+0.001?(h=d,d=b,b=e,a.m_type=wa.FACE_B,k=1):(h=b,b=c,c=e,l=k,a.m_type=wa.FACE_A,k=0);e=J.s_incidentEdge;J.findIncidentEdge(e,h,b,l,d,c);M=h.m_vertices;d=M[l];var u;u=l+1<h.m_vertexCount?M[l+1|0]:M[0];h=J.s_localTangent;h.set(u.x-d.x,u.y-d.y);h.normalize();
M=J.s_localNormal;M.x=h.y;M.y=-h.x;var m=J.s_planePoint;m.set(0.5*(d.x+u.x),0.5*(d.y+u.y));f=J.s_tangent;l=b.R;f.x=l.col1.x*h.x+l.col2.x*h.y;f.y=l.col1.y*h.x+l.col2.y*h.y;var r=J.s_tangent2;r.x=-f.x;r.y=-f.y;h=J.s_normal;h.x=f.y;h.y=-f.x;var n=J.s_v11,q=J.s_v12;n.x=b.position.x+(l.col1.x*d.x+l.col2.x*d.y);n.y=b.position.y+(l.col1.y*d.x+l.col2.y*d.y);q.x=b.position.x+(l.col1.x*u.x+l.col2.x*u.y);q.y=b.position.y+(l.col1.y*u.x+l.col2.y*u.y);b=h.x*n.x+h.y*n.y;l=f.x*q.x+f.y*q.y+g;u=J.s_clipPoints1;d=J.s_clipPoints2;
e=J.clipSegmentToLine(u,e,r,-f.x*n.x-f.y*n.y+g);if(!(2>e||(e=J.clipSegmentToLine(d,u,f,l),2>e))){a.m_localPlaneNormal.setV(M);a.m_localPoint.setV(m);M=e=0;for(m=v.b2_maxManifoldPoints;M<m;)l=M++,f=d[l],h.x*f.v.x+h.y*f.v.y-b<=g&&(r=a.m_points[e],l=c.R,n=f.v.x-c.position.x,u=f.v.y-c.position.y,r.m_localPoint.x=n*l.col1.x+u*l.col1.y,r.m_localPoint.y=n*l.col2.x+u*l.col2.y,r.m_id.set(f.id),r.m_id.features.set_flip(k),++e);a.m_pointCount=e}}}};J.collideCircles=function(a,b,c,d,e){a.m_pointCount=0;var f,
g;f=c.R;g=b.m_p;var k=c.position.x+(f.col1.x*g.x+f.col2.x*g.y);c=c.position.y+(f.col1.y*g.x+f.col2.y*g.y);f=e.R;g=d.m_p;k=e.position.x+(f.col1.x*g.x+f.col2.x*g.y)-k;e=e.position.y+(f.col1.y*g.x+f.col2.y*g.y)-c;f=b.m_radius+d.m_radius;k*k+e*e>f*f||(a.m_type=wa.CIRCLES,a.m_localPoint.setV(b.m_p),a.m_localPlaneNormal.setZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))};J.collidePolygonAndCircle=function(a,b,c,d,e){a.m_pointCount=0;var f,g,k,h=e.R;k=d.m_p;
var l=e.position.y+(h.col1.y*k.x+h.col2.y*k.y);f=e.position.x+(h.col1.x*k.x+h.col2.x*k.y)-c.position.x;g=l-c.position.y;h=c.R;c=f*h.col1.x+g*h.col1.y;var h=f*h.col2.x+g*h.col2.y,M=0;e=-Number.MAX_VALUE;var l=b.m_radius+d.m_radius,u=b.m_vertexCount,m=b.m_vertices;b=b.m_normals;for(var r=0;r<u;){var n=r++;k=m[n];f=c-k.x;g=h-k.y;k=b[n];k=k.x*f+k.y*g;if(k>l)return;k>e&&(e=k,M=n)}k=M;f=m[k];u=m[k+1<u?k+1:0];e<Number.MIN_VALUE?(a.m_pointCount=1,a.m_type=wa.FACE_A,a.m_localPlaneNormal.setV(b[M]),a.m_localPoint.x=
0.5*(f.x+u.x),a.m_localPoint.y=0.5*(f.y+u.y),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):(e=(c-u.x)*(f.x-u.x)+(h-u.y)*(f.y-u.y),0>=(c-f.x)*(u.x-f.x)+(h-f.y)*(u.y-f.y)?(c-f.x)*(c-f.x)+(h-f.y)*(h-f.y)>l*l||(a.m_pointCount=1,a.m_type=wa.FACE_A,a.m_localPlaneNormal.x=c-f.x,a.m_localPlaneNormal.y=h-f.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):0>=e?(c-u.x)*(c-u.x)+(h-u.y)*(h-u.y)>l*l||(a.m_pointCount=
1,a.m_type=wa.FACE_A,a.m_localPlaneNormal.x=c-u.x,a.m_localPlaneNormal.y=h-u.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(u),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):(M=0.5*(f.x+u.x),f=0.5*(f.y+u.y),e=(c-M)*b[k].x+(h-f)*b[k].y,e>l||(a.m_pointCount=1,a.m_type=wa.FACE_A,a.m_localPlaneNormal.x=b[k].x,a.m_localPlaneNormal.y=b[k].y,a.m_localPlaneNormal.normalize(),a.m_localPoint.set(M,f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))))};J.testOverlap=
function(a,b){var c=b.lowerBound,d=a.upperBound,e=c.x-d.x,f=c.y-d.y,c=a.lowerBound,d=b.upperBound,g=c.y-d.y;return 0<e||0<f||0<c.x-d.x||0<g?!1:!0};var bf=function(){this.position=new s;this.velocity=new s;this.normal=new s;this.id=new xc};bf.__name__=["box2D","collision","B2ContactPoint"];bf.prototype={__class__:bf};var cf=function(){this.m_v1=new Tc;this.m_v2=new Tc;this.m_v3=new Tc;this.m_vertices=[];this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};cf.__name__=
["box2D","collision","B2Simplex"];cf.prototype={readCache:function(a,b,c,d,e){v.b2Assert(0<=a.count&&3>=a.count);var f,g;this.m_count=a.count;for(var k=this.m_vertices,h,l=0,M=this.m_count;l<M;)f=l++,h=k[f],h.indexA=a.indexA[f],h.indexB=a.indexB[f],f=b.getVertex(h.indexA),g=d.getVertex(h.indexB),h.wA=r.mulX(c,f),h.wB=r.mulX(e,g),h.w=r.subtractVV(h.wB,h.wA),h.a=0;1<this.m_count&&(a=a.metric,h=this.getMetric(),h<0.5*a||2*a<h||h<Number.MIN_VALUE)&&(this.m_count=0);0==this.m_count&&(h=k[0],h.indexA=0,
h.indexB=0,f=b.getVertex(0),g=d.getVertex(0),h.wA=r.mulX(c,f),h.wB=r.mulX(e,g),h.w=r.subtractVV(h.wB,h.wA),this.m_count=1)},writeCache:function(a){a.metric=this.getMetric();a.count=this.m_count|0;for(var b=this.m_vertices,c=0,d=this.m_count;c<d;){var e=c++;a.indexA[e]=b[e].indexA|0;a.indexB[e]=b[e].indexB|0}},getSearchDirection:function(){switch(this.m_count){case 1:return this.m_v1.w.getNegative();case 2:var a=r.subtractVV(this.m_v2.w,this.m_v1.w);return 0<r.crossVV(a,this.m_v1.w.getNegative())?
r.crossFV(1,a):r.crossVF(a,1);default:return v.b2Assert(!1),new s}},getClosestPoint:function(){switch(this.m_count){case 0:return v.b2Assert(!1),new s;case 1:return this.m_v1.w;case 2:return new s(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return v.b2Assert(!1),new s}},getWitnessPoints:function(a,b){switch(this.m_count){case 0:v.b2Assert(!1);break;case 1:a.setV(this.m_v1.wA);b.setV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+
this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:v.b2Assert(!1)}},getMetric:function(){switch(this.m_count){case 0:return v.b2Assert(!1),0;case 1:return 0;
case 2:return r.subtractVV(this.m_v1.w,this.m_v2.w).length();case 3:return r.crossVV(r.subtractVV(this.m_v2.w,this.m_v1.w),r.subtractVV(this.m_v3.w,this.m_v1.w));default:return v.b2Assert(!1),0}},solve2:function(){var a=this.m_v1.w,b=this.m_v2.w,c=r.subtractVV(b,a),a=-(a.x*c.x+a.y*c.y);0>=a?this.m_count=this.m_v1.a=1:(b=b.x*c.x+b.y*c.y,0>=b?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):(c=1/(b+a),this.m_v1.a=b*c,this.m_v2.a=a*c,this.m_count=2))},solve3:function(){var a=this.m_v1.w,b=this.m_v2.w,
c=this.m_v3.w,d=r.subtractVV(b,a),e=r.dot(a,d),f=r.dot(b,d),e=-e,g=r.subtractVV(c,a),k=r.dot(a,g),h=r.dot(c,g),k=-k,l=r.subtractVV(c,b),M=r.dot(b,l),l=r.dot(c,l),M=-M,g=r.crossVV(d,g),d=g*r.crossVV(b,c),c=g*r.crossVV(c,a),a=g*r.crossVV(a,b);0>=e&&0>=k?this.m_count=this.m_v1.a=1:0<f&&0<e&&0>=a?(h=1/(f+e),this.m_v1.a=f*h,this.m_v2.a=e*h,this.m_count=2):0<h&&0<k&&0>=c?(f=1/(h+k),this.m_v1.a=h*f,this.m_v3.a=k*f,this.m_count=2,this.m_v2.set(this.m_v3)):0>=f&&0>=M?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):
0>=h&&0>=l?(this.m_count=this.m_v3.a=1,this.m_v1.set(this.m_v3)):0<l&&0<M&&0>=d?(f=1/(l+M),this.m_v2.a=l*f,this.m_v3.a=M*f,this.m_count=2,this.m_v1.set(this.m_v3)):(f=1/(d+c+a),this.m_v1.a=d*f,this.m_v2.a=c*f,this.m_v3.a=a*f,this.m_count=3)},__class__:cf};var Tc=function(){};Tc.__name__=["box2D","collision","B2SimplexVertex"];Tc.prototype={set:function(a){this.wA.setV(a.wA);this.wB.setV(a.wB);this.w.setV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB},__class__:Tc};var ab=function(){};
ab.__name__=["box2D","collision","B2Distance"];ab.distance=function(a,b,c){++ab.b2_gjkCalls;var d=c.proxyA,e=c.proxyB,f=c.transformA,g=c.transformB,k=ab.s_simplex;k.readCache(b,d,f,e,g);var h=k.m_vertices,l=ab.s_saveA,M=ab.s_saveB,u=0;k.getClosestPoint().lengthSquared();for(var m,n=0;20>n;){u=k.m_count;m=0;for(var q=u;m<q;){var p=m++;l[p]=h[p].indexA;M[p]=h[p].indexB}switch(k.m_count){case 1:break;case 2:k.solve2();break;case 3:k.solve3();break;default:v.b2Assert(!1)}if(3==k.m_count)break;m=k.getClosestPoint();
m.lengthSquared();q=k.getSearchDirection();if(q.lengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;m=h[k.m_count];m.indexA=d.getSupport(r.mulTMV(f.R,q.getNegative()))|0;m.wA=r.mulX(f,d.getVertex(m.indexA));m.indexB=e.getSupport(r.mulTMV(g.R,q))|0;m.wB=r.mulX(g,e.getVertex(m.indexB));m.w=r.subtractVV(m.wB,m.wA);++n;++ab.b2_gjkIters;q=!1;for(p=0;p<u;){var t=p++;if(m.indexA==l[t]&&m.indexB==M[t]){q=!0;break}}if(q)break;++k.m_count}ab.b2_gjkMaxIters=r.max(ab.b2_gjkMaxIters,n)|0;k.getWitnessPoints(a.pointA,
a.pointB);a.distance=r.subtractVV(a.pointA,a.pointB).length();a.iterations=n;k.writeCache(b);c.useRadii&&(b=d.m_radius,e=e.m_radius,a.distance>b+e&&a.distance>Number.MIN_VALUE?(a.distance-=b+e,c=r.subtractVV(a.pointB,a.pointA),c.normalize(),a.pointA.x+=b*c.x,a.pointA.y+=b*c.y,a.pointB.x-=e*c.x,a.pointB.y-=e*c.y):(m=new s,m.x=0.5*(a.pointA.x+a.pointB.x),m.y=0.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=m.x,a.pointA.y=a.pointB.y=m.y,a.distance=0))};var df=function(){};df.__name__=["box2D","collision",
"B2DistanceInput"];df.prototype={__class__:df};var ef=function(){this.pointA=new s;this.pointB=new s};ef.__name__=["box2D","collision","B2DistanceOutput"];ef.prototype={__class__:ef};var Id=function(){this.m_vertices=[]};Id.__name__=["box2D","collision","B2DistanceProxy"];Id.prototype={set:function(a){switch(a.getType()[1]){case 1:a=y.__cast(a,bb);this.m_vertices=[];this.m_vertices[0]=a.m_p;this.m_count=1;this.m_radius=a.m_radius;break;case 2:a=y.__cast(a,ka);this.m_vertices=a.m_vertices;this.m_count=
a.m_vertexCount;this.m_radius=a.m_radius;break;default:v.b2Assert(!1)}},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_count;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_count;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},getVertexCount:function(){return this.m_count},
getVertex:function(a){v.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]},__class__:Id};var ff=function(){this.m_freeList=this.m_root=null;this.m_insertionCount=this.m_path=0};ff.__name__=["box2D","collision","B2DynamicTree"];ff.prototype={createProxy:function(a,b){var c=this.allocateNode(),d=v.b2_aabbExtension,e=v.b2_aabbExtension;c.aabb.lowerBound.x=a.lowerBound.x-d;c.aabb.lowerBound.y=a.lowerBound.y-e;c.aabb.upperBound.x=a.upperBound.x+d;c.aabb.upperBound.y=a.upperBound.y+e;c.userData=
b;this.insertLeaf(c);return c},destroyProxy:function(a){this.removeLeaf(a);this.freeNode(a)},moveProxy:function(a,b,c){v.b2Assert(a.isLeaf());if(a.aabb.contains(b))return!1;this.removeLeaf(a);var d=v.b2_aabbExtension+v.b2_aabbMultiplier*(0<c.x?c.x:-c.x);c=v.b2_aabbExtension+v.b2_aabbMultiplier*(0<c.y?c.y:-c.y);a.aabb.lowerBound.x=b.lowerBound.x-d;a.aabb.lowerBound.y=b.lowerBound.y-c;a.aabb.upperBound.x=b.upperBound.x+d;a.aabb.upperBound.y=b.upperBound.y+c;this.insertLeaf(a);return!0},rebalance:function(a){if(null!=
this.m_root)for(var b=0;b<a;){b++;for(var c=this.m_root,d=0;!1==c.isLeaf();)c=0!=(this.m_path>>d&1)?c.child2:c.child1,d=d+1&31;++this.m_path;this.removeLeaf(c);this.insertLeaf(c)}},getFatAABB:function(a){return a.aabb},getUserData:function(a){return a.userData},query:function(a,b){if(null!=this.m_root){var c=[],d=0;for(c[d++]=this.m_root;0<d;){var e=c[--d];if(e.aabb.testOverlap(b))if(e.isLeaf()){if(!a(e))break}else c[d++]=e.child1,c[d++]=e.child2}}},rayCast:function(a,b){if(null!=this.m_root){var c=
b.p1,d=b.p2,e=r.subtractVV(c,d);e.normalize();var e=r.crossFV(1,e),f=r.absV(e),g=b.maxFraction,k=new $a,h;h=c.x+g*(d.x-c.x);g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g);var l=[],m=0;for(l[m++]=this.m_root;0<m;)if(h=l[--m],!1!=h.aabb.testOverlap(k)){var g=h.aabb.getCenter(),u=h.aabb.getExtents();if(!(0<Math.abs(e.x*(c.x-g.x)+e.y*(c.y-g.y))-f.x*u.x-f.y*u.y))if(h.isLeaf()){g=new Jd;g.p1=b.p1;g.p2=b.p2;g.maxFraction=
b.maxFraction;g=a(g,h);if(0==g)break;h=c.x+g*(d.x-c.x);g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g)}else l[m++]=h.child1,l[m++]=h.child2}}},allocateNode:function(){if(null!=this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a}return new Uc},freeNode:function(a){a.parent=this.m_freeList;this.m_freeList=a},insertLeaf:function(a){++this.m_insertionCount;
if(null==this.m_root)this.m_root=a,this.m_root.parent=null;else{var b=a.aabb.getCenter(),c=this.m_root;if(!1==c.isLeaf())for(;;){var d=c.child1,c=c.child2,e=Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-b.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/2-b.y),f=Math.abs((c.aabb.lowerBound.x+c.aabb.upperBound.x)/2-b.x)+Math.abs((c.aabb.lowerBound.y+c.aabb.upperBound.y)/2-b.y),c=e<f?d:c;if(!1!=c.isLeaf())break}b=c.parent;d=this.allocateNode();d.parent=b;d.userData=null;d.aabb.combine(a.aabb,
c.aabb);if(null!=b)for(c.parent.child1==c?b.child1=d:b.child2=d,d.child1=c,d.child2=a,c.parent=d,a.parent=d;!b.aabb.contains(d.aabb)&&(b.aabb.combine(b.child1.aabb,b.child2.aabb),d=b,b=b.parent,null!=b););else d.child1=c,d.child2=a,c.parent=d,this.m_root=a.parent=d}},removeLeaf:function(a){if(a==this.m_root)this.m_root=null;else{var b=a.parent,c=b.parent;a=b.child1==a?b.child2:b.child1;if(null!=c)for(c.child1==b?c.child1=a:c.child2=a,a.parent=c,this.freeNode(b);null!=c;){b=c.aabb;c.aabb=new $a;c.aabb.combine(c.child1.aabb,
c.child2.aabb);if(b.contains(c.aabb))break;c=c.parent}else this.m_root=a,a.parent=null,this.freeNode(b)}},__class__:ff};var gf=function(){};gf.__name__=["box2D","collision","IBroadPhase"];gf.prototype={__class__:gf};var Kd=function(){this.m_tree=new ff;this.m_moveBuffer=[];this.m_pairBuffer=[];this.m_pairCount=0};Kd.__name__=["box2D","collision","B2DynamicTreeBroadPhase"];Kd.__interfaces__=[gf];Kd.prototype={createProxy:function(a,b){var c=this.m_tree.createProxy(a,b);++this.m_proxyCount;this.bufferMove(c);
return c},destroyProxy:function(a){this.unBufferMove(a);--this.m_proxyCount;this.m_tree.destroyProxy(a)},moveProxy:function(a,b,c){this.m_tree.moveProxy(a,b,c)&&this.bufferMove(a)},testOverlap:function(a,b){var c=this.m_tree.getFatAABB(a),d=this.m_tree.getFatAABB(b);return c.testOverlap(d)},getUserData:function(a){return this.m_tree.getUserData(a)},getFatAABB:function(a){return this.m_tree.getFatAABB(a)},getProxyCount:function(){return this.m_proxyCount},updatePairs:function(a){for(var b=this,c=this.m_pairCount=
0,d=this.m_moveBuffer;c<d.length;){var e=[d[c]];++c;var f=function(a){return function(c){if(c==a[0])return!0;b.m_pairCount==b.m_pairBuffer.length&&(b.m_pairBuffer[b.m_pairCount]=new hf);var d=b.m_pairBuffer[b.m_pairCount];c.id<a[0].id?(d.proxyA=c,d.proxyB=a[0]):(d.proxyA=a[0],d.proxyB=c);++b.m_pairCount;return!0}}(e),e=this.m_tree.getFatAABB(e[0]);this.m_tree.query(f,e)}this.m_moveBuffer=[];c=!0;for(d=0;c;)if(d>=this.m_pairCount)c=!1;else{var f=this.m_pairBuffer[d],e=this.m_tree.getUserData(f.proxyA),
g=this.m_tree.getUserData(f.proxyB);a(e,g);for(++d;d<this.m_pairCount;){e=this.m_pairBuffer[d];if(e.proxyA!=f.proxyA||e.proxyB!=f.proxyB)break;++d}}},query:function(a,b){this.m_tree.query(a,b)},rayCast:function(a,b){this.m_tree.rayCast(a,b)},validate:function(){},rebalance:function(a){this.m_tree.rebalance(a)},bufferMove:function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a},unBufferMove:function(a){G.remove(this.m_moveBuffer,a)},comparePairs:function(a,b){return 0},__class__:Kd};var Uc=function(){this.aabb=
new $a;this.id=Uc.currentID++};Uc.__name__=["box2D","collision","B2DynamicTreeNode"];Uc.prototype={isLeaf:function(){return null==this.child1},__class__:Uc};var hf=function(){};hf.__name__=["box2D","collision","B2DynamicTreePair"];hf.prototype={__class__:hf};var Vc=function(){this.m_pointCount=0;this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new jf}this.m_localPlaneNormal=new s;this.m_localPoint=new s};Vc.__name__=["box2D","collision","B2Manifold"];Vc.prototype=
{reset:function(){for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c].reset()}this.m_localPlaneNormal.setZero();this.m_localPoint.setZero();this.m_type=wa.CIRCLES;this.m_pointCount=0},set:function(a){this.m_pointCount=a.m_pointCount;for(var b=0,c=v.b2_maxManifoldPoints;b<c;){var d=b++;this.m_points[d].set(a.m_points[d])}this.m_localPlaneNormal.setV(a.m_localPlaneNormal);this.m_localPoint.setV(a.m_localPoint);this.m_type=a.m_type},copy:function(){var a=new Vc;a.set(this);return a},
__class__:Vc};var jf=function(){this.m_localPoint=new s;this.m_id=new xc;this.reset()};jf.__name__=["box2D","collision","B2ManifoldPoint"];jf.prototype={reset:function(){this.m_localPoint.setZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.set_key(0)},set:function(a){this.m_localPoint.setV(a.m_localPoint);this.m_normalImpulse=a.m_normalImpulse;this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.set(a.m_id)},__class__:jf};var wa={__ename__:!0,__constructs__:["CIRCLES","FACE_A","FACE_B"],
CIRCLES:["CIRCLES",0]};wa.CIRCLES.__enum__=wa;wa.FACE_A=["FACE_A",1];wa.FACE_A.__enum__=wa;wa.FACE_B=["FACE_B",2];wa.FACE_B.__enum__=wa;wa.__empty_constructs__=[wa.CIRCLES,wa.FACE_A,wa.FACE_B];var Jd=function(a,b,c){null==c&&(c=1);this.p1=new s;this.p2=new s;null!=a&&this.p1.setV(a);null!=b&&this.p2.setV(b);this.maxFraction=c};Jd.__name__=["box2D","collision","B2RayCastInput"];Jd.prototype={__class__:Jd};var kf=function(){this.normal=new s};kf.__name__=["box2D","collision","B2RayCastOutput"];kf.prototype=
{__class__:kf};var lf=function(){this.m_localPoint=new s;this.m_axis=new s};lf.__name__=["box2D","collision","B2SeparationFunction"];lf.prototype={initialize:function(a,b,c,d,e){this.m_proxyA=b;this.m_proxyB=d;b=a.count;v.b2Assert(0<b&&3>b);var f=new s,g=new s,k,h;if(1==b)this.m_type=Ha.POINTS,f=this.m_proxyA.getVertex(a.indexA[0]),g=this.m_proxyB.getVertex(a.indexB[0]),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*
h.x+k.col2.x*h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),this.m_axis.x=g-f,this.m_axis.y=e-c,this.m_axis.normalize();else{if(a.indexB[0]==a.indexB[1])this.m_type=Ha.FACE_A,b=this.m_proxyA.getVertex(a.indexA[0]),d=this.m_proxyA.getVertex(a.indexA[1]),g=this.m_proxyB.getVertex(a.indexB[0]),this.m_localPoint.x=0.5*(b.x+d.x),this.m_localPoint.y=0.5*(b.y+d.y),this.m_axis=r.crossVF(r.subtractVV(d,b),1),this.m_axis.normalize(),h=this.m_axis,k=c.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,
h=this.m_localPoint,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(g-f)*b+(e-c)*d;else if(a.indexA[0]==a.indexA[0])this.m_type=Ha.FACE_B,k=this.m_proxyB.getVertex(a.indexB[0]),h=this.m_proxyB.getVertex(a.indexB[1]),f=this.m_proxyA.getVertex(a.indexA[0]),this.m_localPoint.x=0.5*(k.x+h.x),this.m_localPoint.y=0.5*(k.y+h.y),this.m_axis=r.crossVF(r.subtractVV(h,
k),1),this.m_axis.normalize(),h=this.m_axis,k=e.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,h=this.m_localPoint,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(f-g)*b+(c-e)*d;else{b=this.m_proxyA.getVertex(a.indexA[0]);d=this.m_proxyA.getVertex(a.indexA[1]);k=this.m_proxyB.getVertex(a.indexB[0]);h=this.m_proxyB.getVertex(a.indexB[1]);r.mulX(c,
f);f=r.mulMV(c.R,r.subtractVV(d,b));r.mulX(e,g);a=r.mulMV(e.R,r.subtractVV(h,k));e=f.x*f.x+f.y*f.y;c=a.x*a.x+a.y*a.y;var l=r.subtractVV(a,f),g=f.x*l.x+f.y*l.y,l=a.x*l.x+a.y*l.y,f=f.x*a.x+f.y*a.y,m=e*c-f*f;a=0;0!=m&&(a=r.clamp((f*l-g*c)/m,0,1));0>(f*a+l)/c&&(a=r.clamp((f-g)/e,0,1));f=new s;f.x=b.x+a*(d.x-b.x);f.y=b.y+a*(d.y-b.y);g=new s;g.x=k.x+a*(h.x-k.x);g.y=k.y+a*(h.y-k.y);0==a||1==a?(this.m_type=Ha.FACE_B,this.m_axis=r.crossVF(r.subtractVV(h,k),1),this.m_axis.normalize(),this.m_localPoint=g):(this.m_type=
Ha.FACE_A,this.m_axis=r.crossVF(r.subtractVV(d,b),1),this.m_localPoint=f)}0>a&&this.m_axis.negativeSelf()}},evaluate:function(a,b){var c,d,e;switch(this.m_type[1]){case 0:return c=r.mulTMV(a.R,this.m_axis),d=r.mulTMV(b.R,this.m_axis.getNegative()),c=this.m_proxyA.getSupportVertex(c),d=this.m_proxyB.getSupportVertex(d),c=r.mulX(a,c),d=r.mulX(b,d),e=(d.x-c.x)*this.m_axis.x+(d.y-c.y)*this.m_axis.y;case 1:return e=r.mulMV(a.R,this.m_axis),c=r.mulX(a,this.m_localPoint),d=r.mulTMV(b.R,e.getNegative()),
d=this.m_proxyB.getSupportVertex(d),d=r.mulX(b,d),e=(d.x-c.x)*e.x+(d.y-c.y)*e.y;case 2:return e=r.mulMV(b.R,this.m_axis),d=r.mulX(b,this.m_localPoint),c=r.mulTMV(a.R,e.getNegative()),c=this.m_proxyA.getSupportVertex(c),c=r.mulX(a,c),e=(c.x-d.x)*e.x+(c.y-d.y)*e.y}},__class__:lf};var Ha={__ename__:!0,__constructs__:["POINTS","FACE_A","FACE_B"],POINTS:["POINTS",0]};Ha.POINTS.__enum__=Ha;Ha.FACE_A=["FACE_A",1];Ha.FACE_A.__enum__=Ha;Ha.FACE_B=["FACE_B",2];Ha.FACE_B.__enum__=Ha;Ha.__empty_constructs__=
[Ha.POINTS,Ha.FACE_A,Ha.FACE_B];var mf=function(){this.indexA=[];this.indexB=[]};mf.__name__=["box2D","collision","B2SimplexCache"];mf.prototype={__class__:mf};var nf=function(){this.proxyA=new Id;this.proxyB=new Id;this.sweepA=new Mb;this.sweepB=new Mb};nf.__name__=["box2D","collision","B2TOIInput"];nf.prototype={__class__:nf};var pb=function(a,b){this.position=new s;this.R=new da;null!=a&&(this.position.setV(a),this.R.setM(b))};pb.__name__=["box2D","common","math","B2Transform"];pb.prototype={initialize:function(a,
b){this.position.setV(a);this.R.setM(b)},setIdentity:function(){this.position.setZero();this.R.setIdentity()},set:function(a){this.position.setV(a.position);this.R.setM(a.R)},getAngle:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},__class__:pb};var da=function(){this.col1=new s(0,1);this.col2=new s(0,1)};da.__name__=["box2D","common","math","B2Mat22"];da.fromAngle=function(a){var b=new da;b.set(a);return b};da.fromVV=function(a,b){var c=new da;c.setVV(a,b);return c};da.prototype={set:function(a){var b=
Math.cos(a);a=Math.sin(a);this.col1.x=b;this.col2.x=-a;this.col1.y=a;this.col2.y=b},setVV:function(a,b){this.col1.setV(a);this.col2.setV(b)},copy:function(){var a=new da;a.setM(this);return a},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col1.y=
0;this.col2.y=0},getAngle:function(){return Math.atan2(this.col1.y,this.col1.x)},getInverse:function(a){var b=this.col1.x,c=this.col2.x,d=this.col1.y,e=this.col2.y,f=b*e-c*d;0!=f&&(f=1/f);a.col1.x=f*e;a.col2.x=-f*c;a.col1.y=-f*d;a.col2.y=f*b;return a},solve:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},abs:function(){this.col1.abs();this.col2.abs()},__class__:da};var N=function(){};N.__name__=["box2D",
"collision","B2TimeOfImpact"];N.timeOfImpact=function(a){++N.b2_toiCalls;var b=a.proxyA,c=a.proxyB,d=a.sweepA,e=a.sweepB;v.b2Assert(d.t0==e.t0);v.b2Assert(1-d.t0>Number.MIN_VALUE);var f=b.m_radius+c.m_radius;a=a.tolerance;var g=0,k=0,h=0;N.s_cache.count=0;for(N.s_distanceInput.useRadii=!1;;){d.getTransform(N.s_xfA,g);e.getTransform(N.s_xfB,g);N.s_distanceInput.proxyA=b;N.s_distanceInput.proxyB=c;N.s_distanceInput.transformA=N.s_xfA;N.s_distanceInput.transformB=N.s_xfB;ab.distance(N.s_distanceOutput,
N.s_cache,N.s_distanceInput);if(0>=N.s_distanceOutput.distance){g=1;break}N.s_fcn.initialize(N.s_cache,b,N.s_xfA,c,N.s_xfB);var l=N.s_fcn.evaluate(N.s_xfA,N.s_xfB);if(0>=l){g=1;break}0==k&&(h=l>f?r.max(f-a,0.75*f):r.max(l-a,0.02*f));if(l-h<0.5*a){if(0==k){g=1;break}break}var m=g,u=g,n=1;d.getTransform(N.s_xfA,n);e.getTransform(N.s_xfB,n);var q=N.s_fcn.evaluate(N.s_xfA,N.s_xfB);if(q>=h){g=1;break}for(var s=0;;){var p;p=0!=(s&1)?u+(h-l)*(n-u)/(q-l):0.5*(u+n);d.getTransform(N.s_xfA,p);e.getTransform(N.s_xfB,
p);var t=N.s_fcn.evaluate(N.s_xfA,N.s_xfB);if(r.abs(t-h)<0.025*a){m=p;break}t>h?(u=p,l=t):(n=p,q=t);++s;++N.b2_toiRootIters;if(50==s)break}N.b2_toiMaxRootIters=r.max(N.b2_toiMaxRootIters,s)|0;if(m<(1+100*Number.MIN_VALUE)*g)break;g=m;++k;++N.b2_toiIters;if(1E3==k)break}N.b2_toiMaxIters=r.max(N.b2_toiMaxIters,k)|0;return g};var of=function(){this.m_normal=new s;this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new s}};of.__name__=["box2D","collision","B2WorldManifold"];
of.prototype={initialize:function(a,b,c,d,e){if(0!=a.m_pointCount){var f,g,k,h,l,m,u;switch(a.m_type[1]){case 0:g=b.R;f=a.m_localPoint;k=b.position.x+g.col1.x*f.x+g.col2.x*f.y;h=b.position.y+g.col1.y*f.x+g.col2.y*f.y;g=d.R;f=a.m_points[0].m_localPoint;a=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*f.x+g.col2.y*f.y;g=a-k;d=f-h;l=g*g+d*d;l>Number.MIN_VALUE*Number.MIN_VALUE?(l=Math.sqrt(l),this.m_normal.x=g/l,this.m_normal.y=d/l):(this.m_normal.x=1,this.m_normal.y=0);g=h+c*this.m_normal.y;
f-=e*this.m_normal.y;this.m_points[0].x=0.5*(k+c*this.m_normal.x+(a-e*this.m_normal.x));this.m_points[0].y=0.5*(g+f);break;case 1:g=b.R;f=a.m_localPlaneNormal;k=g.col1.x*f.x+g.col2.x*f.y;h=g.col1.y*f.x+g.col2.y*f.y;g=b.R;f=a.m_localPoint;l=b.position.x+g.col1.x*f.x+g.col2.x*f.y;m=b.position.y+g.col1.y*f.x+g.col2.y*f.y;this.m_normal.x=k;this.m_normal.y=h;b=0;for(var r=a.m_pointCount;b<r;){var n=b++;g=d.R;f=a.m_points[n].m_localPoint;u=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*
f.x+g.col2.y*f.y;this.m_points[n].x=u+0.5*(c-(u-l)*k-(f-m)*h-e)*k;this.m_points[n].y=f+0.5*(c-(u-l)*k-(f-m)*h-e)*h}break;case 2:for(g=d.R,f=a.m_localPlaneNormal,k=g.col1.x*f.x+g.col2.x*f.y,h=g.col1.y*f.x+g.col2.y*f.y,g=d.R,f=a.m_localPoint,l=d.position.x+g.col1.x*f.x+g.col2.x*f.y,m=d.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_normal.x=-k,this.m_normal.y=-h,d=0,r=a.m_pointCount;d<r;)n=d++,g=b.R,f=a.m_points[n].m_localPoint,u=b.position.x+g.col1.x*f.x+g.col2.x*f.y,f=b.position.y+g.col1.y*f.x+g.col2.y*
f.y,this.m_points[n].x=u+0.5*(e-(u-l)*k-(f-m)*h-c)*k,this.m_points[n].y=f+0.5*(e-(u-l)*k-(f-m)*h-c)*h}}},__class__:of};var xa=function(){this.m_type=X.UNKNOWN_SHAPE;this.m_radius=v.b2_linearSlop};xa.__name__=["box2D","collision","shapes","B2Shape"];xa.testOverlap=function(a,b,c,d){return!0};xa.prototype={copy:function(){return null},set:function(a){this.m_radius=a.m_radius},getType:function(){return this.m_type},testPoint:function(a,b){return!1},rayCast:function(a,b,c){return!1},computeAABB:function(a,
b){},computeMass:function(a,b){},computeSubmergedArea:function(a,b,c,d){return 0},__class__:xa};var bb=function(a){null==a&&(a=0);xa.call(this);this.m_p=new s;this.m_type=X.CIRCLE_SHAPE;this.m_radius=a};bb.__name__=["box2D","collision","shapes","B2CircleShape"];bb.__super__=xa;bb.prototype=p(xa.prototype,{copy:function(){var a=new bb;a.set(this);return a},set:function(a){xa.prototype.set.call(this,a);y.__instanceof(a,bb)&&(a=y.__cast(a,bb),this.m_p.setV(a.m_p))},testPoint:function(a,b){var c=a.R,
d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y),d=b.x-d,c=b.y-c;return d*d+c*c<=this.m_radius*this.m_radius},rayCast:function(a,b,c){var d=c.R,e=b.p1.x-(c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y));c=b.p1.y-(c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y));var d=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y,g=e*d+c*f,k=d*d+f*f,h=g*g-k*(e*e+c*c-this.m_radius*this.m_radius);if(0>h||k<Number.MIN_VALUE)return!1;g=-(g+Math.sqrt(h));return 0<=
g&&g<=b.maxFraction*k?(g/=k,a.fraction=g,a.normal.x=e+g*d,a.normal.y=c+g*f,a.normal.normalize(),!0):!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.set(d-this.m_radius,c-this.m_radius);a.upperBound.set(d+this.m_radius,c+this.m_radius)},computeMass:function(a,b){a.mass=b*v.b2_pi*this.m_radius*this.m_radius;a.center.setV(this.m_p);a.I=a.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*
this.m_p.x+this.m_p.y*this.m_p.y))},computeSubmergedArea:function(a,b,c,d){c=r.mulX(c,this.m_p);var e=-(r.dot(a,c)-b);if(e<-this.m_radius+Number.MIN_VALUE)return 0;if(e>this.m_radius)return d.setV(c),Math.PI*this.m_radius*this.m_radius;b=this.m_radius*this.m_radius;var f=e*e,e=b*(Math.asin(e/this.m_radius)+Math.PI/2)+e*Math.sqrt(b-f);b=-0.6666666666666666*Math.pow(b-f,1.5)/e;d.x=c.x+a.x*b;d.y=c.y+a.y*b;return e},getLocalPosition:function(){return this.m_p},setLocalPosition:function(a){this.m_p.setV(a)},
getRadius:function(){return this.m_radius},setRadius:function(a){this.m_radius=a},__class__:bb});var yc=function(a,b){xa.call(this);this.s_supportVec=new s;this.m_v1=new s;this.m_v2=new s;this.m_coreV1=new s;this.m_coreV2=new s;this.m_normal=new s;this.m_direction=new s;this.m_cornerDir1=new s;this.m_cornerDir2=new s;this.m_type=X.EDGE_SHAPE;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=a;this.m_v2=b;this.m_direction.set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.normalize();
this.m_normal.set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.set(-v.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-v.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y);this.m_coreV2.set(-v.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-v.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.set(-this.m_normal.x,-this.m_normal.y)};yc.__name__=["box2D","collision","shapes","B2EdgeShape"];yc.__super__=
xa;yc.prototype=p(xa.prototype,{testPoint:function(a,b){return!1},rayCast:function(a,b,c){var d,e=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y;d=c.R;var g=c.position.x+(d.col1.x*this.m_v1.x+d.col2.x*this.m_v1.y),k=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),h=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y)-k;c=-(c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y)-g);d=100*Number.MIN_VALUE;var l=-(e*h+f*c);if(l>d){var g=b.p1.x-g,m=b.p1.y-k,k=g*h+m*c;if(0<=k&&k<=b.maxFraction*l&&(b=-e*m+
f*g,-d*l<=b&&b<=l*(1+d)))return a.fraction=k/l,b=Math.sqrt(h*h+c*c),a.normal.x=h/b,a.normal.y=c/b,!0}return!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_v1.x+c.col2.x*this.m_v1.y),e=b.position.y+(c.col1.y*this.m_v1.x+c.col2.y*this.m_v1.y),f=b.position.x+(c.col1.x*this.m_v2.x+c.col2.x*this.m_v2.y),c=b.position.y+(c.col1.y*this.m_v2.x+c.col2.y*this.m_v2.y);d<f?(a.lowerBound.x=d,a.upperBound.x=f):(a.lowerBound.x=f,a.upperBound.x=d);e<c?(a.lowerBound.y=e,a.upperBound.y=c):(a.lowerBound.y=
c,a.upperBound.y=e)},computeMass:function(a,b){a.mass=0;a.center.setV(this.m_v1);a.I=0},computeSubmergedArea:function(a,b,c,d){var e=new s(a.x*b,a.y*b),f=r.mulX(c,this.m_v1);c=r.mulX(c,this.m_v2);var g=r.dot(a,f)-b;a=r.dot(a,c)-b;if(0<g){if(0<a)return 0;f.x=-a/(g-a)*f.x+g/(g-a)*c.x;f.y=-a/(g-a)*f.y+g/(g-a)*c.y}else 0<a&&(c.x=-a/(g-a)*f.x+g/(g-a)*c.x,c.y=-a/(g-a)*f.y+g/(g-a)*c.y);d.x=(e.x+f.x+c.x)/3;d.y=(e.y+f.y+c.y)/3;return 0.5*((f.x-e.x)*(c.y-e.y)-(f.y-e.y)*(c.x-e.x))},getLength:function(){return this.m_length},
getVertex1:function(){return this.m_v1},getVertex2:function(){return this.m_v2},getCoreVertex1:function(){return this.m_coreV1},getCoreVertex2:function(){return this.m_coreV2},getNormalVector:function(){return this.m_normal},getDirectionVector:function(){return this.m_direction},getCorner1Vector:function(){return this.m_cornerDir1},getCorner2Vector:function(){return this.m_cornerDir2},corner1IsConvex:function(){return this.m_cornerConvex1},corner2IsConvex:function(){return this.m_cornerConvex2},getFirstVertex:function(a){var b=
a.R;return new s(a.position.x+(b.col1.x*this.m_coreV1.x+b.col2.x*this.m_coreV1.y),a.position.y+(b.col1.y*this.m_coreV1.x+b.col2.y*this.m_coreV1.y))},getNextEdge:function(){return this.m_nextEdge},getPrevEdge:function(){return this.m_prevEdge},support:function(a,b,c){var d=a.R,e=a.position.x+(d.col1.x*this.m_coreV1.x+d.col2.x*this.m_coreV1.y),f=a.position.y+(d.col1.y*this.m_coreV1.x+d.col2.y*this.m_coreV1.y),g=a.position.x+(d.col1.x*this.m_coreV2.x+d.col2.x*this.m_coreV2.y);a=a.position.y+(d.col1.y*
this.m_coreV2.x+d.col2.y*this.m_coreV2.y);e*b+f*c>g*b+a*c?(this.s_supportVec.x=e,this.s_supportVec.y=f):(this.s_supportVec.x=g,this.s_supportVec.y=a);return this.s_supportVec},setPrevEdge:function(a,b,c,d){this.m_prevEdge=a;this.m_coreV1=b;this.m_cornerDir1=c;this.m_cornerConvex1=d},setNextEdge:function(a,b,c,d){this.m_nextEdge=a;this.m_coreV2=b;this.m_cornerDir2=c;this.m_cornerConvex2=d},__class__:yc});var Ld=function(){this.mass=0;this.center=new s(0,0);this.I=0};Ld.__name__=["box2D","collision",
"shapes","B2MassData"];Ld.prototype={__class__:Ld};var ka=function(){xa.call(this);this.m_type=X.POLYGON_SHAPE;this.m_centroid=new s;this.m_vertices=[];this.m_normals=[]};ka.__name__=["box2D","collision","shapes","B2PolygonShape"];ka.asArray=function(a,b){var c=new ka;c.setAsArray(a,b);return c};ka.asVector=function(a,b){var c=new ka;c.setAsVector(a,b);return c};ka.asBox=function(a,b){var c=new ka;c.setAsBox(a,b);return c};ka.asOrientedBox=function(a,b,c,d){null==d&&(d=0);var e=new ka;e.setAsOrientedBox(a,
b,c,d);return e};ka.asEdge=function(a,b){var c=new ka;c.setAsEdge(a,b);return c};ka.computeCentroid=function(a,b){for(var c=new s,d=0,e=0;e<b;){var f=e++,g=a[f],f=f+1<b?a[f+1|0]:a[0],k=0.5*((g.x-0)*(f.y-0)-(g.y-0)*(f.x-0)),d=d+k;c.x+=0.3333333333333333*k*(0+g.x+f.x);c.y+=0.3333333333333333*k*(0+g.y+f.y)}c.x*=1/d;c.y*=1/d;return c};ka.computeOBB=function(a,b,c){for(var d=[],e=0;e<c;){var f=e++;d[f]=b[f]}d[c]=d[0];b=Number.MAX_VALUE;e=1;for(f=c+1;e<f;){for(var g=e++,k=d[g-1|0],h=d[g].x-k.x,l=d[g].y-
k.y,g=Math.sqrt(h*h+l*l),h=h/g,l=l/g,m=-l,u=h,r=g=Number.MAX_VALUE,n=-Number.MAX_VALUE,q=-Number.MAX_VALUE,s=0,p=c;s<p;){var t=s++,v=d[t].x-k.x,w=d[t].y-k.y,t=h*v+l*w,v=m*v+u*w;t<g&&(g=t);v<r&&(r=v);t>n&&(n=t);v>q&&(q=v)}s=(n-g)*(q-r);s<0.95*b&&(b=s,a.R.col1.x=h,a.R.col1.y=l,a.R.col2.x=m,a.R.col2.y=u,h=0.5*(g+n),l=0.5*(r+q),m=a.R,a.center.x=k.x+(m.col1.x*h+m.col2.x*l),a.center.y=k.y+(m.col1.y*h+m.col2.y*l),a.extents.x=0.5*(n-g),a.extents.y=0.5*(q-r))}};ka.__super__=xa;ka.prototype=p(xa.prototype,
{copy:function(){var a=new ka;a.set(this);return a},set:function(a){xa.prototype.set.call(this,a);if(y.__instanceof(a,ka)){a=y.__cast(a,ka);this.m_centroid.setV(a.m_centroid);this.m_vertexCount=a.m_vertexCount;this.reserve(this.m_vertexCount);for(var b=0,c=this.m_vertexCount;b<c;){var d=b++;this.m_vertices[d].setV(a.m_vertices[d]);this.m_normals[d].setV(a.m_normals[d])}}},setAsArray:function(a,b){null==b&&(b=0);for(var c=[],d=0;d<a.length;){var e=a[d];++d;c.push(e)}this.setAsVector(c,b)},setAsVector:function(a,
b){null==b&&(b=0);0==b&&(b=a.length);v.b2Assert(2<=b);this.m_vertexCount=b|0;this.reserve(b|0);for(var c=0,d=this.m_vertexCount;c<d;){var e=c++;this.m_vertices[e].setV(a[e])}c=0;for(d=this.m_vertexCount;c<d;){var e=c++,f=r.subtractVV(this.m_vertices[e+1<this.m_vertexCount?e+1:0],this.m_vertices[e]);v.b2Assert(f.lengthSquared()>Number.MIN_VALUE);this.m_normals[e].setV(r.crossVF(f,1));this.m_normals[e].normalize()}this.m_centroid=ka.computeCentroid(this.m_vertices,this.m_vertexCount)},setAsBox:function(a,
b){this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid.setZero()},setAsOrientedBox:function(a,b,c,d){null==d&&(d=0);this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,
-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid=c;a=new pb;a.position=c;a.R.set(d);c=0;for(d=this.m_vertexCount;c<d;)b=c++,this.m_vertices[b]=r.mulX(a,this.m_vertices[b]),this.m_normals[b]=r.mulMV(a.R,this.m_normals[b])},setAsEdge:function(a,b){this.m_vertexCount=2;this.reserve(2);this.m_vertices[0].setV(a);this.m_vertices[1].setV(b);this.m_centroid.x=0.5*(a.x+b.x);this.m_centroid.y=0.5*(a.y+b.y);this.m_normals[0]=r.crossVF(r.subtractVV(b,a),1);
this.m_normals[0].normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y},testPoint:function(a,b){var c;c=a.R;for(var d=b.x-a.position.x,e=b.y-a.position.y,f=d*c.col1.x+e*c.col1.y,g=d*c.col2.x+e*c.col2.y,k=0,h=this.m_vertexCount;k<h;){var l=k++;c=this.m_vertices[l];d=f-c.x;e=g-c.y;c=this.m_normals[l];if(0<c.x*d+c.y*e)return!1}return!0},rayCast:function(a,b,c){var d=0,e=b.maxFraction,f,g,k,h;f=b.p1.x-c.position.x;g=b.p1.y-c.position.y;k=c.R;var l=f*k.col1.x+g*
k.col1.y,m=f*k.col2.x+g*k.col2.y;f=b.p2.x-c.position.x;g=b.p2.y-c.position.y;k=c.R;b=f*k.col1.x+g*k.col1.y-l;k=f*k.col2.x+g*k.col2.y-m;for(var u=-1,r=0,n=this.m_vertexCount;r<n;){var q=r++;h=this.m_vertices[q];f=h.x-l;g=h.y-m;h=this.m_normals[q];f=h.x*f+h.y*g;g=h.x*b+h.y*k;if(0==g){if(0>f)return!1}else 0>g&&f<d*g?(d=f/g,u=q):0<g&&f<e*g&&(e=f/g);if(e<d-Number.MIN_VALUE)return!1}return 0<=u?(a.fraction=d,k=c.R,h=this.m_normals[u],a.normal.x=k.col1.x*h.x+k.col2.x*h.y,a.normal.y=k.col1.y*h.x+k.col2.y*
h.y,!0):!1},computeAABB:function(a,b){for(var c=b.R,d=this.m_vertices[0],e=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),f=b.position.y+(c.col1.y*d.x+c.col2.y*d.y),g=e,k=f,h=1,l=this.m_vertexCount;h<l;){var m=h++,d=this.m_vertices[m],m=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),d=b.position.y+(c.col1.y*d.x+c.col2.y*d.y);e<m||(e=m);f<d||(f=d);g>m||(g=m);k>d||(k=d)}a.lowerBound.x=e-this.m_radius;a.lowerBound.y=f-this.m_radius;a.upperBound.x=g+this.m_radius;a.upperBound.y=k+this.m_radius},computeMass:function(a,
b){if(2==this.m_vertexCount)a.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=0.5*(this.m_vertices[0].y+this.m_vertices[1].y),a.mass=0,a.I=0;else{for(var c=0,d=0,e=0,f=0,g=0,k=this.m_vertexCount;g<k;)var h=g++,l=this.m_vertices[h],m=h+1<this.m_vertexCount?this.m_vertices[h+1|0]:this.m_vertices[0],u=l.x-0,r=l.y-0,n=m.x-0,q=m.y-0,h=u*q-r*n,s=0.5*h,e=e+s,c=c+0.3333333333333333*s*(0+l.x+m.x),d=d+0.3333333333333333*s*(0+l.y+m.y),l=u,f=f+h*(0.3333333333333333*(0.25*(l*l+n*l+n*n)+(0*
l+0*n))+0+(0.3333333333333333*(0.25*(r*r+q*r+q*q)+(0*r+0*q))+0));a.mass=b*e;a.center.set(c*(1/e),d*(1/e));a.I=b*f}},computeSubmergedArea:function(a,b,c,d){var e=r.mulTMV(c.R,a),f=b-r.dot(a,c.position),g=[],k=0;a=b=-1;for(var h=!1,l=0,m=this.m_vertexCount;l<m;){var u=l++;g[u]=r.dot(e,this.m_vertices[u])-f;var n=g[u]<-Number.MIN_VALUE;0<u&&(n?h||(b=u-1,++k):h&&(a=u-1,++k));h=n}switch(k){case 0:return h?(a=new Ld,this.computeMass(a,1),d.setV(r.mulX(c,a.center)),a.mass):0;case 1:-1==b?b=this.m_vertexCount-
1:a=this.m_vertexCount-1}f=(b+1)%this.m_vertexCount;e=(a+1)%this.m_vertexCount;k=(0-g[b])/(g[f]-g[b]);g=(0-g[a])/(g[e]-g[a]);b=new s(this.m_vertices[b].x*(1-k)+this.m_vertices[f].x*k,this.m_vertices[b].y*(1-k)+this.m_vertices[f].y*k);a=new s(this.m_vertices[a].x*(1-g)+this.m_vertices[e].x*g,this.m_vertices[a].y*(1-g)+this.m_vertices[e].y*g);g=0;k=new s;for(h=this.m_vertices[f];f!=e;)f=(f+1)%this.m_vertexCount,l=f==e?a:this.m_vertices[f],m=0.5*((h.x-b.x)*(l.y-b.y)-(h.y-b.y)*(l.x-b.x)),g+=m,k.x+=m*
(b.x+h.x+l.x)/3,k.y+=m*(b.y+h.y+l.y)/3,h=l;k.multiply(1/g);d.setV(r.mulX(c,k));return g},getVertexCount:function(){return this.m_vertexCount},getVertices:function(){return this.m_vertices},getNormals:function(){return this.m_normals},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*
a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},validate:function(){return!1},reserve:function(a){for(var b=this.m_vertices.length;b<a;){var c=b++;this.m_vertices[c]=new s;this.m_normals[c]=new s}},__class__:ka});var X={__ename__:!0,__constructs__:["UNKNOWN_SHAPE","CIRCLE_SHAPE","POLYGON_SHAPE","EDGE_SHAPE"],UNKNOWN_SHAPE:["UNKNOWN_SHAPE",0]};X.UNKNOWN_SHAPE.__enum__=X;X.CIRCLE_SHAPE=
["CIRCLE_SHAPE",1];X.CIRCLE_SHAPE.__enum__=X;X.POLYGON_SHAPE=["POLYGON_SHAPE",2];X.POLYGON_SHAPE.__enum__=X;X.EDGE_SHAPE=["EDGE_SHAPE",3];X.EDGE_SHAPE.__enum__=X;X.__empty_constructs__=[X.UNKNOWN_SHAPE,X.CIRCLE_SHAPE,X.POLYGON_SHAPE,X.EDGE_SHAPE];var Md=function(a,b,c){this._r=255*r.clamp(a,0,1)|0;this._g=255*r.clamp(b,0,1)|0;this._b=255*r.clamp(c,0,1)|0};Md.__name__=["box2D","common","B2Color"];Md.prototype={set:function(a,b,c){this._r=255*r.clamp(a,0,1)|0;this._g=255*r.clamp(b,0,1)|0;this._b=255*
r.clamp(c,0,1)|0},toHex:function(){return"#"+this.componentToHex(this._r)+this.componentToHex(this._g)+this.componentToHex(this._b)},componentToHex:function(a){a=a.toString(16);return"1"==a.length?"0"+a:a},set_r:function(a){return this._r=255*r.clamp(a,0,1)|0},set_g:function(a){return this._g=255*r.clamp(a,0,1)|0},set_b:function(a){return this._b=255*r.clamp(a,0,1)|0},get_r:function(){return this._r},get_g:function(){return this._g},get_b:function(){return this._b},get_color:function(){return this._r<<
16|this._g<<8|this._b},__class__:Md,__properties__:{get_color:"get_color",set_b:"set_b",set_g:"set_g",set_r:"set_r"}};var v=function(){};v.__name__=["box2D","common","B2Settings"];v.b2MixFriction=function(a,b){return Math.sqrt(a*b)};v.b2MixRestitution=function(a,b){return a>b?a:b};v.b2Assert=function(a){if(!a)throw new K("Assertion Failed");};var bc=function(a,b,c){this.col1=new Ka;this.col2=new Ka;this.col3=new Ka;null==a&&null==b&&null==c?(this.col1.setZero(),this.col2.setZero(),this.col3.setZero()):
(this.col1.setV(a),this.col2.setV(b),this.col3.setV(c))};bc.__name__=["box2D","common","math","B2Mat33"];bc.prototype={setVVV:function(a,b,c){this.col1.setV(a);this.col2.setV(b);this.col3.setV(c)},copy:function(){return new bc(this.col1,this.col2,this.col3)},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2);this.col3.setV(a.col3)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col1.z+=a.col1.z;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y;this.col2.z+=a.col2.z;this.col3.x+=
a.col3.x;this.col3.y+=a.col3.y;this.col3.z+=a.col3.z},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0},solve22:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},solve33:function(a,
b,c,d){var e=this.col1.x,f=this.col1.y,g=this.col1.z,k=this.col2.x,h=this.col2.y,l=this.col2.z,m=this.col3.x,u=this.col3.y,r=this.col3.z,n=e*(h*r-l*u)+f*(l*m-k*r)+g*(k*u-h*m);0!=n&&(n=1/n);a.x=n*(b*(h*r-l*u)+c*(l*m-k*r)+d*(k*u-h*m));a.y=n*(e*(c*r-d*u)+f*(d*m-b*r)+g*(b*u-c*m));a.z=n*(e*(h*d-l*c)+f*(l*b-k*d)+g*(k*c-h*b));return a},__class__:bc};var r=function(){};r.__name__=["box2D","common","math","B2Math"];r.__properties__={get_MAX_VALUE:"get_MAX_VALUE",get_MIN_VALUE:"get_MIN_VALUE"};r.isValid=function(a){return isNaN(a)||
-Infinity==a||Infinity==a?!1:!0};r.dot=function(a,b){return a.x*b.x+a.y*b.y};r.crossVV=function(a,b){return a.x*b.y-a.y*b.x};r.crossVF=function(a,b){return new s(b*a.y,-b*a.x)};r.crossFV=function(a,b){return new s(-a*b.y,a*b.x)};r.mulMV=function(a,b){return new s(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y)};r.mulTMV=function(a,b){return new s(r.dot(b,a.col1),r.dot(b,a.col2))};r.mulX=function(a,b){var c=r.mulMV(a.R,b);c.x+=a.position.x;c.y+=a.position.y;return c};r.mulXT=function(a,b){var c=
r.subtractVV(b,a.position),d=c.x*a.R.col1.x+c.y*a.R.col1.y;c.y=c.x*a.R.col2.x+c.y*a.R.col2.y;c.x=d;return c};r.addVV=function(a,b){return new s(a.x+b.x,a.y+b.y)};r.subtractVV=function(a,b){return new s(a.x-b.x,a.y-b.y)};r.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};r.distanceSquared=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};r.mulFV=function(a,b){return new s(a*b.x,a*b.y)};r.addMM=function(a,b){return da.fromVV(r.addVV(a.col1,b.col1),r.addVV(a.col2,b.col2))};
r.mulMM=function(a,b){return da.fromVV(r.mulMV(a,b.col1),r.mulMV(a,b.col2))};r.mulTMM=function(a,b){var c=new s(r.dot(a.col1,b.col1),r.dot(a.col2,b.col1)),d=new s(r.dot(a.col1,b.col2),r.dot(a.col2,b.col2));return da.fromVV(c,d)};r.abs=function(a){return 0<a?a:-a};r.absV=function(a){return new s(r.abs(a.x),r.abs(a.y))};r.absM=function(a){return da.fromVV(r.absV(a.col1),r.absV(a.col2))};r.min=function(a,b){return a<b?a:b};r.minV=function(a,b){return new s(r.min(a.x,b.x),r.min(a.y,b.y))};r.max=function(a,
b){return a>b?a:b};r.maxV=function(a,b){return new s(r.max(a.x,b.x),r.max(a.y,b.y))};r.clamp=function(a,b,c){return a<b?b:a>c?c:a};r.clampV=function(a,b,c){return r.maxV(b,r.minV(a,c))};r.swap=function(a,b){var c=a[0];a[0]=b[0];b[0]=c};r.random=function(){return 2*Math.random()-1};r.randomRange=function(a,b){var c=Math.random();return(b-a)*c+a};r.nextPowerOfTwo=function(a){a|=a>>1&2147483647;a|=a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};r.isPowerOfTwo=function(a){return 0<
a&&0==(a&a-1)};r.get_MIN_VALUE=function(){return Number.MIN_VALUE};r.get_MAX_VALUE=function(){return Number.MAX_VALUE};var Mb=function(){this.localCenter=new s;this.c0=new s;this.c=new s};Mb.__name__=["box2D","common","math","B2Sweep"];Mb.prototype={set:function(a){this.localCenter.setV(a.localCenter);this.c0.setV(a.c0);this.c.setV(a.c);this.a0=a.a0;this.a=a.a;this.t0=a.t0},copy:function(){var a=new Mb;a.localCenter.setV(this.localCenter);a.c0.setV(this.c0);a.c.setV(this.c);a.a0=this.a0;a.a=this.a;
a.t0=this.t0;return a},getTransform:function(a,b){a.position.x=(1-b)*this.c0.x+b*this.c.x;a.position.y=(1-b)*this.c0.y+b*this.c.y;a.R.set((1-b)*this.a0+b*this.a);var c=a.R;a.position.x-=c.col1.x*this.localCenter.x+c.col2.x*this.localCenter.y;a.position.y-=c.col1.y*this.localCenter.x+c.col2.y*this.localCenter.y},advance:function(a){if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x;this.c0.y=(1-b)*this.c0.y+b*this.c.y;this.a0=(1-b)*this.a0+
b*this.a;this.t0=a}},__class__:Mb};var Ka=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};Ka.__name__=["box2D","common","math","B2Vec3"];Ka.prototype={setZero:function(){this.x=this.y=this.z=0},set:function(a,b,c){this.x=a;this.y=b;this.z=c},setV:function(a){this.x=a.x;this.y=a.y;this.z=a.z},getNegative:function(){return new Ka(-this.x,-this.y,-this.z)},negativeSelf:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z},copy:function(){return new Ka(this.x,
this.y,this.z)},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z},multiply:function(a){this.x*=a;this.y*=a;this.z*=a},__class__:Ka};var z=function(a,b){this.m_xf=new pb;this.m_sweep=new Mb;this.m_linearVelocity=new s;this.m_force=new s;this.m_flags=0;a.bullet&&(this.m_flags|=z.e_bulletFlag);a.fixedRotation&&(this.m_flags|=z.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=z.e_allowSleepFlag);a.awake&&(this.m_flags|=z.e_awakeFlag);a.active&&
(this.m_flags|=z.e_activeFlag);this.m_world=b;this.m_xf.position.setV(a.position);this.m_xf.R.set(a.angle);this.m_sweep.localCenter.setZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=
null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.setV(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;this.m_angularDamping=a.angularDamping;this.m_force.set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=this.m_type==z.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_inertiaScale=a.inertiaScale;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0};z.__name__=
["box2D","dynamics","B2Body"];z.prototype={connectEdges:function(a,b,c){var d=Math.atan2(b.getDirectionVector().y,b.getDirectionVector().x);c=Math.tan(0.5*(d-c));c=r.mulFV(c,b.getDirectionVector());c=r.subtractVV(c,b.getNormalVector());c=r.mulFV(v.b2_toiSlop,c);c=r.addVV(c,b.getVertex1());var e=r.addVV(a.getDirectionVector(),b.getDirectionVector());e.normalize();var f=0<r.dot(a.getDirectionVector(),b.getNormalVector());a.setNextEdge(b,c,e,f);b.setPrevEdge(a,c,e,f);return d},createFixture:function(a){if(!0==
this.m_world.isLocked())return null;var b=new Bb;b.create(this,this.m_xf,a);0!=(this.m_flags&z.e_activeFlag)&&b.createProxy(this.m_world.m_contactManager.m_broadPhase,this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;0<b.m_density&&this.resetMassData();this.m_world.m_flags|=Z.e_newFixture;return b},createFixture2:function(a,b){null==b&&(b=0);var c=new pf;c.shape=a;c.density=b;return this.createFixture(c)},DestroyFixture:function(a){if(!0!=this.m_world.isLocked()){for(var b=
this.m_fixtureList,c=null;null!=b;){if(b==a){null!=c?c.m_next=a.m_next:this.m_fixtureList=a.m_next;break}c=b;b=b.m_next}for(b=this.m_contactList;null!=b;){var c=b.contact,b=b.next,d=c.getFixtureA(),e=c.getFixtureB();a!=d&&a!=e||this.m_world.m_contactManager.destroy(c)}0!=(this.m_flags&z.e_activeFlag)&&a.destroyProxy(this.m_world.m_contactManager.m_broadPhase);a.destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.resetMassData()}},setPositionAndAngle:function(a,b){var c;if(!0!=this.m_world.isLocked()){this.m_xf.R.set(b);
this.m_xf.position.setV(a);c=this.m_xf.R;var d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=b;d=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;null!=c;)c.synchronize(d,this.m_xf,this.m_xf),c=c.m_next;this.m_world.m_contactManager.findNewContacts()}},setTransform:function(a){this.setPositionAndAngle(a.position,
a.getAngle())},getTransform:function(){return this.m_xf},getPosition:function(){return this.m_xf.position},setPosition:function(a){this.setPositionAndAngle(a,this.getAngle())},getAngle:function(){return this.m_sweep.a},setAngle:function(a){this.setPositionAndAngle(this.getPosition(),a)},getWorldCenter:function(){return this.m_sweep.c},getLocalCenter:function(){return this.m_sweep.localCenter},setLinearVelocity:function(a){this.m_type!=z.b2_staticBody&&this.m_linearVelocity.setV(a)},getLinearVelocity:function(){return this.m_linearVelocity},
setAngularVelocity:function(a){this.m_type!=z.b2_staticBody&&(this.m_angularVelocity=a)},getAngularVelocity:function(){return this.m_angularVelocity},getDefinition:function(){var a=new Nd;a.type=this.getType();a.allowSleep=(this.m_flags&z.e_allowSleepFlag)==z.e_allowSleepFlag;a.angle=this.getAngle();a.angularDamping=this.m_angularDamping;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&z.e_fixedRotationFlag)==z.e_fixedRotationFlag;a.bullet=(this.m_flags&z.e_bulletFlag)==z.e_bulletFlag;
a.awake=(this.m_flags&z.e_awakeFlag)==z.e_awakeFlag;a.linearDamping=this.m_linearDamping;a.linearVelocity.setV(this.getLinearVelocity());a.position=this.getPosition();a.userData=this.getUserData();return a},applyForce:function(a,b){this.m_type==z.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)},applyTorque:function(a){this.m_type==z.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),
this.m_torque+=a)},applyImpulse:function(a,b){this.m_type==z.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))},split:function(a){for(var b=this.getLinearVelocity().copy(),c=this.getAngularVelocity(),d=this.getWorldCenter(),e=this.m_world.createBody(this.getDefinition()),f=null,g=this.m_fixtureList;null!=g;)if(a(g)){var k=
g.m_next;null!=f?f.m_next=k:this.m_fixtureList=k;this.m_fixtureCount--;g.m_next=e.m_fixtureList;e.m_fixtureList=g;e.m_fixtureCount++;g.m_body=e;g=k}else f=g,g=g.m_next;this.resetMassData();e.resetMassData();f=this.getWorldCenter();a=e.getWorldCenter();f=r.addVV(b,r.crossFV(c,r.subtractVV(f,d)));b=r.addVV(b,r.crossFV(c,r.subtractVV(a,d)));this.setLinearVelocity(f);e.setLinearVelocity(b);this.setAngularVelocity(c);e.setAngularVelocity(c);this.synchronizeFixtures();e.synchronizeFixtures();return e},
merge:function(a){for(var b=a.m_fixtureList;null!=b;){var c=b.m_next;a.m_fixtureCount--;b.m_next=this.m_fixtureList;this.m_fixtureList=b;this.m_fixtureCount++;b.m_body=a;b=c}this.m_fixtureCount=0;this.getWorldCenter();a.getWorldCenter();this.getLinearVelocity().copy();a.getLinearVelocity().copy();this.getAngularVelocity();a.getAngularVelocity();this.resetMassData();this.synchronizeFixtures()},getMass:function(){return this.m_mass},getInertia:function(){return this.m_I},getMassData:function(a){a.mass=
this.m_mass;a.I=this.m_I;a.center.setV(this.m_sweep.localCenter)},setMassData:function(a){v.b2Assert(!1==this.m_world.isLocked());if(!0!=this.m_world.isLocked()&&this.m_type==z.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<a.I&&0==(this.m_flags&z.e_fixedRotationFlag)&&(this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a.center);
this.m_sweep.c0.setV(r.mulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.setV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},resetMassData:function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.setZero();if(this.m_type!=z.b2_staticBody&&this.m_type!=z.b2_kinematicBody){for(var a=s.make(0,0),b=this.m_fixtureList;null!=b;)if(0!=b.m_density){var c=b.getMassData();
this.m_mass+=c.mass;a.x+=c.center.x*c.mass;a.y+=c.center.y*c.mass;this.m_I+=c.I;b=b.m_next}0<this.m_mass?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0==(this.m_flags&z.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,v.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a);this.m_sweep.c0.setV(r.mulX(this.m_xf,this.m_sweep.localCenter));
this.m_sweep.c.setV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},getWorldPoint:function(a){var b=this.m_xf.R;a=new s(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return a},getWorldVector:function(a){return r.mulMV(this.m_xf.R,a)},getLocalPoint:function(a){return r.mulXT(this.m_xf,a)},getLocalVector:function(a){return r.mulTMV(this.m_xf.R,
a)},getLinearVelocityFromWorldPoint:function(a){return new s(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},getLinearVelocityFromLocalPoint:function(a){var b=this.m_xf.R;a=new s(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return new s(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*
(a.x-this.m_sweep.c.x))},getLinearDamping:function(){return this.m_linearDamping},setLinearDamping:function(a){this.m_linearDamping=a},getAngularDamping:function(){return this.m_angularDamping},setAngularDamping:function(a){this.m_angularDamping=a},setType:function(a){if(this.m_type!=a)for(this.m_type=a,this.resetMassData(),this.m_type==z.b2_staticBody&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0,a=this.m_contactList;null!=a;)a.contact.flagForFiltering(),
a=a.next},getType:function(){return this.m_type},setBullet:function(a){this.m_flags=a?this.m_flags|z.e_bulletFlag:this.m_flags&~z.e_bulletFlag},isBullet:function(){return(this.m_flags&z.e_bulletFlag)==z.e_bulletFlag},setSleepingAllowed:function(a){a?this.m_flags|=z.e_allowSleepFlag:(this.m_flags&=~z.e_allowSleepFlag,this.setAwake(!0))},setAwake:function(a){a?(this.m_flags|=z.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~z.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=
0,this.m_force.setZero(),this.m_torque=0)},isAwake:function(){return(this.m_flags&z.e_awakeFlag)==z.e_awakeFlag},setFixedRotation:function(a){this.m_flags=a?this.m_flags|z.e_fixedRotationFlag:this.m_flags&~z.e_fixedRotationFlag;this.resetMassData()},isFixedRotation:function(){return(this.m_flags&z.e_fixedRotationFlag)==z.e_fixedRotationFlag},setActive:function(a){if(a!=this.isActive()){var b;if(a)for(this.m_flags|=z.e_activeFlag,a=this.m_world.m_contactManager.m_broadPhase,b=this.m_fixtureList;null!=
b;)b.createProxy(a,this.m_xf),b=b.m_next;else{this.m_flags&=~z.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=b;)b.destroyProxy(a),b=b.m_next;for(a=this.m_contactList;null!=a;)b=a,a=a.next,this.m_world.m_contactManager.destroy(b.contact);this.m_contactList=null}}},isActive:function(){return(this.m_flags&z.e_activeFlag)==z.e_activeFlag},isSleepingAllowed:function(){return(this.m_flags&z.e_allowSleepFlag)==z.e_allowSleepFlag},getFixtureList:function(){return this.m_fixtureList},
getJointList:function(){return this.m_jointList},getControllerList:function(){return this.m_controllerList},getContactList:function(){return this.m_contactList},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=a},getWorld:function(){return this.m_world},synchronizeFixtures:function(){var a=z.s_xf1;a.R.set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y);a.position.y=
this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);c=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=b;)b.synchronize(c,a,this.m_xf),b=b.m_next},synchronizeTransform:function(){this.m_xf.R.set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y);this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)},shouldCollide:function(a){if(this.m_type!=z.b2_dynamicBody&&a.m_type!=z.b2_dynamicBody)return!1;
for(var b=this.m_jointList;null!=b;){if(b.other==a&&!1==b.joint.m_collideConnected)return!1;b=b.next}return!0},advance:function(a){this.m_sweep.advance(a);this.m_sweep.c.setV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.synchronizeTransform()},__class__:z};var Nd=function(){this.position=new s;this.linearVelocity=new s;this.userData=null;this.angularDamping=this.linearDamping=this.angularVelocity=this.angle=0;this.awake=this.allowSleep=!0;this.bullet=this.fixedRotation=!1;this.type=z.b2_staticBody;
this.active=!0;this.inertiaScale=1};Nd.__name__=["box2D","dynamics","B2BodyDef"];Nd.prototype={__class__:Nd};var Wc=function(){};Wc.__name__=["box2D","dynamics","B2ContactFilter"];Wc.prototype={shouldCollide:function(a,b){var c=a.getFilterData(),d=b.getFilterData();return c.groupIndex==d.groupIndex&&0!=c.groupIndex?0<c.groupIndex:0!=(c.maskBits&d.categoryBits)&&0!=(c.categoryBits&d.maskBits)},rayCollide:function(a,b){return null==a?!0:this.shouldCollide(y.__cast(a,Bb),b)},__class__:Wc};var qf=function(){this.normalImpulses=
[];this.tangentImpulses=[]};qf.__name__=["box2D","dynamics","B2ContactImpulse"];qf.prototype={__class__:qf};var fb=function(){};fb.__name__=["box2D","dynamics","B2ContactListener"];fb.prototype={beginContact:function(a){},endContact:function(a){},preSolve:function(a,b){},postSolve:function(a,b){},__class__:fb};var Od=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=Wc.b2_defaultFilter;this.m_contactListener=fb.b2_defaultListener;this.m_contactFactory=new rf(this.m_allocator);
this.m_broadPhase=new Kd};Od.__name__=["box2D","dynamics","B2ContactManager"];Od.prototype={addPair:function(a,b){var c=y.__cast(a,Bb),d=y.__cast(b,Bb),e=c.getBody(),f=d.getBody();if(e!=f){for(var g=f.getContactList();null!=g;){if(g.other==e){var k=g.contact.getFixtureA(),h=g.contact.getFixtureB();if(k==c&&h==d||k==d&&h==c)return}g=g.next}!1!=f.shouldCollide(e)&&!1!=this.m_contactFilter.shouldCollide(c,d)&&(g=this.m_contactFactory.create(c,d),c=g.getFixtureA(),d=g.getFixtureB(),e=c.m_body,f=d.m_body,
g.m_prev=null,g.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=g),this.m_world.m_contactList=g,g.m_nodeA.contact=g,g.m_nodeA.other=f,g.m_nodeA.prev=null,g.m_nodeA.next=e.m_contactList,null!=e.m_contactList&&(e.m_contactList.prev=g.m_nodeA),e.m_contactList=g.m_nodeA,g.m_nodeB.contact=g,g.m_nodeB.other=e,g.m_nodeB.prev=null,g.m_nodeB.next=f.m_contactList,null!=f.m_contactList&&(f.m_contactList.prev=g.m_nodeB),f.m_contactList=g.m_nodeB,++this.m_world.m_contactCount)}},
findNewContacts:function(){this.m_broadPhase.updatePairs(w(this,this.addPair))},destroy:function(a){var b=a.getFixtureA(),c=a.getFixtureB(),b=b.getBody(),c=c.getBody();a.isTouching()&&this.m_contactListener.endContact(a);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next);null!=a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);null!=a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA==
b.m_contactList&&(b.m_contactList=a.m_nodeA.next);null!=a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next);null!=a.m_nodeB.next&&(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB==c.m_contactList&&(c.m_contactList=a.m_nodeB.next);this.m_contactFactory.destroy(a);--this.m_contactCount},collide:function(){for(var a=this.m_world.m_contactList;null!=a;){var b=a.getFixtureA(),c=a.getFixtureB(),d=b.getBody(),e=c.getBody();if(!1==d.isAwake()&&!1==e.isAwake())a=a.getNext();else{if(0!=(a.m_flags&B.e_filterFlag)){if(!1==
e.shouldCollide(d)){b=a;a=b.getNext();this.destroy(b);continue}if(!1==this.m_contactFilter.shouldCollide(b,c)){b=a;a=b.getNext();this.destroy(b);continue}a.m_flags&=~B.e_filterFlag}!1==this.m_broadPhase.testOverlap(b.m_proxy,c.m_proxy)?(b=a,a=b.getNext(),this.destroy(b)):(a.update(this.m_contactListener),a=a.getNext())}}},__class__:Od};var za=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;this.m_drawFlags=0};za.__name__=["box2D","dynamics","B2DebugDraw"];
za.prototype={setFlags:function(a){this.m_drawFlags=a},getFlags:function(){return this.m_drawFlags},appendFlags:function(a){this.m_drawFlags|=a},clearFlags:function(a){this.m_drawFlags&=~a},setSprite:function(a){this.m_sprite=a},getSprite:function(){return this.m_sprite},setDrawScale:function(a){this.m_drawScale=a},getDrawScale:function(){return this.m_drawScale},setLineThickness:function(a){this.m_lineThickness=a},getLineThickness:function(){return this.m_lineThickness},setAlpha:function(a){this.m_alpha=
a},getAlpha:function(){return this.m_alpha},setFillAlpha:function(a){this.m_fillAlpha=a},getFillAlpha:function(){return this.m_fillAlpha},setXFormScale:function(a){this.m_xformScale=a},getXFormScale:function(){return this.m_xformScale},drawPolygon:function(a,b,c){console.log("drawPolygon()");this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);
for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);this.m_sprite.stroke()},drawSolidPolygon:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);c="rgba("+c.get_r()+","+c.get_g()+","+c.get_b()+","+this.m_fillAlpha;
this.m_sprite.fillStyle=c+")";for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);this.m_sprite.stroke();this.m_sprite.fill()},drawCircle:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,
!1);this.m_sprite.stroke()},drawSolidCircle:function(a,b,c,d){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=d.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();c="rgba("+d.get_r()+","+d.get_g()+","+d.get_b()+","+this.m_fillAlpha;this.m_sprite.fillStyle=c+")";this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,!1);this.m_sprite.stroke();this.m_sprite.fill()},drawSegment:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;
this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.x*this.m_drawScale,a.y*this.m_drawScale);this.m_sprite.lineTo(b.x*this.m_drawScale,b.y*this.m_drawScale);this.m_sprite.stroke()},drawTransform:function(a){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle="#FF0000";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);
this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col1.y)*this.m_drawScale);this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle="#00FF00";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col2.y)*this.m_drawScale);this.m_sprite.stroke()},
__class__:za};var Xc=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};Xc.__name__=["box2D","dynamics","B2FilterData"];Xc.prototype={copy:function(){var a=new Xc;a.categoryBits=this.categoryBits;a.maskBits=this.maskBits;a.groupIndex=this.groupIndex;return a},__class__:Xc};var Bb=function(){this.m_filter=new Xc;this.m_aabb=new $a;this.m_shape=this.m_next=this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};Bb.__name__=["box2D","dynamics","B2Fixture"];
Bb.prototype={getType:function(){return this.m_shape.getType()},getShape:function(){return this.m_shape},setSensor:function(a){if(this.m_isSensor!=a&&(this.m_isSensor=a,null!=this.m_body))for(a=this.m_body.getContactList();null!=a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.setSensor(c.isSensor()||d.isSensor());a=a.next}},isSensor:function(){return this.m_isSensor},setFilterData:function(a){this.m_filter=a.copy();if(null==this.m_body)for(a=this.m_body.getContactList();null!=
a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.flagForFiltering();a=a.next}},getFilterData:function(){return this.m_filter.copy()},getBody:function(){return this.m_body},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},SetUserData:function(a){this.m_userData=a},testPoint:function(a){return this.m_shape.testPoint(this.m_body.getTransform(),a)},rayCast:function(a,b){return this.m_shape.rayCast(a,b,this.m_body.getTransform())},getMassData:function(a){null==
a&&(a=new Ld);this.m_shape.computeMass(a,this.m_density);return a},setDensity:function(a){this.m_density=a},getDensity:function(){return this.m_density},getFriction:function(){return this.m_friction},setFriction:function(a){this.m_friction=a},getRestitution:function(){return this.m_restitution},setRestitution:function(a){this.m_restitution=a},getAABB:function(){return this.m_aabb},create:function(a,b,c){this.m_userData=c.userData;this.m_friction=c.friction;this.m_restitution=c.restitution;this.m_body=
a;this.m_next=null;this.m_filter=c.filter.copy();this.m_isSensor=c.isSensor;this.m_shape=c.shape.copy();this.m_density=c.density},destroy:function(){this.m_shape=null},createProxy:function(a,b){this.m_shape.computeAABB(this.m_aabb,b);this.m_proxy=a.createProxy(this.m_aabb,this)},destroyProxy:function(a){null!=this.m_proxy&&(a.destroyProxy(this.m_proxy),this.m_proxy=null)},synchronize:function(a,b,c){if(null!=this.m_proxy){var d=new $a,e=new $a;this.m_shape.computeAABB(d,b);this.m_shape.computeAABB(e,
c);this.m_aabb.combine(d,e);b=r.subtractVV(c.position,b.position);a.moveProxy(this.m_proxy,this.m_aabb,b)}},__class__:Bb};var pf=function(){this.filter=new Xc;this.userData=this.shape=null;this.friction=0.2;this.density=this.restitution=0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=!1};pf.__name__=["box2D","dynamics","B2FixtureDef"];pf.prototype={__class__:pf};var cc=function(){this.m_bodies=[];this.m_contacts=[];this.m_joints=[]};cc.__name__=["box2D",
"dynamics","B2Island"];cc.prototype={initialize:function(a,b,c,d,e,f){this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=c;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=d;this.m_listener=e;this.m_contactSolver=f;for(d=this.m_bodies.length;d<a;)e=d++,this.m_bodies[e]=null;for(a=this.m_contacts.length;a<b;)d=a++,this.m_contacts[d]=null;for(b=this.m_joints.length;b<c;)a=b++,this.m_joints[a]=null},clear:function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=
0},solve:function(a,b,c){for(var d,e=0,f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()==z.b2_dynamicBody&&(d.m_linearVelocity.x+=a.dt*(b.x+d.m_invMass*d.m_force.x),d.m_linearVelocity.y+=a.dt*(b.y+d.m_invMass*d.m_force.y),d.m_angularVelocity+=a.dt*d.m_invI*d.m_torque,d.m_linearVelocity.multiply(r.clamp(1-a.dt*d.m_linearDamping,0,1)),d.m_angularVelocity*=r.clamp(1-a.dt*d.m_angularDamping,0,1));this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);b=this.m_contactSolver;
b.initVelocityConstraints(a);e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.initVelocityConstraints(a);e=0;for(f=a.velocityIterations;e<f;){e++;for(var g=0,k=this.m_jointCount;g<k;)d=g++,d=this.m_joints[d],d.solveVelocityConstraints(a);b.solveVelocityConstraints()}e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.finalizeVelocityConstraints();b.finalizeVelocityConstraints();e=0;for(f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()!=z.b2_staticBody&&(g=a.dt*d.m_linearVelocity.x,
k=a.dt*d.m_linearVelocity.y,g*g+k*k>v.b2_maxTranslationSquared&&(d.m_linearVelocity.normalize(),d.m_linearVelocity.x*=v.b2_maxTranslation*a.inv_dt,d.m_linearVelocity.y*=v.b2_maxTranslation*a.inv_dt),g=a.dt*d.m_angularVelocity,g*g>v.b2_maxRotationSquared&&(d.m_angularVelocity=0>d.m_angularVelocity?-v.b2_maxRotation*a.inv_dt:v.b2_maxRotation*a.inv_dt),d.m_sweep.c0.setV(d.m_sweep.c),d.m_sweep.a0=d.m_sweep.a,d.m_sweep.c.x+=a.dt*d.m_linearVelocity.x,d.m_sweep.c.y+=a.dt*d.m_linearVelocity.y,d.m_sweep.a+=
a.dt*d.m_angularVelocity,d.synchronizeTransform());e=0;for(f=a.positionIterations;e<f;){e++;for(var g=b.solvePositionConstraints(v.b2_contactBaumgarte),k=!0,h=0,l=this.m_jointCount;h<l;)d=h++,d=this.m_joints[d],d=d.solvePositionConstraints(v.b2_contactBaumgarte),k=k?d:!1;if(g&&k)break}this.report(b.m_constraints);if(c){c=Number.MAX_VALUE;b=v.b2_linearSleepTolerance*v.b2_linearSleepTolerance;e=v.b2_angularSleepTolerance*v.b2_angularSleepTolerance;f=0;for(g=this.m_bodyCount;f<g;)d=f++,d=this.m_bodies[d],
d.getType()!=z.b2_staticBody&&(0==(d.m_flags&z.e_allowSleepFlag)&&(c=d.m_sleepTime=0),0==(d.m_flags&z.e_allowSleepFlag)||d.m_angularVelocity*d.m_angularVelocity>e||r.dot(d.m_linearVelocity,d.m_linearVelocity)>b?c=d.m_sleepTime=0:(d.m_sleepTime+=a.dt,c=r.min(c,d.m_sleepTime)));if(c>=v.b2_timeToSleep)for(a=0,c=this.m_bodyCount;a<c;)b=a++,d=this.m_bodies[b],d.setAwake(!1)}},solveTOI:function(a){this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);for(var b=this.m_contactSolver,
c=0,d=this.m_jointCount;c<d;){var e=c++;this.m_joints[e].initVelocityConstraints(a)}c=0;for(d=a.velocityIterations;c<d;){c++;b.solveVelocityConstraints();for(var e=0,f=this.m_jointCount;e<f;){var g=e++;this.m_joints[g].solveVelocityConstraints(a)}}c=0;for(d=this.m_bodyCount;c<d;)e=c++,e=this.m_bodies[e],e.getType()!=z.b2_staticBody&&(f=a.dt*e.m_linearVelocity.x,g=a.dt*e.m_linearVelocity.y,f*f+g*g>v.b2_maxTranslationSquared&&(e.m_linearVelocity.normalize(),e.m_linearVelocity.x*=v.b2_maxTranslation*
a.inv_dt,e.m_linearVelocity.y*=v.b2_maxTranslation*a.inv_dt),f=a.dt*e.m_angularVelocity,f*f>v.b2_maxRotationSquared&&(e.m_angularVelocity=0>e.m_angularVelocity?-v.b2_maxRotation*a.inv_dt:v.b2_maxRotation*a.inv_dt),e.m_sweep.c0.setV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=a.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=a.dt*e.m_linearVelocity.y,e.m_sweep.a+=a.dt*e.m_angularVelocity,e.synchronizeTransform());c=0;for(a=a.positionIterations;c<a;){c++;d=b.solvePositionConstraints(0.75);e=!0;f=0;
for(g=this.m_jointCount;f<g;)var k=f++,k=this.m_joints[k].solvePositionConstraints(v.b2_contactBaumgarte),e=e?k:!1;if(d&&e)break}this.report(b.m_constraints)},report:function(a){if(null!=this.m_listener)for(var b=0,c=this.m_contactCount;b<c;){for(var d=b++,e=this.m_contacts[d],d=a[d],f=0,g=d.pointCount;f<g;){var k=f++;cc.s_impulse.normalImpulses[k]=d.points[k].normalImpulse;cc.s_impulse.tangentImpulses[k]=d.points[k].tangentImpulse}this.m_listener.postSolve(e,cc.s_impulse)}},addBody:function(a){a.m_islandIndex=
this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a},addContact:function(a){this.m_contacts[this.m_contactCount++]=a},addJoint:function(a){this.m_joints[this.m_jointCount++]=a},__class__:cc};var Yc=function(){};Yc.__name__=["box2D","dynamics","B2TimeStep"];Yc.prototype={set:function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.warmStarting=a.warmStarting},__class__:Yc};var Z=function(a,b){this.s_stack=[];this.m_contactManager=
new Od;this.m_contactSolver=new Ea;this.m_island=new cc;this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;Z.m_warmStarting=!0;Z.m_continuousPhysics=!0;this.m_allowSleep=b;this.m_gravity=a;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var c=new Nd;this.m_groundBody=this.createBody(c)};Z.__name__=["box2D","dynamics","B2World"];Z.prototype={setDestructionListener:function(a){this.m_destructionListener=
a},setContactFilter:function(a){this.m_contactManager.m_contactFilter=a},setContactListener:function(a){this.m_contactManager.m_contactListener=a},setDebugDraw:function(a){this.m_debugDraw=a},setBroadPhase:function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;null!=c;){for(var d=c.m_fixtureList;null!=d;)d.m_proxy=a.createProxy(b.getFatAABB(d.m_proxy),d),d=d.m_next;c=c.m_next}},validate:function(){this.m_contactManager.m_broadPhase.validate()},
getProxyCount:function(){return this.m_contactManager.m_broadPhase.getProxyCount()},createBody:function(a){if(!0==this.isLocked())return null;a=new z(a,this);a.m_prev=null;a.m_next=this.m_bodyList;null!=this.m_bodyList&&(this.m_bodyList.m_prev=a);this.m_bodyList=a;++this.m_bodyCount;return a},destroyBody:function(a){if(!0!=this.isLocked()){for(var b=a.m_jointList;null!=b;){var c=b,b=b.next;null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeJoint(c.joint);this.destroyJoint(c.joint)}for(b=
a.m_controllerList;null!=b;)c=b,b=b.nextController,c.controller.removeBody(a);for(b=a.m_contactList;null!=b;)c=b,b=b.next,this.m_contactManager.destroy(c.contact);a.m_contactList=null;for(b=a.m_fixtureList;null!=b;)c=b,b=b.m_next,null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeFixture(c),c.destroyProxy(this.m_contactManager.m_broadPhase),c.destroy();a.m_fixtureList=null;a.m_fixtureCount=0;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);
a==this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}},createJoint:function(a){var b=aa.create(a,null);b.m_prev=null;b.m_next=this.m_jointList;null!=this.m_jointList&&(this.m_jointList.m_prev=b);this.m_jointList=b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;b.m_edgeA.next=b.m_bodyA.m_jointList;null!=b.m_bodyA.m_jointList&&(b.m_bodyA.m_jointList.prev=b.m_edgeA);b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;b.m_edgeB.prev=
null;b.m_edgeB.next=b.m_bodyB.m_jointList;null!=b.m_bodyB.m_jointList&&(b.m_bodyB.m_jointList.prev=b.m_edgeB);b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(!1==a.collideConnected)for(a=d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next;return b},destroyJoint:function(a){var b=a.m_collideConnected;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;
c.setAwake(!0);d.setAwake(!0);null!=a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);null!=a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next);a.m_edgeA.prev=null;a.m_edgeA.next=null;null!=a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);null!=a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB==d.m_jointList&&(d.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;aa.destroy(a,null);--this.m_jointCount;if(!1==
b)for(a=d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next},addController:function(a){a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList=a;a.m_world=this;this.m_controllerCount++;return a},removeController:function(a){null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList==a&&(this.m_controllerList=a.m_next);this.m_controllerCount--},createController:function(a){if(a.m_world!=this)throw new K("Controller can only be a member of one world");
a.m_next=this.m_controllerList;a.m_prev=null;null!=this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;a.m_world=this;return a},destroyController:function(a){a.clear();null!=a.m_next&&(a.m_next.m_prev=a.m_prev);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);a==this.m_controllerList&&(this.m_controllerList=a.m_next);--this.m_controllerCount},setWarmStarting:function(a){Z.m_warmStarting=a},setContinuousPhysics:function(a){Z.m_continuousPhysics=a},getBodyCount:function(){return this.m_bodyCount},
getJointCount:function(){return this.m_jointCount},getContactCount:function(){return this.m_contactCount},setGravity:function(a){this.m_gravity=a},getGravity:function(){return this.m_gravity},getGroundBody:function(){return this.m_groundBody},step:function(a,b,c){0!=(this.m_flags&Z.e_newFixture)&&(this.m_contactManager.findNewContacts(),this.m_flags&=~Z.e_newFixture);this.m_flags|=Z.e_locked;var d=Z.s_timestep2;d.dt=a;d.velocityIterations=b;d.positionIterations=c;d.inv_dt=0<a?1/a:0;d.dtRatio=this.m_inv_dt0*
a;d.warmStarting=Z.m_warmStarting;this.m_contactManager.collide();0<d.dt&&this.solve(d);Z.m_continuousPhysics&&0<d.dt&&this.solveTOI(d);0<d.dt&&(this.m_inv_dt0=d.inv_dt);this.m_flags&=~Z.e_locked},clearForces:function(){for(var a=this.m_bodyList;null!=a;)a.m_force.setZero(),a.m_torque=0,a=a.m_next},drawDebugData:function(){if(null!=this.m_debugDraw){var a=this.m_debugDraw.getFlags(),b,c,d;new s;new s;new s;var e;new $a;new $a;e=[new s,new s,new s,new s];var f=new Md(0,0,0);if(0!=(a&za.e_shapeBit))for(b=
this.m_bodyList;null!=b;){e=b.m_xf;for(c=b.getFixtureList();null!=c;)d=c.getShape(),!1==b.isActive()?f.set(0.5,0.5,0.3):b.getType()==z.b2_staticBody?f.set(0.5,0.9,0.5):b.getType()==z.b2_kinematicBody?f.set(0.5,0.5,0.9):!1==b.isAwake()?f.set(0.6,0.6,0.6):f.set(0.9,0.7,0.7),this.drawShape(d,e,f),c=c.m_next;b=b.m_next}if(0!=(a&za.e_jointBit))for(b=this.m_jointList;null!=b;)this.drawJoint(b),b=b.m_next;if(0!=(a&za.e_controllerBit))for(b=this.m_controllerList;null!=b;)b.draw(this.m_debugDraw),b=b.m_next;
if(0!=(a&za.e_pairBit))for(f.set(0.3,0.9,0.9),b=this.m_contactManager.m_contactList;null!=b;)d=b.getFixtureA(),c=b.getFixtureB(),d=d.getAABB().getCenter(),c=c.getAABB().getCenter(),this.m_debugDraw.drawSegment(d,c,f),b=b.getNext();if(0!=(a&za.e_aabbBit))for(d=this.m_contactManager.m_broadPhase,e=[new s,new s,new s,new s],b=this.m_bodyList;null!=b;){if(!1!=b.isActive())for(c=b.getFixtureList();null!=c;){var g=d.getFatAABB(c.m_proxy);e[0].set(g.lowerBound.x,g.lowerBound.y);e[1].set(g.upperBound.x,g.lowerBound.y);
e[2].set(g.upperBound.x,g.upperBound.y);e[3].set(g.lowerBound.x,g.upperBound.y);this.m_debugDraw.drawPolygon(e,4,f);c=c.getNext()}b=b.getNext()}if(0!=(a&za.e_centerOfMassBit))for(b=this.m_bodyList;null!=b;)e=Z.s_xf,e.R=b.m_xf.R,e.position=b.getWorldCenter(),this.m_debugDraw.drawTransform(e),b=b.m_next}},queryAABB:function(a,b){var c=this.m_contactManager.m_broadPhase;c.query(function(b){b=c.getUserData(b);return a(b)},b)},queryShape:function(a,b,c){null==c&&(c=new pb,c.setIdentity());var d=this.m_contactManager.m_broadPhase,
e=new $a;b.computeAABB(e,c);d.query(function(e){e=y.__cast(d.getUserData(e),Bb);var g=e.getShape(),k=e.getBody().getTransform();return xa.testOverlap(b,c,g,k)?a(e):!0},e)},queryPoint:function(a,b){var c=this.m_contactManager.m_broadPhase,d=new $a;d.lowerBound.set(b.x-v.b2_linearSlop,b.y-v.b2_linearSlop);d.upperBound.set(b.x+v.b2_linearSlop,b.y+v.b2_linearSlop);c.query(function(d){d=y.__cast(c.getUserData(d),Bb);return d.testPoint(b)?a(d):!0},d)},rayCast:function(a,b,c){var d=this.m_contactManager.m_broadPhase,
e=new kf,f=new Jd(b,c);d.rayCast(function(f,k){var h=d.getUserData(k),h=y.__cast(h,Bb);if(h.rayCast(e,f)){var l=e.fraction,m=new s((1-l)*b.x+l*c.x,(1-l)*b.y+l*c.y);return a(h,m,e.normal,l)}return f.maxFraction},f)},rayCastOne:function(a,b){var c;this.rayCast(function(a,b,f,g){c=a;return g},a,b);return c},rayCastAll:function(a,b){var c=[];this.rayCast(function(a,b,f,g){c[c.length]=a;return 1},a,b);return c},getBodyList:function(){return this.m_bodyList},getJointList:function(){return this.m_jointList},
getContactList:function(){return this.m_contactList},isLocked:function(){return 0<(this.m_flags&Z.e_locked)},solve:function(a){for(var b,c=this.m_controllerList;null!=c;)c.step(a),c=c.m_next;var d=this.m_island;d.initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;null!=b;)b.m_flags&=~z.e_islandFlag,b=b.m_next;for(c=this.m_contactList;null!=c;)c.m_flags&=~B.e_islandFlag,c=c.m_next;for(c=this.m_jointList;null!=
c;)c.m_islandFlag=!1,c=c.m_next;for(var c=this.s_stack,e=this.m_bodyList;null!=e;){if(0==(e.m_flags&z.e_islandFlag)&&!1!=e.isAwake()&&!1!=e.isActive()&&e.getType()!=z.b2_staticBody){d.clear();var f=0;c[f++]=e;for(e.m_flags|=z.e_islandFlag;0<f;)if(b=c[--f],d.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()!=z.b2_staticBody){for(var g,k=b.m_contactList;null!=k;)0==(k.contact.m_flags&B.e_islandFlag)&&(!0!=k.contact.isSensor()&&!1!=k.contact.isEnabled()&&!1!=k.contact.isTouching())&&(d.addContact(k.contact),
k.contact.m_flags|=B.e_islandFlag,g=k.other,0==(g.m_flags&z.e_islandFlag)&&(c[f++]=g,g.m_flags|=z.e_islandFlag)),k=k.next;for(b=b.m_jointList;null!=b;)!0!=b.joint.m_islandFlag&&(g=b.other,!1!=g.isActive()&&(d.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(g.m_flags&z.e_islandFlag)&&(c[f++]=g,g.m_flags|=z.e_islandFlag))),b=b.next}d.solve(a,this.m_gravity,this.m_allowSleep);f=0;for(g=d.m_bodyCount;f<g;)b=f++,b=d.m_bodies[b],b.getType()==z.b2_staticBody&&(b.m_flags&=~z.e_islandFlag)}e=e.m_next}a=0;for(d=
c.length;a<d;){e=a++;if(null==c[e])break;c[e]=null}for(b=this.m_bodyList;null!=b;)!1!=b.isAwake()&&!1!=b.isActive()&&b.getType()!=z.b2_staticBody&&b.synchronizeFixtures(),b=b.m_next;this.m_contactManager.findNewContacts()},solveTOI:function(a){var b,c,d,e,f=this.m_island;f.initialize(this.m_bodyCount,v.b2_maxTOIContactsPerIsland,v.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var g=Z.s_queue;for(b=this.m_bodyList;null!=b;)b.m_flags&=~z.e_islandFlag,b.m_sweep.t0=
0,b=b.m_next;for(b=this.m_contactList;null!=b;)b.m_flags&=~(B.e_toiFlag|B.e_islandFlag),b=b.m_next;for(e=this.m_jointList;null!=e;)e.m_islandFlag=!1,e=e.m_next;for(;;){e=null;var k=1;for(b=this.m_contactList;null!=b;){if(!0!=b.isSensor()&&!1!=b.isEnabled()&&!1!=b.isContinuous()){c=1;if(0!=(b.m_flags&B.e_toiFlag))c=b.m_toi;else{c=b.m_fixtureA;d=b.m_fixtureB;c=c.m_body;d=d.m_body;if(!(c.getType()==z.b2_dynamicBody&&!1!=c.isAwake()||d.getType()==z.b2_dynamicBody&&!1!=d.isAwake())){b=b.m_next;continue}var h=
c.m_sweep.t0;c.m_sweep.t0<d.m_sweep.t0?(h=d.m_sweep.t0,c.m_sweep.advance(h)):d.m_sweep.t0<c.m_sweep.t0&&(h=c.m_sweep.t0,d.m_sweep.advance(h));c=b.computeTOI(c.m_sweep,d.m_sweep);v.b2Assert(0<=c&&1>=c);0<c&&1>c&&(c=(1-c)*h+c,1<c&&(c=1));b.m_toi=c;b.m_flags|=B.e_toiFlag}Number.MIN_VALUE<c&&c<k&&(e=b,k=c)}b=b.m_next}if(null==e||1-100*Number.MIN_VALUE<k)break;c=e.m_fixtureA;d=e.m_fixtureB;c=c.m_body;d=d.m_body;Z.s_backupA.set(c.m_sweep);Z.s_backupB.set(d.m_sweep);c.advance(k);d.advance(k);e.update(this.m_contactManager.m_contactListener);
e.m_flags&=~B.e_toiFlag;if(!0==e.isSensor()||!1==e.isEnabled())c.m_sweep.set(Z.s_backupA),d.m_sweep.set(Z.s_backupB),c.synchronizeTransform(),d.synchronizeTransform();else if(!1!=e.isTouching()){b=c;b.getType()!=z.b2_dynamicBody&&(b=d);f.clear();d=c=0;g[c+d++]=b;for(b.m_flags|=z.e_islandFlag;0<d;)if(b=g[c++],--d,f.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()==z.b2_dynamicBody){for(e=b.m_contactList;null!=e&&f.m_contactCount!=f.m_contactCapacity;)0==(e.contact.m_flags&B.e_islandFlag)&&(!0!=
e.contact.isSensor()&&!1!=e.contact.isEnabled()&&!1!=e.contact.isTouching())&&(f.addContact(e.contact),e.contact.m_flags|=B.e_islandFlag,h=e.other,0==(h.m_flags&z.e_islandFlag)&&(h.getType()!=z.b2_staticBody&&(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=z.e_islandFlag)),e=e.next;for(b=b.m_jointList;null!=b;)f.m_jointCount!=f.m_jointCapacity&&!0!=b.joint.m_islandFlag&&(h=b.other,!1!=h.isActive()&&(f.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(h.m_flags&z.e_islandFlag)&&(h.getType()!=z.b2_staticBody&&
(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=z.e_islandFlag))),b=b.next}b=Z.s_timestep;b.warmStarting=!1;b.dt=(1-k)*a.dt;b.inv_dt=1/b.dt;b.dtRatio=0;b.velocityIterations=a.velocityIterations;b.positionIterations=a.positionIterations;f.solveTOI(b);k=0;for(c=f.m_bodyCount;k<c;)if(b=k++,b=f.m_bodies[b],b.m_flags&=~z.e_islandFlag,!1!=b.isAwake()&&b.getType()==z.b2_dynamicBody)for(b.synchronizeFixtures(),e=b.m_contactList;null!=e;)e.contact.m_flags&=~B.e_toiFlag,e=e.next;k=0;for(e=f.m_contactCount;k<
e;)b=k++,b=f.m_contacts[b],b.m_flags&=~(B.e_toiFlag|B.e_islandFlag);k=0;for(b=f.m_jointCount;k<b;)e=k++,e=f.m_joints[e],e.m_islandFlag=!1;this.m_contactManager.findNewContacts()}}},drawJoint:function(a){var b=a.getBodyA(),c=a.getBodyB(),d=b.m_xf.position,e=c.m_xf.position,f=a.getAnchorA(),g=a.getAnchorB(),k=Z.s_jointColor;switch(a.m_type[1]){case 3:this.m_debugDraw.drawSegment(f,g,k);break;case 4:b=y.__cast(a,qb);a=b.getGroundAnchorA();b=b.getGroundAnchorB();this.m_debugDraw.drawSegment(a,f,k);this.m_debugDraw.drawSegment(b,
g,k);this.m_debugDraw.drawSegment(a,b,k);break;case 5:this.m_debugDraw.drawSegment(f,g,k);break;default:b!=this.m_groundBody&&this.m_debugDraw.drawSegment(d,f,k),this.m_debugDraw.drawSegment(f,g,k),c!=this.m_groundBody&&this.m_debugDraw.drawSegment(e,g,k)}},drawShape:function(a,b,c){switch(a.m_type[1]){case 1:a=y.__cast(a,bb);var d=r.mulX(b,a.m_p);this.m_debugDraw.drawSolidCircle(d,a.m_radius,b.R.col1,c);break;case 2:d=y.__cast(a,ka);a=d.getVertexCount();for(var d=d.getVertices(),e=[],f=0;f<a;){var g=
f++;e[g]=r.mulX(b,d[g])}this.m_debugDraw.drawSolidPolygon(e,a,c);break;case 3:a=y.__cast(a,yc),this.m_debugDraw.drawSegment(r.mulX(b,a.getVertex1()),r.mulX(b,a.getVertex2()),c)}},__class__:Z};var B=function(){this.m_nodeA=new Pd;this.m_nodeB=new Pd;this.m_manifold=new Vc;this.m_oldManifold=new Vc};B.__name__=["box2D","dynamics","contacts","B2Contact"];B.prototype={getManifold:function(){return this.m_manifold},getWorldManifold:function(a){var b=this.m_fixtureA.getBody(),c=this.m_fixtureB.getBody(),
d=this.m_fixtureA.getShape(),e=this.m_fixtureB.getShape();a.initialize(this.m_manifold,b.getTransform(),d.m_radius,c.getTransform(),e.m_radius)},isTouching:function(){return(this.m_flags&B.e_touchingFlag)==B.e_touchingFlag},isContinuous:function(){return(this.m_flags&B.e_continuousFlag)==B.e_continuousFlag},setSensor:function(a){this.m_flags=a?this.m_flags|B.e_sensorFlag:this.m_flags&~B.e_sensorFlag},isSensor:function(){return(this.m_flags&B.e_sensorFlag)==B.e_sensorFlag},setEnabled:function(a){this.m_flags=
a?this.m_flags|B.e_enabledFlag:this.m_flags&~B.e_enabledFlag},isEnabled:function(){return(this.m_flags&B.e_enabledFlag)==B.e_enabledFlag},getNext:function(){return this.m_next},getFixtureA:function(){return this.m_fixtureA},getFixtureB:function(){return this.m_fixtureB},flagForFiltering:function(){this.m_flags|=B.e_filterFlag},reset:function(a,b){this.m_flags=B.e_enabledFlag;if(null==a||null==b)this.m_fixtureB=this.m_fixtureA=null;else{if(a.isSensor()||b.isSensor())this.m_flags|=B.e_sensorFlag;var c=
a.getBody(),d=b.getBody();if(c.getType()!=z.b2_dynamicBody||c.isBullet()||d.getType()!=z.b2_dynamicBody||d.isBullet())this.m_flags|=B.e_continuousFlag;this.m_fixtureA=a;this.m_fixtureB=b;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}},update:function(a){var b=this.m_oldManifold;this.m_oldManifold=
this.m_manifold;this.m_manifold=b;this.m_flags|=B.e_enabledFlag;var c=!1,b=(this.m_flags&B.e_touchingFlag)==B.e_touchingFlag,d=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body,f=this.m_fixtureA.m_aabb.testOverlap(this.m_fixtureB.m_aabb);if(0!=(this.m_flags&B.e_sensorFlag))f&&(c=this.m_fixtureA.getShape(),f=this.m_fixtureB.getShape(),d=d.getTransform(),e=e.getTransform(),c=xa.testOverlap(c,d,f,e)),this.m_manifold.m_pointCount=0;else{d.getType()!=z.b2_dynamicBody||d.isBullet()||e.getType()!=z.b2_dynamicBody||
e.isBullet()?this.m_flags|=B.e_continuousFlag:this.m_flags&=~B.e_continuousFlag;if(f){this.evaluate();for(var c=0<this.m_manifold.m_pointCount,f=0,g=this.m_manifold.m_pointCount;f<g;){var k=f++,k=this.m_manifold.m_points[k];k.m_normalImpulse=0;k.m_tangentImpulse=0;for(var h=k.m_id,l=0,m=this.m_oldManifold.m_pointCount;l<m;){var u=l++,u=this.m_oldManifold.m_points[u];if(u.m_id.get_key()==h.get_key()){k.m_normalImpulse=u.m_normalImpulse;k.m_tangentImpulse=u.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=
0;c!=b&&(d.setAwake(!0),e.setAwake(!0))}this.m_flags=c?this.m_flags|B.e_touchingFlag:this.m_flags&~B.e_touchingFlag;!1==b&&!0==c&&a.beginContact(this);!0==b&&!1==c&&a.endContact(this);0==(this.m_flags&B.e_sensorFlag)&&a.preSolve(this,this.m_oldManifold)},evaluate:function(){},computeTOI:function(a,b){B.s_input.proxyA.set(this.m_fixtureA.getShape());B.s_input.proxyB.set(this.m_fixtureB.getShape());B.s_input.sweepA=a;B.s_input.sweepB=b;B.s_input.tolerance=v.b2_linearSlop;return N.timeOfImpact(B.s_input)},
__class__:B};var Nb=function(){B.call(this)};Nb.__name__=["box2D","dynamics","contacts","B2CircleContact"];Nb.create=function(a){return new Nb};Nb.destroy=function(a,b){};Nb.__super__=B;Nb.prototype=p(B.prototype,{reset:function(a,b){B.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();J.collideCircles(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),bb),a.m_xf,y.__cast(this.m_fixtureB.getShape(),bb),b.m_xf)},__class__:Nb});var tf=function(){this.localPlaneNormal=
new s;this.localPoint=new s;this.normal=new s;this.normalMass=new da;this.K=new da;this.points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.points[c]=new sf}};tf.__name__=["box2D","dynamics","contacts","B2ContactConstraint"];tf.prototype={__class__:tf};var sf=function(){this.localPoint=new s;this.rA=new s;this.rB=new s};sf.__name__=["box2D","dynamics","contacts","B2ContactConstraintPoint"];sf.prototype={__class__:sf};var Pd=function(){};Pd.__name__=["box2D","dynamics","contacts","B2ContactEdge"];
Pd.prototype={__class__:Pd};var rf=function(a){this.m_allocator=a;this.initializeRegisters()};rf.__name__=["box2D","dynamics","contacts","B2ContactFactory"];rf.prototype={addType:function(a,b,c,d){var e=c[1],f=d[1];this.m_registers[e][f].createFcn=a;this.m_registers[e][f].destroyFcn=b;this.m_registers[e][f].primary=!0;c!=d&&(this.m_registers[f][e].createFcn=a,this.m_registers[f][e].destroyFcn=b,this.m_registers[f][e].primary=!1)},initializeRegisters:function(){this.m_registers=[];for(var a=0,b=X.__empty_constructs__.length;a<
b;){var c=a++;this.m_registers[c]=[];for(var d=0,e=X.__empty_constructs__.length;d<e;){var f=d++;this.m_registers[c][f]=new uf}}this.addType(Nb.create,Nb.destroy,X.CIRCLE_SHAPE,X.CIRCLE_SHAPE);this.addType(Ob.create,Ob.destroy,X.POLYGON_SHAPE,X.CIRCLE_SHAPE);this.addType(Pb.create,Pb.destroy,X.POLYGON_SHAPE,X.POLYGON_SHAPE);this.addType(Qb.create,Qb.destroy,X.EDGE_SHAPE,X.CIRCLE_SHAPE);this.addType(Rb.create,Rb.destroy,X.POLYGON_SHAPE,X.EDGE_SHAPE)},create:function(a,b){var c=a.getType(),d=b.getType(),
c=this.m_registers[c[1]][d[1]];if(null!=c.pool)return d=c.pool,c.pool=d.m_next,c.poolCount--,d.reset(a,b),d;d=c.createFcn;return null!=d?(c.primary?(d=d(this.m_allocator),d.reset(a,b)):(d=d(this.m_allocator),d.reset(b,a)),d):null},destroy:function(a){0<a.m_manifold.m_pointCount&&(a.m_fixtureA.m_body.setAwake(!0),a.m_fixtureB.m_body.setAwake(!0));var b=a.m_fixtureA.getType(),c=a.m_fixtureB.getType(),b=this.m_registers[b[1]][c[1]];b.poolCount++;a.m_next=b.pool;b.pool=a;b=b.destroyFcn;b(a,this.m_allocator)},
__class__:rf};var uf=function(){};uf.__name__=["box2D","dynamics","contacts","B2ContactRegister"];uf.prototype={__class__:uf};var Zc=function(){this.m_normal=new s;this.m_separations=[];this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new s}};Zc.__name__=["box2D","dynamics","contacts","B2PositionSolverManifold"];Zc.prototype={initialize:function(a){v.b2Assert(0<a.pointCount);var b,c,d,e,f;switch(a.type[1]){case 0:d=a.bodyA.m_xf.R;c=a.localPoint;b=a.bodyA.m_xf.position.x+
(d.col1.x*c.x+d.col2.x*c.y);e=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;c=a.points[0].localPoint;f=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);d=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);c=f-b;var g=d-e,k=c*c+g*g;k>Number.MIN_VALUE*Number.MIN_VALUE?(k=Math.sqrt(k),this.m_normal.x=c/k,this.m_normal.y=g/k):(this.m_normal.x=1,this.m_normal.y=0);this.m_points[0].x=0.5*(b+f);this.m_points[0].y=0.5*(e+d);this.m_separations[0]=c*this.m_normal.x+g*this.m_normal.y-
a.radius;break;case 1:d=a.bodyA.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyA.m_xf.R;c=a.localPoint;e=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;g=0;for(k=a.pointCount;g<k;){var h=g++;c=a.points[h].localPoint;b=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);c=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);this.m_separations[h]=(b-e)*
this.m_normal.x+(c-f)*this.m_normal.y-a.radius;this.m_points[h].x=b;this.m_points[h].y=c}break;case 2:d=a.bodyB.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyB.m_xf.R;c=a.localPoint;e=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyA.m_xf.R;g=0;for(k=a.pointCount;g<k;)h=g++,c=a.points[h].localPoint,b=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y),c=a.bodyA.m_xf.position.y+
(d.col1.y*c.x+d.col2.y*c.y),this.m_separations[h]=(b-e)*this.m_normal.x+(c-f)*this.m_normal.y-a.radius,this.m_points[h].set(b,c);this.m_normal.x*=-1;this.m_normal.y*=-1}},__class__:Zc};var Ea=function(){this.m_step=new Yc;this.m_constraints=[]};Ea.__name__=["box2D","dynamics","contacts","B2ContactSolver"];Ea.prototype={initialize:function(a,b,c,d){var e;this.m_step.set(a);this.m_allocator=d;for(this.m_constraintCount=c;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=
new tf;for(a=0;a<c;){d=a++;e=b[d];var f=e.m_fixtureA,g=e.m_fixtureB,k=f.m_shape.m_radius,h=g.m_shape.m_radius,l=f.m_body,m=g.m_body;e=e.getManifold();var u=v.b2MixFriction(f.getFriction(),g.getFriction()),r=v.b2MixRestitution(f.getRestitution(),g.getRestitution()),n=l.m_linearVelocity.x,q=l.m_linearVelocity.y,s=m.m_linearVelocity.x,p=m.m_linearVelocity.y,t=l.m_angularVelocity,w=m.m_angularVelocity;v.b2Assert(0<e.m_pointCount);Ea.s_worldManifold.initialize(e,l.m_xf,k,m.m_xf,h);f=Ea.s_worldManifold.m_normal.x;
g=Ea.s_worldManifold.m_normal.y;d=this.m_constraints[d];d.bodyA=l;d.bodyB=m;d.manifold=e;d.normal.x=f;d.normal.y=g;d.pointCount=e.m_pointCount;d.friction=u;d.restitution=r;d.localPlaneNormal.x=e.m_localPlaneNormal.x;d.localPlaneNormal.y=e.m_localPlaneNormal.y;d.localPoint.x=e.m_localPoint.x;d.localPoint.y=e.m_localPoint.y;d.radius=k+h;d.type=e.m_type;k=0;for(h=d.pointCount;k<h;){var x=k++,r=e.m_points[x],u=d.points[x];u.normalImpulse=r.m_normalImpulse;u.tangentImpulse=r.m_tangentImpulse;u.localPoint.setV(r.m_localPoint);
var r=u.rA.x=Ea.s_worldManifold.m_points[x].x-l.m_sweep.c.x,z=u.rA.y=Ea.s_worldManifold.m_points[x].y-l.m_sweep.c.y,A=u.rB.x=Ea.s_worldManifold.m_points[x].x-m.m_sweep.c.x,x=u.rB.y=Ea.s_worldManifold.m_points[x].y-m.m_sweep.c.y,B=r*g-z*f,y=A*g-x*f,B=B*B,y=y*y;u.normalMass=1/(l.m_invMass+m.m_invMass+l.m_invI*B+m.m_invI*y);var C=l.m_mass*l.m_invMass+m.m_mass*m.m_invMass,C=C+(l.m_mass*l.m_invI*B+m.m_mass*m.m_invI*y);u.equalizedMass=1/C;y=g;C=-f;B=r*C-z*y;y=A*C-x*y;B*=B;y*=y;u.tangentMass=1/(l.m_invMass+
m.m_invMass+l.m_invI*B+m.m_invI*y);u.velocityBias=0;r=d.normal.x*(s+-w*x-n- -t*z)+d.normal.y*(p+w*A-q-t*r);r<-v.b2_velocityThreshold&&(u.velocityBias+=-d.restitution*r)}2==d.pointCount&&(p=d.points[0],s=d.points[1],e=l.m_invMass,l=l.m_invI,n=m.m_invMass,m=m.m_invI,q=p.rA.x*g-p.rA.y*f,p=p.rB.x*g-p.rB.y*f,t=s.rA.x*g-s.rA.y*f,s=s.rB.x*g-s.rB.y*f,f=e+n+l*q*q+m*p*p,g=e+n+l*t*t+m*s*s,m=e+n+l*q*t+m*p*s,f*f<100*(f*g-m*m)?(d.K.col1.set(f,m),d.K.col2.set(m,g),d.K.getInverse(d.normalMass)):d.pointCount=1)}},
initVelocityConstraints:function(a){for(var b=0,c=this.m_constraintCount;b<c;){var d=b++,d=this.m_constraints[d],e=d.bodyA,f=d.bodyB,g=e.m_invMass,k=e.m_invI,h=f.m_invMass,l=f.m_invI,m=d.normal.x,u=d.normal.y,r=u,n=-m,q;if(a.warmStarting){q=d.pointCount;for(var s=0;s<q;){var p=s++,p=d.points[p];p.normalImpulse*=a.dtRatio;p.tangentImpulse*=a.dtRatio;var t=p.normalImpulse*m+p.tangentImpulse*r,v=p.normalImpulse*u+p.tangentImpulse*n;e.m_angularVelocity-=k*(p.rA.x*v-p.rA.y*t);e.m_linearVelocity.x-=g*t;
e.m_linearVelocity.y-=g*v;f.m_angularVelocity+=l*(p.rB.x*v-p.rB.y*t);f.m_linearVelocity.x+=h*t;f.m_linearVelocity.y+=h*v}}else for(q=d.pointCount,e=0,f=q;e<f;)g=e++,g=d.points[g],g.normalImpulse=0,g.tangentImpulse=0}},solveVelocityConstraints:function(){for(var a,b,c,d,e,f,g,k,h,l,m=0,u=this.m_constraintCount;m<u;){var n=m++;d=this.m_constraints[n];var n=d.bodyA,q=d.bodyB,p=n.m_angularVelocity,s=q.m_angularVelocity,t=n.m_linearVelocity,v=q.m_linearVelocity,w=n.m_invMass,x=n.m_invI,z=q.m_invMass,A=
q.m_invI;k=d.normal.x;var y=h=d.normal.y,B=-k;l=d.friction;g=0;for(f=d.pointCount;g<f;)a=g++,a=d.points[a],b=v.x-s*a.rB.y-t.x+p*a.rA.y,c=v.y+s*a.rB.x-t.y-p*a.rA.x,b=b*y+c*B,b=a.tangentMass*-b,c=l*a.normalImpulse,c=r.clamp(a.tangentImpulse+b,-c,c),b=c-a.tangentImpulse,e=b*y,b*=B,t.x-=w*e,t.y-=w*b,p-=x*(a.rA.x*b-a.rA.y*e),v.x+=z*e,v.y+=z*b,s+=A*(a.rB.x*b-a.rB.y*e),a.tangentImpulse=c;if(1==d.pointCount)a=d.points[0],b=v.x+-s*a.rB.y-t.x- -p*a.rA.y,c=v.y+s*a.rB.x-t.y-p*a.rA.x,d=b*k+c*h,b=-a.normalMass*
(d-a.velocityBias),c=a.normalImpulse+b,0<c||(c=0),b=c-a.normalImpulse,e=b*k,b*=h,t.x-=w*e,t.y-=w*b,p-=x*(a.rA.x*b-a.rA.y*e),v.x+=z*e,v.y+=z*b,s+=A*(a.rB.x*b-a.rB.y*e),a.normalImpulse=c;else{a=d.points[0];y=d.points[1];f=a.normalImpulse;g=y.normalImpulse;e=(v.x-s*a.rB.y-t.x+p*a.rA.y)*k+(v.y+s*a.rB.x-t.y-p*a.rA.x)*h;var C=(v.x-s*y.rB.y-t.x+p*y.rA.y)*k+(v.y+s*y.rB.x-t.y-p*y.rA.x)*h;b=e-a.velocityBias;c=C-y.velocityBias;l=d.K;b-=l.col1.x*f+l.col2.x*g;for(c-=l.col1.y*f+l.col2.y*g;;){l=d.normalMass;B=-(l.col1.x*
b+l.col2.x*c);l=-(l.col1.y*b+l.col2.y*c);if(0<=B&&0<=l){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;t.x-=w*(d+k);t.y-=w*(f+h);p-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);s+=A*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=B;y.normalImpulse=l;break}B=-a.normalMass*b;l=0;C=d.K.col1.y*B+c;if(0<=B&&0<=C){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;t.x-=w*(d+k);t.y-=w*(f+h);p-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);s+=A*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
B;y.normalImpulse=l;break}B=0;l=-y.normalMass*c;e=d.K.col2.x*l+b;if(0<=l&&0<=e){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;t.x-=w*(d+k);t.y-=w*(f+h);p-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);s+=A*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=B;y.normalImpulse=l;break}l=B=0;e=b;C=c;if(0<=e&&0<=C){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;t.x-=w*(d+k);t.y-=w*(f+h);p-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);s+=A*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
B;y.normalImpulse=l;break}break}}n.m_angularVelocity=p;q.m_angularVelocity=s}},finalizeVelocityConstraints:function(){for(var a=0,b=this.m_constraintCount;a<b;)for(var c=a++,c=this.m_constraints[c],d=c.manifold,e=0,f=c.pointCount;e<f;){var g=e++,k=d.m_points[g],g=c.points[g];k.m_normalImpulse=g.normalImpulse;k.m_tangentImpulse=g.tangentImpulse}},solvePositionConstraints:function(a){for(var b=0,c=0,d=this.m_constraintCount;c<d;){var e=c++,e=this.m_constraints[e],f=e.bodyA,g=e.bodyB,k=f.m_mass*f.m_invMass,
h=f.m_mass*f.m_invI,l=g.m_mass*g.m_invMass,m=g.m_mass*g.m_invI;Ea.s_psm.initialize(e);for(var u=Ea.s_psm.m_normal,n=0,p=e.pointCount;n<p;){var q=n++,s=e.points[q],t=Ea.s_psm.m_points[q],w=Ea.s_psm.m_separations[q],q=t.x-f.m_sweep.c.x,x=t.y-f.m_sweep.c.y,y=t.x-g.m_sweep.c.x,t=t.y-g.m_sweep.c.y;b<w||(b=w);w=r.clamp(a*(w+v.b2_linearSlop),-v.b2_maxLinearCorrection,0);w*=-s.equalizedMass;s=w*u.x;w*=u.y;f.m_sweep.c.x-=k*s;f.m_sweep.c.y-=k*w;f.m_sweep.a-=h*(q*w-x*s);f.synchronizeTransform();g.m_sweep.c.x+=
l*s;g.m_sweep.c.y+=l*w;g.m_sweep.a+=m*(y*w-t*s);g.synchronizeTransform()}}return b>-1.5*v.b2_linearSlop},__class__:Ea};var Qb=function(){B.call(this)};Qb.__name__=["box2D","dynamics","contacts","B2EdgeAndCircleContact"];Qb.create=function(a){return new Qb};Qb.destroy=function(a,b){};Qb.__super__=B;Qb.prototype=p(B.prototype,{reset:function(a,b){B.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollideEdgeAndCircle(this.m_manifold,
y.__cast(this.m_fixtureA.getShape(),yc),a.m_xf,y.__cast(this.m_fixtureB.getShape(),bb),b.m_xf)},b2CollideEdgeAndCircle:function(a,b,c,d,e){},__class__:Qb});var Ob=function(){B.call(this)};Ob.__name__=["box2D","dynamics","contacts","B2PolyAndCircleContact"];Ob.create=function(a){return new Ob};Ob.destroy=function(a,b){};Ob.__super__=B;Ob.prototype=p(B.prototype,{reset:function(a,b){B.prototype.reset.call(this,a,b);v.b2Assert(a.getType()==X.POLYGON_SHAPE);v.b2Assert(b.getType()==X.CIRCLE_SHAPE)},evaluate:function(){var a=
this.m_fixtureA.m_body,b=this.m_fixtureB.m_body;J.collidePolygonAndCircle(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),ka),a.m_xf,y.__cast(this.m_fixtureB.getShape(),bb),b.m_xf)},__class__:Ob});var Rb=function(){B.call(this)};Rb.__name__=["box2D","dynamics","contacts","B2PolyAndEdgeContact"];Rb.create=function(a){return new Rb};Rb.destroy=function(a,b){};Rb.__super__=B;Rb.prototype=p(B.prototype,{reset:function(a,b){B.prototype.reset.call(this,a,b);v.b2Assert(a.getType()==X.POLYGON_SHAPE);
v.b2Assert(b.getType()==X.EDGE_SHAPE)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollidePolyAndEdge(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),ka),a.m_xf,y.__cast(this.m_fixtureB.getShape(),yc),b.m_xf)},b2CollidePolyAndEdge:function(a,b,c,d,e){},__class__:Rb});var Pb=function(){B.call(this)};Pb.__name__=["box2D","dynamics","contacts","B2PolygonContact"];Pb.create=function(a){return new Pb};Pb.destroy=function(a,b){};Pb.__super__=B;Pb.prototype=
p(B.prototype,{reset:function(a,b){B.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();J.collidePolygons(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),ka),a.m_xf,y.__cast(this.m_fixtureB.getShape(),ka),b.m_xf)},__class__:Pb});var aa=function(a){this.m_edgeA=new Qd;this.m_edgeB=new Qd;this.m_localCenterA=new s;this.m_localCenterB=new s;v.b2Assert(a.bodyA!=a.bodyB);this.m_type=a.type;this.m_next=this.m_prev=null;this.m_bodyA=a.bodyA;
this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_islandFlag=!1;this.m_userData=a.userData};aa.__name__=["box2D","dynamics","joints","B2Joint"];aa.create=function(a,b){var c=null;switch(a.type[1]){case 1:c=new rb(y.__cast(a,Rd));break;case 2:c=new zc(y.__cast(a,Sd));break;case 3:c=new Td(y.__cast(a,Ud));break;case 4:c=new qb(y.__cast(a,Vd));break;case 5:c=new Wd(y.__cast(a,Xd));break;case 6:c=new Yd(y.__cast(a,Zd));break;case 7:c=new $d(y.__cast(a,ae));break;case 8:c=new be(y.__cast(a,
ce));break;case 9:c=new de(y.__cast(a,ee))}return c};aa.destroy=function(a,b){};aa.prototype={getType:function(){return this.m_type},getAnchorA:function(){return null},getAnchorB:function(){return null},getReactionForce:function(a){return null},getReactionTorque:function(a){return 0},getBodyA:function(){return this.m_bodyA},getBodyB:function(){return this.m_bodyB},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=a},isActive:function(){return this.m_bodyA.isActive()?
this.m_bodyB.isActive():!1},initVelocityConstraints:function(a){},solveVelocityConstraints:function(a){},finalizeVelocityConstraints:function(){},solvePositionConstraints:function(a){return!1},__class__:aa};var Td=function(a){aa.call(this,a);this.m_localAnchor1=new s;this.m_localAnchor2=new s;this.m_u=new s;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_length=a.length;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_bias=this.m_gamma=
this.m_impulse=0};Td.__name__=["box2D","dynamics","joints","B2DistanceJoint"];Td.__super__=aa;Td.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new s(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)},getReactionTorque:function(a){return 0},getLength:function(){return this.m_length},setLength:function(a){this.m_length=a},
getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchor1.x-d.m_sweep.localCenter.x,g=this.m_localAnchor1.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchor2.x-e.m_sweep.localCenter.x,
h=this.m_localAnchor2.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;this.m_u.x=e.m_sweep.c.x+k-d.m_sweep.c.x-f;this.m_u.y=e.m_sweep.c.y+h-d.m_sweep.c.y-g;c=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);c>v.b2_linearSlop?this.m_u.multiply(1/c):this.m_u.setZero();b=f*this.m_u.y-g*this.m_u.x;var l=k*this.m_u.y-h*this.m_u.x;b=d.m_invMass+d.m_invI*b*b+e.m_invMass+e.m_invI*l*l;this.m_mass=0!=b?1/b:0;if(0<this.m_frequencyHz){c-=this.m_length;var l=2*Math.PI*this.m_frequencyHz,
m=this.m_mass*l*l;this.m_gamma=a.dt*(2*this.m_mass*this.m_dampingRatio*l+a.dt*m);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_bias=c*a.dt*m*this.m_gamma;this.m_mass=b+this.m_gamma;this.m_mass=0!=this.m_mass?1/this.m_mass:0}a.warmStarting?(this.m_impulse*=a.dtRatio,a=this.m_impulse*this.m_u.x,b=this.m_impulse*this.m_u.y,d.m_linearVelocity.x-=d.m_invMass*a,d.m_linearVelocity.y-=d.m_invMass*b,d.m_angularVelocity-=d.m_invI*(f*b-g*a),e.m_linearVelocity.x+=e.m_invMass*a,e.m_linearVelocity.y+=e.m_invMass*
b,e.m_angularVelocity+=e.m_invI*(k*b-h*a)):this.m_impulse=0},solveVelocityConstraints:function(a){var b;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=-this.m_mass*(this.m_u.x*(c.m_linearVelocity.x+
-c.m_angularVelocity*k-(a.m_linearVelocity.x+-a.m_angularVelocity*e))+this.m_u.y*(c.m_linearVelocity.y+c.m_angularVelocity*g-(a.m_linearVelocity.y+a.m_angularVelocity*d))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;b=f*this.m_u.x;f*=this.m_u.y;a.m_linearVelocity.x-=a.m_invMass*b;a.m_linearVelocity.y-=a.m_invMass*f;a.m_angularVelocity-=a.m_invI*(d*f-e*b);c.m_linearVelocity.x+=c.m_invMass*b;c.m_linearVelocity.y+=c.m_invMass*f;c.m_angularVelocity+=c.m_invI*(g*f-k*b)},solvePositionConstraints:function(a){var b;
if(0<this.m_frequencyHz)return!0;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=c.m_sweep.c.x+g-a.m_sweep.c.x-d,h=c.m_sweep.c.y+k-a.m_sweep.c.y-e;b=Math.sqrt(f*f+h*h);f/=b;h/=b;b-=this.m_length;
b=r.clamp(b,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection);var l=-this.m_mass*b;this.m_u.set(f,h);f=l*this.m_u.x;h=l*this.m_u.y;a.m_sweep.c.x-=a.m_invMass*f;a.m_sweep.c.y-=a.m_invMass*h;a.m_sweep.a-=a.m_invI*(d*h-e*f);c.m_sweep.c.x+=c.m_invMass*f;c.m_sweep.c.y+=c.m_invMass*h;c.m_sweep.a+=c.m_invI*(g*h-k*f);a.synchronizeTransform();c.synchronizeTransform();return r.abs(b)<v.b2_linearSlop},__class__:Td});var fa=function(){this.type=O.UNKNOWN_JOINT;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=
!1};fa.__name__=["box2D","dynamics","joints","B2JointDef"];fa.prototype={__class__:fa};var Ud=function(){fa.call(this);this.localAnchorA=new s;this.localAnchorB=new s;this.type=O.DISTANCE_JOINT;this.length=1;this.dampingRatio=this.frequencyHz=0};Ud.__name__=["box2D","dynamics","joints","B2DistanceJointDef"];Ud.__super__=fa;Ud.prototype=p(fa.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(d));
a=d.x-c.x;c=d.y-c.y;this.length=Math.sqrt(a*a+c*c);this.dampingRatio=this.frequencyHz=0},__class__:Ud});var de=function(a){aa.call(this,a);this.m_localAnchorA=new s;this.m_localAnchorB=new s;this.m_linearMass=new da;this.m_linearImpulse=new s;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_linearMass.setZero();this.m_angularMass=0;this.m_linearImpulse.setZero();this.m_angularImpulse=0;this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque};de.__name__=["box2D",
"dynamics","joints","B2FrictionJoint"];de.__super__=aa;de.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new s(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)},getReactionTorque:function(a){return a*this.m_angularImpulse},setMaxForce:function(a){this.m_maxForce=a},getMaxForce:function(){return this.m_maxForce},setMaxTorque:function(a){this.m_maxTorque=
a},getMaxTorque:function(){return this.m_maxTorque},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;c=e.m_invMass;var l=d.m_invI,m=e.m_invI,
u=new da;u.col1.x=b+c;u.col2.x=0;u.col1.y=0;u.col2.y=b+c;u.col1.x+=l*g*g;u.col2.x+=-l*f*g;u.col1.y+=-l*f*g;u.col2.y+=l*f*f;u.col1.x+=m*h*h;u.col2.x+=-m*k*h;u.col1.y+=-m*k*h;u.col2.y+=m*k*k;u.getInverse(this.m_linearMass);this.m_angularMass=l+m;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.warmStarting?(this.m_linearImpulse.x*=a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio,a=this.m_linearImpulse,d.m_linearVelocity.x-=b*a.x,d.m_linearVelocity.y-=b*a.y,
d.m_angularVelocity-=l*(f*a.y-g*a.x+this.m_angularImpulse),e.m_linearVelocity.x+=c*a.x,e.m_linearVelocity.y+=c*a.y,e.m_angularVelocity+=m*(k*a.y-h*a.x+this.m_angularImpulse)):(this.m_linearImpulse.setZero(),this.m_angularImpulse=0)},solveVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB,f=d.m_linearVelocity,g=d.m_angularVelocity,k=e.m_linearVelocity,h=e.m_angularVelocity,l=d.m_invMass,m=e.m_invMass,u=d.m_invI,n=e.m_invI;b=d.m_xf.R;var q=this.m_localAnchorA.x-d.m_sweep.localCenter.x,
p=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*q+b.col2.x*p;p=b.col1.y*q+b.col2.y*p;q=c;b=e.m_xf.R;var t=this.m_localAnchorB.x-e.m_sweep.localCenter.x,v=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*t+b.col2.x*v;v=b.col1.y*t+b.col2.y*v;t=c;c=-this.m_angularMass*(h-g);var w=this.m_angularImpulse;b=a.dt*this.m_maxTorque;this.m_angularImpulse=r.clamp(this.m_angularImpulse+c,-b,b);c=this.m_angularImpulse-w;g-=u*c;h+=n*c;b=r.mulMV(this.m_linearMass,new s(-(k.x-h*v-f.x+g*p),-(k.y+
h*t-f.y-g*q)));c=this.m_linearImpulse.copy();this.m_linearImpulse.add(b);b=a.dt*this.m_maxForce;this.m_linearImpulse.lengthSquared()>b*b&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.multiply(b));b=r.subtractVV(this.m_linearImpulse,c);f.x-=l*b.x;f.y-=l*b.y;g-=u*(q*b.y-p*b.x);k.x+=m*b.x;k.y+=m*b.y;h+=n*(t*b.y-v*b.x);d.m_angularVelocity=g;e.m_angularVelocity=h},solvePositionConstraints:function(a){return!0},__class__:de});var ee=function(){fa.call(this);this.localAnchorA=new s;this.localAnchorB=
new s;this.type=O.FRICTION_JOINT;this.maxTorque=this.maxForce=0};ee.__name__=["box2D","dynamics","joints","B2FrictionJointDef"];ee.__super__=fa;ee.prototype=p(fa.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c))},__class__:ee});var Yd=function(a){aa.call(this,a);this.m_groundAnchor1=new s;this.m_groundAnchor2=new s;this.m_localAnchor1=new s;this.m_localAnchor2=new s;this.m_J=new vf;
var b=a.joint1.m_type,c=a.joint2.m_type;this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;this.m_ground1=a.joint1.getBodyA();this.m_bodyA=a.joint1.getBodyB();b==O.REVOLUTE_JOINT?(this.m_revolute1=y.__cast(a.joint1,rb),this.m_groundAnchor1.setV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.setV(this.m_revolute1.m_localAnchor2),b=this.m_revolute1.getJointAngle()):(this.m_prismatic1=y.__cast(a.joint1,zc),this.m_groundAnchor1.setV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.setV(this.m_prismatic1.m_localAnchor2),
b=this.m_prismatic1.getJointTranslation());this.m_ground2=a.joint2.getBodyA();this.m_bodyB=a.joint2.getBodyB();c==O.REVOLUTE_JOINT?(this.m_revolute2=y.__cast(a.joint2,rb),this.m_groundAnchor2.setV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.setV(this.m_revolute2.m_localAnchor2),c=this.m_revolute2.getJointAngle()):(this.m_prismatic2=y.__cast(a.joint2,zc),this.m_groundAnchor2.setV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.setV(this.m_prismatic2.m_localAnchor2),c=this.m_prismatic2.getJointTranslation());
this.m_ratio=a.ratio;this.m_constant=b+this.m_ratio*c;this.m_impulse=0};Yd.__name__=["box2D","dynamics","joints","B2GearJoint"];Yd.__super__=aa;Yd.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new s(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)},getReactionTorque:function(a){var b=this.m_bodyB.m_xf.R,
c=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,d=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,e=b.col1.x*c+b.col2.x*d,d=b.col1.y*c+b.col2.y*d;return a*(this.m_impulse*this.m_J.angularB-e*this.m_impulse*this.m_J.linearB.y+d*this.m_impulse*this.m_J.linearB.x)},getRatio:function(){return this.m_ratio},setRatio:function(a){this.m_ratio=a},initVelocityConstraints:function(a){var b=this.m_ground1,c=this.m_ground2,d=this.m_bodyA,e=this.m_bodyB,f,g,k,h,l,m=0;this.m_J.setZero();null!=
this.m_revolute1?(this.m_J.angularA=-1,m+=d.m_invI):(h=b.m_xf.R,f=this.m_prismatic1.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=d.m_xf.R,g=this.m_localAnchor1.x-d.m_sweep.localCenter.x,k=this.m_localAnchor1.y-d.m_sweep.localCenter.y,l=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=l*f-k*b,this.m_J.linearA.set(-b,-f),this.m_J.angularA=-h,m+=d.m_invMass+d.m_invI*h*h);null!=this.m_revolute2?(this.m_J.angularB=-this.m_ratio,m+=this.m_ratio*this.m_ratio*e.m_invI):(h=c.m_xf.R,
f=this.m_prismatic2.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=e.m_xf.R,g=this.m_localAnchor2.x-e.m_sweep.localCenter.x,k=this.m_localAnchor2.y-e.m_sweep.localCenter.y,l=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=l*f-k*b,this.m_J.linearB.set(-this.m_ratio*b,-this.m_ratio*f),this.m_J.angularB=-this.m_ratio*h,m+=this.m_ratio*this.m_ratio*(e.m_invMass+e.m_invI*h*h));this.m_mass=0<m?1/m:0;a.warmStarting?(d.m_linearVelocity.x+=d.m_invMass*this.m_impulse*this.m_J.linearA.x,
d.m_linearVelocity.y+=d.m_invMass*this.m_impulse*this.m_J.linearA.y,d.m_angularVelocity+=d.m_invI*this.m_impulse*this.m_J.angularA,e.m_linearVelocity.x+=e.m_invMass*this.m_impulse*this.m_J.linearB.x,e.m_linearVelocity.y+=e.m_invMass*this.m_impulse*this.m_J.linearB.y,e.m_angularVelocity+=e.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=this.m_J.compute(a.m_linearVelocity,a.m_angularVelocity,b.m_linearVelocity,b.m_angularVelocity),
c=-this.m_mass*c;this.m_impulse+=c;a.m_linearVelocity.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_linearVelocity.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_angularVelocity+=a.m_invI*c*this.m_J.angularA;b.m_linearVelocity.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_linearVelocity.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_angularVelocity+=b.m_invI*c*this.m_J.angularB},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d;c=null!=this.m_revolute1?this.m_revolute1.getJointAngle():this.m_prismatic1.getJointTranslation();
d=null!=this.m_revolute2?this.m_revolute2.getJointAngle():this.m_prismatic2.getJointTranslation();c=-this.m_mass*(this.m_constant-(c+this.m_ratio*d));a.m_sweep.c.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_sweep.c.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_sweep.a+=a.m_invI*c*this.m_J.angularA;b.m_sweep.c.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_sweep.c.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_sweep.a+=b.m_invI*c*this.m_J.angularB;a.synchronizeTransform();b.synchronizeTransform();return 0<v.b2_linearSlop},
__class__:Yd});var Zd=function(){fa.call(this);this.type=O.GEAR_JOINT;this.joint2=this.joint1=null;this.ratio=1};Zd.__name__=["box2D","dynamics","joints","B2GearJointDef"];Zd.__super__=fa;Zd.prototype=p(fa.prototype,{__class__:Zd});var vf=function(){this.linearA=new s;this.linearB=new s};vf.__name__=["box2D","dynamics","joints","B2Jacobian"];vf.prototype={setZero:function(){this.linearA.setZero();this.angularA=0;this.linearB.setZero();this.angularB=0},set:function(a,b,c,d){this.linearA.setV(a);this.angularA=
b;this.linearB.setV(c);this.angularB=d},compute:function(a,b,c,d){return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*b+(this.linearB.x*c.x+this.linearB.y*c.y)+this.angularB*d},__class__:vf};var Qd=function(){};Qd.__name__=["box2D","dynamics","joints","B2JointEdge"];Qd.prototype={__class__:Qd};var O={__ename__:!0,__constructs__:"UNKNOWN_JOINT REVOLUTE_JOINT PRISMATIC_JOINT DISTANCE_JOINT PULLEY_JOINT MOUSE_JOINT GEAR_JOINT LINE_JOINT WELD_JOINT FRICTION_JOINT".split(" "),UNKNOWN_JOINT:["UNKNOWN_JOINT",
0]};O.UNKNOWN_JOINT.__enum__=O;O.REVOLUTE_JOINT=["REVOLUTE_JOINT",1];O.REVOLUTE_JOINT.__enum__=O;O.PRISMATIC_JOINT=["PRISMATIC_JOINT",2];O.PRISMATIC_JOINT.__enum__=O;O.DISTANCE_JOINT=["DISTANCE_JOINT",3];O.DISTANCE_JOINT.__enum__=O;O.PULLEY_JOINT=["PULLEY_JOINT",4];O.PULLEY_JOINT.__enum__=O;O.MOUSE_JOINT=["MOUSE_JOINT",5];O.MOUSE_JOINT.__enum__=O;O.GEAR_JOINT=["GEAR_JOINT",6];O.GEAR_JOINT.__enum__=O;O.LINE_JOINT=["LINE_JOINT",7];O.LINE_JOINT.__enum__=O;O.WELD_JOINT=["WELD_JOINT",8];O.WELD_JOINT.__enum__=
O;O.FRICTION_JOINT=["FRICTION_JOINT",9];O.FRICTION_JOINT.__enum__=O;O.__empty_constructs__=[O.UNKNOWN_JOINT,O.REVOLUTE_JOINT,O.PRISMATIC_JOINT,O.DISTANCE_JOINT,O.PULLEY_JOINT,O.MOUSE_JOINT,O.GEAR_JOINT,O.LINE_JOINT,O.WELD_JOINT,O.FRICTION_JOINT];var D={__ename__:!0,__constructs__:["INACTIVE_LIMIT","AT_LOWER_LIMIT","AT_UPPER_LIMIT","EQUAL_LIMITS"],INACTIVE_LIMIT:["INACTIVE_LIMIT",0]};D.INACTIVE_LIMIT.__enum__=D;D.AT_LOWER_LIMIT=["AT_LOWER_LIMIT",1];D.AT_LOWER_LIMIT.__enum__=D;D.AT_UPPER_LIMIT=["AT_UPPER_LIMIT",
2];D.AT_UPPER_LIMIT.__enum__=D;D.EQUAL_LIMITS=["EQUAL_LIMITS",3];D.EQUAL_LIMITS.__enum__=D;D.__empty_constructs__=[D.INACTIVE_LIMIT,D.AT_LOWER_LIMIT,D.AT_UPPER_LIMIT,D.EQUAL_LIMITS];var $d=function(a){aa.call(this,a);this.m_localAnchor1=new s;this.m_localAnchor2=new s;this.m_localXAxis1=new s;this.m_localYAxis1=new s;this.m_axis=new s;this.m_perp=new s;this.m_K=new da;this.m_impulse=new s;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);
this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=D.INACTIVE_LIMIT;this.m_axis.setZero();this.m_perp.setZero()};$d.__name__=["box2D","dynamics","joints","B2LineJoint"];
$d.__super__=aa;$d.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new s(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=
this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,
f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(m.x+-b*k-l.x- -a*e)+h.y*(m.y+b*g-l.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},
getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMaxMotorForce:function(){return this.m_maxMotorForce},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*
g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*l;l=d.col1.y*h+d.col2.y*l;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+l-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(r.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;this.m_a2=h*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=
this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.setV(r.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-l*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;this.m_K.col1.y=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;
this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?this.m_limitState=D.EQUAL_LIMITS:d<=this.m_lowerTranslation?this.m_limitState!=D.AT_LOWER_LIMIT&&(this.m_limitState=D.AT_LOWER_LIMIT,this.m_impulse.y=0):d>=this.m_upperTranslation?this.m_limitState!=D.AT_UPPER_LIMIT&&(this.m_limitState=D.AT_UPPER_LIMIT,this.m_impulse.y=0):(this.m_limitState=
D.INACTIVE_LIMIT,this.m_impulse.y=0)):this.m_limitState=D.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,f=this.m_impulse.x*this.m_s2+
(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,l;this.m_enableMotor&&
this.m_limitState!=D.EQUAL_LIMITS&&(l=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=r.clamp(this.m_motorImpulse+l,-a,a),l=this.m_motorImpulse-k,k=l*this.m_axis.x,a=l*this.m_axis.y,h=l*this.m_a1,l*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*l);a=this.m_perp.x*(f.x-d.x)+this.m_perp.y*
(f.y-d.y)+this.m_s2*g-this.m_s1*e;this.m_enableLimit&&this.m_limitState!=D.INACTIVE_LIMIT?(h=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),l=this.m_K.solve(new s,-a,-h),this.m_impulse.add(l),this.m_limitState==D.AT_LOWER_LIMIT?this.m_impulse.y=r.max(this.m_impulse.y,0):this.m_limitState==D.AT_UPPER_LIMIT&&(this.m_impulse.y=r.min(this.m_impulse.y,0)),a=-a-(this.m_impulse.y-k.y)*this.m_K.col2.x,this.m_impulse.x=0!=this.m_K.col1.x?a/this.m_K.col1.x+k.x:
k.x,l.x=this.m_impulse.x-k.x,l.y=this.m_impulse.y-k.y,k=l.x*this.m_perp.x+l.y*this.m_axis.x,a=l.x*this.m_perp.y+l.y*this.m_axis.y,h=l.x*this.m_s1+l.y*this.m_a1,l=l.x*this.m_s2+l.y*this.m_a2):(l=0!=this.m_K.col1.x?-a/this.m_K.col1.x:0,this.m_impulse.x+=l,k=l*this.m_perp.x,a=l*this.m_perp.y,h=l*this.m_s1,l*=this.m_s2);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*l;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);
c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,l,m,u=0,n=0;h=!1;var q=0,p=da.fromAngle(d);l=da.fromAngle(f);g=p;var n=this.m_localAnchor1.x-this.m_localCenterA.x,t=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*n+g.col2.x*t;t=g.col1.y*n+g.col2.y*t;n=k;g=l;l=this.m_localAnchor2.x-this.m_localCenterB.x;m=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*l+g.col2.x*m;m=g.col1.y*l+
g.col2.y*m;l=k;g=e.x+l-c.x-n;k=e.y+m-c.y-t;if(this.m_enableLimit){this.m_axis=r.mulMV(p,this.m_localXAxis1);this.m_a1=(g+n)*this.m_axis.y-(k+t)*this.m_axis.x;this.m_a2=l*this.m_axis.y-m*this.m_axis.x;var w=this.m_axis.x*g+this.m_axis.y*k;r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?(q=r.clamp(w,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection),u=r.abs(w),h=!0):w<=this.m_lowerTranslation?(q=r.clamp(w-this.m_lowerTranslation+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),
u=this.m_lowerTranslation-w,h=!0):w>=this.m_upperTranslation&&(q=r.clamp(w-this.m_upperTranslation+v.b2_linearSlop,0,v.b2_maxLinearCorrection),u=w-this.m_upperTranslation,h=!0)}this.m_perp=r.mulMV(p,this.m_localYAxis1);this.m_s1=(g+n)*this.m_perp.y-(k+t)*this.m_perp.x;this.m_s2=l*this.m_perp.y-m*this.m_perp.x;p=new s;t=this.m_perp.x*g+this.m_perp.y*k;u=r.max(u,r.abs(t));n=0;h?(h=this.m_invMassA,l=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,this.m_K.col1.x=h+l+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,
this.m_K.col1.y=m*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=h+l+m*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_K.solve(p,-t,-q)):(h=this.m_invMassA,l=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,q=h+l+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,p.x=0!=q?-t/q:0,p.y=0);q=p.x*this.m_perp.x+p.y*this.m_axis.x;h=p.x*this.m_perp.y+p.y*this.m_axis.y;t=p.x*this.m_s1+p.y*this.m_a1;p=p.x*this.m_s2+p.y*this.m_a2;c.x-=this.m_invMassA*q;c.y-=this.m_invMassA*
h;d-=this.m_invIA*t;e.x+=this.m_invMassB*q;e.y+=this.m_invMassB*h;f+=this.m_invIB*p;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return u<=v.b2_linearSlop?n<=v.b2_angularSlop:!1},__class__:$d});var ae=function(){fa.call(this)};ae.__name__=["box2D","dynamics","joints","B2LineJointDef"];ae.__super__=fa;ae.prototype=p(fa.prototype,{b2LineJointDef:function(){this.localAnchorA=new s;this.localAnchorB=new s;this.localAxisA=new s;this.type=O.LINE_JOINT;this.localAxisA.set(1,
0);this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0},initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d)},__class__:ae});var Wd=function(a){aa.call(this,a);this.K=new da;this.K1=new da;this.K2=new da;this.m_localAnchor=new s;this.m_target=new s;this.m_impulse=new s;this.m_mass=new da;this.m_C=
new s;this.m_target.setV(a.target);var b=this.m_target.x-this.m_bodyB.m_xf.position.x,c=this.m_target.y-this.m_bodyB.m_xf.position.y,d=this.m_bodyB.m_xf.R;this.m_localAnchor.x=b*d.col1.x+c*d.col1.y;this.m_localAnchor.y=b*d.col2.x+c*d.col2.y;this.m_maxForce=a.maxForce;this.m_impulse.setZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};Wd.__name__=["box2D","dynamics","joints","B2MouseJoint"];Wd.__super__=aa;Wd.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_target},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor)},getReactionForce:function(a){return new s(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return 0},getTarget:function(){return this.m_target},setTarget:function(a){!1==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0);this.m_target=a},getMaxForce:function(){return this.m_maxForce},setMaxForce:function(a){this.m_maxForce=a},getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=
a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b=this.m_bodyB,c=b.getMass(),d=2*Math.PI*this.m_frequencyHz,e=c*d*d;this.m_gamma=a.dt*(2*c*this.m_dampingRatio*d+a.dt*e);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_beta=a.dt*e*this.m_gamma;var e=b.m_xf.R,c=this.m_localAnchor.x-b.m_sweep.localCenter.x,d=this.m_localAnchor.y-b.m_sweep.localCenter.y,f=e.col1.x*c+e.col2.x*d,d=e.col1.y*c+e.col2.y*
d,c=f,e=b.m_invMass,f=b.m_invI;this.K1.col1.x=e;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=e;this.K2.col1.x=f*d*d;this.K2.col2.x=-f*c*d;this.K2.col1.y=-f*c*d;this.K2.col2.y=f*c*c;this.K.setM(this.K1);this.K.addM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.getInverse(this.m_mass);this.m_C.x=b.m_sweep.c.x+c-this.m_target.x;this.m_C.y=b.m_sweep.c.y+d-this.m_target.y;b.m_angularVelocity*=0.98;this.m_impulse.x*=a.dtRatio;this.m_impulse.y*=a.dtRatio;b.m_linearVelocity.x+=
e*this.m_impulse.x;b.m_linearVelocity.y+=e*this.m_impulse.y;b.m_angularVelocity+=f*(c*this.m_impulse.y-d*this.m_impulse.x)},solveVelocityConstraints:function(a){var b=this.m_bodyB,c,d,e;c=b.m_xf.R;var f=this.m_localAnchor.x-b.m_sweep.localCenter.x,g=this.m_localAnchor.y-b.m_sweep.localCenter.y;d=c.col1.x*f+c.col2.x*g;g=c.col1.y*f+c.col2.y*g;f=d;d=b.m_linearVelocity.x+-b.m_angularVelocity*g;var k=b.m_linearVelocity.y+b.m_angularVelocity*f;c=this.m_mass;d=d+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;
e=k+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;k=-(c.col1.x*d+c.col2.x*e);e=-(c.col1.y*d+c.col2.y*e);c=this.m_impulse.x;d=this.m_impulse.y;this.m_impulse.x+=k;this.m_impulse.y+=e;a=a.dt*this.m_maxForce;this.m_impulse.lengthSquared()>a*a&&this.m_impulse.multiply(a/this.m_impulse.length());k=this.m_impulse.x-c;e=this.m_impulse.y-d;b.m_linearVelocity.x+=b.m_invMass*k;b.m_linearVelocity.y+=b.m_invMass*e;b.m_angularVelocity+=b.m_invI*(f*e-g*k)},solvePositionConstraints:function(a){return!0},
__class__:Wd});var Xd=function(){fa.call(this);this.target=new s;this.type=O.MOUSE_JOINT;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};Xd.__name__=["box2D","dynamics","joints","B2MouseJointDef"];Xd.__super__=fa;Xd.prototype=p(fa.prototype,{__class__:Xd});var zc=function(a){aa.call(this,a);this.m_localAnchor1=new s;this.m_localAnchor2=new s;this.m_localXAxis1=new s;this.m_localYAxis1=new s;this.m_axis=new s;this.m_perp=new s;this.m_K=new bc;this.m_impulse=new Ka;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=D.INACTIVE_LIMIT;
this.m_axis.setZero();this.m_perp.setZero()};zc.__name__=["box2D","dynamics","joints","B2PrismaticJoint"];zc.__super__=aa;zc.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new s(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*
this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*
e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(m.x+-b*k-l.x- -a*e)+h.y*(m.y+b*g-l.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);
this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-
this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*l;l=d.col1.y*h+d.col2.y*l;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+l-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(r.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;
this.m_a2=h*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);this.m_perp.setV(r.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-l*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;
this.m_K.col1.y=k*this.m_s1+h*this.m_s2;this.m_K.col1.z=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=k+h;this.m_K.col2.z=k*this.m_a1+h*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?this.m_limitState=D.EQUAL_LIMITS:d<=this.m_lowerTranslation?
this.m_limitState!=D.AT_LOWER_LIMIT&&(this.m_limitState=D.AT_LOWER_LIMIT,this.m_impulse.z=0):d>=this.m_upperTranslation?this.m_limitState!=D.AT_UPPER_LIMIT&&(this.m_limitState=D.AT_UPPER_LIMIT,this.m_impulse.z=0):(this.m_limitState=D.INACTIVE_LIMIT,this.m_impulse.z=0)):this.m_limitState=D.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+
this.m_impulse.z)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,f=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*
d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,l;this.m_enableMotor&&this.m_limitState!=D.EQUAL_LIMITS&&(l=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=r.clamp(this.m_motorImpulse+
l,-a,a),l=this.m_motorImpulse-k,k=l*this.m_axis.x,a=l*this.m_axis.y,h=l*this.m_a1,l*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*l);h=this.m_perp.x*(f.x-d.x)+this.m_perp.y*(f.y-d.y)+this.m_s2*g-this.m_s1*e;a=g-e;this.m_enableLimit&&this.m_limitState!=D.INACTIVE_LIMIT?(l=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),l=this.m_K.solve33(new Ka,-h,-a,-l),this.m_impulse.add(l),
this.m_limitState==D.AT_LOWER_LIMIT?this.m_impulse.z=r.max(this.m_impulse.z,0):this.m_limitState==D.AT_UPPER_LIMIT&&(this.m_impulse.z=r.min(this.m_impulse.z,0)),h=-h-(this.m_impulse.z-k.z)*this.m_K.col3.x,a=-a-(this.m_impulse.z-k.z)*this.m_K.col3.y,a=this.m_K.solve22(new s,h,a),a.x+=k.x,a.y+=k.y,this.m_impulse.x=a.x,this.m_impulse.y=a.y,l.x=this.m_impulse.x-k.x,l.y=this.m_impulse.y-k.y,l.z=this.m_impulse.z-k.z,k=l.x*this.m_perp.x+l.z*this.m_axis.x,a=l.x*this.m_perp.y+l.z*this.m_axis.y,h=l.x*this.m_s1+
l.y+l.z*this.m_a1,l=l.x*this.m_s2+l.y+l.z*this.m_a2):(l=this.m_K.solve22(new s,-h,-a),this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,k=l.x*this.m_perp.x,a=l.x*this.m_perp.y,h=l.x*this.m_s1+l.y,l=l.x*this.m_s2+l.y);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*l;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,
c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,l,m=0,u=0;h=!1;var n=0,p=da.fromAngle(d),q=da.fromAngle(f);g=p;var u=this.m_localAnchor1.x-this.m_localCenterA.x,t=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*u+g.col2.x*t;t=g.col1.y*u+g.col2.y*t;u=k;g=q;q=this.m_localAnchor2.x-this.m_localCenterB.x;l=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*q+g.col2.x*l;l=g.col1.y*q+g.col2.y*l;q=k;g=e.x+q-c.x-u;k=e.y+l-c.y-t;if(this.m_enableLimit){this.m_axis=r.mulMV(p,this.m_localXAxis1);
this.m_a1=(g+u)*this.m_axis.y-(k+t)*this.m_axis.x;this.m_a2=q*this.m_axis.y-l*this.m_axis.x;var w=this.m_axis.x*g+this.m_axis.y*k;r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?(n=r.clamp(w,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection),m=r.abs(w),h=!0):w<=this.m_lowerTranslation?(n=r.clamp(w-this.m_lowerTranslation+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),m=this.m_lowerTranslation-w,h=!0):w>=this.m_upperTranslation&&(n=r.clamp(w-this.m_upperTranslation+v.b2_linearSlop,
0,v.b2_maxLinearCorrection),m=w-this.m_upperTranslation,h=!0)}this.m_perp=r.mulMV(p,this.m_localYAxis1);this.m_s1=(g+u)*this.m_perp.y-(k+t)*this.m_perp.x;this.m_s2=q*this.m_perp.y-l*this.m_perp.x;p=new Ka;t=this.m_perp.x*g+this.m_perp.y*k;q=f-d-this.m_refAngle;m=r.max(m,r.abs(t));u=r.abs(q);h?(h=this.m_invMassA,l=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,this.m_K.col1.x=h+l+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,this.m_K.col1.y=g*this.m_s1+k*this.m_s2,this.m_K.col1.z=g*this.m_s1*this.m_a1+
k*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=g+k,this.m_K.col2.z=g*this.m_a1+k*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=h+l+g*this.m_a1*this.m_a1+k*this.m_a2*this.m_a2,this.m_K.solve33(p,-t,-q,-n)):(h=this.m_invMassA,l=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,n=g*this.m_s1+k*this.m_s2,w=g+k,this.m_K.col1.set(h+l+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,n,0),this.m_K.col2.set(n,w,0),n=this.m_K.solve22(new s,-t,-q),p.x=
n.x,p.y=n.y,p.z=0);n=p.x*this.m_perp.x+p.z*this.m_axis.x;h=p.x*this.m_perp.y+p.z*this.m_axis.y;t=p.x*this.m_s1+p.y+p.z*this.m_a1;p=p.x*this.m_s2+p.y+p.z*this.m_a2;c.x-=this.m_invMassA*n;c.y-=this.m_invMassA*h;d-=this.m_invIA*t;e.x+=this.m_invMassB*n;e.y+=this.m_invMassB*h;f+=this.m_invIB*p;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return m<=v.b2_linearSlop?u<=v.b2_angularSlop:!1},__class__:zc});var Sd=function(){fa.call(this);this.localAnchorA=new s;this.localAnchorB=
new s;this.localAxisA=new s;this.type=O.PRISMATIC_JOINT;this.localAxisA.set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};Sd.__name__=["box2D","dynamics","joints","B2PrismaticJointDef"];Sd.__super__=fa;Sd.prototype=p(fa.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d);
this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:Sd});var qb=function(a){aa.call(this,a);this.m_groundAnchor1=new s;this.m_groundAnchor2=new s;this.m_localAnchor1=new s;this.m_localAnchor2=new s;this.m_u1=new s;this.m_u2=new s;this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=a.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x;
this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_maxLength1=r.min(a.maxLengthA,this.m_constant-this.m_ratio*qb.b2_minPulleyLength);this.m_maxLength2=r.min(a.maxLengthB,(this.m_constant-qb.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};qb.__name__=["box2D","dynamics","joints",
"B2PulleyJoint"];qb.__super__=aa;qb.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new s(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)},getReactionTorque:function(a){return 0},getGroundAnchorA:function(){var a=this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor1);return a},getGroundAnchorB:function(){var a=
this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor2);return a},getLength1:function(){var a=this.m_bodyA.getWorldPoint(this.m_localAnchor1),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(b*b+a*a)},getLength2:function(){var a=this.m_bodyB.getWorldPoint(this.m_localAnchor2),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(b*
b+a*a)},getRatio:function(){return this.m_ratio},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_xf.R,e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,f=this.m_localAnchor1.y-b.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g,d=c.m_xf.R,k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*k+d.col2.x*h,h=d.col1.y*k+d.col2.y*h,k=g,d=c.m_sweep.c.x+k,g=c.m_sweep.c.y+h,l=this.m_ground.m_xf.position.x+
this.m_groundAnchor2.x,m=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.set(b.m_sweep.c.x+e-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),b.m_sweep.c.y+f-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.set(d-l,g-m);d=this.m_u1.length();g=this.m_u2.length();d>v.b2_linearSlop?this.m_u1.multiply(1/d):this.m_u1.setZero();g>v.b2_linearSlop?this.m_u2.multiply(1/g):this.m_u2.setZero();0<this.m_constant-d-this.m_ratio*g?(this.m_state=D.INACTIVE_LIMIT,this.m_impulse=
0):this.m_state=D.AT_UPPER_LIMIT;d<this.m_maxLength1?(this.m_limitState1=D.INACTIVE_LIMIT,this.m_limitImpulse1=0):this.m_limitState1=D.AT_UPPER_LIMIT;g<this.m_maxLength2?(this.m_limitState2=D.INACTIVE_LIMIT,this.m_limitImpulse2=0):this.m_limitState2=D.AT_UPPER_LIMIT;d=e*this.m_u1.y-f*this.m_u1.x;g=k*this.m_u2.y-h*this.m_u2.x;this.m_limitMass1=b.m_invMass+b.m_invI*d*d;this.m_limitMass2=c.m_invMass+c.m_invI*g*g;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=
1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;a.warmStarting?(this.m_impulse*=a.dtRatio,this.m_limitImpulse1*=a.dtRatio,this.m_limitImpulse2*=a.dtRatio,a=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,d=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,g=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,l=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*a,b.m_linearVelocity.y+=b.m_invMass*
d,b.m_angularVelocity+=b.m_invI*(e*d-f*a),c.m_linearVelocity.x+=c.m_invMass*g,c.m_linearVelocity.y+=c.m_invMass*l,c.m_angularVelocity+=c.m_invI*(k*l-h*g)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,
k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,h,l;this.m_state==D.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,h=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u1.x*c+this.m_u1.y*f)-this.m_ratio*(this.m_u2.x*h+this.m_u2.y*l),l=this.m_pulleyMass*-c,c=this.m_impulse,this.m_impulse=r.max(0,this.m_impulse+l),l=this.m_impulse-c,c=-l*this.m_u1.x,
f=-l*this.m_u1.y,h=-this.m_ratio*l*this.m_u2.x,l=-this.m_ratio*l*this.m_u2.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c),b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(g*l-k*h));this.m_limitState1==D.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,c=-(this.m_u1.x*c+this.m_u1.y*f),l=-this.m_limitMass1*c,c=this.m_limitImpulse1,
this.m_limitImpulse1=r.max(0,this.m_limitImpulse1+l),l=this.m_limitImpulse1-c,c=-l*this.m_u1.x,f=-l*this.m_u1.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c));this.m_limitState2==D.AT_UPPER_LIMIT&&(h=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u2.x*h+this.m_u2.y*l),l=-this.m_limitMass2*c,c=this.m_limitImpulse2,this.m_limitImpulse2=r.max(0,this.m_limitImpulse2+l),l=this.m_limitImpulse2-
c,h=-l*this.m_u2.x,l=-l*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(g*l-k*h))},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,e=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,f=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,k,h,l,m,u,n,p,q=0;this.m_state==D.AT_UPPER_LIMIT&&(c=a.m_xf.R,
k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,u=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=u,c=b.m_xf.R,l=this.m_localAnchor2.x-b.m_sweep.localCenter.x,m=this.m_localAnchor2.y-b.m_sweep.localCenter.y,u=c.col1.x*l+c.col2.x*m,m=c.col1.y*l+c.col2.y*m,l=u,c=a.m_sweep.c.x+k,u=a.m_sweep.c.y+h,n=b.m_sweep.c.x+l,p=b.m_sweep.c.y+m,this.m_u1.set(c-d,u-e),this.m_u2.set(n-f,p-g),c=this.m_u1.length(),u=this.m_u2.length(),c>v.b2_linearSlop?this.m_u1.multiply(1/
c):this.m_u1.setZero(),u>v.b2_linearSlop?this.m_u2.multiply(1/u):this.m_u2.setZero(),c=this.m_constant-c-this.m_ratio*u,q=r.max(q,-c),c=r.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),p=-this.m_pulleyMass*c,c=-p*this.m_u1.x,u=-p*this.m_u1.y,n=-this.m_ratio*p*this.m_u2.x,p=-this.m_ratio*p*this.m_u2.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*u,a.m_sweep.a+=a.m_invI*(k*u-h*c),b.m_sweep.c.x+=b.m_invMass*n,b.m_sweep.c.y+=b.m_invMass*p,b.m_sweep.a+=b.m_invI*(l*p-m*n),a.synchronizeTransform(),
b.synchronizeTransform());this.m_limitState1==D.AT_UPPER_LIMIT&&(c=a.m_xf.R,k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,u=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=u,c=a.m_sweep.c.x+k,u=a.m_sweep.c.y+h,this.m_u1.set(c-d,u-e),c=this.m_u1.length(),c>v.b2_linearSlop?(this.m_u1.x*=1/c,this.m_u1.y*=1/c):this.m_u1.setZero(),c=this.m_maxLength1-c,q=r.max(q,-c),c=r.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),p=-this.m_limitMass1*c,c=-p*this.m_u1.x,
u=-p*this.m_u1.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*u,a.m_sweep.a+=a.m_invI*(k*u-h*c),a.synchronizeTransform());this.m_limitState2==D.AT_UPPER_LIMIT&&(c=b.m_xf.R,l=this.m_localAnchor2.x-b.m_sweep.localCenter.x,m=this.m_localAnchor2.y-b.m_sweep.localCenter.y,u=c.col1.x*l+c.col2.x*m,m=c.col1.y*l+c.col2.y*m,l=u,n=b.m_sweep.c.x+l,p=b.m_sweep.c.y+m,this.m_u2.set(n-f,p-g),u=this.m_u2.length(),u>v.b2_linearSlop?(this.m_u2.x*=1/u,this.m_u2.y*=1/u):this.m_u2.setZero(),c=this.m_maxLength2-
u,q=r.max(q,-c),c=r.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),p=-this.m_limitMass2*c,n=-p*this.m_u2.x,p=-p*this.m_u2.y,b.m_sweep.c.x+=b.m_invMass*n,b.m_sweep.c.y+=b.m_invMass*p,b.m_sweep.a+=b.m_invI*(l*p-m*n),b.synchronizeTransform());return q<v.b2_linearSlop},__class__:qb});var Vd=function(){fa.call(this);this.groundAnchorA=new s;this.groundAnchorB=new s;this.localAnchorA=new s;this.localAnchorB=new s;this.type=O.PULLEY_JOINT;this.groundAnchorA.set(-1,1);this.groundAnchorB.set(1,1);this.localAnchorA.set(-1,
0);this.localAnchorB.set(1,0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=!0};Vd.__name__=["box2D","dynamics","joints","B2PulleyJointDef"];Vd.__super__=fa;Vd.prototype=p(fa.prototype,{initialize:function(a,b,c,d,e,f,g){this.bodyA=a;this.bodyB=b;this.groundAnchorA.setV(c);this.groundAnchorB.setV(d);this.localAnchorA=this.bodyA.getLocalPoint(e);this.localAnchorB=this.bodyB.getLocalPoint(f);a=e.x-c.x;c=e.y-c.y;this.lengthA=Math.sqrt(a*a+c*c);c=f.x-d.x;
d=f.y-d.y;this.lengthB=Math.sqrt(c*c+d*d);this.ratio=g;g=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=g-this.ratio*qb.b2_minPulleyLength;this.maxLengthB=(g-qb.b2_minPulleyLength)/this.ratio},__class__:Vd});var rb=function(a){aa.call(this,a);this.K=new da;this.K1=new da;this.K2=new da;this.K3=new da;this.impulse3=new Ka;this.impulse2=new s;this.reduced=new s;this.m_localAnchor1=new s;this.m_localAnchor2=new s;this.m_impulse=new Ka;this.m_mass=new bc;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=D.INACTIVE_LIMIT};rb.__name__=["box2D","dynamics","joints","B2RevoluteJoint"];rb.__super__=aa;rb.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new s(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},getJointAngle:function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},getJointSpeed:function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_enableLimit=
a},getLowerLimit:function(){return this.m_lowerAngle},getUpperLimit:function(){return this.m_upperAngle},setLimits:function(a,b){this.m_lowerAngle=a;this.m_upperAngle=b},isMotorEnabled:function(){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);return this.m_enableMotor},enableMotor:function(a){this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorTorque:function(a){this.m_maxMotorTorque=
a},getMotorTorque:function(){return this.m_maxMotorTorque},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;d=b.m_xf.R;var f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;var k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*k+d.col2.x*h;h=d.col1.y*k+d.col2.y*h;k=e;d=b.m_invMass;e=c.m_invMass;var l=b.m_invI,
m=c.m_invI;this.m_mass.col1.x=d+e+g*g*l+h*h*m;this.m_mass.col2.x=-g*f*l-h*k*m;this.m_mass.col3.x=-g*l-h*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=d+e+f*f*l+k*k*m;this.m_mass.col3.y=f*l+k*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;this.m_motorMass=1/(l+m);!1==this.m_enableMotor&&(this.m_motorImpulse=0);if(this.m_enableLimit){var u=c.m_sweep.a-b.m_sweep.a-this.m_referenceAngle;r.abs(this.m_upperAngle-this.m_lowerAngle)<2*v.b2_angularSlop?
this.m_limitState=D.EQUAL_LIMITS:u<=this.m_lowerAngle?(this.m_limitState!=D.AT_LOWER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=D.AT_LOWER_LIMIT):u>=this.m_upperAngle?(this.m_limitState!=D.AT_UPPER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=D.AT_UPPER_LIMIT):(this.m_limitState=D.INACTIVE_LIMIT,this.m_impulse.z=0)}else this.m_limitState=D.INACTIVE_LIMIT;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x,u=this.m_impulse.y,
b.m_linearVelocity.x-=d*a,b.m_linearVelocity.y-=d*u,b.m_angularVelocity-=l*(f*u-g*a+this.m_motorImpulse+this.m_impulse.z),c.m_linearVelocity.x+=e*a,c.m_linearVelocity.y+=e*u,c.m_angularVelocity+=m*(k*u-h*a+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e,f,g,k,h=b.m_linearVelocity,l=b.m_angularVelocity,m=c.m_linearVelocity,u=c.m_angularVelocity,n=b.m_invMass,p=c.m_invMass,q=b.m_invI,
t=c.m_invI;this.m_enableMotor&&this.m_limitState!=D.EQUAL_LIMITS&&(f=this.m_motorMass*-(u-l-this.m_motorSpeed),g=this.m_motorImpulse,a=a.dt*this.m_maxMotorTorque,this.m_motorImpulse=r.clamp(this.m_motorImpulse+f,-a,a),f=this.m_motorImpulse-g,l-=q*f,u+=t*f);if(this.m_enableLimit&&this.m_limitState!=D.INACTIVE_LIMIT){d=b.m_xf.R;f=this.m_localAnchor1.x-b.m_sweep.localCenter.x;g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;a=this.m_localAnchor2.x-
c.m_sweep.localCenter.x;k=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*a+d.col2.x*k;k=d.col1.y*a+d.col2.y*k;a=e;e=m.x+-u*k-h.x- -l*g;var s=m.y+u*a-h.y-l*f;this.m_mass.solve33(this.impulse3,-e,-s,-(u-l));this.m_limitState==D.EQUAL_LIMITS?this.m_impulse.add(this.impulse3):this.m_limitState==D.AT_LOWER_LIMIT?(d=this.m_impulse.z+this.impulse3.z,0>d&&(this.m_mass.solve22(this.reduced,-e,-s),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=
this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==D.AT_UPPER_LIMIT&&(d=this.m_impulse.z+this.impulse3.z,0<d&&(this.m_mass.solve22(this.reduced,-e,-s),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0));h.x-=n*this.impulse3.x;h.y-=n*this.impulse3.y;l-=q*(f*this.impulse3.y-g*this.impulse3.x+this.impulse3.z);m.x+=p*this.impulse3.x;m.y+=
p*this.impulse3.y;u+=t*(a*this.impulse3.y-k*this.impulse3.x+this.impulse3.z)}else d=b.m_xf.R,f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,e=d.col1.x*f+d.col2.x*g,g=d.col1.y*f+d.col2.y*g,f=e,d=c.m_xf.R,a=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,e=d.col1.x*a+d.col2.x*k,k=d.col1.y*a+d.col2.y*k,a=e,this.m_mass.solve22(this.impulse2,-(m.x+-u*k-h.x- -l*g),-(m.y+u*a-h.y-l*f)),this.m_impulse.x+=this.impulse2.x,
this.m_impulse.y+=this.impulse2.y,h.x-=n*this.impulse2.x,h.y-=n*this.impulse2.y,l-=q*(f*this.impulse2.y-g*this.impulse2.x),m.x+=p*this.impulse2.x,m.y+=p*this.impulse2.y,u+=t*(a*this.impulse2.y-k*this.impulse2.x);b.m_linearVelocity.setV(h);b.m_angularVelocity=l;c.m_linearVelocity.setV(m);c.m_angularVelocity=u},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=0;c=0;var f,g,k;if(this.m_enableLimit&&this.m_limitState!=D.INACTIVE_LIMIT){b=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle;
var h=0;this.m_limitState==D.EQUAL_LIMITS?(b=r.clamp(b-this.m_lowerAngle,-v.b2_maxAngularCorrection,v.b2_maxAngularCorrection),h=-this.m_motorMass*b,e=r.abs(b)):this.m_limitState==D.AT_LOWER_LIMIT?(b-=this.m_lowerAngle,e=-b,b=r.clamp(b+v.b2_angularSlop,-v.b2_maxAngularCorrection,0),h=-this.m_motorMass*b):this.m_limitState==D.AT_UPPER_LIMIT&&(e=b-=this.m_upperAngle,b=r.clamp(b-v.b2_angularSlop,0,v.b2_maxAngularCorrection),h=-this.m_motorMass*b);a.m_sweep.a-=a.m_invI*h;d.m_sweep.a+=d.m_invI*h;a.synchronizeTransform();
d.synchronizeTransform()}c=a.m_xf.R;h=this.m_localAnchor1.x-a.m_sweep.localCenter.x;b=this.m_localAnchor1.y-a.m_sweep.localCenter.y;f=c.col1.x*h+c.col2.x*b;b=c.col1.y*h+c.col2.y*b;h=f;c=d.m_xf.R;var l=this.m_localAnchor2.x-d.m_sweep.localCenter.x,m=this.m_localAnchor2.y-d.m_sweep.localCenter.y;f=c.col1.x*l+c.col2.x*m;m=c.col1.y*l+c.col2.y*m;l=f;g=d.m_sweep.c.x+l-a.m_sweep.c.x-h;k=d.m_sweep.c.y+m-a.m_sweep.c.y-b;var u=g*g+k*k;c=Math.sqrt(u);f=a.m_invMass;var n=d.m_invMass,p=a.m_invI,q=d.m_invI,t=10*
v.b2_linearSlop;u>t*t&&(u=1/(f+n),g=u*-g,k=u*-k,a.m_sweep.c.x-=0.5*f*g,a.m_sweep.c.y-=0.5*f*k,d.m_sweep.c.x+=0.5*n*g,d.m_sweep.c.y+=0.5*n*k,g=d.m_sweep.c.x+l-a.m_sweep.c.x-h,k=d.m_sweep.c.y+m-a.m_sweep.c.y-b);this.K1.col1.x=f+n;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=f+n;this.K2.col1.x=p*b*b;this.K2.col2.x=-p*h*b;this.K2.col1.y=-p*h*b;this.K2.col2.y=p*h*h;this.K3.col1.x=q*m*m;this.K3.col2.x=-q*l*m;this.K3.col1.y=-q*l*m;this.K3.col2.y=q*l*l;this.K.setM(this.K1);this.K.addM(this.K2);this.K.addM(this.K3);
this.K.solve(rb.tImpulse,-g,-k);g=rb.tImpulse.x;k=rb.tImpulse.y;a.m_sweep.c.x-=a.m_invMass*g;a.m_sweep.c.y-=a.m_invMass*k;a.m_sweep.a-=a.m_invI*(h*k-b*g);d.m_sweep.c.x+=d.m_invMass*g;d.m_sweep.c.y+=d.m_invMass*k;d.m_sweep.a+=d.m_invI*(l*k-m*g);a.synchronizeTransform();d.synchronizeTransform();return c<=v.b2_linearSlop?e<=v.b2_angularSlop:!1},__class__:rb});var Rd=function(){fa.call(this);this.localAnchorA=new s;this.localAnchorB=new s;this.type=O.REVOLUTE_JOINT;this.localAnchorA.set(0,0);this.localAnchorB.set(0,
0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=!1};Rd.__name__=["box2D","dynamics","joints","B2RevoluteJointDef"];Rd.__super__=fa;Rd.prototype=p(fa.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:Rd});var be=function(a){aa.call(this,a);this.m_localAnchorA=
new s;this.m_localAnchorB=new s;this.m_impulse=new Ka;this.m_mass=new bc;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_mass=new bc};be.__name__=["box2D","dynamics","joints","B2WeldJoint"];be.__super__=aa;be.prototype=p(aa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new s(a*
this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;
c=e.m_invMass;var l=d.m_invI,m=e.m_invI;this.m_mass.col1.x=b+c+g*g*l+h*h*m;this.m_mass.col2.x=-g*f*l-h*k*m;this.m_mass.col3.x=-g*l-h*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+f*f*l+k*k*m;this.m_mass.col3.y=f*l+k*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,d.m_linearVelocity.x-=b*this.m_impulse.x,d.m_linearVelocity.y-=b*this.m_impulse.y,
d.m_angularVelocity-=l*(f*this.m_impulse.y-g*this.m_impulse.x+this.m_impulse.z),e.m_linearVelocity.x+=c*this.m_impulse.x,e.m_linearVelocity.y+=c*this.m_impulse.y,e.m_angularVelocity+=m*(k*this.m_impulse.y-h*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.setZero()},solveVelocityConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=a.m_linearVelocity,f=a.m_angularVelocity,g=d.m_linearVelocity,k=d.m_angularVelocity,h=a.m_invMass,l=d.m_invMass,m=a.m_invI,u=d.m_invI;b=a.m_xf.R;var n=
this.m_localAnchorA.x-a.m_sweep.localCenter.x,p=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*n+b.col2.x*p;p=b.col1.y*n+b.col2.y*p;n=c;b=d.m_xf.R;var r=this.m_localAnchorB.x-d.m_sweep.localCenter.x,q=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*r+b.col2.x*q;q=b.col1.y*r+b.col2.y*q;r=c;b=g.x-k*q-e.x+f*p;c=g.y+k*r-e.y-f*n;var t=k-f,s=new Ka;this.m_mass.solve33(s,-b,-c,-t);this.m_impulse.add(s);e.x-=h*s.x;e.y-=h*s.y;f-=m*(n*s.y-p*s.x+s.z);g.x+=l*s.x;g.y+=l*s.y;k+=u*(r*s.y-q*s.x+
s.z);a.m_angularVelocity=f;d.m_angularVelocity=k},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB;b=a.m_xf.R;var e=this.m_localAnchorA.x-a.m_sweep.localCenter.x,f=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*e+b.col2.x*f;f=b.col1.y*e+b.col2.y*f;e=c;b=d.m_xf.R;var g=this.m_localAnchorB.x-d.m_sweep.localCenter.x,k=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*g+b.col2.x*k;k=b.col1.y*g+b.col2.y*k;g=c;b=a.m_invMass;c=d.m_invMass;var h=a.m_invI,l=d.m_invI,
m=d.m_sweep.c.x+g-a.m_sweep.c.x-e,u=d.m_sweep.c.y+k-a.m_sweep.c.y-f,n=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle,p=10*v.b2_linearSlop,q=Math.sqrt(m*m+u*u),t=r.abs(n);q>p&&(h*=1,l*=1);this.m_mass.col1.x=b+c+f*f*h+k*k*l;this.m_mass.col2.x=-f*e*h-k*g*l;this.m_mass.col3.x=-f*h-k*l;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+e*e*h+g*g*l;this.m_mass.col3.y=e*h+g*l;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=h+l;p=new Ka;this.m_mass.solve33(p,
-m,-u,-n);a.m_sweep.c.x-=b*p.x;a.m_sweep.c.y-=b*p.y;a.m_sweep.a-=h*(e*p.y-f*p.x+p.z);d.m_sweep.c.x+=c*p.x;d.m_sweep.c.y+=c*p.y;d.m_sweep.a+=l*(g*p.y-k*p.x+p.z);a.synchronizeTransform();d.synchronizeTransform();return q<=v.b2_linearSlop?t<=v.b2_angularSlop:!1},__class__:be});var ce=function(){fa.call(this);this.localAnchorA=new s;this.localAnchorB=new s;this.type=O.WELD_JOINT;this.referenceAngle=0};ce.__name__=["box2D","dynamics","joints","B2WeldJointDef"];ce.__super__=fa;ce.prototype=p(fa.prototype,
{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c));this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:ce});var W={__ename__:!0,__constructs__:"Image Audio Other Javascript Css Font".split(" "),Image:["Image",0]};W.Image.__enum__=W;W.Audio=["Audio",1];W.Audio.__enum__=W;W.Other=["Other",2];W.Other.__enum__=W;W.Javascript=["Javascript",3];W.Javascript.__enum__=W;W.Css=["Css",
4];W.Css.__enum__=W;W.Font=["Font",5];W.Font.__enum__=W;W.__empty_constructs__=[W.Image,W.Audio,W.Other,W.Javascript,W.Css,W.Font];var wf=function(a,b,c,d,e){null==d&&(d=!1);this.isAbsolute=!1;this.asset=null;this.name=a;this.type=c;this.source=b;this.isAbsolute=d;this.options=e};wf.__name__=["engine","AssetLoadingInfo"];wf.prototype={__class__:wf};var sb=function(){this._eventListeners=[]};sb.__name__=["engine","events","EventDispatcher"];sb.prototype={addEventListener:function(a,b){this.hasEventListener(a,
b)||this._eventListeners.push(new xf(a,b))},hasEventListener:function(a,b){for(var c=this._eventListeners.length-1;0<=c;){if(this._eventListeners[c].eventName==a&&ma.compareMethods(this._eventListeners[c].action,b))return!0;--c}return!1},dispatchEvent:function(a){a.target=this;for(var b=this._eventListeners.length-1;0<=b;){var c=this._eventListeners[b];c.eventName==a.getType()&&c.action(a);--b}},removeAllEventListeners:function(){this._eventListeners=[]},removeEventListener:function(a,b){if(this.hasEventListener(a,
b))for(var c=this._eventListeners.length-1;0<=c;){var d=this._eventListeners[c];if(d.eventName==a&&ma.compareMethods(d.action,b)){this._eventListeners.splice(c,1);break}--c}},__class__:sb};var L=function(){this._instanceId=0;this._isActive=this._isUpdating=!0;this._isInitialized=this._isMarkedForDeletion=!1;this._eventListeners=[];this._instanceId=L._currentInstanceId++;this._name="GameObject"+this._instanceId;this._properties=new Oa};L.__name__=["engine","GameObject"];L.__super__=sb;L.prototype=
p(sb.prototype,{init:function(){this._isInitialized=!0;this.dispatchEvent(new gb("initialize"))},update:function(){!this._isInitialized&&this._isActive&&(this.init(),this.setActive(!0))},fixedUpdate:function(){},postUpdate:function(){},render:function(){},onActivate:function(){this._isActive=!0;this.dispatchEvent(new gb("activate"))},onDeactivate:function(){this._isActive=!1;this.dispatchEvent(new gb("deactivate"))},debugRender:function(){},handleMessage:function(a,b){},setProperty:function(a,b){var c=
this._properties;null!=ea[a]?c.setReserved(a,b):c.h[a]=b},getProperty:function(a){var b=this._properties;return null!=ea[a]?b.getReserved(a):b.h[a]},hasProperty:function(a){var b=this._properties;return null!=ea[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},isMarkedForDeletion:function(){return this._isMarkedForDeletion},getName:function(){return this._name},setName:function(a){this._name=a},getInstanceId:function(){return this._instanceId},isActive:function(){return this._isActive},setActive:function(a){if(!this._isActive&&
a)this._isInitialized||this.init(),this.onActivate();else if(this._isActive&&!a)this.onDeactivate()},setUpdating:function(a){this._isUpdating=a},isUpdating:function(){return this._isUpdating},destroy:function(){this._isMarkedForDeletion=!0;this.setActive(!1)},onDestroy:function(){this.dispatchEvent(new gb("destroy"))},log:function(a){Fa.log(a)},__class__:L});var m=function(a){L.call(this);a.addComponent(this);this.setName(Wa.getClassName(y.getClass(this)))};m.__name__=["engine","Component"];m.__super__=
L;m.prototype=p(L.prototype,{getEntity:function(){return this._entity},setEntity:function(a){this._entity=a},getTags:function(){return this.getEntity().getTags()},addTag:function(a){this.getEntity().addTag(a)},hasTag:function(a){return this.getEntity().hasTag(a)},removeTag:function(a){this.getEntity().removeTag(a)},getComponent:function(a){return this.getEntity().getComponent(a)},getGameState:function(){return this.getEntity().getGameState()},destroy:function(){L.prototype.destroy.call(this)},addEntity:function(a){null==
a&&(a=!0);return this.getEntity().addEntity(a)},onPause:function(){},onResume:function(){},onDestroy:function(){L.prototype.onDestroy.call(this)},__class__:m});var dc=function(){this._prevScale=new F;this._prevRotation=new F;this._prevPosition=new F;this._cachedWorldScale=new F;this._cachedWorldRotation=new F;this._cachedWorldPosition=new F;this._isVisible=this._worldPositionDirty=this._worldRotationDirty=this._worldScaleDirty=!0;this._parent=null;L.call(this);this._components=[];this._children=[];
this._tags=[];this._transform=new Ac(this);this._transform.addEventListener("update",w(this,this.onTransformUpdate))};dc.__name__=["engine","Entity"];dc.instantiate=function(a){return a.addEntity()};dc.__super__=L;dc.prototype=p(L.prototype,{getTransform:function(){return this._transform},init:function(){L.prototype.init.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.init()}},getGameState:function(){return this._gameState},setGameState:function(a){this._gameState=
a},addTag:function(a){this._tags.push(a)},removeTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;this._tags[d]==a&&this._tags.splice(d,1)}},hasTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;if(this._tags[d]==a)return!0}return!1},getTags:function(){return this._tags},hasChild:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++;if(this._children[d]==a)return!0}return!1},removeChild:function(a,b){null==b&&(b=!1);for(var c=0,d=this._children.length;c<d;){var e=
c++,f=this._children[e];if(f==a){f.setParent(null,b);this._children.splice(e,1);break}}},addChild:function(a,b){null==b&&(b=!1);a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a,b);this._children.push(a);a.setParent(this,b)},insertChild:function(a,b){a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a);this._children.splice(b,0,a);a.setParent(this)},destroyAllChildren:function(){for(var a=0,
b=this._children.length;a<b;){var c=a++;this._children[c].destroy()}this._children=[]},getParent:function(){return this._parent},getRootEntity:function(){return null!=this.getParent()?this.getParent():this},setParent:function(a,b){null==b&&(b=!1);if(this._parent!=a){var c=this.getPosition(),d=this.getRotation(),e=this.getScale();this._parent=a;null!=this.getParent()?this.dispatchEvent(new T("addedToParent",{parent:this.getParent()})):this.dispatchEvent(new T("removedFromParent"));b&&(this.setPosition(c.x,
c.y,c.z),this.setRotation(d.x,d.y,d.z),this.setScale(e.z,e.y,e.z));this.dispatchEvent(new T("displayUpdate"));this.dispatchEvent(new T("parentUpdate"));c=0;for(d=this._children;c<d.length;)e=d[c],++c,e.dispatchEvent(new T("parentUpdate"));this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0}},setActive:function(a){L.prototype.setActive.call(this,a)},isActive:function(){return this._isActive},isActiveInHierarchy:function(){return null!=this.getParent()?this.isActive()?this.getParent().isActive():
!1:this._isActive},getChildren:function(a){null==a&&(a=!1);if(!a)return this._children;a=this._children;for(var b=[].concat(a),c=0,d=b.length;c<d;){var e=c++;a=a.concat(b[e].getChildren(!0))}return a},findChildByName:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++,d=this._children[d];if(d.getName()==a)return d;d=d.findChildByName(a);if(null!=d)return d}return null},isVisible:function(){return null!=this._parent?this._parent.isVisible()?this._isVisible:!1:this._isVisible},setVisible:function(a){(this._isVisible=
a)?this.dispatchEvent(new T("visibilityOn")):this.dispatchEvent(new T("visibilityOff"));this.dispatchEvent(new T("displayUpdate"))},onActivate:function(){L.prototype.onActivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].setActive(!0)}this.dispatchEvent(new T("displayUpdate"))},onDeactivate:function(){L.prototype.onDeactivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].setActive(!1)}this.dispatchEvent(new T("displayUpdate"))},
getPositionRef:function(){return this._transform.getPositionRef()},getPosition:function(){if(this._worldPositionDirty){this._cachedWorldPosition=this._transform.getPosition(S.World);this._worldPositionDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldPosition.getClone()},getLocalPosition:function(){return this._transform.getPosition(S.Local)},setLocalPosition:function(a,b,c){null==c&&(c=
0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new F(a,b,c),S.Local);this.dispatchEvent(new T("displayUpdate"))},setPosition:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new F(a,b,c),S.World);this.dispatchEvent(new T("displayUpdate"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.translate(a,b,c);this.dispatchEvent(new T("displayUpdate"))},getRotationRef:function(){return this._transform.getRotationRef()},
getRotation:function(){if(this._worldRotationDirty){this._cachedWorldRotation=this._transform.getRotation(S.World);this._worldRotationDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldRotation.getClone()},getLocalRotation:function(){return this._transform.getRotation(S.Local)},setLocalRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,
c,S.Local);this.dispatchEvent(new T("displayUpdate"))},setRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,c,S.World);this.dispatchEvent(new T("displayUpdate"))},setLocalRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(S.Local);this._transform.setRotation(b.x,b.z,a,S.Local);this.dispatchEvent(new T("displayUpdate"))},setRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(S.World);this._transform.setRotation(b.x,
b.z,a,S.World);this.dispatchEvent(new T("displayUpdate"))},rotate:function(a,b,c){this._transform.rotate(a,b,c)},rotate2d:function(a){this._transform.rotate(0,0,a)},getScaleRef:function(){return this._transform.getScaleRef()},getScale:function(){if(this._worldScaleDirty){this._cachedWorldScale=this._transform.getScale(S.World);this._worldScaleDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldScale.getClone()},
getLocalScale:function(){return this._transform.getScale(S.Local)},setScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,S.World);this.dispatchEvent(new T("displayUpdate"))},setLocalScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,S.Local);this.dispatchEvent(new T("displayUpdate"))},onPause:function(){for(var a=0,b=this._components.length;a<b;){var c=a++;this._components[c].onPause()}},onResume:function(){for(var a=
0,b=this._components.length;a<b;){var c=a++;this._components[c].onResume()}},update:function(){L.prototype.update.call(this);for(var a=this._components.length,b=a;0<b--;)a=this._components[b],a.isMarkedForDeletion()&&(a.onDestroy(),this._components.splice(b,1));a=this._components.length;for(b=0;b<a;){var c=b++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.update()}},fixedUpdate:function(){L.prototype.fixedUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];
c.isActive()&&c.fixedUpdate()}},render:function(){L.prototype.render.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.render()}},postUpdate:function(){L.prototype.postUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.postUpdate()}},debugRender:function(){L.prototype.debugRender.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&
c.debugRender()}a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ga.getDebugCamera()){var d=ga.getDebugCamera().getEntity(),b=ga.getDebugCamera().getZoomScale(),c=ga.getDebugCamera().getComponent(Bc),d=d.getPosition();a.translate(-d.x*b+c.getContainerOffset().x,-d.y*b+c.getContainerOffset().y);a.scale(b,b)}a.beginPath();a.globalAlpha=0.65;a.lineWidth=1;a.strokeStyle="#44FF44";b=this.getPosition();a.moveTo(b.x,b.y-10);a.lineTo(b.x,b.y+10);a.moveTo(b.x-10,b.y);
a.lineTo(b.x+10,b.y);a.moveTo(b.x-10,b.y-10);a.lineTo(b.x+10,b.y+10);a.moveTo(b.x+10,b.y-10);a.lineTo(b.x-10,b.y+10);a.stroke();a.restore();n.getInstance().getLayerByName("debug").setWholeCanvasDirty(!0)},addComponent:function(a){for(var b=0,c=this._components.length;b<c;){var d=b++;if(this._components[d]==a)return null}this._components.push(a);a.setEntity(this);return a},getComponent:function(a){for(var b=0,c=this._components.length;b<c;){var d=b++;if(y.__instanceof(this._components[d],a))return this._components[d]}return null},
getComponentsInChildren:function(a){var b=[],c=this.getComponents(a);null!=c&&(b=b.concat(c));for(var c=0,d=this._children.length;c<d;){var e=c++,e=this._children[e].getComponentsInChildren(a);null!=e&&(b=b.concat(e))}return b},getComponents:function(a){if(null==a)return this._components;for(var b=[],c=0,d=this._components.length;c<d;){var e=c++;y.__instanceof(this._components[e],a)&&b.push(this._components[e])}return 0<b.length?b:null},handleMessage:function(a,b){for(var c=this._components.length-
1;0<=c;){var d=this._components[c];d.isActive()&&d.handleMessage(a,b);--c}},isUpdating:function(){return null!=this._parent?this._isUpdating?this._parent.isUpdating():!1:this._isUpdating},destroy:function(){L.prototype.destroy.call(this);null!=this._gameState&&this._gameState.scheduleEntityForDeletion(this);for(var a=this._components.length;0<a--;){var b=this._components[a];b.destroy();b.onDestroy()}for(a=this._children.length;0<a--;)b=this._children[a],b.destroy(),b.onDestroy();null!=this.getParent()&&
this.getParent().removeChild(this)},addEntity:function(a){null==a&&(a=!0);var b=this.getGameState().addEntity();a&&this.addChild(b);return b},onTransformUpdate:function(){this.setTransformsDirty()},setTransformsDirty:function(){this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c.setTransformsDirty()}},onDestroy:function(){L.prototype.onDestroy.call(this)},__class__:dc});var I=function(){};I.__name__=["engine","GameConfig"];
I.getProperty=function(a,b){var c=I._properties;if(null!=ea[a]?!c.existsReserved(a):!c.h.hasOwnProperty(a))return b;c=I._properties;return null!=ea[a]?c.getReserved(a):c.h[a]};I.getBoolProperty=function(a){a=I.getProperty(a);return"TRUE"!=a.toUpperCase()?"1"==a:!0};I.setProperty=function(a,b){var c=I._properties,d=ra.string(b);null!=ea[a]?c.setReserved(a,d):c.h[a]=d};I.parseGameConfig=function(a){for(var b=0,c=ma.fields(a);b<c.length;){var d=c[b];++b;var e=I._properties,f=ma.field(a,d);null!=ea[d]?
e.setReserved(d,f):e.h[d]=f}};I.prototype={__class__:I};var R=function(){this._activeEntities=this._entitiesToDelete=null;this._isPaused=!1;this._elapsedTime=0;this._hasInitialized=!1;L.call(this);this._entities=[];this._activeEntities=[];this._entitiesToDelete=[];this._sceneRoot=this.addEntity()};R.__name__=["engine","GameState"];R.__super__=L;R.prototype=p(L.prototype,{getPaused:function(){return this._isPaused},init:function(){L.prototype.init.call(this)},getSceneRoot:function(){return this._sceneRoot},
update:function(){L.prototype.update.call(this);for(var a=this._entitiesToDelete.length,b=0,c=a;b<c;){var d=b++,d=this._entitiesToDelete[d];d.onDestroy();G.remove(this._entities,d)}Sb.clear(this._entitiesToDelete);b=0;if(!this._isPaused){Sb.clear(this._activeEntities);c=[].concat(this._entities);a=c.length;for(d=0;d<a;){var e=d++,e=c[e];null!=e&&e.isActiveInHierarchy()&&(this._activeEntities.push(e),++b,e.isUpdating()&&e.update())}this._elapsedTime+=n.getDeltaTime()}"1"==I.getProperty("debugCheats")&&
na.getInstance().isKeyPressed(105)&&(this.log(this._entities),this.log(this._activeEntities),H.outputAssets(),this.log("Active entities: "+b))},fixedUpdate:function(){L.prototype.fixedUpdate.call(this);if(!this._isPaused)for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isActiveInHierarchy()&&c.fixedUpdate()}},postUpdate:function(){L.prototype.postUpdate.call(this);if(!this._isPaused)for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];
c.isUpdating()&&c.isActiveInHierarchy()&&c.postUpdate()}},render:function(){L.prototype.render.call(this);for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isVisible()&&c.isActiveInHierarchy()&&c.render()}},debugRender:function(){L.prototype.debugRender.call(this);for(var a=0,b=this._entities.length;a<b;){var c=a++,c=this._entities[c];c.isActive()&&c.isVisible()&&c.debugRender()}},addEntity:function(a){null==a&&(a=new dc);a.setGameState(this);this._entities.push(a);
null!=this._sceneRoot&&this._sceneRoot.addChild(a);return a},removeEntity:function(a){G.remove(this._entities,a)},getHasEntity:function(a){return-1!=Sb.indexOf(this._entities,a)},getEntities:function(){return this._entities},findEntityByName:function(a){for(var b=0,c=this._entities.length;b<c;){var d=b++,d=this._entities[d];if(d.getName()==a)return d}return null},getEntitiesByTag:function(a,b){null==b&&(b=!0);for(var c=[],d=0,e=this._entities.length;d<e;){var f=d++,f=this._entities[f];(!b||f.isActiveInHierarchy())&&
f.hasTag(a)&&c.push(f)}return c},getClosestEntityToPointByTag:function(a,b,c){null==c&&(c=!0);b=this.getEntitiesByTag(b);for(var d=-1,e=null,f=0,g=b.length;f<g;){var k=f++,k=b[k];if(!c||k.isActiveInHierarchy()){var h=k.getPosition(),h=(new F(h.x-a.x,h.y-a.y,h.z-a.z)).getLength();if(-1==d||h<d)d=h,e=k}}return e},sortEntitiesByZ:function(){this._entities.sort(function(a,b){var c=a.getPosition(),d=b.getPosition();return c.z==d.z?a.getInstanceId()>b.getInstanceId()?1:-1:c.z<d.z?1:-1})},handleMessage:function(a,
b){L.prototype.handleMessage.call(this,a,b);if(!this._isPaused)for(var c=this._activeEntities.length-1;0<=c;)this._activeEntities[c].isActive()&&this._activeEntities[c].handleMessage(a,b),--c},pause:function(){this._isPaused=!0;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onPause()}},resume:function(){this._isPaused=!1;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onResume()}},bringEntityToFront:function(a,b){null==b&&(b=!1);G.remove(this._entities,
a)&&this._entities.push(a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.bringEntityToFront(c[f],!0)}},sendEntityToBack:function(a,b){null==b&&(b=!1);G.remove(this._entities,a)&&this._entities.splice(0,0,a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.sendEntityToBack(c[f],!0)}},insertEntityAfter:function(a,b){if(G.remove(this._entities,a)){var c=this._entities,d=Sb.indexOf(this._entities,b)+1;c.splice(d,0,a)}},scheduleEntityForDeletion:function(a){this._entitiesToDelete.push(a)},
destroy:function(){L.prototype.destroy.call(this);for(var a=this._entities.length-1;0<=a;)this._entities[a].destroy(),this._entities[a].onDestroy(),--a;this._isMarkedForDeletion=!0},__class__:R});var yf=function(){};yf.__name__=["engine","TimeService"];yf.prototype={__class__:yf,__properties__:{get_fixedIterationsThisFrame:"get_fixedIterationsThisFrame",get_realDeltaTime:"get_realDeltaTime",set_isFixedTimeStep:"set_isFixedTimeStep",get_isFixedTimeStep:"get_isFixedTimeStep",set_maxTimeStep:"set_maxTimeStep",
get_maxTimeStep:"get_maxTimeStep",set_fixedTimeStep:"set_fixedTimeStep",get_fixedTimeStep:"get_fixedTimeStep",set_timeScale:"set_timeScale",get_timeScale:"get_timeScale",get_deltaTime:"get_deltaTime"}};var fe=function(){this._timeScale=1;this._maxTimeStep=0.5;this._isFixedTimeStep=!1;this._remainderTimeStep=0;this._fixedTimeStep=0.016666666666666666;this._prevTimeStamp=this._currentTimeStamp=0;this.updateTimeStamp();this._prevTimeStamp=this._currentTimeStamp};fe.__name__=["engine","HaxeTimerTimeService"];
fe.__interfaces__=[yf];fe.prototype={get_deltaTime:function(){return this.get_isFixedTimeStep()?this.get_fixedTimeStep():Math.min(this.get_maxTimeStep(),this.get_realDeltaTime())*this.get_timeScale()},get_timeScale:function(){return this._timeScale},set_timeScale:function(a){return this._timeScale=a},get_fixedTimeStep:function(){return this._fixedTimeStep},set_fixedTimeStep:function(a){return this._fixedTimeStep=a},get_maxTimeStep:function(){return this._maxTimeStep},set_maxTimeStep:function(a){return this._maxTimeStep=
a},get_isFixedTimeStep:function(){return this._isFixedTimeStep},set_isFixedTimeStep:function(a){return this._isFixedTimeStep=a},get_realDeltaTime:function(){return this._currentTimeStamp-this._prevTimeStamp},get_fixedIterationsThisFrame:function(){var a=Math.min(this.get_maxTimeStep(),this.get_realDeltaTime()+this._remainderTimeStep),b=Math.floor(a/this.get_fixedTimeStep()),b=Math.max(1,b)|0;this._remainderTimeStep=a-b*this._fixedTimeStep;return b},update:function(){this.updateTimeStamp()},updateTimeStamp:function(){this._prevTimeStamp=
this._currentTimeStamp;this._currentTimeStamp=(new Date).getTime()/1E3},__class__:fe,__properties__:{get_fixedIterationsThisFrame:"get_fixedIterationsThisFrame",get_realDeltaTime:"get_realDeltaTime",set_isFixedTimeStep:"set_isFixedTimeStep",get_isFixedTimeStep:"get_isFixedTimeStep",set_maxTimeStep:"set_maxTimeStep",get_maxTimeStep:"get_maxTimeStep",set_fixedTimeStep:"set_fixedTimeStep",get_fixedTimeStep:"get_fixedTimeStep",set_timeScale:"set_timeScale",get_timeScale:"get_timeScale",get_deltaTime:"get_deltaTime"}};
var Cb=function(a,b,c,d,e){null==e&&(e=!1);this._context2d=null;this._wholeCanvasDirty=this._renderedThisFrame=!1;this._canvasWidth=this._canvasHeight=0;this._autoClear=!0;this._backgroundColor="#000000";L.call(this);this.setName(a);this._container=x.getContainer();this._canvas=x.getDocument().createElement("canvas");this._canvas.width=b;this._canvas.height=c;this._canvasWidth=b;this._canvasHeight=c;this._canvas.setAttribute("webkitTransform","translate3d(0px, 0px, 0px);");this._canvas.style.position=
"absolute";this._context2d=this._canvas.getContext("2d");e?(Cb._masterLayer=this,this._container.appendChild(this._canvas)):this._canvas.style.visibility="hidden"};Cb.__name__=["engine","Layer"];Cb.getMasterLayer=function(){return Cb._masterLayer};Cb.__super__=L;Cb.prototype=p(L.prototype,{getClearBounds:function(){return this._clearBounds},setClearBounds:function(a){this._clearBounds=a},getContext:function(){return this._context2d},getWholeCanvasDirty:function(){return this._wholeCanvasDirty},setWholeCanvasDirty:function(a){this._wholeCanvasDirty=
a;this._renderedThisFrame=!0},clear:function(a){null==a&&(a=!1);if(Cb._masterLayer!=this||a)a=this._canvas.getContext("2d"),null==this._clearBounds?a.clearRect(0,0,this._canvas.width,this._canvas.height):a.clearRect(this._clearBounds.ul.x,this._clearBounds.ul.y,this._clearBounds.wh.x,this._clearBounds.wh.y),this._wholeCanvasDirty=!1},render:function(){L.prototype.render.call(this);null==P.getInstance().getRenderer()||P.getInstance().getWebGlEnabled()||(P.getInstance().getRenderer().view.getContext("2d",
null).setTransform(1,0,0,1,0,0),P.getInstance().getRenderer().view.getContext("2d",null).drawImage(this._canvas,0,0,this._canvasWidth,this._canvasHeight))},getSize:function(){return new t(this._canvasWidth,this._canvasHeight)},setSize:function(a,b){this._canvasWidth=a;this._canvasHeight=b;this._canvas.width=a;this._canvas.height=b},update:function(){L.prototype.update.call(this);this._renderedThisFrame=!1},getMaskFunction:function(){return this._maskFunction},setMaskFunction:function(a){this._maskFunction=
a},getContainer:function(){return this._container},getCanvas:function(){return this._canvas},getAutoClear:function(){return this._autoClear},setAutoClear:function(a){this._autoClear=a},destroy:function(){L.prototype.destroy.call(this);null!=this.getCanvas().parentNode&&this.getCanvas().parentNode.removeChild(this.getCanvas())},__class__:Cb});var Cc=function(a){null==a&&(a=!1);this._currentRequestsActive=0;this._minLoadTimeElapsed=!1;this._currentAssetToLoad=0;this._loadCompleted=!1;this._assetsToLoad=
0;this._onCompleteCallback=null;this._assetLoadingInfo=[];a&&(this._minLoadTimeElapsed=!0)};Cc.__name__=["engine","LoadBatch"];Cc.prototype={getLoadComplete:function(){return this._loadCompleted},addAsset:function(a,b,c,d){this._assetLoadingInfo.push(new wf(a,b,c,!1,d))},getAssetLoadingInfoByAssetName:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=b++,d=this._assetLoadingInfo[d];if(d.name==a)return d}return null},numAssets:function(){return this._assetsToLoad},onAssetLoaded:function(a){this._assetsToLoad--;
this.checkAssetsLoaded();a=this._assetLoadingInfo.length-this._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this.loadNext()},onXmlHttpRequestLoaded:function(a){},checkAssetsLoaded:function(){if(!(0<this._currentRequestsActive)){var a=this._assetLoadingInfo.length-this._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this._loadCompleted||0<this._assetsToLoad||this.fireAllAssetsLoaded()}},
fireAllAssetsLoaded:function(){this._minLoadTimeElapsed&&(this._loadCompleted=!0,null!=this._onCompleteCallback&&this._onCompleteCallback())},load:function(a){this._onCompleteCallback=a;this._assetsToLoad=this._assetLoadingInfo.length;this._loadCompleted=!1;this._currentAssetToLoad=0;0==this._assetLoadingInfo.length?(a(),this._loadCompleted=!0):(this.loadNext(),n.getInstance().setDeferredActionsPaused(!1),n.getInstance().invokeAsyncDeferredAction(0.5,w(this,this.onMinLoadElapsed)))},unload:function(){for(var a=
0,b=this._assetLoadingInfo.length;a<b;){var c=a++;H.unloadAsset(this._assetLoadingInfo[c].name)}},loadNext:function(){var a=this;if(!(10<=this._currentRequestsActive||0>=this._assetsToLoad&&this._minLoadTimeElapsed)){for(var b=null;null==b&&0<this._assetsToLoad;)if(b=this._assetLoadingInfo[this._currentAssetToLoad++],null==b)this._assetsToLoad--,this.checkAssetsLoaded();else break;if(!(0>=this._assetsToLoad)){b.source=Da.replace(b.source,"${locale}",x.dataLocale);switch(b.type[1]){case 0:var c=x.getDocument().createElement("img");
H.registerAsset(b.name,c);this._currentRequestsActive++;var d=this;c.addEventListener("load",function(d){PIXI.Texture.addTextureToCache(PIXI.Texture.fromImage(c.src,!1,null!=b.options?b.options.scaleMode:PIXI.SCALE_MODES.DEFAULT),b.name);a._currentRequestsActive--;a.onAssetLoaded(d)});c.addEventListener("onerror",function(){d._assetsToLoad--;alert("file not found: "+b.source);a._currentRequestsActive--;d.checkAssetsLoaded();var c=d._assetLoadingInfo.length-d._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",
{progress:c,total:d._assetLoadingInfo.length});d.loadNext()});c.id=b.name;c.src=b.source;break;case 1:if(!n.isMobile()||q.isWebkitEnabled()||n.isCocoon()){var e=null,f=this;if(H.assetExists(b.name)){f._assetsToLoad--;f.checkAssetsLoaded();e=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:e,total:f._assetLoadingInfo.length});f.loadNext();return}var e=G.substr(b.source,b.source.length-3,3),g=-1<navigator.userAgent.toLowerCase().indexOf("firefox");
"mp3"==e&&g&&(b.source=Da.replace(b.source,"mp3","ogg"));if(!q.isWebkitEnabled()||g)e=document.createElement("audio"),e.src=b.source,e.preload=!0,e.autoplay=!1,e.id=b.name,this._currentRequestsActive++,e.addEventListener("canplay",function(){f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();var b=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:b,total:f._assetLoadingInfo.length});f.loadNext()},!1),e.addEventListener("onerror",
function(){f._assetsToLoad--;console.log("File not found: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("stalled",function(){f._assetsToLoad--;console.log("File not found: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",
{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("suspend",function(){f._assetsToLoad--;console.log("Loading suspended: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),H.registerAsset(b.name,e),e.load();else{var k=new XMLHttpRequest;k.open("GET",b.source,!0);k.responseType="arraybuffer";H.registerAsset(b.name+
"_src",b.source);this._currentRequestsActive++;k.onload=function(){q.getAudioContextInstance().decodeAudioData(k.response,function(c){H.registerAsset(b.name,c);f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()})};k.send()}}else H.registerAsset(b.name,b.source),this._assetsToLoad--,this.checkAssetsLoaded(),this.loadNext();break;case 2:var h=
new XMLHttpRequest,l=this;this._currentRequestsActive++;h.onload=function(){H.registerAsset(b.name,h.responseText);l._assetsToLoad--;a._currentRequestsActive--;l.checkAssetsLoaded();var c=l._assetLoadingInfo.length-l._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:l._assetLoadingInfo.length});l.loadNext()};h.onerror=function(){l._assetsToLoad--;alert("File not found: "+b.source);a._currentRequestsActive--;l.checkAssetsLoaded();l.loadNext()};h.open("GET",b.source,!0);
h.send();break;case 3:e=x.getDocument().createElement("script");e.type="text/javascript";e.async=!0;e.src=b.source;e.id=b.name;x.getDocument().body.appendChild(e);this._currentRequestsActive++;e.onload=function(){a._currentRequestsActive--;a.checkAssetsLoaded();a.loadNext()};break;case 4:e=x.getDocument().createElement("link");e.rel="stylesheet";e.type="text/css";e.href=b.source;e.id=b.name;x.getDocument().head.appendChild(e);this.checkAssetsLoaded();this.loadNext();break;case 5:e='<style type="text/css"> @font-face { font-family: \''+
b.name+"'; src: url('"+b.source+"'); } </style>",x.getDocument().head.innerHTML+=e,this.checkAssetsLoaded(),this.loadNext()}this.loadNext()}}},onMinLoadElapsed:function(){this._minLoadTimeElapsed=!0;this.checkAssetsLoaded()},concatLoadBatch:function(a){for(var b=0,c=a._assetLoadingInfo.length;b<c;){var d=b++,d=a._assetLoadingInfo[d];this.hasAsset(d.name)||this._assetLoadingInfo.push(d)}},hasAsset:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=b++;if(this._assetLoadingInfo[d].name==
a)return!0}return!1},__class__:Cc};var sa=function(){};sa.__name__=["engine","Localizer"];sa.initStrings=function(){if(!sa._isInitialized){var a=H.getAsset("strings"),a=C.parse(a);sa.stringsXml=a.elementsNamed("strings").next();sa._isInitialized=!0}};sa.getString=function(a){try{var b=sa.stringsXml.elementsNamed(a).next();if(b.nodeType!=C.Document&&b.nodeType!=C.Element)throw new K("Bad node type, expected Element or Document but found "+b.nodeType);var c=b.children[0];if(c.nodeType==C.Document||
c.nodeType==C.Element)throw new K("Bad node type, unexpected "+c.nodeType);return c.nodeValue}catch(d){throw new K("Could not find string: "+a);}};var U=function(){L.call(this)};U.__name__=["engine","Manager"];U.__super__=L;U.prototype=p(L.prototype,{__class__:U});var Db=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.ul=new t(a,b);this.wh=new t(c,d)};Db.__name__=["engine","Rect2D"];Db.prototype={getClone:function(){return new Db(this.ul.x,this.ul.y,this.wh.x,this.wh.y)},
getIntersect:function(a){return!(this.ul.x>a.ul.x+a.wh.x||this.ul.x+this.wh.x<a.ul.x||this.ul.y>a.ul.y+a.wh.y||this.ul.y+this.wh.y<a.ul.y)},containsPoint:function(a){return a.x>this.ul.x&&a.y>this.ul.y&&a.x<this.ul.x+this.wh.x?a.y<this.ul.y+this.wh.y:!1},__class__:Db};var n=function(a,b,c){this._iosAudioEnabled=!1;this._prevWidth=this._prevHeight=0;this._isUpdating=!0;this._hasFocus=!1;this._screenScale=null;this._isOrientationScreenShowing=!1;this._currentOrientation=0;this._isDeferredActionsPaused=
!1;this._gameStates=this._managers=this._layers=this._deferredActions=null;this._gameHeight=768;this._gameWidth=1024;this._gameId=a;this._gameWidth=b;this._gameHeight=c;this._screenScale=new t(1,1);this._gameStates=[];n._instance=this;this._layers=[];this._managers=[];this._deferredActions=[]};n.__name__=["engine","Root"];n.getTimeScale=function(){return n._timeService.get_timeScale()};n.setTimeScale=function(a){n._timeService.set_timeScale(a)};n.getDeltaTime=function(){return n._timeService.get_deltaTime()};
n.getRealDeltaTime=function(){return n._timeService.get_realDeltaTime()};n.getInstance=function(){return n._instance};n.isAppMode=function(){return window.isStandalone};n.isPhone=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("iphone")||-1!=navigator.userAgent.toLowerCase().indexOf("ipod")||-1!=navigator.userAgent.toLowerCase().indexOf("android")||-1!=navigator.userAgent.toLowerCase().indexOf("Linux")?!0:!1};n.isIOS=function(){x.getWindow();var a=x.getWindow().navigator.platform;return-1!=
a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")?!0:!1};n.isCocoon=function(){return!1};n.isMobile=function(){x.getWindow();var a=x.getWindow().navigator.platform;return-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")||-1!=a.indexOf("android")||-1!=a.indexOf("Linux")?!0:!1};n.isInternetExplorer=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("msie")};n.isFirefox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")};n.isSafari=
function(){return-1<navigator.userAgent.toLowerCase().indexOf("safari/")};n.getDevicePixelRatio=function(){return 1};n.prototype={getGameStates:function(){return this._gameStates},getLayers:function(){return this._layers},getGameWidth:function(){return this._gameWidth},setGameWidth:function(a){this._gameWidth=a},getGameHeight:function(){return this._gameHeight},setGameHeight:function(a){this._gameHeight=a},getGameId:function(){return this._gameId},init:function(){q.init();x.getContainer().focus();
for(var a=0,b=this._gameStates;a<b.length;){var c=b[a];++a;c.init()}this._prevWidth=x.getWindow().innerWidth;this._prevHeight=x.getWindow().innerHeight;a=window;a.addEventListener("orientationchange",w(this,this.onOrientationChange),!1);a.addEventListener("pageshow",w(this,this.onOrientationChange),!1);a.addEventListener("resize",w(this,this.onResizeWindow),!1);a.onfocus=w(this,this.onFocusGained);a.onblur=w(this,this.onFocusLost);window.document.addEventListener("webkitvisibilitychange",w(this,this.onWebkitVisibilityChange),
!1);a.addEventListener("pagehide",w(this,this.onFocusLost),!1);n.isMobile()&&n.isIOS()&&a.addEventListener("touchend",w(this,this.onIosTouchEnd),!1);if(n.isMobile())this.onOrientationChange();else this.setScreenScale(1,1)},update:function(){if(!this._hasFocus)this.onFocusGained();if(this._isUpdating){for(var a=0,b=this._managers.length,a=b;0<a--;)b=this._managers[a],b.isMarkedForDeletion()&&(b.onDestroy(),this._managers.splice(a,1));b=this._managers.length;for(a=0;a<b;){var c=a++,c=this._managers[c];
c.isActive()&&c.update()}q.update();for(a=b=this._gameStates.length;0<a--;)b=this._gameStates[a],b.isMarkedForDeletion()&&(b.onDestroy(),this._gameStates.splice(a,1));b=this._gameStates.length;for(a=0;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].update();for(a=this._layers.length;0<a--;)b=this._layers[a],b.isMarkedForDeletion()&&(b.onDestroy(),G.remove(this._layers,b));a=0;for(b=this._layers.length;a<b;)c=a++,this._layers[c].update()}if(!this._isDeferredActionsPaused)for(a=this._deferredActions.length;0<
a--;)b=this._deferredActions[a],null!=b&&(b.timeUntilExecute-=n.getDeltaTime(),0>=b.timeUntilExecute&&(b.params?b.actionToExecute(b.params):b.actionToExecute(),this._deferredActions.splice(a,1)))},fixedUpdate:function(){var a=n._timeService.get_fixedIterationsThisFrame();n._timeService.set_isFixedTimeStep(!0);for(var b=0;b<a;){b++;for(var c=0,d=this._managers.length;c<d;){var e=c++,e=this._managers[e];e.isActive()&&e.fixedUpdate()}c=0;for(d=this._gameStates.length;c<d;)e=c++,this._gameStates[e].isActive()&&
this._gameStates[e].fixedUpdate()}n._timeService.set_isFixedTimeStep(!1)},postUpdate:function(){for(var a=0,b=this._managers.length;a<b;){var c=a++,c=this._managers[c];c.isActive()&&c.postUpdate()}a=0;for(b=this._gameStates.length;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].postUpdate()},processFrame:function(){n._timeService.update();this.fixedUpdate();this.update();this.render();this.postUpdate()},updateDivClass:function(){var a="container";1==this._currentOrientation&&(a+=" portrait");
x.getContainer().className=a},render:function(){for(var a=this._layers.length,b=0;b<a;){var c=b++,c=this._layers[c];c.getAutoClear()&&c.getWholeCanvasDirty()&&c.clear()}b=0;for(a=this._gameStates.length;b<a;)c=b++,this._gameStates[c].isActive()&&this._gameStates[c].render();b=0;for(a=this._managers.length;b<a;)c=b++,this._managers[c].isActive()&&this._managers[c].render();a=this._layers.length;for(b=0;b<a;)c=b++,c=this._layers[c],"debug"!=c.getName()&&c.render()},debugRender:function(){for(var a=
0,b=this._gameStates.length;a<b;){var c=a++;this._gameStates[c].debugRender()}a=0;for(b=this._managers.length;a<b;)c=a++,this._managers[c].debugRender();a=0;for(b=this._layers.length;a<b;)c=a++,c=this._layers[c],"debug"==c.getName()&&c.render(),c.debugRender()},addGameState:function(a){0<=this._gameStates.indexOf(a)&&(G.remove(this._gameStates,a),this._gameStates.push(a));for(var b=0,c=this._gameStates.length;b<c;){var d=b++;if(a==this._gameStates[d])return a}this._gameStates.push(a);return a},removeGameState:function(a){a.destroy()},
addManager:function(a){this._managers.push(a);a.init()},removeManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++;if(this._managers[d]==a){this._managers.splice(d,1);a.destroy();break}}},getManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++;if(y.__instanceof(this._managers[d],a))return this._managers[d]}return null},setDeferredActionsPaused:function(a){this._isDeferredActionsPaused=a},destroyAllDeferredActions:function(){this._deferredActions=[]},switchToGameState:function(a,
b){null!=a&&this.removeGameState(a);null!=b&&this.addGameState(b)},addLayer:function(a,b){null==b&&(b=!1);b?this._layers.splice(0,0,a):this._layers.push(a)},insertLayerAfter:function(a,b){var c=this._layers,d=this._layers.indexOf(b)+1;c.splice(d,0,a)},removeLayer:function(a){a.destroy();G.remove(this._layers,a)},getLayerByName:function(a){for(var b=0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.getName()==a)return d}return null},sendGlobalMessage:function(a,b){for(var c=this._managers.length-
1;0<=c;)this._managers[c].handleMessage(a,b),--c;for(c=this._gameStates.length-1;0<=c;)this._gameStates[c].handleMessage(a,b),--c},invokeAsyncDeferredAction:function(a,b,c){a=new ge(a,b,c);this._deferredActions.push(a);return a},destroyDeferredAction:function(a){G.remove(this._deferredActions,a)},onOrientationChange:function(){var a=this;this.invokeAsyncDeferredAction(0.35,function(){var b=!1,b=n.isMobile()?x.getWindow().innerWidth>x.getWindow().innerHeight:!0;"HORIZONTAL"==I.getProperty("forceOrientation")?
(a._currentOrientation=0,b=!0):"VERTICAL"==I.getProperty("forceOrientation")?(a._currentOrientation=1,b=!1):a._currentOrientation=b?0:1;a.onResizeWindow();a.sendGlobalMessage("onOrientationChanged",{isHorizontal:b})})},setScreenScale:function(a,b){this.updateDivClass();this._screenScale.x=a;this._screenScale.y=b;this.onScreenScaleUpdated()},getScreenScale:function(){return null!=P.getInstance()&&null!=P.getInstance().getStage()?new t(P.getInstance().getStage().scale.x,P.getInstance().getStage().scale.y):
new t(1,1)},getGameSize:function(){return new t(this._gameWidth,this._gameHeight)},getScreenOffset:function(){var a=x.getWindow().innerWidth,b=x.getWindow().innerHeight;return new t(Math.max(0,a/2-this._gameWidth*P.getInstance().getStage().scale.x/P.getInstance().devicePixelRatio/2),Math.max(0,b/2-this._gameHeight*P.getInstance().getStage().scale.y/P.getInstance().devicePixelRatio/2))},getCurrentOrientation:function(){return this._currentOrientation},onWebkitVisibilityChange:function(){if(x.getDocument().webkitHidden)this.onFocusLost();
else this.onFocusGained()},onFocusGained:function(){this._hasFocus||(na.getInstance().disablePageKeyPresses(),q.resumeAllSounds(),this._isUpdating=this._hasFocus=!0,this.sendGlobalMessage("onFocusGained"))},onFocusLost:function(){q.pauseAllSounds();this._hasFocus&&(na.getInstance().enablePageKeyPresses(),this._isUpdating=this._hasFocus=!1,this.sendGlobalMessage("onFocusLost"))},onResizeWindow:function(){var a=1,b=a,b="1"==I.getProperty("scaleToScreenOnDesktop");P.getInstance().shouldDesktopExpandToScreen=
b;n.isMobile()||b?(b=x.getWindow(),b=a=Math.min(b.innerHeight/this._gameHeight,b.innerWidth/this._gameWidth)):a=b=1;this.sendGlobalMessage("onResizedWindow");this.setScreenScale(b,a)},onScreenScaleUpdated:function(){x.getWindow();x.getWindow();x.getContainer();n.getDevicePixelRatio();n.isMobile()&&this.hideAddressBar();this.sendGlobalMessage("onScreenScaleUpdated")},stopUpdates:function(){this._isUpdating=!1},resumeUpdates:function(){this._isUpdating=!0},hideAddressBar:function(){if(n.isPhone()&&
!window.location.hash){var a=window.outerHeight;document.height<a&&(document.body.style.height=a+50+"px");setTimeout(function(){window.scrollTo(0,1)},50)}},requestFullscreen:function(){if(!n.isIOS()){var a=window.document,b=a.documentElement,c=b.requestFullscreen||b.mozRequestFullScreen||b.webkitRequestFullScreen||b.msRequestFullscreen;a.fullscreenElement||(a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement)||c.call(b)}},onIosTouchEnd:function(){if(!1==this._iosAudioEnabled)try{var a=
q.getAudioContextInstance(),b=a.createBuffer(1,1,22050),c=a.createBufferSource();c.buffer=b;c.connect(a.destination);c.start(0);this._iosAudioEnabled=!0;Fa.log("Audio enabled for iOS")}catch(d){Fa.log("error")}},__class__:n};var zf=function(){this._data={};this.load()};zf.__name__=["engine","SaveData"];zf.prototype={setItem:function(a,b){this._data[a]=b;this.save()},getItem:function(a,b){if(Object.prototype.hasOwnProperty.call(this._data,a))return ma.field(this._data,a);this.setItem(a,b);return b},
save:function(){var a=n.getInstance().getGameId()+"Data";if(null!=Za.getSessionStorage())try{Za.getSessionStorage().setItem(a,JSON.stringify(this._data))}catch(b){Fa.log("Error saving to session storage")}if(null!=Za.getLocalStorage())try{Za.getLocalStorage().setItem(a,JSON.stringify(this._data))}catch(c){Fa.log("Error saving to local storage")}},load:function(){var a=n.getInstance().getGameId()+"Data";if(null!=Za.getSessionStorage()||null!=Za.getLocalStorage()){var b=null;try{b=Za.getSessionStorage().getItem(a)}catch(c){Fa.log("Failed to get item from session storage")}if(null==
b)try{b=Za.getLocalStorage().getItem(a)}catch(d){Fa.log("Failed to get item from session storage")}null!=b&&(this._data=JSON.parse(b))}},deleteAllSaveData:function(){this._data={};this.save()},__class__:zf};var t=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=this.y=0;this.x=a;this.y=b};t.__name__=["engine","Vector2"];t.prototype={getClone:function(){return new t(this.x,this.y)},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},scaleBy:function(a,b){this.x*=a;this.y*=b},dotProduct:function(a){return this.x*
a.x+this.y*a.y},getNormalized:function(){var a=this.getLength();return new t(this.x/a,this.y/a)},__class__:t};var F=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=this.y=this.z=0;this.x=a;this.y=b;this.z=c};F.__name__=["engine","Vector3"];F.lerp=function(a,b,c){return new F(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c,a.z+(b.z-a.z)*c)};F.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};F.prototype={add:function(a){return new F(this.x+a.x,this.y+a.y,this.z+a.z)},subtract:function(a){return new F(this.x-
a.x,this.y-a.y,this.z-a.z)},scaleBy:function(a){this.x*=a;this.y*=a;this.z*=a},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},getClone:function(){return new F(this.x,this.y,this.z)},getNormalized:function(){var a=this.getLength();return new F(this.x/a,this.y/a,this.z/a)},__class__:F};var ba=function(a,b,c){this._isMuted=!1;this._currentTime=0;this._isInitialized=!1;this._soundName=a;this._volume=b;this._loop=c;this.init()};ba.__name__=["engine","audio","SoundData"];
ba.prototype={init:function(){this._isInitialized=!0},play:function(a){},resume:function(){},update:function(){this._currentTime+=n.getDeltaTime()},pause:function(){},stop:function(){q.removeSoundFromPlayingSounds(this)},getVolume:function(){return this._volume},setVolume:function(a){this._volume=a},getMuted:function(){return this._isMuted},setMuted:function(a){this._isMuted=a},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getSoundLength:function(){return 1},getCurrentTime:function(){return this._currentTime},
setCurrentTime:function(a){this._currentTime=a},getSoundName:function(){return this._soundName},__class__:ba};var $c=function(a,b,c){ba.call(this,a,b,c)};$c.__name__=["engine","audio","FlashSoundData"];$c.__super__=ba;$c.prototype=p(ba.prototype,{init:function(){ba.prototype.init.call(this);this._audio=soundManager.createSound({id:this._soundName});this._audio.setVolume(100*this._volume)},play:function(a){null==a&&(a=0);ba.prototype.play.call(this,a);var b=this;this._audio.play({onfinish:function(){b._loop&&
b.play(0);q.removeSoundFromPlayingSounds(b)},onstop:function(){q.removeSoundFromPlayingSounds(b)}})},pause:function(){ba.prototype.pause.call(this);this._audio.pause()},stop:function(){ba.prototype.stop.call(this);this._audio.stop()},resume:function(){ba.prototype.resume.call(this);this._audio.resume()},setVolume:function(a){ba.prototype.setVolume.call(this,a);this._audio.setVolume(100*a)},__class__:$c});var ad=function(a,b,c){ba.call(this,a,b,c)};ad.__name__=["engine","audio","Html5SoundData"];ad.__super__=
ba;ad.prototype=p(ba.prototype,{init:function(){ba.prototype.init.call(this)},play:function(a){null==a&&(a=0);var b=this;ba.prototype.play.call(this,a);this._audio=H.getAsset(this._soundName);0!=a&&this._audio.addEventListener("canplay",function(c){b._audio.currentTime=a});this._audio.play();this._audio.addEventListener("ended",w(this,this.onSoundComplete),!1);this._audio.loop=this._loop;this._audio.volume=this._volume},resume:function(){ba.prototype.resume.call(this);this._audio.play()},pause:function(){ba.prototype.pause.call(this);
this._audio.pause()},stop:function(){ba.prototype.stop.call(this);this._audio.pause()},onSoundComplete:function(a){q.removeSoundFromPlayingSounds(this)},setVolume:function(a){ba.prototype.setVolume.call(this,a);this._audio.volume=a},setMuted:function(a){ba.prototype.setMuted.call(this,a);this._audio.muted=a},getCurrentTime:function(){return this._audio.currentTime},setCurrentTime:function(a){this._audio.currentTime=a},__class__:ad});var q=function(){};q.__name__=["engine","audio","SoundManager"];
q.getMusicTrack=function(){return q._musicTrack};q.init=function(){try{q._audioContext=new AudioContext,q._isWebkitEnabled=!n.isFirefox()&&null!=q._audioContext}catch(a){if(n.isInternetExplorer())try{soundManager.setup({url:"soundmanager2_flash9.swf",flashVersion:9,onready:q.onSoundManagerReady,ontimeout:q.onSoundManagerTimeout,useHighPerformance:!0})}catch(b){q._useFlashSound=!1}}q._musicTrack=new bd(null)};q.onSoundManagerReady=function(){q._useFlashSound=!0==soundManager.html5.usingFlash};q.onSoundManagerTimeout=
function(){q._useFlashSound=!1==soundManager.html5.usingFlash};q.getAudioContextInstance=function(){return q._audioContext};q.isWebkitEnabled=function(){return q._isWebkitEnabled?!q._useFlashSound:!1};q.setWebkitEnabled=function(a){q._isWebkitEnabled=a};q.isMusicMuted=function(){return q._musicMuted};q.setMusicMuted=function(a){q._musicMuted=a;null!=q._musicTrack.get()&&q._musicTrack.get().setMuted(a);q.isWebkitEnabled()||(n.isMobile()&&a?q._musicTrack.get().pause():n.isMobile()&&!a&&q._musicTrack.get().play())};
q.isSoundMuted=function(){return q._soundMuted};q.setSoundMuted=function(a){q._soundMuted=a;for(var b=0,c=q._soundsPlaying.length;b<c;){var d=b++;q._soundsPlaying[d].setMuted(a)}};q.getMasterVolume=function(){return q._masterVolume};q.setMasterVolume=function(a){q._masterVolume=a;q.setMusicVolume(q._musicVolume);q.setSoundVolume(q._soundVolume)};q.getMusicVolume=function(){return q._musicVolume};q.setMusicVolume=function(a){q._musicVolume=a;null!=q._musicTrack&&null!=q._musicTrack.get()&&q._musicTrack.get().setVolume(q.getMusicVolume()*
q.getMasterVolume())};q.getSoundVolume=function(){return q._soundVolume};q.setSoundVolume=function(a){q._soundVolume=a;a=0;for(var b=q._soundsPlaying.length;a<b;){var c=a++;q._soundsPlaying[c].setVolume(q.getSoundVolume()*q.getMasterVolume())}};q.playRandomSoundByName=function(a,b,c,d){null==d&&(d=1);null==c&&(c=!1);null==b&&(b=!1);return q.playSoundByName(a[V.randomInt(0,a.length)],b,c,d)};q.playSoundByName=function(a,b,c,d){null==d&&(d=1);null==c&&(c=!1);null==b&&(b=!1);if(!q.isWebkitEnabled()&&
n.isMobile()&&!b||!H.assetExists(a))return null;a=q.isWebkitEnabled()?new cd(a,q.getSoundVolume()*q.getMasterVolume()*d,c):q.getUseFlashSound()?new $c(a,q.getMasterVolume()*q.getSoundVolume()*d,c):new ad(a,q.getSoundVolume()*q.getMasterVolume()*d,c);a.play();a.setMuted(q._soundMuted);q._soundsPlaying.push(a);return a};q.update=function(){for(var a=0,b=q._soundsPlaying.length;a<b;){var c=a++,c=q._soundsPlaying[c];null==c?q.removeSoundFromPlayingSounds(c):c.update()}null!=q._musicTrack.get()&&q._musicTrack.get().update()};
q.onSoundComplete=function(a){q.removeSoundFromPlayingSounds(a.currentTarget)};q.removeSoundFromPlayingSounds=function(a){G.remove(q._soundsPlaying,a)};q.addSoundToPlayingSounds=function(a){q._soundsPlaying.push(a)};q.isSoundPlaying=function(a){return-1!=q._soundsPlaying.indexOf(a)};q.pauseAllSounds=function(){null!=q._musicTrack.get()&&q._musicTrack.get().pause();for(var a=0,b=q._soundsPlaying.length;a<b;){var c=a++,c=q._soundsPlaying[c];null!=c&&c.pause()}};q.resumeAllSounds=function(){for(var a=
q._soundsPlaying.length,b=[].concat(q._soundsPlaying),c=0;c<a;){var d=c++;b[d].resume()}null!=q._musicTrack.get()&&(q._musicTrack.get().pause(),q._musicTrack.get().resume())};q.playMusicByNameOnMobileOnly=function(a){return n.isMobile()?q.playMusicByName(a,!0):null};q.playMusicByName=function(a,b){null==b&&(b=!0);if(n.isMobile()&&!b)return null;if(!H.assetExists(a))return Fa.log(a+" doesn't exist!"),null;if(null!=q._musicTrack.get()){if(q._musicTrack.get().getSoundName()==a)return q._musicTrack.get();
q._musicTrack.get().stop()}var c;c=q.isWebkitEnabled()?new cd(a,q.getMasterVolume()*q.getMusicVolume(),!0):q._useFlashSound?new $c(a,q.getMusicVolume()*q.getMasterVolume(),!0):new ad(a,q.getMasterVolume()*q.getMusicVolume(),!0);c.play(0);q._musicTrack.set(c);q.setMusicVolume(q._musicVolume);q._musicTrack.get().setMuted(q._musicMuted);return q._musicTrack.get()};q.stopMusic=function(){null!=q._musicTrack.get()&&(q._musicTrack.get().stop(),q._musicTrack=new bd(null))};q.stopAllSounds=function(){for(var a=
q._soundsPlaying.length-1;0<=a;){var b=q._soundsPlaying[a];null!=b&&b.stop();q.removeSoundFromPlayingSounds(b);--a}q._soundsPlaying=[]};q.getUseFlashSound=function(){return q._useFlashSound};q.prototype={__class__:q};var cd=function(a,b,c){null==c&&(c=!1);null==b&&(b=1);this._audio=null;ba.call(this,a,b,c)};cd.__name__=["engine","audio","WebkitSoundData"];cd.__super__=ba;cd.prototype=p(ba.prototype,{init:function(){ba.prototype.init.call(this);this._audioContext=q.getAudioContextInstance();this._audio=
this._audioContext.createBufferSource();this._audio.buffer=H.getAsset(this._soundName);this._gainNode=null!=(hb=this._audioContext,w(hb,hb.createGain))?this._audioContext.createGain():this._audioContext.createGainNode();this._audio.connect(this._gainNode,0,0);this._gainNode.connect(this._audioContext.destination,0,0);this._audio.loop=this._loop;this._audio.id=this._soundName;this.setVolume(this._volume)},play:function(a){null==a&&(a=0);ba.prototype.play.call(this,a);this._currentTime=a;try{null!=
(hb=this._audio,w(hb,hb.start))?this._audio.start(this._audioContext.currentTime,a):0==a?this._audio.noteOn():this._audio.noteGrainOn(this._audioContext.currentTime,a)}catch(b){this._audio.noteOn(this._audioContext.currentTime,a,this._audio.buffer.duration-a)}},pause:function(){ba.prototype.pause.call(this);if(!(null==this._audio||null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop())){if(null!=(hb=this._audio,w(hb,hb.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}q.removeSoundFromPlayingSounds(this)}},
resume:function(){ba.prototype.resume.call(this);null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop()||(this.stop(),this.init(),this.play(this._currentTime),q.addSoundToPlayingSounds(this))},stop:function(){ba.prototype.stop.call(this);if(null!=this._audio){if(null!=(hb=this._audio,w(hb,hb.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}this._audio=null;
q.removeSoundFromPlayingSounds(this)}},getSoundLength:function(){return this._audio.buffer.duration},update:function(){ba.prototype.update.call(this);this.getCurrentTime()>this.getSoundLength()&&!this.getLoop()?q.removeSoundFromPlayingSounds(this):this.getCurrentTime()>this.getSoundLength()&&(this._currentTime-=this.getSoundLength())},onSoundComplete:function(){},setCurrentTime:function(a){ba.prototype.setCurrentTime.call(this,a);this.stop();this.init();this.play(a)},setVolume:function(a){ba.prototype.setVolume.call(this,
a);if(null!=this._audio||null!=this._gainNode)this._gainNode.gain.value=this._isMuted?0:a},setMuted:function(a){ba.prototype.setMuted.call(this,a);this._gainNode.gain.value=this._isMuted?0:this._volume},__class__:cd});var he=function(){};he.__name__=["engine","box2d","Box2dContactListener"];he.__super__=fb;he.prototype=p(fb.prototype,{beginContact:function(a){fb.prototype.beginContact.call(this,a);var b=a.getFixtureA().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Eb("beginContact",
{contact:a})));b=a.getFixtureB().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Eb("beginContact",{contact:a})))},endContact:function(a){fb.prototype.endContact.call(this,a);var b=a.getFixtureA().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Eb("endContact",{contact:a})));b=a.getFixtureB().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Eb("endContact",{contact:a})))},preSolve:function(a,b){fb.prototype.preSolve.call(this,
a,b)},postSolve:function(a,b){fb.prototype.postSolve.call(this,a,b)},__class__:he});var Q=function(a){this._type=a};Q.__name__=["engine","events","Event"];Q.prototype={getType:function(){return this._type},__class__:Q};var Eb=function(a,b){this._data=null;this._type=a;this._data=b};Eb.__name__=["engine","box2d","Box2dEvent"];Eb.__super__=Q;Eb.prototype=p(Q.prototype,{getData:function(){return this._data},setData:function(a){this._data=a},__class__:Eb});var dd=function(a,b){null==b&&(b="debug");this._debugLayerName=
"";this._physicsScale=0.03333333333333333;this._positionIterations=2;this._velocityIterations=6;this._b2World=this._gravity=null;L.call(this);null==a&&(a=new t(0,0));this._gravity=new s(a.x,a.y);this._debugLayerName=b;this._b2World=new Z(this._gravity,!1)};dd.__name__=["engine","box2d","Box2dManager"];dd.__super__=U;dd.prototype=p(U.prototype,{get_velocityIterations:function(){return this._velocityIterations},set_velocityIterations:function(a){return this._velocityIterations=a},get_positionIterations:function(){return this._positionIterations},
set_positionIterations:function(a){return this._positionIterations=a},init:function(){U.prototype.init.call(this);this._debugDrawLayer=n.getInstance().getLayerByName(this._debugLayerName);this._debugDraw=new za;this._debugDraw.setSprite(this._debugDrawLayer.getCanvas().getContext("2d"));this._debugDraw.setDrawScale(30);this._debugDraw.setLineThickness(1);this._debugDraw.setAlpha(0.5);this._debugDraw.setFillAlpha(0.1);this._debugDraw.setFlags(za.e_shapeBit|za.e_jointBit|za.e_centerOfMassBit);this._b2World.setDebugDraw(this._debugDraw);
this._b2World.setContactListener(new he)},getB2World:function(){return this._b2World},getGravity:function(){return this._gravity},setGravity:function(a){this._gravity=a;this._b2World.setGravity(a);return a},getPhysicsScale:function(){return this._physicsScale},getInversePhysicsScale:function(){return 1/this._physicsScale},setPhysicsScale:function(a){this._physicsScale=a},update:function(){U.prototype.update.call(this);this.dispatchEvent(new ec("preUpdate"));for(var a=0,b=Math.max(1,Math.floor(n.getDeltaTime()/
0.016666666666666666));a<b;)a++,this._b2World.step(0.016666666666666666,this._velocityIterations,this._positionIterations),this._b2World.clearForces();this.dispatchEvent(new ec("update"))},getPixelToWorld:function(a,b){return new s(a*this._physicsScale,b*this._physicsScale)},getWorldToPixel:function(a,b){return new t(a/this._physicsScale,b/this._physicsScale)},debugRender:function(){U.prototype.debugRender.call(this);this._b2World.drawDebugData();this._debugDrawLayer.setWholeCanvasDirty(!0)},__class__:dd,
__properties__:{set_positionIterations:"set_positionIterations",get_positionIterations:"get_positionIterations",set_velocityIterations:"set_velocityIterations",get_velocityIterations:"get_velocityIterations"}});var ec=function(a){this._type=a};ec.__name__=["engine","box2d","Box2dManagerEvent"];ec.__super__=Q;ec.prototype=p(Q.prototype,{__class__:ec});var pa=function(a,b,c){this._loop=!0;this._length=0;this._name=a;this._animationKeyframes=[];null!=b&&(this._length=b);this._offset=new t};pa.__name__=
["engine","components","Animation"];pa.parseFromXmlString=function(a,b){for(var c=C.parse(b),d=c.elementsNamed("animation").next().get("name"),d=new pa(d,c.elementsNamed("animation").next().get("length")),c=c.elementsNamed("animation").next().elementsNamed("keyframe");c.hasNext();){var e=c.next(),e=new ie(e.get("index"),e.get("spriteIndex"),a);d.addKeyframe(e)}Ia.getInstance().registerAnimation(d);return d};pa.makeLinearAnimationFromSheetBySpriteName=function(a,b,c,d,e,f,g){null==g&&(g=0);null==f&&
(f=-1);null==e&&(e=!1);var k=Pa.getInstance().getSpriteSheetByName(b),h=k.getNumSprites();-1==f&&(f=h);for(var l=0,m=0,u=f;m<u;){var p=m++;Da.startsWith(k.getSpriteInfoByIndex(p).getName(),c)&&++l}a=new pa(a,l*d);for(m=l=0;m<h&&!(u=m++,Da.startsWith(k.getSpriteInfoByIndex(u).getName(),c)&&(u=new ie(g,u,b),a.addKeyframe(u),g+=d,++l,l>=f)););a.setLoop(e);Ia.getInstance().registerAnimation(a);return a};pa.createAnimation=function(a,b,c,d,e){null==e&&(e=!0);null==d&&(d=1);null==Ia.getInstance().getAnimationByName(a)&&
(fc.parseFromXmlString(a,a,H.getAsset(b)),pa.makeLinearAnimationFromSheetBySpriteName(a,a,"",d,e).setOffset(c.x,c.y))};pa.appendAnimation=function(a,b,c,d,e){null==e&&(e=1);if(null==Ia.getInstance().getAnimationByName(b))for(a=Ia.getInstance().getAnimationByName(a),fc.parseFromXmlString(b,b,H.getAsset(c)),b=pa.makeLinearAnimationFromSheetBySpriteName("tempAnim",b,"",e,!1,-1,a.getKeyframeLength()),b.setOffset(d.x,d.y),d=b.getAnimationKeyframes(),b=0,c=d.length;b<c;)e=b++,a.addKeyframe(d[e])};pa.prototype=
{getAnimationKeyframes:function(){return this._animationKeyframes},getKeyframeLength:function(){return this._length},getLength:function(){return this._length/30},getName:function(){return this._name},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getOffset:function(){return this._offset},setOffset:function(a,b){this._offset.x=a;this._offset.y=b},addKeyframe:function(a){this._animationKeyframes.push(a);var b=a.getPosition();this._length=Math.max(this._length,a.getPosition());
b>this._length&&(this._length=b)},getSpriteIndexAtPosition:function(a){for(var b=this._animationKeyframes.length,c=this._animationKeyframes[0].getSpriteIndex(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/30)c=this._animationKeyframes[e].getSpriteIndex();else break}return c},getSpriteSheetNameAtPosition:function(a){for(var b=this._animationKeyframes.length,c=this._animationKeyframes[0].getSpriteSheetName(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/
30)c=this._animationKeyframes[e].getSpriteSheetName();else break}return c},__class__:pa};var ha=function(a,b,c,d,e){this.handPointer=!0;this._inactiveOneFrame=!1;this._killMessageOnMouseDown=!0;this._isMouseOver=!1;this._onClicked=this._onMouseDown=this._onMouseUp=this._onMouseMoved=this._onMouseOver=this._onMouseOut=null;m.call(this,a);this._boxCollision=new Xa;this._collisionSize=b;this._collisionOffset=c;this._camera=e;this.setOnMouseDown(d)};ha.__name__=["engine","components","Button"];ha.createFromHTMLElement=
function(a){return new ha(a.getEntity(),a.getSize(),new t(0,0))};ha.createFromHTMLElementID=function(a,b,c){null==c&&(c=0);b=x.getDocument().getElementById(b);var d=b.clientWidth+c,e=b.clientHeight+c;return new ha(a,new t(d,e),new t(b.offsetLeft-a.getPosition().x-c/2+d/2,b.offsetTop-a.getPosition().y-c/2+e/2))};ha.createFromEdgeHTMLElementID=function(a,b,c,d){null==d&&(d=0);var e=x.getDocument().getElementById(b);b=ra.parseInt(e.style.width)+d;var f=ra.parseInt(e.style.height)+d,g=cb.getStylePositionOfDomElement(e).y-
d/2;d=cb.getStylePositionOfDomElement(e).x-d/2;return new ha(a,new t(b,f),new t(d-a.getPosition().x+b/2,g-a.getPosition().y+f/2),c)};ha.createFromPixiSprite=function(a){return new ha(a.getEntity(),new t(a.getSprite().texture.width,a.getSprite().texture.height),null)};ha.__super__=m;ha.prototype=p(m.prototype,{setOnClicked:function(a){this._onClicked=a},setOnMouseDown:function(a){this._onMouseDown=a},setOnMouseMoved:function(a){this._onMouseMoved=a},setOnMouseUp:function(a){this._onMouseUp=a},setOnMouseOut:function(a){this._onMouseOut=
a},getKillMessageOnMouseDown:function(){return this._killMessageOnMouseDown},setKillMessageOnMouseDown:function(a){this._killMessageOnMouseDown=a},getData:function(){return this._data},getCollisionSize:function(){return this._collisionSize},setData:function(a){this._data=a},init:function(){m.prototype.init.call(this);this._prevPosition=new t(this.getEntity().getPosition().x,this.getEntity().getPosition().y);this.updateCollision()},update:function(){m.prototype.update.call(this);this._inactiveOneFrame=
!1;!1==this.getEntity().isVisible()&&(this._inactiveOneFrame=!0);if(this._isMouseOver&&this.isButtonDisabledByButtonGroup(this.getEntity()))this.onMouseOut(na.getInstance().getMousePosition());this.updateCollision()},setOffset:function(a,b){this._collisionOffset=new t(a,b)},getOffset:function(){return this._collisionOffset},updateCollision:function(){var a=this.getEntity().getPosition();this._boxCollision.ul.x=a.x-this._collisionSize.x/2;this._boxCollision.ul.y=a.y-this._collisionSize.y/2;this._boxCollision.wh.x=
this._collisionSize.x;this._boxCollision.wh.y=this._collisionSize.y;null!=this._collisionOffset&&(this._boxCollision.ul.x+=this._collisionOffset.x,this._boxCollision.ul.y+=this._collisionOffset.y)},onMouseClick:function(a){a=a.getClone();a.x>n.getInstance().getGameSize().x||(0>a.x||a.y>n.getInstance().getGameSize().y||0>a.y)||(null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/
this._camera.getZoomScale(),1/this._camera.getZoomScale())),this._boxCollision.checkPointIntersect(a)&&(this.getEntity().dispatchEvent(new T("mouseClick",{button:this,entity:this.getEntity()})),null!=this._onClicked&&this._onClicked(this)))},onMouseDown:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));
return this._boxCollision.checkPointIntersect(a)?(this.getEntity().dispatchEvent(new T("mouseDown",{button:this,entity:this.getEntity()})),null!=this._onMouseDown&&this._onMouseDown(this),n.isMobile()&&(this._isMouseOver=!0),!0):!1},onMouseMoved:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));
if(this._boxCollision.checkPointIntersect(a)){this.getEntity().dispatchEvent(new T("mouseOver",{button:this,entity:this.getEntity()}));if(!this._isMouseOver)this.onMouseOver(a);this._isMouseOver=!0;this.getEntity().dispatchEvent(new T("mouseMove",{button:this,entity:this.getEntity()}));null!=this._onMouseMoved&&this._onMouseMoved(this)}else this._isMouseOver&&(this.onMouseOut(a),this._isMouseOver=!1)},onMouseUp:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*
this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));this._boxCollision.checkPointIntersect(a)&&(this.getEntity().dispatchEvent(new T("mouseUp",{button:this,entity:this.getEntity()})),null!=this._onMouseUp&&this._onMouseUp(this))},onMouseOver:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*
this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));this.handPointer&&(x.getDocument().body.style.cursor="pointer");this.getEntity().dispatchEvent(new T("mouseOver",{button:this,entity:this.getEntity()}));null!=this._onMouseOver&&this._onMouseOver(this);this._isMouseOver=!0},onMouseOut:function(a){null!=a&&(a=a.getClone(),null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*
this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale())),this.handPointer&&(x.getDocument().body.style.cursor="default"),this.getEntity().dispatchEvent(new T("mouseOut",{button:this,entity:this.getEntity()})),null!=this._onMouseOut&&this._onMouseOut(this),this._isMouseOver=!1)},verifyTouches:function(a){var b=!1;if(null!=a&&null!=a.touches){for(var c=0,d=a.touches.length;c<d;){var e=c++,f=a.touches[e],g=n.getInstance().getScreenOffset(),e=(f.pageX-g.x)/n.getInstance().getScreenScale().x,
f=(f.pageY-g.y)/n.getInstance().getScreenScale().y;this._boxCollision.checkPointIntersect(new t(e,f))&&(b=!0)}if(!b&&this._isMouseOver)this.onMouseOut(null);else if(b&&!this._isMouseOver)this.onMouseOver(null)}},setCollisionProperties:function(a,b){this._collisionSize=a;this._collisionOffset=b},isButtonDisabledByButtonGroup:function(a){var b=a.getComponent(gc);if(null!=b&&!b.isInputEnabled())return!0;a=a.getParent();return null!=a?this.isButtonDisabledByButtonGroup(a):!1},handleMessage:function(a,
b){m.prototype.handleMessage.call(this,a,b);if(!(b&&b.isDisabled||!this.getEntity().isVisible()||!this.isActive()||this.isButtonDisabledByButtonGroup(this.getEntity())||this._inactiveOneFrame))switch(a){case "mouseClick":this.onMouseClick(b);break;case "mouseDown":this.onMouseDown(b)&&this._killMessageOnMouseDown&&(b.isDisabled=!0);break;case "mouseMove":this.onMouseMoved(b);break;case "mouseUp":this.onMouseUp(b);break;case "verifyTouches":this.verifyTouches(b)}},onActivate:function(){m.prototype.onActivate.call(this);
this._inactiveOneFrame=!0},onDeactivate:function(){m.prototype.onDeactivate.call(this);this._isMouseOver&&this.handPointer&&(x.getDocument().body.style.cursor="default")},debugRender:function(){m.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ga.getDebugCamera()){var b=ga.getDebugCamera().getEntity();a.translate(-b.getPosition().x,-b.getPosition().y)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._boxCollision.ul.x,
this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,this._boxCollision.ul.y+this._boxCollision.wh.y);a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y+this._boxCollision.wh.y);a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y);a.stroke();a.restore()},destroy:function(){m.prototype.destroy.call(this);if(this._isMouseOver)this.onMouseOut(null)},__class__:ha});var ga=function(a){this._offset=
null;this._zoomScale=1;this._target=this._cameraBounds=this._slackMovement=null;m.call(this,a);this._offset=new t;this._lensWidth=n.getInstance().getGameSize().x;this._lensHeight=n.getInstance().getGameSize().y;null==ga._debugCamera&&(ga._debugCamera=this)};ga.__name__=["engine","components","Camera"];ga.getDebugCamera=function(){return ga._debugCamera};ga.__super__=m;ga.prototype=p(m.prototype,{getTarget:function(){return this._target},setTarget:function(a){null!=this._target&&this._target.removeEventListener("destroy",
w(this,this.onTargetDestroy));this._target=a;null!=this._target&&this._target.addEventListener("destroy",w(this,this.onTargetDestroy))},setOffset:function(a){this._offset=a},getOffset:function(){return this._offset},getZoomScale:function(){return this._zoomScale},setZoomScale:function(a){this._zoomScale=a},getLensSize:function(){return new t(this._lensWidth,this._lensHeight)},setLensSize:function(a,b){this._lensWidth=a;this._lensHeight=b},init:function(){m.prototype.init.call(this);this._slackMovement=
this.getComponent(ed)},getSlackMovement:function(){return this._slackMovement},jumpToTarget:function(){null!=this._target&&this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z)},getCenter:function(){var a=this.getEntity().getPosition();return new F(a.x-this._lensWidth/this._zoomScale/2,a.y-this._lensHeight/
this._zoomScale/2,a.z)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);null!=this._target&&(null==this._slackMovement?this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z):this._slackMovement.setTarget(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,
this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z));this.updateCameraBounds()},updateCameraBounds:function(){if(null!=this._cameraBounds){var a=this.getEntity().getPosition().getClone(),b=this._lensWidth/2/this._zoomScale,c=this._lensHeight/2/this._zoomScale,d=new t(a.x+b,a.y+c),e=!1;d.x-b<this._cameraBounds.ul.x&&(d.x=this._cameraBounds.ul.x+b,e=!0);d.y-c<this._cameraBounds.ul.y&&(d.y=this._cameraBounds.ul.y+c,e=!0);d.x+
b>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(d.x=this._cameraBounds.ul.x+this._cameraBounds.wh.x-b,e=!0);d.y+c>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(d.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-c,e=!0);a.x=d.x-b;a.y=d.y-c;e&&this.getEntity().setLocalPosition(a.x,a.y,a.z)}},getPointConstrainedToCameraBounds:function(a,b){if(null!=this._cameraBounds){var c=new F(a,b),d=this._lensWidth/2/this._zoomScale,e=this._lensHeight/2/this._zoomScale,f=new t(a,b);f.x-d<this._cameraBounds.ul.x&&
(f.x=this._cameraBounds.ul.x+d);f.y-e<this._cameraBounds.ul.y&&(f.y=this._cameraBounds.ul.y+e);f.x+d>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(f.x=this._cameraBounds.ul.x+this._cameraBounds.wh.x-d);c.y+e>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(f.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-e);a=f.x;b=f.y}return new t(a,b)},getBounds:function(){return this._cameraBounds},setBounds:function(a,b,c,d){this._cameraBounds=new Db(a,b,c-a,d-b)},getViewBounds:function(){var a=this.getEntity().getPosition();
return new Db(a.x,a.y,2*(this._lensWidth/2/this._zoomScale),2*(this._lensHeight/2/this._zoomScale))},destroyBounds:function(){this._cameraBounds=null},destroy:function(){m.prototype.destroy.call(this);ga._debugCamera==this&&(ga._debugCamera=null)},onTargetDestroy:function(){this.setTarget(null)},__class__:ga});var Tb=function(a,b){this._offset=this._onEnter=this._onInside=this._onExit=null;m.call(this,a);this._offset=b};Tb.__name__=["engine","components","Collider"];Tb.__super__=m;Tb.prototype=p(m.prototype,
{init:function(){m.prototype.init.call(this);db.getInstance().registerCollider(this)},getCollision:function(){return null},checkPointIntersect:function(a){return!1},update:function(){m.prototype.update.call(this)},getRaycastPoint:function(a,b,c,d,e){db.getInstance().dispatchEvent(new fd("raycastCheck",a,b));return-1},debugRender:function(){m.prototype.debugRender.call(this)},setOnEnter:function(a){this._onEnter=a},setOnExit:function(a){this._onExit=a},setOnInside:function(a){this._onInside=a},onEnter:function(a){this._isActive&&
null!=this._onEnter&&this._onEnter(a,this)},onInside:function(a){this._isActive&&null!=this._onInside&&this._onInside(a,this)},onExit:function(a){this._isActive&&null!=this._onExit&&this._onExit(a,this)},onDestroy:function(){m.prototype.onDestroy.call(this);db.getInstance().removeCollider(this)},__class__:Tb});var ge=function(a,b,c,d){null==d&&(d=!1);this.isPaused=this.repeating=!1;this.timeUntilExecute=a;this.actionToExecute=b;this.params=c;this.repeating=d;this.duration=a};ge.__name__=["engine",
"components","DeferredAction"];ge.prototype={update:function(){this.isPaused||(this.timeUntilExecute-=n.getDeltaTime())},__class__:ge};var Fb=function(a){m.call(this,a);this._deferredActions=[]};Fb.__name__=["engine","components","DeferredActionController"];Fb.addDeferredActionToTarget=function(a,b,c,d){var e=a.getComponent(Fb);null==e&&(e=new Fb(a));e.addDeferredAction(b,c,d);return e};Fb.__super__=m;Fb.prototype=p(m.prototype,{update:function(){m.prototype.update.call(this);for(var a=this._deferredActions.length-
1;0<=a;){var b=this._deferredActions[a];null==b?G.remove(this._deferredActions,b):(b.update(),0>=b.timeUntilExecute&&(b.actionToExecute(b.params),b.repeating?b.timeUntilExecute=b.duration:G.remove(this._deferredActions,b)),--a,a>this._deferredActions.length-1&&(a=this._deferredActions.length-1))}},addDeferredAction:function(a,b,c){a=new ge(a,b,c);this._deferredActions.push(a);return a},removeDeferredAction:function(a){G.remove(this._deferredActions,a)},destroyAllDeferredActions:function(){this._deferredActions=
[]},__class__:Fb});var Af=function(a,b,c,d){this._context=this._image=this._cachedSize=this._clipRect=null;this._forceRenderRequired=!1;this._skew=this._rotation=this._spriteInfo=this._coords=null;this._alpha=1;this._maskFunction=null;this._imageName="";this.IsLargeImage=!1;m.call(this,a);this._imageName=b;this._layer=c;this._cameraPositionScale=new t(1,1);this._pivotPoint=new t;this._camera=d;this._offset=new t;this._scale=new F(1,1,1);this._skew=new t;this._rotation=new F(0,0,0);this._clipRect=
null};Af.__name__=["engine","components","GameImage"];Af.__super__=m;Af.prototype=p(m.prototype,{getClipRect:function(){return this._clipRect},setClipRect:function(a){1>a.wh.x&&(a.wh.x=1);1>a.wh.y&&(a.wh.y=1);this._clipRect=a},getCamera:function(){return this._camera},setCamera:function(a){this._camera=a},getCoords:function(){return this._coords},setCoords:function(a){this._coords=a},getRotation:function(){return this._rotation},setRotation:function(a){this._rotation=a},setSpriteInfo:function(a){this._spriteInfo=
a},setImage:function(a){H.assetExists(a)&&""!=a&&(this._imageName=a,this._image=this.getImageAsset(),this._cachedSize=null)},getImageAsset:function(){return H.getAsset(this._imageName)},getSkew:function(){return this._skew},setSkew:function(a,b){this._skew=new t(a,b)},setSource:function(a){this._imageName=a},getOffset:function(){return this._offset},setOffset:function(a,b){this._offset=new t(a,b)},centerOffsetOnEntity:function(){if(""!=this._imageName){var a=this.getSize(),a=null!=this._spriteInfo?
new t(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new t(this._image.width,this._image.height);this.setOffset(-a.x/2,-a.y/2)}},setOffsetBasedOnPivotPoint:function(a,b){var c=this.getSize(),c=null!=this._spriteInfo?new t(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new t(this._image.width,this._image.height);this.setOffset(-(c.x*a),-(c.y*(1-b)))},getAlpha:function(){return this._alpha},setAlpha:function(a){this._alpha=a},getPivotPoint:function(){return this._pivotPoint},
setPivotPoint:function(a,b){this._pivotPoint=new t(a,b)},getLayer:function(){return this._layer},setLayer:function(a){this._layer=a;this._context=null},getImageName:function(){return this._imageName},getSize:function(){if(null!=this._cachedSize)return this._cachedSize;null==this._image&&(this._image=this.getImageAsset());var a=this.getEntity().getScale();return null!=this._spriteInfo?this._cachedSize=new t(this._spriteInfo.getCoords().wh.x*Math.abs(a.x*this._scale.x),this._spriteInfo.getCoords().wh.y*
Math.abs(a.y*this._scale.y)):""==this._imageName?new t(0,0):this._cachedSize=new t(this._image.width*Math.abs(a.x*this._scale.x),this._image.height*Math.abs(a.y*this._scale.y))},getMaskFunction:function(){return this._maskFunction},setMaskFunction:function(a){this._maskFunction=a},setScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._scale=new F(a,b,c)},getScale:function(){return this._scale},getCameraPositionScale:function(){return this._cameraPositionScale},setCameraPositionScale:function(a){this._cameraPositionScale=
a},render:function(){m.prototype.render.call(this);if(0!=this._alpha&&(""!=this._imageName||null!=this._spriteInfo)){var a=this.getEntity(),b=a.getPosition(),c=1,d=new t(0,0),e=new t(1,1);null!=this._camera&&(d=this._camera.getEntity(),c=this._camera.getZoomScale(),d=d.getPosition(),d=new t(-(d.x/this._cameraPositionScale.x)*e.x,-(d.y/this._cameraPositionScale.y)*e.y),d.scaleBy(c,c));null==this._context&&(this._context=this._layer.getCanvas().getContext("2d"));this._context.save();null!=this._maskFunction&&
(this._context.translate(d.x/e.x*c,d.y/e.y*c),this._maskFunction(this._context,this),this._context.clip(),this._context.translate(-d.x*e.x*c,-d.y*e.y*c));var f=a.getScale().getClone();f.x*=this._scale.x;f.y*=this._scale.y;this._context.setTransform(1,this._skew.x/f.x,this._skew.y/f.y,1,Math.floor(b.x*e.x*c+d.x)*n.getDevicePixelRatio(),Math.floor(b.y*e.y*c+d.y)*n.getDevicePixelRatio());0!=a.getRotation().z+this._rotation.z&&this._context.rotate(V.degToRad(a.getRotation().z+this._rotation.z));this._context.scale(f.x*
c,f.y*c);a=this._offset.getClone();null!=this._spriteInfo&&(a.x+=this._spriteInfo.getOffset().x,a.y+=this._spriteInfo.getOffset().y);this._context.translate(Math.floor(a.x*e.x)*n.getDevicePixelRatio(),Math.floor(a.y*e.y)*n.getDevicePixelRatio());this._context.globalAlpha=this._alpha;this._context.scale(e.x*n.getDevicePixelRatio(),e.y*n.getDevicePixelRatio());null==this._spriteInfo&&null==this._coords?(null==this._image&&(this._image=this.getImageAsset()),null==this._clipRect?this._context.drawImage(this._image,
0,0):(this._clipRect.ul.x=Math.max(0,this._clipRect.ul.x),this._clipRect.ul.y=Math.max(0,this._clipRect.ul.y),this._context.drawImage(this._image,this._clipRect.ul.x,this._clipRect.ul.y,this._clipRect.wh.x,this._clipRect.wh.y,0,0,this._clipRect.wh.x*e.x*n.getDevicePixelRatio(),this._clipRect.wh.y*e.y*n.getDevicePixelRatio()))):null==this._spriteInfo&&null!=this._coords?(null==this._image&&(this._image=H.getAsset(this._imageName)),this._context.drawImage(this._image,this._coords.ul.x,this._coords.ul.y,
this._coords.wh.x,this._coords.wh.y,0,0,this._coords.wh.x,this._coords.wh.y)):(e=this._spriteInfo.getCoords(),a=Pa.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName()),null==this._image&&(this._image=H.getAsset(a.getImageName())),this._context.drawImage(a.getImage(),e.ul.x,e.ul.y,e.wh.x,e.wh.y,0,0,e.wh.x,e.wh.y));this._layer.setWholeCanvasDirty(!0);this._context.restore()}},quickRender:function(){m.prototype.render.call(this);new t(1,1);this._context=this._layer.getCanvas().getContext("2d");
null!=this._maskFunction&&(this._maskFunction(this._context,this),this._context.clip());this._context.scale(this._scale.x,this._scale.y);this._context.rotate(this._rotation.z);if(null==this._spriteInfo&&null==this._coords)null==this._image&&(this._image=H.getAsset(this._imageName));else if(null==this._spriteInfo&&null!=this._coords)null==this._image&&(this._image=H.getAsset(this._imageName)),this._context.drawImage(this._image,Math.floor(this._coords.ul.x),Math.floor(this._coords.ul.y),Math.floor(this._coords.wh.x),
Math.floor(this._coords.wh.y),this._offset.x,this._offset.y,Math.floor(this._coords.wh.x)+2,Math.floor(this._coords.wh.y)+2);else{var a=this._spriteInfo.getCoords(),b=Pa.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName());null==this._image&&(this._image=H.getAsset(b.getImageName()));this._context.drawImage(this._image,a.ul.x,a.ul.y,a.wh.x,a.wh.y,this._offset.x,this._offset.y,a.wh.x,a.wh.y)}this._context.rotate(-this._rotation.z);this._context.scale(1/this._scale.x,this._scale.y);
this._layer.setWholeCanvasDirty(!0)},destroy:function(){m.prototype.destroy.call(this)},onDestroy:function(){m.prototype.onDestroy.call(this);this._camera=null},__class__:Af});var cb=function(a,b,c,d){null==d&&(d="");null==c&&(c="");this._alwaysUpdatePosition=!1;this._className="";this._div=null;this._isDirty=!0;m.call(this,a);this._html=c;this._className=d;this._layer=b;this.updateHtml()};cb.__name__=["engine","components","HtmlElements"];cb.showElementById=function(a,b){null==b&&(b=!0);var c=cb.getChildDivById(x.getContainer(),
a);null!=c?c.style.display=b?"block":"none":Fa.log("Could not find element with id of "+a+" to "+(b?"show":"hide"))};cb.getStylePositionOfDomElement=function(a){for(var b=ra.parseInt(a.style.top),c=ra.parseInt(a.style.left);;)if(null!=a.parentNode&&Object.prototype.hasOwnProperty.call(a.parentNode,"style")&&"layer"!=a.parentElement.className)b+=ra.parseInt(a.parentElement.style.top),c+=ra.parseInt(a.parentElement.style.left),a=a.parentElement;else break;return new t(c,b)};cb.setElementTextById=function(a,
b){var c=x.getDocument().getElementById(a);null==c?Fa.log("Could not find '"+a+"' on the page!"):c.innerHTML=b};cb.getChildDivById=function(a,b){for(var c=0,d=a.children.length;c<d;){var e=c++,e=a.children[e];if(e.id==b||e.hasChildNodes()&&(e=cb.getChildDivById(e,b),null!=e))return e}return null};cb.__super__=m;cb.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this.getEntity().addEventListener("displayUpdate",w(this,this.onDisplayUpdated))},getChildElementById:function(a){return x.getDocument().getElementById(a)},
setChildElementTextById:function(a,b){var c=cb.getChildDivById(this.getDiv(),a);null!=c&&(c.innerHTML=b);this._html=this.getDiv().innerHTML},getDiv:function(){null==this._div&&this._isDirty&&this.updateHtml();return this._div},update:function(){m.prototype.update.call(this);null!=this._div&&this._isDirty&&this.updateHtml();null!=this._div&&this._alwaysUpdatePosition&&this.updatePosition();var a=this.getEntity().isVisible()?"block":"none";this._div.style.display=a},updateHtml:function(){Fa.log("updateHtml");
null!=this._div&&null!=this._div.parentNode&&this._div.parentNode.removeChild(this._div);this._isDirty=!1;this._div=x.getDocument().createElement("div");this._div.className=this._className;this._div.innerHTML=this._html;this._div.style.position="absolute";var a="translate(0, 0px) scale("+this.getEntity().getScale().x*n.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*n.getInstance().getScreenScale().y;this._div.style.webkitTransform=a+")";a="translate(0, 0px) scale("+this.getEntity().getScale().x*
n.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*n.getInstance().getScreenScale().y;this._div.style.transform=a+")";this._layer.getContainer().appendChild(this._div);this.updatePosition()},updatePosition:function(){var a=this.getEntity().getPosition().x*n.getInstance().getScreenScale().x;this._div.style.left=a-(this._center?this._div.clientWidth/2:0)+"px";a=this.getEntity().getPosition().y*n.getInstance().getScreenScale().y;this._div.style.top=a-(this._center?this._div.clientHeight/
2:0)+"px"},setId:function(a){null==this._div&&this._isDirty&&this.updateHtml();this._id=a;this._div.id=a},getId:function(){return this._id},getHtml:function(){return this._html},setHtml:function(a){this._html=a},setClassName:function(a){this._className=a},getClassName:function(){return this._className},addClassName:function(a){this._className=0<this._className.length?this._className+(" "+a):a},removeClassName:function(a){this._className=Da.replace(this._className,a,"")},forceUpdateNextFrame:function(){this._html=
this._div.innerHTML},centerOnEntity:function(a){null==a&&(a=!0);this._center=a;this.updatePosition()},getSize:function(){return new t(this._div.clientWidth*n.getInstance().getScreenScale().y,this._div.clientHeight*n.getInstance().getScreenScale().y)},destroy:function(){m.prototype.destroy.call(this);null!=this._div.parentNode&&this._layer.getContainer().removeChild(this._div)},handleMessage:function(a,b){m.prototype.handleMessage.call(this,a,b)},onDisplayUpdated:function(){},alwaysUpdatePosition:function(a){null==
a&&(a=!0);this._alwaysUpdatePosition=a},__class__:cb});var Dc=function(a,b,c,d,e,f,g,k,h){null==h&&(h=0);null==k&&(k=0);null==g&&(g=!1);this._magnitudeDecayRate=0;this._half=!1;this._propertyName="";this._target=null;this._theta=this._rate=this._base=this._magnitude=0;m.call(this,a);this._base=d;this._magnitude=e;this._rate=f;this._propertyName=c;this._target=b;this._half=g;this._theta=k;this._magnitudeDecayRate=h};Dc.__name__=["engine","components","PropertyOscillator"];Dc.__super__=m;Dc.prototype=
p(m.prototype,{getTheta:function(){return this._theta},setTheta:function(a){this._theta=a},getMagnitude:function(){return this._magnitude},setMagnitude:function(a){this._magnitude=a},getMagnitudeDecayRate:function(){return this._magnitudeDecayRate},setMagnitudeDecayRate:function(a){this._magnitudeDecayRate=a},getBase:function(){return this._base},setBase:function(a){this._base=a},update:function(){m.prototype.update.call(this);if(0<this._magnitude){this._magnitude-=this._magnitudeDecayRate*n.getDeltaTime();
0>this._magnitude&&(this._magnitude=0);this._theta+=this._rate*n.getDeltaTime();this._theta>=(this._half?Math.PI:2*Math.PI)&&(this._theta-=this._half?Math.PI:2*Math.PI);var a=this._base+Math.sin(this._theta)*this._magnitude;ma.setProperty(this._target,this._propertyName,a)}},__class__:Dc});var ed=function(a,b){null==b&&(b=0.5);this._slack=1;this._targetPosition=null;m.call(this,a);this._slack=b};ed.__name__=["engine","components","SlackMovement"];ed.__super__=m;ed.prototype=p(m.prototype,{getSlack:function(){return this._slack},
setSlack:function(a){this._slack=a},update:function(){m.prototype.update.call(this);if(null!=this._targetPosition){var a=this._targetPosition.subtract(this.getEntity().getPosition()),b=a.getLength();0!=b&&(a=a.getNormalized(),a.scaleBy(b*this._slack),5E-5>a.x&&-5E-5<a.x&&(a.x=0),5E-5>a.y&&-5E-5<a.y&&(a.y=0),5E-5>a.z&&-5E-5<a.z&&(a.z=0),b=this.getEntity().getPosition(),this.getEntity().setLocalPosition(b.x+a.x,b.y+a.y,b.z+a.z))}},getTarget:function(){return this._targetPosition},setTarget:function(a,
b,c){this._targetPosition=new F(a,b,c)},__class__:ed});var S={__ename__:!0,__constructs__:["Local","World"],Local:["Local",0]};S.Local.__enum__=S;S.World=["World",1];S.World.__enum__=S;S.__empty_constructs__=[S.Local,S.World];var Ac=function(a){m.call(this,a);this._localPosition=new F;this._localRotation=new F;this._localScale=new F(1,1,1)};Ac.__name__=["engine","components","Transform"];Ac.getIdentity=function(){return window.glMatrix.mat4.identity(window.glMatrix.mat4.create())};Ac.__super__=m;
Ac.prototype=p(m.prototype,{getParent:function(){return null!=this.getEntity().getParent()?this.getEntity().getParent().getTransform():null},getPositionRef:function(){return this._localPosition},getRotationRef:function(){return this._localRotation},getScaleRef:function(){return this._localScale},getPosition:function(a){if(a==S.Local)return this._localPosition.getClone();a=window.glMatrix.mat4.identity(window.glMatrix.mat4.create());for(var b=this;null!=b;){var c=window.glMatrix.mat4.create(),d=b.getRotation(S.Local),
e=b.getPosition(S.Local),f=b.getScale(S.Local),c=window.glMatrix.mat4.fromRotationTranslationScale(c,window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),d.x,d.y,d.z),window.glMatrix.vec3.fromValues(e.x,e.y,e.z),window.glMatrix.vec3.fromValues(f.x,f.y,f.z));window.glMatrix.mat4.multiply(a,c,a);b=b.getParent()}b=window.glMatrix.vec3.create();window.glMatrix.vec3.transformMat4(b,b,a);return new F(b[0],b[1],b[1])},setPosition:function(a,b){switch(b[1]){case 0:this._localPosition.x=a.x;this._localPosition.y=
a.y;this._localPosition.z=a.z;break;case 1:if(this._localPosition.x=a.x,this._localPosition.y=a.y,this._localPosition.z=a.z,null!=this.getParent()){for(var c=Ac.getIdentity(),d=this.getParent();null!=d;){var e=d.getRotation(S.Local),f=d.getPosition(S.Local),g=d.getScale(S.Local),e=window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),e.x,e.y,e.z),f=window.glMatrix.vec3.fromValues(f.x,f.y,f.z),g=window.glMatrix.vec3.fromValues(g.x,g.y,g.z),k=window.glMatrix.mat4.create(),k=window.glMatrix.mat4.fromRotationTranslationScale(k,
e,f,g);window.glMatrix.mat4.multiply(c,k,c);d=d.getParent()}c=window.glMatrix.mat4.invert(window.glMatrix.mat4.create(),c);d=window.glMatrix.vec3.fromValues(this._localPosition.x,this._localPosition.y,this._localPosition.z);d=window.glMatrix.vec3.transformMat4(d,d,c);this._localPosition.x=d[0];this._localPosition.y=d[1];this._localPosition.z=d[2]}else this.setPosition(this._localPosition,S.Local)}this.dispatchEvent(new tb("update"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&
(a=0);this._localPosition.x+=a;this._localPosition.y+=b;this._localPosition.z+=c;this.dispatchEvent(new tb("update"))},getScale:function(a){if(a==S.Local)return this._localScale.getClone();a=new F(1,1,1);for(var b=this;null!=b;)a.x*=b.getScale(S.Local).x,a.y*=b.getScale(S.Local).y,a.z*=b.getScale(S.Local).z,b=b.getParent();return a},setScale:function(a,b,c,d){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);switch(d[1]){case 0:this._localScale.x=a;this._localScale.y=b;this._localScale.z=c;break;case 1:for(this._localScale.x=
a,this._localScale.y=b,this._localScale.z=c,a=this.getEntity().getParent();null!=a;)this._localScale.x/=a.getTransform().getScale(S.Local).x,this._localScale.y/=a.getTransform().getScale(S.Local).y,this._localScale.z/=a.getTransform().getScale(S.Local).z,a=a.getParent()}this.dispatchEvent(new tb("update"))},scale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._localScale.x*=a;this._localScale.y*=b;this._localScale.z*=c;this.dispatchEvent(new tb("update"))},getRotation:function(a){if(a==
S.Local)return this._localRotation.getClone();a=new F;for(var b=this;null!=b;)a.x+=b.getRotation(S.Local).x,a.y+=b.getRotation(S.Local).y,a.z+=b.getRotation(S.Local).z,b=b.getParent();return a},setRotation:function(a,b,c,d){switch(d[1]){case 0:this._localRotation.x=a;this._localRotation.y=b;this._localRotation.z=c;break;case 1:null!=this.getParent()&&(this._localRotation.x=a,this._localRotation.y=b,this._localRotation.z=c,this._localRotation.x-=this.getParent().getRotation(d).x,this._localRotation.y-=
this.getParent().getRotation(d).y,this._localRotation.z-=this.getParent().getRotation(d).z)}this.dispatchEvent(new tb("update"))},rotate:function(a,b,c){this._localRotation.x+=a;this._localRotation.y+=b;this._localRotation.z+=c;this.dispatchEvent(new tb("update"))},__class__:Ac});var tb=function(a){this._type=a};tb.__name__=["engine","components","TransformEvent"];tb.__super__=Q;tb.prototype=p(Q.prototype,{__class__:tb});var Aa=function(a){this._tweens=null;m.call(this,a);this._tweens=[]};Aa.__name__=
["engine","components","Tweener"];Aa.addTweenToTarget=function(a,b,c,d,e,f,g,k,h,l){null==k&&(k=0);var m=a.getComponent(Aa);null==m&&(m=new Aa(a));m.addTween(b,c,d,e,f,g,k,h,l);return m};Aa.__super__=m;Aa.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this)},addTween:function(a,b,c,d,e,f,g,k,h){null==g&&(g=0);a=new Bf(a,b,c,d,e,f,g,k,h);this._tweens.push(a);return a},skipAll:function(){for(var a=0,b=this._tweens.length;a<b;){var c=a++;this._tweens[c].skip()}},destroyTween:function(a){G.remove(this._tweens,
a)},destroyAllTweens:function(){this._tweens=[]},update:function(){m.prototype.update.call(this);for(var a=this._tweens.length-1;0<=a;){var b=this._tweens[a];b.update(n.getDeltaTime());this.getEntity().setTransformsDirty();b._isCompleted&&this._tweens.splice(a,1);--a}},__class__:Aa});var hc=function(a,b){this._velocity=this._angularVelocity=this._gravity=null;m.call(this,a);this._velocity=new F;this._angularVelocity=new F;null!=b&&(this._gravity=b.getClone())};hc.__name__=["engine","components","VelocityController"];
hc.__super__=m;hc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);null!=this._gravity&&(this._velocity.x+=this._gravity.x*n.getDeltaTime(),this._velocity.y+=this._gravity.y*n.getDeltaTime(),this._velocity.z+=this._gravity.z*n.getDeltaTime());var a=this._velocity.getClone();a.scaleBy(n.getDeltaTime());var b=this._angularVelocity.getClone();b.scaleBy(n.getDeltaTime());var c=this.getEntity().getLocalPosition();this.getEntity().getLocalRotation();
this.getEntity().setLocalPosition(c.x+a.x,c.y+a.y,c.z+a.z);this.getEntity().rotate(b.x,b.y,b.z)},getXyAngleFromVector:function(a){return V.getAngleInDegreesBetween2dVectors(a,new t(this._velocity.x,this._velocity.y))},getGravity:function(){return this._gravity.getClone()},setGravity:function(a){this._gravity=new F(a.x,a.y,a.z)},getVelocity:function(){return this._velocity},addVelocity:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=this._velocity.add(new F(a,b,c))},setVelocity:function(a,
b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=new F(a,b,c)},setVelocityX:function(a){this._velocity.x=a},setVelocityY:function(a){this._velocity.y=a},setVelocityZ:function(a){this._velocity.z=a},getVelocityX:function(){return this._velocity.x},getVelocityY:function(){return this._velocity.y},getVelocityZ:function(){return this._velocity.z},getAngularVelocity:function(){return this._angularVelocity},setAngularVelocity:function(a){this._angularVelocity=a},__class__:hc});var Ja=function(a){m.call(this,
a);null!=Ja._instance&&(window.console.warn("An AudioListener instance already exists. There should only be one!"),Ja._instance.destroy());Ja._instance=this;this._audioSources=[]};Ja.__name__=["engine","components","audio","AudioListener"];Ja.getInstance=function(){return Ja._instance};Ja.__super__=m;Ja.prototype=p(m.prototype,{registerAudioSource:function(a){-1==this._audioSources.indexOf(a)&&(this._audioSources.push(a),a.addEventListener("destroy",w(this,this.onAudioSourceDestroyed)))},removeAudioSource:function(a){G.remove(this._audioSources,
a)},onAudioSourceDestroyed:function(a){a.target.removeEventListener("destroy",w(this,this.onAudioSourceDestroyed));this.removeAudioSource(a.target)},update:function(){m.prototype.update.call(this);if(!this.getGameState().getPaused())for(var a=this.getEntity().getPosition(),b=0,c=this._audioSources.length;b<c;){var d=b++,d=this._audioSources[d],e=Math.abs(a.subtract(d.getEntity().getPosition()).getLength()),f=d.getRolloff();0<f?e<=f?(e=E.linear(1-e/f,0,1,1),d.setVolumePercent(e)):d.setVolumePercent(0):
d.setVolumePercent(1)}},onPause:function(){m.prototype.onPause.call(this);for(var a=0,b=this._audioSources.length;a<b;){var c=a++;this._audioSources[c].setVolumePercent(0)}},destroy:function(){m.prototype.destroy.call(this);Ja._instance=null},__class__:Ja});var gd=function(a,b,c){null==c&&(c=1);null==b&&(b=750);m.call(this,a);this._maxVolume=c;this._rolloff=b;this._volume=0};gd.__name__=["engine","components","audio","AudioSource"];gd.__super__=m;gd.prototype=p(m.prototype,{setRolloff:function(a){this._rolloff=
a},getRolloff:function(){return this._rolloff},setVolumePercent:function(a){this.setVolume(this._maxVolume*a)},setVolume:function(a){a!=this._volume&&(this._volume=a,null!=this._soundData&&this._soundData.setVolume(this._volume))},play:function(a,b){null==b&&(b=!1);null!=Ja.getInstance()&&(Ja.getInstance().registerAudioSource(this),q.isSoundMuted()||(this._soundData=q.playSoundByName(a,!1,b),null!=this._soundData&&this._soundData.setVolume(this._volume)))},playRandom:function(a,b){null==b&&(b=!1);
var c=a[V.randomInt(0,a.length)];this.play(c,b)},pause:function(){null!=this._soundData&&this._soundData.pause()},resume:function(){null!=this._soundData&&this._soundData.resume()},stop:function(){null!=this._soundData&&(this._soundData.stop(),this._soundData=null)},setActive:function(a){m.prototype.setActive.call(this,a);null!=Ja.getInstance()&&(a?Ja.getInstance().registerAudioSource(this):(Ja.getInstance().removeAudioSource(this),this.setVolumePercent(0)))},destroy:function(){m.prototype.destroy.call(this);
this.stop()},__class__:gd});var Ga=function(a,b,c,d){this._lockDelayButtonNextFrame=!1;this._inputEnabled=!0;this._action=this._instantAction=this._deferredAction=null;this._delayTime=0;m.call(this,a);this._delayTime=c;this._action=b;this._instantAction=d};Ga.__name__=["engine","components","buttons","ButtonActionDelay"];Ga.getDelayButtonLock=function(){return Ga._delayButtonLock};Ga.__super__=m;Ga.prototype=p(m.prototype,{setOnAction:function(a){this._action=a},init:function(){m.prototype.init.call(this);
this._deferredAction=new Fb(this.getEntity());this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))},onMouseDown:function(){this._inputEnabled&&!Ga._delayButtonLock&&(this._inputEnabled=!1,this._lockDelayButtonNextFrame=!0,null!=this._instantAction&&this._instantAction(),this._deferredAction.addDeferredAction(this._delayTime,w(this,this.onMouseDownDelayElapse)))},postUpdate:function(){m.prototype.update.call(this);this._lockDelayButtonNextFrame&&(Ga._delayButtonLock=!0);this._lockDelayButtonNextFrame=
!1},onMouseDownDelayElapse:function(){this._lockDelayButtonNextFrame=Ga._delayButtonLock=!1;null!=this._action&&this._action();this._inputEnabled=!0},destroy:function(){m.prototype.destroy.call(this);0<=this._delayTime&&(Ga._delayButtonLock=!1)},__class__:Ga});var gc=function(a){this._inputEnabled=!0;m.call(this,a)};gc.__name__=["engine","components","buttons","ButtonGroup"];gc.__super__=m;gc.prototype=p(m.prototype,{isInputEnabled:function(){return this._inputEnabled},setInputEnabled:function(a){this._inputEnabled=
a},__class__:gc});var Ec=function(a,b,c,d,e){null==e&&(e=!0);this._allowOnce=!0;this._buttonMouseOverScale=this._tweener=null;this._isPulseActive=!1;m.call(this,a);this._pulseFromScale=b;this._pulseToScale=c;this._pulseDuration=d;this._allowOnce=e;this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))};Ec.__name__=["engine","components","buttons","ButtonMouseDownPulse"];Ec.__super__=m;Ec.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._buttonMouseOverScale=
this.getComponent(ic);this._tweener=new Aa(this.getEntity())},disableButton:function(){this.getEntity().removeEventListener("mouseDown",w(this,this.onMouseDown))},enableButton:function(){this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))},onMouseDown:function(){if(!this._isPulseActive&&!Ga.getDelayButtonLock()){var a=this.getEntity().getComponent(ca);this._isPulseActive=!0;null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!1);null!=a?(this._tweener.addTween(a.getScaleRef(),
"x",this._pulseFromScale,this._pulseToScale,this._pulseDuration,E.easeOutBack,0,w(this,this.onPulseComplete)),this._tweener.addTween(a.getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,E.easeOutBack,0)):(this._tweener.addTween(this.getEntity().getScaleRef(),"x",this._pulseFromScale,this._pulseToScale,this._pulseDuration,E.easeOutBack,0,w(this,this.onPulseComplete)),this._tweener.addTween(this.getEntity().getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,
E.easeOutBack,0))}},onPulseComplete:function(){this._allowOnce||(this._isPulseActive=!1,null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!0))},__class__:Ec});var jc=function(a,b,c){this._pixiSprite=null;m.call(this,a);this._defaultImageName=b;this._mouseOverImageName=c;this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))};jc.__name__=["engine","components","buttons","ButtonMouseOverImage"];
jc.__super__=m;jc.prototype=p(m.prototype,{setDefaultImage:function(a){this._defaultImageName=a;this.updateImage(this._defaultImageName)},setMouseOverImage:function(a){this._mouseOverImageName=a;this.updateImage(this._mouseOverImageName)},init:function(){m.prototype.init.call(this);this._pixiSprite=this.getComponent(A);null!=this._pixiSprite&&(this._pixiSprite.setImage(this._defaultImageName),this._pixiSprite.getSprite().anchor.x=0.5,this._pixiSprite.getSprite().anchor.y=0.5)},disableButton:function(){this.getEntity().removeEventListener("mouseOver",
w(this,this.onMouseOver));this.getEntity().removeEventListener("mouseOut",w(this,this.onMouseOut))},enableButton:function(){this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))},onMouseOver:function(a){this.updateImage(this._mouseOverImageName)},onMouseOut:function(a){this.updateImage(this._defaultImageName)},updateImage:function(a){null==this._pixiSprite&&(this._pixiSprite=this.getComponent(A));null!=this._pixiSprite&&
this._pixiSprite.setImage(a)},__class__:jc});var ic=function(a,b,c,d,e){null==c&&(c=0.35);null==b&&(b=1.25);this._baseScaleX=this._baseScaleY=1;this._button=this._tweener=null;m.call(this,a);this._scaleSize=b;this._scaleDuration=c;this._mouseOverEasingFunction=d;this._mouseOutEasingFunction=e;null==this._mouseOverEasingFunction&&(this._mouseOverEasingFunction=E.linear);null==this._mouseOutEasingFunction&&(this._mouseOutEasingFunction=E.linear);this._baseScaleX=this.getEntity().getScaleRef().x;this._baseScaleY=
this.getEntity().getScaleRef().y;this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))};ic.__name__=["engine","components","buttons","ButtonMouseOverScale"];ic.__super__=m;ic.prototype=p(m.prototype,{onDeactivate:function(){m.prototype.onDeactivate.call(this);this._tweener.setActive(!1)},onActivate:function(){m.prototype.onActivate.call(this);this._tweener.setActive(!0)},init:function(){m.prototype.init.call(this);
this._tweener=new Aa(this.getEntity());var a=this.getEntity().getComponent(ca);null!=a&&(this._baseScaleX=a.getScaleRef().x,this._baseScaleY=a.getScaleRef().y)},disableButton:function(){this.onMouseOut(null);this.getEntity().removeEventListener("mouseOver",w(this,this.onMouseOver))},enableButton:function(){this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver))},onMouseOver:function(a){a=this.getEntity().getComponent(ca);if(!Ga.getDelayButtonLock())if(this._tweener.destroyAllTweens(),
null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),"x",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)}else a=this.getEntity().getScaleRef().x,b=this.getEntity().getScaleRef().y,this._tweener.addTween(this.getEntity().getScaleRef(),"x",a,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),
"y",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)},onMouseOut:function(a){if(null!=this._tweener)if(a=this.getEntity().getComponent(ca),this._tweener.destroyAllTweens(),null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),"x",b,this._baseScaleX,this._scaleDuration,this._mouseOutEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)}else a=this.getEntity().getScaleRef().x,
b=this.getEntity().getScaleRef().y,this._tweener.addTween(this.getEntity().getScaleRef(),"x",a,this._baseScaleX,this._scaleDuration,this._mouseOutEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),"y",b,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)},__class__:ic});var Fc=function(a,b,c){m.call(this,a);this._soundName=b;this._overSoundName=c};Fc.__name__=["engine","components","buttons","ButtonSoundPlay"];Fc.__super__=m;Fc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);
this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown));this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver))},onMouseDown:function(){""!=this._soundName&&q.playSoundByName(this._soundName)},onMouseOver:function(){""!=this._soundName&&q.playSoundByName(this._overSoundName)},destroy:function(){m.prototype.destroy.call(this);this.getEntity().removeEventListener("mouseDown",w(this,this.onMouseDown))},__class__:Fc});var Ya=function(a,b,c){Tb.call(this,a,c);this._collision=
b};Ya.__name__=["engine","components","colliders","BoxCollider"];Ya.__super__=Tb;Ya.prototype=p(Tb.prototype,{update:function(){Tb.prototype.update.call(this);var a=this.getEntity().getPosition().getClone(),b=null!=this._offset?this._offset:new F,c=a.x-this._collision.wh.x/2,d=b.x*this.getEntity().getScale().x;this._collision.ul.x=c+d;a=a.y-this._collision.wh.y/2;b=b.y*this.getEntity().getScale().y;this._collision.ul.y=a+b},checkPointIntersect:function(a){return this._collision.checkPointIntersect(a)},
getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);return this._collision.getRaycastPoint(a,b,c,d,e)},debugRender:function(){Tb.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ga.getDebugCamera()){var b=ga.getDebugCamera().getEntity(),c=ga.getDebugCamera().getZoomScale(),d=ga.getDebugCamera().getComponent(Bc);a.translate(-b.getPosition().x*c+d.getContainerOffset().x,-b.getPosition().y*c+d.getContainerOffset().y);a.scale(c,
c)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._collision.ul.x,this._collision.ul.y);a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y);a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y+this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y+this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y);a.stroke();a.restore()},getCollision:function(){return this._collision},__class__:Ya});var ie=function(a,
b,c){this._position=this._spriteIndex=0;this._position=a;this._spriteIndex=b;this._spriteSheetName=c};ie.__name__=["engine","components","flashAnimation","AnimationKeyframe"];ie.prototype={getSpriteSheetName:function(){return this._spriteSheetName},getPosition:function(){return this._position},getSpriteIndex:function(){return this._spriteIndex},__class__:ie};var E=function(){};E.__name__=["engine","components","tween","EasingFunctions"];E.linear=function(a,b,c,d){return b+c*(a/d)};E.easeOutExpo=function(a,
b,c,d){return c*(-Math.pow(2,-10*a/d)+1)+b};E.easeInCubic=function(a,b,c,d){a/=d;return c*a*a*a+b};E.easeOutCubic=function(a,b,c,d){a/=d;--a;return c*(a*a*a+1)+b};E.easeInQuad=function(a,b,c,d){a/=d;return c*a*a+b};E.easeOutQuad=function(a,b,c,d){a/=d;return-c*a*(a-2)+b};E.easeInOutQuad=function(a,b,c,d){a/=d/2;if(1>a)return c/2*a*a+b;--a;return-c/2*(a*(a-2)-1)+b};E.easeInOutSine=function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b};E.easeInQuint=function(a,b,c,d){a/=d;return c*a*a*a*a*a+b};E.easeOutQuint=
function(a,b,c,d){a/=d;--a;return c*(a*a*a*a*a+1)+b};E.easeOutBounce=function(a,b,c,d){a/=d;return 0.36363636363636365>a?c*7.5625*a*a+b:0.7272727272727273>a?c*(7.5625*(a-=0.5454545454545454)*a+0.75)+b:0.9090909090909091>a?c*(7.5625*(a-=0.8181818181818182)*a+0.9375)+b:c*(7.5625*(a-=0.9545454545454546)*a+0.984375)+b};E.easeInBack=function(a,b,c,d){return c*(a/=d)*a*(2.70158*a-1.70158)+b};E.easeOutBack=function(a,b,c,d){a=a/d-1;return c*(a*a*(3.70158*a+2.70158)+1)+b};E.easeInOutExpo=function(a,b,c,d){a/=
d/2;if(1>a)return c/2*Math.pow(2,10*(a-1))+b;--a;return c/2*(-Math.pow(2,-10*a)+2)+b};var Bf=function(a,b,c,d,e,f,g,k,h){this._elapsedTime=0;this._isCompleted=!1;this._action=this._params=null;this._change=this._delay=0;this._target=this._easingFunction=null;this._propertyName="";this._begin=this._end=this._duration=0;this._target=a;this._propertyName=b;this._begin=c;this._end=d;this._duration=e;this._easingFunction=f;this._delay=g;this._action=k;this._params=h};Bf.__name__=["engine","components",
"tween","Tween"];Bf.prototype={getOnUpdate:function(){return this._onUpdate},setOnUpdate:function(a){this._onUpdate=a},update:function(a){this._change=this._end-this._begin;this._elapsedTime+=a;this._elapsedTime<this._delay||(this._elapsedTime>this._duration+this._delay&&(this._elapsedTime=this._duration+this._delay),a=0,a=this._easingFunction(this.getTransitionTimeElapsed(),this._begin,this._change,this._duration),ma.setProperty(this._target,this._propertyName,a),null!=this._onUpdate&&this._onUpdate(),
!this._isCompleted&&this.getTransitionTimeElapsed()>=this._duration&&(this._isCompleted=!0,null!=this._action&&(a=this._action,this._action=null,a(this._params))))},skip:function(){ma.setProperty(this._target,this._propertyName,this._end);this._isCompleted=!0;this._elapsedTime=this._duration},getTransitionTimeElapsed:function(){return Math.max(0,this._elapsedTime-this._delay)},__class__:Bf};var T=function(a,b){this.data=null;this._type=a;this.data=b};T.__name__=["engine","events","EntityEvent"];T.__super__=
Q;T.prototype=p(Q.prototype,{__class__:T});var xf=function(a,b){this.eventName=a;this.action=b};xf.__name__=["engine","events","EventListener"];xf.prototype={__class__:xf};var gb=function(a){this._type=a};gb.__name__=["engine","events","GameObjectEvent"];gb.__super__=Q;gb.prototype=p(Q.prototype,{__class__:gb});var fd=function(a,b,c){this.start=this.end=null;this._type=a;this.start=b;this.end=c};fd.__name__=["engine","events","RaycastCheckEvent"];fd.__super__=Q;fd.prototype=p(Q.prototype,{__class__:fd});
var Ia=function(){this._animations=new Oa};Ia.__name__=["engine","managers","AnimationManager"];Ia.getInstance=function(){null==Ia._instance&&(Ia._instance=new Ia);return Ia._instance};Ia.prototype={getAnimationByName:function(a){var b=this._animations;return null!=ea[a]?b.getReserved(a):b.h[a]},registerAnimation:function(a){var b=this._animations,c=a.getName();null!=ea[c]?b.setReserved(c,a):b.h[c]=a},removeAnimationByName:function(a){this._animations.remove(a)},removeAllAnimations:function(){this._animations=
new Oa},__class__:Ia};var H=function(){};H.__name__=["engine","managers","AssetManager"];H.outputAssets=function(){Fa.log(H.assetList)};H.getAsset=function(a){var b=H.assetList;if(null!=ea[a]?!b.existsReserved(a):!b.h.hasOwnProperty(a))throw new K(a+" does not exist in asset list!");b=H.assetList;return null!=ea[a]?b.getReserved(a):b.h[a]};H.assetExists=function(a){var b=H.assetList;return null!=ea[a]?b.existsReserved(a):b.h.hasOwnProperty(a)};H.unloadAsset=function(a){var b=H.assetList;null!=ea[a]?
b.setReserved(a,null):b.h[a]=null;H.assetList.remove(a);a=PIXI.Texture.removeTextureFromCache(a);null!=a&&a.destroy(!0)};H.unloadLoadBatch=function(a){H.getAsset(a).unload()};H.registerAsset=function(a,b,c){null==c&&(c=!0);var d=H.assetList;(null!=ea[a]?d.existsReserved(a):d.h.hasOwnProperty(a))&&!c||(c=H.assetList,null!=ea[a]?c.setReserved(a,b):c.h[a]=b)};H.prototype={__class__:H};var Ub=function(){L.call(this);Ub._instance=this};Ub.__name__=["engine","managers","DebugManager"];Ub.getInstance=function(){return Ub._instance};
Ub.__super__=U;Ub.prototype=p(U.prototype,{update:function(){U.prototype.update.call(this);"1"==I.getProperty("debugCheats")&&(na.getInstance().isKeyPressed(104)&&I.setProperty("debugDraw","1"==I.getProperty("debugDraw")?"0":"1"),na.getInstance().isKeyPressed(101)&&this.dispatchEvent(new ub("beatLevel")),na.getInstance().isKeyPressed(102)&&this.dispatchEvent(new ub("failLevel")),na.getInstance().isKeyPressed(100)&&(I.setProperty("forceOrientation","HORIZONTAL"==I.getProperty("forceOrientation")?"VERTICAL":
"HORIZONTAL"),n.getInstance().onOrientationChange()),na.getInstance().isKeyPressed(99)&&this.outputHierarchyToWindow())},destroy:function(){U.prototype.destroy.call(this);Ub._instance=null},outputHierarchyToWindow:function(){Fa.log("Outputting Hierarchy to window...");for(var a=window.document.createElement("div"),b=window.open("","_blank"),c=0,d=n.getInstance().getGameStates().length;c<d;){var e=c++,e=n.getInstance().getGameStates()[e],f=window.document.createElement("details");a.appendChild(f);
f.style.color="#FF0000";var g=window.document.createElement("summary");f.appendChild(g);g.innerText=Wa.getClassName(null==e?null:y.getClass(e));for(var g=0,k=e.getEntities().length;g<k;){var h=g++,h=e.getEntities()[h];null==h.getParent()&&(h=this.createDetailsElementForEntity(h),h.style.marginLeft="10px",f.appendChild(h))}}b.document.body.appendChild(a)},createDetailsElementForEntity:function(a){var b=a.getName();if(""==b||null==b)b="Entity";var c=window.document.createElement("details");c.style.marginLeft=
"10px";c.style.color="#00b700";var d=window.document.createElement("summary");c.appendChild(d);for(var e=null!=a.getComponents(m)?a.getComponents(m).length:0,f=a.getChildren().length,g=a.getChildren(!0).length,k="",h=0;h<e;){var l=h++,l=a.getComponents(m)[l],p=window.document.createElement("details");p.style.marginLeft="10px";p.style.color="#439eff";var u=window.document.createElement("summary");p.appendChild(u);var n=Wa.getClassName(null==l?null:y.getClass(l));l.isActive()||(n="(INACTIVE) "+n);u.innerText=
n;""!=k&&(k+=", ");u=Wa.getClassName(null==l?null:y.getClass(l)).split(".");k+=u[u.length-1];c.appendChild(p);for(var u=ma.fields(l),n=0,r=u.length;n<r;){var q=n++,t=u[q],q=window.document.createElement("details");q.style.marginLeft="10px";q.style.color="#AAAAAA";var s=window.document.createElement("summary");q.appendChild(s);var v=ma.field(l,t),w=v;null==w||y.getClass(w);s.innerText=t;t=window.document.createElement("span");t.style.marginLeft="10px";t.style.color="#888888";t.innerText=v;p.appendChild(q);
q.appendChild(t)}}a.isActive()||(b="(INACTIVE) "+b);d.innerHTML=0<e?b+" - Children("+f+"/"+g+") <font color='#439eff'> Components("+e+": "+k+")</font>":b+" - Children("+f+"/"+g+")";for(b=0;b<f;)d=b++,d=a.getChildren()[d],d=this.createDetailsElementForEntity(d),c.appendChild(d);return c},__class__:Ub});var ub=function(a){this._type=a};ub.__name__=["engine","managers","DebugManagerEvent"];ub.__super__=Q;ub.prototype=p(Q.prototype,{__class__:ub});var na=function(){this._keysDown=this._keysPressedThisFrame=
null;this._isInputDisabled=this._isLeftMouseDown=!1;this._mousePosition=null;L.call(this);na._instance=this;this._mousePosition=new t(0,0);this._keysDown=[];this._keysPressedThisFrame=[];for(var a=0;255>a;)a++,this._keysDown.push(!1),this._keysPressedThisFrame.push(!1)};na.__name__=["engine","managers","InputManager"];na.getInstance=function(){return na._instance};na.__super__=U;na.prototype=p(U.prototype,{init:function(){U.prototype.init.call(this);x.getWindow().addEventListener("mousemove",w(this,
this.onMouseMoved));x.getWindow().addEventListener("mousedown",w(this,this.onMouseDown));x.getWindow().addEventListener("mouseup",w(this,this.onMouseUp));x.getWindow().addEventListener("mouseleave",w(this,this.onMouseLeave));x.getWindow().addEventListener("mouseout",w(this,this.onMouseOut));x.getDocument().addEventListener("keydown",w(this,this.onKeyDown));x.getDocument().addEventListener("keyup",w(this,this.onKeyUp));x.getDocument().addEventListener("keypress",w(this,this.onKeyPressed));x.getWindow().addEventListener("click",
w(this,this.onMouseClick));document.addEventListener("touchstart",w(this,this.onMouseDown));document.addEventListener("touchend",w(this,this.onMouseUp));document.addEventListener("touchmove",w(this,this.onMouseMoved))},update:function(){U.prototype.update.call(this)},postUpdate:function(){U.prototype.postUpdate.call(this);for(var a=0,b=this._keysPressedThisFrame.length;a<b;){var c=a++;this._keysPressedThisFrame[c]=!1}},getMousePosition:function(){if(null==P.getInstance().getStage())return new t(0,
0);var a=n.getInstance().getScreenOffset(),a=new t((this._mousePosition.x-a.x)/P.getInstance().getStage().scale.x,(this._mousePosition.y-a.y)/P.getInstance().getStage().scale.y);a.x*=P.getInstance().devicePixelRatio;a.y*=P.getInstance().devicePixelRatio;return a},onMouseMoved:function(a){if(!this._isInputDisabled)if(n.isMobile()){for(var b=a.changedTouches,c=0,d=b.length;c<d;){var e=c++,f=b[e],e=f.pageX-x.getContainer().offsetParent.offsetLeft,f=f.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=
e;this._mousePosition.y=f;n.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())}n.getInstance().sendGlobalMessage("verifyTouches",a)}else b=a.pageX-x.getContainer().offsetParent.offsetLeft,a=a.pageY-x.getContainer().offsetParent.offsetTop,this._mousePosition.x=b,this._mousePosition.y=a,n.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())},onMouseDown:function(a){n.getInstance().hideAddressBar();n.isMobile()&&!n.isIOS()&&n.getInstance().requestFullscreen();if(!this._isInputDisabled)if(n.isMobile()){this._isLeftMouseDown=
!0;var b=a.changedTouches;a=0;for(var c=b.length;a<c;){var d=a++,e=b[d],d=e.pageX-x.getContainer().offsetParent.offsetLeft,e=e.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=d;this._mousePosition.y=e;n.getInstance().sendGlobalMessage("mouseDown",this.getMousePosition())}}else this._isLeftMouseDown=!0,b=a.pageX-x.getContainer().offsetParent.offsetLeft,a=a.pageY-x.getContainer().offsetParent.offsetTop,this._mousePosition.x=b,this._mousePosition.y=a,n.getInstance().sendGlobalMessage("mouseDown",
this.getMousePosition())},onMouseUp:function(a){if(!this._isInputDisabled){if(n.isMobile())this._isLeftMouseDown=!1;else{this._isLeftMouseDown=!1;var b;b=a.pageX-x.getContainer().offsetParent.offsetLeft;a=a.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a}n.getInstance().sendGlobalMessage("mouseUp",this.getMousePosition())}},onMouseClick:function(a){if(!this._isInputDisabled){var b=a.pageX-x.getContainer().offsetParent.offsetLeft;a=a.pageY-x.getContainer().offsetParent.offsetTop;
this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseClick",this.getMousePosition())}},onMouseLeave:function(a){if(!this._isInputDisabled){var b=a.pageX-x.getContainer().offsetParent.offsetLeft;a=a.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseLeave",this.getMousePosition())}},onMouseOut:function(a){if(!this._isInputDisabled){var b=a.pageX-x.getContainer().offsetParent.offsetLeft;
a=a.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseOut",this.getMousePosition())}},onKeyDown:function(a){a.stopPropagation();this._isInputDisabled||this._keysDown[a.keyCode]||(this._keysDown[a.keyCode]=!0,this._keysPressedThisFrame[a.keyCode]=!0,n.getInstance().sendGlobalMessage("keyDown",a.keyCode))},onKeyUp:function(a){this._isInputDisabled||(this._keysDown[a.keyCode]=!1,n.getInstance().sendGlobalMessage("keyUp",
a.keyCode))},onKeyPressed:function(a){a.stopPropagation();this._isInputDisabled||n.getInstance().sendGlobalMessage("keyPressed",a.keyCode)},disablePageKeyPresses:function(){document.onkeydown=function(a){a.preventDefault();return!1}},enablePageKeyPresses:function(){document.onkeydown=null},getInputDisabled:function(){return this._isInputDisabled},setInputDisabled:function(a){this._isInputDisabled=a},isKeyDown:function(a){return this._keysDown[a]},isKeyPressed:function(a){return this._keysPressedThisFrame[a]},
isLeftMouseDown:function(){return this._isLeftMouseDown},__class__:na});var db=function(){this._colliders=this._raycastsThisFrame=null;L.call(this);db._instance=this;this._raycastsThisFrame=[];this._colliders=[];this._debugDrawEnabled="1"==I.getProperty("debugDraw");this.addEventListener("raycastCheck",w(this,this.onRaycastCheck))};db.__name__=["engine","managers","PhysicsManager"];db.getInstance=function(){return db._instance};db.createBoxColliderEntity=function(a,b,c,d,e,f,g,k){null==k&&(k=!0);
d=f.addEntity();d.setLocalPosition(a,b,c);a=new Xa;k=new Ya(d,a,k?new F:new F(0.5*a.wh.x,0.5*a.wh.y));if(null!=g)for(a=0,b=g.length;a<b;)c=a++,k.addTag(g[c]);return d};db.createBoxCollider=function(a,b,c,d,e,f,g){null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);b=new Xa;a=new Ya(a,b,new F(d,e,f));if(null!=g)for(d=0,e=g.length;d<e;)f=d++,a.addTag(g[f]);return a};db.__super__=U;db.prototype=p(U.prototype,{update:function(){U.prototype.update.call(this)},registerCollider:function(a){for(var b=0,c=this._colliders.length;b<
c;){var d=b++;if(this._colliders[d]==a)return}this._colliders.push(a)},removeCollider:function(a){for(var b=0,c=this._colliders.length;b<c;){var d=b++;if(this._colliders[d]==a){this._colliders.splice(d,1);break}}},getColliders:function(){return this._colliders},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!0);for(var f=-1,g=null,k=null,h=0,l=0,m=0,p=this._colliders.length;m<p;){var n=m++;++l;n=this._colliders[n];if(!1!=n.isActive()){if(null!=e){for(var q=!1,r=0,s=e.length;r<s;){var v=r++;if(n.hasTag(e[v])){q=
!0;break}}if(!q)continue}++h;q=new t;if(d){if(r=new t,s=n.getRaycastPoint(a,b,q,d,r),-1==f&&0<s||0<s&&s<f)c.distance=s,c.collider=n,c.collisionPoint=q,k=c.normal=r,g=q,f=s,G.remove(this._colliders,n),this._colliders.unshift(n)}else if(r=new t,s=n.getRaycastPoint(a,b,q,d,r),0<s){c.distance=s;c.collider=n;c.collisionPoint=q;k=c.normal=r;g=q;f=s;G.remove(this._colliders,n);this._colliders.unshift(n);break}}}this._raycastsThisFrame.push({start:a,end:b,hitPoint:g,normal:k});return f},render:function(){U.prototype.render.call(this);
"0"==I.getProperty("debugDraw")&&(this._raycastsThisFrame=[])},debugRender:function(){U.prototype.debugRender.call(this);for(var a=0,b=this._raycastsThisFrame.length;a<b;){var c=a++,d=this._raycastsThisFrame[c],e=d.start,f=d.end,c=d.hitPoint,g=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");g.save();if(null!=ga.getDebugCamera()){var k=ga.getDebugCamera().getEntity(),h=ga.getDebugCamera().getZoomScale(),l=ga.getDebugCamera().getComponent(Bc);g.translate(-k.getPosition().x*h+l.getContainerOffset().x,
-k.getPosition().y*h+l.getContainerOffset().y);g.scale(h,h)}null==c?(g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(f.x,f.y),g.stroke()):(g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(c.x,c.y),g.stroke(),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FFFF00",g.moveTo(c.x,c.y),g.lineTo(f.x,f.y),g.stroke(),null!=d.normal&&(e=(new t(f.x-c.x,f.y-c.y)).getLength(),d=new t(c.x+d.normal.x*e,c.y+
d.normal.y*e),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FF00FF",g.moveTo(c.x,c.y),g.lineTo(d.x,d.y),g.stroke()));g.restore()}this._raycastsThisFrame=[]},destroyAllColliders:function(){for(var a=this._colliders.length-1;0<=a;)this.removeCollider(this._colliders[a]),--a;this._colliders=[]},onRaycastCheck:function(a){this._raycastsThisFrame.push({start:a.start,end:a.end})},__class__:db});var kc=function(){this._isCurrentVoLocked=!1;this._voTrack=null;L.call(this);kc._instance=this};
kc.__name__=["engine","managers","VoManager"];kc.getInstance=function(){return kc._instance};kc.__super__=U;kc.prototype=p(U.prototype,{playVo:function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!1);null==b&&(b=!1);if(!this._isCurrentVoLocked||b)this.stopVo(),this._voTrack=q.playSoundByName(a,c,d),b&&(n.getInstance().invokeAsyncDeferredAction(this._voTrack.getSoundLength(),w(this,this.onHighPrioritySoundElapse)),this._isCurrentVoLocked=!0)},onHighPrioritySoundElapse:function(){this._isCurrentVoLocked=!1},
stopVo:function(){null!=this._voTrack&&(this._voTrack.stop(),this._voTrack=null)},__class__:kc});var je=function(){};je.__name__=["engine","ui","ILayoutElement"];je.prototype={__class__:je,__properties__:{set_localPosition:"set_localPosition",get_localPosition:"get_localPosition",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"}};var ia=function(a){this._updateContainerEveryFrame=!0;m.call(this,a);this._positionOffset=new t(0,0);this._scaleModifier=new t(1,
1);this._scaleOffset=new t(0,0);this._rotationOffset=0;this.initContainer()};ia.__name__=["engine","pixi","PixiContainer"];ia.__interfaces__=[je];ia.__super__=m;ia.prototype=p(m.prototype,{get_width:function(){return this._container.width},set_width:function(a){return this._container.width=a},get_height:function(){return this._container.height},set_height:function(a){return this._container.height=a},get_localPosition:function(){return this.getEntity().getLocalPosition()},set_localPosition:function(a){this.getEntity().setLocalPosition(a.x,
a.y,a.z);return a},getUpdateContainerEveryFrame:function(){return this._updateContainerEveryFrame},setUpdateContainerEveryFrame:function(a){this._updateContainerEveryFrame=a},getPositionOffset:function(){return this._positionOffset},setPositionOffset:function(a){this._positionOffset=a},getScaleModifier:function(){return this._scaleModifier},setScaleModifier:function(a){this._scaleModifier=a},getScaleOffset:function(){return this._scaleOffset},setScaleOffset:function(a){this._scaleOffset=a},getRotationOffset:function(){return this._rotationOffset},
setRotationOffset:function(a){this._rotationOffset=a},getContainer:function(){return this._container},initContainer:function(){this._container=new PIXI.Container},onActivate:function(){m.prototype.onActivate.call(this);null!=this._container&&(this._container.renderable=!0)},onDeactivate:function(){m.prototype.onDeactivate.call(this);null!=this._container&&(this._container.renderable=!1)},init:function(){m.prototype.init.call(this);this.updateTransforms();this.updateParenting()},updateParenting:function(){if(!this.isMarkedForDeletion()){var a=
this.getEntity().getParent();if(null!=a){var b=a.getComponent(ia);null==b&&(b=new ia(a));0<b.getContainer().children.length?b.getContainer().addChildAt(this._container,b.getContainer().children.length):b.getContainer().addChild(this._container);this._parentContainer=b}else 0<P.getInstance().getStage().children.length?P.getInstance().getStage().addChildAt(this._container,P.getInstance().getStage().children.length):P.getInstance().getStage().addChild(this._container)}},update:function(){m.prototype.update.call(this);
this._container.visible=this.getEntity().isVisible()},render:function(){m.prototype.render.call(this);this._updateContainerEveryFrame&&(this.updateTransforms(),this.updateParenting())},bringToFront:function(){var a=this._container.parent;null!=a&&(a.removeChild(this._container),a.addChild(this._container))},updateTransforms:function(){var a=this.getEntity().getLocalPosition(),b=this.getEntity().getLocalScale();this._container.position=new PIXI.Point(a.x+this._positionOffset.x,a.y+this._positionOffset.y);
a=this.getEntity().getLocalRotation().z+this._rotationOffset;this._container.rotation=V.degToRad(a);this._container.scale=new PIXI.Point(b.x*this._scaleModifier.x+this._scaleOffset.x,b.y*this._scaleModifier.y+this._scaleOffset.y)},destroy:function(){m.prototype.destroy.call(this);null!=this._container.parent&&this._container.parent.removeChild(this._container)},__class__:ia,__properties__:{set_localPosition:"set_localPosition",get_localPosition:"get_localPosition",set_height:"set_height",get_height:"get_height",
set_width:"set_width",get_width:"get_width"}});var A=function(a,b,c){ia.call(this,a);this.setImage(b,c)};A.__name__=["engine","pixi","PixiSprite"];A.__interfaces__=[je];A.__super__=ia;A.prototype=p(ia.prototype,{getSprite:function(){return this._container},getFrame:function(){return this.getSprite().texture.frame},getAnchor:function(){return new t(this.getSprite().anchor.x,this.getSprite().anchor.y)},setAnchor:function(a,b){this.getSprite().anchor.x=a;this.getSprite().anchor.y=b},getSize:function(){return new t(this.getSprite().width,
this.getSprite().height)},setSize:function(a,b){this.getEntity().setScale(a/this.getSprite().texture.width,b/this.getSprite().texture.height)},setImageElement:function(a,b){this._currentImageElement=a;var c;null==b?c=PIXI.Texture.fromImage(this._currentImageElement.src):(c=PIXI.BaseTexture.fromImage(this._currentImageElement.src),c=new PIXI.Texture(c,b));this.getSprite().texture=c;this.updateTransforms()},setImage:function(a,b){if(H.assetExists(a)){var c=H.getAsset(a);this.setImageElement(c,b)}},
initContainer:function(){ia.prototype.initContainer.call(this);this._container=new PIXI.Sprite(null)},__class__:A});var vb=function(a,b){this._onAnimationComplete=null;this._position=0;this._updateScale=1;this._isPlaying=!0;A.call(this,a,"");this._currentAnimationName=b};vb.__name__=["engine","pixi","PixiAnimation"];vb.__super__=A;vb.prototype=p(A.prototype,{getAnimation:function(){return Ia.getInstance().getAnimationByName(this._currentAnimationName)},getAnimationLength:function(){return this.getAnimation().getLength()},
getUpdateScale:function(){return this._updateScale},setUpdateScale:function(a){this._updateScale=a},fixedUpdate:function(){A.prototype.update.call(this);var a=this.getAnimation();if(null!=a){if(this._isPlaying){this._position+=n.getDeltaTime()*this.getUpdateScale();if(0<this._updateScale&&this._position>=a.getLength()&&(a.getLoop()?this._position-=a.getLength():(this._position=a.getLength(),this.stop()),null!=this._onAnimationComplete)){var b=this._onAnimationComplete;this._onAnimationComplete=null;
b(this.getEntity());a=Ia.getInstance().getAnimationByName(this._currentAnimationName)}0>this._updateScale&&0>=this._position&&(a.getLoop()?this._position+=a.getLength():(this._position=0,this.stop()),null!=this._onAnimationComplete&&(b=this._onAnimationComplete,this._onAnimationComplete=null,b(this.getEntity()),a=Ia.getInstance().getAnimationByName(this._currentAnimationName)))}if(null!=a){var b=a.getSpriteIndexAtPosition(this._position),c=a.getSpriteSheetNameAtPosition(this._position),b=Pa.getInstance().getSpriteSheetByName(c).getSpriteInfoByIndex(b),
d=b.getCoords();this.setImage(c,new PIXI.Rectangle(d.ul.x,d.ul.y,d.wh.x,d.wh.y));c=a.getOffset().x/b.getCoords().wh.x;a=a.getOffset().y/b.getCoords().wh.y;d=b.getOffset().x/b.getCoords().wh.x;b=b.getOffset().y/b.getCoords().wh.y;this.getSprite().anchor.x=-c-d;this.getSprite().anchor.y=-a-b}}},setPosition:function(a){this._position=a},getPosition:function(){return this._position},setAnimation:function(a,b,c){null==c&&(c=!1);if(this._currentAnimationName!=a||c)this._position=0;this._currentAnimationName=
a;this._onAnimationComplete=b;this._isPlaying=!0},getAnimationName:function(){return this._currentAnimationName},play:function(){this._isPlaying=!0},stop:function(){this._isPlaying=!1},playing:function(){return this._isPlaying},setOnAnimationComplete:function(a){this._onAnimationComplete=a},getOnAnimationComplete:function(){return this._onAnimationComplete},__class__:vb});var Bc=function(a){this._containerOffset=new t(0,0);this._muteRotation=!1;this._layers=[];ga.call(this,a)};Bc.__name__=["engine",
"pixi","PixiCamera"];Bc.__super__=ga;Bc.prototype=p(ga.prototype,{getContainerOffset:function(){return this._containerOffset},setContainerOffset:function(a){this._containerOffset.x=a.x;this._containerOffset.y=a.y},getMuteRotation:function(){return this._muteRotation},setMuteRotation:function(a){this._muteRotation=a},addLayer:function(a,b,c,d,e,f){null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=1);null==b&&(b=1);a=new Cf(a,b,c,d,e,f);this._layers.push(a);return a},removeLayer:function(a){G.remove(this._layers,
a)},getLayerByContainer:function(a){for(var b=0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.pixiContainer==a)return d}return null},getLayers:function(){return this._layers},postUpdate:function(){ga.prototype.postUpdate.call(this);for(var a=this.getEntity().getPosition(),b=0,c=this._layers.length;b<c;){var d=b++,e=this._zoomScale,d=this._layers[d],e=0==d.zoomModifier?1:e*d.zoomModifier;0==d.parallaxX&&0==d.parallaxY&&(e=1);d.muteXMovement?d.pixiContainer.setPositionOffset(new t(d.pixiContainer.getPositionOffset().x,
n.getInstance().getGameSize().y/2+this._containerOffset.y*d.parallaxY)):d.muteYMovement?d.pixiContainer.setPositionOffset(new t(n.getInstance().getGameSize().x/2+this._containerOffset.x*d.parallaxX,d.pixiContainer.getPositionOffset().y)):d.muteXMovement||d.muteYMovement||d.pixiContainer.setPositionOffset(new t(n.getInstance().getGameSize().x/2+this._containerOffset.x*d.parallaxX,n.getInstance().getGameSize().y/2+this._containerOffset.y*d.parallaxY));this._muteRotation||d.pixiContainer.setRotationOffset(this.getEntity().getRotation().z);
var f=Math.floor(a.x*d.parallaxX)-d.originX+n.getInstance().getGameSize().x/e/2,g=Math.floor(a.y*d.parallaxY)-d.originY+n.getInstance().getGameSize().y/e/2;d.pixiContainer.getContainer().pivot=new PIXI.Point(f,g);d.pixiContainer.setScaleModifier(new t(e,e))}},__class__:Bc});var Cf=function(a,b,c,d,e,f){null==f&&(f=1);this.muteXMovement=this.muteYMovement=!1;this.zoomModifier=1;this.originX=this.originY=0;this.parallaxX=this.parallaxY=1;this.pixiContainer=a;this.parallaxX=b;this.parallaxY=c;this.originX=
d;this.originY=e;this.zoomModifier=f};Cf.__name__=["engine","pixi","PixiCameraLayer"];Cf.prototype={__class__:Cf};var P=function(a){this.devicePixelRatio=1;this.shouldDesktopExpandToScreen=this._isSetup=!1;this.scaleHeightToWidth=0;L.call(this)};P.__name__=["engine","pixi","PixiManager"];P.getInstance=function(){null==P._instance&&(P._instance=new P,n.getInstance().addManager(P._instance));return P._instance};P.__super__=U;P.prototype=p(U.prototype,{get_baseWidth:function(){return this._baseWidth},
get_baseHeight:function(){return this._baseHeight},getWebGlEnabled:function(){return this._renderer.type==PIXI.RENDERER_TYPE.WEBGL},getStage:function(){return this._stage},getRenderer:function(){return this._renderer},setup:function(a){this._baseWidth=n.getInstance().getGameWidth();this._baseHeight=n.getInstance().getGameHeight();this._stage=new PIXI.Container;this.devicePixelRatio=window.devicePixelRatio;this._stage=new PIXI.Container;this._renderer=PIXI.autoDetectRenderer(n.getInstance().getGameSize().x,
n.getInstance().getGameSize().y,a,!1);this._masterLayer=n.getInstance().getLayerByName("master");x.getContainer().appendChild(this._renderer.view);this._isSetup=!0;this.updateSize()},render:function(){U.prototype.render.call(this);null!=this._renderer&&this._renderer.render(this._stage)},handleMessage:function(a,b){U.prototype.handleMessage.call(this,a,b);if(null!=this._renderer)switch(a){case "onOrientationChanged":this.updateSize();break;case "onResizedWindow":this.updateSize()}},updateSize:function(){if(null!=
this._stage)if(n.isMobile()||this.shouldDesktopExpandToScreen){var a=window.innerWidth,b=window.innerHeight,c=V.lerp(b/this._baseHeight,a/this._baseWidth,this.scaleHeightToWidth);this._stage.scale.x=c*this.devicePixelRatio;this._stage.scale.y=c*this.devicePixelRatio;this._stage.x=(0.5*a-0.5*this._baseWidth*c)*this.devicePixelRatio;this._stage.y=(0.5*b-0.5*this._baseHeight*c)*this.devicePixelRatio;this._renderer.view.style.left="0px";this._renderer.view.style.top="0px";this._renderer.view.style.width=
a+"px";this._renderer.view.style.height=b+"px";this._renderer.resize(a*this.devicePixelRatio,b*this.devicePixelRatio)}else a=window.innerHeight,this._renderer.view.style.left=0.5*window.innerWidth-0.5*this._baseWidth+"px",this._renderer.view.style.top=0.5*a-0.5*this._baseHeight+"px"},__class__:P,__properties__:{get_baseHeight:"get_baseHeight",get_baseWidth:"get_baseWidth"}});var Df=function(a,b,c,d){ia.call(this,a);Fa.log("WARNING: Spine is not enabled. Set the SPINE preprocessor to enable this");
a=H.getAsset(b);c=H.getAsset(c);this.generateSpine(a,c,d)};Df.__name__=["engine","pixi","PixiSpineAnimation"];Df.__super__=ia;Df.prototype=p(ia.prototype,{generateSpine:function(a,b,c){null!=this._spine&&(this._container.removeChild(this._spine),this._spine=null);a=JSON.parse(a);b=new PIXI.spine.core.TextureAtlas(b,function(a,b){b(PIXI.BaseTexture.fromImage(c+a))},null);a=(new PIXI.spine.core.SkeletonJson(new PIXI.spine.core.AtlasAttachmentLoader(b))).readSkeletonData(a);this._spine=new PIXI.spine.Spine(a);
this._container.addChild(this._spine);a=this._spine.getBounds();this._spine.position.set(-a.x,-a.y);this._spine.skeleton.setToSetupPose();this._spine.update(0)},setToSetupPose:function(){this._spine.skeleton.setToSetupPose()},setAnimation:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);this._spine.state.setAnimation(c,a,b)},setSkinByName:function(a){this._spine.skeleton.setSkinByName(a)},setSlotsToSetupPose:function(){this._spine.skeleton.setSlotsToSetupPose()},__class__:Df});var ta=function(a,b,c){ia.call(this,
a);this.getText().anchor.x=0.5;this.getText().anchor.y=0.5;a=this._container;a.text=b;a.style=c};ta.__name__=["engine","pixi","PixiText"];ta.__super__=ia;ta.prototype=p(ia.prototype,{getText:function(){return this._container},getTextString:function(){return this.getText().text},setTextString:function(a){this.getText().text=a},getAnchor:function(){return new t(this.getText().anchor.x,this.getText().anchor.y)},setAnchor:function(a,b){this.getText().anchor.x=a;this.getText().anchor.y=b},initContainer:function(){ia.prototype.initContainer.call(this);
this._container=new PIXI.Text("")},init:function(){ia.prototype.init.call(this)},destroy:function(){ia.prototype.destroy.call(this);this.getText().texture.baseTexture.destroy()},__class__:ta});var wb=function(a,b,c){null==c&&(c=!0);R.call(this);this._from=a;this._to=b;this._destroyFrom=c;q.playSoundByName("transition_1")};wb.__name__=["engine","screenTransition","TransitionScreen"];wb.__super__=R;wb.prototype=p(R.prototype,{onTransitionMidpoint:function(){this._destroyFrom&&null!=this._from&&this._from.destroy();
null!=this._to&&n.getInstance().addGameState(this._to);this.dispatchEvent(new lc("midpoint"))},onTransitionComplete:function(){this.destroy();this.dispatchEvent(new lc("complete"))},__class__:wb});var lc=function(a){this._type=a};lc.__name__=["engine","screenTransition","TransitionScreenEvent"];lc.__super__=Q;lc.prototype=p(Q.prototype,{__class__:lc});var xb=function(){this.layers=[];this.ul=new t;this.wh=new t};xb.__name__=["engine","shapes","Shape"];xb.prototype={hasLayer:function(a){for(var b=
0,c=this.layers.length;b<c;){var d=b++;if(this.layers[d]==a)return!0}return!1},getClone:function(){var a=new xb;a.ul=this.ul.getClone();a.wh=this.wh.getClone();for(var b=0,c=this.layers.length;b<c;){var d=b++;a.layers.push(this.layers[d])}return a},checkPointIntersect:function(a){return!1},getRaycastPoint:function(a,b,c,d,e){return-1},__class__:xb};var Xa=function(){xb.call(this)};Xa.__name__=["engine","shapes","BoxShape"];Xa.__super__=xb;Xa.prototype=p(xb.prototype,{checkPointIntersect:function(a){xb.prototype.checkPointIntersect.call(this,
a);return a.x>=this.ul.x&&a.y>=this.ul.y&&a.x<=this.ul.x+this.wh.x?a.y<=this.ul.y+this.wh.y:!1},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);e=new t;for(var f=[new t(this.ul.x,this.ul.y),new t(this.ul.x+this.wh.x,this.ul.y),new t(this.ul.x+this.wh.x,this.ul.y+this.wh.y),new t(this.ul.x,this.ul.y+this.wh.y)],g=-1,k=0,h=f.length-1;k<h;){var l=k++,l=V.lineIntersect2D(a,b,f[l],f[l+1],e);if(0<l)if(d){if(-1==g||l<g)c.x=e.x,c.y=e.y,g=l}else return c.x=e.x,c.y=e.y,l}a=V.lineIntersect2D(a,b,f[0],f[f.length-
1],e);if(0<a)if(d){if(-1==g||a<g)c.x=e.x,c.y=e.y,g=a}else return c.x=e.x,c.y=e.y,a;return g},getClone:function(){return null},__class__:Xa});var Ef=function(){this._lowestPoint=this._highestPoint=null;xb.call(this);this._lowestPoint=new t(999999,999999);this._highestPoint=new t(-999999,-999999);this._points=[]};Ef.__name__=["engine","shapes","PolygonShape"];Ef.__super__=xb;Ef.prototype=p(xb.prototype,{addPoint:function(a,b){this._points.push(new t(a,b));a<this._lowestPoint.x&&(this._lowestPoint.x=
a);b<this._lowestPoint.y&&(this._lowestPoint.y=b);a>this._highestPoint.x&&(this._highestPoint.x=a);b>this._highestPoint.y&&(this._highestPoint.y=b)},getPoints:function(){return this._points},checkPointIntersect:function(a){for(var b=this._points.length,c=0,d=!1,e=null,f=null;c<b;){e=this._points[c].getClone();f=this._points[(c+1)%b].getClone();e.x+=this.ul.x;e.y+=this.ul.y;f.x+=this.ul.x;f.y+=this.ul.y;if(0==c)d=0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y);else if(d&&0>(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*
(f.y-e.y)||!d&&0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y))return!1;++c}return!0},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);var f=new Db;f.ul=this._lowestPoint.getClone();f.wh=new t(this._highestPoint.x-this._lowestPoint.x,this._highestPoint.y-this._lowestPoint.y);f.ul.x+=this.ul.x;f.ul.y+=this.ul.y;var g=Math.abs(b.x-a.x),k=Math.abs(b.y-a.y),g=new Db(a.x<b.x?a.x:b.x,a.y<b.y?a.y:b.y,g,k);if(!f.getIntersect(g))return-1;for(var f=new t,k=this._points,g=-1,h=0,l=k.length-1;h<l;){var m=h++,n=
k[m].getClone();n.x+=this.ul.x;n.y+=this.ul.y;var p=k[m+1].getClone();p.x+=this.ul.x;p.y+=this.ul.y;m=V.lineIntersect2D(a,b,n,p,f);if(0<m)if(d){if(-1==g||m<g)c.x=f.x,c.y=f.y,null!=e&&(g=(new t(p.y-n.y,n.x-p.x)).getNormalized(),e.x=g.x,e.y=g.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),g=m}else return c.x=f.x,c.y=f.y,null!=e&&(c=(new t(p.y-n.y,n.x-p.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),m}h=k[0].getClone();h.x+=this.ul.x;
h.y+=this.ul.y;l=k[k.length-1].getClone();l.x+=this.ul.x;l.y+=this.ul.y;k=V.lineIntersect2D(a,b,h,l,f);if(0<k)if(d){if(-1==g||k<g)c.x=f.x,c.y=f.y,null!=e&&(c=(new t(l.y-h.y,h.x-l.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),g=k}else return c.x=f.x,c.y=f.y,null!=e&&(c=(new t(l.y-h.y,h.x-l.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),k;return g},getClone:function(){return null},__class__:Ef});var Ff=
function(a){this.soundName=a;this.subtitles=[]};Ff.__name__=["engine","speechManager","Dialogue"];Ff.prototype={__class__:Ff};var Vb=function(a,b){null==b&&(b=!0);null==a&&(a=!0);this._voTrack=this._speechMap=this._currentDeferredActions=null;L.call(this);this._speechMap=new Gf;this._voiceOversEnabled=a;this._subtitlesEnabled=b;this._currentDeferredActions=[];Vb._instance=this};Vb.__name__=["engine","speechManager","SpeechManager"];Vb.getInstance=function(){return Vb._instance};Vb.__super__=U;Vb.prototype=
p(U.prototype,{getVoiceOversEnabled:function(){return this._voiceOversEnabled},setVoiceOversEnabled:function(a){this._voiceOversEnabled=a},getSubtitlesEnabled:function(){return this._subtitlesEnabled},setSubtitlesEnabled:function(a){this._subtitlesEnabled=a},init:function(){U.prototype.init.call(this)},setup:function(){this.parseSpeechMap()},parseSpeechMap:function(){for(var a=C.parse(H.getAsset("speechMap")).elementsNamed("speech_map").next().elementsNamed("dialogue");a.hasNext();){for(var b=a.next(),
c=new Ff(b.get("soundName")),b=b.elementsNamed("subtitle");b.hasNext();){var d=b.next(),d=new Hf(d.get("stringId"),parseFloat(d.get("time")),parseFloat(d.get("duration")));c.subtitles.push(d)}this._speechMap.dialogue.push(c)}},stopVo:function(){null!=this._voTrack&&(this._voTrack.stop(),this._voTrack=null)},playVo:function(a){var b=this;null!=this._voTrack&&this.stopVo();if("0"==I.getProperty("speechMode")||"2"==I.getProperty("speechMode"))this._voTrack=q.playSoundByName(a);if("1"==I.getProperty("speechMode")||
"2"==I.getProperty("speechMode")){var c=this._speechMap.getDialogueBySoundName(a);if(null!=c){for(;0<this._currentDeferredActions.length;)a=this._currentDeferredActions.pop(),n.getInstance().destroyDeferredAction(a);a=0;for(var d=c.subtitles.length;a<d;){var e=a++,e=[c.subtitles[e]];this._currentDeferredActions.push(n.getInstance().invokeAsyncDeferredAction(e[0].time,function(a){return function(){b.dispatchSubtitle(a[0])}}(e)))}}else Fa.log("WARNING: '"+a+"' has no subtitles.")}return this._voTrack},
dispatchSubtitle:function(a){this.dispatchEvent(new hd("showSubtitle",a.duration,sa.getString(a.stringId)))},__class__:Vb});var Gf=function(){this.dialogue=[]};Gf.__name__=["engine","speechManager","SpeechMap"];Gf.prototype={getDialogueBySoundName:function(a){for(var b=0,c=this.dialogue.length;b<c;){var d=b++;if(this.dialogue[d].soundName==a)return this.dialogue[d]}return null},__class__:Gf};var Hf=function(a,b,c){this.stringId=a;this.time=b;this.duration=c};Hf.__name__=["engine","speechManager",
"Subtitle"];Hf.prototype={__class__:Hf};var hd=function(a,b,c){this._duration=0;this._type=a;this._duration=b;this._subtitleText=c};hd.__name__=["engine","speechManager","SubtitleEvent"];hd.__super__=Q;hd.prototype=p(Q.prototype,{getDuration:function(){return this._duration},getSubtitleText:function(){return this._subtitleText},__class__:hd});var ke=function(a,b,c,d){this._name=a;this._coords=b.getClone();this._spriteSheetName=c;null==d||isNaN(d.x)&&isNaN(d.y)?this._offset=new t:this._offset=new t(d.x,
d.y)};ke.__name__=["engine","spriteSheets","SpriteInfo"];ke.prototype={getCoords:function(){return this._coords},setOffset:function(a,b){this._offset.x=a;this._offset.y=b},getOffset:function(){return this._offset},getSpriteSheetName:function(){return this._spriteSheetName},getName:function(){return this._name},__class__:ke};var fc=function(a,b){this._image=null;this._spriteInfo=[];this._spriteInfoHashTable=new Oa;this._name=a;null==b?this._imageName=a:(this._imageName=b,this._image=H.getAsset(this._imageName))};
fc.__name__=["engine","spriteSheets","SpriteSheet"];fc.parseFromXmlString=function(a,b,c){c=C.parse(c);b=new fc(a,b);for(c=c.elementsNamed("TextureAtlas").next().elementsNamed("sprite");c.hasNext();){var d=c.next(),d=new ke(d.get("n"),new Db(parseFloat(d.get("x")),parseFloat(d.get("y")),parseFloat(d.get("w")),parseFloat(d.get("h"))),a,new t(parseFloat(d.get("oX")),parseFloat(d.get("oY"))));b.addSpriteInfo(d)}Pa.getInstance().registerSpriteSheet(b);return b};fc.prototype={getNumSprites:function(){return this._spriteInfo.length},
getName:function(){return this._name},getImage:function(){return this._image},getImageName:function(){return this._imageName},addSpriteInfo:function(a){this._spriteInfo.push(a);var b=this._spriteInfoHashTable,c=a.getName();null!=ea[c]?b.setReserved(c,a):b.h[c]=a},getSpriteInfoByIndex:function(a){return this._spriteInfo[a]},getSpriteInfoByName:function(a){var b=this._spriteInfoHashTable;return null!=ea[a]?b.getReserved(a):b.h[a]},addToAllOffsets:function(a,b){for(var c=0,d=this._spriteInfo.length;c<
d;){var e=c++,e=this._spriteInfo[e];e.setOffset(e.getOffset().x+a,e.getOffset().y+b)}},__class__:fc};var Pa=function(){this._spriteSheets=new Oa};Pa.__name__=["engine","spriteSheets","SpriteSheetManager"];Pa.getInstance=function(){null==Pa._instance&&(Pa._instance=new Pa);return Pa._instance};Pa.createSpriteSheetFromGrid=function(a,b,c,d,e){var f=H.getAsset(a),g=Math.floor(f.width/c),f=Math.floor(f.height/d);b=new fc(a,b);for(var k=0;k<f;)for(var h=k++,l=0,m=g;l<m;){var n=l++,n=new ke(a+n+"-"+h,new Db(n*
c,h*d,c,d),a,e);b.addSpriteInfo(n)}Pa.getInstance().registerSpriteSheet(b)};Pa.prototype={addToAllSpriteSheetOffsets:function(a,b,c){this.getSpriteSheetByName(a).addToAllOffsets(b,c)},getSpriteSheetByName:function(a){var b=this._spriteSheets;return null!=ea[a]?b.getReserved(a):b.h[a]},registerSpriteSheet:function(a){var b=this._spriteSheets,c=a.getName();null!=ea[c]?b.setReserved(c,a):b.h[c]=a},removeSpriteSheetByName:function(a){this._spriteSheets.remove(a)},removeAllSpriteSheets:function(){this._spriteSheets=
new Oa},__class__:Pa};var le=function(a){m.call(this,a)};le.__name__=["engine","ui","KeepUiPanelCentered"];le.__super__=m;le.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._uiPanel=this.getEntity().getComponent(mc)},update:function(){m.prototype.update.call(this);if(n.isMobile()){P.getInstance().getRenderer();P.getInstance().getRenderer();var a=n.getInstance().getGameSize();this.getEntity().setPosition(0.5*a.x,0.5*a.y)}else a=n.getInstance().getGameSize(),this.getEntity().setPosition(a.x/
2,a.y/2)},__class__:le});var If=function(a,b){m.call(this,a);this._size=b};If.__name__=["engine","ui","ScaleBackgroundToWindow"];If.__super__=m;If.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);if(null==this._size){var a=this.getComponent(A);this._size=null!=a?new t(a.getSprite().texture.baseTexture.width,a.getSprite().texture.baseTexture.height):new t}this._uiElement=this.getComponent(ca)},update:function(){m.prototype.update.call(this);var a=new t(P.getInstance().getStage().scale.x,
P.getInstance().getStage().scale.y),b=P.getInstance().getRenderer().view.width/this._size.x,c=P.getInstance().getRenderer().view.height/this._size.y,b=Math.max(b,c),b=b/a.x;null!=this._uiElement?this._uiElement.setScale(b,b):this.getEntity().setScale(b,b)},__class__:If});var ib={__ename__:!0,__constructs__:["Left","Center","Right"],Left:["Left",0]};ib.Left.__enum__=ib;ib.Center=["Center",1];ib.Center.__enum__=ib;ib.Right=["Right",2];ib.Right.__enum__=ib;ib.__empty_constructs__=[ib.Left,ib.Center,
ib.Right];var jb={__ename__:!0,__constructs__:["Top","Center","Bottom"],Top:["Top",0]};jb.Top.__enum__=jb;jb.Center=["Center",1];jb.Center.__enum__=jb;jb.Bottom=["Bottom",2];jb.Bottom.__enum__=jb;jb.__empty_constructs__=[jb.Top,jb.Center,jb.Bottom];var ca=function(a,b){this._updateEveryFrame=!0;this._positionDirty=this._pixelPerfect=!1;this._uiPanel=this._coords=this._size=this._scale=null;m.call(this,a);this.setUiPanel(b);this._coords=new t(0,0);this._scale=new t(1,1)};ca.__name__=["engine","ui",
"UiElement"];ca.__super__=m;ca.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);if(null==this._size){var a=this.getComponent(A);null!=a?this.setSize(new t(a.getSprite().width,a.getSprite().height)):this.setSize(new t(0,0))}this.updateDisplay()},getScaleRef:function(){return this._scale},getSize:function(){return this._size},getPixelPerfect:function(){return this._pixelPerfect},setPixelPerfect:function(a){this._pixelPerfect=a},setSize:function(a){null==this._size&&(this._size=new t);
this._size.x=a.x;this._size.y=a.y},getUiPanel:function(){return this._uiPanel},setScale:function(a,b){null==b&&(b=1);null==a&&(a=1);this._scale=new t(a,b);this.updateDisplay()},setUiPanel:function(a){null!=this._uiPanel&&this._uiPanel.removeEventListener("updateDisplay",w(this,this.onUiPanelUpdateDisplay));this._uiPanel=a;this._uiPanel.addEventListener("updateDisplay",w(this,this.onUiPanelUpdateDisplay));this._uiPanel.getEntity().addChild(this.getEntity())},getCoords:function(){return this._coords},
getCoordsRef:function(){return this._coords},setCoords:function(a){this._coords=a},update:function(){m.prototype.update.call(this)},postUpdate:function(){m.prototype.postUpdate.call(this);(this._positionDirty||this._updateEveryFrame)&&this.updateDisplay()},onUiPanelUpdateDisplay:function(){this._positionDirty=!0},updateDisplay:function(){x.getWindow();this._uiPanel.getSize();n.getInstance().getGameSize();this._uiPanel.getSize();n.getInstance().getGameSize();var a=this._uiPanel.getSize().x/2*this._coords.x,
b=this._uiPanel.getSize().y/2*this._coords.y;this._pixelPerfect?this.getEntity().setLocalScale(this._scale.x,this._scale.y):this.getEntity().setLocalScale(this._scale.x/this._uiPanel.getEntity().getScale().x,this._scale.y/this._uiPanel.getEntity().getScale().y);this.getEntity().setLocalPosition(a/P.getInstance().getStage().scale.x,b/P.getInstance().getStage().scale.y,0);this._positionDirty=!1},debugRender:function(){m.prototype.debugRender.call(this);if(null!=this._size){var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");
a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#0000FF";a.moveTo(b.x-this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();a.restore()}},__class__:ca});var mc=function(a,b){m.call(this,a);this._size=b;this._window=x.getWindow()};mc.__name__=["engine","ui","UiPanel"];mc.__super__=
m;mc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this.setSize(this._size)},getSize:function(){return this._size},setSize:function(a){this._size=a;this.updateDisplay()},updateDisplay:function(){this.dispatchEvent(new id("updateDisplay"))},debugRender:function(){m.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(b.x-
this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();a.restore()},__class__:mc});var id=function(a){this._type=a};id.__name__=["engine","ui","UiPanelEvent"];id.__super__=Q;id.prototype=p(Q.prototype,{__class__:id});var me=function(a,b){this._prevWidth=this._prevHeight=0;this._uiPanel=this._window=null;m.call(this,a);
this._uiPanel=b;this._window=x.getWindow()};me.__name__=["engine","ui","UiPanelSizeToWindow"];me.__super__=m;me.prototype=p(m.prototype,{update:function(){m.prototype.update.call(this);var a=P.getInstance().getRenderer().width,b=P.getInstance().getRenderer().height;this._uiPanel.setSize(new t(a,b));this.getEntity().setLocalPosition(0.5*a,0.5*b,0);this._prevWidth=a;this._prevHeight=b},__class__:me});var Sb=function(){};Sb.__name__=["engine","utilities","ArrayUtils"];Sb.indexOf=function(a,b){for(var c=
0,d=a.length;c<d;){var e=c++;if(a[e]==b)return e}return-1};Sb.clear=function(a){a.length=0};Sb.prototype={__class__:Sb};var Fa=function(){};Fa.__name__=["engine","utilities","Debug"];Fa.log=function(a){};Fa.alert=function(a){};var jd=function(){};jd.__name__=["engine","utilities","FontPreloadHelper"];jd.createFontPreload=function(a,b){a.addEntity();var c={};c.fontFamily=b;(new ta(a,"x",c)).getText().alpha=0.01};jd.prototype={__class__:jd};var V=function(){};V.__name__=["engine","utilities","Math2"];
V.lerp=function(a,b,c){return a+(b-a)*c};V.degToRad=function(a){return 0.0174532925*a};V.radToDeg=function(a){return 57.2957795*a};V.randomFloat=function(a,b){return a+Math.random()*(b-a)};V.randomInt=function(a,b){return Math.floor(V.randomFloat(a,b))};V.getClosestPointOnSegment=function(a,b,c){b=new t(b.x-a.x,b.y-a.y);c=(new t(c.x-a.x,c.y-a.y)).dotProduct(b)/b.dotProduct(b);0>c&&(c=0);1<c&&(c=1);c=new t(b.x*c,b.y*c);return new t(a.x+c.x,a.y+c.y)};V.lineIntersect2D=function(a,b,c,d,e){var f=(b.x-
a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x),g=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x);if(0==f||0==g)return-2;d=((a.y-c.y)*(d.x-c.x)-(a.x-c.x)*(d.y-c.y))/f;c=((a.y-c.y)*(b.x-a.x)-(a.x-c.x)*(b.y-a.y))/g;return 0<d&&1>d&&0<c&&1>c?(c=(new t(a.x-b.x,a.y-b.y)).getLength()*d,b=new t(b.x-a.x,b.y-a.y),b.scaleBy(d,d),b=new t(a.x+b.x,a.y+b.y),e.x=b.x,e.y=b.y,c):-1};V.clamp=function(a,b,c){return a<b?b:a>c?c:a};V.getRotated2dVector=function(a,b){var c=V.degToRad(b),d=Math.cos(c),c=Math.sin(c),e=new t(a.x,a.y),f=e.x*c+
e.y*d;e.x=e.x*d-e.y*c;e.y=f;return e};V.getAngleInDegreesBetween2dVectors=function(a,b){return V.radToDeg(Math.atan2(a.x*b.y-a.y*b.x,a.dotProduct(b)))};var bd=function(a){this._value=null;this._eventListeners=[];this._value=a};bd.__name__=["engine","utilities","WatchableValue"];bd.__super__=sb;bd.prototype=p(sb.prototype,{set:function(a){var b=this._value;this._value=a;this._value!=b&&this.dispatchEvent(new kd("change",this._value,b))},get:function(){return this._value},__class__:bd});var kd=function(a,
b,c){this._type=a;this.value=b;this.oldValue=c};kd.__name__=["engine","utilities","WatchableValueEvent"];kd.__super__=Q;kd.prototype=p(Q.prototype,{__class__:kd});var Jf=function(){this._entries=null;this._entries=[]};Jf.__name__=["engine","weightedVector","WeightedArray"];Jf.prototype={addEntry:function(a,b){var c=new Kf(a,b);this._entries.push(c);return c},getRandomValue:function(a){null==a&&(a=!1);for(var b=0,c=this._entries.length,d=0;d<c;)var e=d++,b=b+this._entries[e].weight;b=V.randomFloat(0,
b);for(e=d=0;e<c;){var f=e++,g=this._entries[f],d=d+g.weight;if(d>=b)return a&&this._entries.splice(f,1),g.value}return null},clear:function(){this._entries=[]},__class__:Jf};var Kf=function(a,b){this.weight=a;this.value=b};Kf.__name__=["engine","weightedVector","WeightedArrayEntry"];Kf.prototype={__class__:Kf};var ua=function(a,b){wb.call(this,a,b)};ua.__name__=["game","FadeTransition"];ua.doTransition=function(a,b){var c=new ua(a,b);n.getInstance().addGameState(c)};ua.doMidpointTransition=function(a,
b,c){a=new ua(a,b);a.addEventListener("midpoint",c);n.getInstance().addGameState(a)};ua.__super__=wb;ua.prototype=p(wb.prototype,{init:function(){var a=this;wb.prototype.init.call(this);na.getInstance().setInputDisabled(!0);var b=this.addEntity();b.setLocalPosition(512,384,0);this._pixiSprite=new A(b,"blackSquare");this._pixiSprite.getSprite().anchor.x=0.5;this._pixiSprite.getSprite().anchor.y=0.5;b.setLocalScale(300,300,1);this._tweener=new Aa(b);this._tweener.addTween(this._pixiSprite.getSprite(),
"alpha",0,1,0.2,E.linear,0,function(){a.onTransitionMidpoint()});this._tweener.addTween(this._pixiSprite.getSprite(),"alpha",1,0,0.2,E.linear,0.25,function(){a.onTransitionComplete()})},render:function(){wb.prototype.render.call(this);null!=this._pixiSprite&&this._pixiSprite.bringToFront()},update:function(){wb.prototype.update.call(this);G.remove(n.getInstance().getGameStates(),this);n.getInstance().getGameStates().push(this)},onTransitionMidpoint:function(){wb.prototype.onTransitionMidpoint.call(this);
na.getInstance().setInputDisabled(!1)},__class__:ua});var Lf=function(){this.lastLevelSelectPanX=-5E3;this.shouldShowLevelSelectTutorial=this.shouldShowMinigameTutorial=!0;this.numRecapsUntilPromo=0;this.numRecapsPerPromo=3;this.currentPromoImageIndex=0;this.utagManager=this.minigameSuggestionController=null;ra.parseInt(I.getProperty("numRecapsPerPromo"));this.minigameSuggestionController=new Gc(Y.getInstance().getSaveData())};Lf.__name__=["game","GameController"];Lf.prototype={get_selectedMinigame:function(){return this._selectedMinigame},
set_selectedMinigame:function(a){return this._selectedMinigame=a},get_selectedMinigameName:function(){switch(this._selectedMinigame[1]){case 0:return"horseRiding";case 1:return"hideAndSeek";case 2:return"badminton"}},link:function(a,b){null!=this.utagManager&&this.utagManager.link(a,b)},__class__:Lf,__properties__:{get_selectedMinigameName:"get_selectedMinigameName",set_selectedMinigame:"set_selectedMinigame",get_selectedMinigame:"get_selectedMinigame"}};var Y=function(){this._currentLevelNumber=
1;this._eventListeners=[];Y._instance=this;this._saveData=new zf};Y.__name__=["game","GameTracker"];Y.getInstance=function(){null==Y._instance&&(Y._instance=new Y);return Y._instance};Y.getScoreSaveKeyForLevel=function(a){return"levelScore"+(null==a?"null":""+a)};Y.__super__=sb;Y.prototype=p(sb.prototype,{getSaveData:function(){return this._saveData},getNumLevels:function(){return ra.parseInt(I.getProperty("numLevels"))},getNumLevelsUnlocked:function(){return this.getSaveData().getItem("numLevelsUnlocked",
1)},setNumLevelsUnlocked:function(a){this.getSaveData().setItem("numLevelsUnlocked",Math.min(this.getNumLevels(),Math.max(a,this.getNumLevelsUnlocked())))},setScoreForLevel:function(a,b){a>this.getScoreForLevel(b)&&this.getSaveData().setItem(Y.getScoreSaveKeyForLevel(b),a)},getScoreForLevel:function(a){return this.getSaveData().getItem(Y.getScoreSaveKeyForLevel(a),0)},setScoreForCurrentLevel:function(a){this.setScoreForLevel(a,this._currentLevelNumber)},setCurrentLevelNumber:function(a){this._currentLevelNumber=
a},getCurrentLevelNumber:function(){return this._currentLevelNumber},getHasBeatenGame:function(){return this.getSaveData().getItem("hasBeatenGame",!1)},setHasBeatenGame:function(a){this.getSaveData().setItem("hasBeatenGame",a)},getHasStartedGame:function(){return this.getSaveData().getItem("hasStartedGame",!1)},setHasStartedGame:function(a){this.getSaveData().setItem("hasStartedGame",a)},getHighScore:function(){return this.getSaveData().getItem("highScore",0)},setHighScore:function(a){a<=this.getHighScore()||
this.getSaveData().setItem("highScore",a)},getNumStarsForLevel:function(a){return this.getSaveData().getItem("numStars"+a,0)},setNumStarsForLevel:function(a,b){b<this.getNumStarsForLevel(a)||this.getSaveData().setItem("numStars"+a,b)},hasSeenStoryForMinigame:function(a){return this.getSaveData().getItem("hasSeenTutorial_"+a[1],!1)},setHasSeenStoryForMinigame:function(a,b){this.getSaveData().setItem("hasSeenTutorial_"+a[1],b)},hasBeatenAllGames:function(){return this.getSaveData().getItem("hasBeatenAllGames",
!1)},setBeatenAllGames:function(a){this.getSaveData().setItem("hasBeatenAllGames",a)},__class__:Y});var Qa=function(){};Qa.__name__=["game","Prototype"];Qa.prototype={create:function(a,b,c){return null},__class__:Qa};var ne=function(a,b){this.endAlpha=0;this.startAlpha=1;this._isGeneratingPoints=!0;this._endWidth=0;this._startWidth=15;this._tailLength=10;m.call(this,a);this._positionAgent=b;this._tailPoints=[];var c=this.addEntity();this._pixiContainer=new ia(c);this._graphics=new PIXI.Graphics(!0);
this._pixiContainer.getContainer().addChild(this._graphics)};ne.__name__=["game","TrailRenderer"];ne.__super__=m;ne.prototype=p(m.prototype,{get_isGeneratingPoints:function(){return this._isGeneratingPoints},set_isGeneratingPoints:function(a){return this._isGeneratingPoints=a},get_tailLength:function(){return this._tailLength},set_tailLength:function(a){return this._tailLength=a},get_startWidth:function(){return this._startWidth},set_startWidth:function(a){return this._startWidth=a},get_endWidth:function(){return this._endWidth},
set_endWidth:function(a){return this._endWidth=a},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);var a=this._positionAgent.getPosition();this._pixiContainer.getEntity().setPosition(0,0);this._pixiContainer.getEntity().setScale(1,1);this.get_isGeneratingPoints()?this._tailPoints.unshift(a):this._tailPoints.pop();this._tailPoints.length>this._tailLength&&this._tailPoints.pop()},render:function(){m.prototype.render.call(this);this._graphics.clear();if(!(2>this._tailPoints.length)){this.getEntity().getPosition();
for(var a=this._tailPoints.length,b=[],c=0,d=a-1;c<d;){var e=c++,f=this._tailPoints[e],g=this._tailPoints[e+1],g=(new F(g.x-f.x,g.y-f.y)).getNormalized(),g=new F(-g.y,g.x),k=V.lerp(this._startWidth,this._endWidth,e/a),e=new F(f.x+g.x*k,f.y+g.y*k),f=new F(f.x-g.x*k,f.y-g.y*k);b.push(e);b.push(f)}a=b.length;for(c=0;c<a-2;)d=[],f=V.lerp(this.startAlpha,this.endAlpha,c/a),this._graphics.beginFill(16777215,f),this._graphics.blendMode=PIXI.BLEND_MODES.ADD,d.push(b[c].x),d.push(b[c].y),d.push(b[c+1].x),
d.push(b[c+1].y),d.push(b[c+3].x),d.push(b[c+3].y),d.push(b[c+2].x),d.push(b[c+2].y),this._graphics.drawPolygon(d),this._graphics.endFill(),c+=2}},destroy:function(){m.prototype.destroy.call(this);null!=this._graphics.parent&&this._graphics.parent.removeChild(this._graphics)},__class__:ne,__properties__:{set_endWidth:"set_endWidth",get_endWidth:"get_endWidth",set_startWidth:"set_startWidth",get_startWidth:"get_startWidth",set_tailLength:"set_tailLength",get_tailLength:"get_tailLength",set_isGeneratingPoints:"set_isGeneratingPoints",
get_isGeneratingPoints:"get_isGeneratingPoints"}});var Gd=function(){R.call(this)};Gd.__name__=["game","boot","BootState"];Gd.__super__=R;Gd.prototype=p(R.prototype,{init:function(){R.prototype.init.call(this);this._root=n.getInstance();var a=new db;this._root.addManager(a);a=new na;this._root.addManager(a);var b=new Ub;this._root.addManager(b);b=new kc;this._root.addManager(b);b=new Vb;this._root.addManager(b);a.disablePageKeyPresses();this.initLayers();this.getAssetsList()},getAssetsList:function(){var a=
new Cc;a.addAsset("assetList","asset_list.js",W.Other);a.addAsset("strings","./locale/${locale}/strings.xml",W.Other);a.addAsset("globalGameConfig","game_config.js",W.Other);a.addAsset("gameConfig","./locale/${locale}/game_config.js",W.Other);a.addAsset("styleCss","./locale/${locale}/css/style.css",W.Css);a.addAsset("speechMap","./media/xml/speech_map.xml",W.Other);a.addAsset("ipadOrientationImage","./media/images/system/orientation_ipad.png",W.Image);a.addAsset("iphoneOrientationImage","./media/images/system/orientation_iphone.png",
W.Image);a.load(w(this,this.onAssetListLoaded))},onAssetListLoaded:function(){I.parseGameConfig(JSON.parse(H.getAsset("globalGameConfig")));I.parseGameConfig(JSON.parse(H.getAsset("gameConfig")));n.getInstance().setGameWidth(I.getProperty("gameWidth",1024));n.getInstance().setGameHeight(I.getProperty("gameHeight",768));sa.initStrings();Vb.getInstance().setup();if(n.isMobile()||"NONE"!=I.getProperty("forceOrientation")){var a=new oe;this._root.addGameState(a);n.getInstance().onOrientationChange()}for(var a=
JSON.parse(H.getAsset("assetList")),b=0,c=a.loadBatches.length;b<c;){for(var d=b++,e=new Cc,d=a.loadBatches[d],f=0,g=d.assets.length;f<g;){var k=f++,k=d.assets[k],h=k.source.split("."),l=W.Other;switch(h[h.length-1]){case "css":l=W.Css;break;case "eot":case "ttf":case "woff":l=W.Font;break;case "jpeg":case "jpg":case "png":l=W.Image;break;case "js":l=W.Other;break;case "mp3":case "wav":l=W.Audio}e.addAsset(k.name,k.source,l)}H.registerAsset(d.name,e)}H.getAsset("loadScreenBatchPreload").load(w(this,
this.onLoadScreenPreloadComplete))},onLoadScreenPreloadComplete:function(){P.getInstance().setup({backgroundColor:0});this._loadingScreen=new ld;this._root.addGameState(this._loadingScreen);this._root.onResizeWindow();H.getAsset("loadBatchPreload").load(w(this,this.onPreloadComplete))},onPreloadComplete:function(){this.destroy();var a=new pe("barbie_dreamhouse"),b=new Lf;b.utagManager=a;ua.doTransition(this._loadingScreen,new qe(b))},initLayers:function(){this._root.addLayer(new Cb("debug",n.getInstance().getGameWidth()|
0,n.getInstance().getGameHeight()|0))},__class__:Gd});var Hc=function(a){m.call(this,a);this._root=n.getInstance();this.center()};Hc.__name__=["game","gameplay","CenterToScreen"];Hc.__super__=m;Hc.prototype=p(m.prototype,{postUpdate:function(){m.prototype.postUpdate.call(this);this.center()},center:function(){var a=this._root.getGameWidth(),b=this._root.getGameHeight(),a=0.5*a,b=0.5*b;this.getEntity().setPosition(a,b)},__class__:Hc});var md=function(a){this.yDragMax=0;this.xDragMax=280;this.yDragMin=
0;this.xDragMin=-280;this._prevMousePosition=new t;this._isDragging=!1;m.call(this,a)};md.__name__=["game","gameplay","DragSceneButton"];md.__super__=m;md.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getComponent(ha);this._button.setOnMouseDown(w(this,this.onMouseDown));this.constrictPosition()},onMouseDown:function(){this._isDragging=!0;this._prevMousePosition=na.getInstance().getMousePosition()},onMouseUp:function(){this._isDragging&&(this._isDragging=!1)},
update:function(){m.prototype.update.call(this);if(this._isDragging){var a=na.getInstance().getMousePosition(),a=new t(a.x-this._prevMousePosition.x,a.y-this._prevMousePosition.y),b=this.getEntity().getLocalPosition();b.x+=a.x;b.y+=a.y;this.getEntity().setLocalPosition(b.x,b.y);0<a.getLength()&&this.dispatchEvent(new yb("drag"));this._prevMousePosition=na.getInstance().getMousePosition()}this.constrictPosition()},constrictPosition:function(){var a=this.getEntity().getLocalPosition(),b=this.xDragMin/
this.getEntity().getScale().x,c=this.xDragMax/this.getEntity().getScale().x,d=this.yDragMin/this.getEntity().getScale().y,e=this.yDragMax/this.getEntity().getScale().y;a.x<b&&(a.x=b,this.dispatchEvent(new yb("exceedBounds")));a.y<d&&(a.y=d,this.dispatchEvent(new yb("exceedBounds")));a.x>c&&(a.x=c,this.dispatchEvent(new yb("exceedBounds")));a.y>e&&(a.y=e,this.dispatchEvent(new yb("exceedBounds")));this.getEntity().setLocalPosition(a.x,a.y)},snapToLeft:function(){var a=this.getEntity().getLocalPosition(),
b=this.xDragMin/this.getEntity().getScale().x;this.getEntity().setLocalPosition(b,a.y);this.constrictPosition()},snapToRight:function(){var a=this.getEntity().getLocalPosition(),b=this.xDragMax/this.getEntity().getScale().x;this.getEntity().setLocalPosition(b,a.y);this.constrictPosition()},gotoPosition:function(a){this.getEntity().setLocalPosition(a,0)},getPosition:function(){return this.getEntity().getLocalPosition().x},scrollToEntity:function(a){this.getEntity().setLocalPosition(-a.getLocalPosition().x,
0);this.constrictPosition()},handleMessage:function(a,b){m.prototype.handleMessage.call(this,a,b);if("mouseUp"==a)this.onMouseUp()},__class__:md});var yb=function(a){this._type=a};yb.__name__=["game","gameplay","DragSceneButtonEvent"];yb.__super__=Q;yb.prototype=p(Q.prototype,{__class__:yb});var Ic=function(){};Ic.__name__=["game","gameplay","IScrollable"];Ic.prototype={__class__:Ic};var Wb=function(a,b,c){this._parallax=1;this._tileSprites=[];this._tiles=[];this._viewSize=new t(2048,768);this._leftMost=
this._rightMost=0;m.call(this,a);this._imageIds=c;this._positionAgent=b};Wb.__name__=["game","gameplay","EndlessBackground"];Wb.__interfaces__=[Ic];Wb.__super__=m;Wb.prototype=p(m.prototype,{get_parallax:function(){return this._parallax},set_parallax:function(a){return this._parallax=a},init:function(){m.prototype.init.call(this);this.updateTiles()},scroll:function(a){a*=this.get_parallax();for(var b=0,c=this._tiles;b<c.length;){var d=c[b];++b;d.translate(a)}this._leftMost+=a;this._rightMost+=a},
update:function(){m.prototype.update.call(this);this.updateTiles()},updateTiles:function(){this.cleanUpTiles();this.fillScreen()},getRandomImageId:function(){var a=V.randomInt(0,this._imageIds.length);return this._imageIds[a]},cleanUpTiles:function(){for(var a=this._positionAgent.getPosition(),b=a.x-0.5*this._viewSize.x,a=a.x+0.5*this._viewSize.x,c=this._tiles.length-1;0<=c;){var d=this._tiles[c].getLocalPosition(),e=this._tileSprites[c],f=d.x-e.get_width()*e.getAnchor().x,e=d.x+e.get_width()*(1-
e.getAnchor().x);e<b&&(this._tiles[c].destroy(),this._tiles.splice(c,1),this._tileSprites.splice(c,1),this._leftMost=Math.max(f,d.x));f>a&&(this._tiles[c].destroy(),this._tiles.splice(c,1),this._tileSprites.splice(c,1),this._rightMost=Math.max(e,d.x));--c}},fillScreen:function(){var a=this._positionAgent.getPosition(),b=a.x+0.5*this._viewSize.x;a.x-0.5*this._viewSize.x<this._leftMost&&(a=this.getRandomImageId(),this.createLeftBackgroundTile(a));b>this._rightMost&&(b=this.getRandomImageId(),this.createRightBackgroundTile(b))},
createLeftBackgroundTile:function(a){var b=this.addEntity();a=new A(b,a);a.setAnchor(1,0);this._tileSprites.push(a);b.setLocalPosition(this._leftMost,0);this._leftMost-=a.getSprite().width;this._tiles.push(b);return b},createRightBackgroundTile:function(a){var b=this.addEntity();a=new A(b,a);a.setAnchor(0,0);this._tileSprites.push(a);b.setLocalPosition(this._rightMost,0);this._rightMost+=a.getSprite().width;this._tiles.push(b);return b},__class__:Wb,__properties__:{set_parallax:"set_parallax",get_parallax:"get_parallax"}});
var re=function(a,b){this._scrollSpeed=450;m.call(this,a);this._scrollableGroup=b};re.__name__=["game","gameplay","GameScrollController"];re.__super__=m;re.prototype=p(m.prototype,{get_scrollSpeed:function(){return this._scrollSpeed},set_scrollSpeed:function(a){return this._scrollSpeed=a},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this._scrollableGroup.scroll(-this._scrollSpeed*n.getDeltaTime())},__class__:re,__properties__:{set_scrollSpeed:"set_scrollSpeed",get_scrollSpeed:"get_scrollSpeed"}});
var nd=function(a){this._type=a};nd.__name__=["game","gameplay","HudEvent"];nd.__super__=Q;nd.prototype=p(Q.prototype,{__class__:nd});var Mf=function(){this._score=this._levelTime=0};Mf.__name__=["game","gameplay","LevelStats"];Mf.prototype={getScore:function(){return this._score},setScore:function(a){this._score=a},setLevelTime:function(a){this._levelTime=a},getLevelTime:function(){return this._levelTime},__class__:Mf};var Nf=function(){this.scoreTiers=[5,10]};Nf.__name__=["game","gameplay","ScoreConfig"];
Nf.prototype={parse:function(a){this.scoreTiers=a.scoreTiers},__class__:Nf};var Of=function(){this._score=this.lastNumStarsEarned=0;this._config=new Nf};Of.__name__=["game","gameplay","ScoreController"];Of.prototype={get_config:function(){return this._config},set_config:function(a){return this._config=a},get_score:function(){return this._score},set_score:function(a){return this._score=a},get_numStars:function(){return this.getNumStarsForScore(this.get_score())},getNumStarsForScore:function(a){for(var b=
this._config.scoreTiers.length,c=0;c<b;){var d=c++;if(a<this._config.scoreTiers[d])return d+1}return b+1},reset:function(){this.set_score(0)},__class__:Of,__properties__:{get_numStars:"get_numStars",set_score:"set_score",get_score:"get_score",set_config:"set_config",get_config:"get_config"}};var Pf=function(){this._scrollables=[]};Pf.__name__=["game","gameplay","ScrollableGroup"];Pf.prototype={addScrollable:function(a){this._scrollables.push(a)},scroll:function(a){for(var b=0,c=this._scrollables;b<
c.length;){var d=c[b];++b;d.scroll(a)}},__class__:Pf};var se=function(a){m.call(this,a)};se.__name__=["game","gameplay","TimeController"];se.__super__=m;se.prototype=p(m.prototype,{get_timeLeft:function(){return this._timeLeft},set_timeLeft:function(a){return this._timeLeft=a},update:function(){m.prototype.update.call(this);if(0<this._timeLeft){var a=Math.ceil(this._timeLeft);this._timeLeft-=n.getDeltaTime();var b=Math.ceil(this._timeLeft);5>=b&&(0<b&&b<a)&&q.playSoundByName("sfxClockTimer");if(0>=
this._timeLeft)this.onTimeElapse()}},onTimeElapse:function(){this.dispatchEvent(new od("timeElapse"));0>this._timeLeft&&(this._timeLeft=0)},__class__:se,__properties__:{set_timeLeft:"set_timeLeft",get_timeLeft:"get_timeLeft"}});var od=function(a){this._type=a};od.__name__=["game","gameplay","TimeControllerEvent"];od.__super__=Q;od.prototype=p(Q.prototype,{__class__:od});var Qf=function(){};Qf.__name__=["game","gameplay","minigames","IMinigame"];Qf.prototype={__class__:Qf,__properties__:{get_timeLeft:"get_timeLeft",
get_hasTimer:"get_hasTimer",get_scoreString:"get_scoreString",get_scoreController:"get_scoreController"}};var ja=function(a,b){this._finishMinigameDelay=1.5;this._countdownDelay=1;this._scoreController=new Of;m.call(this,a);this._gameController=b;this._config=new Rf;this._deferredAction=new Fb(this.getEntity());this._countdownDelay=this._config.countdownDelay};ja.__name__=["game","gameplay","minigames","Minigame"];ja.__interfaces__=[Qf];ja.__super__=m;ja.prototype=p(m.prototype,{get_scoreController:function(){return this._scoreController},
get_hasTimer:function(){return!1},get_timeLeft:function(){throw new K("Not implemented.");},get_scoreString:function(){throw new K("Not implemented.");},get_isMobile:function(){return n.isMobile()},init:function(){m.prototype.init.call(this);this._deferredAction.addDeferredAction(this._countdownDelay,w(this,this.onCountdownDelayElapse));this._uiPanel=Ba.createFullscreenUiPanel(this.getGameState());this._hud=new pd(this._uiPanel.getEntity(),this)},onCountdownDelayElapse:function(){var a=this,b=!Y.getInstance().hasSeenStoryForMinigame(this._gameController.get_selectedMinigame()),
c=this._gameController.get_selectedMinigame()[1]+1;if(b)Xb.show(this._uiPanel.getEntity(),[sa.getString("STORY_HEADING_"+c)],[sa.getString("STORY_BODY_"+c)],function(){a.onCloseStory()},"storyCornerImage"+c);else this.onCloseStory()},onCloseStory:function(){Y.getInstance().setHasSeenStoryForMinigame(this._gameController.get_selectedMinigame(),!0);this._gameController.shouldShowMinigameTutorial?this.showTutorial():this.startCountdown()},showTutorial:function(){this._gameController.shouldShowMinigameTutorial=
!1;var a=this._gameController.get_selectedMinigame()[1]+1,b=this.addEntity();new Jc(b,a,this._config.tutorialImageIdBase,this._config.tutorialStringIdBase);b.addEventListener("destroy",w(this,this.onTutorialDestroy))},onTutorialDestroy:function(a){this.startCountdown()},startCountdown:function(){var a=this.addEntity();new ca(a,this._uiPanel);(new Kc(a)).set_onComplete(w(this,this.onCountdownComplete))},onCountdownComplete:function(){this.startGameplay()},startGameplay:function(){console.log("startGameplay()")},
onGameOver:function(){console.log("onGameOver()");this.destroyVirtualButtons();var a=this.get_scoreController(),b=this._scoreController.get_score();this._scoreController.lastNumStarsEarned=a.getNumStarsForScore(b);this._deferredAction.addDeferredAction(this._finishMinigameDelay,w(this,this.onFinishMinigameDelayElapse))},createArrowVirtualButtons:function(a){this._hud.createLeftVirtualButton(a);this._hud.createRightVirtualButton(a)},destroyVirtualButtons:function(){this._hud.destroyVirtualButtons()},
onFinishMinigameDelayElapse:function(){this.onComplete()},onComplete:function(){this._hud.getEntity().destroy();this.dispatchEvent(new qd("complete"));q.playSoundByName("sfxLevelComplete")},pauseGame:function(){this.getGameState().pause();Lc.show(this.getGameState(),this._gameController,this._config).addEventListener("destroy",w(this,this.onMenusDestroy))},onMenusDestroy:function(a){this.unpauseGame()},unpauseGame:function(){this.getGameState().resume()},__class__:ja,__properties__:{get_isMobile:"get_isMobile",
get_scoreString:"get_scoreString",get_timeLeft:"get_timeLeft",get_hasTimer:"get_hasTimer",get_scoreController:"get_scoreController"}});var Rf=function(){this.countdownDelay=1.5};Rf.__name__=["game","gameplay","minigames","MinigameConfig"];Rf.prototype={__class__:Rf};var qd=function(a){this._type=a};qd.__name__=["game","gameplay","minigames","MinigameEvent"];qd.__super__=Q;qd.prototype=p(Q.prototype,{__class__:qd});var pd=function(a,b){this._leftArrow=this._rightArrow=this._actionButton=null;m.call(this,
a);this._minigame=b};pd.__name__=["game","gameplay","minigames","MinigameHud"];pd.__super__=m;pd.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._uiPanel=this.getComponent(mc);var a=new Mc(this._uiPanel);a.createPauseButton(0.89,-0.85,w(this,this.onPauseButtonClick));this._scoreText=a.createScoreCounter(0,-0.85).getComponentsInChildren(ta)[0];this._minigame.get_hasTimer()&&(this._time=this._minigame.get_timeLeft(),a=a.createTimer(-0.85,-0.79),this._clockMask=a.findChildByName("fill").getComponent(A).getSprite().mask,
this._clockHand=a.findChildByName("hand"),this._clockRed=a.addEntity(),a=new A(this._clockRed,"clockBaseRed"),a.setAnchor(0.5,0.5),a.getSprite().blendMode=PIXI.BLEND_MODES.MULTIPLY,this._propertyOscillator=new Dc(this._clockRed,a.getSprite(),"alpha",0.35,0.35,5),this._clockRed.setVisible(!1))},update:function(){m.prototype.update.call(this);this._scoreText.setTextString(this._minigame.get_scoreString());null!=this._clockHand&&this.updateClock(this._minigame.get_timeLeft()/this._time)},updateClock:function(a){this._clockRed.setVisible(0.33>
a);a=1-a;this._clockHand.setLocalRotation2d(360*a);var b=Math.PI*(1-2*a);this._clockMask.clear();this._clockMask.beginFill();this._clockMask.moveTo(0,0);this._clockMask.lineTo(2E3*Math.sin(b),2E3*Math.cos(b));0.95<a&&(this._clockMask.lineTo(2E3*Math.sin(0.5*b),2E3*Math.cos(0.2*-b)),this._clockMask.lineTo(2E3*Math.sin(0.5*-b),2E3*Math.cos(0.5*-b)),this._clockMask.lineTo(2E3*Math.sin(-b),2E3*Math.cos(-b)));0.45<a&&0.95>=a&&(this._clockMask.lineTo(2E3*Math.sin(0.01*(Math.PI-b)),2E3*Math.cos(0.01*(Math.PI-
b))),this._clockMask.lineTo(2E3*Math.sin(0.1*(Math.PI-b)),2E3*Math.cos(0.1*(Math.PI-b))),this._clockMask.lineTo(2E3*Math.sin(0.3*(Math.PI-b)),2E3*Math.cos(0.3*(Math.PI-b))),this._clockMask.lineTo(2E3*Math.sin(0.6*(Math.PI-b)),2E3*Math.cos(0.6*(Math.PI-b))),this._clockMask.lineTo(2E3*Math.sin(0.9*(Math.PI-b)),2E3*Math.cos(0.9*(Math.PI-b))),this._clockMask.lineTo(2E3*Math.sin(0.99*(Math.PI-b)),2E3*Math.cos(0.99*(Math.PI-b))));this._clockMask.lineTo(0,-2E3);this._clockMask.endFill()},destroyVirtualButtons:function(){null!=
this._leftArrow&&this._leftArrow.destroy();null!=this._rightArrow&&this._rightArrow.destroy();null!=this._actionButton&&this._actionButton.destroy()},createLeftVirtualButton:function(a){this._leftArrow=(new Mc(this._uiPanel)).createLeftButton(-0.85,0.8,a)},createRightVirtualButton:function(a){this._rightArrow=(new Mc(this._uiPanel)).createRightButton(0.85,0.8,a)},onPauseButtonClick:function(){this._minigame.pauseGame()},__class__:pd});var va={__ename__:!0,__constructs__:["InfiniteRunner","HideAndSeek",
"Badminton"],InfiniteRunner:["InfiniteRunner",0]};va.InfiniteRunner.__enum__=va;va.HideAndSeek=["HideAndSeek",1];va.HideAndSeek.__enum__=va;va.Badminton=["Badminton",2];va.Badminton.__enum__=va;va.__empty_constructs__=[va.InfiniteRunner,va.HideAndSeek,va.Badminton];var te=function(a,b){m.call(this,a);this._target=b};te.__name__=["game","gameplay","minigames","UpArrowButton"];te.__super__=m;te.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getEntity().getComponent(ha);
this._button.setOnMouseDown(w(this,this.onMouseDown))},onMouseDown:function(){this._target.handleUpStart()},__class__:te});var rd=function(a,b){this._gravityScaleIncreasePerSecond=0.05;this._gravity=0;this._maxGravityScale=7;this._gravityScale=1;this._canTouchNet=!1;this._lastHitter=null;this._hasHitGround=!1;m.call(this,a);this._badmintonController=b;this._velocityController=new hc(this.getEntity(),new F(0,0,0));this._lastPosition=this.getEntity().getPosition()};rd.__name__=["game","gameplay","minigames",
"badminton","BadmintonBirdie"];rd.__super__=m;rd.prototype=p(m.prototype,{get_velocity:function(){return this._velocityController.getVelocity()},set_velocity:function(a){this._velocityController.setVelocity(a.x,a.y,a.z);return a},get_gravity:function(){return this._gravity},set_gravity:function(a){return this._gravity=a},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this._gravityScale+=this._gravityScaleIncreasePerSecond*n.getDeltaTime();this._gravityScale>this._maxGravityScale&&(this._gravityScale=
this._maxGravityScale);this._velocityController.setGravity(new F(0,this._gravity*this._gravityScale,0));var a=this.getEntity().getLocalPosition(),b=this._canTouchNet&&Math.abs(a.x)<0.5*this._badmintonController.badmintonConfig.netWidth&&a.y>this._badmintonController.badmintonConfig.netTopY,c=0<this.get_velocity().x;b&&c&&(0>a.x&&0<this.get_velocity().x?(this.set_velocity(new F(-this.get_velocity().x,this.get_velocity().y)),this.dispatchEvent(new Ra("hitNet"))):0<a.x&&0>this.get_velocity().x&&(this.set_velocity(new F(-this.get_velocity().x,
this.get_velocity().y)),this.dispatchEvent(new Ra("hitNet"))));if(!this._hasHitGround&&a.y>=this.groundY)this.onHitGround();0>this._lastPosition.x&&0<=a.x?this.dispatchEvent(new Ra("passNetToRight")):this.dispatchEvent(new Ra("passNetToLeft"));this._lastPosition=a;0<this.get_velocity().getLength()&&(a=V.getAngleInDegreesBetween2dVectors(new t(0,-1),(new t(this.get_velocity().x,this.get_velocity().y)).getNormalized()),this.getEntity().setRotation2d(a));0<this.get_gravity()&&this.get_gravity()>this._badmintonController.badmintonConfig.maxBirdieGravity&&
this.set_gravity(this._badmintonController.badmintonConfig.maxBirdieGravity)},onActivate:function(){m.prototype.onActivate.call(this);this._velocityController.setActive(!0)},onDeactivate:function(){m.prototype.onDeactivate.call(this);this._velocityController.setActive(!1)},hit:function(a,b,c){this._hasHitGround||(this._lastHitter==c&&this.dispatchEvent(new Ra("doubleHit")),b=b.getNormalized(),b.x*=a,b.y*=a,this.set_velocity(new F(b.x,b.y)),this._lastHitter=c,this._velocityController.setActive(!0))},
onHitGround:function(){this._hasHitGround=!0;this.set_velocity(new F(0,0,0));this.dispatchEvent(new Ra("hitGround"));this._velocityController.setActive(!1)},getProjectedXAtYWithVelocity:function(a,b){for(var c=new t(this.getEntity().getPosition().x,this.getEntity().getPosition().y),d=new t(a.x,a.y),e=0;1E3>e&&!(e++,c.x+=0.005555555555555556*d.x,c.y+=0.005555555555555556*d.y,d.y+=0.005555555555555556*this.get_gravity()*this._gravityScale,c.y>=b&&0<=d.y););return c.x},getProjectedXAtY:function(a){return this.getProjectedXAtYWithVelocity(new t(this.get_velocity().x,
this.get_velocity().y),a)},__class__:rd,__properties__:{set_gravity:"set_gravity",get_gravity:"get_gravity",set_velocity:"set_velocity",get_velocity:"get_velocity"}});var ue=function(a,b){ja.call(this,a,b);this.badmintonConfig=new Sf;this.badmintonConfig.parse(JSON.parse(H.getAsset("badmintonConfig")));this._scoreController.get_config().parse(JSON.parse(H.getAsset("badmintonConfig")));this._config.tutorialImageIdBase="badmintonTutorial";this._config.tutorialStringIdBase="BADMINTON_TUTORIAL"};ue.__name__=
["game","gameplay","minigames","badminton","BadmintonController"];ue.__super__=ja;ue.prototype=p(ja.prototype,{get_scoreString:function(){return ra.string(this._scoreController.get_score())},init:function(){ja.prototype.init.call(this);this._gameController.minigameSuggestionController.incrementMinigamePlay(va.Badminton);pa.createAnimation("badmintonBarbieIdle","badmintonBarbieIdleXml",new t(-123,-246),3,!0);pa.createAnimation("badmintonBarbieMove","badmintonBarbieMoveXml",new t(-123,-246),2.5,!0);
pa.createAnimation("badmintonBarbieHit","badmintonBarbieHitXml",new t(-123,-246),1.5,!1);pa.createAnimation("badmintonOpponentIdle","badmintonOpponentIdleXml",new t(-123,-246),3,!0);pa.createAnimation("badmintonOpponentMove","badmintonOpponentMoveXml",new t(-123,-246),2.5,!0);pa.createAnimation("badmintonOpponentHit","badmintonOpponentHitXml",new t(-123,-246),1.5,!1);pa.createAnimation("badmintonOpponentServe","badmintonOpponentServeXml",new t(-123,-246),2,!1);this._gameplayRoot=this.addEntity();
new Hc(this._gameplayRoot);this._background=this._gameplayRoot.addEntity();var a=this._background.addEntity();(new A(a,"badmintonBg")).setAnchor(0.5,0.5);a=this._background.addEntity();a.setLocalPosition(-1024,0);(new A(a,"badmintonBg")).setAnchor(0.5,0.5);a=this._background.addEntity();a.setLocalPosition(1024,0);(new A(a,"badmintonBg")).setAnchor(0.5,0.5);a=this._background.addEntity();a.setLocalPosition(0.5*this.badmintonConfig.playAreaWidth+50,235);(new A(a,"badmintonMarker")).setAnchor(0.5,0.5);
a=this._background.addEntity();a.setLocalScale(-1,1);a.setLocalPosition(0.5*-this.badmintonConfig.playAreaWidth-50,235);(new A(a,"badmintonMarker")).setAnchor(0.5,0.5);a=new ve(this.badmintonConfig);this._opponent=a.createLeftFacingBadmintonPlayer(this._gameplayRoot,200,this.badmintonConfig.baselineY).getComponent(kb);this._opponent.maxX=0.5*this.badmintonConfig.playAreaWidth;this._opponent.minX=0.5*this.badmintonConfig.netWidth;this._opponentAiController=new we(this._opponent.getEntity());this._opponentAiController.set_state(new nc(this._opponentAiController));
this._opponentAiController.setActive(!1);var b=this._gameplayRoot.addEntity();b.setLocalPosition(0,155);(new A(b,"badmintonNet")).setAnchor(0.5,0.5);this._player=a.createRightFacingBadmintonPlayer(this._gameplayRoot,-200,this.badmintonConfig.baselineY).getComponent(kb);new sd(this._player.getEntity(),this._player);new xe(this._player.getEntity(),this._player);this._player.minX=0.5*-this.badmintonConfig.playAreaWidth;this._player.maxX=0.5*-this.badmintonConfig.netWidth;var b=this._player.getEntity().getComponentsInChildren(Gb)[0],
c=this._opponent.getEntity().getComponentsInChildren(Gb)[0],d=c.getEntity().getPosition();this._birdie=a.createBirdie(this._gameplayRoot,0,0,this).getComponent(rd);this._birdie.set_gravity(this.badmintonConfig.birdieGravity);this._birdie.getEntity().setPosition(d.x,d.y);this._birdie.groundY=this.badmintonConfig.groundY;this._birdie.addEventListener("hitGround",w(this,this.onBirdieHitGround));this._birdie.addEventListener("hitNet",w(this,this.onBirdieHitNet));this._birdie.addEventListener("doubleHit",
w(this,this.onBirdieDoubleHit));this._birdie.addEventListener("passNetToRight",w(this,this.onBirdiePassNetRight));this._birdie.addEventListener("passNetToLeft",w(this,this.onBirdiePassNetLeft));this._birdie.setActive(!1);b.birdie=this._birdie;c.birdie=this._birdie;this._opponent.set_state(new Nc(this._opponent));q.playMusicByName("musicFretless")},removeBirdieListeners:function(){this._birdie.removeEventListener("hitGround",w(this,this.onBirdieHitGround));this._birdie.removeEventListener("hitNet",
w(this,this.onBirdieHitNet));this._birdie.removeEventListener("doubleHit",w(this,this.onBirdieDoubleHit));this._birdie.removeEventListener("passNetToRight",w(this,this.onBirdiePassNetRight));this._birdie.removeEventListener("passNetToLeft",w(this,this.onBirdiePassNetLeft))},onBirdiePassNetRight:function(a){a=this._scoreController;var b=a.get_score();a.set_score(b+1)},onBirdiePassNetLeft:function(a){},onBirdieDoubleHit:function(a){this.onGameOver()},startGameplay:function(){ja.prototype.startGameplay.call(this);
this._opponentAiController.setActive(!0)},startCountdown:function(){ja.prototype.startCountdown.call(this);this.get_isMobile()&&this.createArrowVirtualButtons(this._player)},onGameOver:function(){ja.prototype.onGameOver.call(this);this.removeBirdieListeners();this._opponentAiController.setActive(!1)},onBirdieHitGround:function(a){this.onGameOver();q.playRandomSoundByName(["sfxBirdieGrassImpact1","sfxBirdieGrassImpact2","sfxBirdieGrassImpact3"]);this._birdie.set_gravity(0);this._birdie.set_velocity(new F(0,
0,0))},onBirdieHitNet:function(a){this.onGameOver()},__class__:ue});var ve=function(a){this._config=a};ve.__name__=["game","gameplay","minigames","badminton","BadmintonFactory"];ve.prototype={createRightFacingBadmintonPlayer:function(a,b,c){a=this.createBadmintonPlayer(a,b,c);b=a.addEntity();b.setLocalPosition(25,-150);new Gb(b);b=a.getComponent(kb);b.set_config(this._config.playerConfig);b.minTargetX=512;b.maxTargetX=912;return a},createLeftFacingBadmintonPlayer:function(a,b,c){a=this.createBadmintonPlayer(a,
b,c);b=a.addEntity();b.setLocalPosition(-25,-150);new Gb(b);b=a.getComponent(kb);b.set_config(this._config.opponentConfig);b.minTargetX=112;b.maxTargetX=512;return a},createBadmintonPlayer:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=a.addEntity();(new A(b,"badmintonShadow")).setAnchor(0.5,0.5);b=a.addEntity();new vb(b,"badmintonBarbieIdle");new kb(a);return a},createBirdie:function(a,b,c,d){var e=a.addEntity();e.setLocalPosition(b,c);(new A(e,"badmintonBirdie")).setAnchor(0.5,0.5);new rd(e,
d);a=new ne(a,e);a.set_startWidth(5);a.set_endWidth(1);a.set_tailLength(15);a.startAlpha=0.1;a.endAlpha=0.025;return e},__class__:ve};var Ra=function(a){this._type=a};Ra.__name__=["game","gameplay","minigames","badminton","BirdieEvent"];Ra.__super__=Q;Ra.prototype=p(Q.prototype,{__class__:Ra});var Sf=function(){this.netTopY=0;this.birdieGravityIncreasePerSecond=2;this.maxBirdieGravity=700;this.birdieGravity=500;this.netWidth=100;this.playAreaWidth=950;this.baselineY=this.groundY=260};Sf.__name__=
"game gameplay minigames badminton badmintonPlayer BadmintonConfig".split(" ");Sf.prototype={parse:function(a){this.baselineY=a.baselineY;this.groundY=a.groundY;this.playAreaWidth=a.playAreaWidth;this.netWidth=a.netWidth;this.birdieGravity=a.birdieGravity;this.maxBirdieGravity=a.maxBirdieGravity;this.birdieGravityIncreasePerSecond=a.birdieGravityIncreasePerSecond;this.netTopY=a.netTopY;this.playerConfig=new td;this.playerConfig.parse(a.playerConfig);this.opponentConfig=new td;this.opponentConfig.parse(a.opponentConfig);
console.log(this)},__class__:Sf};var Tf=function(){};Tf.__name__=["game","gameplay","minigames","playerInput","IActionInputReceiver"];Tf.prototype={__class__:Tf};var ye=function(){};ye.__name__=["game","gameplay","minigames","playerInput","IDirectionalInputReceiver"];ye.prototype={__class__:ye};var kb=function(a){this.maxTargetX=1E3;this.minTargetX=-1E3;m.call(this,a);this._config=new td;this._stateMachine=new ze;this._velocityController=new hc(this.getEntity());this._playerChargeController=new oc(this.getEntity(),
this);new Ja(a);this._audioSource=new gd(a,1500)};kb.__name__="game gameplay minigames badminton badmintonPlayer BadmintonPlayer".split(" ");kb.__interfaces__=[Tf,ye];kb.__super__=m;kb.prototype=p(m.prototype,{get_audioSource:function(){return this._audioSource},get_state:function(){return this._stateMachine.getState()},set_state:function(a){this._stateMachine.setState(a);return a},get_config:function(){return this._config},set_config:function(a){return this._config=a},get_movementSpeed:function(){return this._config.movementSpeed},
get_velocity:function(){return this._velocityController.getVelocity()},set_velocity:function(a){this._velocityController.setVelocity(a.x,a.y,a.z);return a},get_swingTransform:function(){null==this._swingTransform&&(this._swingTransform=this.getEntity().getComponentsInChildren(Gb)[0]);return this._swingTransform},playAnimation:function(a,b){null==this._animation&&(this._animation=this.getEntity().getComponentsInChildren(vb)[0]);this._animation.setAnimation(this.get_config().animationPrefix+a,b)},stopAnimation:function(){null==
this._animation&&(this._animation=this.getEntity().getComponentsInChildren(vb)[0]);this._animation.stop()},faceLeft:function(){this._animation.getEntity().setLocalScale(-1,1)},faceRight:function(){this._animation.getEntity().setLocalScale(1,1)},init:function(){m.prototype.init.call(this);this._animation=this.getEntity().getComponentsInChildren(vb)[0];this._swingTransform=this.getEntity().getComponentsInChildren(Gb)[0];null==this.get_state()&&this.set_state(new pc(this))},update:function(){m.prototype.update.call(this);
this._stateMachine.onUpdate()},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this._stateMachine.onFixedUpdate();this.constrainPosition()},postUpdate:function(){m.prototype.postUpdate.call(this);this._stateMachine.onPostUpdate();this.constrainPosition()},constrainPosition:function(){var a=this.getEntity().getLocalPosition();a.x<this.minX&&(a.x=this.minX);a.x>this.maxX&&(a.x=this.maxX);this.getEntity().setLocalPosition(a.x,a.y)},startCharge:function(){this._playerChargeController.startCharge()},
swingWithCurrentCharge:function(){this.swingWithCharge(this._playerChargeController.chargePercentage)},swingWithRandomCharge:function(){for(var a=Infinity,b=-Infinity,c=this._config.swingDirection.getNormalized(),d=0;50>d;){var e=0.02*d++,f=V.lerp(this._config.minSwingPower,this._config.swingPower,e),f=new t(c.x*f,c.y*f),f=this._swingTransform.birdie.getProjectedXAtYWithVelocity(f,this._swingTransform.birdie.groundY);f<this.minTargetX||f>this.maxTargetX||(e<a&&(a=e),e>b&&(b=e))}a=V.randomFloat(a,
b);this.swingWithCharge(a)},swingIfTouchingBirdie:function(){this._swingTransform.get_touchingBirdie()&&(this.swingWithRandomCharge(),q.playRandomSoundByName(["sfxBirdieHit1","sfxBirdieHit2","sfxBirdieHit3"]))},swingWithCharge:function(a){this._swingTransform.get_touchingBirdie()&&(a=V.lerp(this._config.minSwingPower,this._config.swingPower,a),this._swingTransform.birdie.hit(a,this._config.swingDirection,this.getEntity()));this.set_state(new Ae(this));this.endCharge()},endCharge:function(){this._playerChargeController.endCharge()},
handleLeftStart:function(){this._stateMachine.handleLeftDown()},handleLeftEnd:function(){this._stateMachine.handleLeftUp()},handleRightStart:function(){this._stateMachine.handleRightDown()},handleRightEnd:function(){this._stateMachine.handleRightUp()},handleActionStart:function(){this._stateMachine.handleActionDown()},handleActionEnd:function(){this._stateMachine.handleActionUp()},handleUpStart:function(){},handleUpEnd:function(){},handleDownStart:function(){},handleDownEnd:function(){},__class__:kb,
__properties__:{get_swingTransform:"get_swingTransform",set_velocity:"set_velocity",get_velocity:"get_velocity",get_movementSpeed:"get_movementSpeed",set_config:"set_config",get_config:"get_config",set_state:"set_state",get_state:"get_state",get_audioSource:"get_audioSource"}});var we=function(a){m.call(this,a);this._stateMachine=new Be};we.__name__="game gameplay minigames badminton badmintonPlayer BadmintonPlayerAiController".split(" ");we.__super__=m;we.prototype=p(m.prototype,{get_state:function(){return this._stateMachine.getState()},
set_state:function(a){this._stateMachine.setState(a);return a},init:function(){m.prototype.init.call(this);this.badmintonPlayer=this.getComponent(kb)},update:function(){m.prototype.update.call(this);this._stateMachine.onUpdate()},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this._stateMachine.onFixedUpdate()},postUpdate:function(){m.prototype.postUpdate.call(this);this._stateMachine.onPostUpdate()},__class__:we,__properties__:{set_state:"set_state",get_state:"get_state"}});var td=function(){this.animationPrefix=
"";this.swingPower=800;this.minSwingPower=350;this.swingDirection=new t(1,-2);this.movementSpeed=450};td.__name__="game gameplay minigames badminton badmintonPlayer BadmintonPlayerConfig".split(" ");td.prototype={parse:function(a){this.movementSpeed=a.movementSpeed;this.swingDirection=new t(a.swingDirection[0],a.swingDirection[1]);this.minSwingPower=a.minSwingPower;this.swingPower=a.swingPower;this.animationPrefix=a.animationPrefix},__class__:td};var oc=function(a,b){this.chargePercentage=0;this.chargeDuration=
0.65;this._isCharging=!1;m.call(this,a);this._badmintonPlayer=b;this._badmintonFactory=new ve(null)};oc.__name__="game gameplay minigames badminton badmintonPlayer PlayerChargeController".split(" ");oc.__super__=m;oc.prototype=p(m.prototype,{fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this._isCharging&&(this.chargePercentage+=n.getDeltaTime()/this.chargeDuration,1<=this.chargePercentage&&(this.chargePercentage=1),this._chargeMeter.set_fill(this.chargePercentage))},startCharge:function(){this._isCharging||
(this._isCharging=!0,this.chargePercentage=0)},endCharge:function(){this._isCharging&&(this._isCharging=!1)},__class__:oc});var Uf=function(a,b){m.call(this,a);this._fillEntity=b};Uf.__name__="game gameplay minigames badminton badmintonPlayer PlayerChargeUi".split(" ");Uf.__super__=m;Uf.prototype=p(m.prototype,{get_fill:function(){return this._fillEntity.getLocalScale().x},set_fill:function(a){this._fillEntity.setLocalScale(a,1);return a},__class__:Uf,__properties__:{set_fill:"set_fill",get_fill:"get_fill"}});
var Gb=function(a){m.call(this,a);a=new Xa;a.wh=new t(125,100);this._boxCollider=new Ya(this.getEntity(),a,new F(0,15))};Gb.__name__="game gameplay minigames badminton badmintonPlayer PlayerSwingTransform".split(" ");Gb.__super__=m;Gb.prototype=p(m.prototype,{get_touchingBirdie:function(){var a=this.birdie.getEntity().getPosition();return this._boxCollider.checkPointIntersect(new t(a.x,a.y))},__class__:Gb,__properties__:{get_touchingBirdie:"get_touchingBirdie"}});var Yb=function(a){this._context=
a};Yb.__name__=["game","stateMachine","State"];Yb.prototype={getContext:function(){return this._context},onEnter:function(){},onUpdate:function(){},onFixedUpdate:function(){},onPostUpdate:function(){},onExit:function(){},__class__:Yb};var Hb=function(a){this._context=a;this.badmintonPlayer=this.getContext().getComponent(kb)};Hb.__name__="game gameplay minigames badminton badmintonPlayer aiStates BadmintonPlayerAiState".split(" ");Hb.__super__=Yb;Hb.prototype=p(Yb.prototype,{__class__:Hb});var lb=
function(){};lb.__name__=["game","stateMachine","StateMachine"];lb.prototype={getState:function(){return this._state},setState:function(a){if(null!=this._state)this._state.onExit();this._state=a;if(null!=this._state)this._state.onEnter()},onUpdate:function(){if(null!=this._state)this._state.onUpdate()},onFixedUpdate:function(){if(null!=this._state)this._state.onFixedUpdate()},onPostUpdate:function(){if(null!=this._state)this._state.onPostUpdate()},__class__:lb};var Be=function(){};Be.__name__="game gameplay minigames badminton badmintonPlayer aiStates BadmintonPlayerAiStateMachine".split(" ");
Be.__super__=lb;Be.prototype=p(lb.prototype,{getState:function(){return lb.prototype.getState.call(this)},__class__:Be});var nc=function(a){this._maxSwingPositionX=512;this._minSwingPositionX=0;this._maxSwingPower=0.8;this._minSwingPower=0.2;Hb.call(this,a)};nc.__name__="game gameplay minigames badminton badmintonPlayer aiStates BeACompleteJerkState".split(" ");nc.__super__=Hb;nc.prototype=p(Hb.prototype,{onEnter:function(){Hb.prototype.onEnter.call(this)},onFixedUpdate:function(){Hb.prototype.onFixedUpdate.call(this);
var a=this.badmintonPlayer.get_swingTransform();if(a.get_touchingBirdie()){var b=!a.birdie.isActive();0<a.birdie.getEntity().getLocalPosition().x&&(0<a.birdie.get_velocity().y||b)&&(b=(this.getContext().getEntity().getLocalPosition().x-this._minSwingPositionX)/(this._maxSwingPositionX-this._minSwingPositionX),0>b&&(b=0),1<b&&(b=1),b=V.lerp(this._minSwingPower,this._maxSwingPower,b),this.badmintonPlayer.get_state().handleSwingWithCharge(b),this.badmintonPlayer.handleLeftEnd(),this.badmintonPlayer.handleRightEnd())}else{a.birdie.getEntity().getPosition();
var b=a.birdie.getProjectedXAtY(this.getContext().badmintonPlayer.getEntity().getPosition().y),c=this.getContext().getEntity().getPosition(),d=this.getContext().getEntity().getLocalPosition(),a=0<a.birdie.get_velocity().x&&0<a.birdie.get_velocity().y,e=this.getContext().getEntity().getLocalPosition().x>=this.getContext().badmintonPlayer.maxX;a?50<=Math.abs(b+-25-c.x)?(b>c.x&&!e&&(this.badmintonPlayer.handleRightStart(),this.badmintonPlayer.handleLeftEnd()),b<c.x&&(this.badmintonPlayer.handleLeftStart(),
this.badmintonPlayer.handleRightEnd()),e&&this.badmintonPlayer.handleRightEnd()):(this.badmintonPlayer.handleLeftEnd(),this.badmintonPlayer.handleRightEnd()):350<=d.x?this.badmintonPlayer.handleLeftStart():this.badmintonPlayer.handleLeftEnd()}},onExit:function(){Hb.prototype.onExit.call(this)},__class__:nc});var Ib=function(a){this._context=a};Ib.__name__="game gameplay minigames badminton badmintonPlayer states BadmintonPlayerState".split(" ");Ib.__super__=Yb;Ib.prototype=p(Yb.prototype,{handleActionDown:function(){},
handleActionUp:function(){},handleLeftDown:function(){},handleLeftUp:function(){},handleRightDown:function(){},handleRightUp:function(){},handleSwingWithCharge:function(a){},__class__:Ib});var ze=function(){};ze.__name__="game gameplay minigames badminton badmintonPlayer states BadmintonPlayerStateMachine".split(" ");ze.__super__=lb;ze.prototype=p(lb.prototype,{getState:function(){return lb.prototype.getState.call(this)},handleActionDown:function(){null!=this.getState()&&this.getState().handleActionDown()},
handleActionUp:function(){null!=this.getState()&&this.getState().handleActionUp()},handleLeftDown:function(){null!=this.getState()&&this.getState().handleLeftDown()},handleLeftUp:function(){null!=this.getState()&&this.getState().handleLeftUp()},handleRightDown:function(){null!=this.getState()&&this.getState().handleRightDown()},handleRightUp:function(){null!=this.getState()&&this.getState().handleRightUp()},__class__:ze});var qa=function(a){this._context=a};qa.__name__="game gameplay minigames badminton badmintonPlayer states SwingableState".split(" ");
qa.__super__=Ib;qa.prototype=p(Ib.prototype,{onFixedUpdate:function(){Ib.prototype.onFixedUpdate.call(this);this.getContext().swingIfTouchingBirdie()},__class__:qa});var pc=function(a){this._context=a};pc.__name__="game gameplay minigames badminton badmintonPlayer states IdleState".split(" ");pc.__super__=qa;pc.prototype=p(qa.prototype,{onEnter:function(){qa.prototype.onEnter.call(this);this.getContext().playAnimation("Idle");0<this.getContext().get_config().swingDirection.x?this.getContext().faceRight():
this.getContext().faceLeft()},handleLeftDown:function(){qa.prototype.handleLeftDown.call(this);this.getContext().set_state(new ud(this.getContext(),new F(-1,0)))},handleRightDown:function(){qa.prototype.handleRightDown.call(this);this.getContext().set_state(new ud(this.getContext(),new F(1,0)))},__class__:pc});var ud=function(a,b){this._context=a;this._direction=b;this._velocity=new F;var c=this._direction.x,d=this.getContext().get_movementSpeed();this._velocity.x=c*d};ud.__name__="game gameplay minigames badminton badmintonPlayer states RunState".split(" ");
ud.__super__=qa;ud.prototype=p(qa.prototype,{onEnter:function(){qa.prototype.onEnter.call(this);this.getContext().set_velocity(this._velocity);this.getContext().get_audioSource().playRandom(["sfxWalkingGrassLoop","sfxWalkingGrassLoop2","sfxWalkingGrassLoop3"],!0);this.getContext().playAnimation("Move");0>this._velocity.x?this.getContext().faceLeft():0<this._velocity.x&&this.getContext().faceRight()},onFixedUpdate:function(){qa.prototype.onFixedUpdate.call(this)},onExit:function(){qa.prototype.onExit.call(this);
this.getContext().set_velocity(new F(0,0,0));this.getContext().get_audioSource().stop()},handleLeftUp:function(){qa.prototype.handleLeftUp.call(this);0>this._velocity.x&&this.getContext().set_state(new pc(this.getContext()))},handleRightUp:function(){qa.prototype.handleRightUp.call(this);0<this._velocity.x&&this.getContext().set_state(new pc(this.getContext()))},__class__:ud});var Ce=function(a){this._timeUntilSwing=0.35;this._context=a};Ce.__name__="game gameplay minigames badminton badmintonPlayer states ServeState".split(" ");
Ce.__super__=qa;Ce.prototype=p(qa.prototype,{onEnter:function(){qa.prototype.onEnter.call(this);this.getContext().playAnimation("Serve");this.getContext().get_swingTransform().birdie.setActive(!0)},onFixedUpdate:function(){0<this._timeUntilSwing?(this._timeUntilSwing-=n.getDeltaTime(),0>=this._timeUntilSwing&&(this._timeUntilSwing=0)):qa.prototype.onFixedUpdate.call(this)},handleSwingWithCharge:function(a){0>=this._timeUntilSwing&&qa.prototype.handleSwingWithCharge.call(this,a)},__class__:Ce});var Nc=
function(a){this._context=a};Nc.__name__="game gameplay minigames badminton badmintonPlayer states ServeWaitState".split(" ");Nc.__super__=qa;Nc.prototype=p(qa.prototype,{onEnter:function(){qa.prototype.onEnter.call(this);this.getContext().playAnimation("Serve");this.getContext().stopAnimation();0<this.getContext().get_config().swingDirection.x?this.getContext().faceRight():this.getContext().faceLeft();var a=this.getContext().get_swingTransform().birdie,b=this.getContext().getEntity().getPosition();
a.getEntity().setPosition(b.x+-34,b.y+-172);console.log(a)},onFixedUpdate:function(){},handleSwingWithCharge:function(a){this.getContext().set_state(new Ce(this.getContext()))},__class__:Nc});var Ae=function(a){this._context=a};Ae.__name__="game gameplay minigames badminton badmintonPlayer states SwingState".split(" ");Ae.__super__=Ib;Ae.prototype=p(Ib.prototype,{onEnter:function(){Ib.prototype.onEnter.call(this);this.getContext().playAnimation("Hit",w(this,this.onAnimationComplete));0<this.getContext().get_config().swingDirection.x?
this.getContext().faceRight():this.getContext().faceLeft()},onAnimationComplete:function(){this.getContext().set_state(new pc(this.getContext()))},__class__:Ae});var qc=function(a,b){this.hideDirection=Sa.Down;this.scale=1;this._hasPoppedOut=this.shouldUseMask=!1;this._hideDistance=0;m.call(this,a);this._hiddenObjectConfig=b};qc.__name__=["game","gameplay","minigames","hideAndSeek","HiddenObject"];qc.__super__=m;qc.prototype=p(m.prototype,{get_sprite:function(){return this._sprite},get_hiddenObjectConfig:function(){return this._hiddenObjectConfig},
set_hiddenObjectConfig:function(a){return this._hiddenObjectConfig=a},get_hideDistance:function(){return this._hideDistance},set_hideDistance:function(a){this.setSpriteY(a);return this._hideDistance=a},init:function(){m.prototype.init.call(this);this._button=this.getEntity().getComponent(ha);this._button.setOnMouseDown(w(this,this.onMouseDown));var a=this._button.getCollisionSize();this._button.setCollisionProperties(new t(1.5*a.x,Math.max(120,a.y-this._hideDistance)),new t(0,0));this._sprite=this.getEntity().getComponentsInChildren(A)[0];
this._tweener=new Aa(this.getEntity());this.shouldUseMask&&(this._mask=new PIXI.Graphics);switch(this.hideDirection[1]){case 0:null!=this._mask&&(this._mask.beginFill(16711935,1),this._mask.drawRect(0.5*-this._sprite.get_width(),0.5*-this._sprite.get_height(),2*this._sprite.get_width(),this._sprite.get_height()),this._mask.endFill());this.setSpriteX(-this.get_hideDistance());this._sprite.getEntity().setLocalScale(-1,1);break;case 1:null!=this._mask&&(this._mask.beginFill(16711935,1),this._mask.drawRect(-this._sprite.get_width(),
0.5*-this._sprite.get_height(),1.5*this._sprite.get_width(),this._sprite.get_height()),this._mask.endFill());this.setSpriteX(this.get_hideDistance());break;case 2:null!=this._mask&&(this._mask.beginFill(16711935,1),this._mask.drawRect(0.5*-this._sprite.get_width(),-this._sprite.get_height(),this._sprite.get_width(),1.5*this._sprite.get_height()),this._mask.endFill()),this.setSpriteY(this.get_hideDistance())}a=this.getEntity().getComponent(ia);null==a&&(a=new ia(this.getEntity()));this.shouldUseMask&&
(a.getContainer().addChild(this._mask),this._sprite.getSprite().mask=this._mask)},onMouseDown:function(){this.isActive()&&this.find()},setSpriteY:function(a){null!=this._sprite&&this._sprite.getEntity().setLocalPosition(0,a)},setSpriteX:function(a){null!=this._sprite&&this._sprite.getEntity().setLocalPosition(a,0)},tweenSpriteToX:function(a,b){this._tweener.skipAll();this._tweener.addTween(this._sprite.getEntity().getPositionRef(),"x",this._sprite.getEntity().getLocalPosition().x,a,b,E.easeOutBack)},
tweenSpriteToY:function(a,b){this._tweener.skipAll();this._tweener.addTween(this._sprite.getEntity().getPositionRef(),"y",this._sprite.getEntity().getLocalPosition().y,a,b,E.easeOutBack)},find:function(){this.dispatchEvent(new vd("found"))},popOut:function(){this._hasPoppedOut||(2==this.hideDirection[1]?this.tweenSpriteToY(0,0.35):this.tweenSpriteToX(0,0.35),this._hasPoppedOut=!0)},__class__:qc,__properties__:{set_hideDistance:"set_hideDistance",get_hideDistance:"get_hideDistance",set_hiddenObjectConfig:"set_hiddenObjectConfig",
get_hiddenObjectConfig:"get_hiddenObjectConfig",get_sprite:"get_sprite"}});var Vf=function(){this.noMobile=!1;this.possiblePlacements=[]};Vf.__name__=["game","gameplay","minigames","hideAndSeek","HiddenObjectConfig"];Vf.prototype={parse:function(a){this.imageId=a.imageId;this.thumbImageId=a.thumbImageId;null!=a.noMobile&&(this.noMobile=a.noMobile);for(var b=0,c=a.possiblePlacements.length;b<c;){var d=b++,e=new Wf;e.parse(a.possiblePlacements[d]);this.possiblePlacements.push(e)}},__class__:Vf};var vd=
function(a){this._type=a};vd.__name__=["game","gameplay","minigames","hideAndSeek","HiddenObjectEvent"];vd.__super__=Q;vd.prototype=p(Q.prototype,{__class__:vd});var Wf=function(){this.layerIndex=0;this.scale=1;this.hideDirection=Sa.Down;this.hideDistance=0};Wf.__name__=["game","gameplay","minigames","hideAndSeek","HiddenObjectPlacementConfig"];Wf.prototype={parse:function(a){this.position=new t(a.position[0],a.position[1]);this.hideDistance=a.hideDistance;null!=a.hideDirection&&(this.hideDirection=
Wa.createEnum(Sa,a.hideDirection,null));null!=a.scale&&(this.scale=a.scale);null!=a.layerIndex&&(this.layerIndex=a.layerIndex)},__class__:Wf};var Xf=function(a){this._hideAndSeekSceneConfig=a};Xf.__name__=["game","gameplay","minigames","hideAndSeek","HiddenObjectSelector"];Xf.prototype={getRandomHiddenObjectConfig:function(){for(var a=[],b=0,c=this._hideAndSeekSceneConfig.hiddenObjectConfigs;b<c.length;){var d=c[b];++b;n.isMobile()&&d.noMobile||a.push(d)}b=V.randomInt(0,a.length);return a[b]},__class__:Xf};
var Yf=function(){this.timePerObjectFound=5;this.scenes=[];this.startingTime=this.maxTime=15.99};Yf.__name__=["game","gameplay","minigames","hideAndSeek","HideAndSeekConfig"];Yf.prototype={parse:function(a){this.startingTime=a.startingTime;this.maxTime=a.maxTime;this.timePerObjectFound=a.timePerObjectFound;for(var b=0,c=a.scenes.length;b<c;){var d=b++,e=new Zf;e.parse(a.scenes[d]);this.scenes.push(e)}},__class__:Yf};var Ee=function(a,b){this._shouldShowHiddenObjectIndicator=!1;this._hiddenObjects=
[];this._nextSceneDelay=1;ja.call(this,a,b);this._hideAndSeekConfig=new Yf;this._hideAndSeekConfig.parse(JSON.parse(H.getAsset("hideAndSeekConfig")));this._scoreController.get_config().parse(JSON.parse(H.getAsset("hideAndSeekConfig")));this._sceneSelector=new $f(this._hideAndSeekConfig.scenes);var c=this.addEntity();new Hc(c);var d=c.addEntity();this._background=d.addEntity();var e=this._background.addEntity();this._backgroundSpriteLeft=new A(e,"");this._backgroundSpriteLeft.setAnchor(1,0.5);e=this._background.addEntity();
this._backgroundSpriteRight=new A(e,"");this._backgroundSpriteRight.setAnchor(0,0.5);this._foreground=d.addEntity();d=this._foreground.addEntity();this._foregroundSpriteLeft=new A(d,"");this._foregroundSpriteLeft.setAnchor(1,0.5);d=this._foreground.addEntity();this._foregroundSpriteRight=new A(d,"");this._foregroundSpriteRight.setAnchor(0,0.5);c=c.addEntity();d=c.addEntity();(new A(d,"hideAndSeekCurtains")).setAnchor(1,0.5);d.setLocalPosition(-512,0);d=c.addEntity();(new A(d,"hideAndSeekCurtains")).setAnchor(1,
0.5);d.setLocalPosition(-751,0);d=c.addEntity();(new A(d,"hideAndSeekCurtains")).setAnchor(0,0.5);d.setLocalPosition(512,0);c=c.addEntity();(new A(c,"hideAndSeekCurtains")).setAnchor(0,0.5);c.setLocalPosition(751,0);c=new De;c.set_minX(-512);c.set_maxX(512);c.set_minY(-100);c.set_maxY(400);this._positionGenerator=c;this._timeController=new se(this.getEntity());this._timeController.setActive(!1);this._timeController.set_timeLeft(this._hideAndSeekConfig.maxTime);this._timeController.addEventListener("timeElapse",
w(this,this.onTimeElapse));q.playMusicByName("musicSambaIsobel");this._config.tutorialImageIdBase="hideAndSeekTutorial";this._config.tutorialStringIdBase="HIDE_AND_SEEK_TUTORIAL"};Ee.__name__=["game","gameplay","minigames","hideAndSeek","HideAndSeekController"];Ee.__super__=ja;Ee.prototype=p(ja.prototype,{get_hasTimer:function(){return!0},get_timeLeft:function(){return this._timeController.get_timeLeft()},get_scoreString:function(){return ra.string(this._scoreController.get_score())},onTimeElapse:function(a){this.onGameOver()},
init:function(){ja.prototype.init.call(this);this._gameController.minigameSuggestionController.incrementMinigamePlay(va.HideAndSeek);this.gotoNextScene()},update:function(){ja.prototype.update.call(this)},gotoNextScene:function(){this.clearHiddenObjects();this._currentScene=this._sceneSelector.nextRandomScene();this.processScene(this._currentScene)},processScene:function(a){this._background.getParent().setLocalPosition(-a.cameraPanX,0);null!=this._layersRoot&&this._layersRoot.destroy();switch(a.sceneType[1]){case 0:this._backgroundSpriteLeft.getEntity().setVisible(!0);
this._backgroundSpriteRight.getEntity().setVisible(!0);this._foregroundSpriteLeft.getEntity().setVisible(!0);this._foregroundSpriteRight.getEntity().setVisible(!0);this._backgroundSpriteLeft.setImage(a.backgroundImageIdBase+"Left");this._backgroundSpriteRight.setImage(a.backgroundImageIdBase+"Right");this._foregroundSpriteLeft.setImage(a.backgroundImageIdBase+"LeftFront");this._foregroundSpriteRight.setImage(a.backgroundImageIdBase+"RightFront");break;case 1:this._layersRoot=this._background.addEntity();
this._backgroundSpriteLeft.getEntity().setVisible(!1);this._backgroundSpriteRight.getEntity().setVisible(!1);this._foregroundSpriteLeft.getEntity().setVisible(!1);this._foregroundSpriteRight.getEntity().setVisible(!1);for(var b=0,c=a.numLayers;b<c;){var d=b++,e=this._layersRoot.addEntity();e.setName("layer"+(d+1));(new A(e,a.backgroundImageIdBase+"Layer"+(d+1))).setAnchor(0.5,0.5)}}this._positionGenerator.get_nextPosition();a=(new Xf(a)).getRandomHiddenObjectConfig();(new Fe).createFromHiddenObjectConfig(this._background,
a)},startGameplay:function(){ja.prototype.startGameplay.call(this);this.listenToHiddenObjects();this._timeController.setActive(!0);this.showFindIndicator(this._hiddenObjects[0].get_hiddenObjectConfig())},listenToHiddenObjects:function(){for(var a=this._background.getComponentsInChildren(qc),b=0,c=a.length;b<c;){var d=b++,d=a[d];d.addEventListener("found",w(this,this.onHiddenObjectFound));this._hiddenObjects.push(d)}},onGameOver:function(){ja.prototype.onGameOver.call(this);this.removeHiddenObjectListeners();
this._timeController.setActive(!1);q.playSoundByName("sfxClockAlarm")},clearHiddenObjects:function(){for(var a=0,b=this._hiddenObjects;a<b.length;){var c=b[a];++a;c.getEntity().destroy()}this._hiddenObjects=[]},showFindIndicator:function(a){null!=this._hiddenObjectIndicator&&this._hiddenObjectIndicator.destroy();var b=new ag(this._uiPanel);this._shouldShowHiddenObjectIndicator&&(this._hiddenObjectIndicator=b.createFindHiddenObjectIndicator(-0.95,0.95,a))},onHiddenObjectFound:function(a){a=a.target;
a.popOut();a.removeEventListener("found",w(this,this.onHiddenObjectFound));this._timeController.setActive(!1);var b=this._scoreController,c=b.get_score();b.set_score(c+1);this._deferredAction.addDeferredAction(this._nextSceneDelay,w(this,this.onNextSceneDelayElapse));b=a.getEntity().getPosition();c=new Fe;0<this._hideAndSeekConfig.timePerObjectFound&&(c=c.createTimeGainEffect(this._background.getParent(),0,0,this._hideAndSeekConfig.timePerObjectFound|0,a.scale),a=0>a.getEntity().getLocalPosition().x,
c.setPosition(b.x+(a?85:-85),b.y));this._shouldShowHiddenObjectIndicator&&(a=this._hiddenObjectIndicator.addEntity(),(new A(a,"hideAndSeekFoundCheck")).setAnchor(0.5,0.5),a.setLocalPosition(60,60));q.playRandomSoundByName(["sfxPuppyYelp1","sfxPuppyYelp2","sfxPuppyYelp3"])},onNextSceneDelayElapse:function(){var a=this._timeController;a.set_timeLeft(a.get_timeLeft()+this._hideAndSeekConfig.timePerObjectFound);this._timeController.get_timeLeft()>this._hideAndSeekConfig.maxTime&&this._timeController.set_timeLeft(this._hideAndSeekConfig.maxTime);
this.gotoNextScene();this._timeController.setActive(!0);this.listenToHiddenObjects();this.showFindIndicator(this._hiddenObjects[0].get_hiddenObjectConfig())},removeHiddenObjectListeners:function(){for(var a=0,b=this._hiddenObjects;a<b.length;){var c=b[a];++a;c.removeEventListener("found",w(this,this.onHiddenObjectFound))}},__class__:Ee});var Fe=function(){};Fe.__name__=["game","gameplay","minigames","hideAndSeek","HideAndSeekFactory"];Fe.prototype={createFromHiddenObjectConfig:function(a,b){var c=
V.randomInt(0,b.possiblePlacements.length),c=b.possiblePlacements[c],d=c.position,d=this.createHiddenObject(a,d.x,d.y,b.imageId,b,c.hideDirection);d.setLocalScale(c.scale,c.scale);var e=d.getComponent(qc);e.set_hideDistance(c.hideDistance);e.scale=c.scale;c=a.findChildByName("layer"+c.layerIndex);null!=c&&c.addChild(d);return d},createHiddenObject:function(a,b,c,d,e,f){a=a.addEntity();var g=a.addEntity();d=new A(g,d);d.setAnchor(0.5,0.5);(new ha(a,new t(d.getSprite().width,d.getSprite().height))).handPointer=
!1;(new qc(a,e)).hideDirection=f;a.setLocalPosition(b,c);return a},createTimeGainEffect:function(a,b,c,d,e){var f=a.addEntity();a=new ia(f);b=f.addEntity();c=new Aa(b);b.setLocalRotation2d(-10);var g=b.addEntity();(new A(g,"hideAndSeekClock")).setAnchor(0.5,0.5);g.setLocalPosition(-25,0);g=b.addEntity();g.setLocalPosition(5,0);(new ta(g,"+"+d,{fontFamily:"ralewayblack",fill:"#FFFFFF",fontSize:48})).setAnchor(0,0.5);c.addTween(b.getPositionRef(),"y",0,-175*e,0.5,E.easeOutBack);c.addTween(a.getContainer(),
"alpha",1,0,0.5,E.linear,1,function(a){f.destroy()});return f},__class__:Fe};var Zf=function(){this.numLayers=2;this.sceneType=Jb.LeftAndRight;this.cameraPanX=0;this.hiddenObjectConfigs=[]};Zf.__name__=["game","gameplay","minigames","hideAndSeek","HideAndSeekSceneConfig"];Zf.prototype={parse:function(a){this.backgroundImageIdBase=a.backgroundImageIdBase;this.cameraPanX=a.cameraPanX;var b=a.hiddenObjectConfigs.length;null!=a.sceneType&&(this.sceneType=Wa.createEnum(Jb,a.sceneType,null));null!=a.numLayers&&
(this.numLayers=a.numLayers);for(var c=0;c<b;){var d=c++,e=new Vf;e.parse(a.hiddenObjectConfigs[d]);this.hiddenObjectConfigs.push(e)}},__class__:Zf};var ag=function(a){this._uiPanel=a};ag.__name__=["game","gameplay","minigames","hideAndSeek","HideAndSeekUiFactory"];ag.prototype={createFindHiddenObjectIndicator:function(a,b,c){var d=this._uiPanel.addEntity(),e=new ca(d,this._uiPanel);e.setCoords(new t(a,b));a=d.addEntity();c=new A(a,c.thumbImageId);c.setAnchor(0,1);e.setSize(new t(c.get_width(),c.get_height()));
return d},__class__:ag};var Sa={__ename__:!0,__constructs__:["Left","Right","Down"],Left:["Left",0]};Sa.Left.__enum__=Sa;Sa.Right=["Right",1];Sa.Right.__enum__=Sa;Sa.Down=["Down",2];Sa.Down.__enum__=Sa;Sa.__empty_constructs__=[Sa.Left,Sa.Right,Sa.Down];var $f=function(a){this._usedScenes=[];this._availableScenes=[];this._availableScenes=[];this._availableScenes=this._availableScenes.concat(a)};$f.__name__=["game","gameplay","minigames","hideAndSeek","SceneSelector"];$f.prototype={get_isSceneAvailable:function(){return 0<
this._availableScenes.length},nextRandomScene:function(){0==this._availableScenes.length&&this.resetScenes();var a=V.randomInt(0,this._availableScenes.length),a=this._availableScenes[a];G.remove(this._availableScenes,a);this._usedScenes.push(a);this.get_isSceneAvailable()||(this.resetScenes(),G.remove(this._availableScenes,a),this._usedScenes.push(a));return a},resetScenes:function(){this._availableScenes=this._availableScenes.concat(this._usedScenes);this._usedScenes=[]},__class__:$f,__properties__:{get_isSceneAvailable:"get_isSceneAvailable"}};
var Jb={__ename__:!0,__constructs__:["LeftAndRight","Layered"],LeftAndRight:["LeftAndRight",0]};Jb.LeftAndRight.__enum__=Jb;Jb.Layered=["Layered",1];Jb.Layered.__enum__=Jb;Jb.__empty_constructs__=[Jb.LeftAndRight,Jb.Layered];var Oc=function(a,b){this._shadows=[];this._obstacles=[];this._lanes=[];this._runnerStartX=275;this._baselineY=610;ja.call(this,a,b);this._config.tutorialImageIdBase="horseRidingTutorial";this._config.tutorialStringIdBase="HORSE_RIDING_TUTORIAL";this._countdownDelay=0};Oc.__name__=
["game","gameplay","minigames","infiniteRunner","InfiniteRunner"];Oc.__interfaces__=[Ic];Oc.__super__=ja;Oc.prototype=p(ja.prototype,{get_scoreString:function(){return ra.string(this._scoreController.get_score())},init:function(){ja.prototype.init.call(this);this._gameController.minigameSuggestionController.incrementMinigamePlay(va.InfiniteRunner);null==Ia.getInstance().getAnimationByName("horseRidingHorseRun")&&(pa.createAnimation("horseRidingHorseRun","horseRidingHorseRunXml",new t(-228,-284),2,
!0),pa.appendAnimation("horseRidingHorseRun","horseRidingHorseRun2","horseRidingHorseRun2Xml",new t(-228,-284),2),pa.createAnimation("horseRidingHorseJump","horseRidingHorseJumpXml",new t(-228,-284),3,!1),pa.createAnimation("horseRidingHorseFail","horseRidingHorseFailXml",new t(-228,-284),3,!1),pa.createAnimation("horseRidingFxFail","horseRidingFxFailXml",new t(-177,-135),2,!1));this._tweener=new Aa(this.getEntity());this._infiniteRunnerConfig=new bg;this._infiniteRunnerConfig.parse(JSON.parse(H.getAsset("infiniteRunnerConfig")));
this._scoreController.get_config().parse(JSON.parse(H.getAsset("infiniteRunnerConfig")));this._backgroundScrollPositionAgent=this.addEntity();new Hc(this._backgroundScrollPositionAgent);this._scrollableGroup=new Pf;this._scrollableGroup.addScrollable(this);this._backgroundLayer=this.addEntity();var a=new Wb(this._backgroundLayer,this._backgroundScrollPositionAgent,["horseRidingBgSky"]);a.set_parallax(0.7);this._scrollableGroup.addScrollable(a);this._roadLayer=this.addEntity();this._roadLayer.setLocalPosition(0,
380);a=this._roadLayer.addEntity();a=new Wb(a,this._backgroundScrollPositionAgent,["horseRidingBgGround"]);this._scrollableGroup.addScrollable(a);a=this.addEntity();a.setLocalPosition(0,100);a=new Wb(a,this._backgroundScrollPositionAgent,["horseRidingBgBush"]);this._scrollableGroup.addScrollable(a);a=this.addEntity();a.setLocalPosition(0,350);a=new Wb(a,this._backgroundScrollPositionAgent,["horseRidingBgFence1","horseRidingBgFence2"]);this._scrollableGroup.addScrollable(a);this._gameScrollController=
new re(this.getEntity(),this._scrollableGroup);this._gameScrollController.set_scrollSpeed(0);this._gameScrollController.setActive(!1);this._gameplayLayer=this.addEntity();var a=this._gameplayLayer.addEntity(),b=new A(a,"horseRidingHorseShadow");b.setAnchor(0.5,0.5);b.getSprite().blendMode=PIXI.BLEND_MODES.MULTIPLY;a.setPosition(this._runnerStartX,this._baselineY-25);a=(new Ge).createPlayer(this._gameplayLayer,this._runnerStartX,this._baselineY);this._player=a.getComponent(Pc);this._player.set_groundY(this._baselineY);
this._player.addEventListener("hitObstacle",w(this,this.onPlayerHitObstacle));new sd(a,this._player);a=this.createLane(this._baselineY);this.initLaneObjectSpawner(a);this._runnerCollisionDetection=new cg;this._runnerCollisionDetection.set_players([this._player]);this._runnerCollisionDetection.set_obstacles(this._obstacles);this._runnerObstaclePassDetection=new He;this._runnerObstaclePassDetection.set_players([this._player]);this._runnerObstaclePassDetection.set_obstacles(this._obstacles);this._runnerObstaclePassDetection.addEventListener("pass",
w(this,this.onObstaclePass));a=this.addEntity();new ha(a,new t(8E3,3E3));new te(a,this._player);this.processDifficultyConfigForJumps(0);q.playMusicByName("musicGutsAndBourbon")},initLaneObjectSpawner:function(a){this._laneObjectSpawner=new wd(this._gameplayLayer,a);this._laneObjectSpawner.set_minDistanceUntilObject(this._infiniteRunnerConfig.minObstacleSpawnDistance);this._laneObjectSpawner.set_maxDistanceUntilObject(this._infiniteRunnerConfig.maxObstacleSpawnDistance);this._laneObjectSpawner.set_chanceToSpawn(1);
this._shortObstacleSpawnConfig=new Zb;this._shortObstacleSpawnConfig.prototype=new Ie;this._shortObstacleSpawnConfig.chance=1;this._laneObjectSpawner.addLaneObjectSpawnConfig(this._shortObstacleSpawnConfig);this._midObstacleSpawnConfig=new Zb;this._midObstacleSpawnConfig.prototype=new Je;this._midObstacleSpawnConfig.chance=0;this._laneObjectSpawner.addLaneObjectSpawnConfig(this._midObstacleSpawnConfig);this._highObstacleSpawnConfig=new Zb;this._highObstacleSpawnConfig.prototype=new Ke;this._highObstacleSpawnConfig.chance=
0;this._laneObjectSpawner.addLaneObjectSpawnConfig(this._highObstacleSpawnConfig);this._hayBaleObstacleSpawnConfig=new Zb;this._hayBaleObstacleSpawnConfig.prototype=new Le;this._hayBaleObstacleSpawnConfig.chance=0;this._laneObjectSpawner.addLaneObjectSpawnConfig(this._hayBaleObstacleSpawnConfig);this._hayBaleMidObstacleSpawnConfig=new Zb;this._hayBaleMidObstacleSpawnConfig.prototype=new Me;this._hayBaleMidObstacleSpawnConfig.chance=0;this._laneObjectSpawner.addLaneObjectSpawnConfig(this._hayBaleMidObstacleSpawnConfig);
this._puddleObstacleSpawnConfig=new Zb;this._puddleObstacleSpawnConfig.prototype=new Ne;this._puddleObstacleSpawnConfig.chance=0;this._laneObjectSpawner.addLaneObjectSpawnConfig(this._puddleObstacleSpawnConfig);this._laneObjectSpawner.addEventListener("spawn",w(this,this.onObjectSpawn));this._scrollableGroup.addScrollable(this._laneObjectSpawner);this._laneObjectSpawner.setActive(!1)},scroll:function(a){for(var b=0,c=this._shadows;b<c.length;){var d=c[b];++b;d.translate(a,0)}},onObstaclePass:function(a){a=
this._scoreController;var b=a.get_score();a.set_score(b+1);a=this._scoreController.get_score();this.processDifficultyConfigForJumps(a)},processDifficultyConfigForJumps:function(a){for(var b=0,c=this._infiniteRunnerConfig.infiniteRunnerDifficultyConfigs;b<c.length;){var d=c[b];++b;if(d.numJumps==a){this.processDifficultyConfig(d);break}}},onPlayerHitObstacle:function(){(new Ge).createHitParticleEffect(this._player.getEntity(),0,0);this._tweener.addTween(this._gameScrollController,"scrollSpeed",this._gameScrollController.get_scrollSpeed(),
0,1.15,E.linear);this.onGameOver()},postUpdate:function(){ja.prototype.postUpdate.call(this);this.sortEntities()},fixedUpdate:function(){ja.prototype.fixedUpdate.call(this);this._runnerCollisionDetection.detectCollisions();this._runnerObstaclePassDetection.detectPasses()},createLane:function(a){var b=this.addEntity();b.setLocalPosition(0,a);a=new Qc(b);this._scrollableGroup.addScrollable(a);this._lanes.push(a);return a},processDifficultyConfig:function(a){this.setScrollSpeed(a.horseSpeed);this._shortObstacleSpawnConfig.chance=
a.shortObstaclePercentage;this._midObstacleSpawnConfig.chance=a.midObstaclePercentage;this._highObstacleSpawnConfig.chance=a.highObstaclePercentage;this._hayBaleObstacleSpawnConfig.chance=a.hayBaleObstaclePercentage;this._hayBaleMidObstacleSpawnConfig.chance=a.hayBaleMidObstaclePercentage;this._puddleObstacleSpawnConfig.chance=a.puddleObstaclePercentage},getSortableEntities:function(){for(var a=[],b=0,c=this._obstacles;b<c.length;){var d=c[b];++b;a.push(d.getEntity())}a.push(this._player.getEntity());
return a},sortEntities:function(){var a=this.getSortableEntities();a.sort(function(a,b){return a.getPosition().x<b.getPosition().x?1:a.getPosition().x>b.getPosition().x?-1:0});for(var b=0;b<a.length;){var c=a[b];++b;"puddle"!=c.getName()&&this.getGameState().bringEntityToFront(c)}},setScrollSpeed:function(a){this._gameScrollController.set_scrollSpeed(a)},onObjectSpawn:function(a){var b=this;a=a.get_entity().getComponent(zb);if(null!=a){this._obstacles.push(a);a.addEventListener("destroy",w(this,this.onObstacleDestroy));
var c=a.getEntity().findChildByName("shadow");null!=c&&(this._shadows.push(c),this._roadLayer.addChild(c,!0),a.addEventListener("destroy",function(a){G.remove(b._shadows,c);c.destroy()}))}},onObstacleDestroy:function(a){G.remove(this._obstacles,a.target)},startGameplay:function(){ja.prototype.startGameplay.call(this);this._laneObjectSpawner.setActive(!0)},startCountdown:function(){ja.prototype.startCountdown.call(this);this.startRunning()},startRunning:function(){this._gameScrollController.setActive(!0);
this._player.startRunning()},onGameOver:function(){ja.prototype.onGameOver.call(this);this._gameScrollController.set_scrollSpeed(0)},__class__:Oc});var bg=function(){this.maxObstacleSpawnDistance=800;this.minObstacleSpawnDistance=600;this.infiniteRunnerDifficultyConfigs=[]};bg.__name__=["game","gameplay","minigames","infiniteRunner","InfiniteRunnerConfig"];bg.prototype={parse:function(a){this.minObstacleSpawnDistance=a.minObstacleSpawnDistance;this.maxObstacleSpawnDistance=a.maxObstacleSpawnDistance;
for(var b=0,c=a.difficultyConfigs.length;b<c;){var d=b++,d=a.difficultyConfigs[d],e=new dg;e.parse(d);this.infiniteRunnerDifficultyConfigs.push(e)}},__class__:bg};var dg=function(){this.hayBaleObstaclePercentage=this.hayBaleMidObstaclePercentage=this.puddleObstaclePercentage=0;this.shortObstaclePercentage=this.midObstaclePercentage=this.highObstaclePercentage=1};dg.__name__=["game","gameplay","minigames","infiniteRunner","InfiniteRunnerDifficultyConfig"];dg.prototype={parse:function(a){this.numJumps=
a.numJumps;this.horseSpeed=a.horseSpeed;this.shortObstaclePercentage=a.shortObstaclePercentage;this.midObstaclePercentage=a.midObstaclePercentage;this.hayBaleMidObstaclePercentage=a.hayBaleMidObstaclePercentage;this.highObstaclePercentage=a.highObstaclePercentage;null!=a.hayBaleObstaclePercentage&&(this.hayBaleObstaclePercentage=a.hayBaleObstaclePercentage);null!=a.puddleObstaclePercentage&&(this.puddleObstaclePercentage=a.puddleObstaclePercentage)},__class__:dg};var Ge=function(){};Ge.__name__=["game",
"gameplay","minigames","infiniteRunner","InfiniteRunnerFactory"];Ge.prototype={createPlayer:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);new vb(a,"horseRidingHorseRun");new Pc(a);return a},createHitParticleEffect:function(a,b,c){var d=a.addEntity();d.setLocalPosition(b,c);(new vb(d,"horseRidingFxFail")).setAnimation("horseRidingFxFail",function(){d.destroy()});return d},__class__:Ge};var Qc=function(a){this._entities=[];m.call(this,a)};Qc.__name__=["game","gameplay","minigames","infiniteRunner",
"Lane"];Qc.__interfaces__=[Ic];Qc.__super__=m;Qc.prototype=p(m.prototype,{addToLane:function(a){this._entities.push(a)},update:function(){m.prototype.update.call(this);this.cleanUpObjects()},cleanUpObjects:function(){for(var a=this._entities.length-1;0<=a;){var b=this._entities[a];-450>=b.getLocalPosition().x&&(b.destroy(),this._entities.splice(a,1));--a}},scroll:function(a){for(var b=0,c=this._entities;b<c.length;){var d=c[b];++b;d.translate(a,0)}},__class__:Qc});var Zb=function(){this.prototype=
null;this.chance=1};Zb.__name__=["game","gameplay","minigames","infiniteRunner","LaneObjectSpawnConfig"];Zb.prototype={__class__:Zb};var wd=function(a,b){this._laneObjectSpawnConfigs=[];this._maxDistanceUntilObject=300;this._minDistanceUntilObject=200;this._distanceUntilNextObject=0;this._objectSpawnX=1500;this._chanceToSpawn=0.35;m.call(this,a);this._lane=b};wd.__name__=["game","gameplay","minigames","infiniteRunner","LaneObjectSpawner"];wd.__interfaces__=[Ic];wd.__super__=m;wd.prototype=p(m.prototype,
{get_chanceToSpawn:function(){return this._chanceToSpawn},set_chanceToSpawn:function(a){return this._chanceToSpawn=a},get_minDistanceUntilObject:function(){return this._minDistanceUntilObject},set_minDistanceUntilObject:function(a){return this._minDistanceUntilObject=a},get_maxDistanceUntilObject:function(){return this._maxDistanceUntilObject},set_maxDistanceUntilObject:function(a){return this._maxDistanceUntilObject=a},init:function(){m.prototype.init.call(this);this.rollNextObject()},addLaneObjectSpawnConfig:function(a){this._laneObjectSpawnConfigs.push(a)},
rollNextObject:function(){this._distanceUntilNextObject=V.randomFloat(this._minDistanceUntilObject,this._maxDistanceUntilObject)},scroll:function(a){if(this.isActive()&&(this._distanceUntilNextObject+=a,0>=this._distanceUntilNextObject))this.onDistanceUntilNextObjectElapse()},onDistanceUntilNextObjectElapse:function(){this.rollNextObject();V.randomFloat(0,1)<this._chanceToSpawn&&this.spawnRandomObject()},getRandomLaneObjectSpawnConfig:function(){for(var a=new Jf,b=0,c=this._laneObjectSpawnConfigs;b<
c.length;){var d=c[b];++b;a.addEntry(d.chance,d)}return a.getRandomValue()},spawnRandomObject:function(){var a=this.getRandomLaneObjectSpawnConfig(),b=this._objectSpawnX+this._distanceUntilNextObject,c=this._lane.getEntity().getPosition().y,a=a.prototype.create(this.getEntity(),b,c);a.setPosition(b,c);this._lane.addToLane(a);this.dispatchEvent(new xd("spawn",a));return a},__class__:wd,__properties__:{set_maxDistanceUntilObject:"set_maxDistanceUntilObject",get_maxDistanceUntilObject:"get_maxDistanceUntilObject",
set_minDistanceUntilObject:"set_minDistanceUntilObject",get_minDistanceUntilObject:"get_minDistanceUntilObject",set_chanceToSpawn:"set_chanceToSpawn",get_chanceToSpawn:"get_chanceToSpawn"}});var xd=function(a,b){this._type=a;this._entity=b};xd.__name__=["game","gameplay","minigames","infiniteRunner","ObjectSpawnEvent"];xd.__super__=Q;xd.prototype=p(Q.prototype,{get_entity:function(){return this._entity},__class__:xd,__properties__:{get_entity:"get_entity"}});var eg=function(){};eg.__name__="game gameplay minigames infiniteRunner obstacles IObstacleHittable".split(" ");
eg.prototype={__class__:eg};var zb=function(a){m.call(this,a)};zb.__name__="game gameplay minigames infiniteRunner obstacles Obstacle".split(" ");zb.__super__=m;zb.prototype=p(m.prototype,{get_boxCollider:function(){return this._boxCollider},get_hitSfx:function(){return this._hitSfx},set_hitSfx:function(a){return this._hitSfx=a},init:function(){m.prototype.init.call(this);this._boxCollider=this.getComponent(Ya)},hit:function(a){this.setActive(!1);q.playSoundByName(this._hitSfx)},__class__:zb,__properties__:{get_boxCollider:"get_boxCollider",
set_hitSfx:"set_hitSfx",get_hitSfx:"get_hitSfx"}});var La=function(a){this._context=a};La.__name__="game gameplay minigames infiniteRunner runnerCharacter RunnerCharacterState".split(" ");La.__super__=Yb;La.prototype=p(Yb.prototype,{handleUpInput:function(){},__class__:La});var Ta=function(a){this._landOffset=0;this._context=a};Ta.__name__="game gameplay minigames infiniteRunner runnerCharacter AerialState".split(" ");Ta.__super__=La;Ta.prototype=p(La.prototype,{onEnter:function(){La.prototype.onEnter.call(this);
this.getContext().activateGravity();this._velocityController=this.getContext().getEntity().getComponent(hc);this.getContext().playAnimation("horseRidingHorseJump")},onFixedUpdate:function(){La.prototype.onFixedUpdate.call(this);var a=this._velocityController.getVelocity(),b=this.getContext().getEntity().getPosition();b.y+=this._landOffset;var c=this.getContext().get_groundY()*this.getContext().getEntity().getScale().y;if(b.y>=c&&0<=a.y)this.onLand()},onLand:function(){},__class__:Ta});var Oe=function(a){Ta.call(this,
a)};Oe.__name__="game gameplay minigames infiniteRunner runnerCharacter FailState".split(" ");Oe.__super__=Ta;Oe.prototype=p(Ta.prototype,{onEnter:function(){Ta.prototype.onEnter.call(this);this._context.playAnimation("horseRidingHorseFail")},onLand:function(){Ta.prototype.onLand.call(this);var a=this.getContext().get_groundY()*this.getContext().getEntity().getScale().y,b=this.getContext().getEntity().getPosition();b.y=a;this.getContext().getEntity().setPosition(b.x,b.y);this._velocityController.setVelocity(0,
0)},__class__:Oe});var Pe=function(a){this._context=a};Pe.__name__="game gameplay minigames infiniteRunner runnerCharacter FrozenState".split(" ");Pe.__super__=La;Pe.prototype=p(La.prototype,{onEnter:function(){La.prototype.onEnter.call(this);this._context.pauseAnimation()},__class__:Pe});var yd=function(a){Ta.call(this,a);this._landOffset=60};yd.__name__="game gameplay minigames infiniteRunner runnerCharacter JumpingState".split(" ");yd.__super__=Ta;yd.prototype=p(Ta.prototype,{onEnter:function(){Ta.prototype.onEnter.call(this);
this.getContext().getEntity().translate(0,-45);q.playRandomSoundByName(["sfxHorseJump1","sfxHorseJump2","sfxHorseJump3"])},onExit:function(){Ta.prototype.onExit.call(this);this.getContext().deactivateGravity()},onLand:function(){Ta.prototype.onLand.call(this);var a=this.getContext().get_groundY()*this.getContext().getEntity().getScale().y,b=this.getContext().getEntity().getPosition();b.y=a;this.getContext().getEntity().setPosition(b.x,b.y);this.getContext().set_state(new zd(this.getContext()));this._velocityController.setVelocity(0,
0,0)},__class__:yd});var Ad=function(a){this._type=a};Ad.__name__="game gameplay minigames infiniteRunner runnerCharacter ObstaclePassEvent".split(" ");Ad.__super__=Q;Ad.prototype=p(Q.prototype,{__class__:Ad});var Pc=function(a){this._obstacleHitRadius=100;this._jumpPower=900;this._gravity=2E3;this._groundY=0;m.call(this,a);this._stateMachine=new Qe;this._velocity=new hc(a,null);this._animation=this.getEntity().getComponentsInChildren(vb)[0];this.set_state(new Pe(this));new Ja(a);this._audioSource=
new gd(a)};Pc.__name__="game gameplay minigames infiniteRunner runnerCharacter RunnerCharacter".split(" ");Pc.__interfaces__=[eg,ye];Pc.__super__=m;Pc.prototype=p(m.prototype,{get_audioSource:function(){return this._audioSource},get_obstacleHitRadius:function(){return this._obstacleHitRadius},set_obstacleHitRadius:function(a){return this._obstacleHitRadius=a},get_groundY:function(){return this._groundY},set_groundY:function(a){return this._groundY=a},get_state:function(){return this._stateMachine.getState()},
set_state:function(a){this._stateMachine.setState(a);return a},playAnimation:function(a){this._animation.setAnimation(a)},pauseAnimation:function(){this._animation.stop()},startRunning:function(){this.set_state(new zd(this))},update:function(){m.prototype.update.call(this);this._stateMachine.onUpdate()},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this._stateMachine.onFixedUpdate()},postUpdate:function(){m.prototype.postUpdate.call(this);this._stateMachine.onPostUpdate()},jump:function(){this._velocity.setVelocity(0,
-this._jumpPower,0);this.set_state(new yd(this))},activateGravity:function(){this._velocity.setGravity(new F(0,this._gravity))},deactivateGravity:function(){this._velocity.setGravity(new F(0,0,0))},handleUpStart:function(){this._stateMachine.handleUpInput()},onHitObstacle:function(a){a.hit(this);this.dispatchEvent(new Bd("hitObstacle"));this.set_state(new Oe(this))},handleUpEnd:function(){},handleDownStart:function(){},handleDownEnd:function(){},handleLeftStart:function(){},handleLeftEnd:function(){},
handleRightStart:function(){},handleRightEnd:function(){},__class__:Pc,__properties__:{set_state:"set_state",get_state:"get_state",set_groundY:"set_groundY",get_groundY:"get_groundY",set_obstacleHitRadius:"set_obstacleHitRadius",get_obstacleHitRadius:"get_obstacleHitRadius",get_audioSource:"get_audioSource"}});var Bd=function(a){this._type=a};Bd.__name__="game gameplay minigames infiniteRunner runnerCharacter RunnerCharacterEvent".split(" ");Bd.__super__=Q;Bd.prototype=p(Q.prototype,{__class__:Bd});
var Qe=function(){};Qe.__name__="game gameplay minigames infiniteRunner runnerCharacter RunnerCharacterStateMachine".split(" ");Qe.__super__=lb;Qe.prototype=p(lb.prototype,{getState:function(){return lb.prototype.getState.call(this)},handleUpInput:function(){null!=this.getState()&&this.getState().handleUpInput()},__class__:Qe});var cg=function(){this._obstacles=[];this._players=[]};cg.__name__="game gameplay minigames infiniteRunner runnerCharacter RunnerCollisionDetection".split(" ");cg.prototype=
{get_players:function(){return this._players},set_players:function(a){return this._players=a},get_obstacles:function(){return this._obstacles},set_obstacles:function(a){return this._obstacles=a},detectCollisions:function(){for(var a=0,b=this._players;a<b.length;){var c=b[a];++a;var d=c.getEntity().getPosition().getClone();d.x+=20;d.y+=-40;for(var e=0,f=this._obstacles;e<f.length;){var g=f[e];++e;if(g.isActive()&&null!=g.get_boxCollider()&&g.get_boxCollider().checkPointIntersect(new t(d.x,d.y)))c.onHitObstacle(g)}}},
__class__:cg,__properties__:{set_obstacles:"set_obstacles",get_obstacles:"get_obstacles",set_players:"set_players",get_players:"get_players"}};var He=function(){this._passedObstacles=[];this._obstacles=[];this._players=[];this._eventListeners=[]};He.__name__="game gameplay minigames infiniteRunner runnerCharacter RunnerObstaclePassDetection".split(" ");He.__super__=sb;He.prototype=p(sb.prototype,{get_players:function(){return this._players},set_players:function(a){return this._players=a},get_obstacles:function(){return this._obstacles},
set_obstacles:function(a){return this._obstacles=a},detectPasses:function(){for(var a=0,b=this._players;a<b.length;){var c=b[a];++a;for(var c=c.getEntity().getPosition(),d=0,e=this._obstacles;d<e.length;){var f=e[d];++d;if(!(0<=this._passedObstacles.indexOf(f))){var g=f.getEntity().getPosition();0>(new F(g.x-c.x,g.y-c.y)).x&&(this.dispatchEvent(new Ad("pass")),this._passedObstacles.push(f),f.getEntity().addEventListener("destroy",w(this,this.onObstacleDestroy)))}}}},onObstacleDestroy:function(a){G.remove(this._passedObstacles,
a.target)},__class__:He,__properties__:{set_obstacles:"set_obstacles",get_obstacles:"get_obstacles",set_players:"set_players",get_players:"get_players"}});var zd=function(a){this._context=a};zd.__name__="game gameplay minigames infiniteRunner runnerCharacter RunningState".split(" ");zd.__super__=La;zd.prototype=p(La.prototype,{onEnter:function(){La.prototype.onEnter.call(this);this.getContext().playAnimation("horseRidingHorseRun");this.getContext().get_audioSource().play("sfxHorseGallopLoop1",!0)},
onExit:function(){La.prototype.onExit.call(this);this.getContext().get_audioSource().stop()},handleUpInput:function(){La.prototype.handleUpInput.call(this);this.getContext().jump()},__class__:zd});var fg=function(){this.numTimesPlayed=0};fg.__name__=["game","gameplay","minigames","minigameSuggestions","MinigamePlayData"];fg.prototype={parse:function(a){this.minigameType=Wa.createEnum(va,a.minigameType,null);this.numTimesPlayed=a.numTimesPlayed},toString:function(){var a={};a.numTimesPlayed=this.numTimesPlayed;
a.minigameType=this.minigameType[0];return JSON.stringify(a)},__class__:fg};var Gc=function(a){this.lastPlayedMinigameType=null;this._minigamePlayData=new Cd;this._saveData=a;a=0;for(var b=Gc.MINIGAME_TYPES_ORDERED;a<b.length;){var c=b[a];++a;var d=new fg;d.minigameType=c;d.numTimesPlayed=0;this._minigamePlayData.set(c,d);c=this.getSaveKey(c);null!=this._saveData.getItem(c,null)&&d.parse(JSON.parse(this._saveData.getItem(c,null)))}};Gc.__name__=["game","gameplay","minigames","minigameSuggestions",
"MinigameSuggestionController"];Gc.prototype={getSaveKey:function(a){return"minigamePlayData"+a[0]},incrementMinigamePlay:function(a){var b=this._minigamePlayData.get(a);b.numTimesPlayed++;a=this.getSaveKey(a);this._saveData.setItem(a,b.toString())},getUnplayedMinigameTypes:function(){for(var a=[],b=0,c=Gc.MINIGAME_TYPES_ORDERED;b<c.length;){var d=c[b];++b;d=this._minigamePlayData.get(d);0==d.numTimesPlayed&&a.push(d.minigameType)}return a},getNextBestMinigameType:function(){var a=this.getUnplayedMinigameTypes();
if(0<a.length)return a[0];if(null==this.lastPlayedMinigameType){var a=va.__empty_constructs__,b=V.randomInt(0,a.length);return a[b]}a=this.getMinigameTypesBesides(this.lastPlayedMinigameType);b=V.randomInt(0,a.length);return a[b]},getMinigameTypesBesides:function(a){var b=[].concat(va.__empty_constructs__);G.remove(b,a);console.log(b);return b},__class__:Gc};var sd=function(a,b){this._upKeyDownPrev=this._downKeyDownPrev=this._leftKeyDownPrev=this._rightKeyDownPrev=!1;m.call(this,a);this._upKey=I.getProperty("keyUp");
this._downKey=I.getProperty("keyDown");this._leftKey=I.getProperty("keyLeft");this._rightKey=I.getProperty("keyRight");this._inputManager=na.getInstance();this._target=b};sd.__name__=["game","gameplay","minigames","playerInput","PlayerArrowInputController"];sd.__super__=m;sd.prototype=p(m.prototype,{update:function(){m.prototype.update.call(this);this._inputManager.isKeyDown(this._downKey)&&!this._downKeyDownPrev?(this._target.handleDownStart(),this._downKeyDownPrev=!0):!this._inputManager.isKeyDown(this._downKey)&&
this._downKeyDownPrev&&(this._target.handleDownEnd(),this._downKeyDownPrev=!1);this._inputManager.isKeyDown(this._upKey)&&!this._upKeyDownPrev?(this._target.handleUpStart(),this._upKeyDownPrev=!0):!this._inputManager.isKeyDown(this._upKey)&&this._upKeyDownPrev&&(this._target.handleUpEnd(),this._upKeyDownPrev=!1);this._inputManager.isKeyDown(this._leftKey)&&!this._leftKeyDownPrev?(this._target.handleLeftStart(),this._leftKeyDownPrev=!0):!this._inputManager.isKeyDown(this._leftKey)&&this._leftKeyDownPrev&&
(this._target.handleLeftEnd(),this._leftKeyDownPrev=!1);this._inputManager.isKeyDown(this._rightKey)&&!this._rightKeyDownPrev?(this._target.handleRightStart(),this._rightKeyDownPrev=!0):!this._inputManager.isKeyDown(this._rightKey)&&this._rightKeyDownPrev&&(this._target.handleRightEnd(),this._rightKeyDownPrev=!1)},__class__:sd});var xe=function(a,b){this._spaceKeyDownPrev=!1;m.call(this,a);this._spaceKey=I.getProperty("keySpace");this._inputManager=na.getInstance();this._target=b};xe.__name__=["game",
"gameplay","minigames","playerInput","PlayerSpaceActionInputController"];xe.__super__=m;xe.prototype=p(m.prototype,{update:function(){m.prototype.update.call(this);this._inputManager.isKeyDown(this._spaceKey)&&!this._spaceKeyDownPrev?(this._target.handleActionStart(),this._spaceKeyDownPrev=!0):!this._inputManager.isKeyDown(this._spaceKey)&&this._spaceKeyDownPrev&&(this._target.handleActionEnd(),this._spaceKeyDownPrev=!1)},__class__:xe});var gg=function(a,b){m.call(this,a);this._target=b};gg.__name__=
["game","gameplay","virtualController","ActionButton"];gg.__super__=m;gg.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getComponent(ha);this._button.setOnMouseDown(w(this,this.onMouseDown));this._button.setOnMouseMoved(w(this,this.onMouseDown));this._button.setOnMouseUp(w(this,this.onMouseUp));this._button.setOnMouseOut(w(this,this.onMouseUp))},onMouseDown:function(){this._target.handleActionStart()},onMouseUp:function(){this._target.handleActionEnd()},__class__:gg});
var Re=function(a,b){m.call(this,a);this._target=b};Re.__name__=["game","gameplay","virtualController","LeftButton"];Re.__super__=m;Re.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getComponent(ha);this._button.setOnMouseDown(w(this,this.onMouseDown));this._button.setOnMouseMoved(w(this,this.onMouseDown));this._button.setOnMouseUp(w(this,this.onMouseUp));this._button.setOnMouseOut(w(this,this.onMouseUp))},onMouseDown:function(){this._target.handleLeftStart()},
onMouseUp:function(){this._target.handleLeftEnd()},__class__:Re});var Se=function(a,b){m.call(this,a);this._target=b};Se.__name__=["game","gameplay","virtualController","RightButton"];Se.__super__=m;Se.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getComponent(ha);this._button.setOnMouseDown(w(this,this.onMouseDown));this._button.setOnMouseMoved(w(this,this.onMouseDown));this._button.setOnMouseUp(w(this,this.onMouseUp));this._button.setOnMouseOut(w(this,this.onMouseUp))},
onMouseDown:function(){this._target.handleRightStart()},onMouseUp:function(){this._target.handleRightEnd()},__class__:Se});var Ua=function(){this._hidFullscreen=this._hasForcePlayed=!1;L.call(this)};Ua.__name__=["game","mattelVideoManager","MattelVideoManager"];Ua.getInstance=function(){null==Ua._instance&&(Ua._instance=new Ua,n.getInstance().addManager(Ua._instance));return Ua._instance};Ua.__super__=U;Ua.prototype=p(U.prototype,{embed:function(a,b,c,d,e){var f=this,g=x.getDocument().createElement("script");
g.src="https://player.ooyala.com/core/"+b;g.addEventListener("load",function(b){b=x.getDocument().createElement("div");f._currentDiv=b;f._currentDiv.id="ooyalaplayer";f._currentDiv.style.width=d+"px";f._currentDiv.style.height=e+"px";c.appendChild(f._currentDiv);f._player=OO.Player.create("ooyalaplayer",a,{});f._player.subscribe("played","ooyalaplayer",w(f,f.onVideoPlayed));n.isMobile()||f._player.play();f._hasForcePlayed=!1;f._player.setVolume(1)});x.getDocument().body.appendChild(g)},setVideoSize:function(a,
b){null!=this._currentDiv&&(this._currentDiv.style.width=a+"px",this._currentDiv.style.height=b+"px")},destroyVideo:function(){null!=this._player&&(this._player.destroy(),this._player=null);null!=this._currentDiv&&this._currentDiv.parentNode.removeChild(this._currentDiv)},update:function(){U.prototype.update.call(this);if(null!=this._player)for(var a=x.getDocument().body.getElementsByClassName("oo_fullscreen"),b=0,c=a.length;b<c;){var d=b++;a.item(d).style.display="none";this._hidFullscreen=!0}},
onVideoPlayed:function(){this.dispatchEvent(new Dd("videoFinish"))},destroy:function(){U.prototype.destroy.call(this);Ua._instance=null},handleMessage:function(a,b){U.prototype.handleMessage.call(this,a,b);n.isMobile()&&("mouseDown"==a&&null!=this._player&&!this._hasForcePlayed)&&(this._player.play(),this._hasForcePlayed=!0)},__class__:Ua});var Dd=function(a){this._type=a};Dd.__name__=["game","mattelVideoManager","MattelVideoManagerEvent"];Dd.__super__=Q;Dd.prototype=p(Q.prototype,{__class__:Dd});
var hg=function(){};hg.__name__=["game","positionGenerator","IPositionGenerator"];hg.prototype={__class__:hg,__properties__:{get_nextPosition:"get_nextPosition",get_position:"get_position"}};var De=function(){this._position=new F;this._maxX=this._maxY=500;this._minX=this._minY=-500};De.__name__=["game","positionGenerator","RandomPositionGenerator"];De.__interfaces__=[hg];De.prototype={get_minX:function(){return this._minX},set_minX:function(a){return this._minX=a},get_minY:function(){return this._minY},
set_minY:function(a){return this._minY=a},get_maxX:function(){return this._maxX},set_maxX:function(a){return this._maxX=a},get_maxY:function(){return this._maxY},set_maxY:function(a){return this._maxY=a},get_position:function(){return this._position.getClone()},get_nextPosition:function(){this.generatePosition();return this.get_position()},generatePosition:function(){var a=this.get_minX(),b=this.get_maxX();this._position.x=V.randomFloat(a,b);a=this.get_minY();b=this.get_maxY();this._position.y=V.randomFloat(a,
b)},__class__:De,__properties__:{get_nextPosition:"get_nextPosition",get_position:"get_position",set_maxY:"set_maxY",get_maxY:"get_maxY",set_maxX:"set_maxX",get_maxX:"get_maxX",set_minY:"set_minY",get_minY:"get_minY",set_minX:"set_minX",get_minX:"get_minX"}};var Me=function(){};Me.__name__=["game","prototypes","HayBaleMidObstaclePrototype"];Me.__super__=Qa;Me.prototype=p(Qa.prototype,{create:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=a.addEntity();c=new A(b,"horseRidingJump6");b.setLocalPosition(0,
-20);c.setAnchor(0.5,0.5);(new zb(a)).set_hitSfx("sfxHorseHayImpact");b=new Xa;b.wh=new t(64,80);new Ya(a,b,new F(0,-80));return a},__class__:Me});var Le=function(){};Le.__name__=["game","prototypes","HayBaleObstaclePrototype"];Le.__super__=Qa;Le.prototype=p(Qa.prototype,{create:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=a.addEntity();c=new A(b,"horseRidingJump5");b.setLocalPosition(0,-20);c.setAnchor(0.5,0.5);(new zb(a)).set_hitSfx("sfxHorseHayImpact");b=new Xa;b.wh=new t(64,80);new Ya(a,
b,new F(0,-40));return a},__class__:Le});var Ke=function(){};Ke.__name__=["game","prototypes","HighObstaclePrototype"];Ke.__super__=Qa;Ke.prototype=p(Qa.prototype,{create:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=a.addEntity();b.setName("shadow");b=new A(b,"horseRidingJumpShadow");b.setAnchor(0.5,0.5);b.getSprite().blendMode=PIXI.BLEND_MODES.MULTIPLY;b=a.addEntity();c=new A(b,"horseRidingJump3");b.setLocalPosition(0,-50);c.setAnchor(0.5,0.5);(new zb(a)).set_hitSfx("sfxHorseWoodImpact1");
b=new Xa;b.wh=new t(64,200);new Ya(a,b,new F(0,-80));return a},__class__:Ke});var Je=function(){};Je.__name__=["game","prototypes","MidObstaclePrototype"];Je.__super__=Qa;Je.prototype=p(Qa.prototype,{create:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=a.addEntity();b.setName("shadow");b=new A(b,"horseRidingJumpShadow");b.setAnchor(0.5,0.5);b.getSprite().blendMode=PIXI.BLEND_MODES.MULTIPLY;b=a.addEntity();c=new A(b,"horseRidingJump2");b.setLocalPosition(0,-50);c.setAnchor(0.5,0.5);(new zb(a)).set_hitSfx("sfxHorseWoodImpact1");
b=new Xa;b.wh=new t(64,150);new Ya(a,b,new F(0,-50));return a},__class__:Je});var Ne=function(){};Ne.__name__=["game","prototypes","PuddleObstaclePrototype"];Ne.__super__=Qa;Ne.prototype=p(Qa.prototype,{create:function(a,b,c){a=a.addEntity();a.setName("puddle");a.setLocalPosition(b,c);b=a.addEntity();c=new A(b,"horseRidingJump4");b.setLocalPosition(0,-10);c.setAnchor(0.5,0.5);(new zb(a)).set_hitSfx("sfxHorseMudSlide");b=new Xa;b.wh=new t(64,80);new Ya(a,b,new F(0,-40));return a},__class__:Ne});var Ie=
function(){};Ie.__name__=["game","prototypes","ShortObstaclePrototype"];Ie.__super__=Qa;Ie.prototype=p(Qa.prototype,{create:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=a.addEntity();b.setName("shadow");b=new A(b,"horseRidingJumpShadow");b.setAnchor(0.5,0.5);b.getSprite().blendMode=PIXI.BLEND_MODES.MULTIPLY;b=a.addEntity();c=new A(b,"horseRidingJump1");b.setLocalPosition(0,-50);c.setAnchor(0.5,0.5);(new zb(a)).set_hitSfx("sfxHorseWoodImpact1");b=new Xa;b.wh=new t(64,80);new Ya(a,b,new F(0,
-40));return a},__class__:Ie});var Ed=function(a){R.call(this);this._gameController=a;this._levelStats=new Mf};Ed.__name__=["game","screens","GameplayScreen"];Ed.__super__=R;Ed.prototype=p(R.prototype,{init:function(){R.prototype.init.call(this);this.instantiateMinigame()},instantiateMinigame:function(){var a=this.addEntity();switch(this._gameController.get_selectedMinigame()[1]){case 0:this._minigame=new Oc(a,this._gameController);break;case 1:this._minigame=new Ee(a,this._gameController);break;
case 2:this._minigame=new ue(a,this._gameController)}this._minigame.addEventListener("complete",w(this,this.onMinigameComplete))},onMinigameComplete:function(a){this.showLevelComplete()},showLevelComplete:function(){var a=this.getSceneRoot().addEntity();this._levelStats.setScore(this._minigame.get_scoreController().get_score());Y.getInstance().setHighScore(this._levelStats.getScore());(new Te(a,this._gameController,this._minigame.get_scoreController())).addEventListener("destroy",w(this,this.onLevelCompleteDestroy))},
onLevelCompleteDestroy:function(a){a.target.removeEventListener("destroy",w(this,this.onLevelCompleteDestroy));this.destroy()},__class__:Ed});var Ue=function(a,b){this._container=a;this._gameController=b};Ue.__name__=["game","screens","LevelSelectFactory"];Ue.prototype={createBarbie:function(a,b){var c=this._container.addEntity();c.setLocalPosition(a,b);var d=c.addEntity();(new A(d,"levelSelectBarbie")).setAnchor(0.5,0.5);d=c.addEntity();d.setLocalPosition(125,35);d.setLocalScale(0.65,0.65);var e=
new Ca;e.defaultImageName="splashPlayButton";e.clickSoundId="sfxButtonForward";e.deactivateButtonOnClick=!1;d=la.createButton(e,d);new rc(d,this._gameController,3);this.createAlertIcon(c,140,-310).setVisible(!1);return c},createNikki:function(a,b){var c=this._container.addEntity();c.setLocalPosition(a,b);var d=c.addEntity();(new A(d,"levelSelectNikki")).setAnchor(0.5,0.5);d=c.addEntity();d.setLocalPosition(-70,-75);d.setLocalScale(0.65,0.65);var e=new Ca;e.defaultImageName="splashPlayButton";e.clickSoundId=
"sfxButtonForward";e.deactivateButtonOnClick=!1;d=la.createButton(e,d);new rc(d,this._gameController,1);this.createAlertIcon(c,130,-310).setVisible(!1);return c},createChelsea:function(a,b){var c=this._container.addEntity();c.setLocalPosition(a,b);var d=c.addEntity();(new A(d,"levelSelectChelsea")).setAnchor(0.5,0.5);d=c.addEntity();d.setLocalPosition(-85,60);d.setLocalScale(0.65,0.65);var e=new Ca;e.defaultImageName="splashPlayButton";e.clickSoundId="sfxButtonForward";e.deactivateButtonOnClick=!1;
d=la.createButton(e,d);new rc(d,this._gameController,2);this.createAlertIcon(c,80,-240).setVisible(!1);return c},createTutorialHand:function(a,b){var c=this._container.addEntity();c.setLocalPosition(a,b);(new A(c,"tutorialFinger")).setAnchor(0.5,0.5);return c},createAlertIcon:function(a,b,c){a=a.addEntity();a.setName("alert");a.setLocalPosition(b,c);(new A(a,"alert")).setAnchor(0.5,0.5);new Dc(a,a.getScaleRef(),"x",1,0.1,5);new Dc(a,a.getScaleRef(),"y",1,0.1,5);return a},__class__:Ue};var Kb=function(a){this._buttonEntities=
[];R.call(this);this._gameController=a};Kb.__name__=["game","screens","LevelSelectScreen"];Kb.__super__=R;Kb.prototype=p(R.prototype,{init:function(){var a=this;R.prototype.init.call(this);this._suggestedMinigameType=this._gameController.minigameSuggestionController.getNextBestMinigameType();this._uiPanel=Ba.createFullscreenUiPanel(this);var b=this._uiPanel.addEntity();new ca(b,this._uiPanel);this._tweener=new Aa(b);this._scrollBase=b.addEntity();this._buttonGroup=new gc(this._scrollBase);new ha(this._scrollBase,
new t(2E3,2E3));this._drag=new md(this._scrollBase);var b=this._scrollBase.addEntity(),c=b.addEntity();(new A(c,"levelSelectLeftBg")).setAnchor(1,0.5);b=b.addEntity();(new A(b,"levelSelectRightBg")).setAnchor(0,0.5);b=this._scrollBase.addEntity();c=b.addEntity();(new A(c,"levelSelectLeftFg")).setAnchor(1,0.5);b=b.addEntity();(new A(b,"levelSelectRightFg")).setAnchor(0,0.5);var d=new Ue(this._scrollBase,this._gameController),b=d.createBarbie(-470,105);this.listenToLevelButtonInChild(b);c=d.createNikki(80,
105);this.listenToLevelButtonInChild(c);var e=d.createChelsea(475,150);this.listenToLevelButtonInChild(e);this._drag.snapToRight();d=b;switch(this._suggestedMinigameType[1]){case 0:d=c;break;case 1:d=e;break;default:d=b}b=this._uiPanel.addEntity();(new A(b,"gameLogoSmall")).setAnchor(0,0);(new ca(b,this._uiPanel)).setCoords(new t(-0.95,-0.95));this._alertEntity=d.findChildByName("alert");this._alertEntity.setLocalScale(0,0);this._gameController.shouldShowLevelSelectTutorial?Y.getInstance().getHasStartedGame()?
this.startTutorial():Xb.show(this._uiPanel.getEntity(),[sa.getString("INTRO_HEADING")],[sa.getString("INTRO_BODY")],function(){a.startTutorial()},"mainStoryBarbie"):(this.buttonsEnter(),this._drag.scrollToEntity(d));q.playMusicByName("musicYouCanDoAnything");this.updateDragBounds()},update:function(){R.prototype.update.call(this);this.updateDragBounds()},updateDragBounds:function(){var a=0.5*window.innerWidth/P.getInstance().getStage().scale.x*P.getInstance().devicePixelRatio;this._drag.xDragMin=
-(800-a);a=0.5*window.innerWidth/P.getInstance().getStage().scale.x*P.getInstance().devicePixelRatio;this._drag.xDragMax=800-a},buttonsEnter:function(){this._tweener.addTween(this._alertEntity.getScaleRef(),"x",this._alertEntity.getLocalScale().x,1,0.3,E.easeOutQuad);this._tweener.addTween(this._alertEntity.getScaleRef(),"y",this._alertEntity.getLocalScale().y,1,0.3,E.easeOutQuad);this._alertEntity.setVisible(!0);for(var a=0,b=this._buttonEntities.length;a<b;){var c=a++;this._tweener.addTween(this._buttonEntities[c].getScaleRef(),
"x",this._buttonEntities[c].getLocalScale().x,1,0.3,E.easeOutQuad);this._tweener.addTween(this._buttonEntities[c].getScaleRef(),"y",this._buttonEntities[c].getLocalScale().y,1,0.3,E.easeOutQuad);this._buttonEntities[c].setActive(!0)}},startTutorial:function(){1.3333333333333333<window.innerWidth/window.innerHeight?this.buttonsEnter():new eb(this._uiPanel.getEntity(),this._scrollBase,this);this._gameController.shouldShowLevelSelectTutorial=!1},listenToLevelButtonInChild:function(a){a=a.getComponentsInChildren(rc)[0];
this._buttonEntities.push(a.getEntity());a.getEntity().setLocalScale(0,0);a.getEntity().setActive(!1);a.addEventListener("popupEnter",w(this,this.onLevelSelectButtonEnter));a.addEventListener("popupDismiss",w(this,this.onLevelSelectButtonDismiss))},onLevelSelectButtonEnter:function(a){this._buttonGroup.setInputEnabled(!1)},onLevelSelectButtonDismiss:function(a){this._buttonGroup.setInputEnabled(!0)},destroy:function(){R.prototype.destroy.call(this);this._gameController.lastLevelSelectPanX=this._drag.getPosition()},
__class__:Kb});var eb=function(a,b,c){m.call(this,a);this._scrollBase=b;this._levelSelectScreen=c};eb.__name__=["game","screens","LevelSelectScrollTutorial"];eb.__super__=m;eb.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._tweener=new Aa(this.getEntity());this._deferredAction=new Fb(this.getEntity());this._dragSceneButton=this._scrollBase.getComponent(md);this._dragSceneButton.addEventListener("drag",w(this,this.onStartDrag));this.spawnHand()},onStartDrag:function(){this._levelSelectScreen.buttonsEnter();
this.destroy()},spawnHand:function(){this._hand=(new Ue(this.getEntity(),null)).createTutorialHand(-300,-185);this._hand.setScale(0,0);this._tweener.addTween(this._hand.getScaleRef(),"x",0,1,0.25,E.easeOutBack,0.5);this._tweener.addTween(this._hand.getScaleRef(),"y",0,1,0.25,E.easeOutBack,0.5);this._deferredAction.addDeferredAction(1,w(this,this.onMoveHandToStartDelayElapse))},onMoveHandToStartDelayElapse:function(){this.moveHandToStart()},moveHandToStart:function(){this._tweener.addTween(this._hand.getPositionRef(),
"x",this._hand.getLocalPosition().x,195,0.65,E.easeInOutQuad,0.1);this._tweener.addTween(this._hand.getPositionRef(),"y",this._hand.getLocalPosition().y,-40,0.65,E.easeInOutQuad);this._deferredAction.addDeferredAction(1.15,w(this,this.onStartDragLeftDelayElapse))},onStartDragLeftDelayElapse:function(){this.startDragLeft()},startDragLeft:function(){this.fingerDown();this._tweener.addTween(this._hand.getPositionRef(),"x",this._hand.getLocalPosition().x,this._hand.getLocalPosition().x-500,2,E.easeInOutQuad);
this._tweener.addTween(this._scrollBase.getPositionRef(),"x",this._scrollBase.getLocalPosition().x,this._scrollBase.getLocalPosition().x-500*this._scrollBase.getScale().x,2,E.easeInOutQuad);this._deferredAction.addDeferredAction(2,w(this,this.onStartDragRightDelayElapse))},onStartDragRightDelayElapse:function(){this.startDragRight()},startDragRight:function(){this._tweener.addTween(this._hand.getPositionRef(),"x",this._hand.getLocalPosition().x,this._hand.getLocalPosition().x+500,2,E.easeInOutQuad);
this._tweener.addTween(this._scrollBase.getPositionRef(),"x",this._scrollBase.getLocalPosition().x,this._scrollBase.getLocalPosition().x+500*this._scrollBase.getScale().x,2,E.easeInOutQuad,null,w(this,this.onDragFinish));this._deferredAction.addDeferredAction(2.5,w(this,this.onDismissFingerDelayElapse))},onDragFinish:function(){this.fingerUp()},onDismissFingerDelayElapse:function(){this.dismissFinger()},dismissFinger:function(){this._tweener.addTween(this._hand.getScaleRef(),"x",1,0,0.25,E.easeInBack);
this._tweener.addTween(this._hand.getScaleRef(),"y",1,0,0.25,E.easeInBack,0,w(this,this.onFingerDismissComplete))},onFingerDismissComplete:function(){this._hand.destroy();this._levelSelectScreen.buttonsEnter()},onResetDelayElapse:function(){},fingerDown:function(){this._tweener.addTween(this._hand.getScaleRef(),"x",1,0.8,0.15,E.easeInBack);this._tweener.addTween(this._hand.getScaleRef(),"y",1,0.8,0.15,E.easeInBack)},fingerUp:function(){this._tweener.addTween(this._hand.getScaleRef(),"x",0.8,1,0.15,
E.easeOutBack);this._tweener.addTween(this._hand.getScaleRef(),"y",0.8,1,0.15,E.easeOutBack)},destroy:function(){m.prototype.destroy.call(this);this._hand.destroy();this._tweener.destroy();this._deferredAction.destroy()},__class__:eb});var ld=function(){R.call(this)};ld.__name__=["game","screens","LoadingScreen"];ld.__super__=R;ld.prototype=p(R.prototype,{init:function(){R.prototype.init.call(this);var a=Ba.createFullscreenUiPanel(this),b=a.addEntity();(new ca(b,a)).setScale(1E3,1);(new A(b,"loadingBGWide")).setAnchor(0.5,
0.5);this._background=this.addEntity();(new ca(this._background,a)).setCoords(new t(0,0));b=new A(this._background,"loadingBG");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=this.addEntity();(new ca(b,a)).setCoords(new t(0,0));b=new A(b,"loadingBarBG");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;this._loadingBar=this.addEntity();(new ca(this._loadingBar,a)).setCoords(new t(0,0.2965));a=new A(this._loadingBar,"loadingBar");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=1;this._mask=
new PIXI.Graphics;a.getSprite().mask=this._mask;a.getSprite().addChild(this._mask);jd.createFontPreload(this._background,"ralewayblack");jd.createFontPreload(this._background,"ralewaybold")},onFileLoaded:function(a,b){null!=this._mask&&this.updateLoadingMeter(a/b)},updateLoadingMeter:function(a){1<a&&(a=1);this._mask.clear();this._mask.beginFill(16711935);this._mask.drawRect(-150,-229*a,300,229*a);this._mask.endFill()},handleMessage:function(a,b){R.prototype.handleMessage.call(this,a,b);if("onFileLoaded"==
a)this.onFileLoaded(b.progress,b.total)},__class__:ld});var Lc=function(a,b,c){R.call(this);this._gameController=b;this._minigameConfig=c;this._parentState=a;this._pauseMenu=Rc.show(this.getSceneRoot(),this._gameController,this._minigameConfig);this._pauseMenu.addEventListener("resume",w(this,this.onPauseMenuResume));this._pauseMenu.addEventListener("quit",w(this,this.onPauseMenuQuit))};Lc.__name__=["game","screens","MenusState"];Lc.show=function(a,b,c){a=new Lc(a,b,c);n.getInstance().addGameState(a);
return a};Lc.__super__=R;Lc.prototype=p(R.prototype,{onPauseMenuQuit:function(a){this.destroy();ua.doTransition(this._parentState,new Kb(this._gameController))},onPauseMenuResume:function(a){var b=this;this._pauseMenu.dismiss();this._pauseMenu.addEventListener("dismissComplete",function(){n.getInstance().removeGameState(b)})},__class__:Lc});var oe=function(){this._orientationEntity=this._div=this._image=null;R.call(this)};oe.__name__=["game","screens","OrientationState"];oe.__super__=R;oe.prototype=
p(R.prototype,{init:function(){R.prototype.init.call(this)},onOrientationChanged:function(a){n.isMobile()&&!n.isPhone()?a&&0==I.getProperty("isLandscapeAllowedIPad")?this.showOrientationScreen(1):a||0!=I.getProperty("isPortraitAllowedIPad")?this.hideOrientationScreen():this.showOrientationScreen(0):n.isMobile()&&(a&&0==I.getProperty("isLandscapeAllowedIPhone")?this.showOrientationScreen(1):a||0!=I.getProperty("isPortraitAllowedIPhone")?this.hideOrientationScreen():this.showOrientationScreen(0))},
showOrientationScreen:function(a){this.hideOrientationScreen(!1);n.getInstance().addGameState(this);n.getInstance().stopUpdates();na.getInstance().setInputDisabled(!0);q.pauseAllSounds();this._div=x.getDocument().createElement("div");this._div.style.position="fixed";this._div.style.backgroundColor="#000000";this._div.style.width="100%";this._div.style.height="100%";x.getContainer().appendChild(this._div);switch(a){case 0:this._orientationEntity=this.addEntity();this._image=H.getAsset(n.isPhone()?
"iphoneOrientationImage":"ipadOrientationImage");this._div.appendChild(this._image);this._image.style.position="absolute";this._image.style.margin="auto auto auto auto";this._image.style.display="block";this._image.style.maxWidth="100%";this._image.style.maxHeight="auto";this._image.style.top="0px";this._image.style.bottom="0px";this._image.style.left="0px";this._image.style.right="0px";break;case 1:this._orientationEntity=this.addEntity(),this._image=H.getAsset(n.isPhone()?"iphoneOrientationImage":
"ipadOrientationImage"),this._div.appendChild(this._image),this._image.style.position="absolute",this._image.style.margin="auto auto auto auto",this._image.style.display="block",this._image.style.maxWidth="100%",this._image.style.maxHeight="auto",this._image.style.top="0px",this._image.style.bottom="0px",this._image.style.left="0px",this._image.style.right="0px"}},update:function(){R.prototype.update.call(this)},hideOrientationScreen:function(a){null==a&&(a=!0);null!=this._div&&(this._div.parentNode.removeChild(this._div),
this._div=null);a&&(n.getInstance().resumeUpdates(),na.getInstance().setInputDisabled(!1),q.resumeAllSounds(),n.getInstance().hideAddressBar(),n.getInstance().onScreenScaleUpdated())},handleMessage:function(a,b){R.prototype.handleMessage.call(this,a,b);if("onOrientationChanged"==a)this.onOrientationChanged(b.isHorizontal)},__class__:oe});var Ve=function(a,b,c,d){this.image=a;this.url=b;this.type=c;this.productName=d};Ve.__name__=["game","screens","PromoConfig"];Ve.prototype={__class__:Ve};var mb=
{__ename__:!0,__constructs__:["Toy","BarbieLife"],Toy:["Toy",0]};mb.Toy.__enum__=mb;mb.BarbieLife=["BarbieLife",1];mb.BarbieLife.__enum__=mb;mb.__empty_constructs__=[mb.Toy,mb.BarbieLife];var qe=function(a){R.call(this);this._gameController=a};qe.__name__=["game","screens","TitleScreen"];qe.__super__=R;qe.prototype=p(R.prototype,{init:function(){R.prototype.init.call(this);this.createMenuScreen();q.playMusicByName("musicYouCanDoAnything")},createMenuScreen:function(){var a=Ba.createFullscreenUiPanel(this);
this._buttonGroup=new gc(a.getEntity());a=new Ma(a);a.createWhiteBackground();a.createUiImage(-0.63,0,"splashFacesLeft");a.createUiImage(0.03,0,"splashFacesCenter");a.createUiImage(0.67,0,"splashFacesRight");a.createSplashLogo(0.015,0);a.createPlayButton(0.67,0.645,w(this,this.onPlayButtonClicked))},onPlayButtonClicked:function(){this._gameController.link("play: [Game Name]","games");this._buttonGroup.setInputEnabled(!1);Y.getInstance().getHasStartedGame()?this.gotoHub():this.gotoStory()},gotoStory:function(){var a=
this;this.addEntity();if("1"==I.getProperty("introVideoEnabled")){var b=new sc(this._gameController,this,new Kb(this._gameController));b.addEventListener("destroy",function(b){a.destroy()});n.getInstance().addGameState(b)}else ua.doTransition(this,new Kb(this._gameController))},gotoHub:function(){ua.doTransition(this,new Kb(this._gameController))},__class__:qe});var We=function(a,b){this._promos=[];this._background=this._uiPanel=null;R.call(this);this._nextScreen=b;this._gameController=a;var c=I.getProperty("toyPromoUrl");
I.getProperty("barbielifePromoUrl");for(var d=0;7>d;){var e=d++;null!=I.getProperty("toyPromo"+(e+1)+"Url")&&(this.addPromoConfig(new Ve("promoDollImage"+(e+1),I.getProperty("toyPromo"+(e+1)+"Url"),mb.Toy,"toy")),this.addPromoConfig(new Ve("promoBarbieLifeImage1",c,mb.BarbieLife,"barbieLife")))}if(null==this._promos[this._gameController.currentPromoImageIndex])this.onCloseClick();else this._uiPanel=Ba.createFullscreenUiPanel(this),c=new Ma(this._uiPanel),c.createWhiteBackground(),c.createUiImage(-0.63,
0,"splashFacesLeft"),c.createUiImage(0.03,0,"splashFacesCenter"),c.createUiImage(0.67,0,"splashFacesRight"),c.createSplashLogo(0.015,0),c.createUnderlay(),this.initPromoConfig(),this.createUi(this._uiPanel)};We.__name__=["game","screens","ToyPromoScreen"];We.__super__=R;We.prototype=p(R.prototype,{init:function(){R.prototype.init.call(this)},initPromoConfig:function(){this._promoConfig=this._promos[this._gameController.currentPromoImageIndex];console.log(this._promoConfig);this._gameController.currentPromoImageIndex++;
this._gameController.currentPromoImageIndex>this._promos.length-1&&(this._gameController.currentPromoImageIndex=0);this._gameController.utagManager.link("Product: [Game Name] - "+this._promoConfig.productName,"games")},addPromoConfig:function(a){"1"!=I.getProperty("barbieLifePromosEnabled")&&a.type==mb.BarbieLife||this._promos.push(a)},createUi:function(a){a=(new Ma(this._uiPanel)).createPopupBase();var b=a.addEntity();b.setLocalPosition(0,43);(new A(b,"shopImageContainer")).setAnchor(0.5,0.5);var c=
b.addEntity();c.setLocalPosition(-140,0);(new A(c,this._promoConfig.image)).setAnchor(0.5,0.5);c=new Ca;c.x=0;c.y=250;c.mouseOverScaleTo=1.05;c.defaultImageName="splashPlayButton";c.clickSoundId="sfxButtonForward";la.createButton(c,b,w(this,this.onCloseClick));this._promoConfig.type==mb.Toy?(c.x=187,c.y=45,c.defaultImageName="shopButton",c.clickSoundId="sfxButtonForward",b={fontFamily:"ralewayblack",fill:"#FFFFFF",fontSize:26},"en-us"!=x.dataLocale&&(b.fontSize=18),c.textStyle=b,c.textX=9,c.textY=
-4,c.text=sa.getString("SHOP_BUTTON"),la.createButton(c,a,null,w(this,this.onShopClick))):(c.x=187,c.y=5,c.defaultImageName="appleButton",c.clickSoundId="sfxButtonForward",la.createButton(c,a,null,w(this,this.onAppleButtonClick)),c.x=187,c.y=85,c.defaultImageName="googleButton",c.clickSoundId="sfxButtonForward",la.createButton(c,a,null,w(this,this.onGoogleButtonClick)));a=this.addEntity();(new ca(a,this._uiPanel)).setCoords(new t(1,-1));(new A(a,"adBanner")).setAnchor(1,0);a=a.addEntity();b={fontFamily:"ralewayblack",
fill:"#FFFFFF",fontSize:32};"en-us"!=x.dataLocale&&(b.fontSize=25);a.setRotation2d(30);a.setLocalPosition(-78,40);new ta(a,sa.getString("AD_LABEL"),b)},onAppleButtonClick:function(){x.getWindow().open(I.getProperty("appleStoreUrl"),"_blank");this._gameController.utagManager.link("Apple Store Click: [Game Name] - "+this._promoConfig.productName,"games")},onGoogleButtonClick:function(){x.getWindow().open(I.getProperty("googleStoreUrl"),"_blank");this._gameController.utagManager.link("Google Store Click: [Game Name] - "+
this._promoConfig.productName,"games")},onShopClick:function(){x.getWindow().open(this._promoConfig.url,"_blank");this._gameController.utagManager.link("Product Click: [Game Name] - "+this._promoConfig.productName,"games")},onCloseClick:function(){ua.doTransition(this,this._nextScreen)},__class__:We});var sc=function(a,b,c){this._wasPrevMuted=!1;R.call(this);this._nextState=c;this._gameController=a;this._uiPanel=Ba.createFullscreenUiPanel(this);this._root=this.addEntity();this._wasPrevMuted=q.isMusicMuted();
this._parentState=b};sc.__name__=["game","screens","WatchTrailerDialog"];sc.__super__=R;sc.prototype=p(R.prototype,{init:function(){R.prototype.init.call(this);var a=new Ma(this._uiPanel);a.createUnderlay();var a=a.createPopupBase(),b=a.addEntity();(new A(b,"popupTrailerContainer")).setAnchor(0.5,0.5);b.setLocalPosition(0,25);b=new Ca;b.x=450;b.y=-210;b.mouseOverScaleTo=1.05;b.defaultImageName="quitButton";b.clickSoundId="sfxButtonForward";la.createButton(b,a,w(this,this.onCloseButtonClick));this._videoDiv=
x.getDocument().createElement("div");this._videoDiv.style.position="absolute";this._videoDiv.style.backgroundColor="#000000";this._videoDiv.style.display="inline-block";x.getContainer().appendChild(this._videoDiv);Ua.getInstance().embed(I.getProperty("videoTrailer.contentId"),I.getProperty("videoTrailer.playerId"),this._videoDiv,566,318);Ua.getInstance().addEventListener("videoFinish",w(this,this.onVideoFinish));this.updateVideoSize();this._wasPrevMuted||q.setMusicMuted(!0)},updateVideoSize:function(){var a=
window.innerWidth,b=window.innerHeight,c=P.getInstance().getStage().scale.x,d=P.getInstance().getStage().scale.x,c=566*c/P.getInstance().devicePixelRatio,e=318*d/P.getInstance().devicePixelRatio,a=0.5*a-0.5*c,b=0.5*b-0.5*e-14*d/P.getInstance().devicePixelRatio;this._videoDiv.style.left=a+"px";this._videoDiv.style.top=b+"px";this._videoDiv.style.width=c+"px";this._videoDiv.style.height=e+"px";Ua.getInstance().setVideoSize(c,e)},update:function(){R.prototype.update.call(this);this.updateVideoSize()},
onVideoFinish:function(){this.onCloseButtonClick()},onCloseButtonClick:function(){this._gameController.utagManager.link("Video Complete: [Game Name]","games");this._videoDiv.parentNode.removeChild(this._videoDiv);Ua.getInstance().destroyVideo();this._wasPrevMuted||q.setMusicMuted(!1);ua.doTransition(this,this._nextState)},onDestroy:function(){R.prototype.onDestroy.call(this);this._parentState.destroy()},__class__:sc});var Kc=function(a){this._timeLeft=3;m.call(this,a);this._container=new ia(this.getEntity());
this._tweener=new Aa(this.getEntity());a=this.addEntity();this._sprite=new A(a,"countdown3");this._sprite.setAnchor(0.5,0.5);this._tweener.addTween(this._sprite.getEntity().getScaleRef(),"x",0,1,0.25,E.easeOutBack);this._tweener.addTween(this._sprite.getEntity().getScaleRef(),"y",0,1,0.25,E.easeOutBack);q.playSoundByName("sfx32Countdown")};Kc.__name__=["game","ui","Countdown"];Kc.__super__=m;Kc.prototype=p(m.prototype,{get_onComplete:function(){return this._onComplete},set_onComplete:function(a){return this._onComplete=
a},update:function(){m.prototype.update.call(this);var a=this._timeLeft;this._timeLeft-=1.5*n.getDeltaTime();if(Math.ceil(a)>Math.ceil(this._timeLeft))this.onSecondsChange(Math.ceil(this._timeLeft))},onSecondsChange:function(a){0>=a?(this.onSecondsElapse(),this._tweener.addTween(this._sprite.getEntity().getScaleRef(),"x",1,0,0.15,E.easeInBack),this._tweener.addTween(this._sprite.getEntity().getScaleRef(),"y",1,0,0.15,E.easeInBack),q.playSoundByName("sfx1Countdown")):(this._sprite.setImage("countdown"+
a),this._tweener.addTween(this._sprite.getEntity().getScaleRef(),"x",0.5,1,0.25,E.easeOutBack),this._tweener.addTween(this._sprite.getEntity().getScaleRef(),"y",0.5,1,0.25,E.easeOutBack),q.playSoundByName("sfx32Countdown"))},onSecondsElapse:function(){var a=this;null!=this.get_onComplete()&&this.get_onComplete()();this._tweener.addTween(this._container.getContainer(),"alpha",this._container.getContainer().alpha,0,0.2,E.linear,0,function(){a.getEntity().destroy()})},__class__:Kc,__properties__:{set_onComplete:"set_onComplete",
get_onComplete:"get_onComplete"}});var Mc=function(a){this._uiPanel=a;this._isMobile=n.isMobile()};Mc.__name__=["game","ui","HudUiFactory"];Mc.prototype={createPauseButton:function(a,b,c){var d=new Ca;d.x=a;d.y=b;this._isMobile&&(d.scale=1.1);d.defaultImageName="pauseButton";d.deactivateButtonOnClick=!1;d.clickSoundId="sfxButtonForward";return la.createButton(d,this._uiPanel.getEntity(),c)},createLeftButton:function(a,b,c){var d=new Ca;d.x=a;d.y=b;d.defaultImageName="leftButton";d.deactivateButtonOnClick=
!1;a=la.createButton(d,this._uiPanel.getEntity());a.getComponentsInChildren(ha);new Re(a,c);return a},createRightButton:function(a,b,c){var d=new Ca;d.x=a;d.y=b;d.defaultImageName="rightButton";d.deactivateButtonOnClick=!1;d.clickSoundId="sfxButtonForward";a=la.createButton(d,this._uiPanel.getEntity());a.getComponentsInChildren(ha);new Se(a,c);return a},createScoreCounter:function(a,b){var c=this._uiPanel.addEntity();(new A(c,"scoreContainer")).setAnchor(0.5,0.5);var d=new ca(c,this._uiPanel);d.setCoords(new t(a,
b));this._isMobile&&d.setScale(1.1,1.1);d=c.addEntity();d.setLocalPosition(27,-8);d=new ta(d,"0",{fontFamily:"ralewaybold",fill:"#FFFFFF",fontSize:41,align:"center"});d.getText().anchor.x=0;d.getText().anchor.y=0.5;d={fontFamily:"ralewaybold",fill:"#FF38BD",fontSize:24};"en-us"!=x.dataLocale&&(d.fontSize=19);d.align="center";var e=c.addEntity();e.setLocalPosition(22,-6);d=new ta(e,sa.getString("LEVEL_COMPLETE_TOTAL_LABEL"),d);d.getText().anchor.x=1;d.getText().anchor.y=0.5;return c},createTimer:function(a,
b){var c=this._uiPanel.addEntity(),d=new ca(c,this._uiPanel);this._isMobile&&d.setScale(1.1,1.1);(new A(c,"clockBase")).setAnchor(0.5,0.5);d.setCoords(new t(a,b));d=c.addEntity();d.setName("fill");d=new A(d,"clockFill");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;var e=new PIXI.Graphics;d.getSprite().mask=e;d.getSprite().addChild(e);d=c.addEntity();d.setName("hand");d=new A(d,"clockHand");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;return c},createLivesCounter:function(a,b){var c=
this._uiPanel.addEntity();(new ca(c,this._uiPanel)).setCoords(new t(a,b));new ta(c,"3",{fontFamily:"ralewaybold",fill:"#000000",fontSize:42,align:"center"});return c},__class__:Mc};var rc=function(a,b,c){m.call(this,a);this._gameController=b;this._levelNumber=c};rc.__name__=["game","ui","LevelSelectButton"];rc.__super__=m;rc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getComponent(ha);this._button.getComponent(Ga).setOnAction(w(this,this.onMouseDown))},onMouseDown:function(){var a=
this.getGameState().addEntity(),a=new Xe(a,this._levelNumber,this._gameController);this.dispatchEvent(new tc("popupEnter"));a.addEventListener("destroy",w(this,this.onLevelConfirmDestroy))},onLevelConfirmDestroy:function(a){this.dispatchEvent(new tc("popupDismiss"))},__class__:rc});var tc=function(a){this._type=a};tc.__name__=["game","ui","LevelSelectButtonEvent"];tc.__super__=Q;tc.prototype=p(Q.prototype,{__class__:tc});var Ma=function(a){this._uiPanel=a};Ma.__name__=["game","ui","PopupUiFactory"];
Ma.prototype={createUnderlay:function(){var a=this._uiPanel.addEntity(),b=a.addEntity(),b=new A(b,"underlay");b.getSprite().alpha=1;b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=a.addEntity();b.setLocalPosition(-512,0);var c=new A(b,"underlay");c.getSprite().alpha=1;c.getSprite().anchor.x=1;c.getSprite().anchor.y=0.5;b.setScale(500,1);c=a.addEntity();c.setLocalPosition(512,0);c=new A(c,"underlay");c.getSprite().alpha=1;c.getSprite().anchor.x=0;c.getSprite().anchor.y=0.5;b.setScale(500,1);
new ca(a,this._uiPanel);return a},createSplashBackground:function(){var a=this._uiPanel.addEntity();new ca(a,this._uiPanel);var b=new A(a,"splashBg");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;return a},createWhiteBackground:function(){var a=this._uiPanel.addEntity();(new ca(a,this._uiPanel)).setScale(50,50);var b=new A(a,"whiteBg");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;return a},createSplashFooter:function(){var a=this._uiPanel.addEntity();(new ca(a,this._uiPanel)).setCoords(new t(0,
1));var b=new A(a,"splashFooter");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=1;return a},createPlayButton:function(a,b,c){var d=new Ca;d.x=a;d.y=b;d.defaultImageName="splashPlayButton";d.clickSoundId="sfxButtonForward";return la.createButton(d,this._uiPanel.getEntity(),c)},createSplashLogo:function(a,b){var c=this._uiPanel.addEntity();(new ca(c,this._uiPanel)).setCoords(new t(a,b));(new A(c,"gameLogo")).setAnchor(0.5,0.5);return c},createHeadingText:function(a,b,c){var d=this._uiPanel.addEntity();
(new ca(d,this._uiPanel)).setCoords(new t(a,b));new ta(d,c,{fontSize:"28px",fontFamily:"ralewaybold"});return d},createPopupBase:function(){var a=1.3333333333333333<window.innerWidth/window.innerHeight,b=this._uiPanel.addEntity();(new ca(b,this._uiPanel)).setCoords(new t(0,-0.1));a?(new A(b,"popupBgWide")).setAnchor(0.5,0.5):(new A(b,"popupBg")).setAnchor(0.5,0.5);return b},createStarFormation:function(a,b,c,d){a=a.addEntity();a.setLocalPosition(b,c);1<=d&&(b=a.addEntity(),b.setLocalPosition(-52.5,
17.5),(new A(b,"star1Small")).setAnchor(0.5,0.5));2<=d&&(b=a.addEntity(),(new A(b,"star2Small")).setAnchor(0.5,0.5));3<=d&&(d=a.addEntity(),d.setLocalPosition(50.5,18.5),(new A(d,"star3Small")).setAnchor(0.5,0.5));return a},createLargeStarFormation:function(a,b,c,d){a=a.addEntity();(new A(a,"starContainerLarge")).setAnchor(0.5,0.5);a.setLocalPosition(b,c);b=new Aa(a);1<=d&&(c=a.addEntity(),c.setLocalPosition(-118,22),(new A(c,"star1Large")).setAnchor(0.5,0.5),c.setLocalScale(0,0),b.addTween(c.getScaleRef(),
"x",0,1,0.35,E.easeOutBack,0),b.addTween(c.getScaleRef(),"y",0,1,0.35,E.easeOutBack,0));2<=d&&(c=a.addEntity(),c.setLocalPosition(3,-18),(new A(c,"star2Large")).setAnchor(0.5,0.5),c.setLocalScale(0,0),b.addTween(c.getScaleRef(),"x",0,1,0.35,E.easeOutBack,0.25),b.addTween(c.getScaleRef(),"y",0,1,0.35,E.easeOutBack,0.25));3<=d&&(d=a.addEntity(),d.setLocalPosition(118,24),(new A(d,"star3Large")).setAnchor(0.5,0.5),d.setLocalScale(0,0),b.addTween(d.getScaleRef(),"x",0,1,0.35,E.easeOutBack,0.5),b.addTween(d.getScaleRef(),
"y",0,1,0.35,E.easeOutBack,0.5));return a},createCornerCharacter:function(a){var b=this._uiPanel.addEntity();(new ca(b,this._uiPanel)).setCoords(new t(-0.5,1));switch(a){case 1:a="levelCompleteNikki";break;case 2:a="levelCompleteChelsea";break;default:a="levelCompleteBarbie"}(new A(b,a)).setAnchor(1,1);return b},createCornerSprite:function(a){var b=this._uiPanel.addEntity();(new ca(b,this._uiPanel)).setCoords(new t(-0.5,1));(new A(b,a)).setAnchor(1,1);return b},createUiImage:function(a,b,c){var d=
this._uiPanel.addEntity();(new ca(d,this._uiPanel)).setCoords(new t(a,b));(new A(d,c)).setAnchor(0.5,0.5);return d},__class__:Ma};var ig=function(a,b){this._baseHeight=500;this._baseWidth=750;L.call(this);this._baseWidth=a;this._baseHeight=b};ig.__name__=["game","ui","ScreenSizeToBrowserSize"];ig.__super__=U;ig.prototype=p(U.prototype,{postUpdate:function(){U.prototype.postUpdate.call(this);n.getDevicePixelRatio();if(1==n.getInstance().getCurrentOrientation()){var a=this._baseWidth/window.innerWidth;
n.getInstance().setGameWidth(this._baseWidth);n.getInstance().setGameHeight(Math.ceil(window.innerHeight*a))}else a=this._baseHeight/window.innerHeight,n.getInstance().setGameWidth(Math.ceil(window.innerWidth*a)),n.getInstance().setGameHeight(this._baseHeight);n.getInstance().onResizeWindow()},__class__:ig});var Ye=function(a,b,c){m.call(this,a);this._soundOnImage=b;this._soundOffImage=c};Ye.__name__=["game","ui","SoundButton"];Ye.__super__=m;Ye.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);
this._button=this.getEntity().getComponent(ha);this._buttonActionDelay=this.getEntity().getComponent(Ga);this._buttonMouseOverImage=this.getEntity().getComponent(jc);this._buttonActionDelay.setOnAction(w(this,this.onClick))},update:function(){m.prototype.update.call(this);this._buttonMouseOverImage.setDefaultImage(q.isMusicMuted()?this._soundOffImage:this._soundOnImage);this._buttonMouseOverImage.setMouseOverImage(q.isMusicMuted()?this._soundOffImage:this._soundOnImage)},onClick:function(){q.setMusicMuted(!q.isMusicMuted());
q.setSoundMuted(q.isMusicMuted())},__class__:Ye});var Ba=function(){};Ba.__name__=["game","ui","UiFactory"];Ba.createFullscreenUiPanel=function(a){var b=n.getInstance().getGameSize();b.getClone();b.x*=n.getInstance().getScreenScale().x;b.y*=n.getInstance().getScreenScale().y;a=a.addEntity();b=new mc(a,b);new me(a,b);new le(a);return b};Ba.createPulseButton=function(a,b,c,d,e,f,g,k,h,l,m,n,p,q,r,s){var v=dc.instantiate(a.getGameState());(new ca(v,a)).setCoords(new t(b,c));a=new A(v,h);ha.createFromPixiSprite(a);
new Ec(v,d,e,f,q);new ic(v,g,k,E.easeOutQuint,E.easeOutQuint);new Ga(v,m,n,p);new jc(v,h,l);new Fc(v,r,s);return v};Ba.createPulseButtonQuick=function(a,b,c,d,e,f,g,k,h,l,m){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return Ba.createPulseButton(a,b,c,0.35,1,0.15,1.15,0.35,d,e,f,l,m,h,g,k)};Ba.createPulseButtonAbsolute=function(a,b,c,d,e,f,g,k,h,l,m,n,p,q,r,s){a=dc.instantiate(a);a.setLocalPosition(b,c,0);b=new A(a,h);ha.createFromPixiSprite(b);new Ec(a,d,e,f,q);new ic(a,g,k,
E.easeOutQuint,E.easeOutQuint);new Ga(a,m,n,p);new jc(a,h,l);new Fc(a,r,s);return a};Ba.createPulseButtonQuickAbsolute=function(a,b,c,d,e,f,g,k,h,l,m){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return Ba.createPulseButtonAbsolute(a,b,c,0.35,1,0.15,1.15,0.35,d,e,f,l,m,h,g,k)};Ba.createTextButton=function(a,b,c,d,e,f,g,k,h){null==h&&(h=!0);null==k&&(k="");null==g&&(g="");var l=e.getGameState();a=Ba.createPulseButtonQuick(e,a,b,d,d,f,g,k,h,0.35);l=l.addEntity();l.setLocalPosition(0,
-5,0);new ta(l,c,{fontSize:"24px",fontFamily:"ralewayblack",fill:"#000000"});a.addChild(l);return a.getComponent(ca)};Ba.prototype={__class__:Ba};var Ca=function(){this.scale=1;this.textX=this.textY=0;this.text="";this.textStyle=null;this.clickSoundId=this.overSoundId="";this.deactivateButtonOnClick=!0;this.onClickDelay=0.35;this.defaultImageName=this.mouseOverImageName="";this.mouseOverScaleDuration=0.35;this.mouseOverScaleTo=1.15;this.mouseDownPulseDuration=0.15;this.mouseDownPulseToScale=1;this.mouseDownPulseFromScale=
0.35;this.positionType=Va.UiPanel;this.x=this.y=0};Ca.__name__=["game","ui","buttonFactory","ButtonConfig"];Ca.prototype={__class__:Ca};var la=function(){};la.__name__=["game","ui","buttonFactory","ButtonFactory"];la.createButton=function(a,b,c,d){var e=b.addEntity();b=b.getComponent(mc);null!=b&&a.positionType==Va.UiPanel?(b=new ca(e,b),b.setCoords(new t(a.x,a.y)),b.setScale(a.scale,a.scale)):(a.positionType==Va.World?e.setPosition(a.x,a.y):e.setLocalPosition(a.x,a.y),e.setLocalScale(a.scale,a.scale));
b=new A(e,a.defaultImageName);ha.createFromPixiSprite(b).setData(a.data);new Ec(e,a.mouseDownPulseFromScale*a.scale,a.mouseDownPulseToScale*a.scale,a.mouseDownPulseDuration,a.deactivateButtonOnClick);new ic(e,a.mouseOverScaleTo*a.scale,a.mouseOverScaleDuration,E.easeOutQuint,E.easeOutQuint);new Ga(e,c,a.onClickDelay,d);new jc(e,a.defaultImageName,0<a.mouseOverImageName.length?a.mouseOverImageName:a.defaultImageName);new Fc(e,a.clickSoundId,a.overSoundId);0<a.text.length&&(c=e.addEntity(),c.setLocalPosition(a.textX,
a.textY),new ta(c,a.text,null==a.textStyle?{}:a.textStyle));return e};var Va={__ename__:!0,__constructs__:["Local","World","UiPanel"],Local:["Local",0]};Va.Local.__enum__=Va;Va.World=["World",1];Va.World.__enum__=Va;Va.UiPanel=["UiPanel",2];Va.UiPanel.__enum__=Va;Va.__empty_constructs__=[Va.Local,Va.World,Va.UiPanel];var Fd=function(a){m.call(this,a)};Fd.__name__=["game","ui","popups","Popup"];Fd.__super__=m;Fd.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._uiPanel=Ba.createFullscreenUiPanel(this.getGameState());
new ia(this._uiPanel.getEntity());this._buttonGroup=new gc(this._uiPanel.getEntity());this.enter()},enter:function(){this.onEnterComplete()},onEnterComplete:function(){this.dispatchEvent(new uc("enterComplete"))},dismiss:function(){this.onDismissComplete()},onDismissComplete:function(){this.dispatchEvent(new uc("dismissComplete"));null!=this._uiPanel&&(this._uiPanel.getEntity().destroy(),this._uiPanel=null);this.getEntity().destroy()},__class__:Fd});var oa=function(a){m.call(this,a)};oa.__name__=
["game","ui","popups","FadingPopup"];oa.__super__=Fd;oa.prototype=p(Fd.prototype,{enter:function(){var a=this,b=this._uiPanel.getComponent(ia);Aa.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",0,1,0.1,E.linear,0,function(){a.onEnterComplete()})},dismiss:function(){var a=this;this._buttonGroup.setInputEnabled(!1);var b=this._uiPanel.getComponent(ia);Aa.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",1,0,0.1,E.linear,0,function(){a.onDismissComplete()})},__class__:oa});var Te=
function(a,b,c){this._displayedScore=this.totalScore=0;this._scoreModifier=5;this._loadingScreen=null;m.call(this,a);this._gameController=b;this._scoreController=c};Te.__name__=["game","ui","popups","LevelCompleteScreen"];Te.__super__=oa;Te.prototype=p(oa.prototype,{init:function(){oa.prototype.init.call(this);var a=this._gameController.get_selectedMinigame()[1]+1;Y.getInstance().setNumStarsForLevel(a,this._scoreController.get_numStars());Y.getInstance().setHasStartedGame(!0);this._gameController.link("LevelComplete: [Game Name] - "+
this._gameController.get_selectedMinigameName(),"games");var b=new Ma(this._uiPanel);b.createUnderlay();var c=b.createPopupBase(),d=c.addEntity();d.setLocalPosition(0,-120,0);new ta(d,sa.getString("LEVEL_COMPLETE_HEADER"),{fontSize:38,fill:"#F4E60A",fontFamily:"ralewaybold"});d=c.addEntity();d.setLocalPosition(0,110,0);(new ta(d,sa.getString("LEVEL_COMPLETE_TOTAL_LABEL"),{fontSize:32,fontFamily:"ralewaybold",fill:"#FFFFFF"})).setAnchor(0.5,0.5);d=c.addEntity();d.setLocalPosition(0,160,0);this._scoreTextField=
new ta(d,ra.string(this._scoreController.get_score()),{fontSize:88,fontFamily:"ralewaybold",fill:"#F4E60A"});this._scoreTextField.setAnchor(0.5,0.5);b.createLargeStarFormation(c,1,5,this._scoreController.lastNumStarsEarned);b.createCornerCharacter(a);a=new Ca;a.x=-105;a.y=290;a.defaultImageName="homeButton";a.clickSoundId="sfxButtonBackwardHome";a.deactivateButtonOnClick=!0;la.createButton(a,c,w(this,this.onLevelCompleteNextClicked));a.x=105;a.y=290;a.defaultImageName="replayButton";a.clickSoundId=
"sfxButtonForward";a.deactivateButtonOnClick=!0;la.createButton(a,c,w(this,this.onReplayButtonClick));q.playSoundByName("level_win_1");Y.getInstance().setScoreForCurrentLevel(this.totalScore);Y.getInstance().setNumLevelsUnlocked(Y.getInstance().getCurrentLevelNumber()+1)},onLevelCompleteNextClicked:function(){q.playSoundByName("ui_select_1");this.showTrailerIfApplicable(new Kb(this._gameController))},showTrailerIfApplicable:function(a){var b=0<Y.getInstance().getNumStarsForLevel(1)&&0<Y.getInstance().getNumStarsForLevel(2)&&
0<Y.getInstance().getNumStarsForLevel(3),c=Y.getInstance().hasBeatenAllGames(),d="1"==I.getProperty("outroVideoEnabled");b&&!c&&d?(Y.getInstance().setBeatenAllGames(!0),this.gotoVideo(a)):this.gotoPromoBeforeScreen(a)},gotoVideo:function(a){var b=this;a=new sc(this._gameController,this.getGameState(),a);a.addEventListener("destroy",function(a){b.destroy()});n.getInstance().addGameState(a)},onReplayButtonClick:function(){q.playSoundByName("ui_select_1");this.showTrailerIfApplicable(new Ed(this._gameController))},
gotoPromoBeforeScreen:function(a){var b="1"==I.getProperty("barbieLifePromosEnabled");this._gameController.numRecapsUntilPromo--;b&&0>=this._gameController.numRecapsUntilPromo?(this._gameController.numRecapsUntilPromo=this._gameController.numRecapsPerPromo,ua.doTransition(this.getGameState(),new We(this._gameController,a))):ua.doTransition(this.getGameState(),a)},__class__:Te});var Xe=function(a,b,c){m.call(this,a);this._gameController=c;this._levelNumber=b};Xe.__name__=["game","ui","popups","LevelConfirmPopup"];
Xe.__super__=oa;Xe.prototype=p(oa.prototype,{init:function(){oa.prototype.init.call(this);var a=new Ma(this._uiPanel);a.createUnderlay();var b=a.createPopupBase(),c=b.addEntity();c.setLocalPosition(0,-120,0);this._bodyText=new ta(c,sa.getString("STORY_HEADING_"+this._levelNumber),{fontSize:32,fontFamily:"ralewaybold",fill:"#F4E60A",wordWrapWidth:450,wordWrap:!0,align:"center"});b.addChild(c);c=b.addEntity();c.setLocalPosition(0,50);(new A(c,"minigame"+this._levelNumber+"Preview")).setAnchor(0.5,0.5);
a.createStarFormation(c,1,80,Y.getInstance().getNumStarsForLevel(this._levelNumber));a.createCornerCharacter(this._levelNumber);a=new Ca;a.x=-200;a.y=320;a.defaultImageName="backButtonLarge";a.clickSoundId="sfxButtonBackwardHome";a.deactivateButtonOnClick=!0;la.createButton(a,b,w(this,this.onBackButtonClick));a.x=0;a.y=300;a.defaultImageName="splashPlayButton";a.clickSoundId="sfxEnteringMinigame";a.deactivateButtonOnClick=!1;la.createButton(a,b,w(this,this.onNextClick))},onNextClick:function(){this.startLevel(this._levelNumber)},
startLevel:function(a){var b=H.getAsset("gameplayLoad");this._gameController.shouldShowMinigameTutorial=!0;this._gameController.set_selectedMinigame(Wa.createEnumIndex(va,a-1,null));this._gameController.minigameSuggestionController.lastPlayedMinigameType=this._gameController.get_selectedMinigame();Y.getInstance().setCurrentLevelNumber(a);this._loadingScreen=new ld;ua.doTransition(this.getGameState(),this._loadingScreen);a="level"+Y.getInstance().getCurrentLevelNumber()+"Load";b.concatLoadBatch(H.getAsset(a));
this._gameController.link("play: [Game Name] - "+this._gameController.get_selectedMinigameName(),"games");b.load(w(this,this.onLevelLoadComplete))},onLevelLoadComplete:function(){var a=new Ed(this._gameController);ua.doTransition(this._loadingScreen,a)},onBackButtonClick:function(){this.dismiss()},__class__:Xe});var Xb=function(a,b,c,d,e){this._currentPage=0;m.call(this,a);this._headingText=b;this._bodyText=c;this._onOk=d;this._cornerSprite=e};Xb.__name__=["game","ui","popups","MessageBoxOk"];Xb.show=
function(a,b,c,d,e){a=a.addEntity();new Xb(a,b,c,d,e)};Xb.__super__=oa;Xb.prototype=p(oa.prototype,{init:function(){oa.prototype.init.call(this);var a=new Ma(this._uiPanel);a.createUnderlay();var b=a.createPopupBase(),c=b.addEntity();c.setLocalPosition(0,-95,0);this._headingTextField=new ta(c,this._headingText[0],{fontSize:38,fontFamily:"ralewaybold",fill:"#F4E60A",align:"center"});c=b.addEntity();c.setLocalPosition(0,40,0);var d={fontSize:20,fontFamily:"ralewaybold",fill:"#FFFFFF",wordWrapWidth:450,
wordWrap:!0,align:"center"};n.isMobile()&&(d.fontSize=22,d.wordWrapWidth=495.00000000000006);this._bodyTextField=new ta(c,this._bodyText[0],d);a.createCornerSprite(this._cornerSprite);b.addChild(c);a=new Ca;a.x=0;a.y=310;a.defaultImageName="splashPlayButton";a.clickSoundId="sfxButtonForward";la.createButton(a,b,w(this,this.onOkClick))},updateDisplay:function(){this._headingTextField.setTextString(this._headingText[this._currentPage]);this._bodyTextField.setTextString(this._bodyText[this._currentPage])},
onOkClick:function(){var a=this;this._currentPage++;this._currentPage<this._bodyText.length?this.updateDisplay():(this.addEventListener("dismissComplete",function(){null!=a._onOk&&a._onOk()}),this.dismiss())},__class__:Xb});var Sc=function(a,b,c,d){m.call(this,a);this._bodyText=b;this._onYes=c;this._onNo=d};Sc.__name__=["game","ui","popups","MessageBoxYesNo"];Sc.show=function(a,b,c,d){a=a.addEntity();new Sc(a,b,c,d)};Sc.__super__=oa;Sc.prototype=p(oa.prototype,{init:function(){oa.prototype.init.call(this);
var a=new Ma(this._uiPanel);a.createUnderlay();var a=a.createPopupBase(),b=a.addEntity();b.setLocalPosition(0,-50,0);new ta(b,this._bodyText,{fontSize:32,fontFamily:"ralewaybold",fill:"#FFFFFF",wordWrapWidth:450,wordWrap:!0,align:"center"});a.addChild(b);b=new Ca;b.x=-80;b.y=115;b.defaultImageName="confirmButton";b.clickSoundId="sfxButtonForward";la.createButton(b,a,w(this,this.onYesClick));b.x=80;b.y=115;b.defaultImageName="quitButton";b.clickSoundId="sfxButtonBackwardHome";la.createButton(b,a,w(this,
this.onNoClick))},onYesClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=a._onYes&&a._onYes()});this.dismiss()},onNoClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=a._onNo&&a._onNo()});this.dismiss()},__class__:Sc});var Rc=function(a,b,c){m.call(this,a);this._gameController=b;this._minigameConfig=c};Rc.__name__=["game","ui","popups","PauseMenu"];Rc.show=function(a,b,c){a=a.addEntity();return new Rc(a,b,c)};Rc.__super__=oa;Rc.prototype=
p(oa.prototype,{init:function(){oa.prototype.init.call(this);var a=new Ma(this._uiPanel);a.createUnderlay();var a=a.createPopupBase(),b=new Ca;b.x=0;b.y=300;b.defaultImageName="splashPlayButton";b.clickSoundId="sfxButtonForward";b.deactivateButtonOnClick=!0;la.createButton(b,a,w(this,this.onResumeClicked));b.x=0;b.y=30;b.defaultImageName="soundOnButton";b.clickSoundId="sfxButtonForward";b.deactivateButtonOnClick=!1;this._soundButton=la.createButton(b,a);new Ye(this._soundButton,"soundOnButtonLarge",
"soundOffButtonLarge");b.x=150;b.y=30;b.defaultImageName="helpButton";b.clickSoundId="sfxButtonForward";b.deactivateButtonOnClick=!1;la.createButton(b,a,w(this,this.onHelpClicked));b.x=-150;b.y=30;b.defaultImageName="quitButton";b.clickSoundId="sfxButtonBackwardHome";b.deactivateButtonOnClick=!1;la.createButton(b,a,w(this,this.onQuitClicked))},onResumeClicked:function(){this.dispatchEvent(new vc("resume"))},onHelpClicked:function(){var a=this;this.hideMenu();var b=this._gameController.get_selectedMinigame()[1]+
1,c=this.getGameState().getSceneRoot().addEntity();new Jc(c,b,this._minigameConfig.tutorialImageIdBase,this._minigameConfig.tutorialStringIdBase);c.addEventListener("destroy",function(){a.showMenu()})},onQuitClicked:function(){this.hideMenu();Sc.show(this.getGameState().getSceneRoot(),sa.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM_TEXT"),w(this,this.onConfirmQuitYes),w(this,this.onConfirmQuitNo))},onConfirmQuitYes:function(){this.dispatchEvent(new vc("quit"))},onConfirmQuitNo:function(){this.showMenu()},
hideMenu:function(){this._uiPanel.getEntity().setVisible(!1)},showMenu:function(){this._uiPanel.getEntity().setVisible(!0)},__class__:Rc});var vc=function(a){this._type=a};vc.__name__=["game","ui","popups","PauseMenuEvent"];vc.__super__=Q;vc.prototype=p(Q.prototype,{__class__:vc});var uc=function(a){this._type=a};uc.__name__=["game","ui","popups","PopupEvent"];uc.__super__=Q;uc.prototype=p(Q.prototype,{__class__:uc});var Ze=function(a,b){this._currentPage=1;this._text=["STORY_SCREEN_PAGE_1","STORY_SCREEN_PAGE_2",
"STORY_SCREEN_PAGE_3"];m.call(this,a);this._gameController=b};Ze.__name__=["game","ui","popups","StoryPopup"];Ze.__super__=oa;Ze.prototype=p(oa.prototype,{init:function(){oa.prototype.init.call(this);var a=new Ma(this._uiPanel);a.createUnderlay();var a=a.createPopupBase(),b=new Ca,c=a.addEntity();c.setLocalPosition(0,-35,0);var d={fontSize:32,fontFamily:"ralewaybold",fill:"#FFFFFF",wordWrapWidth:450,wordWrap:!0,align:"center"};n.isMobile()&&(d.fontSize=35.2,d.wordWrapWidth=495.00000000000006);this._bodyText=
new ta(c,"",d);this.updatePage();a.addChild(c);b.x=0;b.y=300;b.defaultImageName="splashPlayButton";b.clickSoundId="sfxButtonForward";b.deactivateButtonOnClick=!1;la.createButton(b,a,w(this,this.onNextClick))},updatePage:function(){this._bodyText.setTextString(sa.getString(this._text[this._currentPage-1]))},onNextClick:function(){var a=this._text.length;this._currentPage++;this._currentPage>a?ua.doTransition(this.getGameState(),new Kb(this._gameController)):this.updatePage()},__class__:Ze});var Jc=
function(a,b,c,d){m.call(this,a);this._levelNumber=b;this._imageIdBase=c;this._stringIdBase=d};Jc.__name__=["game","ui","popups","TutorialPopup"];Jc.__super__=oa;Jc.prototype=p(oa.prototype,{init:function(){oa.prototype.init.call(this);var a=new Ma(this._uiPanel);a.createUnderlay();var b=a.createPopupBase(),c=n.isMobile()?"Mobile":"Web",d=b.addEntity(),e={fontFamily:"ralewaybold",fill:"#FFFFFF",fontSize:22,wordWrap:!0,wordWrapWidth:380,align:"center"};n.isMobile()&&(e.fontSize=24.200000000000003,
e.wordWrapWidth=418.00000000000006);new ta(d,sa.getString(this._stringIdBase+"_"+c.toUpperCase()),e);d.setLocalPosition(0,-110);d=b.addEntity();d.setLocalPosition(0,120);(new A(d,this._imageIdBase+c)).setAnchor(0.5,0.5);c=new Ca;c.defaultImageName="playButton";c.clickSoundId="sfxButtonForward";c.x=360;c.y=330;a.createCornerCharacter(this._levelNumber);la.createButton(c,b,w(this,this.onNextButtonClick))},onNextButtonClick:function(){this.dismiss()},__class__:Jc});var pe=function(a){this._gameTitle=
"";L.call(this);this._utag=window.utag;this._gameTitle=a};pe.__name__=["game","utag","UtagManager"];pe.__super__=U;pe.prototype=p(U.prototype,{link:function(a,b){var c={};c.event_id=Da.replace(a,"[Game Title]",this._gameTitle);c.event_id=Da.replace(c.event_id,"[game title]",this._gameTitle);c.event_id=Da.replace(c.event_id,"[Game Name]",this._gameTitle);c.event_id=Da.replace(c.event_id,"[game name]",this._gameTitle);c.event_category_id=b;null!=this._utag&&this._utag.link(c)},view:function(a){var b=
{};a=Da.replace(a,"[Game Title]",this._gameTitle);a=Da.replace(a,"[game title]",this._gameTitle);a=Da.replace(a,"[Game Name]",this._gameTitle);a=Da.replace(a,"[game name]",this._gameTitle);a=Da.replace(a,"[locale]",x.dataLocale);b.page_id=a;null!=this._utag&&this._utag.view(b)},__class__:pe});var kg=function(){};kg.__name__=["haxe","IMap"];var $e=function(){};$e.__name__=["haxe","ds","BalancedTree"];$e.prototype={set:function(a,b){this.root=this.setLoop(a,b,this.root)},get:function(a){for(var b=this.root;null!=
b;){var c=this.compare(a,b.key);if(0==c)return b.value;b=0>c?b.left:b.right}return null},setLoop:function(a,b,c){if(null==c)return new Na(null,a,b,null);var d=this.compare(a,c.key);if(0==d)return new Na(c.left,a,b,c.right,null==c?0:c._height);if(0>d)return a=this.setLoop(a,b,c.left),this.balance(a,c.key,c.value,c.right);a=this.setLoop(a,b,c.right);return this.balance(c.left,c.key,c.value,a)},balance:function(a,b,c,d){var e=null==a?0:a._height,f=null==d?0:d._height;return e>f+2?(e=a.left,f=a.right,
(null==e?0:e._height)>=(null==f?0:f._height)?new Na(a.left,a.key,a.value,new Na(a.right,b,c,d)):new Na(new Na(a.left,a.key,a.value,a.right.left),a.right.key,a.right.value,new Na(a.right.right,b,c,d))):f>e+2?(e=d.right,f=d.left,(null==e?0:e._height)>(null==f?0:f._height)?new Na(new Na(a,b,c,d.left),d.key,d.value,d.right):new Na(new Na(a,b,c,d.left.left),d.left.key,d.left.value,new Na(d.left.right,d.key,d.value,d.right))):new Na(a,b,c,d,(e>f?e:f)+1)},compare:function(a,b){return ma.compare(a,b)},__class__:$e};
var Na=function(a,b,c,d,e){null==e&&(e=-1);this.left=a;this.key=b;this.value=c;this.right=d;-1==e?(a=this.left,b=this.right,a=(null==a?0:a._height)>(null==b?0:b._height)?this.left:this.right,a=null==a?0:a._height,this._height=a+1):this._height=e};Na.__name__=["haxe","ds","TreeNode"];Na.prototype={__class__:Na};var Cd=function(){};Cd.__name__=["haxe","ds","EnumValueMap"];Cd.__interfaces__=[kg];Cd.__super__=$e;Cd.prototype=p($e.prototype,{compare:function(a,b){var c=a[1]-b[1];if(0!=c)return c;var c=
a.slice(2),d=b.slice(2);return 0==c.length&&0==d.length?0:this.compareArgs(c,d)},compareArgs:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(var c=0,d=a.length;c<d;){var e=c++,e=this.compareArg(a[e],b[e]);if(0!=e)return e}return 0},compareArg:function(a,b){return ma.isEnumValue(a)&&ma.isEnumValue(b)?this.compare(a,b):a instanceof Array&&null==a.__enum__&&b instanceof Array&&null==b.__enum__?this.compareArgs(a,b):ma.compare(a,b)},__class__:Cd});var Oa=function(){this.h={}};Oa.__name__=["haxe",
"ds","StringMap"];Oa.__interfaces__=[kg];Oa.prototype={setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},remove:function(a){if(null!=ea[a]){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},__class__:Oa};var ya=function(a,b,c){this.xml=
b;this.message=a;this.position=c;this.lineNumber=1;for(a=this.positionAtLine=0;a<c;){var d=a++,d=b.charCodeAt(d);10==d?(this.lineNumber++,this.positionAtLine=0):13!=d&&this.positionAtLine++}};ya.__name__=["haxe","xml","XmlParserException"];ya.prototype={toString:function(){return Wa.getClassName(y.getClass(this))+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:ya};var Lb=function(){};Lb.__name__=["haxe","xml","Parser"];Lb.parse=function(a,b){null==b&&(b=!1);var c=
C.createDocument();Lb.doParse(a,b,0,c);return c};Lb.doParse=function(a,b,c,d){null==c&&(c=0);for(var e=null,f=1,g=1,k=null,h=0,l=0,m=0,n=a.charCodeAt(c),p=new ac,q=1,r=-1;n==n;){switch(f){case 0:switch(n){case 9:case 10:case 13:case 32:break;default:f=g;continue}break;case 1:if(60==n)f=0,g=2;else{h=c;f=13;continue}break;case 2:switch(n){case 33:if(91==a.charCodeAt(c+1)){c+=2;if("CDATA["!=G.substr(a,c,6).toUpperCase())throw new K(new ya("Expected <![CDATA[",a,c));c+=5;f=17}else if(68==a.charCodeAt(c+
1)||100==a.charCodeAt(c+1)){if("OCTYPE"!=G.substr(a,c+2,6).toUpperCase())throw new K(new ya("Expected <!DOCTYPE",a,c));c+=8;f=16}else{if(45!=a.charCodeAt(c+1)||45!=a.charCodeAt(c+2))throw new K(new ya("Expected \x3c!--",a,c));c+=2;f=15}h=c+1;break;case 47:if(null==d)throw new K(new ya("Expected node name",a,c));h=c+1;f=0;g=10;break;case 63:f=14;h=c;break;default:f=3;h=c;continue}break;case 3:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(c==h)throw new K(new ya("Expected node name",
a,c));e=C.createElement(G.substr(a,h,c-h));d.addChild(e);++l;f=0;g=4;continue}break;case 4:switch(n){case 47:f=11;break;case 62:f=9;break;default:f=5;h=c;continue}break;case 5:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(h==c)throw new K(new ya("Expected attribute name",a,c));k=G.substr(a,h,c-h);if(e.exists(k))throw new K(new ya("Duplicate attribute ["+k+"]",a,c));f=0;g=6;continue}break;case 6:if(61==n)f=0,g=7;else throw new K(new ya("Expected =",a,c));break;case 7:switch(n){case 34:case 39:p=
new ac;f=8;h=c+1;r=n;break;default:throw new K(new ya('Expected "',a,c));}break;case 8:switch(n){case 38:q=c-h;p.b+=null==q?G.substr(a,h,null):G.substr(a,h,q);f=18;q=8;h=c+1;break;case 60:case 62:if(b)throw new K(new ya("Invalid unescaped "+String.fromCharCode(n)+" in attribute value",a,c));n==r&&(g=c-h,p.b+=null==g?G.substr(a,h,null):G.substr(a,h,g),g=p.b,p=new ac,e.set(k,g),f=0,g=4);break;default:n==r&&(g=c-h,p.b+=null==g?G.substr(a,h,null):G.substr(a,h,g),g=p.b,p=new ac,e.set(k,g),f=0,g=4)}break;
case 9:h=c=Lb.doParse(a,b,c,e);f=1;break;case 10:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(h==c)throw new K(new ya("Expected node name",a,c));g=G.substr(a,h,c-h);if(d.nodeType!=C.Element)throw new K("Bad node type, expected Element but found "+d.nodeType);if(g!=d.nodeName){if(d.nodeType!=C.Element)throw new K("Bad node type, expected Element but found "+d.nodeType);throw new K(new ya("Expected </"+d.nodeName+">",a,c));}f=0;g=12;continue}break;case 11:if(62==n)f=
1;else throw new K(new ya("Expected >",a,c));break;case 12:if(62==n)return 0==l&&d.addChild(C.createPCData("")),c;throw new K(new ya("Expected >",a,c));case 13:60==n?(g=c-h,p.b+=null==g?G.substr(a,h,null):G.substr(a,h,g),g=C.createPCData(p.b),p=new ac,d.addChild(g),++l,f=0,g=2):38==n&&(q=c-h,p.b+=null==q?G.substr(a,h,null):G.substr(a,h,q),f=18,q=13,h=c+1);break;case 14:63==n&&62==a.charCodeAt(c+1)&&(++c,n=G.substr(a,h+1,c-h-2),d.addChild(C.createProcessingInstruction(n)),++l,f=1);break;case 15:45==
n&&(45==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(d.addChild(C.createComment(G.substr(a,h,c-h))),++l,c+=2,f=1);break;case 16:91==n?++m:93==n?--m:62==n&&0==m&&(d.addChild(C.createDocType(G.substr(a,h,c-h))),++l,f=1);break;case 17:93==n&&(93==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(n=C.createCData(G.substr(a,h,c-h)),d.addChild(n),++l,c+=2,f=1);break;case 18:if(59==n){h=G.substr(a,h,c-h);if(35==h.charCodeAt(0))h=120==h.charCodeAt(1)?ra.parseInt("0"+G.substr(h,1,h.length-1)):ra.parseInt(G.substr(h,
1,h.length-1)),p.b+=String.fromCharCode(h);else if(n=Lb.escapes,null!=ea[h]?n.existsReserved(h):n.h.hasOwnProperty(h))n=Lb.escapes,h=null!=ea[h]?n.getReserved(h):n.h[h],p.b+=ra.string(h);else{if(b)throw new K(new ya("Undefined entity: "+h,a,c));p.b+=ra.string("&"+h+";")}h=c+1;f=q}else if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)&&35!=n){if(b)throw new K(new ya("Invalid character in entity: "+String.fromCharCode(n),a,c));p.b+="&";n=c-h;p.b+=null==n?G.substr(a,h,null):
G.substr(a,h,n);h=c--;f=q}}n=a.charCodeAt(++c)}1==f&&(h=c,f=13);if(13==f){if(c!=h||0==l)b=c-h,p.b+=null==b?G.substr(a,h,null):G.substr(a,h,b),d.addChild(C.createPCData(p.b));return c}if(!b&&18==f&&13==q)return p.b+="&",b=c-h,p.b+=null==b?G.substr(a,h,null):G.substr(a,h,b),d.addChild(C.createPCData(p.b)),c;throw new K(new ya("Unexpected end",a,c));};var K=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,K)};K.__name__=["js","_Boot",
"HaxeError"];K.wrap=function(a){return a instanceof Error?a:new K(a)};K.__super__=Error;K.prototype=p(Error.prototype,{__class__:K});var y=function(){};y.__name__=["js","Boot"];y.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=y.__nativeClassName(a);return null!=a?y.__resolveNativeClass(a):null};y.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&
(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+y.__string_rec(a[f],b)):c+y.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+y.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(g){return"???"}if(null!=d&&(d!=Object.toString&&"function"==typeof d)&&(c=a.toString(),"[object Object]"!=c))return c;
c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||("prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c)||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+y.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};y.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||y.__interfLoop(f,b))return!0}return y.__interfLoop(a.__super__,
b)};y.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array?null==a.__enum__:!1;case mg:return"boolean"==typeof a;case rg:return!0;case ng:return"number"==typeof a;case sg:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(a instanceof b||y.__interfLoop(y.getClass(a),b))return!0}else{if("object"==typeof b&&y.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==tg&&null!=a.__name__||
b==ug&&null!=a.__ename__?!0:a.__enum__==b}};y.__cast=function(a,b){if(y.__instanceof(a,b))return a;throw new K("Cannot cast "+ra.string(a)+" to "+ra.string(b));};y.__nativeClassName=function(a){a=y.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};y.__isNativeObj=function(a){return null!=y.__nativeClassName(a)};y.__resolveNativeClass=function(a){return jg[a]};var Za=function(){};Za.__name__=["js","Browser"];Za.getLocalStorage=function(){try{var a=window.localStorage;
a.getItem("");return a}catch(b){return null}};Za.getSessionStorage=function(){try{var a=window.sessionStorage;a.getItem("");return a}catch(b){return null}};var Ab=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};Ab.__name__=["js","html","compat","ArrayBuffer"];Ab.sliceImpl=function(a,b){var c=new og(this,a,null==b?null:b-a),d=new lg(c.byteLength);(new og(d)).set(c);return d};Ab.prototype=
{slice:function(a,b){return new Ab(this.a.slice(a,b))},__class__:Ab};var $b=function(){};$b.__name__=["js","html","compat","Uint8Array"];$b._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new Ab(c)}else if(y.__instanceof(a,Ab))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,
c.byteOffset=0,c.buffer=new Ab(c);else throw new K("TODO "+ra.string(a));c.subarray=$b._subarray;c.set=$b._set;return c};$b._set=function(a,b){if(y.__instanceof(a.buffer,Ab)){if(a.byteLength+b>this.byteLength)throw new K("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new K("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new K("TODO");};$b._subarray=
function(a,b){var c=$b._new(this.slice(a,b));c.byteOffset=a;return c};var wc={__ename__:!0,__constructs__:["Fixed","Percent"],Fixed:["Fixed",0]};wc.Fixed.__enum__=wc;wc.Percent=["Percent",1];wc.Percent.__enum__=wc;wc.__empty_constructs__=[wc.Fixed,wc.Percent];var nb={__ename__:!0,__constructs__:["Length","Fixed","Percent"],Length:["Length",0]};nb.Length.__enum__=nb;nb.Fixed=["Fixed",1];nb.Fixed.__enum__=nb;nb.Percent=["Percent",2];nb.Percent.__enum__=nb;nb.__empty_constructs__=[nb.Length,nb.Fixed,
nb.Percent];var ob={__ename__:!0,__constructs__:["Tangent","Chain","ChainScale"],Tangent:["Tangent",0]};ob.Tangent.__enum__=ob;ob.Chain=["Chain",1];ob.Chain.__enum__=ob;ob.ChainScale=["ChainScale",2];ob.ChainScale.__enum__=ob;ob.__empty_constructs__=[ob.Tangent,ob.Chain,ob.ChainScale];var hb,qg=0;String.prototype.__class__=String;String.__name__=["String"];Array.__name__=["Array"];Date.prototype.__class__=Date;Date.__name__=["Date"];var sg={__name__:["Int"]},rg={__name__:["Dynamic"]},ng=Number;ng.__name__=
["Float"];var mg=Boolean;mg.__ename__=["Bool"];var tg={__name__:["Class"]},ug={},ea={},pg=pg||{};pg.JQuery=window.jQuery;var lg=jg.ArrayBuffer||Ab;null==lg.prototype.slice&&(lg.prototype.slice=Ab.sliceImpl);var og=jg.Uint8Array||$b._new;x.TARGET_FPS=60;x.TARGET_FPS_MOBILE=30;x.GAME_ID="barbie_dreamhouse";x.DEFAULT_SCREEN_WIDTH=1024;x.DEFAULT_SCREEN_HEIGHT=768;x.DEFAULT_LOCALE="en-us";x.BACKGROUND_COLOR="#000000";x.dataLocale="";C.Element=0;C.PCData=1;C.CData=2;C.Comment=3;C.DocType=4;C.ProcessingInstruction=
5;C.Document=6;J.b2_nullFeature=255;J.s_incidentEdge=J.makeClipPointVector();J.s_clipPoints1=J.makeClipPointVector();J.s_clipPoints2=J.makeClipPointVector();J.s_edgeAO=[];J.s_edgeBO=[];J.s_localTangent=new s;J.s_localNormal=new s;J.s_planePoint=new s;J.s_normal=new s;J.s_tangent=new s;J.s_tangent2=new s;J.s_v11=new s;J.s_v12=new s;J.b2CollidePolyTempVec=new s;ab.s_simplex=new cf;ab.s_saveA=[];ab.s_saveB=[];Uc.currentID=0;N.b2_toiCalls=0;N.b2_toiIters=0;N.b2_toiMaxIters=0;N.b2_toiRootIters=0;N.b2_toiMaxRootIters=
0;N.s_cache=new mf;N.s_distanceInput=new df;N.s_xfA=new pb;N.s_xfB=new pb;N.s_fcn=new lf;N.s_distanceOutput=new ef;xa.e_hitCollide=1;xa.e_missCollide=0;xa.e_startsInsideCollide=-1;ka.s_mat=new da;v.VERSION="2.1alpha";v.USHRT_MAX=65535;v.b2_pi=Math.PI;v.b2_maxManifoldPoints=2;v.b2_aabbExtension=0.1;v.b2_aabbMultiplier=2;v.b2_polygonRadius=2*v.b2_linearSlop;v.b2_linearSlop=0.005;v.b2_angularSlop=0.011111111111111112*v.b2_pi;v.b2_toiSlop=8*v.b2_linearSlop;v.b2_maxTOIContactsPerIsland=32;v.b2_maxTOIJointsPerIsland=
32;v.b2_velocityThreshold=1;v.b2_maxLinearCorrection=0.2;v.b2_maxAngularCorrection=0.044444444444444446*v.b2_pi;v.b2_maxTranslation=2;v.b2_maxTranslationSquared=v.b2_maxTranslation*v.b2_maxTranslation;v.b2_maxRotation=0.5*v.b2_pi;v.b2_maxRotationSquared=v.b2_maxRotation*v.b2_maxRotation;v.b2_contactBaumgarte=0.2;v.b2_timeToSleep=0.5;v.b2_linearSleepTolerance=0.01;v.b2_angularSleepTolerance=0.011111111111111112*v.b2_pi;r.b2Vec2_zero=new s(0,0);r.b2Mat22_identity=da.fromVV(new s(1,0),new s(0,1));r.b2Transform_identity=
new pb(r.b2Vec2_zero,r.b2Mat22_identity);z.s_xf1=new pb;z.e_islandFlag=1;z.e_awakeFlag=2;z.e_allowSleepFlag=4;z.e_bulletFlag=8;z.e_fixedRotationFlag=16;z.e_activeFlag=32;z.b2_staticBody=0;z.b2_kinematicBody=1;z.b2_dynamicBody=2;Wc.b2_defaultFilter=new Wc;fb.b2_defaultListener=new fb;Od.s_evalCP=new bf;za.e_shapeBit=1;za.e_jointBit=2;za.e_aabbBit=4;za.e_pairBit=8;za.e_centerOfMassBit=16;za.e_controllerBit=32;cc.s_impulse=new qf;Z.s_timestep2=new Yc;Z.s_xf=new pb;Z.s_backupA=new Mb;Z.s_backupB=new Mb;
Z.s_timestep=new Yc;Z.s_queue=[];Z.s_jointColor=new Md(0.5,0.8,0.8);Z.e_newFixture=1;Z.e_locked=2;B.e_sensorFlag=1;B.e_continuousFlag=2;B.e_islandFlag=4;B.e_toiFlag=8;B.e_touchingFlag=16;B.e_enabledFlag=32;B.e_filterFlag=64;B.s_input=new nf;Zc.circlePointA=new s;Zc.circlePointB=new s;Ea.staticFix=v.b2_maxManifoldPoints;Ea.s_worldManifold=new of;Ea.s_psm=new Zc;qb.b2_minPulleyLength=2;rb.tImpulse=new s;L._currentInstanceId=0;I._properties=new Oa;Cb._currentZIndex=0;Cc.MIN_LOAD_TIME=0.5;Cc.MAX_ACTIVE_REQUESTS=
10;sa._isInitialized=!1;n.ORIENTATION_HORIZONTAL=0;n.ORIENTATION_VERTICAL=1;n._devicePixelRatio=-1;n._timeService=new fe;q._masterVolume=1;q._musicVolume=0.25;q._soundVolume=1;q._musicMuted=!1;q._soundMuted=!1;q._soundsPlaying=[];q._isWebkitEnabled=!1;q._useFlashSound=!1;q._soundTimers=new Oa;Eb.BEGIN_CONTACT="beginContact";Eb.END_CONTACT="endContact";dd.PHYSICS_FPS=60;dd.TIMESTEP=0.016666666666666666;ec.PRE_UPDATE="preUpdate";ec.UPDATE="update";pa.FRAMERATE=30;ed.EPSILON=5E-5;tb.UPDATE="update";
Ga._delayButtonLock=!1;T.VISIBILITY_OFF="visibilityOff";T.VISIBILITY_ON="visibilityOn";T.DISPLAY_UPDATE="displayUpdate";T.ADDED_TO_PARENT="addedToParent";T.REMOVED_FROM_PARENT="removedFromParent";T.PARENT_UPDATE="parentUpdate";T.MOUSE_DOWN="mouseDown";T.MOUSE_UP="mouseUp";T.MOUSE_MOVE="mouseMove";T.MOUSE_OUT="mouseOut";T.MOUSE_OVER="mouseOver";T.MOUSE_CLICK="mouseClick";gb.DESTROY="destroy";gb.ACTIVATE="activate";gb.DEACTIVATE="deactivate";gb.INITIALIZE="initialize";fd.RAYCAST_CHECK="raycastCheck";
H.assetList=new Oa;ub.BEAT_LEVEL="beatLevel";ub.FAIL_LEVEL="failLevel";ub.TURBO_START="turboStart";ub.TURBO_END="turboEnd";ub.COMIC_SNAPSHOT="comicSnapshot";lc.MIDPOINT="midpoint";lc.COMPLETE="complete";hd.SHOW_SUBTITLE="showSubtitle";id.UPDATE_DISPLAY="updateDisplay";kd.CHANGE="change";ua.TIME_SCALE=2;ua.TRANSITION_TIME=0.325;ua.FADE_TIME=7.3;ua.FADE_DURATION=0;Y.NUM_LEVELS_UNLOCKED_KEY="numLevelsUnlocked";Y.LEVEL_SCORE_SAVE_KEY="levelScore";Y.HAS_BEATEN_GAME_KEY="hasBeatenGame";Y.HAS_STARTED_GAME_KEY=
"hasStartedGame";yb.DRAG="drag";yb.EXCEED_BOUNDS="exceedBounds";nd.SHOW_MENU="OnMenu";nd.TOGGLE_MUSIC="onToggleMusic";od.TIME_ELAPSE="timeElapse";qd.COMPLETE="complete";pd.CLOCK_FLASH_PERCENT=0.33;Ra.HIT_GROUND="hitGround";Ra.HIT_NET="hitNet";Ra.DOUBLE_HIT="doubleHit";Ra.PASS_NET_TO_RIGHT="passNetToRight";Ra.PASS_NET_TO_LEFT="passNetToLeft";oc.MAX_CHARGE=1;oc.METER_OFFSET_X=0;oc.METER_OFFSET_Y=-225;nc.FAR_FROM_NET_POSITION_X=350;nc.MIN_APPROACH_DISTANCE=50;nc.DESIRED_RELATIVE_X=-25;Nc.BIRDIE_OFFSET_X=
-34;Nc.BIRDIE_OFFSET_Y=-172;qc.MIN_BUTTON_HEIGHT=120;vd.FOUND="found";Oc.HORSE_STOP_DURATION=1.15;Qc.DESTROY_OBJECTS_X=-450;xd.SPAWN="spawn";yd.INSTANT_JUMP_OFFSET=-45;Ad.OBSTACLE_PASS="pass";Bd.HIT_OBSTACLE="hitObstacle";Gc.MINIGAME_TYPES_ORDERED=[va.Badminton,va.InfiniteRunner,va.HideAndSeek];Dd.VIDEO_FINISH="videoFinish";eb.HAND_SPAWN_DELAY=0.5;eb.HAND_SPAWN_X=-300;eb.HAND_SPAWN_Y=-185;eb.HAND_START_X=195;eb.HAND_START_Y=-40;eb.HAND_MOVE_TO_START_DURATION=0.65;eb.DRAG_DISTANCE=500;eb.DRAG_DURATION=
2;sc.VIDEO_WIDTH=566;sc.VIDEO_HEIGHT=318;Kc.TIME_SCALE=1.5;Kc.SPRITE_PREFIX="countdown";Mc.MOBILE_UPSCALE=1.1;tc.POPUP_ENTER="popupEnter";tc.POPUP_DISMISS="popupDismiss";Ma.STAR_POP_DURATION=0.35;Ma.STAR_POP_DELAY=0.25;Xb.MOBILE_TEXT_UPSCALE=1.1;vc.RESUME="resume";vc.QUIT="quit";uc.ENTER_COMPLETE="enterComplete";uc.DISMISS_COMPLETE="dismissComplete";Ze.MOBILE_TEXT_UPSCALE=1.1;Jc.MOBILE_TEXT_UPSCALE=1.1;Lb.escapes=function(a){a=new Oa;null!=ea.lt?a.setReserved("lt","<"):a.h.lt="<";null!=ea.gt?a.setReserved("gt",
">"):a.h.gt=">";null!=ea.amp?a.setReserved("amp","&"):a.h.amp="&";null!=ea.quot?a.setReserved("quot",'"'):a.h.quot='"';null!=ea.apos?a.setReserved("apos","'"):a.h.apos="'";return a}(this);y.__toStr={}.toString;$b.BYTES_PER_ELEMENT=1;x.main()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
